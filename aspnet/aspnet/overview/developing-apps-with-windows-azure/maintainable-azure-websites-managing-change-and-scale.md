---
uid: aspnet/overview/developing-apps-with-windows-azure/maintainable-azure-websites-managing-change-and-scale
title: 'Laboratorio pratico: siti Web di Azure gestibili: gestione delle modifiche e della scalabilità | Microsoft Docs'
author: rick-anderson
description: In questo laboratorio scoprirai come Microsoft Azure semplifica la creazione e la distribuzione di siti Web nell'ambiente di produzione.
ms.author: riande
ms.date: 07/16/2014
ms.assetid: ecfd0eb4-c4ad-44e6-9db9-a2a66611ff6a
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/maintainable-azure-websites-managing-change-and-scale
msc.type: authoredcontent
ms.openlocfilehash: c88bae40a8aa092037c0b359ee391acaf161cf10
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78624271"
---
# <a name="hands-on-lab-maintainable-azure-websites-managing-change-and-scale"></a><span data-ttu-id="1cfc3-103">Laboratorio pratico: siti Web di Azure gestibili: gestione di modifiche e scalabilità</span><span class="sxs-lookup"><span data-stu-id="1cfc3-103">Hands on Lab: Maintainable Azure Websites: Managing Change and Scale</span></span>

<span data-ttu-id="1cfc3-104">dal [team di Web Camp](https://twitter.com/webcamps)</span><span class="sxs-lookup"><span data-stu-id="1cfc3-104">by [Web Camps Team](https://twitter.com/webcamps)</span></span>

[<span data-ttu-id="1cfc3-105">Scarica il kit di formazione di Web Camp</span><span class="sxs-lookup"><span data-stu-id="1cfc3-105">Download Web Camps Training Kit</span></span>](https://aka.ms/webcamps-training-kit)

> <span data-ttu-id="1cfc3-106">Microsoft Azure semplifica la creazione e la distribuzione di siti Web nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-106">Microsoft Azure makes it easy to build and deploy websites to production.</span></span> <span data-ttu-id="1cfc3-107">Tuttavia, quando l'applicazione è attiva, si sta iniziando.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-107">But you're not done when your application is live, you're just getting started!</span></span> <span data-ttu-id="1cfc3-108">È necessario gestire i requisiti modificabili, gli aggiornamenti del database, la scalabilità e altro ancora.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-108">You'll need to handle changing requirements, database updates, scale, and more.</span></span> <span data-ttu-id="1cfc3-109">Fortunatamente, app Azure servizio è stato analizzato, con numerose funzionalità che consentono di garantire un funzionamento ottimale dei siti.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-109">Fortunately, Azure App Service has you covered, with plenty of features to help you keep your sites running smoothly.</span></span>
>
> <span data-ttu-id="1cfc3-110">Azure offre opzioni di sviluppo, distribuzione e scalabilità sicure e flessibili per applicazioni Web di qualsiasi dimensione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-110">Azure offers secure and flexible development, deployment and scaling options for any size web application.</span></span> <span data-ttu-id="1cfc3-111">Usare gli strumenti esistenti per creare e distribuire applicazioni senza dover gestire l'infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-111">Leverage your existing tools to create and deploy applications without the hassle of managing infrastructure.</span></span>
>
> <span data-ttu-id="1cfc3-112">Esegui il provisioning di un'applicazione Web di produzione in pochi minuti semplificando la distribuzione di contenuti creati usando lo strumento di sviluppo preferito.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-112">Provision a production web application yourself in minutes by easily deploying content created using your favorite development tool.</span></span> <span data-ttu-id="1cfc3-113">È possibile distribuire un sito esistente direttamente dal controllo del codice sorgente con supporto per **git**, **GitHub**, **bitbucket**, **TFS**e anche **Dropbox**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-113">You can deploy an existing site directly from source control with support for **Git**, **GitHub**, **Bitbucket**, **TFS**, and even **DropBox**.</span></span> <span data-ttu-id="1cfc3-114">Distribuisci direttamente dall'IDE preferito o dagli script usando **PowerShell** in Windows o gli strumenti dell' **interfaccia** della riga di comando in esecuzione su qualsiasi sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-114">Deploy directly from your favorite IDE or from scripts using **PowerShell** in Windows or **CLI** tools running on any OS.</span></span> <span data-ttu-id="1cfc3-115">Una volta distribuite, Mantieni i siti costantemente aggiornati con il supporto per la distribuzione continua.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-115">Once deployed, keep your sites constantly up-to-date with support for continuous deployment.</span></span>
>
> <span data-ttu-id="1cfc3-116">Azure offre soluzioni di archiviazione cloud, backup e ripristino scalabili e durevoli per tutti i dati, Big o Small.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-116">Azure provides scalable, durable cloud storage, backup, and recovery solutions for any data, big or small.</span></span> <span data-ttu-id="1cfc3-117">Quando si distribuiscono applicazioni in un ambiente di produzione, i servizi di archiviazione quali tabelle, BLOB e database SQL consentono di ridimensionare l'applicazione nel cloud.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-117">When deploying applications to a production environment, storage services such as Tables, Blobs and SQL Databases, help you scale your application in the cloud.</span></span>
>
> <span data-ttu-id="1cfc3-118">Con i database SQL, è importante che il database produttivo rimanga aggiornato quando si distribuiscono nuove versioni dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-118">With SQL Databases, it is important to keep your productive database up-to-date when deploying new versions of your application.</span></span> <span data-ttu-id="1cfc3-119">Grazie alla **migrazioni Code First di Entity Framework**, lo sviluppo e la distribuzione del modello di dati sono stati semplificati per aggiornare gli ambienti in pochi minuti.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-119">Thanks to **Entity Framework Code First Migrations**, the development and deployment of your data model has been simplified to update your environments in minutes.</span></span> <span data-ttu-id="1cfc3-120">Questo laboratorio pratico Mostra i diversi argomenti che possono verificarsi quando si distribuisce l'app Web in ambienti di produzione in Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-120">This hands-on lab will show you the different topics you could encounter when deploying your web app to production environments in Microsoft Azure.</span></span>
>
> <span data-ttu-id="1cfc3-121">Tutti i codici e i frammenti di codice di esempio sono inclusi nel kit di formazione di Web Camp, disponibile all' [https://aka.ms/webcamps-training-kit](https://aka.ms/webcamps-training-kit).</span><span class="sxs-lookup"><span data-stu-id="1cfc3-121">All sample code and snippets are included in the Web Camps Training Kit, available at [https://aka.ms/webcamps-training-kit](https://aka.ms/webcamps-training-kit).</span></span>
>
> <span data-ttu-id="1cfc3-122">Per una copertura più approfondita di questo argomento, vedere la pagina relativa alla [creazione di app Cloud reali con e-book di Azure](building-real-world-cloud-apps-with-windows-azure/introduction.md).</span><span class="sxs-lookup"><span data-stu-id="1cfc3-122">For more in-depth coverage of this topic, see the [Building Real-World Cloud Apps with Azure e-book](building-real-world-cloud-apps-with-windows-azure/introduction.md).</span></span>

<a id="Overview"></a>
## <a name="overview"></a><span data-ttu-id="1cfc3-123">Panoramica</span><span class="sxs-lookup"><span data-stu-id="1cfc3-123">Overview</span></span>

<a id="Objectives"></a>
### <a name="objectives"></a><span data-ttu-id="1cfc3-124">Obiettivi</span><span class="sxs-lookup"><span data-stu-id="1cfc3-124">Objectives</span></span>

<span data-ttu-id="1cfc3-125">In questo laboratorio pratico si apprenderà come:</span><span class="sxs-lookup"><span data-stu-id="1cfc3-125">In this hands-on lab, you will learn how to:</span></span>

- <span data-ttu-id="1cfc3-126">Abilita migrazioni di Entity Framework con un modello esistente</span><span class="sxs-lookup"><span data-stu-id="1cfc3-126">Enable Entity Framework Migrations with an existing model</span></span>
- <span data-ttu-id="1cfc3-127">Aggiornare il modello a oggetti e il database in modo appropriato usando migrazioni di Entity Framework</span><span class="sxs-lookup"><span data-stu-id="1cfc3-127">Update the object model and database accordingly using Entity Framework Migrations</span></span>
- <span data-ttu-id="1cfc3-128">Eseguire la distribuzione nel servizio app Azure usando git</span><span class="sxs-lookup"><span data-stu-id="1cfc3-128">Deploy to Azure App Service using Git</span></span>
- <span data-ttu-id="1cfc3-129">Eseguire il rollback a una distribuzione precedente tramite il portale di gestione di Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-129">Rollback to a previous deployment using the Azure Management portal</span></span>
- <span data-ttu-id="1cfc3-130">Usare archiviazione di Azure per ridimensionare un'app Web</span><span class="sxs-lookup"><span data-stu-id="1cfc3-130">Use Azure Storage to scale a web app</span></span>
- <span data-ttu-id="1cfc3-131">Configurare la scalabilità automatica per un'app Web usando il portale di gestione di Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-131">Configure auto-scaling for a web app using the Azure Management Portal</span></span>
- <span data-ttu-id="1cfc3-132">Creare e configurare un progetto di test di carico in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="1cfc3-132">Create and configure a load test project in Visual Studio</span></span>

<a id="Prerequisites"></a>
### <a name="prerequisites"></a><span data-ttu-id="1cfc3-133">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="1cfc3-133">Prerequisites</span></span>

<span data-ttu-id="1cfc3-134">Per completare questa esercitazione pratica, è necessario quanto segue:</span><span class="sxs-lookup"><span data-stu-id="1cfc3-134">The following is required to complete this hands-on lab:</span></span>

- <span data-ttu-id="1cfc3-135">[Visual Studio Express 2013 per il Web](https://www.microsoft.com/visualstudio/) o versione successiva</span><span class="sxs-lookup"><span data-stu-id="1cfc3-135">[Visual Studio Express 2013 for Web](https://www.microsoft.com/visualstudio/) or greater</span></span>
- [<span data-ttu-id="1cfc3-136">Azure SDK per .NET 2,2</span><span class="sxs-lookup"><span data-stu-id="1cfc3-136">Azure SDK for .NET 2.2</span></span>](https://www.microsoft.com/windowsazure/sdk/)
- [<span data-ttu-id="1cfc3-137">Sistema di controllo della versione GIT</span><span class="sxs-lookup"><span data-stu-id="1cfc3-137">GIT Version Control System</span></span>](http://git-scm.com/download)
- <span data-ttu-id="1cfc3-138">Sottoscrizione di Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-138">A Microsoft Azure subscription</span></span>

    - <span data-ttu-id="1cfc3-139">Iscriversi per ottenere una [versione di valutazione gratuita](https://aka.ms/watk-freetrial)</span><span class="sxs-lookup"><span data-stu-id="1cfc3-139">Sign up for a [Free Trial](https://aka.ms/watk-freetrial)</span></span>
    - <span data-ttu-id="1cfc3-140">Se sei un Visual Studio Professional, Test Professional, Premium o Ultimate con MSDN o MSDN Platforms abbonato, attiva subito i tuoi [vantaggi MSDN](https://aka.ms/watk-msdn) per iniziare a sviluppare e testare in Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-140">If you are a Visual Studio Professional, Test Professional, Premium or Ultimate with MSDN or MSDN Platforms subscriber, activate your [MSDN benefit](https://aka.ms/watk-msdn) now to start developing and testing on Azure</span></span>
    - <span data-ttu-id="1cfc3-141">I membri di [BizSpark](https://aka.ms/watk-bizspark) ricevono automaticamente i vantaggi di Azure tramite le sottoscrizioni Visual Studio Ultimate con MSDN</span><span class="sxs-lookup"><span data-stu-id="1cfc3-141">[BizSpark](https://aka.ms/watk-bizspark) members automatically receive the Azure benefit through their Visual Studio Ultimate with MSDN subscriptions</span></span>
    - <span data-ttu-id="1cfc3-142">I membri del programma [Microsoft Partner Network](https://aka.ms/watk-mpn) Cloud Essentials ricevono crediti Azure mensili gratuitamente</span><span class="sxs-lookup"><span data-stu-id="1cfc3-142">Members of the [Microsoft Partner Network](https://aka.ms/watk-mpn) Cloud Essentials program receive monthly Azure credits at no charge</span></span>

<a id="Setup"></a>
### <a name="setup"></a><span data-ttu-id="1cfc3-143">Configurazione</span><span class="sxs-lookup"><span data-stu-id="1cfc3-143">Setup</span></span>

<span data-ttu-id="1cfc3-144">Per eseguire gli esercizi in questo laboratorio pratico, è necessario configurare prima l'ambiente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-144">In order to run the exercises in this hands-on lab, you will need to set up your environment first.</span></span>

1. <span data-ttu-id="1cfc3-145">Aprire Esplora risorse e passare alla cartella di **origine** del Lab.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-145">Open Windows Explorer and browse to the lab's **Source** folder.</span></span>
2. <span data-ttu-id="1cfc3-146">Fare clic con il pulsante destro del mouse su **Setup. cmd** e scegliere **Esegui come amministratore** per avviare il processo di installazione che configurerà l'ambiente e installerà i frammenti di codice di Visual Studio per questo Lab.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-146">Right-click on **Setup.cmd** and select **Run as administrator** to launch the setup process that will configure your environment and install the Visual Studio code snippets for this lab.</span></span>
3. <span data-ttu-id="1cfc3-147">Se viene visualizzata la finestra di dialogo controllo dell'account utente, confermare l'azione per continuare.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-147">If the User Account Control dialog is shown, confirm the action to proceed.</span></span>

> [!NOTE]
> <span data-ttu-id="1cfc3-148">Prima di eseguire l'installazione, verificare di aver selezionato tutte le dipendenze per questo Lab.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-148">Make sure you have checked all the dependencies for this lab before running the setup.</span></span>

<a id="CodeSnippets"></a>
### <a name="using-the-code-snippets"></a><span data-ttu-id="1cfc3-149">Uso dei frammenti di codice</span><span class="sxs-lookup"><span data-stu-id="1cfc3-149">Using the Code Snippets</span></span>

<span data-ttu-id="1cfc3-150">Nell'intero documento del Lab verrà richiesto di inserire blocchi di codice.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-150">Throughout the lab document, you will be instructed to insert code blocks.</span></span> <span data-ttu-id="1cfc3-151">Per praticità, la maggior parte di questo codice viene fornita come Visual Studio Code frammenti, a cui è possibile accedere da Visual Studio 2013 per evitare di aggiungerla manualmente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-151">For your convenience, most of this code is provided as Visual Studio Code Snippets, which you can access from within Visual Studio 2013 to avoid having to add it manually.</span></span>

> [!NOTE]
> <span data-ttu-id="1cfc3-152">Ogni esercizio è accompagnato da una soluzione iniziale che si trova nella cartella **Begin** dell'esercizio che consente di seguire ogni esercizio in modo indipendente dagli altri.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-152">Each exercise is accompanied by a starting solution located in the **Begin** folder of the exercise that allows you to follow each exercise independently of the others.</span></span> <span data-ttu-id="1cfc3-153">Tenere presente che i frammenti di codice aggiunti durante un esercizio risultano mancanti da queste soluzioni iniziali e potrebbero non funzionare fino a quando non è stato completato l'esercizio.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-153">Please be aware that the code snippets that are added during an exercise are missing from these starting solutions and may not work until you have completed the exercise.</span></span> <span data-ttu-id="1cfc3-154">All'interno del codice sorgente per un esercizio, si troverà anche una cartella **finale** contenente una soluzione di Visual Studio con il codice risultante dal completamento dei passaggi nell'esercizio corrispondente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-154">Inside the source code for an exercise, you will also find an **End** folder containing a Visual Studio solution with the code that results from completing the steps in the corresponding exercise.</span></span> <span data-ttu-id="1cfc3-155">È possibile usare queste soluzioni come materiale sussidiario se è necessaria ulteriore assistenza durante l'utilizzo di questa esercitazione pratica.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-155">You can use these solutions as guidance if you need additional help as you work through this hands-on lab.</span></span>

---

<a id="Exercises"></a>
## <a name="exercises"></a><span data-ttu-id="1cfc3-156">Esercizi</span><span class="sxs-lookup"><span data-stu-id="1cfc3-156">Exercises</span></span>

<span data-ttu-id="1cfc3-157">Questa esercitazione pratica include gli esercizi seguenti:</span><span class="sxs-lookup"><span data-stu-id="1cfc3-157">This hands-on lab includes the following exercises:</span></span>

1. [<span data-ttu-id="1cfc3-158">Uso delle migrazioni di Entity Framework</span><span class="sxs-lookup"><span data-stu-id="1cfc3-158">Using Entity Framework Migrations</span></span>](#Exercise1)
2. [<span data-ttu-id="1cfc3-159">Distribuzione di un'app Web nella gestione temporanea</span><span class="sxs-lookup"><span data-stu-id="1cfc3-159">Deploying a Web App to Staging</span></span>](#Exercise2)
3. [<span data-ttu-id="1cfc3-160">Esecuzione del rollback della distribuzione nell'ambiente di produzione</span><span class="sxs-lookup"><span data-stu-id="1cfc3-160">Performing Deployment Rollback in Production</span></span>](#Exercise3)
4. [<span data-ttu-id="1cfc3-161">Ridimensionamento con archiviazione di Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-161">Scaling Using Azure Storage</span></span>](#Exercise4)
5. <span data-ttu-id="1cfc3-162">[Uso della scalabilità automatica per le app Web](#Exercise5) (facoltativo per Visual Studio 2013 edizione Ultimate)</span><span class="sxs-lookup"><span data-stu-id="1cfc3-162">[Using Autoscale for Web Apps](#Exercise5) (Optional for Visual Studio 2013 Ultimate edition)</span></span>

<span data-ttu-id="1cfc3-163">Tempo stimato per il completamento del Lab: **75 minuti**</span><span class="sxs-lookup"><span data-stu-id="1cfc3-163">Estimated time to complete this lab: **75 minutes**</span></span>

> [!NOTE]
> <span data-ttu-id="1cfc3-164">Quando si avvia Visual Studio per la prima volta, è necessario selezionare una delle raccolte di impostazioni predefinite.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-164">When you first start Visual Studio, you must select one of the predefined settings collections.</span></span> <span data-ttu-id="1cfc3-165">Ogni raccolta predefinita è progettata in modo da corrispondere a un particolare stile di sviluppo e determina il layout delle finestre, il comportamento dell'editor, i frammenti di codice IntelliSense e le opzioni della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-165">Each predefined collection is designed to match a particular development style and determines window layouts, editor behavior, IntelliSense code snippets, and dialog box options.</span></span> <span data-ttu-id="1cfc3-166">Le procedure descritte in questa esercitazione descrivono le azioni necessarie per eseguire un'attività specifica in Visual Studio quando si usa la raccolta di **impostazioni di sviluppo generali** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-166">The procedures in this lab describe the actions necessary to accomplish a given task in Visual Studio when using the **General Development Settings** collection.</span></span> <span data-ttu-id="1cfc3-167">Se si sceglie una raccolta di impostazioni diversa per l'ambiente di sviluppo, è possibile che siano presenti differenze nei passaggi da tenere in considerazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-167">If you choose a different settings collection for your development environment, there may be differences in the steps that you should take into account.</span></span>

<a id="Exercise1"></a>
### <a name="exercise-1-using-entity-framework-migrations"></a><span data-ttu-id="1cfc3-168">Esercizio 1: uso delle migrazioni di Entity Framework</span><span class="sxs-lookup"><span data-stu-id="1cfc3-168">Exercise 1: Using Entity Framework Migrations</span></span>

<span data-ttu-id="1cfc3-169">Quando si sviluppa un'applicazione, il modello di dati potrebbe cambiare nel tempo.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-169">When you are developing an application, your data model might change over time.</span></span> <span data-ttu-id="1cfc3-170">Queste modifiche possono influire sul modello esistente nel database (se si sta creando una nuova versione) ed è importante che il database sia sempre aggiornato per evitare errori.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-170">These changes could affect the existing model in your database (if you are creating a new version) and it is important to keep your database up-to-date to prevent errors.</span></span>

<span data-ttu-id="1cfc3-171">Per semplificare il rilevamento di queste modifiche nel modello, **migrazioni Code First di Entity Framework** rileva automaticamente le modifiche confrontando il modello con lo schema del database e genera codice specifico per aggiornare il database, creando nuove *versioni* del database.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-171">To simplify the tracking of these changes in your model, **Entity Framework Code First Migrations** automatically detect changes comparing your model with the database schema and generates specific code to update your database, creating new *versions* of your database.</span></span>

<span data-ttu-id="1cfc3-172">Questo esercizio illustra come abilitare le **migrazioni** per l'applicazione e come è possibile rilevare e generare facilmente le modifiche per aggiornare i database.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-172">This exercise shows you how to enable **Migrations** for your application and how you can easily detect and generate changes to update your databases.</span></span>

<a id="Ex1Task1"></a>
#### <a name="task-1--enabling-migrations"></a><span data-ttu-id="1cfc3-173">Attività 1: abilitazione delle migrazioni</span><span class="sxs-lookup"><span data-stu-id="1cfc3-173">Task 1 – Enabling Migrations</span></span>

<span data-ttu-id="1cfc3-174">In questa attività verranno illustrati i passaggi per abilitare **migrazioni Code First di Entity Framework** al database quiz di **geek** , modificare il modello e comprendere il modo in cui tali modifiche verranno riflesse nel database.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-174">In this task, you will go through the steps of enabling **Entity Framework Code First Migrations** to the **Geek Quiz** database, changing the model and understanding how those changes are reflected in the database.</span></span>

1. <span data-ttu-id="1cfc3-175">Aprire Visual Studio e aprire il file della soluzione **GeekQuiz. sln** da **Source\Ex1-UsingEntityFrameworkMigrations\Begin**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-175">Open Visual Studio and open the **GeekQuiz.sln** solution file from **Source\Ex1-UsingEntityFrameworkMigrations\Begin**.</span></span>
2. <span data-ttu-id="1cfc3-176">Compilare la soluzione per scaricare e installare le dipendenze del pacchetto **NuGet** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-176">Build the solution in order to download and install the **NuGet** package dependencies.</span></span> <span data-ttu-id="1cfc3-177">A tale scopo, fare clic con il pulsante destro del mouse sulla soluzione e scegliere **Compila soluzione** oppure premere **CTRL + MAIUSC + B**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-177">To do this, right-click the solution and click **Build Solution** or press **Ctrl + Shift + B**.</span></span>
3. <span data-ttu-id="1cfc3-178">Dal menu **strumenti** in Visual Studio selezionare **Gestione pacchetti NuGet**e quindi fare clic su **console di gestione pacchetti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-178">From the **Tools** menu in Visual Studio, select **NuGet Package Manager**, and then click **Package Manager Console**.</span></span>
4. <span data-ttu-id="1cfc3-179">Nella **console di gestione pacchetti**immettere il comando seguente e quindi premere **invio**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-179">In the **Package Manager Console**, enter the following command and then press **Enter**.</span></span> <span data-ttu-id="1cfc3-180">Verrà creata una migrazione iniziale basata sul modello esistente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-180">An initial migration based on the existing model will be created.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample1.ps1)]

    <span data-ttu-id="1cfc3-181">![Abilitazione delle migrazioni](maintainable-azure-websites-managing-change-and-scale/_static/image1.png "Abilitare le migrazioni")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-181">![Enabling Migrations](maintainable-azure-websites-managing-change-and-scale/_static/image1.png "Enabling Migrations")</span></span>

    <span data-ttu-id="1cfc3-182">*Abilitazione delle migrazioni*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-182">*Enabling Migrations*</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-183">Questo comando aggiunge una cartella **Migrations** al progetto quiz geek che contiene un file denominato **Configuration.cs**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-183">This command adds a **Migrations** folder to Geek Quiz project that contains a file called **Configuration.cs**.</span></span> <span data-ttu-id="1cfc3-184">La classe di **configurazione** consente di configurare il comportamento delle migrazioni per il contesto.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-184">The **Configuration** class allows you to configure how Migrations behaves for your context.</span></span>
5. <span data-ttu-id="1cfc3-185">Con le migrazioni abilitate, è necessario aggiornare la classe di **configurazione** per popolare il database con i dati iniziali richiesti dal **quiz geek** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-185">With Migrations enabled, you need to update the **Configuration** class to populate the database with the initial data that **Geek Quiz** requires.</span></span> <span data-ttu-id="1cfc3-186">In **migrazioni**sostituire il file **Configuration.cs** con quello che si trova nella cartella **Source\Assets** di questo Lab.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-186">Under **Migrations**, replace the **Configuration.cs** file with the one located in the **Source\Assets** folder of this lab.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-187">Poiché le **migrazioni** chiameranno il metodo **Seed** a ogni aggiornamento del database, è necessario assicurarsi che i record non vengano duplicati nel database.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-187">Since **Migrations** will call the **Seed** method with every database update, you need to be sure that records are not duplicated in the database.</span></span> <span data-ttu-id="1cfc3-188">Il metodo **AddOrUpdate** consente di evitare i dati duplicati.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-188">The **AddOrUpdate** method will help to prevent duplicate data.</span></span>
6. <span data-ttu-id="1cfc3-189">Per aggiungere una migrazione iniziale, immettere il comando seguente e quindi premere **invio**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-189">To add an initial migration, enter the following command and then press **Enter**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-190">Assicurarsi che non sia presente alcun database denominato &quot;GeekQuizProd&quot; nell'istanza del database locale.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-190">Make sure that there is no database named &quot;GeekQuizProd&quot; in your LocalDB instance.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample2.ps1)]

    <span data-ttu-id="1cfc3-191">![Aggiunta della migrazione dello schema di base](maintainable-azure-websites-managing-change-and-scale/_static/image2.png "Aggiunta della migrazione dello schema di base")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-191">![Adding base schema migration](maintainable-azure-websites-managing-change-and-scale/_static/image2.png "Adding base schema migration")</span></span>

    <span data-ttu-id="1cfc3-192">*Aggiunta della migrazione dello schema di base*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-192">*Adding base schema migration*</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-193">L' **aggiunta** della migrazione effettuerà il patibolo della successiva migrazione in base alle modifiche apportate al modello dopo la creazione dell'ultima migrazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-193">**Add-Migration** will scaffold the next migration based on changes you have made to your model since the last migration was created.</span></span> <span data-ttu-id="1cfc3-194">In questo caso, poiché si tratta della prima migrazione del progetto, vengono aggiunti gli script per creare tutte le tabelle definite nella classe **TriviaContext** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-194">In this case, as it is the first migration of the project, it will add the scripts to create all the tables defined in the **TriviaContext** class.</span></span>
7. <span data-ttu-id="1cfc3-195">Eseguire la migrazione per aggiornare il database eseguendo il comando seguente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-195">Execute the migration to update the database by running the following command.</span></span> <span data-ttu-id="1cfc3-196">Per questo comando si specificherà il flag **verbose** per visualizzare le istruzioni SQL da applicare al database di destinazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-196">For this command you will specify the **Verbose** flag to view the SQL statements being applied to the target database.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample3.ps1)]

    <span data-ttu-id="1cfc3-197">![Creazione del database iniziale](maintainable-azure-websites-managing-change-and-scale/_static/image3.png "Creazione del database iniziale")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-197">![Creating initial database](maintainable-azure-websites-managing-change-and-scale/_static/image3.png "Creating initial database")</span></span>

    <span data-ttu-id="1cfc3-198">*Creazione del database iniziale*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-198">*Creating initial database*</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-199">**Update-database** applica tutte le migrazioni in sospeso al database.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-199">**Update-Database** will apply any pending migrations to the database.</span></span> <span data-ttu-id="1cfc3-200">In tal caso, verrà creato il database utilizzando la stringa di connessione definita nel file Web. config.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-200">In this case, it will create the database using the connection string defined in your web.config file.</span></span>
8. <span data-ttu-id="1cfc3-201">Passare al menu **Visualizza** e aprire **Esplora oggetti di SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-201">Go to **View** menu and open **SQL Server Object Explorer**.</span></span>

    <span data-ttu-id="1cfc3-202">![Apri in Esplora oggetti di SQL Server](maintainable-azure-websites-managing-change-and-scale/_static/image4.png "Apri in Esplora oggetti di SQL Server")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-202">![Open in SQL Server Object Explorer](maintainable-azure-websites-managing-change-and-scale/_static/image4.png "Open in SQL Server Object Explorer")</span></span>

    <span data-ttu-id="1cfc3-203">*Apri in Esplora oggetti di SQL Server*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-203">*Open in SQL Server Object Explorer*</span></span>
9. <span data-ttu-id="1cfc3-204">Nella finestra **Esplora oggetti di SQL Server** connettersi all'istanza del database locale facendo clic con il pulsante destro del mouse sul nodo **SQL Server** e selezionando l'opzione **Aggiungi SQL Server...** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-204">In the **SQL Server Object Explorer** window, connect to your LocalDB instance by right-clicking the **SQL Server** node and selecting **Add SQL Server...** option.</span></span>

    <span data-ttu-id="1cfc3-205">![Aggiunta di un'istanza di SQL Server](maintainable-azure-websites-managing-change-and-scale/_static/image5.png "Aggiunta di un'istanza di SQL Server")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-205">![Adding a SQL Server Instance](maintainable-azure-websites-managing-change-and-scale/_static/image5.png "Adding a SQL Server Instance")</span></span>

    <span data-ttu-id="1cfc3-206">*Aggiunta di un'istanza di SQL Server a Esplora oggetti di SQL Server*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-206">*Adding a SQL Server instance to SQL Server Object Explorer*</span></span>
10. <span data-ttu-id="1cfc3-207">Impostare il **nome del server** su (local DB *) \V11.0* e lasciare **l'autenticazione di Windows** come modalità di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-207">Set the **server name** to *(localdb)\v11.0* and leave **Windows Authentication** as your authentication mode.</span></span> <span data-ttu-id="1cfc3-208">Fare clic su **Connetti** per continuare.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-208">Click **Connect** to continue.</span></span>

    <span data-ttu-id="1cfc3-209">![Connessione al database locale](maintainable-azure-websites-managing-change-and-scale/_static/image6.png "Connessione al database locale")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-209">![Connecting to LocalDB](maintainable-azure-websites-managing-change-and-scale/_static/image6.png "Connecting to LocalDB")</span></span>

    <span data-ttu-id="1cfc3-210">*Connessione al database locale*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-210">*Connecting to LocalDB*</span></span>
11. <span data-ttu-id="1cfc3-211">Aprire il database **GeekQuizProd** ed espandere il nodo **tabelle** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-211">Open the **GeekQuizProd** database and expand the **Tables** node.</span></span> <span data-ttu-id="1cfc3-212">Come si può notare, il comando **Update-database** ha generato tutte le tabelle definite nella classe **TriviaContext** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-212">As you can see, the **Update-Database** command generated all the tables defined in the **TriviaContext** class.</span></span> <span data-ttu-id="1cfc3-213">Individuare il **dbo. Tabella TriviaQuestions** e apertura del nodo Columns.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-213">Locate the **dbo.TriviaQuestions** table and open the columns node.</span></span> <span data-ttu-id="1cfc3-214">Nell'attività successiva verrà aggiunta una nuova colonna a questa tabella e verrà aggiornato il database mediante le **migrazioni**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-214">In the next task, you will add a new column to this table and update the database using **Migrations**.</span></span>

    <span data-ttu-id="1cfc3-215">![Colonne domande trivia](maintainable-azure-websites-managing-change-and-scale/_static/image7.png "Colonne domande trivia")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-215">![Trivia Questions Columns](maintainable-azure-websites-managing-change-and-scale/_static/image7.png "Trivia Questions Columns")</span></span>

    <span data-ttu-id="1cfc3-216">*Colonne domande trivia*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-216">*Trivia Questions Columns*</span></span>

<a id="Ex1Task2"></a>
#### <a name="task-2--updating-database-schema-using-migrations"></a><span data-ttu-id="1cfc3-217">Attività 2: aggiornamento dello schema del database tramite migrazioni</span><span class="sxs-lookup"><span data-stu-id="1cfc3-217">Task 2 – Updating Database Schema Using Migrations</span></span>

<span data-ttu-id="1cfc3-218">In questa attività verranno utilizzati **migrazioni Code First di Entity Framework** per rilevare una modifica nel modello e generare il codice necessario per aggiornare il database.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-218">In this task, you will use **Entity Framework Code First Migrations** to detect a change in your model and generate the necessary code to update the database.</span></span> <span data-ttu-id="1cfc3-219">L'entità **TriviaQuestions** verrà aggiornata aggiungendovi una nuova proprietà.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-219">You will update the **TriviaQuestions** entity by adding a new property to it.</span></span> <span data-ttu-id="1cfc3-220">Sarà quindi possibile eseguire i comandi per creare una nuova migrazione per includere la nuova colonna nella tabella.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-220">Then you will run commands to create a new Migration to include the new column in the table.</span></span>

1. <span data-ttu-id="1cfc3-221">In **Esplora soluzioni**fare doppio clic sul file **TriviaQuestion.cs** che si trova nella cartella **Models** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-221">In **Solution Explorer**, double-click the **TriviaQuestion.cs** file located inside the **Models** folder.</span></span>
2. <span data-ttu-id="1cfc3-222">Aggiungere una nuova proprietà denominata **hint**, come illustrato nel frammento di codice seguente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-222">Add a new property named **Hint**, as shown in the following code snippet.</span></span>

    [!code-csharp[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample4.cs)]
3. <span data-ttu-id="1cfc3-223">Nella **console di gestione pacchetti**immettere il comando seguente e quindi premere **invio**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-223">In the **Package Manager Console**, enter the following command and then press **Enter**.</span></span> <span data-ttu-id="1cfc3-224">Verrà creata una nuova migrazione che riflette la modifica apportata al modello.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-224">A new migration will be created reflecting the change in our model.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample5.ps1)]

    <span data-ttu-id="1cfc3-225">![Aggiungi-migrazione](maintainable-azure-websites-managing-change-and-scale/_static/image8.png "Aggiungi-migrazione")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-225">![Add-Migration](maintainable-azure-websites-managing-change-and-scale/_static/image8.png "Add-Migration")</span></span>

    <span data-ttu-id="1cfc3-226">*Aggiungi-migrazione*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-226">*Add-Migration*</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-227">Un file di migrazione è costituito da due metodi, **in alto e in** **basso**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-227">A Migration file is composed of two methods, **Up** and **Down**.</span></span>
    >
    > - <span data-ttu-id="1cfc3-228">Il metodo **up** verrà usato per specificare le modifiche che la versione corrente dell'applicazione deve applicare al database.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-228">The **Up** method will be used to specify what changes the current version of our application need to apply to the database.</span></span>
    > - <span data-ttu-id="1cfc3-229">Il **basso** viene usato per invertire le modifiche aggiunte al metodo **up** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-229">The **Down** is used to reverse the changes we have added to the **Up** method.</span></span>
    >
    > <span data-ttu-id="1cfc3-230">Quando la migrazione del database aggiorna il database, verranno eseguite tutte le migrazioni nell'ordine di timestamp e solo quelle che non sono state utilizzate dall'ultimo aggiornamento (la \_tabella MigrationHistory tiene traccia delle migrazioni applicate).</span><span class="sxs-lookup"><span data-stu-id="1cfc3-230">When the Database Migration updates the database, it will run all migrations in the timestamp order, and only those that have not been used since the last update (The \_MigrationHistory table keeps track of which migrations have been applied).</span></span> <span data-ttu-id="1cfc3-231">Verrà chiamato il metodo **up** di tutte le migrazioni e verranno apportate le modifiche specificate al database.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-231">The **Up** method of all migrations will be called and will make the changes we have specified to the database.</span></span> <span data-ttu-id="1cfc3-232">Se si decide di tornare a una migrazione precedente, viene chiamato il metodo **Down** per ripristinare le modifiche in ordine inverso.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-232">If we decide to go back to a previous migration, the **Down** method will be called to redo the changes in a reverse order.</span></span>
4. <span data-ttu-id="1cfc3-233">Nella **console di gestione pacchetti**immettere il comando seguente e quindi premere **invio**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-233">In the **Package Manager Console**, enter the following command and then press **Enter**.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample6.ps1)]
5. <span data-ttu-id="1cfc3-234">L'output del comando **Update-database** ha generato un'istruzione **ALTER TABLE** SQL per aggiungere una nuova colonna alla tabella **TriviaQuestions** , come illustrato nell'immagine seguente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-234">The output of the **Update-Database** command generated an **Alter Table** SQL statement to add a new column to the **TriviaQuestions** table, as shown in the image below.</span></span>

    <span data-ttu-id="1cfc3-235">![Aggiunta istruzione SQL di colonna generata](maintainable-azure-websites-managing-change-and-scale/_static/image9.png "Aggiunta istruzione SQL di colonna generata")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-235">![Add column SQL statement generated](maintainable-azure-websites-managing-change-and-scale/_static/image9.png "Add column SQL statement generated")</span></span>

    <span data-ttu-id="1cfc3-236">*Aggiunta istruzione SQL di colonna generata*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-236">*Add column SQL statement generated*</span></span>
6. <span data-ttu-id="1cfc3-237">In **Esplora oggetti di SQL Server**aggiornare **dbo. Tabella TriviaQuestions** e verificare che venga visualizzata la nuova colonna **hint** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-237">In **SQL Server Object Explorer**, refresh the **dbo.TriviaQuestions** table and check that the new **Hint** column is displayed.</span></span>

    <span data-ttu-id="1cfc3-238">![Visualizzazione della nuova colonna hint](maintainable-azure-websites-managing-change-and-scale/_static/image10.png "Visualizzazione della nuova colonna hint")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-238">![Showing the new Hint Column](maintainable-azure-websites-managing-change-and-scale/_static/image10.png "Showing the new Hint Column")</span></span>

    <span data-ttu-id="1cfc3-239">*Visualizzazione della nuova colonna hint*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-239">*Showing the new Hint Column*</span></span>
7. <span data-ttu-id="1cfc3-240">Nell'editor di **TriviaQuestion.cs** aggiungere un vincolo **StringLength** alla proprietà *hint* , come illustrato nel frammento di codice seguente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-240">Back in the **TriviaQuestion.cs** editor, add a **StringLength** constraint to the *Hint* property, as shown in the following code snippet.</span></span>

    [!code-csharp[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample7.cs)]
8. <span data-ttu-id="1cfc3-241">Nella **console di gestione pacchetti**immettere il comando seguente e quindi premere **invio**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-241">In the **Package Manager Console**, enter the following command and then press **Enter**.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample8.ps1)]
9. <span data-ttu-id="1cfc3-242">Nella **console di gestione pacchetti**immettere il comando seguente e quindi premere **invio**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-242">In the **Package Manager Console**, enter the following command and then press **Enter**.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample9.ps1)]
10. <span data-ttu-id="1cfc3-243">L'output del comando **Update-database** ha generato un'istruzione **ALTER TABLE** SQL per aggiornare il tipo di colonna *hint* della tabella **TriviaQuestions** , come illustrato nell'immagine seguente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-243">The output of the **Update-Database** command generated an **Alter Table** SQL statement to update the *hint* column type of the **TriviaQuestions** table, as shown in the image below.</span></span>

    <span data-ttu-id="1cfc3-244">![Istruzione ALTER COLUMN SQL generata](maintainable-azure-websites-managing-change-and-scale/_static/image11.png "Istruzione ALTER COLUMN SQL generata")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-244">![Alter column SQL statement generated](maintainable-azure-websites-managing-change-and-scale/_static/image11.png "Alter column SQL statement generated")</span></span>

    <span data-ttu-id="1cfc3-245">*Istruzione ALTER COLUMN SQL generata*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-245">*Alter column SQL statement generated*</span></span>
11. <span data-ttu-id="1cfc3-246">In **Esplora oggetti di SQL Server**aggiornare **dbo. Tabella TriviaQuestions** e verificare che il tipo di colonna **hint** sia **nvarchar (150)** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-246">In **SQL Server Object Explorer**, refresh the **dbo.TriviaQuestions** table and check that the **Hint** column type is **nvarchar(150)**.</span></span>

    <span data-ttu-id="1cfc3-247">![Visualizzazione del nuovo vincolo](maintainable-azure-websites-managing-change-and-scale/_static/image12.png "Visualizzazione del nuovo vincolo")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-247">![Showing the new constraint](maintainable-azure-websites-managing-change-and-scale/_static/image12.png "Showing the new constraint")</span></span>

    <span data-ttu-id="1cfc3-248">*Visualizzazione del nuovo vincolo*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-248">*Showing the new constraint*</span></span>

<a id="Exercise2"></a>
### <a name="exercise-2-deploying-a-web-app-to-staging"></a><span data-ttu-id="1cfc3-249">Esercizio 2: distribuzione di un'app Web nella gestione temporanea</span><span class="sxs-lookup"><span data-stu-id="1cfc3-249">Exercise 2: Deploying a Web App to Staging</span></span>

<span data-ttu-id="1cfc3-250">**App Web nel servizio app Azure** consente di eseguire la pubblicazione di gestione temporanea.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-250">**Web Apps in Azure App Service** enables you to perform staged publishing.</span></span> <span data-ttu-id="1cfc3-251">La pubblicazione di gestione temporanea crea uno slot di sito di gestione temporanea per ogni sito di produzione predefinito e consente di scambiare questi slot senza tempo di inattività.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-251">Staged publishing creates a staging site slot for each default production site and enables you to swap these slots with no down time.</span></span> <span data-ttu-id="1cfc3-252">Questa operazione è molto utile per convalidare le modifiche prima del rilascio al pubblico, integrare in modo incrementale il contenuto del sito ed eseguire il rollback se le modifiche non funzionano come previsto.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-252">This is really useful to validate changes before releasing to the public, incrementally integrate site content, and roll back if changes are not working as expected.</span></span>

<span data-ttu-id="1cfc3-253">In questo esercizio verrà distribuita l'applicazione di **quiz per geek** nell'ambiente di gestione temporanea dell'app Web usando il controllo del codice sorgente git.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-253">In this exercise, you will deploy the **Geek Quiz** application to the staging environment of your web app using Git source control.</span></span> <span data-ttu-id="1cfc3-254">A tale scopo, si creerà l'app Web e si eseguirà il provisioning dei componenti necessari nel portale di gestione, si configurerà un repository **git** e si eseguirà il push del codice sorgente dell'applicazione dal computer locale allo slot di staging.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-254">To do this, you will create the web app and provision the required components at the management portal, configure a **Git** repository and push the application source code from your local computer to the staging slot.</span></span> <span data-ttu-id="1cfc3-255">Il database di produzione viene aggiornato anche con il **migrazioni Code First** creato nell'esercizio precedente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-255">You will also update your production database with the **Code First Migrations** you created in the previous exercise.</span></span> <span data-ttu-id="1cfc3-256">L'applicazione verrà quindi eseguita in questo ambiente di test per verificarne il funzionamento.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-256">You will then execute the application in this test environment to verify its operation.</span></span> <span data-ttu-id="1cfc3-257">Quando si è soddisfatti che funzioni secondo le proprie aspettative, l'applicazione verrà innalzata di livello alla produzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-257">Once you are satisfied that it is working according to your expectations, you will promote the application to production.</span></span>

> [!NOTE]
> <span data-ttu-id="1cfc3-258">Per abilitare la pubblicazione di gestione temporanea, l'app Web deve essere in **modalità standard**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-258">To enable staged publishing, the web app must be in **Standard mode**.</span></span> <span data-ttu-id="1cfc3-259">Si noti che verranno addebitati costi aggiuntivi se si modifica l'app Web in modalità standard.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-259">Note that additional charges will be incurred if you change your web app to Standard mode.</span></span> <span data-ttu-id="1cfc3-260">Per altre informazioni sui prezzi, vedere [prezzi del servizio app](https://azure.microsoft.com/pricing/details/app-service/).</span><span class="sxs-lookup"><span data-stu-id="1cfc3-260">For more information about pricing, see [App Service Pricing](https://azure.microsoft.com/pricing/details/app-service/).</span></span>

<a id="Ex2Task1"></a>
#### <a name="task-1--creating-a-web-app-in-azure-app-service"></a><span data-ttu-id="1cfc3-261">Attività 1: creazione di un'app Web nel servizio app Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-261">Task 1 – Creating a Web App in Azure App Service</span></span>

<span data-ttu-id="1cfc3-262">In questa attività verrà creata un'app Web nel **servizio app Azure** dal portale di gestione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-262">In this task, you will create a web app in **Azure App Service** from the management portal.</span></span> <span data-ttu-id="1cfc3-263">Sarà inoltre possibile configurare un **database SQL** per salvare in modo permanente i dati dell'applicazione e configurare un repository git locale per il controllo del codice sorgente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-263">You will also configure a **SQL Database** to persist the application data, and configure a local Git repository for source control.</span></span>

1. <span data-ttu-id="1cfc3-264">Passare al [portale di gestione di Azure](https://manage.windowsazure.com) e accedere usando il account Microsoft associato alla sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-264">Go to the [Azure management portal](https://manage.windowsazure.com) and sign in using the Microsoft account associated with your subscription.</span></span>

    ![Accedere al portale di gestione di Azure](maintainable-azure-websites-managing-change-and-scale/_static/image13.png)

    <span data-ttu-id="1cfc3-266">*Accedere al portale di gestione di Azure*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-266">*Sign in to the Azure management portal*</span></span>
2. <span data-ttu-id="1cfc3-267">Fare clic su **nuovo** nella barra dei comandi nella parte inferiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-267">Click **New** in the command bar at the bottom of the page.</span></span>

    <span data-ttu-id="1cfc3-268">![Creazione di una nuova app Web](maintainable-azure-websites-managing-change-and-scale/_static/image14.png "Creazione di una nuova app Web")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-268">![Creating a new web app](maintainable-azure-websites-managing-change-and-scale/_static/image14.png "Creating a new web app")</span></span>

    <span data-ttu-id="1cfc3-269">*Creazione di una nuova app Web*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-269">*Creating a new web app*</span></span>
3. <span data-ttu-id="1cfc3-270">Fare clic su **calcolo**, **sito Web** e quindi **su creazione personalizzata**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-270">Click **Compute**, **Website** and then **Custom Create**.</span></span>

    <span data-ttu-id="1cfc3-271">![Creazione di una nuova app Web con creazione personalizzata](maintainable-azure-websites-managing-change-and-scale/_static/image15.png "Creazione di una nuova app Web con creazione personalizzata")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-271">![Creating a new web app using Custom Create](maintainable-azure-websites-managing-change-and-scale/_static/image15.png "Creating a new web app using Custom Create")</span></span>

    <span data-ttu-id="1cfc3-272">*Creazione di una nuova app Web con creazione personalizzata*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-272">*Creating a new web app using Custom Create*</span></span>
4. <span data-ttu-id="1cfc3-273">Nella finestra di dialogo **nuovo sito web-creazione personalizzata** specificare un **URL** disponibile, ad esempio *Geek-quiz*, selezionare un percorso nell'elenco a discesa **regione** e selezionare **Crea un nuovo database SQL** nell'elenco a discesa **database** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-273">In the **New Website - Custom Create** dialog box, provide an available **URL** (e.g. *geek-quiz*), select a location in the **Region** drop-down list, and select **Create a new SQL database** in the **Database** drop-down list.</span></span> <span data-ttu-id="1cfc3-274">Infine, selezionare la casella **di controllo pubblica dal controllo del codice sorgente** e fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-274">Finally, select the **Publish from source control** check box and click **Next**.</span></span>

    ![Personalizzazione della nuova app Web](maintainable-azure-websites-managing-change-and-scale/_static/image16.png)

    <span data-ttu-id="1cfc3-276">*Personalizzazione della nuova app Web*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-276">*Customizing the new web app*</span></span>
5. <span data-ttu-id="1cfc3-277">Specificare le informazioni seguenti per le impostazioni del database:</span><span class="sxs-lookup"><span data-stu-id="1cfc3-277">Specify the following information for the database settings:</span></span>

   - <span data-ttu-id="1cfc3-278">Nella casella di testo **nome** immettere un nome di database, ad esempio *geekquiz\_DB*)</span><span class="sxs-lookup"><span data-stu-id="1cfc3-278">In the **Name** text box, enter a database name (e.g. *geekquiz\_db*)</span></span>
   - <span data-ttu-id="1cfc3-279">Nell'elenco a **discesa** server selezionare **nuovo server di database SQL**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-279">In the Server **drop-down** list, select **New SQL database server**.</span></span> <span data-ttu-id="1cfc3-280">In alternativa, è possibile selezionare un server esistente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-280">Alternatively, you can select an existing server.</span></span>
   - <span data-ttu-id="1cfc3-281">Nelle caselle **nome utente database** e **password database** immettere il nome utente e la password dell'amministratore per il server di database SQL.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-281">In the **Database username** and **Database password** boxes, enter the administrator username and password for the SQL database server.</span></span> <span data-ttu-id="1cfc3-282">Se si seleziona un server già creato, verrà richiesto di immettere la password.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-282">If you select a server you have already created, you will be prompted for the password.</span></span>

     ![Specifica delle impostazioni del database](maintainable-azure-websites-managing-change-and-scale/_static/image17.png)

     <span data-ttu-id="1cfc3-284">*Specifica delle impostazioni del database*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-284">*Specifying the database settings*</span></span>
6. <span data-ttu-id="1cfc3-285">Fare clic su **Avanti** per continuare.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-285">Click **Next** to continue.</span></span>
7. <span data-ttu-id="1cfc3-286">Selezionare **repository git locale** per il controllo del codice sorgente da usare e fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-286">Select **Local Git repository** for the source control to use and click **Next**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-287">È possibile che vengano richieste le credenziali di distribuzione, ovvero un nome utente e una password.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-287">You may be prompted for the deployment credentials (a username and password).</span></span>

    ![Creazione del repository git](maintainable-azure-websites-managing-change-and-scale/_static/image18.png)

    <span data-ttu-id="1cfc3-289">*Creazione del repository git*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-289">*Creating the Git repository*</span></span>
8. <span data-ttu-id="1cfc3-290">Attendere fino a quando non viene creata la nuova app Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-290">Wait until the new web app is created.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-291">Per impostazione predefinita, Azure offre domini in *azurewebsites.NET* , ma offre anche la possibilità di impostare domini personalizzati tramite il portale di gestione di Azure.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-291">By default, Azure provides domains at *azurewebsites.net* but also gives you the possibility to set custom domains using the Azure management portal.</span></span> <span data-ttu-id="1cfc3-292">Tuttavia, è possibile gestire domini personalizzati solo se si usano determinate modalità di servizio app Azure.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-292">However, you can only manage custom domains if you are using certain Azure App Service modes.</span></span>
    >
    > <span data-ttu-id="1cfc3-293">Il servizio app Azure è disponibile nelle edizioni Free, Shared, Basic, standard e Premium.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-293">Azure App Service is available in Free, Shared, Basic, Standard, and Premium editions.</span></span> <span data-ttu-id="1cfc3-294">In modalità gratuita e condivisa tutte le app Web vengono eseguite in un ambiente multi-tenant e hanno quote per la CPU, la memoria e l'utilizzo della rete.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-294">In Free and Shared mode, all web apps run in a multi-tenant environment and have quotas for CPU, Memory, and Network usage.</span></span> <span data-ttu-id="1cfc3-295">Il numero massimo di app gratuite può variare a seconda del piano.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-295">The maximum number of free apps may vary with your plan.</span></span> <span data-ttu-id="1cfc3-296">In modalità standard è possibile scegliere quali app vengono eseguite in macchine virtuali dedicate che corrispondono alle risorse di calcolo di Azure standard.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-296">In Standard mode, you choose which apps run on dedicated virtual machines that correspond to the standard Azure compute resources.</span></span> <span data-ttu-id="1cfc3-297">È possibile trovare la configurazione della modalità app Web nel menu **scalabilità** dell'app Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-297">You can find the web app mode configuration in the **Scale** menu of your web app.</span></span>
    >
    > <span data-ttu-id="1cfc3-298">![Modalità servizio app Azure](maintainable-azure-websites-managing-change-and-scale/_static/image19.png "Modalità servizio app Azure")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-298">![Azure App Service Modes](maintainable-azure-websites-managing-change-and-scale/_static/image19.png "Azure App Service Modes")</span></span>
    >
    > <span data-ttu-id="1cfc3-299">Se si usa la modalità **condivisa** o **standard** , sarà possibile gestire i domini personalizzati per l'app Web passando al menu di **configurazione** dell'app e facendo clic su **Gestisci domini** in *nomi di dominio*.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-299">If you are using **Shared** or **Standard** mode, you will be able to manage custom domains for your web app by going to your app's **Configure** menu and clicking **Manage Domains** under *domain names*.</span></span>
    >
    > <span data-ttu-id="1cfc3-300">![Gestisci domini](maintainable-azure-websites-managing-change-and-scale/_static/image20.png "Gestisci domini")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-300">![Manage Domains](maintainable-azure-websites-managing-change-and-scale/_static/image20.png "Manage Domains")</span></span>
    >
    > <span data-ttu-id="1cfc3-301">![Gestire domini personalizzati](maintainable-azure-websites-managing-change-and-scale/_static/image21.png "Gestire domini personalizzati")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-301">![Manage Custom Domains](maintainable-azure-websites-managing-change-and-scale/_static/image21.png "Manage Custom Domains")</span></span>
9. <span data-ttu-id="1cfc3-302">Una volta creata l'app Web, fare clic sul collegamento nella colonna **URL** per verificare che la nuova app Web sia in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-302">Once the web app is created, click the link under the **URL** column to check that the new web app is running.</span></span>

    ![Esplorazione della nuova app Web](maintainable-azure-websites-managing-change-and-scale/_static/image22.png)

    <span data-ttu-id="1cfc3-304">*Esplorazione della nuova app Web*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-304">*Browsing to the new web app*</span></span>

    ![app Web in esecuzione](maintainable-azure-websites-managing-change-and-scale/_static/image23.png)

    <span data-ttu-id="1cfc3-306">*app Web in esecuzione*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-306">*web app running*</span></span>

<a id="Ex2Task2"></a>
#### <a name="task-2--creating-the-production-sql-database"></a><span data-ttu-id="1cfc3-307">Attività 2: creazione del database SQL di produzione</span><span class="sxs-lookup"><span data-stu-id="1cfc3-307">Task 2 – Creating the Production SQL Database</span></span>

<span data-ttu-id="1cfc3-308">In questa attività si userà il **migrazioni Code First di Entity Framework** per creare il database destinato all'istanza del **database SQL di Azure** creata nell'attività precedente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-308">In this task, you will use the **Entity Framework Code First Migrations** to create the database targeting the **Azure SQL Database** instance you created in the previous task.</span></span>

1. <span data-ttu-id="1cfc3-309">Nella portale di gestione passare all'app Web creata nell'attività precedente e passare al relativo **Dashboard**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-309">In the Management Portal, navigate to the web app you created in the previous task and go to its **Dashboard**.</span></span>
2. <span data-ttu-id="1cfc3-310">Nella pagina **Dashboard** fare clic sul collegamento **Visualizza stringhe di connessione** nella sezione **Quick Glance** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-310">In the **Dashboard** page, click **View connection strings** link under the **quick glance** section.</span></span>

    <span data-ttu-id="1cfc3-311">![Visualizza stringhe di connessione](maintainable-azure-websites-managing-change-and-scale/_static/image24.png "Visualizza stringhe di connessione")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-311">![View connection strings](maintainable-azure-websites-managing-change-and-scale/_static/image24.png "View connection strings")</span></span>

    <span data-ttu-id="1cfc3-312">*Visualizza stringhe di connessione*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-312">*View connection strings*</span></span>
3. <span data-ttu-id="1cfc3-313">Copiare il valore della **stringa di connessione** e chiudere la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-313">Copy the **connection string** value and close the dialog box.</span></span>

    <span data-ttu-id="1cfc3-314">![Stringa di connessione in portale di gestione di Azure](maintainable-azure-websites-managing-change-and-scale/_static/image25.png "Stringa di connessione in portale di gestione di Azure")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-314">![Connection String in Azure Management Portal](maintainable-azure-websites-managing-change-and-scale/_static/image25.png "Connection String in Azure Management Portal")</span></span>

    <span data-ttu-id="1cfc3-315">*Stringa di connessione in portale di gestione di Azure*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-315">*Connection String in Azure Management Portal*</span></span>
4. <span data-ttu-id="1cfc3-316">Fare clic su **database SQL** per visualizzare l'elenco dei database SQL in Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-316">Click **SQL Databases** to see the list of SQL databases in Azure</span></span>

    <span data-ttu-id="1cfc3-317">![Menu database SQL](maintainable-azure-websites-managing-change-and-scale/_static/image26.png "Menu database SQL")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-317">![SQL Database menu](maintainable-azure-websites-managing-change-and-scale/_static/image26.png "SQL Database menu")</span></span>

    <span data-ttu-id="1cfc3-318">*Menu database SQL*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-318">*SQL Database menu*</span></span>
5. <span data-ttu-id="1cfc3-319">Individuare il database creato nell'attività precedente e fare clic sul server.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-319">Locate the database you created in the previous task and click on the Server.</span></span>

    <span data-ttu-id="1cfc3-320">![Server di database SQL](maintainable-azure-websites-managing-change-and-scale/_static/image27.png "Server di database SQL")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-320">![SQL Database server](maintainable-azure-websites-managing-change-and-scale/_static/image27.png "SQL Database server")</span></span>

    <span data-ttu-id="1cfc3-321">*Server di database SQL*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-321">*SQL Database server*</span></span>
6. <span data-ttu-id="1cfc3-322">Nella pagina **avvio rapido** del server fare clic su **Configura**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-322">In the **Quick Start** page of the server, click on **Configure**.</span></span>

    <span data-ttu-id="1cfc3-323">![Menu Configura](maintainable-azure-websites-managing-change-and-scale/_static/image28.png "Menu Configura")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-323">![Configure menu](maintainable-azure-websites-managing-change-and-scale/_static/image28.png "Configure menu")</span></span>

    <span data-ttu-id="1cfc3-324">*Menu Configura*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-324">*Configure menu*</span></span>
7. <span data-ttu-id="1cfc3-325">Nella sezione **indirizzi IP consentiti** fare clic su **Aggiungi al collegamento indirizzi IP consentiti** per abilitare l'indirizzo IP per la connessione al server di database SQL.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-325">In the **Allowed IP addresses** section, click on **Add to the allowed IP addresses** link to enable your IP to connect to the SQL Database server.</span></span>

    <span data-ttu-id="1cfc3-326">![Indirizzi IP consentiti](maintainable-azure-websites-managing-change-and-scale/_static/image29.png "Indirizzi IP consentiti")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-326">![Allowed IP addresses](maintainable-azure-websites-managing-change-and-scale/_static/image29.png "Allowed IP addresses")</span></span>

    <span data-ttu-id="1cfc3-327">*Indirizzi IP consentiti*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-327">*Allowed IP addresses*</span></span>
8. <span data-ttu-id="1cfc3-328">Per completare il passaggio, fare clic su **Save** nella parte inferiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-328">Click **Save** at the bottom of the page to complete the step.</span></span>
9. <span data-ttu-id="1cfc3-329">Tornare a Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-329">Switch back to Visual Studio.</span></span>
10. <span data-ttu-id="1cfc3-330">Nella **console di gestione pacchetti**eseguire il comando seguente sostituendo il segnaposto *[your-Connection-String]* con la stringa di connessione copiata da Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-330">In the **Package Manager Console**, execute the following command replacing *[YOUR-CONNECTION-STRING]* placeholder with the connection string you copied from Azure</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample10.ps1)]

    <span data-ttu-id="1cfc3-331">![Aggiornare il database per il database SQL di Windows Azure](maintainable-azure-websites-managing-change-and-scale/_static/image30.png "Aggiornare il database per il database SQL di Windows Azure")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-331">![Update database targeting Windows Azure SQL Database](maintainable-azure-websites-managing-change-and-scale/_static/image30.png "Update database targeting Windows Azure SQL Database")</span></span>

    <span data-ttu-id="1cfc3-332">*Aggiornare il database con destinazione database SQL di Azure*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-332">*Update database targeting Azure SQL Database*</span></span>

<a id="Ex2Task3"></a>
#### <a name="task-3--deploying-geek-quiz-to-staging-using-git"></a><span data-ttu-id="1cfc3-333">Attività 3: distribuzione del quiz geek nella gestione temporanea con git</span><span class="sxs-lookup"><span data-stu-id="1cfc3-333">Task 3 – Deploying Geek Quiz to Staging Using Git</span></span>

<span data-ttu-id="1cfc3-334">In questa attività verrà abilitata la pubblicazione di gestione temporanea nell'app Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-334">In this task, you will enable staged publishing in your web app.</span></span> <span data-ttu-id="1cfc3-335">Si userà quindi git per pubblicare l'applicazione di quiz per geek direttamente dal computer locale nell'ambiente di gestione temporanea dell'app Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-335">Then, you will use Git to publish the Geek Quiz application directly from your local computer to the staging environment of your web app.</span></span>

1. <span data-ttu-id="1cfc3-336">Tornare al portale e fare clic sul nome dell'app Web nella colonna **nome** per visualizzare le pagine di gestione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-336">Go back to the portal and click the name of the web app under the **Name** column to display the management pages.</span></span>

    ![Apertura delle pagine di gestione delle app Web](maintainable-azure-websites-managing-change-and-scale/_static/image31.png)

    <span data-ttu-id="1cfc3-338">*Apertura delle pagine di gestione delle app Web*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-338">*Opening the web app management pages*</span></span>
2. <span data-ttu-id="1cfc3-339">Passare alla pagina **scala** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-339">Navigate to the **Scale** page.</span></span> <span data-ttu-id="1cfc3-340">Nella sezione **generale** selezionare **standard** per la configurazione e fare clic su **Salva** nella barra dei comandi.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-340">Under the **general** section, select **Standard** for the configuration and click **Save** in the command bar.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-341">Per eseguire tutte le app Web nell'area e nella sottoscrizione correnti in modalità **standard** , lasciare selezionata la casella di controllo **Seleziona tutto** nella configurazione **scegliere i siti** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-341">To run all web apps in the current region and subscription in **Standard** mode, leave the **Select All** check box selected in the **Choose Sites** configuration.</span></span> <span data-ttu-id="1cfc3-342">In caso contrario, deselezionare la casella di controllo **Seleziona tutto** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-342">Otherwise, clear the **Select All** check box.</span></span>

    <span data-ttu-id="1cfc3-343">![Aggiornamento dell'app Web alla modalità standard](maintainable-azure-websites-managing-change-and-scale/_static/image32.png "Aggiornamento dell'app Web alla modalità standard")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-343">![Upgrading the web app to Standard mode](maintainable-azure-websites-managing-change-and-scale/_static/image32.png "Upgrading the web app to Standard mode")</span></span>

    <span data-ttu-id="1cfc3-344">*Aggiornamento dell'app Web alla modalità standard*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-344">*Upgrading the Web App to Standard mode*</span></span>
3. <span data-ttu-id="1cfc3-345">Fare clic su **Sì** per confermare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-345">Click **Yes** to confirm the changes.</span></span>

    <span data-ttu-id="1cfc3-346">![Conferma della modifica alla modalità standard](maintainable-azure-websites-managing-change-and-scale/_static/image33.png "Continuazione con la modifica della modalità app Web")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-346">![Confirming the change to Standard mode](maintainable-azure-websites-managing-change-and-scale/_static/image33.png "Continuing with the changing of the web app mode")</span></span>

    <span data-ttu-id="1cfc3-347">*Conferma della modifica alla modalità standard*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-347">*Confirming the change to Standard mode*</span></span>
4. <span data-ttu-id="1cfc3-348">Passare alla pagina **Dashboard** e fare clic su **Abilita pubblicazione temporanea** nella sezione **Riepilogo rapido** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-348">Go to the **Dashboard** page and click **Enable staged publishing** under the **quick glance** section.</span></span>

    <span data-ttu-id="1cfc3-349">![Abilitazione della pubblicazione di gestione temporanea](maintainable-azure-websites-managing-change-and-scale/_static/image34.png "Abilitazione della pubblicazione di gestione temporanea")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-349">![Enabling staged publishing](maintainable-azure-websites-managing-change-and-scale/_static/image34.png "Enabling staged publishing")</span></span>

    <span data-ttu-id="1cfc3-350">*Abilitazione della pubblicazione di gestione temporanea*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-350">*Enabling staged publishing*</span></span>
5. <span data-ttu-id="1cfc3-351">Fare clic su **Sì** per abilitare la pubblicazione di gestione temporanea.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-351">Click **Yes** to enable staged publishing.</span></span>

    <span data-ttu-id="1cfc3-352">![Conferma della pubblicazione di gestione temporanea](maintainable-azure-websites-managing-change-and-scale/_static/image35.png "Fare clic su Sì per abilitare la pubblicazione di gestione temporanea")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-352">![Confirming staged publishing](maintainable-azure-websites-managing-change-and-scale/_static/image35.png "Clicking Yes to enable staged publishing")</span></span>

    <span data-ttu-id="1cfc3-353">*Conferma della pubblicazione di gestione temporanea*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-353">*Confirming staged publishing*</span></span>
6. <span data-ttu-id="1cfc3-354">Nell'elenco di app Web espandere il contrassegno a sinistra del nome dell'app Web per visualizzare lo slot del sito di gestione temporanea.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-354">In the list of web apps, expand the mark to the left of your web app name to display the staging site slot.</span></span> <span data-ttu-id="1cfc3-355">Il nome dell'app Web è seguito da ***(staging)***.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-355">It has the name of your web app followed by ***(staging)***.</span></span> <span data-ttu-id="1cfc3-356">Fare clic sul sito di gestione temporanea per passare alla pagina di gestione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-356">Click the staging site to go to the management page.</span></span>

    <span data-ttu-id="1cfc3-357">![Spostamento nell'app Web di staging](maintainable-azure-websites-managing-change-and-scale/_static/image36.png "Spostamento nell'app Web di staging")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-357">![Navigating to the staging web app](maintainable-azure-websites-managing-change-and-scale/_static/image36.png "Navigating to the staging web app")</span></span>

    <span data-ttu-id="1cfc3-358">*Spostamento nell'app di staging*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-358">*Navigating to the staging app*</span></span>
7. <span data-ttu-id="1cfc3-359">Si noti che la pagina di gestione è simile a qualsiasi altra pagina di gestione dell'app Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-359">Notice that he management page looks like any other web app's management page.</span></span> <span data-ttu-id="1cfc3-360">Passare alla pagina **distribuzioni** e copiare il valore di **URL git** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-360">Navigate to the **Deployments** page and copy the **Git URL** value.</span></span> <span data-ttu-id="1cfc3-361">Che verrà usato più avanti in questo esercizio.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-361">You will use it later in this exercise.</span></span>

    ![Copia del valore dell'URL git](maintainable-azure-websites-managing-change-and-scale/_static/image37.png)

    <span data-ttu-id="1cfc3-363">*Copia del valore dell'URL git*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-363">*Copying the Git URL value*</span></span>
8. <span data-ttu-id="1cfc3-364">Aprire una nuova console **git bash** ed eseguire i comandi seguenti.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-364">Open a new **Git Bash** console and execute the following commands.</span></span> <span data-ttu-id="1cfc3-365">Aggiornare il segnaposto *[Your-Application-Path]* con il percorso della soluzione **GeekQuiz** , che si trova nella cartella **Source\Ex1-DeployingWebSiteToStaging\Begin** di questo Lab.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-365">Update the *[YOUR-APPLICATION-PATH]* placeholder with the path to the **GeekQuiz** solution, located in the **Source\Ex1-DeployingWebSiteToStaging\Begin** folder of this lab.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample11.cmd)]

    ![Inizializzazione git e primo commit](maintainable-azure-websites-managing-change-and-scale/_static/image38.png)

    <span data-ttu-id="1cfc3-367">*Inizializzazione git e primo commit*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-367">*Git initialization and first commit*</span></span>
9. <span data-ttu-id="1cfc3-368">Eseguire il comando seguente per effettuare il push dell'app Web nel repository **git** remoto.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-368">Run the following command to push your web app to the remote **Git** repository.</span></span> <span data-ttu-id="1cfc3-369">Sostituire il segnaposto con l'URL ottenuto dal portale di gestione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-369">Replace the placeholder with the URL you obtained from the management portal.</span></span> <span data-ttu-id="1cfc3-370">Verrà richiesto di specificare la password per la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-370">You will be prompted for your deployment password.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample12.cmd)]

    ![Push in Windows Azure](maintainable-azure-websites-managing-change-and-scale/_static/image39.png)

    <span data-ttu-id="1cfc3-372">*Push in Azure*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-372">*Pushing to Azure*</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-373">Quando si distribuisce il contenuto nell'host FTP o nell'archivio GIT di un'app Web, è necessario eseguire l'autenticazione usando le **credenziali di distribuzione** create dalle pagine di gestione **avvio rapido** o **Dashboard** dell'app Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-373">When you deploy content to the FTP host or GIT repository of a web app, you must authenticate using the **deployment credentials** that you created from the web app's **Quick Start** or **Dashboard** management pages.</span></span> <span data-ttu-id="1cfc3-374">Se non si conoscono le credenziali di distribuzione, è possibile reimpostarle facilmente tramite il portale di gestione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-374">If you do not know your deployment credentials you can easily reset them using the management portal.</span></span> <span data-ttu-id="1cfc3-375">Aprire la pagina **Dashboard** dell'app Web e fare clic sul collegamento **Reimposta le credenziali di distribuzione** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-375">Open the web app **Dashboard** page and click the **Reset your deployment credentials** link.</span></span> <span data-ttu-id="1cfc3-376">Specificare una nuova password e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-376">Provide a new password and click **OK**.</span></span> <span data-ttu-id="1cfc3-377">Le credenziali di distribuzione sono valide per l'uso con tutte le app Web associate alla sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-377">Deployment credentials are valid for use with all web apps associated with your subscription.</span></span>
10. <span data-ttu-id="1cfc3-378">Per verificare che l'app Web sia stata inserita correttamente in Azure, tornare al portale di gestione e fare clic su **siti Web**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-378">In order to verify the web app was successfully pushed to Azure, go back to the management portal and click **Websites**.</span></span>
11. <span data-ttu-id="1cfc3-379">Individuare l'app Web ed espandere la voce per visualizzare lo slot del sito di gestione temporanea.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-379">Locate your web app and expand the entry to display the staging site slot.</span></span> <span data-ttu-id="1cfc3-380">Fare clic sul **nome** per passare alla pagina di gestione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-380">Click its **Name** to go to the management page.</span></span>
12. <span data-ttu-id="1cfc3-381">Fare clic su **distribuzioni** per visualizzare la **cronologia di distribuzione**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-381">Click **Deployments** to see the **deployment history**.</span></span> <span data-ttu-id="1cfc3-382">Verificare che sia presente una **distribuzione attiva** con il *&quot;&quot;di commit iniziale* .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-382">Verify that there is an **Active Deployment** with your *&quot;Initial Commit&quot;*.</span></span>

    ![Distribuzione attiva](maintainable-azure-websites-managing-change-and-scale/_static/image40.png)

    <span data-ttu-id="1cfc3-384">*Distribuzione attiva*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-384">*Active deployment*</span></span>
13. <span data-ttu-id="1cfc3-385">Infine, fare clic su **Sfoglia** nella barra dei comandi per passare all'app Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-385">Finally, click **Browse** in the command bar to go to the web app.</span></span>

    ![Esplora app Web](maintainable-azure-websites-managing-change-and-scale/_static/image41.png)

    <span data-ttu-id="1cfc3-387">*Esplora app Web*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-387">*Browse web app*</span></span>
14. <span data-ttu-id="1cfc3-388">Se l'applicazione viene distribuita correttamente, verrà visualizzata la pagina di accesso al quiz geek.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-388">If the application is successfully deployed, you will see the Geek Quiz login page.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-389">L'URL dell'indirizzo dell'applicazione distribuita contiene il nome dell'app Web seguita da *-staging*.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-389">The address URL of the deployed application contains the name of your web app followed by *-staging*.</span></span>

    ![Applicazione in esecuzione nell'ambiente di gestione temporanea](maintainable-azure-websites-managing-change-and-scale/_static/image42.png)

    <span data-ttu-id="1cfc3-391">*Applicazione in esecuzione nell'ambiente di gestione temporanea*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-391">*Application running in the staging environment*</span></span>
15. <span data-ttu-id="1cfc3-392">Se si desidera esplorare l'applicazione, fare clic su **registra** per registrare un nuovo utente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-392">If you wish to explore the application, click **Register** to register a new user.</span></span> <span data-ttu-id="1cfc3-393">Per completare i dettagli dell'account, immettere un nome utente, un indirizzo di posta elettronica e una password.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-393">Complete the account details by entering a user name, email address and password.</span></span> <span data-ttu-id="1cfc3-394">Successivamente, l'applicazione mostra la prima domanda del quiz.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-394">Next, the application shows the first question of the quiz.</span></span> <span data-ttu-id="1cfc3-395">Rispondere ad alcune domande per assicurarsi che funzioni come previsto.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-395">Answer a few questions to make sure it is working as expected.</span></span>

    ![Applicazione pronta per l'uso](maintainable-azure-websites-managing-change-and-scale/_static/image43.png)

    <span data-ttu-id="1cfc3-397">*Applicazione pronta per l'uso*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-397">*Application ready to be used*</span></span>

<a id="Ex2Task4"></a>
#### <a name="task-4--promoting-the-web-app-to-production"></a><span data-ttu-id="1cfc3-398">Attività 4: promozione dell'app Web nell'ambiente di produzione</span><span class="sxs-lookup"><span data-stu-id="1cfc3-398">Task 4 – Promoting the Web App to Production</span></span>

<span data-ttu-id="1cfc3-399">Ora che è stato verificato che l'app Web funziona correttamente nell'ambiente di gestione temporanea, è possibile promuoverla alla produzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-399">Now that you have verified that the web app is working correctly in the staging environment, you are ready to promote it to production.</span></span> <span data-ttu-id="1cfc3-400">In questa attività lo slot del sito di staging verrà scambiato con lo slot del sito di produzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-400">In this task, you will swap the staging site slot with the production site slot.</span></span>

1. <span data-ttu-id="1cfc3-401">Tornare al portale di gestione e selezionare lo slot del sito di staging.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-401">Go back to the management portal and select the staging site slot.</span></span> <span data-ttu-id="1cfc3-402">Fare clic su **swap** sulla barra dei comandi.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-402">Click **Swap** in the command bar.</span></span>

    ![Scambia in ambiente di produzione](maintainable-azure-websites-managing-change-and-scale/_static/image44.png)

    <span data-ttu-id="1cfc3-404">*Scambia in ambiente di produzione*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-404">*Swap to production*</span></span>
2. <span data-ttu-id="1cfc3-405">Fare clic su **Sì** nella finestra di dialogo di conferma per procedere con l'operazione di scambio.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-405">Click **Yes** in the confirmation dialog box to proceed with the swap operation.</span></span> <span data-ttu-id="1cfc3-406">Azure scambierà immediatamente il contenuto del sito di produzione con il contenuto del sito di gestione temporanea.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-406">Azure will immediately swap the content of the production site with the content of the staging site.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-407">Alcune impostazioni della versione di staging verranno copiate automaticamente nella versione di produzione (ad esempio, override della stringa di connessione, mapping del gestore e così via), ma altre impostazioni non verranno modificate, ad esempio gli endpoint DNS, le associazioni SSL e così via.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-407">Some settings from the staged version will automatically be copied to the production version (e.g. connection string overrides, handler mappings, etc.) but other settings will not change (e.g. DNS endpoints, SSL bindings, etc.).</span></span>

    ![Conferma operazione di scambio](maintainable-azure-websites-managing-change-and-scale/_static/image45.png)

    <span data-ttu-id="1cfc3-409">*Conferma operazione di scambio*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-409">*Confirming swap operation*</span></span>
3. <span data-ttu-id="1cfc3-410">Al termine dello scambio, selezionare lo slot di produzione e fare clic su **Sfoglia** nella barra dei comandi per aprire il sito di produzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-410">Once the swap is complete, select the production slot and click **Browse** in the command bar to open the production site.</span></span> <span data-ttu-id="1cfc3-411">Si noti l'URL nella barra degli indirizzi.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-411">Notice the URL in the address bar.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-412">Potrebbe essere necessario aggiornare il browser per cancellare la cache.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-412">You might need to refresh your browser to clear cache.</span></span> <span data-ttu-id="1cfc3-413">In Internet Explorer è possibile eseguire questa operazione premendo **CTRL + R**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-413">In Internet Explorer, you can do this by pressing **CTRL+R**.</span></span>

    ![App Web in esecuzione nell'ambiente di produzione](maintainable-azure-websites-managing-change-and-scale/_static/image46.png)
4. <span data-ttu-id="1cfc3-415">Nella console di **GitBash** aggiornare l'URL remoto per il repository git locale in modo che abbia come destinazione lo slot di produzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-415">In the **GitBash** console, update the remote URL for the local Git repository to target the production slot.</span></span> <span data-ttu-id="1cfc3-416">A tale scopo, eseguire il comando seguente sostituendo i segnaposto con il nome utente della distribuzione e il nome dell'app Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-416">To do this, run the following command replacing the placeholders with your deployment username and the name of your web app.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-417">Negli esercizi seguenti si eseguirà il push delle modifiche al sito di produzione anziché alla gestione temporanea solo per la semplicità del Lab.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-417">In the following exercises, you will push changes to the production site instead of staging just for the simplicity of the lab.</span></span> <span data-ttu-id="1cfc3-418">In uno scenario reale, è consigliabile verificare le modifiche nell'ambiente di gestione temporanea prima di innalzare di livello alla produzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-418">In a real-world scenario, it is recommended to verify the changes in the staging environment before promoting to production.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample13.cmd)]

<a id="Exercise3"></a>
### <a name="exercise-3-performing-deployment-rollback-in-production"></a><span data-ttu-id="1cfc3-419">Esercizio 3: esecuzione del rollback della distribuzione nell'ambiente di produzione</span><span class="sxs-lookup"><span data-stu-id="1cfc3-419">Exercise 3: Performing Deployment Rollback in Production</span></span>

<span data-ttu-id="1cfc3-420">Esistono scenari in cui non è disponibile uno slot di staging per eseguire lo scambio a caldo tra la gestione temporanea e la produzione, ad esempio se si utilizza la modalità **gratuita** o **condivisa** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-420">There are scenarios where you do not have a staging slot to perform hot swap between staging and production, for example, if you are working with **Free** or **Shared** mode.</span></span> <span data-ttu-id="1cfc3-421">In questi scenari, è consigliabile testare l'applicazione in un ambiente di testing, in locale o in un sito remoto, prima della distribuzione in produzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-421">In those scenarios, you should test your application in a testing environment –either locally or in a remote site– before deploying to production.</span></span> <span data-ttu-id="1cfc3-422">Tuttavia, è possibile che un problema non rilevato durante la fase di test possa verificarsi nel sito di produzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-422">However, it is possible that an issue not detected during the testing phase may arise in the production site.</span></span> <span data-ttu-id="1cfc3-423">In questo caso, è importante disporre di un meccanismo per passare facilmente a una versione precedente e più stabile dell'applicazione nel minor tempo possibile.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-423">In this case, it is important to have a mechanism to easily switch to a previous and more stable version of the application as quickly as possible.</span></span>

<span data-ttu-id="1cfc3-424">In **app Azure servizio**, la distribuzione continua dal controllo del codice sorgente rende questa operazione possibile grazie all'azione **Ridistribuisci** disponibile nel portale di gestione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-424">In **Azure App Service**, continuous deployment from source control makes this possible thanks to the **redeploy** action available in the management portal.</span></span> <span data-ttu-id="1cfc3-425">Azure tiene traccia delle distribuzioni associate ai commit di cui è stato eseguito il push nel repository e offre un'opzione per ridistribuire l'applicazione usando una delle distribuzioni precedenti, in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-425">Azure keeps track of the deployments associated with the commits pushed to the repository and provides an option to redeploy your application using any of your previous deployments, at any time.</span></span>

<span data-ttu-id="1cfc3-426">In questo esercizio verrà apportata una modifica al codice nell'applicazione di **quiz per geek** che inserisce intenzionalmente un *bug*.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-426">In this exercise you will perform a change to the code in the **Geek Quiz** application that intentionally injects a *bug*.</span></span> <span data-ttu-id="1cfc3-427">L'applicazione verrà distribuita in produzione per visualizzare l'errore, quindi si utilizzerà la funzionalità Ridistribuisci per tornare allo stato precedente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-427">You will deploy the application to production to see the error, and then you will take advantage of the redeploy feature to go back to the previous state.</span></span>

<a id="Ex3Task1"></a>
#### <a name="task-1--updating-the-geek-quiz-application"></a><span data-ttu-id="1cfc3-428">Attività 1: aggiornamento dell'applicazione quiz per geek</span><span class="sxs-lookup"><span data-stu-id="1cfc3-428">Task 1 – Updating the Geek Quiz Application</span></span>

<span data-ttu-id="1cfc3-429">In questa attività si effettuerà il refactoring di una piccola parte di codice della classe **TriviaController** per estrarre parte della logica che recupera l'opzione del quiz selezionato dal database in un nuovo metodo.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-429">In this task, you will refactor a small piece of code of the **TriviaController** class to extract part of the logic that retrieves the selected quiz option from the database into a new method.</span></span>

1. <span data-ttu-id="1cfc3-430">Passare all'istanza di Visual Studio con la soluzione **GeekQuiz** dell'esercizio precedente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-430">Switch to the Visual Studio instance with the **GeekQuiz** solution from the previous exercise.</span></span>
2. <span data-ttu-id="1cfc3-431">In **Esplora soluzioni**aprire il file **TriviaController.cs** nella cartella **Controllers** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-431">In **Solution Explorer**, open the **TriviaController.cs** file inside the **Controllers** folder.</span></span>
3. <span data-ttu-id="1cfc3-432">Individuare il metodo **storeAsync** e selezionare il codice evidenziato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-432">Locate the **StoreAsync** method and select the code highlighted in the following figure.</span></span>

    ![Selezione del codice](maintainable-azure-websites-managing-change-and-scale/_static/image47.png)

    <span data-ttu-id="1cfc3-434">*Selezione del codice*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-434">*Selecting the code*</span></span>
4. <span data-ttu-id="1cfc3-435">Fare clic con il pulsante destro del mouse sul codice selezionato, espandere il menu **refactoring** e selezionare **Estrai metodo...** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-435">Right-click the selected code, expand the **Refactor** menu and select **Extract Method...**.</span></span>

    ![Estrazione del codice come nuovo metodo](maintainable-azure-websites-managing-change-and-scale/_static/image48.png)

    <span data-ttu-id="1cfc3-437">*Selezione del metodo Extract*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-437">*Selecting Extract Method*</span></span>
5. <span data-ttu-id="1cfc3-438">Nella finestra di dialogo **Estrai metodo** assegnare al nuovo metodo il nome *MatchesOption* e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-438">In the **Extract Method** dialog box, name the new method *MatchesOption* and click **OK**.</span></span>

    ![Specifica del nome del metodo](maintainable-azure-websites-managing-change-and-scale/_static/image49.png)

    <span data-ttu-id="1cfc3-440">*Specifica del nome per il metodo Estratto*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-440">*Specifying the name for the extracted method*</span></span>
6. <span data-ttu-id="1cfc3-441">Il codice selezionato viene quindi estratto nel metodo **MatchesOption** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-441">The selected code is then extracted into the **MatchesOption** method.</span></span> <span data-ttu-id="1cfc3-442">Il codice risultante è illustrato nel frammento di codice seguente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-442">The resulting code is shown in the following snippet.</span></span>

    [!code-csharp[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample14.cs)]
7. <span data-ttu-id="1cfc3-443">Premere **CTRL + S** per salvare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-443">Press **CTRL + S** to save the changes.</span></span>

<a id="Ex3Task2"></a>
#### <a name="task-2--redeploying-the-geek-quiz-application"></a><span data-ttu-id="1cfc3-444">Attività 2: ridistribuzione dell'applicazione di quiz per geek</span><span class="sxs-lookup"><span data-stu-id="1cfc3-444">Task 2 – Redeploying the Geek Quiz Application</span></span>

<span data-ttu-id="1cfc3-445">Si eseguirà ora il push delle modifiche apportate nell'attività precedente al repository, che attiverà una nuova distribuzione nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-445">You will now push the changes you made in the previous task to the repository, which will trigger a new deployment to the production environment.</span></span> <span data-ttu-id="1cfc3-446">Si risoluzione dei problemi quindi un problema usando gli strumenti di **sviluppo F12** forniti da Internet Explorer, quindi eseguire un rollback alla distribuzione precedente dal portale di gestione di Azure.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-446">Then, you will troubleshot an issue using the **F12 development tools** provided by Internet Explorer, and then perform a rollback to the previous deployment from the Azure management portal.</span></span>

1. <span data-ttu-id="1cfc3-447">Aprire una nuova console **git bash** per distribuire l'applicazione aggiornata al servizio app Azure.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-447">Open a new **Git Bash** console to deploy the updated application to Azure App Service.</span></span>
2. <span data-ttu-id="1cfc3-448">Eseguire i comandi seguenti per effettuare il push delle modifiche in Azure.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-448">Execute the following commands to push the changes to Azure.</span></span> <span data-ttu-id="1cfc3-449">Aggiornare il segnaposto *[Your-Application-Path]* con il percorso della soluzione **GeekQuiz** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-449">Update the *[YOUR-APPLICATION-PATH]* placeholder with the path to the **GeekQuiz** solution.</span></span> <span data-ttu-id="1cfc3-450">Verrà richiesto di specificare la password per la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-450">You will be prompted for your deployment password.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample15.cmd)]

    ![Push del codice sottoposto a refactoring in Azure](maintainable-azure-websites-managing-change-and-scale/_static/image50.png)

    <span data-ttu-id="1cfc3-452">*Push del codice sottoposto a refactoring in Azure*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-452">*Pushing refactored code to Azure*</span></span>
3. <span data-ttu-id="1cfc3-453">Aprire Internet Explorer e passare all'app Web, ad esempio `http://<your-web-site>.azurewebsites.net`.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-453">Open Internet Explorer and navigate to your web app (e.g. `http://<your-web-site>.azurewebsites.net`).</span></span> <span data-ttu-id="1cfc3-454">Accedere usando le credenziali create in precedenza.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-454">Log in using the previously created credentials.</span></span>
4. <span data-ttu-id="1cfc3-455">Premere **F12** per avviare gli strumenti di sviluppo, selezionare la scheda **rete** e fare clic sul pulsante **Riproduci** per avviare la registrazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-455">Press **F12** to launch the development tools, select the **Network** tab and click the **Play** button to start recording.</span></span>

    <span data-ttu-id="1cfc3-456">![Avvio della registrazione di rete](maintainable-azure-websites-managing-change-and-scale/_static/image51.png "Avvio della registrazione di rete")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-456">![Starting network recording](maintainable-azure-websites-managing-change-and-scale/_static/image51.png "Starting network recording")</span></span>

    <span data-ttu-id="1cfc3-457">*Avvio della registrazione di rete*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-457">*Starting network recording*</span></span>
5. <span data-ttu-id="1cfc3-458">Selezionare una delle opzioni del quiz.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-458">Select any option of the quiz.</span></span> <span data-ttu-id="1cfc3-459">Si noterà che non viene eseguita alcuna operazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-459">You will see that nothing happens.</span></span>
6. <span data-ttu-id="1cfc3-460">Nella finestra **F12** la voce corrispondente alla richiesta post http Mostra un risultato http **500** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-460">In the **F12** window, the entry corresponding to the POST HTTP request shows an HTTP **500** result.</span></span>

    ![Errore HTTP 500](maintainable-azure-websites-managing-change-and-scale/_static/image52.png)

    <span data-ttu-id="1cfc3-462">*Errore HTTP 500*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-462">*HTTP 500 error*</span></span>
7. <span data-ttu-id="1cfc3-463">Selezionare la scheda **console** . Viene registrato un errore con i dettagli della cause.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-463">Select the **Console** tab. An error is logged with the details of the cause.</span></span>

    ![Errore registrato](maintainable-azure-websites-managing-change-and-scale/_static/image53.png)

    <span data-ttu-id="1cfc3-465">*Errore registrato*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-465">*Logged error*</span></span>
8. <span data-ttu-id="1cfc3-466">Individuare la parte relativa ai dettagli dell'errore.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-466">Locate the details part of the error.</span></span> <span data-ttu-id="1cfc3-467">Ovviamente, questo errore è causato dal refactoring del codice di cui è stato eseguito il commit nei passaggi precedenti.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-467">Clearly, this error is caused by the code refactoring you committed in the previous steps.</span></span>

    <span data-ttu-id="1cfc3-468">`Details: LINQ to Entities does not recognize the method 'Boolean MatchesOption ...`</span><span class="sxs-lookup"><span data-stu-id="1cfc3-468">`Details: LINQ to Entities does not recognize the method 'Boolean MatchesOption ...`.</span></span>
9. <span data-ttu-id="1cfc3-469">Non chiudere il browser.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-469">Do not close the browser.</span></span>
10. <span data-ttu-id="1cfc3-470">In una nuova istanza del browser passare al [portale di gestione di Azure](https://manage.windowsazure.com) e accedere usando il account Microsoft associato alla sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-470">In a new browser instance, navigate to the [Azure management portal](https://manage.windowsazure.com) and sign in using the Microsoft account associated with your subscription.</span></span>
11. <span data-ttu-id="1cfc3-471">Selezionare **siti Web** e fare clic sull'app Web creata nell'esercizio 2.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-471">Select **Websites** and click the web app you created in Exercise 2.</span></span>
12. <span data-ttu-id="1cfc3-472">Passare alla pagina **distribuzioni** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-472">Navigate to the **Deployments** page.</span></span> <span data-ttu-id="1cfc3-473">Si noti che tutti i commit eseguiti sono elencati nella cronologia di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-473">Notice that all the commits performed are listed in the deployment history.</span></span>

    ![Elenco di distribuzioni esistenti](maintainable-azure-websites-managing-change-and-scale/_static/image54.png)

    <span data-ttu-id="1cfc3-475">*Elenco di distribuzioni esistenti*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-475">*List of existing deployments*</span></span>
13. <span data-ttu-id="1cfc3-476">Selezionare il commit precedente e fare clic su **Ridistribuisci** sulla barra dei comandi.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-476">Select the previous commit and click **Redeploy** on the command bar.</span></span>

    ![Ridistribuzione del commit precedente](maintainable-azure-websites-managing-change-and-scale/_static/image55.png)

    <span data-ttu-id="1cfc3-478">*Ridistribuzione del commit precedente*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-478">*Redeploying the previous commit*</span></span>
14. <span data-ttu-id="1cfc3-479">Quando viene richiesto di confermare, fare clic su **Sì**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-479">When prompted to confirm, click **Yes**.</span></span>

    ![Conferma della ridistribuzione](maintainable-azure-websites-managing-change-and-scale/_static/image56.png)
15. <span data-ttu-id="1cfc3-481">Al termine della distribuzione, tornare all'istanza del browser con l'app Web e premere **CTRL + F5**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-481">When the deployment completes, switch back to the browser instance with your web app and press **CTRL + F5**.</span></span>
16. <span data-ttu-id="1cfc3-482">Fare clic su una delle opzioni.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-482">Click any of the options.</span></span> <span data-ttu-id="1cfc3-483">L'animazione flip verrà ora eseguita e verrà visualizzato il risultato (*corretto/errato*).</span><span class="sxs-lookup"><span data-stu-id="1cfc3-483">The flip animation will now take place and the result (*correct/incorrect*) will be displayed.</span></span>
17. <span data-ttu-id="1cfc3-484">Opzionale Passare alla console **git bash** ed eseguire i comandi seguenti per ripristinare il commit precedente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-484">(Optional) Switch to the **Git Bash** console and execute the following commands to revert to the previous commit.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-485">Questi comandi creano un nuovo commit che annulla tutte le modifiche nel repository git effettuate nel commit non valido.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-485">These commands create a new commit that undoes all changes in the Git repository that were made in the bad commit.</span></span> <span data-ttu-id="1cfc3-486">Azure ridistribuirà quindi l'applicazione usando il nuovo commit.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-486">Azure will then redeploy the application using the new commit.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample16.cmd)]

<a id="Exercise4"></a>
### <a name="exercise-4-scaling-using-azure-storage"></a><span data-ttu-id="1cfc3-487">Esercizio 4: ridimensionamento con archiviazione di Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-487">Exercise 4: Scaling Using Azure Storage</span></span>

<span data-ttu-id="1cfc3-488">I **BLOB** rappresentano il modo più semplice per archiviare grandi quantità di dati binari o di testo non strutturati, ad esempio video, audio e immagini.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-488">**Blobs** are the simplest way to store large amounts of unstructured text or binary data such as video, audio and images.</span></span> <span data-ttu-id="1cfc3-489">Lo spostando il contenuto statico dell'applicazione nella risorsa di archiviazione consente di ridimensionare l'applicazione servendo immagini o documenti direttamente nel browser.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-489">Moving the static content of your application to Storage, helps to scale your application by serving images or documents directly to the browser.</span></span>

<span data-ttu-id="1cfc3-490">In questo esercizio il contenuto statico dell'applicazione verrà spostato in un contenitore BLOB.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-490">In this exercise, you will move the static content of your application to a Blob container.</span></span> <span data-ttu-id="1cfc3-491">Si configurerà quindi l'applicazione per aggiungere una **regola di riscrittura URL ASP.NET** nel **file Web. config** per reindirizzare il contenuto al contenitore BLOB.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-491">Then you will configure your application to add an **ASP.NET URL rewrite rule** in the **Web.config** to redirect your content to the Blob container.</span></span>

<a id="Ex4Task1"></a>
#### <a name="task-1--creating-an-azure-storage-account"></a><span data-ttu-id="1cfc3-492">Attività 1: creazione di un account di archiviazione di Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-492">Task 1 – Creating an Azure Storage Account</span></span>

<span data-ttu-id="1cfc3-493">In questa attività si apprenderà come creare un nuovo account di archiviazione usando il portale di gestione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-493">In this task you will learn how to create a new storage account using the management portal.</span></span>

1. <span data-ttu-id="1cfc3-494">Passare al [portale di gestione di Azure](https://manage.windowsazure.com) e accedere usando il account Microsoft associato alla sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-494">Navigate to the [Azure management portal](https://manage.windowsazure.com) and sign in using the Microsoft account associated with your subscription.</span></span>
2. <span data-ttu-id="1cfc3-495">Selezionare **nuovo | Servizi dati | Archiviazione | Creazione rapida** per avviare la creazione di un nuovo account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-495">Select **New | Data Services | Storage | Quick Create** to start creating a new storage account.</span></span> <span data-ttu-id="1cfc3-496">Immettere un nome univoco per l'account e selezionare un' **area** dall'elenco.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-496">Enter a unique name for the account and select a **Region** from the list.</span></span> <span data-ttu-id="1cfc3-497">Per continuare, fare clic su **Crea account di archiviazione** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-497">Click **Create Storage Account** to continue.</span></span>

    <span data-ttu-id="1cfc3-498">![Creazione di un nuovo account di archiviazione](maintainable-azure-websites-managing-change-and-scale/_static/image57.png "Creazione di un nuovo account di archiviazione")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-498">![Creating a new Storage Account](maintainable-azure-websites-managing-change-and-scale/_static/image57.png "Creating a new Storage Account")</span></span>

    <span data-ttu-id="1cfc3-499">*Creazione di un nuovo account di archiviazione*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-499">*Creating a new storage account*</span></span>
3. <span data-ttu-id="1cfc3-500">Nella sezione **archiviazione** attendere che lo stato del nuovo account di archiviazione venga modificato in *online* per continuare con il passaggio successivo.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-500">In the **Storage** section, wait until the status of the new storage account changes to *Online* in order to continue with the following step.</span></span>

    <span data-ttu-id="1cfc3-501">![Account di archiviazione creato](maintainable-azure-websites-managing-change-and-scale/_static/image58.png "Account di archiviazione creato")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-501">![Storage Account created](maintainable-azure-websites-managing-change-and-scale/_static/image58.png "Storage Account created")</span></span>

    <span data-ttu-id="1cfc3-502">*Account di archiviazione creato*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-502">*Storage Account created*</span></span>
4. <span data-ttu-id="1cfc3-503">Fare clic sul nome dell'account di archiviazione e quindi fare clic sul collegamento **Dashboard** nella parte superiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-503">Click on the storage account name and then click the **Dashboard** link at the top of the page.</span></span> <span data-ttu-id="1cfc3-504">Nella pagina **Dashboard** sono disponibili informazioni sullo stato dell'account e degli endpoint di servizio che possono essere utilizzati all'interno delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-504">The **Dashboard** page provides you with information about the status of the account and the service endpoints that can be used within your applications.</span></span>

    <span data-ttu-id="1cfc3-505">![Visualizzazione del dashboard dell'account di archiviazione](maintainable-azure-websites-managing-change-and-scale/_static/image59.png "Visualizzazione del dashboard dell'account di archiviazione")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-505">![Displaying the Storage Account Dashboard](maintainable-azure-websites-managing-change-and-scale/_static/image59.png "Displaying the Storage Account Dashboard")</span></span>

    <span data-ttu-id="1cfc3-506">*Visualizzazione del dashboard dell'account di archiviazione*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-506">*Displaying the Storage Account Dashboard*</span></span>
5. <span data-ttu-id="1cfc3-507">Fare clic sul pulsante **Gestisci chiavi di accesso** nella barra di spostamento.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-507">Click the **Manage Access Keys** button in the navigation bar.</span></span>

    <span data-ttu-id="1cfc3-508">![Pulsante Gestisci chiavi di accesso](maintainable-azure-websites-managing-change-and-scale/_static/image60.png "Pulsante Gestisci chiavi di accesso")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-508">![Manage Access Keys button](maintainable-azure-websites-managing-change-and-scale/_static/image60.png "Manage Access Keys button")</span></span>

    <span data-ttu-id="1cfc3-509">*Pulsante Gestisci chiavi di accesso*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-509">*Manage Access Keys button*</span></span>
6. <span data-ttu-id="1cfc3-510">Nella finestra di dialogo **Gestisci chiavi di accesso** copiare il **nome dell'account di archiviazione** e la chiave di **accesso primaria** , perché sarà necessario nel seguente esercizio.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-510">In the **Manage Access Keys** dialog box, copy the **Storage Account Name** and **Primary Access Key** as you will need them in the following exercise.</span></span> <span data-ttu-id="1cfc3-511">Chiudere quindi la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-511">Then, close the dialog box.</span></span>

    <span data-ttu-id="1cfc3-512">![Finestra di dialogo Gestisci chiave di accesso](maintainable-azure-websites-managing-change-and-scale/_static/image61.png "Finestra di dialogo Gestisci chiave di accesso")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-512">![Manage Access Key dialog box](maintainable-azure-websites-managing-change-and-scale/_static/image61.png "Manage Access Key dialog box")</span></span>

    <span data-ttu-id="1cfc3-513">*Finestra di dialogo Gestisci chiave di accesso*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-513">*Manage Access Key dialog box*</span></span>

<a id="Ex4Task2"></a>
#### <a name="task-2--uploading-an-asset-to-azure-blob-storage"></a><span data-ttu-id="1cfc3-514">Attività 2: caricamento di un asset nell'archivio BLOB di Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-514">Task 2 – Uploading an Asset to Azure Blob Storage</span></span>

<span data-ttu-id="1cfc3-515">In questa attività si userà la finestra di Esplora server da Visual Studio per connettersi all'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-515">In this task, you will use the Server Explorer window from Visual Studio to connect to your storage account.</span></span> <span data-ttu-id="1cfc3-516">Si creerà quindi un contenitore BLOB e si caricherà un file con il logo del quiz geek nel contenitore.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-516">You will then create a blob container and upload a file with the Geek Quiz logo to the container.</span></span>

1. <span data-ttu-id="1cfc3-517">Passare all'istanza di Visual Studio con la soluzione **GeekQuiz** dell'esercizio precedente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-517">Switch to the Visual Studio instance with the **GeekQuiz** solution from the previous exercise.</span></span>
2. <span data-ttu-id="1cfc3-518">Dalla barra dei menu selezionare **Visualizza** e quindi fare clic su **Esplora server**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-518">From the menu bar, select **View** and then click **Server Explorer**.</span></span>
3. <span data-ttu-id="1cfc3-519">In **Esplora server**fare clic con il pulsante destro del mouse sul nodo **Azure** e scegliere **Connetti ad Azure.** Accedere usando il account Microsoft associato alla sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-519">In **Server Explorer**, right-click the **Azure** node and select **Connect to Azure...**. Sign in using the Microsoft account associated with your subscription.</span></span>

    ![Connessione a Microsoft Azure](maintainable-azure-websites-managing-change-and-scale/_static/image62.png)

    <span data-ttu-id="1cfc3-521">*Connect to Azure*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-521">*Connect to Azure*</span></span>
4. <span data-ttu-id="1cfc3-522">Espandere il nodo **Azure** , fare clic con il pulsante destro del mouse su **archiviazione** e scegliere **Connetti archiviazione esterna.**</span><span class="sxs-lookup"><span data-stu-id="1cfc3-522">Expand the **Azure** node, right-click **Storage** and select **Attach External Storage...**.</span></span>
5. <span data-ttu-id="1cfc3-523">Nella finestra di dialogo **Aggiungi nuovo account di archiviazione** immettere il **nome dell'account** e la **chiave dell'account** ottenuti nell'attività precedente e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-523">In the **Add New Storage Account** dialog box, enter the **Account name** and **Account key** you obtained in the previous task and click **OK**.</span></span>

    ![Finestra di dialogo Aggiungi nuovo account di archiviazione](maintainable-azure-websites-managing-change-and-scale/_static/image63.png)

    <span data-ttu-id="1cfc3-525">*Finestra di dialogo Aggiungi nuovo account di archiviazione*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-525">*Add New Storage Account dialog box*</span></span>
6. <span data-ttu-id="1cfc3-526">L'account di archiviazione dovrebbe essere visualizzato sotto il nodo **archiviazione** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-526">Your storage account should appear under the **Storage** node.</span></span> <span data-ttu-id="1cfc3-527">Espandere l'account di archiviazione, fare clic con il pulsante destro del mouse su **BLOB** e selezionare **Crea contenitore BLOB...** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-527">Expand your storage account, right-click **Blobs** and select **Create Blob Container...**.</span></span>

    <span data-ttu-id="1cfc3-528">![Crea contenitore BLOB](maintainable-azure-websites-managing-change-and-scale/_static/image64.png "Crea contenitore BLOB")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-528">![Create Blob Container](maintainable-azure-websites-managing-change-and-scale/_static/image64.png "Create Blob Container")</span></span>

    <span data-ttu-id="1cfc3-529">*Crea contenitore BLOB*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-529">*Create Blob Container*</span></span>
7. <span data-ttu-id="1cfc3-530">Nella finestra di dialogo **Crea contenitore BLOB** immettere un nome per il contenitore BLOB e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-530">In the **Create Blob Container** dialog box, enter a name for the blob container and click **OK**.</span></span>

    <span data-ttu-id="1cfc3-531">![Finestra di dialogo Crea contenitore BLOB](maintainable-azure-websites-managing-change-and-scale/_static/image65.png "Finestra di dialogo Crea contenitore BLOB")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-531">![Create Blob Container dialog box](maintainable-azure-websites-managing-change-and-scale/_static/image65.png "Create Blob Container dialog box")</span></span>

    <span data-ttu-id="1cfc3-532">*Finestra di dialogo Crea contenitore BLOB*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-532">*Create Blob Container dialog box*</span></span>
8. <span data-ttu-id="1cfc3-533">Il nuovo contenitore BLOB deve essere aggiunto al nodo **BLOB** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-533">The new blob container should be added to the **Blobs** node.</span></span> <span data-ttu-id="1cfc3-534">Modificare le autorizzazioni di accesso nel contenitore per rendere pubblico il contenitore.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-534">Change the access permissions in the container to make the container public.</span></span> <span data-ttu-id="1cfc3-535">A tale scopo, fare clic con il pulsante destro del mouse sul contenitore **images** e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-535">To do this, right-click the **images** container and select **Properties**.</span></span>

    <span data-ttu-id="1cfc3-536">![Proprietà del contenitore images](maintainable-azure-websites-managing-change-and-scale/_static/image66.png "Proprietà del contenitore images")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-536">![images container properties](maintainable-azure-websites-managing-change-and-scale/_static/image66.png "images container properties")</span></span>

    <span data-ttu-id="1cfc3-537">*Proprietà del contenitore images*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-537">*Images container properties*</span></span>
9. <span data-ttu-id="1cfc3-538">Nella finestra **Proprietà** impostare l'accesso in **lettura pubblico** sul **contenitore**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-538">In the **Properties** window, set the **Public Read Access** to **Container**.</span></span>

    <span data-ttu-id="1cfc3-539">![Modifica della proprietà di accesso in lettura pubblico](maintainable-azure-websites-managing-change-and-scale/_static/image67.png "Modifica della proprietà di accesso in lettura pubblico")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-539">![Changing public read access property](maintainable-azure-websites-managing-change-and-scale/_static/image67.png "Changing public read access property")</span></span>

    <span data-ttu-id="1cfc3-540">*Modifica della proprietà di accesso in lettura pubblico*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-540">*Changing public read access property*</span></span>
10. <span data-ttu-id="1cfc3-541">Quando viene richiesto se si è certi di voler modificare la proprietà di accesso pubblico, fare clic su **Sì**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-541">When prompted if you are sure you want to change the public access property, click **Yes**.</span></span>

    <span data-ttu-id="1cfc3-542">![Avviso Microsoft Visual Studio](maintainable-azure-websites-managing-change-and-scale/_static/image68.png "Avviso Microsoft Visual Studio")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-542">![Microsoft Visual Studio warning](maintainable-azure-websites-managing-change-and-scale/_static/image68.png "Microsoft Visual Studio warning")</span></span>

    <span data-ttu-id="1cfc3-543">*Avviso Microsoft Visual Studio*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-543">*Microsoft Visual Studio warning*</span></span>
11. <span data-ttu-id="1cfc3-544">In **Esplora server**fare clic con il pulsante destro del mouse sul contenitore BLOB **images** e selezionare **Visualizza contenitore BLOB**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-544">In **Server Explorer**, right-click in the **images** blob container and select **View Blob Container**.</span></span>

    <span data-ttu-id="1cfc3-545">![Visualizza contenitore BLOB](maintainable-azure-websites-managing-change-and-scale/_static/image69.png "Visualizza contenitore BLOB")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-545">![View Blob Container](maintainable-azure-websites-managing-change-and-scale/_static/image69.png "View Blob Container")</span></span>

    <span data-ttu-id="1cfc3-546">*Visualizza contenitore BLOB*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-546">*View Blob Container*</span></span>
12. <span data-ttu-id="1cfc3-547">Il contenitore immagini verrà aperto in una nuova finestra e verrà visualizzata una legenda senza voci.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-547">The images container should open in a new window and a legend with no entries should be shown.</span></span> <span data-ttu-id="1cfc3-548">Fare clic sull'icona **carica** per caricare un file nel contenitore BLOB.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-548">Click the **upload** icon to upload a file to the blob container.</span></span>

    <span data-ttu-id="1cfc3-549">![Contenitore images senza voci](maintainable-azure-websites-managing-change-and-scale/_static/image70.png "Contenitore images senza voci")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-549">![Images container with no entries](maintainable-azure-websites-managing-change-and-scale/_static/image70.png "Images container with no entries")</span></span>

    <span data-ttu-id="1cfc3-550">*Contenitore images senza voci*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-550">*Images container with no entries*</span></span>
13. <span data-ttu-id="1cfc3-551">Nella finestra di dialogo **Carica BLOB** passare alla cartella **Asset** del Lab.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-551">In the **Upload Blob** dialog box, navigate to the **Assets** folder of the lab.</span></span> <span data-ttu-id="1cfc3-552">Selezionare il file **logo-Big. png** e fare clic su **Apri**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-552">Select the **logo-big.png** file and click **Open**.</span></span>
14. <span data-ttu-id="1cfc3-553">Attendere il caricamento del file.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-553">Wait until the file is uploaded.</span></span> <span data-ttu-id="1cfc3-554">Al termine del caricamento, il file deve essere elencato nel contenitore images.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-554">When the upload completes, the file should be listed in the images container.</span></span> <span data-ttu-id="1cfc3-555">Fare clic con il pulsante destro del mouse sulla voce di file e scegliere **Copia URL**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-555">Right-click the file entry and select **Copy URL**.</span></span>

    <span data-ttu-id="1cfc3-556">![Copia URL BLOB](maintainable-azure-websites-managing-change-and-scale/_static/image71.png "Copiare l'URL del file BLOB")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-556">![Copy blob URL](maintainable-azure-websites-managing-change-and-scale/_static/image71.png "Copy blob file URL")</span></span>

    <span data-ttu-id="1cfc3-557">*Copia URL BLOB*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-557">*Copy blob URL*</span></span>
15. <span data-ttu-id="1cfc3-558">Aprire Internet Explorer e incollare l'URL.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-558">Open Internet Explorer and paste the URL.</span></span> <span data-ttu-id="1cfc3-559">Nel browser deve essere visualizzata l'immagine seguente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-559">The following image should be shown in the browser.</span></span>

    <span data-ttu-id="1cfc3-560">![immagine di logo-Big. png dall'archiviazione BLOB di Windows](maintainable-azure-websites-managing-change-and-scale/_static/image72.png "immagine di logo-Big. png dalla risorsa di archiviazione")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-560">![logo-big.png image from Windows Blob Storage](maintainable-azure-websites-managing-change-and-scale/_static/image72.png "logo-big.png image from storage")</span></span>

    <span data-ttu-id="1cfc3-561">*immagine di logo-Big. png dall'archiviazione BLOB di Azure*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-561">*logo-big.png image from Azure Blob Storage*</span></span>

<a id="Ex4Task3"></a>
#### <a name="task-3--updating-the-solution-to-consume-static-content-from-azure-blob-storage"></a><span data-ttu-id="1cfc3-562">Attività 3: aggiornamento della soluzione per l'utilizzo di contenuto statico dall'archiviazione BLOB di Azure</span><span class="sxs-lookup"><span data-stu-id="1cfc3-562">Task 3 – Updating the Solution to Consume Static Content from Azure Blob Storage</span></span>

<span data-ttu-id="1cfc3-563">In questa attività verrà configurata la soluzione **GeekQuiz** in modo da usare l'immagine caricata nell'archivio BLOB di Azure, anziché l'immagine che si trova nell'app Web, aggiungendo una regola di riscrittura URL ASP.NET nel file **Web. config** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-563">In this task, you will configure the **GeekQuiz** solution to consume the image uploaded to Azure Blob Storage (instead of the image located in the web app) by adding an ASP.NET URL rewrite rule in the **web.config** file.</span></span>

1. <span data-ttu-id="1cfc3-564">In Visual Studio aprire il file **Web. config** all'interno del progetto **GeekQuiz** e individuare l'elemento **&lt;System. webserver&gt;** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-564">In Visual Studio, open the **Web.config** file inside the **GeekQuiz** project and locate the **&lt;system.webServer&gt;** element.</span></span>
2. <span data-ttu-id="1cfc3-565">Aggiungere il codice seguente per aggiungere una regola di riscrittura URL, aggiornando il segnaposto con il nome dell'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-565">Add the following code to add an URL rewrite rule, updating the placeholder with your storage account name.</span></span>

    <span data-ttu-id="1cfc3-566">(Frammento di codice- *WebSitesInProduction-EX4-UrlRewriteRule*)</span><span class="sxs-lookup"><span data-stu-id="1cfc3-566">(Code Snippet - *WebSitesInProduction - Ex4 - UrlRewriteRule*)</span></span>

    [!code-xml[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample17.xml)]

    > [!NOTE]
    > <span data-ttu-id="1cfc3-567">La riscrittura URL è il processo di intercettazione di una richiesta Web in ingresso e di reindirizzamento della richiesta a una risorsa diversa.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-567">URL rewriting is the process of intercepting an incoming Web request and redirecting the request to a different resource.</span></span> <span data-ttu-id="1cfc3-568">Le regole di riscrittura URL indicano al motore di riscrittura quando è necessario reindirizzare una richiesta e dove devono essere reindirizzate.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-568">The URL rewriting rules tells the rewriting engine when a request needs to be redirected, and where should they be redirected.</span></span> <span data-ttu-id="1cfc3-569">Una regola di riscrittura è costituita da due stringhe: il criterio da cercare nell'URL richiesto (in genere, usando le espressioni regolari) e la stringa con cui sostituire il modello, se trovato.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-569">A rewriting rule is composed of two strings: the pattern to look for in the requested URL (usually, using regular expressions), and the string to replace the pattern with, if found.</span></span> <span data-ttu-id="1cfc3-570">Per ulteriori informazioni, vedere la pagina relativa [alla riscrittura degli URL in ASP.NET](https://msdn.microsoft.com/library/ms972974.aspx).</span><span class="sxs-lookup"><span data-stu-id="1cfc3-570">For more information, see [URL Rewriting in ASP.NET](https://msdn.microsoft.com/library/ms972974.aspx).</span></span>
3. <span data-ttu-id="1cfc3-571">Premere **CTRL + S** per salvare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-571">Press **CTRL + S** to save the changes.</span></span>
4. <span data-ttu-id="1cfc3-572">Aprire una nuova console **git bash** per distribuire l'applicazione aggiornata al servizio app Azure.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-572">Open a new **Git Bash** console to deploy the updated application to Azure App Service.</span></span>
5. <span data-ttu-id="1cfc3-573">Eseguire i comandi seguenti per effettuare il push delle modifiche in Azure.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-573">Execute the following commands to push the changes to Azure.</span></span> <span data-ttu-id="1cfc3-574">Aggiornare il segnaposto *[Your-Application-Path]* con il percorso della soluzione **GeekQuiz** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-574">Update the *[YOUR-APPLICATION-PATH]* placeholder with the path to the **GeekQuiz** solution.</span></span> <span data-ttu-id="1cfc3-575">Verrà richiesto di specificare la password per la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-575">You will be prompted for your deployment password.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample18.cmd)]

    ![Distribuzione dell'aggiornamento in Azure](maintainable-azure-websites-managing-change-and-scale/_static/image73.png)

    <span data-ttu-id="1cfc3-577">*Distribuzione dell'aggiornamento in Azure*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-577">*Deploying update to Azure*</span></span>

<a id="Ex4Task4"></a>
#### <a name="task-4--verification"></a><span data-ttu-id="1cfc3-578">Attività 4: verifica</span><span class="sxs-lookup"><span data-stu-id="1cfc3-578">Task 4 – Verification</span></span>

<span data-ttu-id="1cfc3-579">In questa attività si userà **Internet Explorer** per esplorare l'applicazione di **quiz per geek** e verificare che la regola di riscrittura URL per le immagini funzioni e si venga reindirizzati all'immagine ospitata nell' **Archivio BLOB di Azure**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-579">In this task you will use **Internet Explorer** to browse the **Geek Quiz** application and check that the URL rewrite rule for images works and you are redirected to the image hosted on **Azure Blob Storage**.</span></span>

1. <span data-ttu-id="1cfc3-580">Aprire Internet Explorer e passare all'app Web, ad esempio `http://<your-web-site>.azurewebsites.net`.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-580">Open Internet Explorer and navigate to your web app (e.g. `http://<your-web-site>.azurewebsites.net`).</span></span> <span data-ttu-id="1cfc3-581">Accedere usando le credenziali create in precedenza.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-581">Log in using the previously created credentials.</span></span>

    <span data-ttu-id="1cfc3-582">![Visualizzazione dell'app Web del quiz per geek con l'immagine](maintainable-azure-websites-managing-change-and-scale/_static/image74.png "Visualizzazione dell'app Web del quiz per geek con l'immagine")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-582">![Showing the Geek Quiz web app with the image](maintainable-azure-websites-managing-change-and-scale/_static/image74.png "Showing the Geek Quiz web app with the image")</span></span>

    <span data-ttu-id="1cfc3-583">*Visualizzazione dell'app Web del quiz per geek con l'immagine*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-583">*Showing the Geek Quiz web app with the image*</span></span>
2. <span data-ttu-id="1cfc3-584">Premere **F12** per avviare gli strumenti di sviluppo, selezionare la scheda **rete** e avviare la registrazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-584">Press **F12** to launch the development tools, select the **Network** tab and start recording.</span></span>

    <span data-ttu-id="1cfc3-585">![Avvio della registrazione di rete](maintainable-azure-websites-managing-change-and-scale/_static/image75.png "Avvio della registrazione di rete")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-585">![Starting network recording](maintainable-azure-websites-managing-change-and-scale/_static/image75.png "Starting network recording")</span></span>

    <span data-ttu-id="1cfc3-586">*Avvio della registrazione di rete*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-586">*Starting network recording*</span></span>
3. <span data-ttu-id="1cfc3-587">Premere **CTRL + F5** per aggiornare la pagina Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-587">Press **CTRL + F5** to refresh the web page.</span></span>
4. <span data-ttu-id="1cfc3-588">Al termine del caricamento della pagina, verrà visualizzata una richiesta HTTP per l'URL **/IMG/logo-Big.png** con un risultato http **301** (Reindirizzamento) e un'altra richiesta per `http://[YOUR-STORAGE-ACCOUNT].blob.core.windows.net/images/logo-big.png` URL con un risultato http **200** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-588">Once the page has finished loading, you should see an HTTP request for the **/img/logo-big.png** URL with an HTTP **301** result (redirect) and another request for `http://[YOUR-STORAGE-ACCOUNT].blob.core.windows.net/images/logo-big.png` URL with a HTTP **200** result.</span></span>

    <span data-ttu-id="1cfc3-589">![Verifica del reindirizzamento dell'URL](maintainable-azure-websites-managing-change-and-scale/_static/image76.png "Visualizzazione del reindirizzamento in strumenti di sviluppo")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-589">![Verifying the URL redirect](maintainable-azure-websites-managing-change-and-scale/_static/image76.png "Showing the redirect in Dev Tools")</span></span>

    <span data-ttu-id="1cfc3-590">*Verifica del reindirizzamento dell'URL*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-590">*Verifying the URL redirect*</span></span>

<a id="Exercise5"></a>
### <a name="exercise-5-using-autoscale-for-web-apps"></a><span data-ttu-id="1cfc3-591">Esercizio 5: uso della scalabilità automatica per le app Web</span><span class="sxs-lookup"><span data-stu-id="1cfc3-591">Exercise 5: Using Autoscale for Web Apps</span></span>

> [!NOTE]
> <span data-ttu-id="1cfc3-592">Questo esercizio è facoltativo, poiché richiede il supporto per il test delle prestazioni del &amp; di carico Web, disponibile solo per **Visual Studio 2013 Ultimate Edition**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-592">This exercise is optional, since it requires support for Web Load &amp; Performance Testing which is only available for **Visual Studio 2013 Ultimate Edition**.</span></span> <span data-ttu-id="1cfc3-593">Per ulteriori informazioni sulle funzionalità specifiche di Visual Studio 2013, confrontare le versioni [qui](https://www.microsoft.com/visualstudio/eng/products/compare).</span><span class="sxs-lookup"><span data-stu-id="1cfc3-593">For more information on specific Visual Studio 2013 features, compare versions [here](https://www.microsoft.com/visualstudio/eng/products/compare).</span></span>

<span data-ttu-id="1cfc3-594">Il **servizio app Web di app Azure** offre la funzionalità di scalabilità automatica per le app Web in esecuzione in **modalità standard**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-594">**Azure App Service Web Apps** provides the Autoscale feature for web apps running in **Standard Mode**.</span></span> <span data-ttu-id="1cfc3-595">La scalabilità automatica consente ad Azure di ridimensionare automaticamente il numero di istanze dell'app Web a seconda del carico.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-595">Autoscale lets Azure automatically scale the instance count of your web app depending on the load.</span></span> <span data-ttu-id="1cfc3-596">Quando è abilitata la scalabilità automatica, Azure controlla la CPU dell'app Web una volta ogni cinque minuti e aggiunge le istanze in base alle esigenze in quel momento.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-596">When Autoscale is enabled, Azure checks the CPU of your web app once every five minutes and adds instances as needed at that point in time.</span></span> <span data-ttu-id="1cfc3-597">Se l'utilizzo della CPU è basso, Azure rimuoverà le istanze una volta ogni due ore per assicurarsi che le prestazioni dell'app Web non siano degradate.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-597">If the CPU usage is low, Azure will remove instances once every two hours to ensure that the performance of your web app is not degraded.</span></span>

<span data-ttu-id="1cfc3-598">In questo esercizio verranno illustrati i passaggi necessari per configurare la funzionalità di **scalabilità** automatica per l'app Web di **quiz per geek** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-598">In this exercise you will go through the steps required to configure the **Autoscale** feature for the **Geek Quiz** web app.</span></span> <span data-ttu-id="1cfc3-599">Questa funzionalità verrà verificata eseguendo un test di carico di Visual Studio per generare un carico sufficiente della CPU nell'applicazione per attivare un aggiornamento dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-599">You will verify this feature by running a Visual Studio load test to generate enough CPU load on the application to trigger an instance upgrade.</span></span>

<a id="Ex5Task1"></a>
#### <a name="task-1--configuring-autoscale-based-on-the-cpu-metric"></a><span data-ttu-id="1cfc3-600">Attività 1: configurazione della scalabilità automatica in base alla metrica della CPU</span><span class="sxs-lookup"><span data-stu-id="1cfc3-600">Task 1 – Configuring Autoscale Based on the CPU Metric</span></span>

<span data-ttu-id="1cfc3-601">In questa attività si userà il portale di gestione di Azure per abilitare la funzionalità di scalabilità automatica per l'app Web creata nell'esercizio 2.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-601">In this task you will use the Azure management portal to enable the Autoscale feature for the web app you created in Exercise 2.</span></span>

1. <span data-ttu-id="1cfc3-602">Nel [portale di gestione di Azure](https://manage.windowsazure.com/)selezionare **siti Web** e fare clic sull'app Web creata nell'esercizio 2.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-602">In the [Azure management portal](https://manage.windowsazure.com/), select **Websites** and click the web app you created in Exercise 2.</span></span>
2. <span data-ttu-id="1cfc3-603">Passare alla pagina **scala** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-603">Navigate to the **Scale** page.</span></span> <span data-ttu-id="1cfc3-604">Nella sezione **capacità** selezionare **CPU** per la configurazione **scala per metrica** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-604">Under the **capacity** section, select **CPU** for the **Scale by Metric** configuration.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-605">Quando si esegue il ridimensionamento in base alla CPU, Azure regola dinamicamente il numero di istanze utilizzate dall'app in caso di modifica dell'utilizzo della CPU.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-605">When scaling by CPU, Azure dynamically adjusts the number of instances that the app uses if the CPU usage changes.</span></span>

    <span data-ttu-id="1cfc3-606">![Selezione per la scalabilità in base alla CPU](maintainable-azure-websites-managing-change-and-scale/_static/image77.png "Selezione della metrica CPU per la scalabilità automatica")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-606">![Selecting to scale by CPU](maintainable-azure-websites-managing-change-and-scale/_static/image77.png "Selecting the CPU metric for auto scaling")</span></span>

    <span data-ttu-id="1cfc3-607">*Selezione per la scalabilità in base alla CPU*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-607">*Selecting to scale by CPU*</span></span>
3. <span data-ttu-id="1cfc3-608">Modificare la configurazione della **CPU di destinazione** in **20**-**40** %.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-608">Change the **Target CPU** configuration to **20**-**40** percent.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-609">Questo intervallo rappresenta l'utilizzo medio della CPU per l'app Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-609">This range represents the average CPU usage for your web app.</span></span> <span data-ttu-id="1cfc3-610">Azure aggiungerà o rimuoverà le istanze per preservare l'app Web in questo intervallo.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-610">Azure will add or remove instances to keep your web app in this range.</span></span> <span data-ttu-id="1cfc3-611">Il numero minimo e massimo di istanze utilizzate per la scalabilità è specificato nella configurazione del **conteggio** delle istanze.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-611">The minimum and maximum number of instances used for scaling is specified in the **Instance Count** configuration.</span></span> <span data-ttu-id="1cfc3-612">Azure non andrà mai oltre tale limite.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-612">Azure will never go above or beyond that limit.</span></span>
    >
    > <span data-ttu-id="1cfc3-613">I valori predefiniti della **CPU di destinazione** vengono modificati solo ai fini di questo Lab.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-613">The default **Target CPU** values are modified just for the purposes of this lab.</span></span> <span data-ttu-id="1cfc3-614">Configurando l'intervallo di CPU con valori ridotti, si aumentano le probabilità di attivare la scalabilità automatica quando si posiziona un carico moderato nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-614">By configuring the CPU range with small values, you are increasing the chances to trigger Autoscale when a moderate load is placed on the application.</span></span>

    <span data-ttu-id="1cfc3-615">![Modificare la CPU di destinazione in modo che sia compresa tra il 20 e il 40%](maintainable-azure-websites-managing-change-and-scale/_static/image78.png "Modificare la CPU di destinazione in modo che sia compresa tra il 20 e il 40%")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-615">![Changing the target CPU to be between 20 and 40 percent](maintainable-azure-websites-managing-change-and-scale/_static/image78.png "Changing the target CPU to be between 20 and 40 percent")</span></span>

    <span data-ttu-id="1cfc3-616">*Modificare la CPU di destinazione in modo che sia compresa tra il 20 e il 40%*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-616">*Changing the Target CPU to be between 20 and 40 percent*</span></span>
4. <span data-ttu-id="1cfc3-617">Fare clic su **Salva** nella barra dei comandi per salvare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-617">Click **Save** in the command bar to save the changes.</span></span>

<a id="Ex5Task2"></a>
#### <a name="task-2--load-testing-with-visual-studio"></a><span data-ttu-id="1cfc3-618">Attività 2: test di carico con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="1cfc3-618">Task 2 – Load Testing with Visual Studio</span></span>

<span data-ttu-id="1cfc3-619">Ora che è stata configurata la **scalabilità** automatica, si creerà un **progetto di test di carico e prestazioni Web** in Visual Studio per generare un carico di CPU nell'app Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-619">Now that **Autoscale** has been configured, you will create a **Web Performance and Load Test Project** in Visual Studio to generate some CPU load on your web app.</span></span>

1. <span data-ttu-id="1cfc3-620">Aprire **Visual Studio Ultimate 2013** e selezionare **file | Nuovo | Progetto...** per avviare una nuova soluzione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-620">Open **Visual Studio Ultimate 2013** and select **File | New | Project...** to start a new solution.</span></span>

    <span data-ttu-id="1cfc3-621">![Creazione di un nuovo progetto](maintainable-azure-websites-managing-change-and-scale/_static/image79.png "Crea un nuovo progetto")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-621">![Creating a new project](maintainable-azure-websites-managing-change-and-scale/_static/image79.png "Creating a new project")</span></span>

    <span data-ttu-id="1cfc3-622">*Creazione di un nuovo progetto*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-622">*Creating a new project*</span></span>
2. <span data-ttu-id="1cfc3-623">Nella finestra di dialogo **nuovo progetto** selezionare **progetto di test di carico e prestazioni Web** nell' **oggetto C# visivo | Scheda test** . Assicurarsi che sia selezionato **.NET Framework 4,5** , denominare il progetto *WebAndLoadTestProject*, scegliere un **percorso** e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-623">In the **New Project** dialog box, select **Web Performance and Load Test Project** under the **Visual C# | Test** tab. Make sure **.NET Framework 4.5** is selected, name the project *WebAndLoadTestProject*, choose a **Location** and click **OK**.</span></span>

    <span data-ttu-id="1cfc3-624">![Creazione di un nuovo progetto di test di carico e Web](maintainable-azure-websites-managing-change-and-scale/_static/image80.png "Creazione di un nuovo progetto di test di carico e Web")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-624">![Creating a new Web and Load Test project](maintainable-azure-websites-managing-change-and-scale/_static/image80.png "Creating a new Web and Load Test project")</span></span>

    <span data-ttu-id="1cfc3-625">*Creazione di un nuovo progetto di test di carico e Web*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-625">*Creating a new Web and Load Test project*</span></span>
3. <span data-ttu-id="1cfc3-626">Nel **WebTest1. WebTest** fare clic con il pulsante destro del mouse sul nodo **WebTest1** e scegliere **Aggiungi richiesta**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-626">In the **WebTest1.webtest** Right-click the **WebTest1** node and click **Add Request**.</span></span>

    <span data-ttu-id="1cfc3-627">![Aggiunta di una richiesta a WebTest1](maintainable-azure-websites-managing-change-and-scale/_static/image81.png "Aggiunta di una richiesta a WebTest1")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-627">![Adding a request to WebTest1](maintainable-azure-websites-managing-change-and-scale/_static/image81.png "Adding a request to WebTest1")</span></span>

    <span data-ttu-id="1cfc3-628">*Aggiunta di una richiesta a WebTest1*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-628">*Adding a request to WebTest1*</span></span>
4. <span data-ttu-id="1cfc3-629">Nella finestra **Proprietà** del nuovo nodo request aggiornare la proprietà **URL** in modo che punti all'URL dell'app web, ad esempio *[http://geek-quiz.azurewebsites.net/](http://geek-quiz.azurewebsites.net/)* .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-629">In the **Properties** window of the new request node, update the **Url** property to point to the URL of your web app (e.g. *[http://geek-quiz.azurewebsites.net/](http://geek-quiz.azurewebsites.net/)*).</span></span>

    <span data-ttu-id="1cfc3-630">![Modifica della proprietà URL](maintainable-azure-websites-managing-change-and-scale/_static/image82.png "Modifica della proprietà URL")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-630">![Changing the Url property](maintainable-azure-websites-managing-change-and-scale/_static/image82.png "Changing the Url property")</span></span>

    <span data-ttu-id="1cfc3-631">*Modifica della proprietà URL*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-631">*Changing the Url property*</span></span>
5. <span data-ttu-id="1cfc3-632">Nella finestra **WebTest1. WebTest** fare clic con il pulsante destro del mouse su **WebTest1** e scegliere **Aggiungi ciclo...** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-632">In the **WebTest1.webtest** window, right-click **WebTest1** and click **Add Loop...**.</span></span>

    <span data-ttu-id="1cfc3-633">![Aggiunta di un ciclo a WebTest1](maintainable-azure-websites-managing-change-and-scale/_static/image83.png "Aggiunta di un ciclo a WebTest1")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-633">![Adding a loop to WebTest1](maintainable-azure-websites-managing-change-and-scale/_static/image83.png "Adding a loop to WebTest1")</span></span>

    <span data-ttu-id="1cfc3-634">*Aggiunta di un ciclo a WebTest1*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-634">*Adding a loop to WebTest1*</span></span>
6. <span data-ttu-id="1cfc3-635">Nella finestra di dialogo **Aggiungi regola condizionale ed elementi a loop** selezionare la regola **ciclo for** e modificare le proprietà seguenti.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-635">In the **Add Conditional Rule and Items to Loop** dialog box, select the **For Loop** rule and modify the following properties.</span></span>

   1. <span data-ttu-id="1cfc3-636">**Valore di terminazione:** 1000</span><span class="sxs-lookup"><span data-stu-id="1cfc3-636">**Terminating value:** 1000</span></span>
   2. <span data-ttu-id="1cfc3-637">**Nome parametro di contesto:** Iteratore</span><span class="sxs-lookup"><span data-stu-id="1cfc3-637">**Context Parameter Name:** Iterator</span></span>
   3. <span data-ttu-id="1cfc3-638">**Valore di incremento:** 1</span><span class="sxs-lookup"><span data-stu-id="1cfc3-638">**Increment Value:** 1</span></span>

      <span data-ttu-id="1cfc3-639">![Selezione della regola ciclo for e aggiornamento delle proprietà](maintainable-azure-websites-managing-change-and-scale/_static/image84.png "Selezione della regola ciclo for e aggiornamento delle proprietà")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-639">![Selecting the For Loop rule and updating the properties](maintainable-azure-websites-managing-change-and-scale/_static/image84.png "Selecting the For Loop rule and updating the properties")</span></span>

      <span data-ttu-id="1cfc3-640">*Selezione della regola ciclo for e aggiornamento delle proprietà*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-640">*Selecting the For Loop rule and updating the properties*</span></span>
7. <span data-ttu-id="1cfc3-641">Nella sezione **Items in loop** selezionare la richiesta creata in precedenza per essere il primo e l'ultimo elemento per il ciclo.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-641">Under the **Items in loop** section, select the request you created previously to be the first and last item for the loop.</span></span> <span data-ttu-id="1cfc3-642">Fare clic su **OK** per continuare.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-642">Click **OK** to continue.</span></span>

    <span data-ttu-id="1cfc3-643">![Selezione del primo e dell'ultimo elemento per il ciclo](maintainable-azure-websites-managing-change-and-scale/_static/image85.png "Selezione del primo e dell'ultimo elemento per il ciclo")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-643">![Selecting the first and last items for the loop](maintainable-azure-websites-managing-change-and-scale/_static/image85.png "Selecting the first and last items for the loop")</span></span>

    <span data-ttu-id="1cfc3-644">*Selezione del primo e dell'ultimo elemento per il ciclo*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-644">*Selecting the first and last items for the loop*</span></span>
8. <span data-ttu-id="1cfc3-645">In **Esplora soluzioni**fare clic con il pulsante destro del mouse sul progetto **WebAndLoadTestProject** , espandere il menu **Aggiungi** e selezionare **test di carico...** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-645">In **Solution Explorer**, right-click the **WebAndLoadTestProject** project, expand the **Add** menu and select **Load Test...**.</span></span>

    <span data-ttu-id="1cfc3-646">![Aggiunta di un test di carico al progetto WebAndLoadTestProject](maintainable-azure-websites-managing-change-and-scale/_static/image86.png "Aggiunta di un test di carico al progetto WebAndLoadTestProject")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-646">![Adding a Load Test to the WebAndLoadTestProject project](maintainable-azure-websites-managing-change-and-scale/_static/image86.png "Adding a Load Test to the WebAndLoadTestProject project")</span></span>

    <span data-ttu-id="1cfc3-647">*Aggiunta di un test di carico al progetto WebAndLoadTestProject*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-647">*Adding a Load Test to the WebAndLoadTestProject project*</span></span>
9. <span data-ttu-id="1cfc3-648">Nella finestra di dialogo **nuovo creazione guidata test di carico** fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-648">In the **New Load Test Wizard** dialog box, click **Next**.</span></span>

    <span data-ttu-id="1cfc3-649">![Nuovo Creazione guidata test di carico](maintainable-azure-websites-managing-change-and-scale/_static/image87.png "Nuovo Creazione guidata test di carico")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-649">![New Load Test Wizard](maintainable-azure-websites-managing-change-and-scale/_static/image87.png "New Load Test Wizard")</span></span>

    <span data-ttu-id="1cfc3-650">*Nuovo Creazione guidata test di carico*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-650">*New Load Test Wizard*</span></span>
10. <span data-ttu-id="1cfc3-651">Nella pagina **scenario** selezionare **non usare i tempi interazione** , quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-651">In the **Scenario** page, select **Do not use think times** and click **Next**.</span></span>

    <span data-ttu-id="1cfc3-652">![Selezione di non utilizzare i tempi interazione](maintainable-azure-websites-managing-change-and-scale/_static/image88.png "Selezione di non utilizzare i tempi interazione")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-652">![Selecting not to use think times](maintainable-azure-websites-managing-change-and-scale/_static/image88.png "Selecting not to use think times")</span></span>

    <span data-ttu-id="1cfc3-653">*Selezione di non utilizzare i tempi interazione*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-653">*Selecting not to use think times*</span></span>
11. <span data-ttu-id="1cfc3-654">Nella pagina **modello di carico** verificare che sia selezionata l'opzione **carico costante** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-654">In the **Load Pattern** page, make sure that the **Constant Load** option is selected.</span></span> <span data-ttu-id="1cfc3-655">Modificare l'impostazione **conteggio** utenti su **250** utenti e fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-655">Change the **User Count** setting to **250** users and click **Next**.</span></span>

    <span data-ttu-id="1cfc3-656">![Modifica del numero di utenti a 250](maintainable-azure-websites-managing-change-and-scale/_static/image89.png "Modifica del numero di utenti a 250")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-656">![Changing the user count to 250](maintainable-azure-websites-managing-change-and-scale/_static/image89.png "Changing the user count to 250")</span></span>

    <span data-ttu-id="1cfc3-657">*Modifica del numero di utenti a 250*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-657">*Changing the user count to 250*</span></span>
12. <span data-ttu-id="1cfc3-658">Nella pagina **modello di combinazione di test** selezionare in **base all'ordine sequenziale dei test** e fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-658">In the **Test Mix Model** page, select **Based on sequential test order** and click **Next**.</span></span>

    <span data-ttu-id="1cfc3-659">![Selezione del modello di combinazione di test](maintainable-azure-websites-managing-change-and-scale/_static/image90.png "Selezione del modello di combinazione di test")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-659">![Selecting the test mix model](maintainable-azure-websites-managing-change-and-scale/_static/image90.png "Selecting the test mix model")</span></span>

    <span data-ttu-id="1cfc3-660">*Selezione del modello di combinazione di test*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-660">*Selecting the test mix model*</span></span>
13. <span data-ttu-id="1cfc3-661">Nella pagina **modello di combinazione di test** fare clic su **Aggiungi** per aggiungere un test alla combinazione.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-661">In the **Test Mix Model** page, click **Add...** to add a test to the mix.</span></span>

    <span data-ttu-id="1cfc3-662">![Aggiunta di un test alla combinazione di test](maintainable-azure-websites-managing-change-and-scale/_static/image91.png "Aggiunta di un test alla combinazione di test")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-662">![Adding a test to the test mix](maintainable-azure-websites-managing-change-and-scale/_static/image91.png "Adding a test to the test mix")</span></span>

    <span data-ttu-id="1cfc3-663">*Aggiunta di un test alla combinazione di test*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-663">*Adding a test to the test mix*</span></span>
14. <span data-ttu-id="1cfc3-664">Nella finestra di dialogo **Aggiungi test** fare doppio clic su **WebTest1** per aggiungere il test all'elenco dei **test selezionati** .</span><span class="sxs-lookup"><span data-stu-id="1cfc3-664">In the **Add Tests** dialog box, double-click **WebTest1** to add the test to the **Selected tests** list.</span></span> <span data-ttu-id="1cfc3-665">Fare clic su **OK** per continuare.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-665">Click **OK** to continue.</span></span>

    <span data-ttu-id="1cfc3-666">![Aggiunta del test WebTest1](maintainable-azure-websites-managing-change-and-scale/_static/image92.png "Aggiunta del test WebTest1")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-666">![Adding the WebTest1 test](maintainable-azure-websites-managing-change-and-scale/_static/image92.png "Adding the WebTest1 test")</span></span>

    <span data-ttu-id="1cfc3-667">*Aggiunta del test WebTest1*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-667">*Adding the WebTest1 test*</span></span>
15. <span data-ttu-id="1cfc3-668">Tornare alla pagina di **combinazione di test** e fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-668">Back in the **Test Mix** page, click **Next**.</span></span>

    <span data-ttu-id="1cfc3-669">![Completamento della pagina di combinazione di test](maintainable-azure-websites-managing-change-and-scale/_static/image93.png "Completamento della pagina di combinazione di test")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-669">![Completing the Test Mix page](maintainable-azure-websites-managing-change-and-scale/_static/image93.png "Completing the Test Mix page")</span></span>

    <span data-ttu-id="1cfc3-670">*Completamento della pagina di combinazione di test*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-670">*Completing the Test Mix page*</span></span>
16. <span data-ttu-id="1cfc3-671">Nella pagina **combinazione di reti** fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-671">In the **Network Mix** page, click **Next**.</span></span>

    <span data-ttu-id="1cfc3-672">![Fare clic su Avanti nella pagina combinazione di reti](maintainable-azure-websites-managing-change-and-scale/_static/image94.png "Fare clic su Avanti nella pagina combinazione di reti")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-672">![Clicking next in the Network Mix page](maintainable-azure-websites-managing-change-and-scale/_static/image94.png "Clicking next in the Network Mix page")</span></span>

    <span data-ttu-id="1cfc3-673">*Fare clic su Avanti nella pagina combinazione di reti*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-673">*Clicking next in the Network Mix page*</span></span>
17. <span data-ttu-id="1cfc3-674">Nella pagina di **combinazione del browser** selezionare **Internet Explorer 10,0** come tipo di browser e fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-674">In the **Browser Mix** page, select **Internet Explorer 10.0** as the browser type and click **Next**.</span></span>

    <span data-ttu-id="1cfc3-675">![Selezione del tipo di browser](maintainable-azure-websites-managing-change-and-scale/_static/image95.png "Selezione del tipo di browser")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-675">![Selecting the browser type](maintainable-azure-websites-managing-change-and-scale/_static/image95.png "Selecting the browser type")</span></span>

    <span data-ttu-id="1cfc3-676">*Selezione del tipo di browser*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-676">*Selecting the browser type*</span></span>
18. <span data-ttu-id="1cfc3-677">Nella pagina **insiemi di contatori** fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-677">In the **Counter Sets** page, click **Next**.</span></span>

    <span data-ttu-id="1cfc3-678">![Fare clic su Avanti nella pagina insiemi di contatori](maintainable-azure-websites-managing-change-and-scale/_static/image96.png "Fare clic su Avanti nella pagina insiemi di contatori")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-678">![Clicking Next in the Counter Sets page](maintainable-azure-websites-managing-change-and-scale/_static/image96.png "Clicking Next in the Counter Sets page")</span></span>

    <span data-ttu-id="1cfc3-679">*Fare clic su Avanti nella pagina insiemi di contatori*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-679">*Clicking Next in the Counter Sets page*</span></span>
19. <span data-ttu-id="1cfc3-680">Nella pagina **impostazioni di esecuzione** impostare la **durata del test di carico** su **5 minuti** e fare clic su **fine**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-680">In the **Run Settings** page, set the **Load test duration** to **5 minutes** and click **Finish**.</span></span>

    <span data-ttu-id="1cfc3-681">![Impostazione della durata del test di carico su 5 minuti](maintainable-azure-websites-managing-change-and-scale/_static/image97.png "Impostazione della durata del test di carico su 5 minuti")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-681">![Setting the load test duration to 5 minutes](maintainable-azure-websites-managing-change-and-scale/_static/image97.png "Setting the load test duration to 5 minutes")</span></span>

    <span data-ttu-id="1cfc3-682">*Impostazione della durata del test di carico su 5 minuti*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-682">*Setting the load test duration to 5 minutes*</span></span>
20. <span data-ttu-id="1cfc3-683">In **Esplora soluzioni**fare doppio clic sul file **local. Settings** per esplorare le impostazioni di test.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-683">In **Solution Explorer**, double-click the **Local.settings** file to explore the test settings.</span></span> <span data-ttu-id="1cfc3-684">Per impostazione predefinita, Visual Studio usa il computer locale per eseguire i test.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-684">By default, Visual Studio uses your local computer to run the tests.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-685">In alternativa, è possibile configurare il progetto di test per eseguire i test di carico nel cloud usando **Azure test plans**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-685">Alternatively, you can configure your test project to run the load tests in the cloud using **Azure Test Plans**.</span></span> <span data-ttu-id="1cfc3-686">Azure Test Plans fornisce un servizio di test di carico basato sul cloud che simula un carico più realistico, evitando vincoli di ambiente locale come la capacità della CPU, la memoria disponibile e la larghezza di banda di rete.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-686">Azure Test Plans provides a cloud-based load testing service that simulates a more realistic load, avoiding local environment constraints like CPU capacity, available memory, and network bandwidth.</span></span> <span data-ttu-id="1cfc3-687">Per ulteriori informazioni sull'utilizzo di Azure Test Plans per eseguire i test di carico, vedere [scenari di test di carico](/azure/devops/test/load-test/overview?view=vsts).</span><span class="sxs-lookup"><span data-stu-id="1cfc3-687">For more information about using Azure Test Plans to run load tests, see [Load testing scenarios](/azure/devops/test/load-test/overview?view=vsts).</span></span>

    ![Impostazioni test](maintainable-azure-websites-managing-change-and-scale/_static/image98.png)

<a id="Ex5Task3"></a>
#### <a name="task-3--autoscale-verification"></a><span data-ttu-id="1cfc3-689">Attività 3: verifica della scalabilità automatica</span><span class="sxs-lookup"><span data-stu-id="1cfc3-689">Task 3 – Autoscale Verification</span></span>

<span data-ttu-id="1cfc3-690">A questo punto si eseguirà il test di carico creato nell'attività precedente e si verificherà il comportamento dell'app Web sotto carico.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-690">You will now execute the load test you created in the previous task and see how your web app behaves under load.</span></span>

1. <span data-ttu-id="1cfc3-691">In **Esplora soluzioni**fare doppio clic su **LoadTest1. LoadTest** per aprire il test di carico.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-691">In **Solution Explorer**, double-click **LoadTest1.loadtest** to open the load test.</span></span>

    <span data-ttu-id="1cfc3-692">![Apertura di LoadTest1. LoadTest](maintainable-azure-websites-managing-change-and-scale/_static/image99.png "Apertura di LoadTest1. LoadTest")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-692">![Opening LoadTest1.loadtest](maintainable-azure-websites-managing-change-and-scale/_static/image99.png "Opening LoadTest1.loadtest")</span></span>

    <span data-ttu-id="1cfc3-693">*Apertura di LoadTest1. LoadTest*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-693">*Opening LoadTest1.loadtest*</span></span>
2. <span data-ttu-id="1cfc3-694">Nella finestra **LoadTest1. LoadTest** fare clic sul primo pulsante nella casella degli strumenti per eseguire il test di carico.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-694">In the **LoadTest1.loadtest** window, click the first button in the toolbox to run the load test.</span></span>

    <span data-ttu-id="1cfc3-695">![Esecuzione del test di carico](maintainable-azure-websites-managing-change-and-scale/_static/image100.png "Esecuzione del test di carico")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-695">![Running the load test](maintainable-azure-websites-managing-change-and-scale/_static/image100.png "Running the load test")</span></span>

    <span data-ttu-id="1cfc3-696">*Esecuzione del test di carico*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-696">*Running the load test*</span></span>
3. <span data-ttu-id="1cfc3-697">Attendere il completamento del test di carico.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-697">Wait until the load test completes.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-698">Il test di carico simula più utenti che inviano richieste all'app Web contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-698">The load test simulates multiple users that send requests to the web app simultaneously.</span></span> <span data-ttu-id="1cfc3-699">Quando il test è in esecuzione, è possibile monitorare i contatori disponibili per rilevare eventuali errori, avvisi o altre informazioni relative all'esecuzione del test di carico.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-699">When the test is running, you can monitor the available counters to detect any errors, warnings or other information related to your load test run.</span></span>

    <span data-ttu-id="1cfc3-700">![Test di carico in esecuzione](maintainable-azure-websites-managing-change-and-scale/_static/image101.png "In attesa del completamento del test di carico")</span><span class="sxs-lookup"><span data-stu-id="1cfc3-700">![Load test running](maintainable-azure-websites-managing-change-and-scale/_static/image101.png "Waiting until the load test completes")</span></span>

    <span data-ttu-id="1cfc3-701">*Test di carico in esecuzione*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-701">*Load test running*</span></span>
4. <span data-ttu-id="1cfc3-702">Al termine del test, tornare al portale di gestione e passare alla pagina **scalabilità** dell'app Web.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-702">Once the test completes, go back to the management portal and navigate to the **Scale** page of your web app.</span></span> <span data-ttu-id="1cfc3-703">Nella sezione **Capacity (capacità** ) si noterà che nel grafico è stata distribuita automaticamente una nuova istanza.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-703">Under the **capacity** section, you should see in the graph that a new instance was automatically deployed.</span></span>

    ![Nuova istanza distribuita automaticamente](maintainable-azure-websites-managing-change-and-scale/_static/image102.png)

    <span data-ttu-id="1cfc3-705">*Nuova istanza distribuita automaticamente*</span><span class="sxs-lookup"><span data-stu-id="1cfc3-705">*New instance automatically deployed*</span></span>

    > [!NOTE]
    > <span data-ttu-id="1cfc3-706">Potrebbero essere necessari alcuni minuti prima che le modifiche vengano visualizzate nel grafico. Premere **CTRL + F5** periodicamente per aggiornare la pagina.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-706">It may take several minutes for the changes to appear in the graph (press **CTRL + F5** periodically to refresh the page).</span></span> <span data-ttu-id="1cfc3-707">Se non vengono visualizzate modifiche, è possibile provare a eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="1cfc3-707">If you do not see any changes, you can try the following:</span></span>
    >
    > - <span data-ttu-id="1cfc3-708">Aumentare la durata del test di carico, ad esempio a **10 minuti**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-708">Increase the duration of the load test (e.g. to **10 minutes**)</span></span>
    > - <span data-ttu-id="1cfc3-709">Ridurre i valori minimo e massimo dell'intervallo di **CPU di destinazione** nella configurazione di scalabilità automatica dell'app Web</span><span class="sxs-lookup"><span data-stu-id="1cfc3-709">Reduce the maximum and minimum values of the **Target CPU** range in the Autoscale configuration of your web app</span></span>
    > - <span data-ttu-id="1cfc3-710">Eseguire il test di carico nel cloud con **Azure test plans**.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-710">Run the load test in the cloud with **Azure Test Plans**.</span></span> <span data-ttu-id="1cfc3-711">Altre informazioni sono disponibili [qui](/azure/devops/test/load-test/index?view=vsts)</span><span class="sxs-lookup"><span data-stu-id="1cfc3-711">More information [here](/azure/devops/test/load-test/index?view=vsts)</span></span>

---

<a id="Summary"></a>
## <a name="summary"></a><span data-ttu-id="1cfc3-712">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="1cfc3-712">Summary</span></span>

<span data-ttu-id="1cfc3-713">In questo laboratorio pratico si è appreso come configurare e distribuire l'applicazione in app Web di produzione in Azure.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-713">In this hands-on lab, you learned how to set up and deploy your application to production web apps in Azure.</span></span> <span data-ttu-id="1cfc3-714">Per iniziare, è necessario rilevare e aggiornare i database usando **migrazioni Code First di Entity Framework**, quindi continuare distribuendo nuove versioni del sito usando **git** ed eseguendo il rollback alla versione stabile più recente del sito.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-714">You started by detecting and updating your databases using **Entity Framework Code First Migrations**, then continued by deploying new versions of your site using **Git** and performing rollbacks to the latest stable version of your site.</span></span> <span data-ttu-id="1cfc3-715">Si è inoltre appreso come ridimensionare l'app usando l'archiviazione per spostare il contenuto statico in un contenitore BLOB.</span><span class="sxs-lookup"><span data-stu-id="1cfc3-715">Additionally, you learned how to scale your app using Storage to move your static content to a Blob container.</span></span>
