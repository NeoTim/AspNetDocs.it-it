---
uid: mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-vb
title: Creazione di classi di modelli con Entity Framework (VB) Documenti Microsoft
author: rick-anderson
description: In questa esercitazione si apprenderà come usare ASP.NET MVC con Microsoft Entity Framework. Informazioni su come utilizzare la Creazione guidata entità per creare un'entità ADO.NET Da...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: ff8322c9-12f3-4e24-aba6-a38046b9bb0d
msc.legacyurl: /mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-vb
msc.type: authoredcontent
ms.openlocfilehash: cdba91969a6ed9c02965999bbc48d5c5cdea140d
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542651"
---
# <a name="creating-model-classes-with-the-entity-framework-vb"></a><span data-ttu-id="472d5-104">Creazione di classi di modelli con Entity Framework (VB)</span><span class="sxs-lookup"><span data-stu-id="472d5-104">Creating Model Classes with the Entity Framework (VB)</span></span>

<span data-ttu-id="472d5-105">da parte [di Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="472d5-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="472d5-106">In questa esercitazione si apprenderà come usare ASP.NET MVC con Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="472d5-106">In this tutorial, you learn how to use ASP.NET MVC with the Microsoft Entity Framework.</span></span> <span data-ttu-id="472d5-107">Viene illustrato come utilizzare la Creazione guidata entità per creare un ADO.NET Entity Data Model.</span><span class="sxs-lookup"><span data-stu-id="472d5-107">You learn how to use the Entity Wizard to create an ADO.NET Entity Data Model.</span></span> <span data-ttu-id="472d5-108">Nel corso di questa esercitazione viene compilata un'applicazione Web che illustra come selezionare, inserire, aggiornare ed eliminare i dati del database tramite Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="472d5-108">Over the course of this tutorial, we build a web application that illustrates how to select, insert, update, and delete database data by using the Entity Framework.</span></span>

<span data-ttu-id="472d5-109">L'obiettivo di questa esercitazione è spiegare come è possibile creare classi di accesso ai dati utilizzando Microsoft Entity Framework durante la compilazione di un'applicazione MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="472d5-109">The goal of this tutorial is to explain how you can create data access classes using the Microsoft Entity Framework when building an ASP.NET MVC application.</span></span> <span data-ttu-id="472d5-110">In questa esercitazione si presuppone che non sia stata previa conoscenza di Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="472d5-110">This tutorial assumes no previous knowledge of the Microsoft Entity Framework.</span></span> <span data-ttu-id="472d5-111">Alla fine di questa esercitazione, si capirà come utilizzare Entity Framework per selezionare, inserire, aggiornare ed eliminare i record del database.</span><span class="sxs-lookup"><span data-stu-id="472d5-111">By the end of this tutorial, you'll understand how to use the Entity Framework to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="472d5-112">Microsoft Entity Framework è uno strumento O/RM (Object Relational Mapping) che consente di generare automaticamente un livello di accesso ai dati da un database.</span><span class="sxs-lookup"><span data-stu-id="472d5-112">The Microsoft Entity Framework is an Object Relational Mapping (O/RM) tool that enables you to generate a data access layer from a database automatically.</span></span> <span data-ttu-id="472d5-113">Entity Framework consente di evitare il noioso lavoro di compilazione delle classi di accesso ai dati a mano.</span><span class="sxs-lookup"><span data-stu-id="472d5-113">The Entity Framework enables you to avoid the tedious work of building your data access classes by hand.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="472d5-114">Non esiste una connessione essenziale tra ASP.NET MVC e Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="472d5-114">There is no essential connection between ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="472d5-115">Esistono diverse alternative a Entity Framework che è possibile utilizzare con ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="472d5-115">There are several alternatives to the Entity Framework that you can use with ASP.NET MVC.</span></span> <span data-ttu-id="472d5-116">Ad esempio, è possibile compilare le classi del modello MVC utilizzando altri strumenti O/RM, ad esempio Microsoft LINQ to SQL, NHibernate o SubSonic.For example, you can build your MVC Model classes using other O/RM tools such as Microsoft LINQ to SQL, NHibernate, or SubSonic.</span><span class="sxs-lookup"><span data-stu-id="472d5-116">For example, you can build your MVC Model classes using other O/RM tools such as Microsoft LINQ to SQL, NHibernate, or SubSonic.</span></span>

<span data-ttu-id="472d5-117">Per illustrare come è possibile utilizzare Microsoft Entity Framework con ASP.NET MVC, verrà compilata una semplice applicazione di esempio.</span><span class="sxs-lookup"><span data-stu-id="472d5-117">In order to illustrate how you can use the Microsoft Entity Framework with ASP.NET MVC, we'll build a simple sample application.</span></span> <span data-ttu-id="472d5-118">Verrà creata un'applicazione Movie Database che consente di visualizzare e modificare i record del database dei film.</span><span class="sxs-lookup"><span data-stu-id="472d5-118">We'll create a Movie Database application that enables you to display and edit movie database records.</span></span>

<span data-ttu-id="472d5-119">In questa esercitazione si presuppone che si dispone di Visual Studio 2008 o Visual Web Developer 2008 con Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="472d5-119">This tutorial assumes that you have Visual Studio 2008 or Visual Web Developer 2008 with Service Pack 1.</span></span> <span data-ttu-id="472d5-120">È necessario il Service Pack 1 per utilizzare Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="472d5-120">You need Service Pack 1 in order to use the Entity Framework.</span></span> <span data-ttu-id="472d5-121">È possibile scaricare Visual Studio 2008 Service Pack 1 o Visual Web Developer con Service Pack 1 dal seguente indirizzo:</span><span class="sxs-lookup"><span data-stu-id="472d5-121">You can download Visual Studio 2008 Service Pack 1 or Visual Web Developer with Service Pack 1 from the following address:</span></span>

> [https://www.asp.net/downloads/](https://www.asp.net/downloads)

## <a name="creating-the-movie-sample-database"></a><span data-ttu-id="472d5-122">Creazione del database di esempio di filmatoCreating the Movie Sample Database</span><span class="sxs-lookup"><span data-stu-id="472d5-122">Creating the Movie Sample Database</span></span>

<span data-ttu-id="472d5-123">L'applicazione Movie Database utilizza una tabella di database denominata Movies che contiene le seguenti colonne:</span><span class="sxs-lookup"><span data-stu-id="472d5-123">The Movie Database application uses a database table named Movies that contains the following columns:</span></span>

| <span data-ttu-id="472d5-124">Nome colonna</span><span class="sxs-lookup"><span data-stu-id="472d5-124">Column Name</span></span> | <span data-ttu-id="472d5-125">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="472d5-125">Data Type</span></span> | <span data-ttu-id="472d5-126">Consentire valori Null?</span><span class="sxs-lookup"><span data-stu-id="472d5-126">Allow Nulls?</span></span> | <span data-ttu-id="472d5-127">La chiave primaria è?</span><span class="sxs-lookup"><span data-stu-id="472d5-127">Is Primary Key?</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="472d5-128">ID</span><span class="sxs-lookup"><span data-stu-id="472d5-128">Id</span></span> | <span data-ttu-id="472d5-129">INT</span><span class="sxs-lookup"><span data-stu-id="472d5-129">int</span></span> | <span data-ttu-id="472d5-130">False</span><span class="sxs-lookup"><span data-stu-id="472d5-130">False</span></span> | <span data-ttu-id="472d5-131">True</span><span class="sxs-lookup"><span data-stu-id="472d5-131">True</span></span> |
| <span data-ttu-id="472d5-132">Titolo</span><span class="sxs-lookup"><span data-stu-id="472d5-132">Title</span></span> | <span data-ttu-id="472d5-133">nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="472d5-133">nvarchar(100)</span></span> | <span data-ttu-id="472d5-134">False</span><span class="sxs-lookup"><span data-stu-id="472d5-134">False</span></span> | <span data-ttu-id="472d5-135">False</span><span class="sxs-lookup"><span data-stu-id="472d5-135">False</span></span> |
| <span data-ttu-id="472d5-136">Responsabile</span><span class="sxs-lookup"><span data-stu-id="472d5-136">Director</span></span> | <span data-ttu-id="472d5-137">nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="472d5-137">nvarchar(100)</span></span> | <span data-ttu-id="472d5-138">False</span><span class="sxs-lookup"><span data-stu-id="472d5-138">False</span></span> | <span data-ttu-id="472d5-139">False</span><span class="sxs-lookup"><span data-stu-id="472d5-139">False</span></span> |

<span data-ttu-id="472d5-140">È possibile aggiungere questa tabella a un progetto MVC ASP.NET attenendosi alla seguente procedura:</span><span class="sxs-lookup"><span data-stu-id="472d5-140">You can add this table to an ASP.NET MVC project by following these steps:</span></span>

1. <span data-ttu-id="472d5-141">Fare clic con\_il pulsante destro del mouse sulla cartella Dati app nella finestra Esplora soluzioni e selezionare l'opzione di menu **Aggiungi, Nuovo elemento.**</span><span class="sxs-lookup"><span data-stu-id="472d5-141">Right-click the App\_Data folder in the Solution Explorer window and select the menu option **Add, New Item.**</span></span>
2. <span data-ttu-id="472d5-142">Nella finestra di dialogo **Aggiungi nuovo elemento** selezionare Database di SQL **Server**, assegnare al database il nome MoviesDB.mdf e fare clic sul pulsante **Aggiungi.**</span><span class="sxs-lookup"><span data-stu-id="472d5-142">From the **Add New Item** dialog box, select **SQL Server Database**, give the database the name MoviesDB.mdf, and click the **Add** button.</span></span>
3. <span data-ttu-id="472d5-143">Fare doppio clic sul file MoviesDB.mdf per aprire la finestra Esplora server/Esplora database.</span><span class="sxs-lookup"><span data-stu-id="472d5-143">Double-click the MoviesDB.mdf file to open the Server Explorer/Database Explorer window.</span></span>
4. <span data-ttu-id="472d5-144">Espandere la connessione al database MoviesDB.mdf, fare clic con il pulsante destro del mouse sulla cartella Tabelle e selezionare l'opzione di menu **Aggiungi nuova tabella**.</span><span class="sxs-lookup"><span data-stu-id="472d5-144">Expand the MoviesDB.mdf database connection, right-click the Tables folder, and select the menu option **Add New Table**.</span></span>
5. <span data-ttu-id="472d5-145">In Progettazione tabelle aggiungere le colonne Id, Titolo e Director.</span><span class="sxs-lookup"><span data-stu-id="472d5-145">In the Table Designer, add the Id, Title, and Director columns.</span></span>
6. <span data-ttu-id="472d5-146">Fare clic sul pulsante **Salva** (con l'icona del dischetto) per salvare la nuova tabella con il nome Film.</span><span class="sxs-lookup"><span data-stu-id="472d5-146">Click the **Save** button (it has the icon of the floppy) to save the new table with the name Movies.</span></span>

<span data-ttu-id="472d5-147">Dopo aver creato la tabella di database Movies, è necessario aggiungere alcuni dati di esempio alla tabella.</span><span class="sxs-lookup"><span data-stu-id="472d5-147">After you create the Movies database table, you should add some sample data to the table.</span></span> <span data-ttu-id="472d5-148">Fare clic con il pulsante destro del mouse sulla tabella Film e selezionare l'opzione di menu **Mostra dati tabella**.</span><span class="sxs-lookup"><span data-stu-id="472d5-148">Right-click the Movies table and select the menu option **Show Table Data**.</span></span> <span data-ttu-id="472d5-149">È possibile immettere dati di film falsi nella griglia visualizzata.</span><span class="sxs-lookup"><span data-stu-id="472d5-149">You can enter fake movie data into the grid that appears.</span></span>

## <a name="creating-the-adonet-entity-data-model"></a><span data-ttu-id="472d5-150">Creazione del ADO.NET Entity Data Model</span><span class="sxs-lookup"><span data-stu-id="472d5-150">Creating the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="472d5-151">Per utilizzare Entity Framework, è necessario creare un Entity Data Model.</span><span class="sxs-lookup"><span data-stu-id="472d5-151">In order to use the Entity Framework, you need to create an Entity Data Model.</span></span> <span data-ttu-id="472d5-152">È possibile sfruttare la procedura guidata Di Visual Studio *Entity Data Model* per generare automaticamente un Entity Data Model da un database.</span><span class="sxs-lookup"><span data-stu-id="472d5-152">You can take advantage of the Visual Studio *Entity Data Model Wizard* to generate an Entity Data Model from a database automatically.</span></span>

<span data-ttu-id="472d5-153">A tale scopo, seguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="472d5-153">Follow these steps:</span></span>

1. <span data-ttu-id="472d5-154">Fare clic con il pulsante destro del mouse sulla cartella Modelli nella finestra Esplora soluzioni e selezionare l'opzione di menu **Aggiungi, Nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="472d5-154">Right-click the Models folder in the Solution Explorer window and select the menu option **Add, New Item**.</span></span>
2. <span data-ttu-id="472d5-155">Nella finestra di dialogo **Aggiungi nuovo elemento** selezionare la categoria Dati (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="472d5-155">In the **Add New Item** dialog, select the Data category (see Figure 1).</span></span>
3. <span data-ttu-id="472d5-156">Selezionare il modello **ADO.NET Entity Data Model,** assegnare a Entity Data Model il nome MoviesDBModel.edmx e fare clic sul pulsante **Aggiungi.**</span><span class="sxs-lookup"><span data-stu-id="472d5-156">Select the **ADO.NET Entity Data Model** template, give the Entity Data Model the name MoviesDBModel.edmx, and click the **Add** button.</span></span> <span data-ttu-id="472d5-157">Facendo clic sul pulsante **Aggiungi** viene avviata la Creazione guidata modello di dati.</span><span class="sxs-lookup"><span data-stu-id="472d5-157">Clicking the **Add** button launches the Data Model Wizard.</span></span>
4. <span data-ttu-id="472d5-158">Nel passaggio **Scegli contenuto modello** scegliere l'opzione Genera da un **database** e fare clic sul pulsante **Avanti** (vedere la Figura 2).</span><span class="sxs-lookup"><span data-stu-id="472d5-158">In the **Choose Model Contents** step, choose the **Generate from a database** option and click the **Next** button (see Figure 2).</span></span>
5. <span data-ttu-id="472d5-159">Nel passaggio Scegliere la **connessione dati** selezionare la connessione al database MoviesDB.mdf, immettere il nome delle impostazioni di connessione delle entità MoviesDBEntities e fare clic sul pulsante **Avanti** (vedere la figura 3).</span><span class="sxs-lookup"><span data-stu-id="472d5-159">In the **Choose Your Data Connection** step, select the MoviesDB.mdf database connection, enter the entities connection settings name MoviesDBEntities, and click the **Next** button (see Figure 3).</span></span>
6. <span data-ttu-id="472d5-160">Nel passaggio Scegli oggetti di **database** selezionare la tabella di database Movie e fare clic sul pulsante **Fine** (vedere la Figura 4).</span><span class="sxs-lookup"><span data-stu-id="472d5-160">In the **Choose Your Database Objects** step, select the Movie database table and click the **Finish** button (see Figure 4).</span></span>

<span data-ttu-id="472d5-161">Dopo aver completato questi passaggi, verrà aperto ADO.NET Entity Data Model Designer (Entity Designer).</span><span class="sxs-lookup"><span data-stu-id="472d5-161">After you complete these steps, the ADO.NET Entity Data Model Designer (Entity Designer) opens.</span></span>

<span data-ttu-id="472d5-162">**Figura 1 – Creazione di un nuovo Entity Data Model**</span><span class="sxs-lookup"><span data-stu-id="472d5-162">**Figure 1 – Creating a new Entity Data Model**</span></span>

![clip_image002](creating-model-classes-with-the-entity-framework-vb/_static/image1.jpg)

<span data-ttu-id="472d5-164">**Figura 2 – Scegliere il passaggio del contenuto del modello**</span><span class="sxs-lookup"><span data-stu-id="472d5-164">**Figure 2 – Choose Model Contents Step**</span></span>

![clip_image004](creating-model-classes-with-the-entity-framework-vb/_static/image2.jpg)

<span data-ttu-id="472d5-166">**Figura 3 – Scegliere la connessione dati**</span><span class="sxs-lookup"><span data-stu-id="472d5-166">**Figure 3 – Choose Your Data Connection**</span></span>

![clip_image006](creating-model-classes-with-the-entity-framework-vb/_static/image3.jpg)

<span data-ttu-id="472d5-168">**Figura 4 – Scegliere gli oggetti di databaseFigure 4 – Choose Your Database Objects**</span><span class="sxs-lookup"><span data-stu-id="472d5-168">**Figure 4 – Choose Your Database Objects**</span></span>

![clip_image008](creating-model-classes-with-the-entity-framework-vb/_static/image4.jpg)

## <a name="modifying-the-adonet-entity-data-model"></a><span data-ttu-id="472d5-170">Modifica del modello Entity Data Model ADO.NET</span><span class="sxs-lookup"><span data-stu-id="472d5-170">Modifying the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="472d5-171">Dopo aver creato un Entity Data Model, è possibile modificare il modello sfruttando Entity Designer (vedere La Figura 5).</span><span class="sxs-lookup"><span data-stu-id="472d5-171">After you create an Entity Data Model, you can modify the model by taking advantage of the Entity Designer (see Figure 5).</span></span> <span data-ttu-id="472d5-172">È possibile aprire Entity Designer in qualsiasi momento facendo doppio clic sul file MoviesDBModel.edmx contenuto nella cartella Models all'interno della finestra Esplora soluzioni.</span><span class="sxs-lookup"><span data-stu-id="472d5-172">You can open the Entity Designer at any time by double-clicking the MoviesDBModel.edmx file contained in the Models folder within the Solution Explorer window.</span></span>

<span data-ttu-id="472d5-173">**Figura 5 – Il ADO.NET Entity Data Model Designer**</span><span class="sxs-lookup"><span data-stu-id="472d5-173">**Figure 5 – The ADO.NET Entity Data Model Designer**</span></span>

![clip_image010](creating-model-classes-with-the-entity-framework-vb/_static/image5.jpg)

<span data-ttu-id="472d5-175">Ad esempio, è possibile utilizzare Entity Designer per modificare i nomi delle classi generate dalla Creazione guidata dati entity Model.</span><span class="sxs-lookup"><span data-stu-id="472d5-175">For example, you can use the Entity Designer to change the names of the classes that the Entity Model Data Wizard generates.</span></span> <span data-ttu-id="472d5-176">La procedura guidata ha creato una nuova classe di accesso ai dati denominata Movies.The Wizard created a new data access class named Movies.</span><span class="sxs-lookup"><span data-stu-id="472d5-176">The Wizard created a new data access class named Movies.</span></span> <span data-ttu-id="472d5-177">In altre parole, la procedura guidata ha assegnato alla classe lo stesso nome della tabella di database.</span><span class="sxs-lookup"><span data-stu-id="472d5-177">In other words, the Wizard gave the class the very same name as the database table.</span></span> <span data-ttu-id="472d5-178">Poiché useremo questa classe per rappresentare una particolare istanza Movie, è necessario rinominare la classe da Movies a Movie.</span><span class="sxs-lookup"><span data-stu-id="472d5-178">Because we will use this class to represent a particular Movie instance, we should rename the class from Movies to Movie.</span></span>

<span data-ttu-id="472d5-179">Se si desidera rinominare una classe di entità, è possibile fare doppio clic sul nome della classe in Entity Designer e immettere un nuovo nome (vedere Figura 6).</span><span class="sxs-lookup"><span data-stu-id="472d5-179">If you want to rename an entity class, you can double-click on the class name in the Entity Designer and enter a new name (see Figure 6).</span></span> <span data-ttu-id="472d5-180">In alternativa, è possibile modificare il nome di un'entità nella finestra Proprietà dopo aver selezionato un'entità in Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="472d5-180">Alternatively, you can change the name of an entity in the Properties window after selecting an entity in the Entity Designer.</span></span>

<span data-ttu-id="472d5-181">**Figura 6 – Modifica del nome di un'entità**</span><span class="sxs-lookup"><span data-stu-id="472d5-181">**Figure 6 – Changing an entity name**</span></span>

![clip_image012](creating-model-classes-with-the-entity-framework-vb/_static/image6.jpg)

<span data-ttu-id="472d5-183">Ricordarsi di salvare Entity Data Model dopo aver apportato una modifica facendo clic sul pulsante Salva (l'icona del disco floppy).</span><span class="sxs-lookup"><span data-stu-id="472d5-183">Remember to save your Entity Data Model after making a modification by clicking the Save button (the icon of the floppy disk).</span></span> <span data-ttu-id="472d5-184">Dietro le quinte, Entity Designer genera un set di classi di Visual Basic .NET.</span><span class="sxs-lookup"><span data-stu-id="472d5-184">Behind the scenes, the Entity Designer generates a set of Visual Basic .NET classes.</span></span> <span data-ttu-id="472d5-185">È possibile visualizzare queste classi aprendo il file MoviesDBModel.Designer.vb dalla finestra Esplora soluzioni.</span><span class="sxs-lookup"><span data-stu-id="472d5-185">You can view these classes by opening the MoviesDBModel.Designer.vb file from the Solution Explorer window.</span></span>

<span data-ttu-id="472d5-186">Non modificare il codice nel file Designer.vb poiché le modifiche verranno sovrascritte al successivo utilizzo di Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="472d5-186">Don't modify the code in the Designer.vb file since your changes will be overwritten the next time you use the Entity Designer.</span></span> <span data-ttu-id="472d5-187">Se si desidera estendere la funzionalità delle classi di entità definite nel file Designer.vb, è possibile creare *classi parziali* in file separati.</span><span class="sxs-lookup"><span data-stu-id="472d5-187">If you want to extend the functionality of the entity classes defined in the Designer.vb file then you can create *partial classes* in separate files.</span></span>

#### <a name="selecting-database-records-with-the-entity-framework"></a><span data-ttu-id="472d5-188">Selezione di record di database con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="472d5-188">Selecting Database Records with the Entity Framework</span></span>

<span data-ttu-id="472d5-189">Iniziamo a creare l'applicazione Movie Database creando una pagina che visualizza un elenco di record di film.</span><span class="sxs-lookup"><span data-stu-id="472d5-189">Let's start building our Movie Database application by creating a page that displays a list of movie records.</span></span> <span data-ttu-id="472d5-190">Il controller Home nel listato 1 espone un'azione denominata Index().</span><span class="sxs-lookup"><span data-stu-id="472d5-190">The Home controller in Listing 1 exposes an action named Index().</span></span> <span data-ttu-id="472d5-191">L'azione Index() restituisce tutti i record del filmato dalla tabella di database Movie sfruttando Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="472d5-191">The Index() action returns all of the movie records from the Movie database table by taking advantage of the Entity Framework.</span></span>

<span data-ttu-id="472d5-192">**Listato 1 – Controller-HomeController.vb**</span><span class="sxs-lookup"><span data-stu-id="472d5-192">**Listing 1 – Controllers\HomeController.vb**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample1.vb)]

<span data-ttu-id="472d5-193">Si noti che il controller nel listato 1 include un costruttore.</span><span class="sxs-lookup"><span data-stu-id="472d5-193">Notice that the controller in Listing 1 includes a constructor.</span></span> <span data-ttu-id="472d5-194">Il costruttore inizializza un campo \_a livello di classe denominato db.</span><span class="sxs-lookup"><span data-stu-id="472d5-194">The constructor initializes a class-level field named \_db.</span></span> <span data-ttu-id="472d5-195">Il \_campo db rappresenta le entità di database generate da Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="472d5-195">The \_db field represents the database entities generated by the Microsoft Entity Framework.</span></span> <span data-ttu-id="472d5-196">Il \_campo db è un'istanza della classe MoviesDBEntities generata da Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="472d5-196">The \_db field is an instance of the MoviesDBEntities class that was generated by the Entity Designer.</span></span>

<span data-ttu-id="472d5-197">Il \_campo db viene utilizzato all'interno dell'azione Index() per recuperare i record dalla tabella di database Movies.</span><span class="sxs-lookup"><span data-stu-id="472d5-197">The \_db field is used within the Index() action to retrieve the records from the Movies database table.</span></span> <span data-ttu-id="472d5-198">Espressione \_db. MovieSet rappresenta tutti i record della tabella di database Movies.</span><span class="sxs-lookup"><span data-stu-id="472d5-198">The expression \_db.MovieSet represents all of the records from the Movies database table.</span></span> <span data-ttu-id="472d5-199">Il metodo ToList() viene utilizzato per convertire l'insieme di filmati in una raccolta generica di oggetti Movie: List( Of Movie).</span><span class="sxs-lookup"><span data-stu-id="472d5-199">The ToList() method is used to convert the set of movies into a generic collection of Movie objects: List( Of Movie).</span></span>

<span data-ttu-id="472d5-200">I record del filmato vengono recuperati con l'aiuto di LINQ to Entities.</span><span class="sxs-lookup"><span data-stu-id="472d5-200">The movie records are retrieved with the help of LINQ to Entities.</span></span> <span data-ttu-id="472d5-201">L'azione Index() nel listato 1 utilizza la *sintassi* del metodo LINQ per recuperare il set di record di database.</span><span class="sxs-lookup"><span data-stu-id="472d5-201">The Index() action in Listing 1 uses LINQ *method syntax* to retrieve the set of database records.</span></span> <span data-ttu-id="472d5-202">Se si preferisce, è possibile utilizzare la *sintassi* di query LINQ.</span><span class="sxs-lookup"><span data-stu-id="472d5-202">If you prefer, you can use LINQ *query syntax* instead.</span></span> <span data-ttu-id="472d5-203">Le due istruzioni seguenti fanno la stessa cosa:</span><span class="sxs-lookup"><span data-stu-id="472d5-203">The following two statements do the very same thing:</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample2.vb)]

<span data-ttu-id="472d5-204">Utilizzare la sintassi LINQ, ovvero la sintassi del metodo o la sintassi della query, che si ritiene più intuitiva.</span><span class="sxs-lookup"><span data-stu-id="472d5-204">Use whichever LINQ syntax – method syntax or query syntax – that you find most intuitive.</span></span> <span data-ttu-id="472d5-205">Non c'è differenza di prestazioni tra i due approcci - l'unica differenza è lo stile.</span><span class="sxs-lookup"><span data-stu-id="472d5-205">There is no difference in performance between the two approaches – the only difference is style.</span></span>

<span data-ttu-id="472d5-206">La vista nel listato 2 viene utilizzata per visualizzare i record del filmato.</span><span class="sxs-lookup"><span data-stu-id="472d5-206">The view in Listing 2 is used to display the movie records.</span></span>

<span data-ttu-id="472d5-207">**Listato 2 – Visualizzazioni, Home, Indice.aspx**</span><span class="sxs-lookup"><span data-stu-id="472d5-207">**Listing 2 – Views\Home\Index.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample3.aspx)]

<span data-ttu-id="472d5-208">La visualizzazione nel listato 2 contiene un ciclo **For Each** che scorre ogni record di filmato e visualizza i valori delle proprietà Title e Director del record del filmato.</span><span class="sxs-lookup"><span data-stu-id="472d5-208">The view in Listing 2 contains a **For Each** loop that iterates through each movie record and displays the values of the movie record's Title and Director properties.</span></span> <span data-ttu-id="472d5-209">Si noti che accanto a ogni record viene visualizzato un collegamento Modifica ed Elimina.</span><span class="sxs-lookup"><span data-stu-id="472d5-209">Notice that an Edit and Delete link is displayed next to each record.</span></span> <span data-ttu-id="472d5-210">Inoltre, un collegamento Aggiungi filmato viene visualizzato nella parte inferiore della visualizzazione (vedere Figura 7).</span><span class="sxs-lookup"><span data-stu-id="472d5-210">Furthermore, an Add Movie link appears at the bottom of the view (see Figure 7).</span></span>

<span data-ttu-id="472d5-211">**Figura 7 – Vista dell'indice**</span><span class="sxs-lookup"><span data-stu-id="472d5-211">**Figure 7 – The Index view**</span></span>

![clip_image014](creating-model-classes-with-the-entity-framework-vb/_static/image7.jpg)

<span data-ttu-id="472d5-213">La vista Indice è una *vista tipizzata.*</span><span class="sxs-lookup"><span data-stu-id="472d5-213">The Index view is a *typed view*.</span></span> <span data-ttu-id="472d5-214">La visualizzazione Dell'indice include una &lt;&gt; direttiva % % della pagina che include un attributo Inherits.</span><span class="sxs-lookup"><span data-stu-id="472d5-214">The Index view has a &lt;%@ Page %&gt; directive that includes an Inherits attribute.</span></span> <span data-ttu-id="472d5-215">L'attributo Inherits esegue il cast della proprietà ViewData.Model in una raccolta List generica fortemente tipizzata di oggetti Movie, ovvero List(Of Movie).</span><span class="sxs-lookup"><span data-stu-id="472d5-215">The Inherits attribute casts the ViewData.Model property to a strongly typed generic List collection of Movie objects – a List(Of Movie).</span></span>

## <a name="inserting-database-records-with-the-entity-framework"></a><span data-ttu-id="472d5-216">Inserimento di record di database con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="472d5-216">Inserting Database Records with the Entity Framework</span></span>

<span data-ttu-id="472d5-217">È possibile utilizzare Entity Framework per semplificare l'inserimento di nuovi record in una tabella di database.</span><span class="sxs-lookup"><span data-stu-id="472d5-217">You can use the Entity Framework to make it easy to insert new records into a database table.</span></span> <span data-ttu-id="472d5-218">Il listato 3 contiene due nuove azioni aggiunte alla classe Controller Home che è possibile utilizzare per inserire nuovi record nella tabella di database Movie.</span><span class="sxs-lookup"><span data-stu-id="472d5-218">Listing 3 contains two new actions added to the Home controller class that you can use to insert new records into the Movie database table.</span></span>

<span data-ttu-id="472d5-219">**Listato 3 – Controllers-HomeController.vb (metodi Add)**</span><span class="sxs-lookup"><span data-stu-id="472d5-219">**Listing 3 – Controllers\HomeController.vb (Add methods)**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample4.vb)]

<span data-ttu-id="472d5-220">La prima azione Add() restituisce semplicemente una visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="472d5-220">The first Add() action simply returns a view.</span></span> <span data-ttu-id="472d5-221">La visualizzazione contiene un modulo per l'aggiunta di un nuovo record di database di film (vedere Figura 8).</span><span class="sxs-lookup"><span data-stu-id="472d5-221">The view contains a form for adding a new movie database record (see Figure 8).</span></span> <span data-ttu-id="472d5-222">Quando si invia il modulo, viene richiamata la seconda azione Add().</span><span class="sxs-lookup"><span data-stu-id="472d5-222">When you submit the form, the second Add() action is invoked.</span></span>

<span data-ttu-id="472d5-223">Si noti che la seconda azione Add() è decorata con l'attributo AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="472d5-223">Notice that the second Add() action is decorated with the AcceptVerbs attribute.</span></span> <span data-ttu-id="472d5-224">Questa azione può essere richiamata solo quando si esegue un'operazione HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="472d5-224">This action can be invoked only when performing an HTTP POST operation.</span></span> <span data-ttu-id="472d5-225">In altre parole, questa azione può essere richiamata solo quando si pubblica un modulo HTML.</span><span class="sxs-lookup"><span data-stu-id="472d5-225">In other words, this action can only be invoked when posting an HTML form.</span></span>

<span data-ttu-id="472d5-226">La seconda azione Add() crea una nuova istanza della classe Entity Framework Movie con l'aiuto del metodo ASP.NET metodo MVC TryUpdateModel().</span><span class="sxs-lookup"><span data-stu-id="472d5-226">The second Add() action creates a new instance of the Entity Framework Movie class with the help of the ASP.NET MVC TryUpdateModel() method.</span></span> <span data-ttu-id="472d5-227">Il metodo TryUpdateModel() accetta i campi di FormCollection passati al metodo Add() e assegna i valori di questi campi modulo HTML alla classe Movie.</span><span class="sxs-lookup"><span data-stu-id="472d5-227">The TryUpdateModel() method takes the fields in the FormCollection passed to the Add() method and assigns the values of these HTML form fields to the Movie class.</span></span>

<span data-ttu-id="472d5-228">Quando si usa Entity Framework, è necessario fornire una "white list" di proprietà quando si usano i metodi TryUpdateModel o UpdateModel per aggiornare le proprietà di una classe di entità.</span><span class="sxs-lookup"><span data-stu-id="472d5-228">When using the Entity Framework, you must supply a "white list" of properties when using the TryUpdateModel or UpdateModel methods to update the properties of an entity class.</span></span>

<span data-ttu-id="472d5-229">Successivamente, l'azione Add() esegue una semplice convalida del form.</span><span class="sxs-lookup"><span data-stu-id="472d5-229">Next, the Add() action performs some simple form validation.</span></span> <span data-ttu-id="472d5-230">L'azione verifica che entrambe le proprietà Title e Director abbiano valori.</span><span class="sxs-lookup"><span data-stu-id="472d5-230">The action verifies that both the Title and Director properties have values.</span></span> <span data-ttu-id="472d5-231">Se si verifica un errore di convalida, viene aggiunto un messaggio di errore di convalida a ModelState.If there is a validation error, then a validation error message is added to ModelState.</span><span class="sxs-lookup"><span data-stu-id="472d5-231">If there is a validation error, then a validation error message is added to ModelState.</span></span>

<span data-ttu-id="472d5-232">Se non sono presenti errori di convalida, un nuovo record di filmato viene aggiunto alla tabella di database Movies con l'aiuto di Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="472d5-232">If there are no validation errors then a new movie record is added to the Movies database table with the help of the Entity Framework.</span></span> <span data-ttu-id="472d5-233">Il nuovo record viene aggiunto al database con le due righe di codice seguenti:</span><span class="sxs-lookup"><span data-stu-id="472d5-233">The new record is added to the database with the following two lines of code:</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample5.vb)]

<span data-ttu-id="472d5-234">La prima riga di codice aggiunge la nuova entità Movie al set di film rilevati da Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="472d5-234">The first line of code adds the new Movie entity to the set of movies being tracked by the Entity Framework.</span></span> <span data-ttu-id="472d5-235">La seconda riga di codice salva tutte le modifiche apportate ai film registrati nel database sottostante.</span><span class="sxs-lookup"><span data-stu-id="472d5-235">The second line of code saves whatever changes have been made to the Movies being tracked back to the underlying database.</span></span>

<span data-ttu-id="472d5-236">**Figura 8 – La visualizzazione Aggiungi**</span><span class="sxs-lookup"><span data-stu-id="472d5-236">**Figure 8 – The Add view**</span></span>

![clip_image016](creating-model-classes-with-the-entity-framework-vb/_static/image8.jpg)

## <a name="updating-database-records-with-the-entity-framework"></a><span data-ttu-id="472d5-238">Aggiornamento dei record di database con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="472d5-238">Updating Database Records with the Entity Framework</span></span>

<span data-ttu-id="472d5-239">È possibile seguire quasi lo stesso approccio per modificare un record di database con Entity Framework come approccio appena seguito per inserire un nuovo record di database.</span><span class="sxs-lookup"><span data-stu-id="472d5-239">You can follow almost the same approach to edit a database record with the Entity Framework as the approach that we just followed to insert a new database record.</span></span> <span data-ttu-id="472d5-240">Il listato 4 contiene due nuove azioni controller denominate Edit().</span><span class="sxs-lookup"><span data-stu-id="472d5-240">Listing 4 contains two new controller actions named Edit().</span></span> <span data-ttu-id="472d5-241">La prima azione Edit() restituisce un modulo HTML per la modifica di un record del filmato.</span><span class="sxs-lookup"><span data-stu-id="472d5-241">The first Edit() action returns an HTML form for editing a movie record.</span></span> <span data-ttu-id="472d5-242">La seconda azione Edit() tenta di aggiornare il database.</span><span class="sxs-lookup"><span data-stu-id="472d5-242">The second Edit() action attempts to update the database.</span></span>

<span data-ttu-id="472d5-243">**Listato 4 – Controllers-HomeController.vb (metodi di modifica)**</span><span class="sxs-lookup"><span data-stu-id="472d5-243">**Listing 4 – Controllers\HomeController.vb (Edit methods)**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample6.vb)]

<span data-ttu-id="472d5-244">La seconda azione Edit() inizia recuperando il record Movie dal database che corrisponde all'ID del filmato in fase di modifica.</span><span class="sxs-lookup"><span data-stu-id="472d5-244">The second Edit() action starts by retrieving the Movie record from the database that matches the Id of the movie being edited.</span></span> <span data-ttu-id="472d5-245">The following LINQ to Entities statement grabs the first database record that matches a particular Id:</span><span class="sxs-lookup"><span data-stu-id="472d5-245">The following LINQ to Entities statement grabs the first database record that matches a particular Id:</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample7.vb)]

<span data-ttu-id="472d5-246">Successivamente, il metodo TryUpdateModel() viene utilizzato per assegnare i valori dei campi modulo HTML alle proprietà dell'entità filmato.</span><span class="sxs-lookup"><span data-stu-id="472d5-246">Next, the TryUpdateModel() method is used to assign the values of the HTML form fields to the properties of the movie entity.</span></span> <span data-ttu-id="472d5-247">Si noti che viene fornita una white list per specificare le proprietà esatte da aggiornare.</span><span class="sxs-lookup"><span data-stu-id="472d5-247">Notice that a white list is supplied to specify the exact properties to update.</span></span>

<span data-ttu-id="472d5-248">Successivamente, viene eseguita una convalida semplice per verificare che entrambe le proprietà Titolo filmato e Director abbiano valori.</span><span class="sxs-lookup"><span data-stu-id="472d5-248">Next, some simple validation is performed to verify that both the Movie Title and Director properties have values.</span></span> <span data-ttu-id="472d5-249">Se in una proprietà manca un valore, viene aggiunto un messaggio di errore di convalida a ModelState e ModelState.IsValid restituisce il valore false.</span><span class="sxs-lookup"><span data-stu-id="472d5-249">If either property is missing a value, then a validation error message is added to ModelState and ModelState.IsValid returns the value false.</span></span>

<span data-ttu-id="472d5-250">Infine, se non sono presenti errori di convalida, la tabella di database Movies sottostante viene aggiornata con le modifiche chiamando il SaveChanges() metodo.</span><span class="sxs-lookup"><span data-stu-id="472d5-250">Finally, if there are no validation errors, then the underlying Movies database table is updated with any changes by calling the SaveChanges() method.</span></span>

<span data-ttu-id="472d5-251">Quando si modificano i record del database, è necessario passare l'ID del record in corso di modifica all'azione del controller che esegue l'aggiornamento del database.</span><span class="sxs-lookup"><span data-stu-id="472d5-251">When editing database records, you need to pass the Id of the record being edited to the controller action that performs the database update.</span></span> <span data-ttu-id="472d5-252">In caso contrario, l'azione del controller non saprà quale record aggiornare nel database sottostante.</span><span class="sxs-lookup"><span data-stu-id="472d5-252">Otherwise, the controller action will not know which record to update in the underlying database.</span></span> <span data-ttu-id="472d5-253">La visualizzazione Modifica, contenuta nel listato 5, include un campo modulo nascosto che rappresenta l'ID del record del database in corso di modifica.</span><span class="sxs-lookup"><span data-stu-id="472d5-253">The Edit view, contained in Listing 5, includes a hidden form field that represents the Id of the database record being edited.</span></span>

<span data-ttu-id="472d5-254">**Listato 5 – Visualizzazioni, Home, Modifica.aspx**</span><span class="sxs-lookup"><span data-stu-id="472d5-254">**Listing 5 – Views\Home\Edit.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample8.aspx)]

## <a name="deleting-database-records-with-the-entity-framework"></a><span data-ttu-id="472d5-255">Eliminazione di record di database con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="472d5-255">Deleting Database Records with the Entity Framework</span></span>

<span data-ttu-id="472d5-256">L'operazione finale del database, che è necessario affrontare in questa esercitazione, consiste nell'eliminazione dei record del database.</span><span class="sxs-lookup"><span data-stu-id="472d5-256">The final database operation, which we need to tackle in this tutorial, is deleting database records.</span></span> <span data-ttu-id="472d5-257">È possibile utilizzare l'azione del controller nel listato 6 per eliminare un record di database specifico.</span><span class="sxs-lookup"><span data-stu-id="472d5-257">You can use the controller action in Listing 6 to delete a particular database record.</span></span>

<span data-ttu-id="472d5-258">**Listato 6 -- - Controller /HomeController.vb (azione Elimina)**</span><span class="sxs-lookup"><span data-stu-id="472d5-258">**Listing 6 -- \Controllers\HomeController.vb (Delete action)**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample9.vb)]

<span data-ttu-id="472d5-259">L'azione Delete() recupera innanzitutto l'entità Movie che corrisponde all'ID passato all'azione.</span><span class="sxs-lookup"><span data-stu-id="472d5-259">The Delete() action first retrieves the Movie entity that matches the Id passed to the action.</span></span> <span data-ttu-id="472d5-260">Successivamente, il filmato viene eliminato dal database chiamando il metodo DeleteObject() seguito dal metodo SaveChanges().</span><span class="sxs-lookup"><span data-stu-id="472d5-260">Next, the movie is deleted from the database by calling the DeleteObject() method followed by the SaveChanges() method.</span></span> <span data-ttu-id="472d5-261">Infine, l'utente viene reindirizzato alla visualizzazione indice.</span><span class="sxs-lookup"><span data-stu-id="472d5-261">Finally, the user is redirected back to the Index view.</span></span>

## <a name="summary"></a><span data-ttu-id="472d5-262">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="472d5-262">Summary</span></span>

<span data-ttu-id="472d5-263">Lo scopo di questa esercitazione era dimostrare come è possibile compilare applicazioni Web basate su database sfruttando ASP.NET MVC e Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="472d5-263">The purpose of this tutorial was to demonstrate how you can build database-driven web applications by taking advantage of ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="472d5-264">Si è appreso come creare un'applicazione che consente di selezionare, inserire, aggiornare ed eliminare record di database.</span><span class="sxs-lookup"><span data-stu-id="472d5-264">You learned how to build an application that enables you to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="472d5-265">In primo luogo, è stato illustrato come è possibile utilizzare la procedura guidata Entity Data Model per generare un Entity Data Model da Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="472d5-265">First, we discussed how you can use the Entity Data Model Wizard to generate an Entity Data Model from within Visual Studio.</span></span> <span data-ttu-id="472d5-266">Successivamente, si apprenderà come utilizzare LINQ to Entities per recuperare un set di record di database da una tabella di database.</span><span class="sxs-lookup"><span data-stu-id="472d5-266">Next, you learn how to use LINQ to Entities to retrieve a set of database records from a database table.</span></span> <span data-ttu-id="472d5-267">Infine, è stato usato Entity Framework per inserire, aggiornare ed eliminare i record del database.</span><span class="sxs-lookup"><span data-stu-id="472d5-267">Finally, we used the Entity Framework to insert, update, and delete database records.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="472d5-268">[Successivo](validation-with-the-data-annotation-validators-cs.md)
> [precedente](creating-model-classes-with-linq-to-sql-vb.md)</span><span class="sxs-lookup"><span data-stu-id="472d5-268">[Previous](validation-with-the-data-annotation-validators-cs.md)
[Next](creating-model-classes-with-linq-to-sql-vb.md)</span></span>
