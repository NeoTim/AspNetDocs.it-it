---
uid: mvc/overview/older-versions-1/security/authenticating-users-with-forms-authentication-cs
title: Autenticazione degli utenti con l'autenticazione basata su form Documenti Microsoft
author: rick-anderson
description: Informazioni su come usare l'attributo [Authorize] per proteggere con password determinate pagine nell'applicazione MVC. Si apprenderà come utilizzare anche l'amministrazione del sito Web...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 239fd3ca-5630-4b8d-bc4b-2f906b1d3504
msc.legacyurl: /mvc/overview/older-versions-1/security/authenticating-users-with-forms-authentication-cs
msc.type: authoredcontent
ms.openlocfilehash: f14f996c0b3a438647b5d181675457735e473354
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/17/2020
ms.locfileid: "81540974"
---
# <a name="authenticating-users-with-forms-authentication-c"></a><span data-ttu-id="6dea4-104">Autenticazione degli utenti con l'autenticazione basata su form (C#)</span><span class="sxs-lookup"><span data-stu-id="6dea4-104">Authenticating Users with Forms Authentication (C#)</span></span>

<span data-ttu-id="6dea4-105">da parte [di Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="6dea4-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="6dea4-106">Informazioni su come usare l'attributo [Authorize] per proteggere con password determinate pagine nell'applicazione MVC.</span><span class="sxs-lookup"><span data-stu-id="6dea4-106">Learn how to use the [Authorize] attribute to password protect particular pages in your MVC application.</span></span> <span data-ttu-id="6dea4-107">Informazioni su come utilizzare lo strumento Amministrazione sito Web per creare e gestire utenti e ruoli.</span><span class="sxs-lookup"><span data-stu-id="6dea4-107">You learn how to use the Web Site Administration Tool to create and manage users and roles.</span></span> <span data-ttu-id="6dea4-108">Viene inoltre illustrato come configurare la posizione in cui vengono archiviate le informazioni relative all'account utente e ai ruoli.</span><span class="sxs-lookup"><span data-stu-id="6dea4-108">You also learn how to configure where user account and role information is stored.</span></span>

<span data-ttu-id="6dea4-109">L'obiettivo di questa esercitazione è spiegare come è possibile utilizzare l'autenticazione basata su form per proteggere con password le visualizzazioni nelle applicazioni MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6dea4-109">The goal of this tutorial is to explain how you can use Forms authentication to password protect the views in your ASP.NET MVC applications.</span></span> <span data-ttu-id="6dea4-110">Informazioni su come utilizzare lo strumento Amministrazione sito Web per creare utenti e ruoli.</span><span class="sxs-lookup"><span data-stu-id="6dea4-110">You learn how to use the Web Site Administration Tool to create users and roles.</span></span> <span data-ttu-id="6dea4-111">Si apprenderà inoltre come impedire agli utenti non autorizzati di richiamare le azioni del controller.</span><span class="sxs-lookup"><span data-stu-id="6dea4-111">You also learn how to prevent unauthorized users from invoking controller actions.</span></span> <span data-ttu-id="6dea4-112">Infine, si apprenderà come configurare la posizione di archiviazione di nomi utente e password.</span><span class="sxs-lookup"><span data-stu-id="6dea4-112">Finally, you learn how to configure where user names and passwords are stored.</span></span>

#### <a name="using-the-web-site-administration-tool"></a><span data-ttu-id="6dea4-113">Utilizzo dello strumento Amministrazione sito Web</span><span class="sxs-lookup"><span data-stu-id="6dea4-113">Using the Web Site Administration Tool</span></span>

<span data-ttu-id="6dea4-114">Prima di fare qualsiasi altra cosa, dovremmo iniziare creando alcuni utenti e ruoli.</span><span class="sxs-lookup"><span data-stu-id="6dea4-114">Before we do anything else, we should start by creating some users and roles.</span></span> <span data-ttu-id="6dea4-115">Il modo più semplice per creare nuovi utenti e ruoli consiste nell'utilizzare lo strumento Amministrazione sito Web di Visual Studio 2008.</span><span class="sxs-lookup"><span data-stu-id="6dea4-115">The easiest way to create new users and roles is to take advantage of the Visual Studio 2008 Web Site Administration Tool.</span></span> <span data-ttu-id="6dea4-116">È possibile avviare questo strumento selezionando l'opzione di menu **Progetto, ASP.NET Configurazione**.</span><span class="sxs-lookup"><span data-stu-id="6dea4-116">You can launch this tool by selecting the menu option **Project, ASP.NET Configuration**.</span></span> <span data-ttu-id="6dea4-117">In alternativa, è possibile avviare lo strumento Amministrazione sito Web facendo clic sull'icona (in qualche modo spaventoso) del martello che colpisce il mondo visualizzato nella parte superiore della finestra Esplora soluzioni (vedere Figura 1).</span><span class="sxs-lookup"><span data-stu-id="6dea4-117">Alternatively, you can launch the Web Site Administration Tool by clicking the (somewhat scary) icon of the hammer hitting the world that appears at the top of the Solution Explorer window (see Figure 1).</span></span>

<span data-ttu-id="6dea4-118">**Figura 1 – Avvio dello strumento Amministrazione sito Web**</span><span class="sxs-lookup"><span data-stu-id="6dea4-118">**Figure 1 – Launching the Web Site Administration Tool**</span></span>

![clip_image002](authenticating-users-with-forms-authentication-cs/_static/image1.jpg)

<span data-ttu-id="6dea4-120">Nello strumento Amministrazione sito Web, è possibile creare nuovi utenti e ruoli selezionando la scheda Protezione. Fare clic sul collegamento **Crea utente** per creare un nuovo utente denominato Stefano (vedere la figura 2).</span><span class="sxs-lookup"><span data-stu-id="6dea4-120">Within the Web Site Administration Tool, you create new users and roles by selecting the Security tab. Click the **Create user** link to create a new user named Stephen (see Figure 2).</span></span> <span data-ttu-id="6dea4-121">Fornire all'utente Stephen la password desiderata, ad esempio *segreta.*</span><span class="sxs-lookup"><span data-stu-id="6dea4-121">Provide the Stephen user with any password that you want (for example, *secret*).</span></span>

<span data-ttu-id="6dea4-122">**Figura 2 – Creazione di un nuovo utente**</span><span class="sxs-lookup"><span data-stu-id="6dea4-122">**Figure 2 – Creating a new user**</span></span>

![clip_image004](authenticating-users-with-forms-authentication-cs/_static/image2.jpg)

<span data-ttu-id="6dea4-124">È possibile creare nuovi ruoli abilitando innanzitutto i ruoli e definendo uno o più ruoli.</span><span class="sxs-lookup"><span data-stu-id="6dea4-124">You create new roles by first enabling roles and defining one or more roles.</span></span> <span data-ttu-id="6dea4-125">Abilitare i ruoli facendo clic sul collegamento **Abilita ruoli.**</span><span class="sxs-lookup"><span data-stu-id="6dea4-125">Enable roles by clicking the **Enable roles** link.</span></span> <span data-ttu-id="6dea4-126">Successivamente, creare un ruolo denominato *Administrators* facendo clic sul collegamento **Crea o gestisci ruoli** (vedere la figura 3).</span><span class="sxs-lookup"><span data-stu-id="6dea4-126">Next, create a role named *Administrators* by clicking the **Create or Manage roles** link (see Figure 3).</span></span>

<span data-ttu-id="6dea4-127">**Figura 3 – Creazione di un nuovo ruolo**</span><span class="sxs-lookup"><span data-stu-id="6dea4-127">**Figure 3 – Creating a new role**</span></span>

![clip_image006](authenticating-users-with-forms-authentication-cs/_static/image3.jpg)

<span data-ttu-id="6dea4-129">Infine, creare un nuovo utente denominato Sally e associare Sally al ruolo Administrators facendo clic sul collegamento Crea utente e selezionando Amministratori durante la creazione di Sally (vedere la figura 4).</span><span class="sxs-lookup"><span data-stu-id="6dea4-129">Finally, create a new user named Sally and associate Sally with the Administrators role by clicking the Create User link and selecting Administrators when creating Sally (see Figure 4).</span></span>

<span data-ttu-id="6dea4-130">**Figura 4 – Aggiunta di un utente a un ruoloFigure 4 – Adding a user to a role**</span><span class="sxs-lookup"><span data-stu-id="6dea4-130">**Figure 4 – Adding a user to a role**</span></span>

![clip_image008](authenticating-users-with-forms-authentication-cs/_static/image4.jpg)

<span data-ttu-id="6dea4-132">Quando tutto è detto e fatto, si dovrebbe avere due nuovi utenti di nome Stephen e Sally.</span><span class="sxs-lookup"><span data-stu-id="6dea4-132">When all is said and done, you should have two new users named Stephen and Sally.</span></span> <span data-ttu-id="6dea4-133">È inoltre necessario disporre di un nuovo ruolo denominato Administrators.You should also have a new role named Administrators.</span><span class="sxs-lookup"><span data-stu-id="6dea4-133">You should also have a new role named Administrators.</span></span> <span data-ttu-id="6dea4-134">Sally è un membro del ruolo Administrators e Stephen non lo è.</span><span class="sxs-lookup"><span data-stu-id="6dea4-134">Sally is a member of the Administrators role and Stephen is not.</span></span>

#### <a name="requiring-authorization"></a><span data-ttu-id="6dea4-135">Richiedere l'autorizzazione</span><span class="sxs-lookup"><span data-stu-id="6dea4-135">Requiring Authorization</span></span>

<span data-ttu-id="6dea4-136">È possibile richiedere l'autenticazione di un utente prima che l'utente richiami un'azione del controller aggiungendo l'attributo [Authorize] all'azione.</span><span class="sxs-lookup"><span data-stu-id="6dea4-136">You can require a user to be authenticated before the user invokes a controller action by adding the [Authorize] attribute to the action.</span></span> <span data-ttu-id="6dea4-137">È possibile applicare l'attributo [Authorize] a una singola azione del controller oppure a un'intera classe controller.</span><span class="sxs-lookup"><span data-stu-id="6dea4-137">You can apply the [Authorize] attribute to an individual controller action or you can apply this attribute to an entire controller class.</span></span>

<span data-ttu-id="6dea4-138">Ad esempio, il controller nel listato 1 espone un'azione denominata CompanySecrets().</span><span class="sxs-lookup"><span data-stu-id="6dea4-138">For example, the controller in Listing 1 exposes an action named CompanySecrets().</span></span> <span data-ttu-id="6dea4-139">Poiché questa azione è decorata con l'attributo [Authorize], questa azione non può essere richiamata a meno che un utente non sia autenticato.</span><span class="sxs-lookup"><span data-stu-id="6dea4-139">Because this action is decorated with the [Authorize] attribute, this action cannot be invoked unless a user is authenticated.</span></span>

<span data-ttu-id="6dea4-140">**Listato 1 – Controller-HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="6dea4-140">**Listing 1 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](authenticating-users-with-forms-authentication-cs/samples/sample1.cs)]

<span data-ttu-id="6dea4-141">Se si richiama l'azione CompanySecrets() immettendo l'URL /Home/CompanySecrets nella barra degli indirizzi del browser e non si è un utente autenticato, verrà reindirizzato automaticamente alla visualizzazione Account di accesso (vedere la Figura 5).</span><span class="sxs-lookup"><span data-stu-id="6dea4-141">If you invoke the CompanySecrets() action by entering the URL /Home/CompanySecrets in the address bar of your browser, and you are not an authenticated user, then you will be redirected to the Login view automatically (see Figure 5).</span></span>

<span data-ttu-id="6dea4-142">**Figura 5 – Visualizzazione Account di accesso**</span><span class="sxs-lookup"><span data-stu-id="6dea4-142">**Figure 5 – The Login view**</span></span>

![clip_image010](authenticating-users-with-forms-authentication-cs/_static/image5.jpg)

<span data-ttu-id="6dea4-144">È possibile utilizzare la vista Login per immettere il nome utente e la password.</span><span class="sxs-lookup"><span data-stu-id="6dea4-144">You can use the Login view to enter your user name and password.</span></span> <span data-ttu-id="6dea4-145">Se non si è un utente registrato, è possibile fare clic sul collegamento **di registrazione** per passare alla visualizzazione Register (vedere Figura 6).</span><span class="sxs-lookup"><span data-stu-id="6dea4-145">If you are not a registered user then you can click the **register** link to navigate to the Register view (see Figure 6).</span></span> <span data-ttu-id="6dea4-146">È possibile utilizzare la visualizzazione Registra per creare un nuovo account utente.</span><span class="sxs-lookup"><span data-stu-id="6dea4-146">You can use the Register view to create a new user account.</span></span>

<span data-ttu-id="6dea4-147">**Figura 6 – Visualizzazione Registro**</span><span class="sxs-lookup"><span data-stu-id="6dea4-147">**Figure 6 – The Register view**</span></span>

![clip_image012](authenticating-users-with-forms-authentication-cs/_static/image6.jpg)

<span data-ttu-id="6dea4-149">Dopo aver eseguito correttamente l'accesso, è possibile visualizzare la visualizzazione CompanySecrets (vedere Figura 7).</span><span class="sxs-lookup"><span data-stu-id="6dea4-149">After you successfully log in, you can see the CompanySecrets view (see Figure 7).</span></span> <span data-ttu-id="6dea4-150">Per impostazione predefinita, si continuerà ad essere connessi fino a quando non si chiude la finestra del browser.</span><span class="sxs-lookup"><span data-stu-id="6dea4-150">By default, you will continue to be logged in until you close your browser window.</span></span>

<span data-ttu-id="6dea4-151">**Figura 7 – Visualizzazione CompanySecrets**</span><span class="sxs-lookup"><span data-stu-id="6dea4-151">**Figure 7 – The CompanySecrets view**</span></span>

![clip_image014](authenticating-users-with-forms-authentication-cs/_static/image7.jpg)

#### <a name="authorizing-by-user-name-or-user-role"></a><span data-ttu-id="6dea4-153">Autorizzazione in base al nome utente o al ruolo utente</span><span class="sxs-lookup"><span data-stu-id="6dea4-153">Authorizing by User Name or User Role</span></span>

<span data-ttu-id="6dea4-154">È possibile utilizzare l'attributo [Authorize] per limitare l'accesso a un'azione del controller a un determinato set di utenti o a un particolare set di ruoli utente.</span><span class="sxs-lookup"><span data-stu-id="6dea4-154">You can use the [Authorize] attribute to restrict access to a controller action to a particular set of users or a particular set of user roles.</span></span> <span data-ttu-id="6dea4-155">Ad esempio, il controller Home modificato nel listato 2 contiene due nuove azioni denominate StephenSecrets() e AdministratorSecrets().</span><span class="sxs-lookup"><span data-stu-id="6dea4-155">For example, the modified Home controller in Listing 2 contains two new actions named StephenSecrets() and AdministratorSecrets().</span></span>

<span data-ttu-id="6dea4-156">**Listato 2 – Controller-HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="6dea4-156">**Listing 2 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](authenticating-users-with-forms-authentication-cs/samples/sample2.cs)]

<span data-ttu-id="6dea4-157">Solo un utente con il nome utente Stephen può richiamare l'azione StephenSecrets().</span><span class="sxs-lookup"><span data-stu-id="6dea4-157">Only a user with the user name Stephen can invoke the StephenSecrets() action.</span></span> <span data-ttu-id="6dea4-158">Tutti gli altri utenti vengono reindirizzati alla visualizzazione di accesso.</span><span class="sxs-lookup"><span data-stu-id="6dea4-158">All other users get redirected to the Login view.</span></span> <span data-ttu-id="6dea4-159">La proprietà Users accetta un elenco separato da virgole di nomi di account utente.</span><span class="sxs-lookup"><span data-stu-id="6dea4-159">The Users property accepts a comma separated list of user account names.</span></span>

<span data-ttu-id="6dea4-160">Solo gli utenti con il ruolo Administrators possono richiamare l'azione AdministratorSecrets().</span><span class="sxs-lookup"><span data-stu-id="6dea4-160">Only users in the Administrators role can invoke the AdministratorSecrets() action.</span></span> <span data-ttu-id="6dea4-161">Ad esempio, poiché Sally è un membro del gruppo Administrators, può richiamare l'azione AdministratorSecrets().</span><span class="sxs-lookup"><span data-stu-id="6dea4-161">For example, because Sally is a member of the Administrators group, she can invoke the AdministratorSecrets() action.</span></span> <span data-ttu-id="6dea4-162">Tutti gli altri utenti vengono reindirizzati alla visualizzazione di accesso.</span><span class="sxs-lookup"><span data-stu-id="6dea4-162">All other users get redirected to the Login view.</span></span> <span data-ttu-id="6dea4-163">Il Roles proprietà accetta un elenco separato da virgole di nomi di ruolo.</span><span class="sxs-lookup"><span data-stu-id="6dea4-163">The Roles property accepts a comma separated list of role names.</span></span>

#### <a name="configuring-authentication"></a><span data-ttu-id="6dea4-164">Configurazione dell'autenticazione</span><span class="sxs-lookup"><span data-stu-id="6dea4-164">Configuring Authentication</span></span>

<span data-ttu-id="6dea4-165">A questo punto, ci si potrebbe chiedere dove vengono archiviate le informazioni sull'account utente e sul ruolo.</span><span class="sxs-lookup"><span data-stu-id="6dea4-165">At this point, you might be wondering where the user account and role information is being stored.</span></span> <span data-ttu-id="6dea4-166">Per impostazione predefinita, le informazioni vengono archiviate in un database SQL Express (RANU)\_denominato ASPNETDB.mdf che si trova nella cartella Dati applicazioni dell'applicazione MVC.</span><span class="sxs-lookup"><span data-stu-id="6dea4-166">By default, the information is stored in a (RANU) SQL Express database named ASPNETDB.mdf located in your MVC application's App\_Data folder.</span></span> <span data-ttu-id="6dea4-167">Questo database viene generato automaticamente dal framework di ASP.NET quando si inizia a usare l'appartenenza.</span><span class="sxs-lookup"><span data-stu-id="6dea4-167">This database is generated by the ASP.NET framework automatically when you start using membership.</span></span>

<span data-ttu-id="6dea4-168">Per visualizzare il database ASPNETDB.mdf nella finestra Esplora soluzioni, è innanzitutto necessario selezionare l'opzione di menu Progetto, Mostra tutti i file.</span><span class="sxs-lookup"><span data-stu-id="6dea4-168">In order to see the ASPNETDB.mdf database in the Solution Explorer window, you first need to select the menu option Project, Show All Files.</span></span>

<span data-ttu-id="6dea4-169">L'utilizzo del database SQL Express predefinito è corretta quando si sviluppa un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6dea4-169">Using the default SQL Express database is fine when developing an application.</span></span> <span data-ttu-id="6dea4-170">Molto probabilmente, tuttavia, non si desidera utilizzare il database ASPNETDB.mdf predefinito per un'applicazione di produzione.</span><span class="sxs-lookup"><span data-stu-id="6dea4-170">Most likely, however, you won't want to use the default ASPNETDB.mdf database for a production application.</span></span> <span data-ttu-id="6dea4-171">In tal caso, è possibile modificare la posizione in cui vengono archiviate le informazioni sull'account utente completando i due passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="6dea4-171">In that case, you can change where user account information is stored by completing the following two steps:</span></span>

1. <span data-ttu-id="6dea4-172">Aggiungere gli oggetti di database di Application Services al database di produzione - Modificare la stringa di connessione dell'applicazione in modo che punti al database di produzioneAdd the Application Services database objects to your production database - Change your application connection string to point to your production database</span><span class="sxs-lookup"><span data-stu-id="6dea4-172">Add the Application Services database objects to your production database - Change your application connection string to point to your production database</span></span>

<span data-ttu-id="6dea4-173">Il primo passaggio consiste nell'aggiungere tutti gli oggetti di database necessari (tabelle e stored procedure) al database di produzione.</span><span class="sxs-lookup"><span data-stu-id="6dea4-173">The first step is to add all of the necessary database objects (tables and stored procedures) to your production database.</span></span> <span data-ttu-id="6dea4-174">Il modo più semplice per aggiungere questi oggetti a un nuovo database consiste nell'utilizzare il ASP.NET'Installazione guidata di SQL Server (vedere la Figura 8).</span><span class="sxs-lookup"><span data-stu-id="6dea4-174">The easiest way to add these objects to a new database is to take advantage of the ASP.NET SQL Server Setup Wizard (see Figure 8).</span></span> <span data-ttu-id="6dea4-175">È possibile avviare questo strumento aprendo il prompt dei comandi di Visual Studio 2008 dal gruppo di programmi di Microsoft Visual Studio 2008 ed eseguendo il comando seguente dal prompt dei comandi:</span><span class="sxs-lookup"><span data-stu-id="6dea4-175">You can launch this tool by opening the Visual Studio 2008 Command Prompt from the Microsoft Visual Studio 2008 program group and executing the following command from the command prompt:</span></span>

<span data-ttu-id="6dea4-176">aspnet\_regsql</span><span class="sxs-lookup"><span data-stu-id="6dea4-176">aspnet\_regsql</span></span>

<span data-ttu-id="6dea4-177">**Figura 8 – Installazione guidata di ASP.NET SQL Server**</span><span class="sxs-lookup"><span data-stu-id="6dea4-177">**Figure 8 – The ASP.NET SQL Server Setup Wizard**</span></span>

![clip_image016](authenticating-users-with-forms-authentication-cs/_static/image8.jpg)

<span data-ttu-id="6dea4-179">L'Installazione guidata di ASP.NET SQL ServerSQL Server consente di selezionare un database di SQL Server nella rete e di installare tutti gli oggetti di database richiesti dai servizi dell'applicazione ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6dea4-179">The ASP.NET SQL Server Setup Wizard enables you to select a SQL Server database on your network and install all of the database objects required by the ASP.NET application services.</span></span> <span data-ttu-id="6dea4-180">Non è necessario che il server di database si trovi nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="6dea4-180">The database server is not required to be located on your local machine.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="6dea4-181">Se non si desidera utilizzare l'Installazione guidata di ASP.NETSQL Server, è possibile trovare script SQL per l'aggiunta degli oggetti di database dei servizi dell'applicazione nella cartella seguente:</span><span class="sxs-lookup"><span data-stu-id="6dea4-181">If you don't want to use the ASP.NET SQL Server Setup Wizard, then you can find SQL scripts for adding the application services database objects in the following folder:</span></span>
> 
> > <span data-ttu-id="6dea4-182">C:.</span><span class="sxs-lookup"><span data-stu-id="6dea4-182">C:\Windows\Microsoft.NET\Framework\v2.0.50727</span></span>

<span data-ttu-id="6dea4-183">Dopo aver creato gli oggetti di database necessari, è necessario modificare la connessione di database utilizzata dall'applicazione MVC.</span><span class="sxs-lookup"><span data-stu-id="6dea4-183">After you create the necessary database objects, you need to modify the database connection used by your MVC application.</span></span> <span data-ttu-id="6dea4-184">Modificare la stringa di connessione ApplicationServices nel file di configurazione Web (web.config) in modo che punti al database di produzione.</span><span class="sxs-lookup"><span data-stu-id="6dea4-184">Modify the ApplicationServices connection string in your web configuration (web.config) file so that it points to the production database.</span></span> <span data-ttu-id="6dea4-185">Ad esempio, la connessione modificata nel listato 3 punta a un database denominato MyProductionDB (la stringa di connessione ApplicationServices originale è stata impostata come commento).</span><span class="sxs-lookup"><span data-stu-id="6dea4-185">For example, the modified connection in Listing 3 points to a database named MyProductionDB (the original ApplicationServices connection string has been commented out).</span></span>

<span data-ttu-id="6dea4-186">**Listato 3 – Web.config**</span><span class="sxs-lookup"><span data-stu-id="6dea4-186">**Listing 3 – Web.config**</span></span>

[!code-xml[Main](authenticating-users-with-forms-authentication-cs/samples/sample3.xml)]

#### <a name="configuring-database-permissions"></a><span data-ttu-id="6dea4-187">Configurazione delle autorizzazioni del database</span><span class="sxs-lookup"><span data-stu-id="6dea4-187">Configuring Database Permissions</span></span>

<span data-ttu-id="6dea4-188">Se si utilizza la protezione integrata per connettersi al database, sarà necessario aggiungere l'account utente di Windows corretto come account di accesso al database.</span><span class="sxs-lookup"><span data-stu-id="6dea4-188">If you use Integrated Security to connect to your database then you will need to add the correct Windows user account as a login to your database.</span></span> <span data-ttu-id="6dea4-189">L'account corretto dipende dal fatto che si utilizzi ASP.NET Development Server o Internet Information Services come server Web.</span><span class="sxs-lookup"><span data-stu-id="6dea4-189">The correct account depends on whether you are using the ASP.NET Development Server or Internet Information Services as your web server.</span></span> <span data-ttu-id="6dea4-190">L'account utente corretto dipende anche dal sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="6dea4-190">The correct user account also depends on your operating system.</span></span>

<span data-ttu-id="6dea4-191">Se si utilizza il ASP.NET Development Server (il server Web predefinito utilizzato da Visual Studio), l'applicazione viene eseguita nel contesto dell'account utente di Windows.</span><span class="sxs-lookup"><span data-stu-id="6dea4-191">If you are using the ASP.NET Development Server (the default web server used by Visual Studio) then your application executes within the context of your Windows user account.</span></span> <span data-ttu-id="6dea4-192">In tal caso, è necessario aggiungere l'account utente di Windows come account di accesso al server di database.</span><span class="sxs-lookup"><span data-stu-id="6dea4-192">In that case, you need to add your Windows user account as a database server login.</span></span>

<span data-ttu-id="6dea4-193">In alternativa, se si utilizza Internet Information Services, è necessario aggiungere l'account ASPNET o l'account NT AUTHORITY/NETWORK SERVICE come account di accesso al server di database.</span><span class="sxs-lookup"><span data-stu-id="6dea4-193">Alternatively, if you are using Internet Information Services then you need to add either the ASPNET account or the NT AUTHORITY/NETWORK SERVICE account as a database server login.</span></span> <span data-ttu-id="6dea4-194">Se si utilizza Windows XP, aggiungere l'account ASPNET come account di accesso al database.</span><span class="sxs-lookup"><span data-stu-id="6dea4-194">If you are using Windows XP then add the ASPNET account as a login to your database.</span></span> <span data-ttu-id="6dea4-195">Se si utilizza un sistema operativo più recente, ad esempio Windows Vista o Windows Server 2008, aggiungere l'account NT AUTHORITY/NETWORK SERVICE come account di accesso al database.</span><span class="sxs-lookup"><span data-stu-id="6dea4-195">If you are using a more recent operating system, such as Windows Vista or Windows Server 2008, then add the NT AUTHORITY/NETWORK SERVICE account as the database login.</span></span>

<span data-ttu-id="6dea4-196">È possibile aggiungere un nuovo account utente al database utilizzando Microsoft SQL Server Management Studio (vedere la figura 9).</span><span class="sxs-lookup"><span data-stu-id="6dea4-196">You can add a new user account to your database by using Microsoft SQL Server Management Studio (see Figure 9).</span></span>

<span data-ttu-id="6dea4-197">**Figura 9 – Creazione di un nuovo account di accesso di Microsoft SQL Server**</span><span class="sxs-lookup"><span data-stu-id="6dea4-197">**Figure 9 – Creating a new Microsoft SQL Server login**</span></span>

![clip_image018](authenticating-users-with-forms-authentication-cs/_static/image9.jpg)

<span data-ttu-id="6dea4-199">Dopo aver creato l'account di accesso richiesto, è necessario eseguire il mapping dell'account di accesso a un utente del database con i ruoli del database corretti.</span><span class="sxs-lookup"><span data-stu-id="6dea4-199">After you create the required login, you need to map the login to a database user with the right database roles.</span></span> <span data-ttu-id="6dea4-200">Fare doppio clic sull'account di accesso e selezionare la scheda Mapping utenti. Selezionare uno o più ruoli del database dei servizi dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6dea4-200">Double-click the login and select the User Mapping tab. Select one or more application services database roles.</span></span> <span data-ttu-id="6dea4-201">Ad esempio, per autenticare gli utenti, è\_\_necessario abilitare il ruolo del database aspnet Membership BasicAccess.</span><span class="sxs-lookup"><span data-stu-id="6dea4-201">For example, in order to authenticate users, you need to enable the aspnet\_Membership\_BasicAccess database role.</span></span> <span data-ttu-id="6dea4-202">Per creare nuovi utenti, è necessario abilitare il ruolo del database aspnet\_Membership\_FullAccess (vedere la Figura 10).</span><span class="sxs-lookup"><span data-stu-id="6dea4-202">In order to create new users, you need to enable the aspnet\_Membership\_FullAccess database role (see Figure 10).</span></span>

<span data-ttu-id="6dea4-203">**Figura 10 - Aggiunta di ruoli del database di Application Services**</span><span class="sxs-lookup"><span data-stu-id="6dea4-203">**Figure 10 – Adding Application Services database roles**</span></span>

![clip_image020](authenticating-users-with-forms-authentication-cs/_static/image10.jpg)

#### <a name="summary"></a><span data-ttu-id="6dea4-205">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="6dea4-205">Summary</span></span>

<span data-ttu-id="6dea4-206">In questa esercitazione è stato illustrato come utilizzare l'autenticazione basata su form durante la compilazione di un'applicazione MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6dea4-206">In this tutorial, you learned how to use Forms authentication when building an ASP.NET MVC application.</span></span> <span data-ttu-id="6dea4-207">In primo luogo, è stato illustrato come creare nuovi utenti e ruoli sfruttando lo strumento Amministrazione sito Web.</span><span class="sxs-lookup"><span data-stu-id="6dea4-207">First, you learned how to create new users and roles by taking advantage of the Web Site Administration Tool.</span></span> <span data-ttu-id="6dea4-208">Successivamente, si è appreso come utilizzare l'attributo [Authorize] per impedire agli utenti non autorizzati di richiamare le azioni del controller.</span><span class="sxs-lookup"><span data-stu-id="6dea4-208">Next, you learned how to use the [Authorize] attribute to prevent unauthorized users from invoking controller actions.</span></span> <span data-ttu-id="6dea4-209">Infine, è stato illustrato come configurare l'applicazione MVC per archiviare le informazioni su utenti e ruoli in un database di produzione.</span><span class="sxs-lookup"><span data-stu-id="6dea4-209">Finally, you learned how to configure your MVC application to store user and role information in a production database.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="6dea4-210">Avanti</span><span class="sxs-lookup"><span data-stu-id="6dea4-210">Next</span></span>](authenticating-users-with-windows-authentication-cs.md)
