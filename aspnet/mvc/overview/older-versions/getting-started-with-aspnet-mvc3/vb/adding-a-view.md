---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
title: Aggiunta di una vista (VB) | Microsoft Docs
author: Rick-Anderson
description: In questa esercitazione vengono illustrate le nozioni di base della creazione di un'applicazione Web MVC ASP.NET utilizzando Microsoft Visual Web Developer 2010 Express Service Pack 1, ovvero...
ms.author: riande
ms.date: 01/12/2011
ms.assetid: d3633f64-5d3c-45c9-ae4b-cb1563e3739f
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
msc.type: authoredcontent
ms.openlocfilehash: fa200935d83bb26c07b302449a6eba6fd67b5322
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78540425"
---
# <a name="adding-a-view-vb"></a><span data-ttu-id="50a1e-103">Aggiunta di una visualizzazione (VB)</span><span class="sxs-lookup"><span data-stu-id="50a1e-103">Adding a View (VB)</span></span>

<span data-ttu-id="50a1e-104">di [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="50a1e-104">by [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

> <span data-ttu-id="50a1e-105">In questa esercitazione vengono illustrate le nozioni di base della creazione di un'applicazione Web MVC ASP.NET utilizzando Microsoft Visual Web Developer 2010 Express Service Pack 1, una versione gratuita di Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="50a1e-105">This tutorial will teach you the basics of building an ASP.NET MVC Web application using Microsoft Visual Web Developer 2010 Express Service Pack 1, which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="50a1e-106">Prima di iniziare, verificare di aver installato i prerequisiti elencati di seguito.</span><span class="sxs-lookup"><span data-stu-id="50a1e-106">Before you start, make sure you've installed the prerequisites listed below.</span></span> <span data-ttu-id="50a1e-107">È possibile installarli tutti facendo clic sul collegamento seguente: [installazione guidata piattaforma Web](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="50a1e-107">You can install all of them by clicking the following link: [Web Platform Installer](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span></span> <span data-ttu-id="50a1e-108">In alternativa, è possibile installare singolarmente i prerequisiti usando i collegamenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="50a1e-108">Alternatively, you can individually install the prerequisites using the following links:</span></span>
> 
> - [<span data-ttu-id="50a1e-109">Prerequisiti di Visual Studio Web Developer Express SP1</span><span class="sxs-lookup"><span data-stu-id="50a1e-109">Visual Studio Web Developer Express SP1 prerequisites</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [<span data-ttu-id="50a1e-110">Aggiornamento degli strumenti di ASP.NET MVC 3</span><span class="sxs-lookup"><span data-stu-id="50a1e-110">ASP.NET MVC 3 Tools Update</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - <span data-ttu-id="50a1e-111">[SQL Server Compact 4,0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(supporto di runtime + Tools)</span><span class="sxs-lookup"><span data-stu-id="50a1e-111">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(runtime + tools support)</span></span>
> 
> <span data-ttu-id="50a1e-112">Se si usa Visual Studio 2010 anziché Visual Web Developer 2010, installare i prerequisiti facendo clic sul collegamento seguente: [prerequisiti di Visual studio 2010](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="50a1e-112">If you're using Visual Studio 2010 instead of Visual Web Developer 2010, install the prerequisites by clicking the following link: [Visual Studio 2010 prerequisites](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span></span>
> 
> <span data-ttu-id="50a1e-113">Per accompagnare questo argomento, è disponibile un progetto Visual Web Developer con codice sorgente VB.NET.</span><span class="sxs-lookup"><span data-stu-id="50a1e-113">A Visual Web Developer project with VB.NET source code is available to accompany this topic.</span></span> <span data-ttu-id="50a1e-114">[Scaricare la versione di VB.NET](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span><span class="sxs-lookup"><span data-stu-id="50a1e-114">[Download the VB.NET version](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span></span> <span data-ttu-id="50a1e-115">Se si preferisce C#, passare alla [ C# versione](../cs/adding-a-view.md) di questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="50a1e-115">If you prefer C#, switch to the [C# version](../cs/adding-a-view.md) of this tutorial.</span></span>

<span data-ttu-id="50a1e-116">In questa sezione verrà modificata la classe `HelloWorldController` per utilizzare un file di modello di visualizzazione per incapsulare in modo semplice il processo di generazione di risposte HTML a un client.</span><span class="sxs-lookup"><span data-stu-id="50a1e-116">In this section we're going to modify the `HelloWorldController` class to use a view template file to cleanly encapsulate the process of generating HTML responses to a client.</span></span>

<span data-ttu-id="50a1e-117">Iniziamo usando un modello di vista con il metodo `Index` nella classe `HelloWorldController`.</span><span class="sxs-lookup"><span data-stu-id="50a1e-117">Let's start by using a view template with the `Index` method in the `HelloWorldController` class.</span></span> <span data-ttu-id="50a1e-118">Attualmente il metodo `Index` restituisce una stringa con un messaggio hardcoded nella classe controller.</span><span class="sxs-lookup"><span data-stu-id="50a1e-118">Currently the `Index` method returns a string with a message that is hard-coded within the controller class.</span></span> <span data-ttu-id="50a1e-119">Modificare il metodo `Index` per restituire un oggetto `View`, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="50a1e-119">Change the `Index` method to return a `View` object, as shown in the following:</span></span>

[!code-vb[Main](adding-a-view/samples/sample1.vb)]

<span data-ttu-id="50a1e-120">A questo punto, aggiungere un modello di vista al progetto che è possibile richiamare con il metodo `Index`.</span><span class="sxs-lookup"><span data-stu-id="50a1e-120">Let's now add a view template to our project that we can invoke with the `Index` method.</span></span> <span data-ttu-id="50a1e-121">A tale scopo, fare clic con il pulsante destro del mouse all'interno del metodo `Index` e scegliere **Aggiungi visualizzazione**.</span><span class="sxs-lookup"><span data-stu-id="50a1e-121">To do this, right-click inside the `Index` method and click **Add View**.</span></span>

<span data-ttu-id="50a1e-122">[![IndexAddView](adding-a-view/_static/image2.png "IndexAddView")](adding-a-view/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="50a1e-122">[![IndexAddView](adding-a-view/_static/image2.png "IndexAddView")](adding-a-view/_static/image1.png)</span></span>

<span data-ttu-id="50a1e-123">Verrà visualizzata la finestra di dialogo **Aggiungi visualizzazione** .</span><span class="sxs-lookup"><span data-stu-id="50a1e-123">The **Add View** dialog box appears.</span></span> <span data-ttu-id="50a1e-124">Lasciare le voci predefinite e fare clic sul pulsante **Aggiungi** .</span><span class="sxs-lookup"><span data-stu-id="50a1e-124">Leave the default entries and click the **Add** button.</span></span>

<span data-ttu-id="50a1e-125">[![3addView](adding-a-view/_static/image4.png "3addView")](adding-a-view/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="50a1e-125">[![3addView](adding-a-view/_static/image4.png "3addView")](adding-a-view/_static/image3.png)</span></span>

<span data-ttu-id="50a1e-126">Vengono creati la cartella *MvcMovie\Views\HelloWorld* e il file *MvcMovie\Views\HelloWorld\Index.vbhtml* .</span><span class="sxs-lookup"><span data-stu-id="50a1e-126">The *MvcMovie\Views\HelloWorld* folder and the *MvcMovie\Views\HelloWorld\Index.vbhtml* file are created.</span></span> <span data-ttu-id="50a1e-127">È possibile visualizzarli nel **Esplora soluzioni**:</span><span class="sxs-lookup"><span data-stu-id="50a1e-127">You can see them in **Solution Explorer**:</span></span>

<span data-ttu-id="50a1e-128">[![SolnExpHelloWorldIndx](adding-a-view/_static/image6.png "SolnExpHelloWorldIndx")](adding-a-view/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="50a1e-128">[![SolnExpHelloWorldIndx](adding-a-view/_static/image6.png "SolnExpHelloWorldIndx")](adding-a-view/_static/image5.png)</span></span>

<span data-ttu-id="50a1e-129">Aggiungere codice HTML sotto il tag `<h2>`.</span><span class="sxs-lookup"><span data-stu-id="50a1e-129">Add some HTML under the `<h2>` tag.</span></span> <span data-ttu-id="50a1e-130">Il file *MvcMovie\Views\HelloWorld\Index.vbhtml* modificato è riportato di seguito.</span><span class="sxs-lookup"><span data-stu-id="50a1e-130">The modified *MvcMovie\Views\HelloWorld\Index.vbhtml* file is shown below.</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample2.vbhtml)]

<span data-ttu-id="50a1e-131">Eseguire l'applicazione e passare al &quot;Hello World&quot; controller (`http://localhost:xxxx/HelloWorld`).</span><span class="sxs-lookup"><span data-stu-id="50a1e-131">Run the application and browse to the &quot;hello world&quot; controller (`http://localhost:xxxx/HelloWorld`).</span></span> <span data-ttu-id="50a1e-132">Il metodo `Index` nel controller non ha fatto molto lavoro; è stata semplicemente eseguita l'istruzione `return View()`, che indicava che volevamo usare un file modello di visualizzazione per eseguire il rendering di una risposta al client.</span><span class="sxs-lookup"><span data-stu-id="50a1e-132">The `Index` method in your controller didn't do much work; it simply ran the statement `return View()`, which indicated that we wanted to use a view template file to render a response to the client.</span></span> <span data-ttu-id="50a1e-133">Poiché non è stato specificato in modo esplicito il nome del file di modello di visualizzazione da usare, per impostazione predefinita, ASP.NET MVC usa il file di visualizzazione *index. vbhtml* nella cartella *\Views\HelloWorld* .</span><span class="sxs-lookup"><span data-stu-id="50a1e-133">Because we did not explicitly specify the name of the view template file to use, ASP.NET MVC defaulted to using the *Index.vbhtml* view file within the *\Views\HelloWorld* folder.</span></span> <span data-ttu-id="50a1e-134">L'immagine seguente mostra la stringa hardcoded nella visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="50a1e-134">The image below shows the string hard-coded in the view.</span></span>

<span data-ttu-id="50a1e-135">[![3HelloWorld](adding-a-view/_static/image8.png "3HelloWorld")](adding-a-view/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="50a1e-135">[![3HelloWorld](adding-a-view/_static/image8.png "3HelloWorld")](adding-a-view/_static/image7.png)</span></span>

<span data-ttu-id="50a1e-136">Sembra abbastanza valido.</span><span class="sxs-lookup"><span data-stu-id="50a1e-136">Looks pretty good.</span></span> <span data-ttu-id="50a1e-137">Si noti, tuttavia, che la barra del titolo del browser indica &quot;Indice&quot; e il titolo grande nella pagina indica &quot;applicazione MVC.&quot; modifiche.</span><span class="sxs-lookup"><span data-stu-id="50a1e-137">However, notice that the browser's title bar says &quot;Index&quot; and the big title on the page says &quot;My MVC Application.&quot; Let's change those.</span></span>

## <a name="changing-views-and-layout-pages"></a><span data-ttu-id="50a1e-138">Modifica delle viste e delle pagine di layout</span><span class="sxs-lookup"><span data-stu-id="50a1e-138">Changing views and layout pages</span></span>

<span data-ttu-id="50a1e-139">Per prima cosa, modificare il testo &quot;applicazione MVC.&quot; il testo viene condiviso e visualizzato in ogni pagina.</span><span class="sxs-lookup"><span data-stu-id="50a1e-139">First, let's change the text &quot;My MVC Application.&quot; That text is shared and appears on every page.</span></span> <span data-ttu-id="50a1e-140">Viene effettivamente visualizzato in una sola posizione del progetto, anche se si trova in ogni pagina dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="50a1e-140">It actually appears in only one place in our project, even though it's on every page in our application.</span></span> <span data-ttu-id="50a1e-141">Passare alla cartella */Views/Shared.* in **Esplora soluzioni** e aprire il file *\_layout. vbhtml* .</span><span class="sxs-lookup"><span data-stu-id="50a1e-141">Go to the */Views/Shared* folder in **Solution Explorer** and open the *\_Layout.vbhtml* file.</span></span> <span data-ttu-id="50a1e-142">Questo file è denominato pagina layout ed è la shell &quot;condivisa&quot; utilizzata da tutte le altre pagine.</span><span class="sxs-lookup"><span data-stu-id="50a1e-142">This file is called a layout page and it's the shared &quot;shell&quot; that all other pages use.</span></span>

<span data-ttu-id="50a1e-143">Si noti la `@RenderBody()` riga di codice accanto alla parte inferiore del file.</span><span class="sxs-lookup"><span data-stu-id="50a1e-143">Note the `@RenderBody()` line of code near the bottom of the file.</span></span> <span data-ttu-id="50a1e-144">`RenderBody` è un segnaposto in cui vengono visualizzate tutte le pagine create, &quot;&quot; di cui è stato eseguito il wrapper nella pagina di layout.</span><span class="sxs-lookup"><span data-stu-id="50a1e-144">`RenderBody` is a placeholder where all the pages you create show up, &quot;wrapped&quot; in the layout page.</span></span> <span data-ttu-id="50a1e-145">Modificare l'intestazione di `<h1>` da **&quot;** &quot; dell'applicazione mvc per &quot;&quot;di app del film MVC.</span><span class="sxs-lookup"><span data-stu-id="50a1e-145">Change the `<h1>` heading from **&quot;** My MVC Application&quot; to &quot;MVC Movie App&quot;.</span></span>

[!code-html[Main](adding-a-view/samples/sample3.html)]

<span data-ttu-id="50a1e-146">Eseguire l'applicazione e si noti che ora &quot;&quot;app Movie MVC.</span><span class="sxs-lookup"><span data-stu-id="50a1e-146">Run the application and note it now says &quot;MVC Movie App&quot;.</span></span> <span data-ttu-id="50a1e-147">Fare clic sul collegamento **About (informazioni** ). nella pagina viene visualizzato &quot;&quot;app Movie MVC.</span><span class="sxs-lookup"><span data-stu-id="50a1e-147">Click the **About** link, and that page shows &quot;MVC Movie App&quot;, too.</span></span>

<span data-ttu-id="50a1e-148">Di seguito è riportato il file completo *\_layout. vbhtml* :</span><span class="sxs-lookup"><span data-stu-id="50a1e-148">The complete *\_Layout.vbhtml* file is shown below:</span></span>

[!code-cshtml[Main](adding-a-view/samples/sample4.cshtml)]

<span data-ttu-id="50a1e-149">A questo punto, modificare il titolo della pagina di indice (visualizzazione).</span><span class="sxs-lookup"><span data-stu-id="50a1e-149">Now, let's change the title of the Index page (view).</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample5.vbhtml)]

<span data-ttu-id="50a1e-150">Aprire *MvcMovie\Views\HelloWorld\Index.vbhtml*.</span><span class="sxs-lookup"><span data-stu-id="50a1e-150">Open *MvcMovie\Views\HelloWorld\Index.vbhtml*.</span></span> <span data-ttu-id="50a1e-151">Sono disponibili due posizioni per apportare una modifica: innanzitutto, il testo visualizzato nel titolo del browser e quindi nell'intestazione secondaria (elemento `<h2>`).</span><span class="sxs-lookup"><span data-stu-id="50a1e-151">There are two places to make a change: first, the text that appears in the title of the browser, and then in the secondary header (the `<h2>` element).</span></span> <span data-ttu-id="50a1e-152">Le modifiche verranno apportate in modo leggermente diverso, in modo da poter visualizzare il bit di codice modificato che fa parte dell'app.</span><span class="sxs-lookup"><span data-stu-id="50a1e-152">We'll make them slightly different so you can see which bit of code changes which part of the app.</span></span>

<span data-ttu-id="50a1e-153">Eseguire l'applicazione e passare a`http://localhost:xx/HelloWorld`.</span><span class="sxs-lookup"><span data-stu-id="50a1e-153">Run the application and browse to`http://localhost:xx/HelloWorld`.</span></span> <span data-ttu-id="50a1e-154">Si noti che il titolo del browser, l'intestazione primaria e le intestazioni secondarie sono cambiati.</span><span class="sxs-lookup"><span data-stu-id="50a1e-154">Notice that the browser title, the primary heading, and the secondary headings have changed.</span></span> <span data-ttu-id="50a1e-155">È facile apportare modifiche importanti all'applicazione con piccole modifiche a una vista.</span><span class="sxs-lookup"><span data-stu-id="50a1e-155">It's easy to make big changes in your application with small changes to a view.</span></span> <span data-ttu-id="50a1e-156">Se le modifiche non sono visibili nel browser, è possibile che si stia visualizzando il contenuto memorizzato nella cache.</span><span class="sxs-lookup"><span data-stu-id="50a1e-156">(If you don't see changes in the browser, you might be viewing cached content.</span></span> <span data-ttu-id="50a1e-157">Premere CTRL + F5 nel browser per forzare il caricamento della risposta dal server.</span><span class="sxs-lookup"><span data-stu-id="50a1e-157">Press Ctrl+F5 in your browser to force the response from the server to be loaded.)</span></span>

<span data-ttu-id="50a1e-158">[![3_MyMovieList](adding-a-view/_static/image10.png "3_MyMovieList")](adding-a-view/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="50a1e-158">[![3_MyMovieList](adding-a-view/_static/image10.png "3_MyMovieList")](adding-a-view/_static/image9.png)</span></span>

<span data-ttu-id="50a1e-159">Il &quot;&quot; di dati, in questo caso il &quot;messaggio Hello World!&quot;, è tuttavia hardcoded.</span><span class="sxs-lookup"><span data-stu-id="50a1e-159">Our little bit of &quot;data&quot; (in this case the &quot;Hello World!&quot; message) is hard-coded, though.</span></span> <span data-ttu-id="50a1e-160">Nell'applicazione MVC sono presenti V (visualizzazioni) e C (controller), ma non M (modello) ancora.</span><span class="sxs-lookup"><span data-stu-id="50a1e-160">Our MVC application has V (views) and we've got C (controllers), but no M (model) yet.</span></span> <span data-ttu-id="50a1e-161">A breve verrà illustrato come creare un database e recuperare i dati del modello.</span><span class="sxs-lookup"><span data-stu-id="50a1e-161">Shortly, we'll walk through how create a database and retrieve model data from it.</span></span>

## <a name="passing-data-from-the-controller-to-the-view"></a><span data-ttu-id="50a1e-162">Passaggio di dati dal controller alla vista</span><span class="sxs-lookup"><span data-stu-id="50a1e-162">Passing Data from the Controller to the View</span></span>

<span data-ttu-id="50a1e-163">Prima di passare a un database e a parlare dei modelli, tuttavia, parliamo prima di passare le informazioni dal controller a una visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="50a1e-163">Before we go to a database and talk about models, though, let's first talk about passing information from the Controller to a View.</span></span> <span data-ttu-id="50a1e-164">Per eseguire il rendering di una risposta HTML a un client, è necessario passare il modello di visualizzazione richiesto.</span><span class="sxs-lookup"><span data-stu-id="50a1e-164">We want to pass what a view template requires in order to render an HTML response to a client.</span></span> <span data-ttu-id="50a1e-165">Questi oggetti vengono in genere creati e passati da una classe controller a un modello di visualizzazione e devono contenere solo i dati richiesti dal modello di visualizzazione e non più.</span><span class="sxs-lookup"><span data-stu-id="50a1e-165">These objects are typically created and passed by a controller class to a view template, and they should contain only the data that the view template requires — and no more.</span></span>

<span data-ttu-id="50a1e-166">In precedenza con la classe `HelloWorldController`, il metodo di azione `Welcome` ha accettato un `name` e un parametro `numTimes` e quindi ha restituito i valori del parametro al browser.</span><span class="sxs-lookup"><span data-stu-id="50a1e-166">Previously with the `HelloWorldController` class, the `Welcome` action method took a `name` and a `numTimes` parameter and then output the parameter values to the browser.</span></span> <span data-ttu-id="50a1e-167">Anziché fare in modo che il controller continui a eseguire direttamente il rendering di questa risposta, verranno inseriti i dati in un contenitore per la visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="50a1e-167">Rather than have the controller continue to render this response directly, let's instead we'll put that data in a bag for the View.</span></span> <span data-ttu-id="50a1e-168">I controller e le visualizzazioni possono usare un oggetto `ViewBag` per conservare i dati.</span><span class="sxs-lookup"><span data-stu-id="50a1e-168">Controllers and Views can use a `ViewBag` object to hold that data.</span></span> <span data-ttu-id="50a1e-169">Che verrà passato a un modello di visualizzazione automaticamente e usato per eseguire il rendering della risposta HTML usando il contenuto del contenitore come dati.</span><span class="sxs-lookup"><span data-stu-id="50a1e-169">That will be passed over to a view template automatically, and used to render the HTML response using the contents of the bag as data.</span></span> <span data-ttu-id="50a1e-170">In questo modo il controller è interessato da una cosa e dal modello di vista con un altro, consentendo di mantenere puliti &quot;la separazione dei problemi&quot; all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="50a1e-170">That way the controller is concerned with one thing and the view template with another — enabling us to maintain clean &quot;separation of concerns&quot; within the application.</span></span>

<span data-ttu-id="50a1e-171">In alternativa, è possibile definire una classe personalizzata, quindi creare un'istanza di tale oggetto, inserire i dati e passarli alla visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="50a1e-171">Alternatively, we could define a custom class, then create an instance of that object on our own, fill it with data and pass it to the View.</span></span> <span data-ttu-id="50a1e-172">Spesso viene chiamato ViewModel, perché si tratta di un modello personalizzato per la visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="50a1e-172">That is often called a ViewModel, because it's a custom Model for the View.</span></span> <span data-ttu-id="50a1e-173">Per piccole quantità di dati, tuttavia, ViewBag funziona benissimo.</span><span class="sxs-lookup"><span data-stu-id="50a1e-173">For small amounts of data, however, the ViewBag works great.</span></span>

<span data-ttu-id="50a1e-174">Tornare al file *HelloWorldController. vb* modificare il metodo `Welcome` all'interno del controller per inserire il messaggio e NumTimes in ViewBag.</span><span class="sxs-lookup"><span data-stu-id="50a1e-174">Return to the *HelloWorldController.vb* file change the `Welcome` method inside the controller to put the Message and NumTimes into the ViewBag.</span></span> <span data-ttu-id="50a1e-175">ViewBag è un oggetto dinamico.</span><span class="sxs-lookup"><span data-stu-id="50a1e-175">The ViewBag is a dynamic object.</span></span> <span data-ttu-id="50a1e-176">Ciò significa che è possibile inserire il contenuto desiderato.</span><span class="sxs-lookup"><span data-stu-id="50a1e-176">That means you can put whatever you want in to it.</span></span> <span data-ttu-id="50a1e-177">Il ViewBag non dispone di proprietà definite fino a quando non si inserisce un elemento al suo interno.</span><span class="sxs-lookup"><span data-stu-id="50a1e-177">The ViewBag has no defined properties until you put something inside it.</span></span>

<span data-ttu-id="50a1e-178">`HelloWorldController.vb` completa con la nuova classe nello stesso file.</span><span class="sxs-lookup"><span data-stu-id="50a1e-178">The complete `HelloWorldController.vb` with the new class in the same file.</span></span>

[!code-vb[Main](adding-a-view/samples/sample6.vb)]

<span data-ttu-id="50a1e-179">Il ViewBag contiene ora i dati che verranno passati automaticamente alla visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="50a1e-179">Now our ViewBag contains data that will be passed over to the View automatically.</span></span> <span data-ttu-id="50a1e-180">Anche in questo caso, è possibile che sia stato passato un oggetto come questo, se è stato apprezzato:</span><span class="sxs-lookup"><span data-stu-id="50a1e-180">Again, alternatively we could have passed in our own object like this if we liked:</span></span>

[!code-csharp[Main](adding-a-view/samples/sample7.cs)]

<span data-ttu-id="50a1e-181">A questo punto è necessario un modello di `WelcomeView`.</span><span class="sxs-lookup"><span data-stu-id="50a1e-181">Now we need a `WelcomeView` template!</span></span> <span data-ttu-id="50a1e-182">Eseguire l'applicazione in modo che il nuovo codice venga compilato.</span><span class="sxs-lookup"><span data-stu-id="50a1e-182">Run the application so the new code is compiled.</span></span> <span data-ttu-id="50a1e-183">Chiudere il browser, fare clic con il pulsante destro del mouse all'interno del `Welcome` metodo, quindi fare clic su **Aggiungi visualizzazione**.</span><span class="sxs-lookup"><span data-stu-id="50a1e-183">Close the browser, right-click inside the `Welcome` method, and then click **Add View**.</span></span>

<span data-ttu-id="50a1e-184">Ecco come appare la finestra di dialogo **Aggiungi visualizzazione** .</span><span class="sxs-lookup"><span data-stu-id="50a1e-184">Here's what your **Add View** dialog box looks like.</span></span>

<span data-ttu-id="50a1e-185">[![3AddWelcomeView](adding-a-view/_static/image12.png "3AddWelcomeView")](adding-a-view/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="50a1e-185">[![3AddWelcomeView](adding-a-view/_static/image12.png "3AddWelcomeView")](adding-a-view/_static/image11.png)</span></span>

<span data-ttu-id="50a1e-186">Aggiungere il codice seguente sotto l'elemento `<h2>` nel nuovo elemento <em>Welcome.</em> file vbhtml.</span><span class="sxs-lookup"><span data-stu-id="50a1e-186">Add the following code under the `<h2>` element in the new <em>Welcome.</em>vbhtml file.</span></span> <span data-ttu-id="50a1e-187">Verrà creato un ciclo e si dirà &quot;Hello&quot; il numero di volte in cui l'utente dice che è necessario.</span><span class="sxs-lookup"><span data-stu-id="50a1e-187">We'll make a loop and say &quot;Hello&quot; as many times as the user says we should!</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample8.vbhtml)]

<span data-ttu-id="50a1e-188">Eseguire l'applicazione e passare a `http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`</span><span class="sxs-lookup"><span data-stu-id="50a1e-188">Run the application and browse to `http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`</span></span>

<span data-ttu-id="50a1e-189">Ora i dati vengono ricavati dall'URL e passati al controller automaticamente.</span><span class="sxs-lookup"><span data-stu-id="50a1e-189">Now data is taken from the URL and passed to the controller automatically.</span></span> <span data-ttu-id="50a1e-190">Il controller inserisce i dati in un oggetto `Model` e passa tale oggetto alla visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="50a1e-190">The controller packages up the data into a `Model` object and passes that object to the view.</span></span> <span data-ttu-id="50a1e-191">Visualizzazione che Visualizza i dati in formato HTML per l'utente.</span><span class="sxs-lookup"><span data-stu-id="50a1e-191">The view than displays the data as HTML to the user.</span></span>

<span data-ttu-id="50a1e-192">[![3Hello_Scott_4](adding-a-view/_static/image14.png "3Hello_Scott_4")](adding-a-view/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="50a1e-192">[![3Hello_Scott_4](adding-a-view/_static/image14.png "3Hello_Scott_4")](adding-a-view/_static/image13.png)</span></span>

<span data-ttu-id="50a1e-193">Beh, era un tipo di &quot;M&quot; per il modello, ma non per il tipo di database.</span><span class="sxs-lookup"><span data-stu-id="50a1e-193">Well, that was a kind of an &quot;M&quot; for model, but not the database kind.</span></span> <span data-ttu-id="50a1e-194">Creare un database di film con i concetti appresi.</span><span class="sxs-lookup"><span data-stu-id="50a1e-194">Let's take what we've learned and create a database of movies.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="50a1e-195">[Precedente](adding-a-controller.md)
> [Successivo](adding-a-model.md)</span><span class="sxs-lookup"><span data-stu-id="50a1e-195">[Previous](adding-a-controller.md)
[Next](adding-a-model.md)</span></span>
