---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-controller
title: Aggiunta di un controller (VB) | Microsoft Docs
author: Rick-Anderson
description: In questa esercitazione vengono illustrate le nozioni di base della creazione di un'applicazione Web MVC ASP.NET utilizzando Microsoft Visual Web Developer 2010 Express Service Pack 1, ovvero...
ms.author: riande
ms.date: 01/12/2011
ms.assetid: 741259e1-54ac-4f71-b4e8-2bd5560bb950
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-controller
msc.type: authoredcontent
ms.openlocfilehash: 2e77f62a9796211b0e59a99c71bc532659b7cb92
ms.sourcegitcommit: 7709c0a091b8d55b7b33bad8849f7b66b23c3d72
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/19/2020
ms.locfileid: "77457402"
---
# <a name="adding-a-controller-vb"></a><span data-ttu-id="5f34f-103">Aggiunta di un controller (VB)</span><span class="sxs-lookup"><span data-stu-id="5f34f-103">Adding a Controller (VB)</span></span>

<span data-ttu-id="5f34f-104">di [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="5f34f-104">by [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

> <span data-ttu-id="5f34f-105">In questa esercitazione vengono illustrate le nozioni di base della creazione di un'applicazione Web MVC ASP.NET utilizzando Microsoft Visual Web Developer 2010 Express Service Pack 1, una versione gratuita di Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5f34f-105">This tutorial will teach you the basics of building an ASP.NET MVC Web application using Microsoft Visual Web Developer 2010 Express Service Pack 1, which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="5f34f-106">Prima di iniziare, verificare di aver installato i prerequisiti elencati di seguito.</span><span class="sxs-lookup"><span data-stu-id="5f34f-106">Before you start, make sure you've installed the prerequisites listed below.</span></span> <span data-ttu-id="5f34f-107">È possibile installarli tutti facendo clic sul collegamento seguente: [installazione guidata piattaforma Web](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="5f34f-107">You can install all of them by clicking the following link: [Web Platform Installer](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span></span> <span data-ttu-id="5f34f-108">In alternativa, è possibile installare singolarmente i prerequisiti usando i collegamenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="5f34f-108">Alternatively, you can individually install the prerequisites using the following links:</span></span>
> 
> - [<span data-ttu-id="5f34f-109">Prerequisiti di Visual Studio Web Developer Express SP1</span><span class="sxs-lookup"><span data-stu-id="5f34f-109">Visual Studio Web Developer Express SP1 prerequisites</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [<span data-ttu-id="5f34f-110">Aggiornamento degli strumenti di ASP.NET MVC 3</span><span class="sxs-lookup"><span data-stu-id="5f34f-110">ASP.NET MVC 3 Tools Update</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - <span data-ttu-id="5f34f-111">[SQL Server Compact 4,0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(supporto di runtime + Tools)</span><span class="sxs-lookup"><span data-stu-id="5f34f-111">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(runtime + tools support)</span></span>
> 
> <span data-ttu-id="5f34f-112">Se si usa Visual Studio 2010 anziché Visual Web Developer 2010, installare i prerequisiti facendo clic sul collegamento seguente: [prerequisiti di Visual studio 2010](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="5f34f-112">If you're using Visual Studio 2010 instead of Visual Web Developer 2010, install the prerequisites by clicking the following link: [Visual Studio 2010 prerequisites](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span></span>
> 
> <span data-ttu-id="5f34f-113">Per accompagnare questo argomento, è disponibile un progetto Visual Web Developer con codice sorgente VB.NET.</span><span class="sxs-lookup"><span data-stu-id="5f34f-113">A Visual Web Developer project with VB.NET source code is available to accompany this topic.</span></span> <span data-ttu-id="5f34f-114">[Scaricare la versione di VB.NET](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span><span class="sxs-lookup"><span data-stu-id="5f34f-114">[Download the VB.NET version](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span></span> <span data-ttu-id="5f34f-115">Se si preferisce C#, passare alla [ C# versione](../cs/adding-a-controller.md) di questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="5f34f-115">If you prefer C#, switch to the [C# version](../cs/adding-a-controller.md) of this tutorial.</span></span>

<span data-ttu-id="5f34f-116">MVC è l'acronimo di *Model-View-Controller*.</span><span class="sxs-lookup"><span data-stu-id="5f34f-116">MVC stands for *model-view-controller*.</span></span> <span data-ttu-id="5f34f-117">MVC è un modello per lo sviluppo di applicazioni in modo che ogni parte abbia una responsabilità separata:</span><span class="sxs-lookup"><span data-stu-id="5f34f-117">MVC is a pattern for developing applications such that each part has a separate responsibility:</span></span>

- <span data-ttu-id="5f34f-118">Modello: i dati per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5f34f-118">Model: The data for your application.</span></span>
- <span data-ttu-id="5f34f-119">Views: i file modello che l'applicazione userà per generare dinamicamente risposte HTML.</span><span class="sxs-lookup"><span data-stu-id="5f34f-119">Views: The template files your application will use to dynamically generate HTML responses.</span></span>
- <span data-ttu-id="5f34f-120">Controller: classi che gestiscono le richieste URL in ingresso per l'applicazione, recuperano i dati del modello e quindi specificano i modelli di visualizzazione che eseguono il rendering di una risposta al client.</span><span class="sxs-lookup"><span data-stu-id="5f34f-120">Controllers: Classes that handle incoming URL requests to the application, retrieve model data, and then specify view templates that render a response to the client.</span></span>

<span data-ttu-id="5f34f-121">Verranno trattati tutti questi concetti in questa esercitazione e verrà illustrato come usarli per creare un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5f34f-121">We'll be covering all these concepts in this tutorial and show you how to use them to build an application.</span></span>

<span data-ttu-id="5f34f-122">Per creare un nuovo controller, fare clic con il pulsante destro del mouse sulla cartella *Controllers* in **Esplora soluzioni** e quindi scegliere **Aggiungi controller**.</span><span class="sxs-lookup"><span data-stu-id="5f34f-122">Create a new controller by right-clicking the *Controllers* folder in **Solution Explorer** and then selecting **Add Controller**.</span></span>

<span data-ttu-id="5f34f-123">[![AddController](adding-a-controller/_static/image2.png "AddController")](adding-a-controller/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5f34f-123">[![AddController](adding-a-controller/_static/image2.png "AddController")](adding-a-controller/_static/image1.png)</span></span>

<span data-ttu-id="5f34f-124">Assegnare un nome al nuovo controller &quot;HelloWorldController&quot; e fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="5f34f-124">Name your new controller &quot;HelloWorldController&quot; and click **Add**.</span></span>

<span data-ttu-id="5f34f-125">[![2AddEmptyController](adding-a-controller/_static/image4.png "2AddEmptyController")](adding-a-controller/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="5f34f-125">[![2AddEmptyController](adding-a-controller/_static/image4.png "2AddEmptyController")](adding-a-controller/_static/image3.png)</span></span>

<span data-ttu-id="5f34f-126">Si noti che in **Esplora soluzioni** a destra è stato creato un nuovo file denominato *HelloWorldController.cs* e che il file è aperto nell'IDE.</span><span class="sxs-lookup"><span data-stu-id="5f34f-126">Notice in **Solution Explorer** on the right that a new file has been created for you named *HelloWorldController.cs* and that the file is open in the IDE.</span></span>

<span data-ttu-id="5f34f-127">All'interno del nuovo blocco `public class HelloWorldController` creare due nuovi metodi simili al codice riportato di seguito.</span><span class="sxs-lookup"><span data-stu-id="5f34f-127">Inside the new `public class HelloWorldController` block, create two new methods that look like the following code.</span></span> <span data-ttu-id="5f34f-128">Verrà restituita una stringa di codice HTML direttamente dal controller come esempio.</span><span class="sxs-lookup"><span data-stu-id="5f34f-128">We'll return a string of HTML directly from the controller as an example.</span></span>

[!code-vb[Main](adding-a-controller/samples/sample1.vb)]

<span data-ttu-id="5f34f-129">Il controller è denominato `HelloWorldController` e il nuovo metodo è denominato `Index`.</span><span class="sxs-lookup"><span data-stu-id="5f34f-129">Your controller is named `HelloWorldController` and your new method is named `Index`.</span></span> <span data-ttu-id="5f34f-130">Eseguire l'applicazione (premere F5 o CTRL + F5).</span><span class="sxs-lookup"><span data-stu-id="5f34f-130">Run the application (press F5 or Ctrl+F5).</span></span> <span data-ttu-id="5f34f-131">Al termine dell'avvio del browser, aggiungere &quot;HelloWorld&quot; al percorso nella barra degli indirizzi.</span><span class="sxs-lookup"><span data-stu-id="5f34f-131">Once your browser has started up, append &quot;HelloWorld&quot; to the path in the address bar.</span></span> <span data-ttu-id="5f34f-132">(Sul mio computer è `http://localhost:43246/HelloWorld`) Il browser sarà simile alla schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="5f34f-132">(On my computer, it's `http://localhost:43246/HelloWorld`) Your browser will look like the screenshot below.</span></span> <span data-ttu-id="5f34f-133">Nel metodo precedente, il codice ha restituito direttamente una stringa.</span><span class="sxs-lookup"><span data-stu-id="5f34f-133">In the method above, the code returned a string directly.</span></span> <span data-ttu-id="5f34f-134">Abbiamo comunicato al sistema di restituire solo codice HTML,</span><span class="sxs-lookup"><span data-stu-id="5f34f-134">We told the system to just return some HTML, and it did!</span></span>

![](adding-a-controller/_static/image5.png)

<span data-ttu-id="5f34f-135">ASP.NET MVC richiama diverse classi controller (e metodi di azione diversi al loro interno) a seconda dell'URL in ingresso.</span><span class="sxs-lookup"><span data-stu-id="5f34f-135">ASP.NET MVC invokes different controller classes (and different action methods within them) depending on the incoming URL.</span></span> <span data-ttu-id="5f34f-136">La logica di mapping predefinita usata da ASP.NET MVC usa un formato simile al seguente per controllare quale codice viene richiamato:</span><span class="sxs-lookup"><span data-stu-id="5f34f-136">The default mapping logic used by ASP.NET MVC uses a format like this to control what code is invoked:</span></span>

`/[Controller]/[ActionName]/[Parameters]`

<span data-ttu-id="5f34f-137">La prima parte dell'URL determina la classe controller da eseguire.</span><span class="sxs-lookup"><span data-stu-id="5f34f-137">The first part of the URL determines the controller class to execute.</span></span> <span data-ttu-id="5f34f-138">Quindi */HelloWorld* esegue il mapping alla classe `HelloWorldController`.</span><span class="sxs-lookup"><span data-stu-id="5f34f-138">So */HelloWorld* maps to the `HelloWorldController` class.</span></span> <span data-ttu-id="5f34f-139">La seconda parte dell'URL determina il metodo di azione sulla classe da eseguire.</span><span class="sxs-lookup"><span data-stu-id="5f34f-139">The second part of the URL determines the action method on the class to execute.</span></span> <span data-ttu-id="5f34f-140">Pertanto */HelloWorld/index* provocherebbe l'esecuzione del metodo `Index` della classe `HelloWorldController`.</span><span class="sxs-lookup"><span data-stu-id="5f34f-140">So */HelloWorld/Index* would cause the `Index` method of the `HelloWorldController` class to execute.</span></span> <span data-ttu-id="5f34f-141">Si noti che è stato necessario solo visitare */HelloWorld* e il metodo `Index` è stato usato per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="5f34f-141">Notice that we only had to visit */HelloWorld* above and the `Index` method was used by default.</span></span> <span data-ttu-id="5f34f-142">Questo perché un metodo denominato `Index` è il metodo predefinito che verrà chiamato su un controller se non ne viene specificato uno in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="5f34f-142">This is because a method named `Index` is the default method that will be called on a controller if one is not explicitly specified.</span></span>

<span data-ttu-id="5f34f-143">Passare a `http://localhost:xxxx/HelloWorld/Welcome`.</span><span class="sxs-lookup"><span data-stu-id="5f34f-143">Browse to `http://localhost:xxxx/HelloWorld/Welcome`.</span></span> <span data-ttu-id="5f34f-144">Il metodo `Welcome` viene eseguito e restituisce la stringa &quot;questo è il metodo di azione iniziale...&quot;.</span><span class="sxs-lookup"><span data-stu-id="5f34f-144">The `Welcome` method runs and returns the string &quot;This is the Welcome action method...&quot;.</span></span> <span data-ttu-id="5f34f-145">Il mapping MVC predefinito è `/[Controller]/[ActionName]/[Parameters]`.</span><span class="sxs-lookup"><span data-stu-id="5f34f-145">The default MVC mapping is `/[Controller]/[ActionName]/[Parameters]`.</span></span> <span data-ttu-id="5f34f-146">Per questo URL, il controller è `HelloWorld` e `Welcome` è il metodo.</span><span class="sxs-lookup"><span data-stu-id="5f34f-146">For this URL, the controller is `HelloWorld` and `Welcome` is the method.</span></span> <span data-ttu-id="5f34f-147">Non è ancora stato usato il `[Parameters]` parte dell'URL.</span><span class="sxs-lookup"><span data-stu-id="5f34f-147">We haven't used the `[Parameters]` part of the URL yet.</span></span>

![](adding-a-controller/_static/image6.png)

<span data-ttu-id="5f34f-148">Modificare leggermente l'esempio in modo che sia possibile passare le informazioni sui parametri dall'URL al controller (ad esempio, */HelloWorld/Welcome? Name = Scott&amp;numtimes = 4*).</span><span class="sxs-lookup"><span data-stu-id="5f34f-148">Let's modify the example slightly so that we can pass some parameter information in from the URL to the controller (for example, */HelloWorld/Welcome?name=Scott&amp;numtimes=4*).</span></span> <span data-ttu-id="5f34f-149">Modificare il metodo `Welcome` per includere due parametri, come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="5f34f-149">Change your `Welcome` method to include two parameters as shown below.</span></span> <span data-ttu-id="5f34f-150">Si noti che è stata usata la funzionalità di parametro VB facoltativo per indicare che il parametro `numTimes` deve essere impostato su 1 se non viene passato alcun valore per il parametro.</span><span class="sxs-lookup"><span data-stu-id="5f34f-150">Note that we've used the VB optional parameter feature to indicate that the `numTimes` parameter should default to 1 if no value is passed for that parameter.</span></span>

[!code-vb[Main](adding-a-controller/samples/sample2.vb)]

<span data-ttu-id="5f34f-151">Eseguire l'applicazione e passare a `http://localhost:xxxx/HelloWorld/Welcome?name=Scott&numtimes=4` **.**</span><span class="sxs-lookup"><span data-stu-id="5f34f-151">Run your application and browse to `http://localhost:xxxx/HelloWorld/Welcome?name=Scott&numtimes=4`**.**</span></span> <span data-ttu-id="5f34f-152">È possibile provare valori diversi per `name` e `numtimes`.</span><span class="sxs-lookup"><span data-stu-id="5f34f-152">You can try different values for `name` and `numtimes`.</span></span> <span data-ttu-id="5f34f-153">Il sistema esegue automaticamente il mapping dei parametri denominati dalla stringa di query nella barra degli indirizzi ai parametri nel metodo.</span><span class="sxs-lookup"><span data-stu-id="5f34f-153">The system automatically maps the named parameters from your query string in the address bar to parameters in your method.</span></span>

![](adding-a-controller/_static/image7.png)

<span data-ttu-id="5f34f-154">In entrambi questi esempi il controller sta eseguendo la parte VC di MVC, ovvero la visualizzazione e il funzionamento del controller.</span><span class="sxs-lookup"><span data-stu-id="5f34f-154">In both these examples the controller has been doing the VC portion of MVC — that is the view and controller work.</span></span> <span data-ttu-id="5f34f-155">Il controller restituisce direttamente l'HTML.</span><span class="sxs-lookup"><span data-stu-id="5f34f-155">The controller is returning HTML directly.</span></span> <span data-ttu-id="5f34f-156">In genere, non si vuole che i controller restituiscano direttamente HTML, perché questo diventa molto complesso per il codice.</span><span class="sxs-lookup"><span data-stu-id="5f34f-156">Ordinarily we don't want controllers returning HTML directly, since that becomes very cumbersome to code.</span></span> <span data-ttu-id="5f34f-157">Si userà in genere un file modello di vista separato per facilitare la generazione della risposta HTML.</span><span class="sxs-lookup"><span data-stu-id="5f34f-157">Instead we'll typically use a separate view template file to help generate the HTML response.</span></span> <span data-ttu-id="5f34f-158">Esaminiamo ora come possiamo eseguire questa operazione.</span><span class="sxs-lookup"><span data-stu-id="5f34f-158">Let's look at how we can do this.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5f34f-159">[Precedente](intro-to-aspnet-mvc-3.md)
> [Successivo](adding-a-view.md)</span><span class="sxs-lookup"><span data-stu-id="5f34f-159">[Previous](intro-to-aspnet-mvc-3.md)
[Next](adding-a-view.md)</span></span>
