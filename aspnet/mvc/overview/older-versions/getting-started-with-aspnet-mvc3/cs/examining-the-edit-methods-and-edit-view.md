---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/cs/examining-the-edit-methods-and-edit-view
title: Analisi dei metodi di modifica e della visualizzazione di modifica (C#) | Microsoft Docs
author: Rick-Anderson
description: In questa esercitazione vengono illustrate le nozioni di base della creazione di un'applicazione Web MVC ASP.NET utilizzando Microsoft Visual Web Developer 2010 Express Service Pack 1, ovvero...
ms.author: riande
ms.date: 01/12/2011
ms.assetid: 1d266bf0-a61e-423b-a3d2-13773d7dafe2
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/cs/examining-the-edit-methods-and-edit-view
msc.type: authoredcontent
ms.openlocfilehash: 0fb3d3cf6c1f4634834aaac1e9170218ca5730bb
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "86163719"
---
# <a name="examining-the-edit-methods-and-edit-view-c"></a><span data-ttu-id="047e0-103">Analisi dei metodi di modifica e della visualizzazione di modifica (C#)</span><span class="sxs-lookup"><span data-stu-id="047e0-103">Examining the Edit Methods and Edit View (C#)</span></span>

<span data-ttu-id="047e0-104">di [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="047e0-104">by [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

> > [!NOTE]
> > <span data-ttu-id="047e0-105">Una versione aggiornata di questa esercitazione è disponibile [qui](../../../getting-started/introduction/getting-started.md) che usa ASP.NET MVC 5 e Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="047e0-105">An updated version of this tutorial is available [here](../../../getting-started/introduction/getting-started.md) that uses ASP.NET MVC 5 and Visual Studio 2013.</span></span> <span data-ttu-id="047e0-106">È più sicuro, molto più semplice da seguire e illustra altre funzionalità.</span><span class="sxs-lookup"><span data-stu-id="047e0-106">It's more secure, much simpler to follow and demonstrates more features.</span></span>
> 
> 
> <span data-ttu-id="047e0-107">In questa esercitazione vengono illustrate le nozioni di base della creazione di un'applicazione Web MVC ASP.NET utilizzando Microsoft Visual Web Developer 2010 Express Service Pack 1, una versione gratuita di Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="047e0-107">This tutorial will teach you the basics of building an ASP.NET MVC Web application using Microsoft Visual Web Developer 2010 Express Service Pack 1, which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="047e0-108">Prima di iniziare, verificare di aver installato i prerequisiti elencati di seguito.</span><span class="sxs-lookup"><span data-stu-id="047e0-108">Before you start, make sure you've installed the prerequisites listed below.</span></span> <span data-ttu-id="047e0-109">È possibile installarli tutti facendo clic sul collegamento seguente: [installazione guidata piattaforma Web](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="047e0-109">You can install all of them by clicking the following link: [Web Platform Installer](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span></span> <span data-ttu-id="047e0-110">In alternativa, è possibile installare singolarmente i prerequisiti usando i collegamenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="047e0-110">Alternatively, you can individually install the prerequisites using the following links:</span></span>
> 
> - [<span data-ttu-id="047e0-111">Prerequisiti di Visual Studio Web Developer Express SP1</span><span class="sxs-lookup"><span data-stu-id="047e0-111">Visual Studio Web Developer Express SP1 prerequisites</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [<span data-ttu-id="047e0-112">Aggiornamento degli strumenti di ASP.NET MVC 3</span><span class="sxs-lookup"><span data-stu-id="047e0-112">ASP.NET MVC 3 Tools Update</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - <span data-ttu-id="047e0-113">[SQL Server Compact 4,0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(supporto di runtime + Tools)</span><span class="sxs-lookup"><span data-stu-id="047e0-113">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(runtime + tools support)</span></span>
> 
> <span data-ttu-id="047e0-114">Se si usa Visual Studio 2010 anziché Visual Web Developer 2010, installare i prerequisiti facendo clic sul collegamento seguente: [prerequisiti di Visual studio 2010](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="047e0-114">If you're using Visual Studio 2010 instead of Visual Web Developer 2010, install the prerequisites by clicking the following link: [Visual Studio 2010 prerequisites](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span></span>
> 
> <span data-ttu-id="047e0-115">Per accompagnare questo argomento, è disponibile un progetto Visual Web Developer con codice sorgente C#.</span><span class="sxs-lookup"><span data-stu-id="047e0-115">A Visual Web Developer project with C# source code is available to accompany this topic.</span></span> <span data-ttu-id="047e0-116">[Scaricare la versione di C#](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span><span class="sxs-lookup"><span data-stu-id="047e0-116">[Download the C# version](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span></span> <span data-ttu-id="047e0-117">Se si preferisce Visual Basic, passare alla [versione Visual Basic](../vb/intro-to-aspnet-mvc-3.md) di questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="047e0-117">If you prefer Visual Basic, switch to the [Visual Basic version](../vb/intro-to-aspnet-mvc-3.md) of this tutorial.</span></span>

<span data-ttu-id="047e0-118">In questa sezione verranno esaminati i metodi di azione e le visualizzazioni generati per il controller di film.</span><span class="sxs-lookup"><span data-stu-id="047e0-118">In this section, you'll examine the generated action methods and views for the movie controller.</span></span> <span data-ttu-id="047e0-119">Si aggiungerà quindi una pagina di ricerca personalizzata.</span><span class="sxs-lookup"><span data-stu-id="047e0-119">Then you'll add a custom search page.</span></span>

<span data-ttu-id="047e0-120">Eseguire l'applicazione e passare al `Movies` controller aggiungendo */Movies* all'URL nella barra degli indirizzi del browser.</span><span class="sxs-lookup"><span data-stu-id="047e0-120">Run the application and browse to the `Movies` controller by appending */Movies* to the URL in the address bar of your browser.</span></span> <span data-ttu-id="047e0-121">Mantenere il puntatore del mouse su un collegamento **Edit (modifica** ) per visualizzare l'URL a cui si collega.</span><span class="sxs-lookup"><span data-stu-id="047e0-121">Hold the mouse pointer over an **Edit** link to see the URL that it links to.</span></span>

<span data-ttu-id="047e0-122">[![EditLink_sm](examining-the-edit-methods-and-edit-view/_static/image2.png)](examining-the-edit-methods-and-edit-view/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-122">[![EditLink_sm](examining-the-edit-methods-and-edit-view/_static/image2.png)](examining-the-edit-methods-and-edit-view/_static/image1.png)</span></span>

<span data-ttu-id="047e0-123">Il collegamento di **modifica** è stato generato dal `Html.ActionLink` metodo nella visualizzazione *Views\Movies\Index.cshtml* :</span><span class="sxs-lookup"><span data-stu-id="047e0-123">The **Edit** link was generated by the `Html.ActionLink` method in the *Views\Movies\Index.cshtml* view:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample1.cshtml)]

<span data-ttu-id="047e0-124">[![HTML. ActionLink](examining-the-edit-methods-and-edit-view/_static/image4.png)](examining-the-edit-methods-and-edit-view/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-124">[![Html.ActionLink](examining-the-edit-methods-and-edit-view/_static/image4.png)](examining-the-edit-methods-and-edit-view/_static/image3.png)</span></span>

<span data-ttu-id="047e0-125">L' `Html` oggetto è un helper esposto utilizzando una proprietà nella `WebViewPage` classe base.</span><span class="sxs-lookup"><span data-stu-id="047e0-125">The `Html` object is a helper that's exposed using a property on the `WebViewPage` base class.</span></span> <span data-ttu-id="047e0-126">Il `ActionLink` metodo dell'helper semplifica la generazione dinamica di collegamenti ipertestuali HTML che si collegano ai metodi di azione nei controller.</span><span class="sxs-lookup"><span data-stu-id="047e0-126">The `ActionLink` method of the helper makes it easy to dynamically generate HTML hyperlinks that link to action methods on controllers.</span></span> <span data-ttu-id="047e0-127">Il primo argomento del `ActionLink` metodo è il testo del collegamento di cui eseguire il rendering (ad esempio, `<a>Edit Me</a>` ).</span><span class="sxs-lookup"><span data-stu-id="047e0-127">The first argument to the `ActionLink` method is the link text to render (for example, `<a>Edit Me</a>`).</span></span> <span data-ttu-id="047e0-128">Il secondo argomento è il nome del metodo di azione da richiamare.</span><span class="sxs-lookup"><span data-stu-id="047e0-128">The second argument is the name of the action method to invoke.</span></span> <span data-ttu-id="047e0-129">L'argomento finale è un [oggetto anonimo](https://weblogs.asp.net/scottgu/archive/2007/05/15/new-orcas-language-feature-anonymous-types.aspx) che genera i dati della route (in questo caso, l'ID 4).</span><span class="sxs-lookup"><span data-stu-id="047e0-129">The final argument is an [anonymous object](https://weblogs.asp.net/scottgu/archive/2007/05/15/new-orcas-language-feature-anonymous-types.aspx) that generates the route data (in this case, the ID of 4).</span></span>

<span data-ttu-id="047e0-130">Il collegamento generato illustrato nell'immagine precedente è `http://localhost:xxxxx/Movies/Edit/4` .</span><span class="sxs-lookup"><span data-stu-id="047e0-130">The generated link shown in the previous image is `http://localhost:xxxxx/Movies/Edit/4`.</span></span> <span data-ttu-id="047e0-131">La route predefinita accetta il modello di URL `{controller}/{action}/{id}` .</span><span class="sxs-lookup"><span data-stu-id="047e0-131">The default route takes the URL pattern `{controller}/{action}/{id}`.</span></span> <span data-ttu-id="047e0-132">Pertanto, ASP.NET converte `http://localhost:xxxxx/Movies/Edit/4` in una richiesta al `Edit` metodo di azione del `Movies` controller con il parametro `ID` uguale a 4.</span><span class="sxs-lookup"><span data-stu-id="047e0-132">Therefore, ASP.NET translates `http://localhost:xxxxx/Movies/Edit/4` into a request to the `Edit` action method of the `Movies` controller with the parameter `ID` equal to 4.</span></span>

<span data-ttu-id="047e0-133">È anche possibile passare i parametri del metodo di azione usando una stringa di query.</span><span class="sxs-lookup"><span data-stu-id="047e0-133">You can also pass action method parameters using a query string.</span></span> <span data-ttu-id="047e0-134">Ad esempio, l'URL `http://localhost:xxxxx/Movies/Edit?ID=4` passa anche il parametro `ID` di 4 al `Edit` metodo di azione del `Movies` controller.</span><span class="sxs-lookup"><span data-stu-id="047e0-134">For example, the URL `http://localhost:xxxxx/Movies/Edit?ID=4` also passes the parameter `ID` of 4 to the `Edit` action method of the `Movies` controller.</span></span>

<span data-ttu-id="047e0-135">[![EditQueryString](examining-the-edit-methods-and-edit-view/_static/image6.png)](examining-the-edit-methods-and-edit-view/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-135">[![EditQueryString](examining-the-edit-methods-and-edit-view/_static/image6.png)](examining-the-edit-methods-and-edit-view/_static/image5.png)</span></span>

<span data-ttu-id="047e0-136">Aprire il `Movies` controller.</span><span class="sxs-lookup"><span data-stu-id="047e0-136">Open the `Movies` controller.</span></span> <span data-ttu-id="047e0-137">Di `Edit` seguito sono riportati i due metodi di azione.</span><span class="sxs-lookup"><span data-stu-id="047e0-137">The two `Edit` action methods are shown below.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample2.cs)]

<span data-ttu-id="047e0-138">Si noti che il secondo metodo di azione `Edit` è preceduto dall'attributo `HttpPost`.</span><span class="sxs-lookup"><span data-stu-id="047e0-138">Notice the second `Edit` action method is preceded by the `HttpPost` attribute.</span></span> <span data-ttu-id="047e0-139">Questo attributo specifica che l'overload del `Edit` metodo può essere richiamato solo per le richieste post.</span><span class="sxs-lookup"><span data-stu-id="047e0-139">This attribute specifies that overload of the `Edit` method can be invoked only for POST requests.</span></span> <span data-ttu-id="047e0-140">È possibile applicare l' `HttpGet` attributo al primo metodo di modifica, ma ciò non è necessario perché è l'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="047e0-140">You could apply the `HttpGet` attribute to the first edit method, but that's not necessary because it's the default.</span></span> <span data-ttu-id="047e0-141">Si farà riferimento ai metodi di azione assegnati in modo implicito all' `HttpGet` attributo come `HttpGet` metodi.</span><span class="sxs-lookup"><span data-stu-id="047e0-141">(We'll refer to action methods that are implicitly assigned the `HttpGet` attribute as `HttpGet` methods.)</span></span>

<span data-ttu-id="047e0-142">Il `HttpGet` `Edit` metodo accetta il parametro Movie ID, Cerca il film usando il metodo Entity Framework `Find` e restituisce il filmato selezionato alla visualizzazione di modifica.</span><span class="sxs-lookup"><span data-stu-id="047e0-142">The `HttpGet` `Edit` method takes the movie ID parameter, looks up the movie using the Entity Framework `Find` method, and returns the selected movie to the Edit view.</span></span> <span data-ttu-id="047e0-143">Quando il sistema di scaffolding ha creato la vista Edit, ha esaminato la classe `Movie` e il codice creato per eseguire il rendering degli elementi `<label>` e `<input>` per ogni proprietà della classe.</span><span class="sxs-lookup"><span data-stu-id="047e0-143">When the scaffolding system created the Edit view, it examined the `Movie` class and created code to render `<label>` and `<input>` elements for each property of the class.</span></span> <span data-ttu-id="047e0-144">Nell'esempio seguente viene illustrata la visualizzazione di modifica generata:</span><span class="sxs-lookup"><span data-stu-id="047e0-144">The following example shows the Edit view that was generated:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample3.cshtml)]

<span data-ttu-id="047e0-145">Si noti che il modello di visualizzazione include un' `@model MvcMovie.Models.Movie` istruzione all'inizio del file. in questo modo si specifica che la vista prevede che il modello per il modello di vista sia di tipo `Movie` .</span><span class="sxs-lookup"><span data-stu-id="047e0-145">Notice how the view template has a `@model MvcMovie.Models.Movie` statement at the top of the file — this specifies that the view expects the model for the view template to be of type `Movie`.</span></span>

<span data-ttu-id="047e0-146">Il codice con impalcature usa diversi *metodi helper* per semplificare il markup HTML.</span><span class="sxs-lookup"><span data-stu-id="047e0-146">The scaffolded code uses several *helper methods* to streamline the HTML markup.</span></span> <span data-ttu-id="047e0-147">L' [`Html.LabelFor`](https://msdn.microsoft.com/library/gg401864(VS.98).aspx) Helper Visualizza il nome del campo ("title", "ReleaseDate", "genre" o "price").</span><span class="sxs-lookup"><span data-stu-id="047e0-147">The [`Html.LabelFor`](https://msdn.microsoft.com/library/gg401864(VS.98).aspx) helper displays the name of the field ("Title", "ReleaseDate", "Genre", or "Price").</span></span> <span data-ttu-id="047e0-148">L' [`Html.EditorFor`](https://msdn.microsoft.com/library/system.web.mvc.html.editorextensions.editorfor(VS.98).aspx) Helper Visualizza un elemento HTML `<input>` .</span><span class="sxs-lookup"><span data-stu-id="047e0-148">The [`Html.EditorFor`](https://msdn.microsoft.com/library/system.web.mvc.html.editorextensions.editorfor(VS.98).aspx) helper displays an HTML `<input>` element.</span></span> <span data-ttu-id="047e0-149">L' [`Html.ValidationMessageFor`](https://msdn.microsoft.com/library/system.web.mvc.html.validationextensions.validationmessagefor(VS.98).aspx) Helper Visualizza tutti i messaggi di convalida associati a tale proprietà.</span><span class="sxs-lookup"><span data-stu-id="047e0-149">The [`Html.ValidationMessageFor`](https://msdn.microsoft.com/library/system.web.mvc.html.validationextensions.validationmessagefor(VS.98).aspx) helper displays any validation messages associated with that property.</span></span>

<span data-ttu-id="047e0-150">Eseguire l'applicazione e passare all'URL */Movies* .</span><span class="sxs-lookup"><span data-stu-id="047e0-150">Run the application and navigate to the */Movies* URL.</span></span> <span data-ttu-id="047e0-151">Fare clic su un collegamento di **modifica** .</span><span class="sxs-lookup"><span data-stu-id="047e0-151">Click an **Edit** link.</span></span> <span data-ttu-id="047e0-152">Nel browser visualizzare l'origine per la pagina.</span><span class="sxs-lookup"><span data-stu-id="047e0-152">In the browser, view the source for the page.</span></span> <span data-ttu-id="047e0-153">Il codice HTML nella pagina ha un aspetto simile all'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="047e0-153">The HTML in the page looks like the following example.</span></span> <span data-ttu-id="047e0-154">Il markup del menu è stato escluso per maggiore chiarezza.</span><span class="sxs-lookup"><span data-stu-id="047e0-154">(The menu markup was excluded for clarity.)</span></span>

[!code-html[Main](examining-the-edit-methods-and-edit-view/samples/sample4.html)]

<span data-ttu-id="047e0-155">Gli `<input>` elementi si trovano in un `<form>` elemento HTML il cui `action` attributo è impostato su post sull'URL */Movies/Edit* .</span><span class="sxs-lookup"><span data-stu-id="047e0-155">The `<input>` elements are in an HTML `<form>` element whose `action` attribute is set to post to the */Movies/Edit* URL.</span></span> <span data-ttu-id="047e0-156">I dati del modulo verranno inviati al server quando si fa clic sul pulsante **modifica** .</span><span class="sxs-lookup"><span data-stu-id="047e0-156">The form data will be posted to the server when the **Edit** button is clicked.</span></span>

## <a name="processing-the-post-request"></a><span data-ttu-id="047e0-157">Elaborazione della richiesta POST</span><span class="sxs-lookup"><span data-stu-id="047e0-157">Processing the POST Request</span></span>

<span data-ttu-id="047e0-158">Nell'elenco seguente viene indicata la versione `HttpPost` del metodo di azione `Edit`.</span><span class="sxs-lookup"><span data-stu-id="047e0-158">The following listing shows the `HttpPost` version of the `Edit` action method.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample5.cs)]

<span data-ttu-id="047e0-159">Lo strumento di associazione di modelli di ASP.NET Framework accetta i valori del modulo inviati e crea un `Movie` oggetto passato come `movie` parametro.</span><span class="sxs-lookup"><span data-stu-id="047e0-159">The ASP.NET framework model binder takes the posted form values and creates a `Movie` object that's passed as the `movie` parameter.</span></span> <span data-ttu-id="047e0-160">Il `ModelState.IsValid` controllo del codice verifica che i dati inviati nel form possano essere usati per modificare un `Movie` oggetto.</span><span class="sxs-lookup"><span data-stu-id="047e0-160">The `ModelState.IsValid` check in the code verifies that the data submitted in the form can be used to modify a `Movie` object.</span></span> <span data-ttu-id="047e0-161">Se i dati sono validi, il codice salva i dati del film nella `Movies` raccolta dell' `MovieDBContext` istanza.</span><span class="sxs-lookup"><span data-stu-id="047e0-161">If the data is valid, the code saves the movie data to the `Movies` collection of the `MovieDBContext` instance.</span></span> <span data-ttu-id="047e0-162">Il codice salva quindi i nuovi dati del film nel database chiamando il `SaveChanges` metodo di `MovieDBContext` , che rende permanente le modifiche apportate al database.</span><span class="sxs-lookup"><span data-stu-id="047e0-162">The code then saves the new movie data to the database by calling the `SaveChanges` method of `MovieDBContext`, which persists changes to the database.</span></span> <span data-ttu-id="047e0-163">Dopo aver salvato i dati, il codice reindirizza l'utente al `Index` metodo di azione della `MoviesController` classe, che fa sì che il filmato aggiornato venga visualizzato nell'elenco dei filmati.</span><span class="sxs-lookup"><span data-stu-id="047e0-163">After saving the data, the code redirects the user to the `Index` action method of the `MoviesController` class, which causes the updated movie to be displayed in the listing of movies.</span></span>

<span data-ttu-id="047e0-164">Se i valori inviati non sono validi, vengono visualizzati nuovamente nel form.</span><span class="sxs-lookup"><span data-stu-id="047e0-164">If the posted values aren't valid, they are redisplayed in the form.</span></span> <span data-ttu-id="047e0-165">Gli `Html.ValidationMessageFor` helper nel modello di vista *Edit. cshtml* si occupano della visualizzazione dei messaggi di errore appropriati.</span><span class="sxs-lookup"><span data-stu-id="047e0-165">The `Html.ValidationMessageFor` helpers in the *Edit.cshtml* view template take care of displaying appropriate error messages.</span></span>

<span data-ttu-id="047e0-166">[![abcNotValid](examining-the-edit-methods-and-edit-view/_static/image8.png)](examining-the-edit-methods-and-edit-view/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-166">[![abcNotValid](examining-the-edit-methods-and-edit-view/_static/image8.png)](examining-the-edit-methods-and-edit-view/_static/image7.png)</span></span>

> <span data-ttu-id="047e0-167">**Nota sulle impostazioni locali** Se normalmente si lavora con impostazioni locali diverse dall'inglese, vedere [supporto della convalida di ASP.NET MVC 3 con impostazioni locali diverse dall'inglese.](https://msdn.microsoft.com/library/gg674880(VS.98).aspx)</span><span class="sxs-lookup"><span data-stu-id="047e0-167">**Note about locales** If you normally work with a locale other than English, see [Supporting ASP.NET MVC 3 Validation with Non-English Locales.](https://msdn.microsoft.com/library/gg674880(VS.98).aspx)</span></span>

## <a name="making-the-edit-method-more-robust"></a><span data-ttu-id="047e0-168">Rendere più affidabile il metodo di modifica</span><span class="sxs-lookup"><span data-stu-id="047e0-168">Making the Edit Method More Robust</span></span>

<span data-ttu-id="047e0-169">Il `HttpGet` `Edit` metodo generato dal sistema di ponteggi non verifica che l'ID passato sia valido.</span><span class="sxs-lookup"><span data-stu-id="047e0-169">The `HttpGet` `Edit` method generated by the scaffolding system doesn't check that the ID that's passed to it is valid.</span></span> <span data-ttu-id="047e0-170">Se un utente rimuove il segmento ID dall'URL ( `http://localhost:xxxxx/Movies/Edit` ), viene visualizzato l'errore seguente:</span><span class="sxs-lookup"><span data-stu-id="047e0-170">If a user removes the ID segment from the URL (`http://localhost:xxxxx/Movies/Edit`), the following error is displayed:</span></span>

<span data-ttu-id="047e0-171">[![Null_ID](examining-the-edit-methods-and-edit-view/_static/image10.png)](examining-the-edit-methods-and-edit-view/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-171">[![Null_ID](examining-the-edit-methods-and-edit-view/_static/image10.png)](examining-the-edit-methods-and-edit-view/_static/image9.png)</span></span>

<span data-ttu-id="047e0-172">Un utente può anche passare un ID che non esiste nel database, ad esempio `http://localhost:xxxxx/Movies/Edit/1234` .</span><span class="sxs-lookup"><span data-stu-id="047e0-172">A user could also pass an ID that doesn't exist in the database, such as `http://localhost:xxxxx/Movies/Edit/1234`.</span></span> <span data-ttu-id="047e0-173">Per risolvere questa limitazione, è possibile apportare due modifiche al `HttpGet` `Edit` metodo di azione.</span><span class="sxs-lookup"><span data-stu-id="047e0-173">You can make two changes to the `HttpGet` `Edit` action method to address this limitation.</span></span> <span data-ttu-id="047e0-174">Per prima cosa, modificare il `ID` parametro in modo che il valore predefinito sia zero quando un ID non viene passato in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="047e0-174">First, change the `ID` parameter to have a default value of zero when an ID isn't explicitly passed.</span></span> <span data-ttu-id="047e0-175">È anche possibile verificare che il `Find` metodo abbia trovato un film prima di restituire l'oggetto Movie al modello di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="047e0-175">You can also check that the `Find` method actually found a movie before returning the movie object to the view template.</span></span> <span data-ttu-id="047e0-176">Il `Edit` metodo aggiornato è illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="047e0-176">The updated `Edit` method is shown below.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample6.cs)]

<span data-ttu-id="047e0-177">Se non viene trovato alcun film, `HttpNotFound` viene chiamato il metodo.</span><span class="sxs-lookup"><span data-stu-id="047e0-177">If no movie is found, the `HttpNotFound` method is called.</span></span>

<span data-ttu-id="047e0-178">Tutti i `HttpGet` metodi seguono un modello simile.</span><span class="sxs-lookup"><span data-stu-id="047e0-178">All the `HttpGet` methods follow a similar pattern.</span></span> <span data-ttu-id="047e0-179">Ottengono un oggetto Movie (o un elenco di oggetti nel caso di `Index` ) e passano il modello alla visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="047e0-179">They get a movie object (or list of objects, in the case of `Index`), and pass the model to the view.</span></span> <span data-ttu-id="047e0-180">Il `Create` metodo passa un oggetto Movie vuoto alla visualizzazione create.</span><span class="sxs-lookup"><span data-stu-id="047e0-180">The `Create` method passes an empty movie object to the Create view.</span></span> <span data-ttu-id="047e0-181">Tutti i metodi che creano, modificano, eliminano o cambiano in altro modo i dati, eseguono questa operazione nell'overload `HttpPost` del metodo.</span><span class="sxs-lookup"><span data-stu-id="047e0-181">All the methods that create, edit, delete, or otherwise modify data do so in the `HttpPost` overload of the method.</span></span> <span data-ttu-id="047e0-182">La modifica dei dati in un metodo HTTP GET costituisce un rischio per la sicurezza, come descritto nel post di Blog relativo all'introduzione a [ASP.NET MVC Tip #46 – non usare i collegamenti Delete perché creano buchi di sicurezza](http://stephenwalther.com/blog/archive/2009/01/21/asp.net-mvc-tip-46-ndash-donrsquot-use-delete-links-because.aspx).</span><span class="sxs-lookup"><span data-stu-id="047e0-182">Modifying data in an HTTP GET method is a security risk, as described in the blog post entry [ASP.NET MVC Tip #46 – Don't use Delete Links because they create Security Holes](http://stephenwalther.com/blog/archive/2009/01/21/asp.net-mvc-tip-46-ndash-donrsquot-use-delete-links-because.aspx).</span></span> <span data-ttu-id="047e0-183">La modifica dei dati in un metodo GET viola anche le procedure consigliate HTTP e il modello REST architetturale, che specifica che le richieste GET non devono modificare lo stato dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="047e0-183">Modifying data in a GET method also violates HTTP best practices and the architectural REST pattern, which specifies that GET requests should not change the state of your application.</span></span> <span data-ttu-id="047e0-184">In altre parole, l'esecuzione di un'operazione GET deve essere un'operazione sicura senza effetti collaterali.</span><span class="sxs-lookup"><span data-stu-id="047e0-184">In other words, performing a GET operation should be a safe operation that has no side effects.</span></span>

## <a name="adding-a-search-method-and-search-view"></a><span data-ttu-id="047e0-185">Aggiunta di un metodo di ricerca e di una visualizzazione di ricerca</span><span class="sxs-lookup"><span data-stu-id="047e0-185">Adding a Search Method and Search View</span></span>

<span data-ttu-id="047e0-186">In questa sezione si aggiungerà un `SearchIndex` metodo di azione che consente di cercare i film in base al genere o al nome.</span><span class="sxs-lookup"><span data-stu-id="047e0-186">In this section you'll add a `SearchIndex` action method that lets you search movies by genre or name.</span></span> <span data-ttu-id="047e0-187">Questa operazione sarà disponibile usando l'URL */Movies/SearchIndex* .</span><span class="sxs-lookup"><span data-stu-id="047e0-187">This will be available using the */Movies/SearchIndex* URL.</span></span> <span data-ttu-id="047e0-188">Nella richiesta viene visualizzato un form HTML che contiene gli elementi di input che un utente può compilare per cercare un film.</span><span class="sxs-lookup"><span data-stu-id="047e0-188">The request will display an HTML form that contains input elements that a user can fill in in order to search for a movie.</span></span> <span data-ttu-id="047e0-189">Quando un utente invia il modulo, il metodo di azione otterrà i valori di ricerca inviati dall'utente e utilizzerà i valori per eseguire ricerche nel database.</span><span class="sxs-lookup"><span data-stu-id="047e0-189">When a user submits the form, the action method will get the search values posted by the user and use the values to search the database.</span></span>

## <a name="displaying-the-searchindex-form"></a><span data-ttu-id="047e0-190">Visualizzazione del modulo SearchIndex</span><span class="sxs-lookup"><span data-stu-id="047e0-190">Displaying the SearchIndex Form</span></span>

<span data-ttu-id="047e0-191">Per iniziare, aggiungere un `SearchIndex` metodo di azione alla `MoviesController` classe esistente.</span><span class="sxs-lookup"><span data-stu-id="047e0-191">Start by adding a `SearchIndex` action method to the existing `MoviesController` class.</span></span> <span data-ttu-id="047e0-192">Il metodo restituirà una visualizzazione contenente un form HTML.</span><span class="sxs-lookup"><span data-stu-id="047e0-192">The method will return a view that contains an HTML form.</span></span> <span data-ttu-id="047e0-193">Ecco il codice:</span><span class="sxs-lookup"><span data-stu-id="047e0-193">Here's the code:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample7.cs)]

<span data-ttu-id="047e0-194">La prima riga del `SearchIndex` metodo crea la seguente query [LINQ](https://msdn.microsoft.com/library/bb397926.aspx) per selezionare i film:</span><span class="sxs-lookup"><span data-stu-id="047e0-194">The first line of the `SearchIndex` method creates the following [LINQ](https://msdn.microsoft.com/library/bb397926.aspx) query to select the movies:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample8.cs)]

<span data-ttu-id="047e0-195">La query è definita a questo punto, ma non è ancora stata eseguita sull'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="047e0-195">The query is defined at this point, but hasn't yet been run against the data store.</span></span>

<span data-ttu-id="047e0-196">Se il `searchString` parametro contiene una stringa, la query Movies viene modificata per filtrare in base al valore della stringa di ricerca, usando il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="047e0-196">If the `searchString` parameter contains a string, the movies query is modified to filter on the value of the search string, using the following code:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample9.cs)]

<span data-ttu-id="047e0-197">Le query LINQ non vengono eseguite quando vengono definite o quando vengono modificate chiamando un metodo come `Where` o `OrderBy` .</span><span class="sxs-lookup"><span data-stu-id="047e0-197">LINQ queries are not executed when they are defined or when they are modified by calling a method such as `Where` or `OrderBy`.</span></span> <span data-ttu-id="047e0-198">Al contrario, l'esecuzione della query viene posticipata, il che significa che la valutazione di un'espressione viene posticipata finché il relativo valore realizzato non viene effettivamente iterato o [`ToList`](https://msdn.microsoft.com/library/bb342261.aspx) viene chiamato il metodo.</span><span class="sxs-lookup"><span data-stu-id="047e0-198">Instead, query execution is deferred, which means that the evaluation of an expression is delayed until its realized value is actually iterated over or the [`ToList`](https://msdn.microsoft.com/library/bb342261.aspx) method is called.</span></span> <span data-ttu-id="047e0-199">Nell' `SearchIndex` esempio, la query viene eseguita nella vista SearchIndex.</span><span class="sxs-lookup"><span data-stu-id="047e0-199">In the `SearchIndex` sample, the query is executed in the SearchIndex view.</span></span> <span data-ttu-id="047e0-200">Per altre informazioni sull'esecuzione posticipata di query, vedere [Esecuzione di query](https://msdn.microsoft.com/library/bb738633.aspx).</span><span class="sxs-lookup"><span data-stu-id="047e0-200">For more information about deferred query execution, see [Query Execution](https://msdn.microsoft.com/library/bb738633.aspx).</span></span>

<span data-ttu-id="047e0-201">A questo punto è possibile implementare la `SearchIndex` visualizzazione che visualizzerà il modulo all'utente.</span><span class="sxs-lookup"><span data-stu-id="047e0-201">Now you can implement the `SearchIndex` view that will display the form to the user.</span></span> <span data-ttu-id="047e0-202">Fare clic con il pulsante destro del mouse all'interno del `SearchIndex` metodo, quindi scegliere **Aggiungi visualizzazione**.</span><span class="sxs-lookup"><span data-stu-id="047e0-202">Right-click inside the `SearchIndex` method and then click **Add View**.</span></span> <span data-ttu-id="047e0-203">Nella finestra di dialogo **Aggiungi visualizzazione** specificare che si intende passare un `Movie` oggetto al modello di visualizzazione come classe del modello.</span><span class="sxs-lookup"><span data-stu-id="047e0-203">In the **Add View** dialog box, specify that you're going to pass a `Movie` object to the view template as its model class.</span></span> <span data-ttu-id="047e0-204">Nell'elenco **modello di impalcatura** scegliere **elenco**, quindi fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="047e0-204">In the **Scaffold template** list, choose **List**, then click **Add**.</span></span>

<span data-ttu-id="047e0-205">[![AddSearchView](examining-the-edit-methods-and-edit-view/_static/image12.png)](examining-the-edit-methods-and-edit-view/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-205">[![AddSearchView](examining-the-edit-methods-and-edit-view/_static/image12.png)](examining-the-edit-methods-and-edit-view/_static/image11.png)</span></span>

<span data-ttu-id="047e0-206">Quando si fa clic sul pulsante **Aggiungi** , viene creato il modello di visualizzazione *Views\Movies\SearchIndex.cshtml* .</span><span class="sxs-lookup"><span data-stu-id="047e0-206">When you click the **Add** button, the *Views\Movies\SearchIndex.cshtml* view template is created.</span></span> <span data-ttu-id="047e0-207">Poiché **l'elenco è stato selezionato nell'** elenco dei modelli di **impalcatura** , Visual Web Developer genera automaticamente (con impalcatura) alcuni contenuti predefiniti nella visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="047e0-207">Because you selected **List** in the **Scaffold template** list, Visual Web Developer automatically generated (scaffolded) some default content in the view.</span></span> <span data-ttu-id="047e0-208">L'impalcatura ha creato un form HTML.</span><span class="sxs-lookup"><span data-stu-id="047e0-208">The scaffolding created an HTML form.</span></span> <span data-ttu-id="047e0-209">Ha esaminato la `Movie` classe e creato il codice per eseguire il rendering `<label>` degli elementi per ogni proprietà della classe.</span><span class="sxs-lookup"><span data-stu-id="047e0-209">It examined the `Movie` class and created code to render `<label>` elements for each property of the class.</span></span> <span data-ttu-id="047e0-210">Nell'elenco seguente viene illustrata la creazione della vista generata:</span><span class="sxs-lookup"><span data-stu-id="047e0-210">The listing below shows the Create view that was generated:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample10.cshtml)]

<span data-ttu-id="047e0-211">Eseguire l'applicazione e passare a */Movies/SearchIndex*.</span><span class="sxs-lookup"><span data-stu-id="047e0-211">Run the application and navigate to */Movies/SearchIndex*.</span></span> <span data-ttu-id="047e0-212">Accodare una stringa di query, ad esempio `?searchString=ghost`, all'URL.</span><span class="sxs-lookup"><span data-stu-id="047e0-212">Append a query string such as `?searchString=ghost` to the URL.</span></span> <span data-ttu-id="047e0-213">Vengono visualizzati i film filtrati.</span><span class="sxs-lookup"><span data-stu-id="047e0-213">The filtered movies are displayed.</span></span>

<span data-ttu-id="047e0-214">[![SearchQryStr](examining-the-edit-methods-and-edit-view/_static/image14.png)](examining-the-edit-methods-and-edit-view/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-214">[![SearchQryStr](examining-the-edit-methods-and-edit-view/_static/image14.png)](examining-the-edit-methods-and-edit-view/_static/image13.png)</span></span>

<span data-ttu-id="047e0-215">Se si modifica la firma del `SearchIndex` metodo in modo che disponga di un parametro denominato `id` , il `id` parametro corrisponderà al `{id}` segnaposto per le route predefinite impostate nel file *Global. asax* .</span><span class="sxs-lookup"><span data-stu-id="047e0-215">If you change the signature of the `SearchIndex` method to have a parameter named `id`, the `id` parameter will match the `{id}` placeholder for the default routes set in the *Global.asax* file.</span></span>

[!code-json[Main](examining-the-edit-methods-and-edit-view/samples/sample11.json)]

<span data-ttu-id="047e0-216">Il `SearchIndex` metodo modificato avrà un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="047e0-216">The modified `SearchIndex` method would look as follows:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample12.cs)]

<span data-ttu-id="047e0-217">È ora possibile passare il titolo della ricerca come dati di route (un segmento di URL), anziché come valore della stringa di query.</span><span class="sxs-lookup"><span data-stu-id="047e0-217">You can now pass the search title as route data (a URL segment) instead of as a query string value.</span></span>

<span data-ttu-id="047e0-218">[![SearchRouteData](examining-the-edit-methods-and-edit-view/_static/image16.png)](examining-the-edit-methods-and-edit-view/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-218">[![SearchRouteData](examining-the-edit-methods-and-edit-view/_static/image16.png)](examining-the-edit-methods-and-edit-view/_static/image15.png)</span></span>

<span data-ttu-id="047e0-219">Tuttavia, non è possibile supporre che gli utenti modifichino l'URL ogni volta che desiderano cercare un film.</span><span class="sxs-lookup"><span data-stu-id="047e0-219">However, you can't expect users to modify the URL every time they want to search for a movie.</span></span> <span data-ttu-id="047e0-220">A questo punto si aggiungerà un'interfaccia utente che consente di filtrare i film.</span><span class="sxs-lookup"><span data-stu-id="047e0-220">So now you you'll add UI to help them filter movies.</span></span> <span data-ttu-id="047e0-221">Se è stata modificata la firma del `SearchIndex` metodo per testare come passare il parametro ID associato alla route, modificarlo di nuovo in modo che il `SearchIndex` Metodo accetti un parametro di stringa denominato `searchString` :</span><span class="sxs-lookup"><span data-stu-id="047e0-221">If you changed the signature of the `SearchIndex` method to test how to pass the route-bound ID parameter, change it back so that your `SearchIndex` method takes a string parameter named `searchString`:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample13.cs)]

<span data-ttu-id="047e0-222">Aprire il file *Views\Movies\SearchIndex.cshtml* e, subito dopo `@Html.ActionLink("Create New", "Create")` , aggiungere quanto segue:</span><span class="sxs-lookup"><span data-stu-id="047e0-222">Open the *Views\Movies\SearchIndex.cshtml* file, and just after `@Html.ActionLink("Create New", "Create")`, add the following:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample14.cshtml)]

<span data-ttu-id="047e0-223">Nell'esempio seguente viene illustrata una parte del file *Views\Movies\SearchIndex.cshtml* con il markup di filtro aggiunto.</span><span class="sxs-lookup"><span data-stu-id="047e0-223">The following example shows a portion of the *Views\Movies\SearchIndex.cshtml* file with the added filtering markup.</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample15.cshtml)]

<span data-ttu-id="047e0-224">L' `Html.BeginForm` Helper crea un tag di apertura `<form>` .</span><span class="sxs-lookup"><span data-stu-id="047e0-224">The `Html.BeginForm` helper creates an opening `<form>` tag.</span></span> <span data-ttu-id="047e0-225">L' `Html.BeginForm` helper fa in modo che il form invii a se stesso quando l'utente invia il modulo facendo clic sul pulsante **filtro** .</span><span class="sxs-lookup"><span data-stu-id="047e0-225">The `Html.BeginForm` helper causes the form to post to itself when the user submits the form by clicking the **Filter** button.</span></span>

<span data-ttu-id="047e0-226">Eseguire l'applicazione e provare a cercare un film.</span><span class="sxs-lookup"><span data-stu-id="047e0-226">Run the application and try searching for a movie.</span></span>

<span data-ttu-id="047e0-227">[![SearchIndxIE9_title](examining-the-edit-methods-and-edit-view/_static/image18.png)](examining-the-edit-methods-and-edit-view/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-227">[![SearchIndxIE9_title](examining-the-edit-methods-and-edit-view/_static/image18.png)](examining-the-edit-methods-and-edit-view/_static/image17.png)</span></span>

<span data-ttu-id="047e0-228">Nessun `HttpPost` Overload del `SearchIndex` metodo.</span><span class="sxs-lookup"><span data-stu-id="047e0-228">There's no `HttpPost` overload of the `SearchIndex` method.</span></span> <span data-ttu-id="047e0-229">Non è necessario, perché il metodo non modifica lo stato dell'applicazione, limitando a filtrare i dati.</span><span class="sxs-lookup"><span data-stu-id="047e0-229">You don't need it, because the method isn't changing the state of the application, just filtering data.</span></span>

<span data-ttu-id="047e0-230">È possibile aggiungere il metodo `HttpPost SearchIndex` seguente.</span><span class="sxs-lookup"><span data-stu-id="047e0-230">You could add the following `HttpPost SearchIndex` method.</span></span> <span data-ttu-id="047e0-231">In tal caso, l'invoker dell'azione corrisponderebbe al `HttpPost SearchIndex` metodo e il `HttpPost SearchIndex` Metodo verrebbe eseguito come illustrato nell'immagine seguente.</span><span class="sxs-lookup"><span data-stu-id="047e0-231">In that case, the action invoker would match the `HttpPost SearchIndex` method, and the `HttpPost SearchIndex` method would run as shown in the image below.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample16.cs)]

<span data-ttu-id="047e0-232">[![SearchPostGhost](examining-the-edit-methods-and-edit-view/_static/image20.png)](examining-the-edit-methods-and-edit-view/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-232">[![SearchPostGhost](examining-the-edit-methods-and-edit-view/_static/image20.png)](examining-the-edit-methods-and-edit-view/_static/image19.png)</span></span>

<span data-ttu-id="047e0-233">Tuttavia, anche se si aggiunge questa versione `HttpPost` del metodo `SearchIndex`, esiste una limitazione sul modo sulla relativa implementazione.</span><span class="sxs-lookup"><span data-stu-id="047e0-233">However, even if you add this `HttpPost` version of the `SearchIndex` method, there's a limitation in how this has all been implemented.</span></span> <span data-ttu-id="047e0-234">Si supponga che si desideri usare come segnalibro una ricerca specifica o inviare un collegamento agli amici su cui possono fare clic per visualizzare lo stesso elenco filtrato di film.</span><span class="sxs-lookup"><span data-stu-id="047e0-234">Imagine that you want to bookmark a particular search or you want to send a link to friends that they can click in order to see the same filtered list of movies.</span></span> <span data-ttu-id="047e0-235">Si noti che l'URL per la richiesta HTTP POST è lo stesso dell'URL per la richiesta GET (localhost: xxxxx/Movies/SearchIndex), non sono presenti informazioni di ricerca nell'URL stesso.</span><span class="sxs-lookup"><span data-stu-id="047e0-235">Notice that the URL for the HTTP POST request is the same as the URL for the GET request (localhost:xxxxx/Movies/SearchIndex) -- there's no search information in the URL itself.</span></span> <span data-ttu-id="047e0-236">A questo punto, le informazioni sulla stringa di ricerca vengono inviate al server come valore del campo del modulo.</span><span class="sxs-lookup"><span data-stu-id="047e0-236">Right now, the search string information is sent to the server as a form field value.</span></span> <span data-ttu-id="047e0-237">Ciò significa che non è possibile acquisire le informazioni di ricerca nel segnalibro o inviarle agli amici in un URL.</span><span class="sxs-lookup"><span data-stu-id="047e0-237">This means you can't capture that search information to bookmark or send to friends in a URL.</span></span>

<span data-ttu-id="047e0-238">La soluzione consiste nell'usare un overload di `BeginForm` che specifichi che la richiesta post deve aggiungere le informazioni di ricerca all'URL e che devono essere indirizzate alla versione HttpGet del `SearchIndex` metodo.</span><span class="sxs-lookup"><span data-stu-id="047e0-238">The solution is to use an overload of `BeginForm` that specifies that the POST request should add the search information to the URL and that is should be routed to the HttpGet version of the `SearchIndex` method.</span></span> <span data-ttu-id="047e0-239">Sostituire il `BeginForm` metodo senza parametri esistente con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="047e0-239">Replace the existing parameterless `BeginForm` method with the following:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample17.cshtml)]

<span data-ttu-id="047e0-240">[![BeginFormPost_SM](examining-the-edit-methods-and-edit-view/_static/image22.png)](examining-the-edit-methods-and-edit-view/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-240">[![BeginFormPost_SM](examining-the-edit-methods-and-edit-view/_static/image22.png)](examining-the-edit-methods-and-edit-view/_static/image21.png)</span></span>

<span data-ttu-id="047e0-241">A questo punto, quando si invia una ricerca, l'URL contiene una stringa di query di ricerca.</span><span class="sxs-lookup"><span data-stu-id="047e0-241">Now when you submit a search, the URL contains a search query string.</span></span> <span data-ttu-id="047e0-242">La ricerca passerà anche al metodo di azione `HttpGet SearchIndex`, anche se si dispone di un metodo `HttpPost SearchIndex`.</span><span class="sxs-lookup"><span data-stu-id="047e0-242">Searching will also go to the `HttpGet SearchIndex` action method, even if you have a `HttpPost SearchIndex` method.</span></span>

<span data-ttu-id="047e0-243">[![SearchIndexWithGetURL](examining-the-edit-methods-and-edit-view/_static/image24.png)](examining-the-edit-methods-and-edit-view/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="047e0-243">[![SearchIndexWithGetURL](examining-the-edit-methods-and-edit-view/_static/image24.png)](examining-the-edit-methods-and-edit-view/_static/image23.png)</span></span>

## <a name="adding-search-by-genre"></a><span data-ttu-id="047e0-244">Aggiunta della ricerca per genere</span><span class="sxs-lookup"><span data-stu-id="047e0-244">Adding Search by Genre</span></span>

<span data-ttu-id="047e0-245">Se è stata aggiunta la `HttpPost` versione del `SearchIndex` metodo, eliminarla ora.</span><span class="sxs-lookup"><span data-stu-id="047e0-245">If you added the `HttpPost` version of the `SearchIndex` method, delete it now.</span></span>

<span data-ttu-id="047e0-246">Si aggiungerà quindi una funzionalità che consente agli utenti di cercare i film in base al genere.</span><span class="sxs-lookup"><span data-stu-id="047e0-246">Next, you'll add a feature to let users search for movies by genre.</span></span> <span data-ttu-id="047e0-247">Sostituire il metodo `SearchIndex` con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="047e0-247">Replace the `SearchIndex` method with the following code:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample18.cs)]

<span data-ttu-id="047e0-248">Questa versione del `SearchIndex` metodo accetta un parametro aggiuntivo, ovvero `movieGenre` .</span><span class="sxs-lookup"><span data-stu-id="047e0-248">This version of the `SearchIndex` method takes an additional parameter, namely `movieGenre`.</span></span> <span data-ttu-id="047e0-249">Le prime righe di codice creano un `List` oggetto per mantenere i generi di film dal database.</span><span class="sxs-lookup"><span data-stu-id="047e0-249">The first few lines of code create a `List` object to hold movie genres from the database.</span></span>

<span data-ttu-id="047e0-250">Il codice seguente è una query LINQ che recupera tutti i generi dal database.</span><span class="sxs-lookup"><span data-stu-id="047e0-250">The following code is a LINQ query that retrieves all the genres from the database.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample19.cs)]

<span data-ttu-id="047e0-251">Il codice usa il `AddRange` metodo della raccolta generica `List` per aggiungere tutti i generi distinti all'elenco.</span><span class="sxs-lookup"><span data-stu-id="047e0-251">The code uses the `AddRange` method of the generic `List` collection to add all the distinct genres to the list.</span></span> <span data-ttu-id="047e0-252">(Senza il `Distinct` modificatore, verranno aggiunti generi duplicati, ad esempio, la commedia verrebbe aggiunta due volte nell'esempio).</span><span class="sxs-lookup"><span data-stu-id="047e0-252">(Without the `Distinct` modifier, duplicate genres would be added — for example, comedy would be added twice in our sample).</span></span> <span data-ttu-id="047e0-253">Il codice archivia quindi l'elenco dei generi nell' `ViewBag` oggetto.</span><span class="sxs-lookup"><span data-stu-id="047e0-253">The code then stores the list of genres in the `ViewBag` object.</span></span>

<span data-ttu-id="047e0-254">Il codice seguente illustra come controllare il `movieGenre` parametro.</span><span class="sxs-lookup"><span data-stu-id="047e0-254">The following code shows how to check the `movieGenre` parameter.</span></span> <span data-ttu-id="047e0-255">Se non è vuoto, il codice vincola ulteriormente la query dei film per limitare i film selezionati al genere specificato.</span><span class="sxs-lookup"><span data-stu-id="047e0-255">If it's not empty the code further constrains the movies query to limit the selected movies to the specified genre.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample20.cs)]

## <a name="adding-markup-to-the-searchindex-view-to-support-search-by-genre"></a><span data-ttu-id="047e0-256">Aggiunta di markup alla visualizzazione SearchIndex per supportare la ricerca per genere</span><span class="sxs-lookup"><span data-stu-id="047e0-256">Adding Markup to the SearchIndex View to Support Search by Genre</span></span>

<span data-ttu-id="047e0-257">Aggiungere un `Html.DropDownList` helper al file *Views\Movies\SearchIndex.cshtml* , immediatamente prima dell' `TextBox` Helper.</span><span class="sxs-lookup"><span data-stu-id="047e0-257">Add an `Html.DropDownList` helper to the *Views\Movies\SearchIndex.cshtml* file, just before the `TextBox` helper.</span></span> <span data-ttu-id="047e0-258">Il markup completato è illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="047e0-258">The completed markup is shown below:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample21.cshtml)]

<span data-ttu-id="047e0-259">Eseguire l'applicazione e passare a */Movies/SearchIndex*.</span><span class="sxs-lookup"><span data-stu-id="047e0-259">Run the application and browse to */Movies/SearchIndex*.</span></span> <span data-ttu-id="047e0-260">Provare a eseguire una ricerca in base al genere, al nome del film e a entrambi i criteri.</span><span class="sxs-lookup"><span data-stu-id="047e0-260">Try a search by genre, by movie name, and by both criteria.</span></span>

<span data-ttu-id="047e0-261">In questa sezione sono stati esaminati i metodi di azione CRUD e le visualizzazioni generate dal Framework.</span><span class="sxs-lookup"><span data-stu-id="047e0-261">In this section you examined the CRUD action methods and views generated by the framework.</span></span> <span data-ttu-id="047e0-262">Sono stati creati un metodo e una visualizzazione di azione di ricerca che consentono agli utenti di eseguire ricerche in base al titolo e al genere.</span><span class="sxs-lookup"><span data-stu-id="047e0-262">You created a search action method and view that let users search by movie title and genre.</span></span> <span data-ttu-id="047e0-263">Nella sezione successiva verrà illustrato come aggiungere una proprietà al `Movie` modello e come aggiungere un inizializzatore che creerà automaticamente un database di prova.</span><span class="sxs-lookup"><span data-stu-id="047e0-263">In the next section, you'll look at how to add a property to the `Movie` model and how to add an initializer that will automatically create a test database.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="047e0-264">[Precedente](accessing-your-models-data-from-a-controller.md) 
>  [Avanti](adding-a-new-field.md)</span><span class="sxs-lookup"><span data-stu-id="047e0-264">[Previous](accessing-your-models-data-from-a-controller.md)
[Next](adding-a-new-field.md)</span></span>
