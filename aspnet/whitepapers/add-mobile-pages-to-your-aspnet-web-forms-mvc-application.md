---
uid: whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
title: "Procedura: aggiungere pagine per dispositivi mobili all'applicazione Web Form/MVC ASP.NET | Microsoft Docs"
author: rick-anderson
description: In questa procedura vengono descritti i vari modi per gestire le pagine ottimizzate per i dispositivi mobili dall'applicazione Web Form/MVC ASP.NET e vengono suggerite l'architettura e...
ms.author: riande
ms.date: 01/20/2011
ms.assetid: 3124f28e-cc32-418a-afe3-519fa56f4c36
msc.legacyurl: /whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
msc.type: content
ms.openlocfilehash: 63c555358d06a9506bb5c8c993800c3307108192
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78572737"
---
# <a name="how-to-add-mobile-pages-to-your-aspnet-web-forms--mvc-application"></a><span data-ttu-id="6988a-103">Procedura: aggiungere pagine per dispositivi mobili all'applicazione Web Form/MVC ASP.NET</span><span class="sxs-lookup"><span data-stu-id="6988a-103">How To: Add Mobile Pages to Your ASP.NET Web Forms / MVC Application</span></span>

> <span data-ttu-id="6988a-104">**Si applica a**</span><span class="sxs-lookup"><span data-stu-id="6988a-104">**Applies To**</span></span>
> 
> - <span data-ttu-id="6988a-105">ASP.NET Web Forms versione 4,0</span><span class="sxs-lookup"><span data-stu-id="6988a-105">ASP.NET Web Forms version 4.0</span></span>
> - <span data-ttu-id="6988a-106">ASP.NET MVC versione 3,0</span><span class="sxs-lookup"><span data-stu-id="6988a-106">ASP.NET MVC version 3.0</span></span>
> 
> <span data-ttu-id="6988a-107">**Riepilogo**</span><span class="sxs-lookup"><span data-stu-id="6988a-107">**Summary**</span></span>
> 
> <span data-ttu-id="6988a-108">In questa procedura vengono descritti i vari modi per gestire le pagine ottimizzate per i dispositivi mobili dall'applicazione Web Form/MVC ASP.NET e vengono suggeriti i problemi di architettura e progettazione da considerare quando si fa riferimento a una vasta gamma di dispositivi.</span><span class="sxs-lookup"><span data-stu-id="6988a-108">This How To describes various ways to serve pages optimized for mobile devices from your ASP.NET Web Forms / MVC application, and suggests architectural and design issues to consider when targeting a broad range of devices.</span></span> <span data-ttu-id="6988a-109">Questo documento spiega anche il motivo per cui i controlli mobili ASP.NET da ASP.NET 2,0 a 3,5 sono ora obsoleti e illustra alcune alternative moderne.</span><span class="sxs-lookup"><span data-stu-id="6988a-109">This document also explains why the ASP.NET Mobile Controls from ASP.NET 2.0 to 3.5 are now obsolete, and discusses some modern alternatives.</span></span>

## <a name="contents"></a><span data-ttu-id="6988a-110">Contenuto</span><span class="sxs-lookup"><span data-stu-id="6988a-110">Contents</span></span>

- <span data-ttu-id="6988a-111">Panoramica</span><span class="sxs-lookup"><span data-stu-id="6988a-111">Overview</span></span>
- <span data-ttu-id="6988a-112">Opzioni architetturali</span><span class="sxs-lookup"><span data-stu-id="6988a-112">Architectural options</span></span>
- <span data-ttu-id="6988a-113">Rilevamento di dispositivi e browser</span><span class="sxs-lookup"><span data-stu-id="6988a-113">Browser and device detection</span></span>
- <span data-ttu-id="6988a-114">Come le applicazioni Web Form ASP.NET possono presentare pagine specifiche per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-114">How ASP.NET Web Forms applications can present mobile-specific pages</span></span>
- <span data-ttu-id="6988a-115">Come le applicazioni MVC ASP.NET possono presentare pagine specifiche per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-115">How ASP.NET MVC applications can present mobile-specific pages</span></span>
- <span data-ttu-id="6988a-116">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="6988a-116">Additional resources</span></span>

<span data-ttu-id="6988a-117">Per esempi di codice scaricabili che dimostrano le tecniche di questo white paper per ASP.NET Web Form e MVC, vedere [app per dispositivi mobili & siti con ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="6988a-117">For downloadable code samples demonstrating this white paper's techniques for both ASP.NET Web Forms and MVC, see [Mobile Apps & Sites with ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span></span>

## <a name="overview"></a><span data-ttu-id="6988a-118">Panoramica</span><span class="sxs-lookup"><span data-stu-id="6988a-118">Overview</span></span>

<span data-ttu-id="6988a-119">Dispositivi mobili: smartphone, telefoni di funzionalità e Tablet: continuano a crescere in popolarità come mezzo per accedere al Web.</span><span class="sxs-lookup"><span data-stu-id="6988a-119">Mobile devices – smartphones, feature phones, and tablets – continue to grow in popularity as a means to access the Web.</span></span> <span data-ttu-id="6988a-120">Per molti sviluppatori Web e aziende orientate al Web, questo significa che è sempre più importante fornire un'esperienza di esplorazione ottimale per i visitatori che usano tali dispositivi.</span><span class="sxs-lookup"><span data-stu-id="6988a-120">For many web developers and web-oriented businesses, this means it's increasingly important to provide a great browsing experience for visitors using those devices.</span></span>

### <a name="how-earlier-versions-of-aspnet-supported-mobile-browsers"></a><span data-ttu-id="6988a-121">Come le versioni precedenti di ASP.NET supportavano i browser per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-121">How earlier versions of ASP.NET supported mobile browsers</span></span>

<span data-ttu-id="6988a-122">ASP.NET versioni da 2,0 a 3,5 includono i controlli per dispositivi *mobili di ASP.NET*: un set di controlli server per i dispositivi mobili nell'assembly *System. Web. mobile. dll* e lo spazio dei nomi *System. Web. UI. MobileControls* .</span><span class="sxs-lookup"><span data-stu-id="6988a-122">ASP.NET versions 2.0 to 3.5 included *ASP.NET Mobile Controls*: a set of server controls for mobile devices in the *System.Web.Mobile.dll* assembly and the *System.Web.UI.MobileControls* namespace.</span></span> <span data-ttu-id="6988a-123">L'assembly è ancora incluso in ASP.NET 4, ma è deprecato.</span><span class="sxs-lookup"><span data-stu-id="6988a-123">The assembly is still included in ASP.NET 4, but it is deprecated.</span></span> <span data-ttu-id="6988a-124">Gli sviluppatori sono invitati a eseguire la migrazione a approcci più moderni, ad esempio quelli descritti in questo documento.</span><span class="sxs-lookup"><span data-stu-id="6988a-124">Developers are advised to migrate to more modern approaches, such as those described in this paper.</span></span>

<span data-ttu-id="6988a-125">Il motivo per cui i controlli mobili ASP.NET sono stati contrassegnati come obsoleti è il fatto che la loro progettazione è orientata intorno ai telefoni cellulari comuni intorno a 2005 e versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="6988a-125">The reason why ASP.NET Mobile Controls have been marked as obsolete is that their design is oriented around the mobile phones that were common around 2005 and earlier.</span></span> <span data-ttu-id="6988a-126">I controlli sono progettati principalmente per eseguire il rendering del markup WML o cHTML (anziché HTML normale) per i browser WAP di quell'era.</span><span class="sxs-lookup"><span data-stu-id="6988a-126">The controls are mainly designed to render WML or cHTML markup (instead of regular HTML) for the WAP browsers of that era.</span></span> <span data-ttu-id="6988a-127">Tuttavia, WAP, WML e cHTML non sono più rilevanti per la maggior parte dei progetti, perché il codice HTML ora è diventato il linguaggio di markup universale per browser per dispositivi mobili e desktop.</span><span class="sxs-lookup"><span data-stu-id="6988a-127">But WAP, WML, and cHTML are no longer relevant for most projects, because HTML has now become the ubiquitous markup language for mobile and desktop browsers alike.</span></span>

### <a name="the-challenges-of-supporting-mobile-devices-today"></a><span data-ttu-id="6988a-128">Problemi di supporto attuale dei dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-128">The challenges of supporting mobile devices today</span></span>

<span data-ttu-id="6988a-129">Anche se i browser per dispositivi mobili ora supportano in modo quasi universale il codice HTML, si affronteranno molti problemi quando si mira a creare esperienze di esplorazione per dispositivi mobili eccezionali:</span><span class="sxs-lookup"><span data-stu-id="6988a-129">Even though mobile browsers now almost universally support HTML, you will still face many challenges when aiming to create great mobile browsing experiences:</span></span>

- <span data-ttu-id="6988a-130">***Dimensioni schermo*** : i dispositivi mobili variano notevolmente in forma e le schermate sono spesso molto più piccole dei monitor desktop.</span><span class="sxs-lookup"><span data-stu-id="6988a-130">***Screen size*** - Mobile devices vary dramatically in form, and their screens are often much smaller than desktop monitors.</span></span> <span data-ttu-id="6988a-131">Quindi, potrebbe essere necessario progettare layout di pagine completamente differenti.</span><span class="sxs-lookup"><span data-stu-id="6988a-131">So, you may need to design completely different page layouts for them.</span></span>
- <span data-ttu-id="6988a-132">***Metodi di input*** : alcuni dispositivi hanno tasti di tastiera, alcuni con stilo, altri usano il tocco.</span><span class="sxs-lookup"><span data-stu-id="6988a-132">***Input methods*** – Some devices have keypads, some have styluses, others use touch.</span></span> <span data-ttu-id="6988a-133">Potrebbe essere necessario prendere in considerazione più meccanismi di esplorazione e metodi di input dei dati.</span><span class="sxs-lookup"><span data-stu-id="6988a-133">You may need to consider multiple navigation mechanisms and data input methods.</span></span>
- <span data-ttu-id="6988a-134">***Conformità agli standard*** : molti browser per dispositivi mobili non supportano gli standard HTML, CSS o JavaScript più recenti.</span><span class="sxs-lookup"><span data-stu-id="6988a-134">***Standards compliance*** – Many mobile browsers do not support the latest HTML, CSS, or JavaScript standards.</span></span>
- <span data-ttu-id="6988a-135">***Larghezza di banda*** : le prestazioni della rete di dati cellulari variano notevolmente e alcuni utenti finali sono basati sulle tariffe addebitate dal megabyte.</span><span class="sxs-lookup"><span data-stu-id="6988a-135">***Bandwidth*** – Cellular data network performance varies wildly, and some end users are on tariffs that charge by the megabyte.</span></span>

<span data-ttu-id="6988a-136">Non esiste una soluzione unica per tutte le dimensioni. l'applicazione dovrà avere un aspetto e un comportamento diverso in base al dispositivo che vi accede.</span><span class="sxs-lookup"><span data-stu-id="6988a-136">There's no one-size-fits-all solution; your application will have to look and behave differently according to the device accessing it.</span></span> <span data-ttu-id="6988a-137">A seconda del livello di supporto mobile desiderato, può trattarsi di una sfida più grande per gli sviluppatori Web rispetto al desktop "Wars".</span><span class="sxs-lookup"><span data-stu-id="6988a-137">Depending on what level of mobile support you want, this can be a bigger challenge for web developers than the desktop "browser wars" ever was.</span></span>

<span data-ttu-id="6988a-138">Gli sviluppatori che si avvicinano al supporto del browser per dispositivi mobili per la prima volta spesso pensano che sia importante supportare gli smartphone più recenti e più sofisticati (ad esempio, Windows Phone 7, iPhone o Android), probabilmente perché gli sviluppatori spesso hanno personalmente tale dispositivi.</span><span class="sxs-lookup"><span data-stu-id="6988a-138">Developers approaching mobile browser support for the first time often initially think it's only important to support the latest and most sophisticated smartphones (e.g., Windows Phone 7, iPhone, or Android), perhaps because developers often personally own such devices.</span></span> <span data-ttu-id="6988a-139">Tuttavia, i telefoni più economici sono ancora molto diffusi e i loro proprietari li usano per esplorare il Web, soprattutto nei paesi in cui i telefoni cellulari sono più facili da ottenere rispetto a una connessione a banda larga.</span><span class="sxs-lookup"><span data-stu-id="6988a-139">However, cheaper phones are still extremely popular, and their owners do use them to browse the web – especially in countries where mobile phones are easier to get than a broadband connection.</span></span> <span data-ttu-id="6988a-140">L'azienda dovrà decidere quale gamma di dispositivi supportare, considerando i clienti probabili.</span><span class="sxs-lookup"><span data-stu-id="6988a-140">Your business will need to decide what range of devices to support by considering its likely customers.</span></span> <span data-ttu-id="6988a-141">Se si sta creando una brochure online per un Health Spa di lusso, è possibile prendere una decisione aziendale solo per gli smartphone avanzati, mentre se si crea un sistema di prenotazione ticket per un cinema, è probabile che sia necessario tenere conto dei visitatori con funzionalità meno potenti telefoni.</span><span class="sxs-lookup"><span data-stu-id="6988a-141">If you're building an online brochure for a luxury health spa, you might make a business decision only to target advanced smartphones, whereas if you're creating a ticket booking system for a cinema, you probably need to account for visitors with less powerful feature phones.</span></span>

## <a name="architectural-options"></a><span data-ttu-id="6988a-142">Opzioni architetturali</span><span class="sxs-lookup"><span data-stu-id="6988a-142">Architectural options</span></span>

<span data-ttu-id="6988a-143">Prima di ottenere i dettagli tecnici specifici di ASP.NET Web Forms o MVC, tenere presente che gli sviluppatori Web in generale hanno tre possibili opzioni principali per il supporto dei browser per dispositivi mobili:</span><span class="sxs-lookup"><span data-stu-id="6988a-143">Before we get to the specific technical details of ASP.NET Web Forms or MVC, note that web developers in general have three main possible options for supporting mobile browsers:</span></span>

1. <span data-ttu-id="6988a-144">***Non eseguire alcuna operazione:*** È possibile creare semplicemente un'applicazione Web standard e orientata al desktop e utilizzare browser per dispositivi mobili per eseguirne il rendering in modo accettabile.</span><span class="sxs-lookup"><span data-stu-id="6988a-144">***Do nothing –*** You can simply create a standard, desktop-oriented web application, and rely on mobile browsers to render it acceptably.</span></span> 

    - <span data-ttu-id="6988a-145">**Vantaggio**: è l'opzione più conveniente da implementare e gestire, senza lavoro aggiuntivo</span><span class="sxs-lookup"><span data-stu-id="6988a-145">**Advantage**: It's the cheapest option to implement and maintain – no extra work</span></span>
    - <span data-ttu-id="6988a-146">**Svantaggio**: offre la peggior esperienza dell'utente finale:</span><span class="sxs-lookup"><span data-stu-id="6988a-146">**Disadvantage**: Gives the worst end-user experience:</span></span> 

        - <span data-ttu-id="6988a-147">Gli smartphone più recenti possono eseguire il rendering del codice HTML così come un browser desktop, ma gli utenti verranno comunque costretti a eseguire lo zoom e lo scorrimento orizzontalmente e verticalmente per utilizzare il contenuto in uno schermo di piccole dimensioni.</span><span class="sxs-lookup"><span data-stu-id="6988a-147">The latest smartphones may render your HTML just as well as a desktop browser, but users will still be forced to zoom and scroll horizontally and vertically to consume your content on a small screen.</span></span> <span data-ttu-id="6988a-148">Si tratta di un'operazione molto più ottimale.</span><span class="sxs-lookup"><span data-stu-id="6988a-148">This is far from optimal.</span></span>
        - <span data-ttu-id="6988a-149">I dispositivi e i telefoni delle funzionalità meno recenti potrebbero non riuscire a eseguire il rendering del markup in modo soddisfacente.</span><span class="sxs-lookup"><span data-stu-id="6988a-149">Older devices and feature phones may fail to render your markup in a satisfactory way.</span></span>
        - <span data-ttu-id="6988a-150">Anche nei dispositivi tablet più recenti, le cui schermate possono essere di grandi dimensioni come gli schermi portatili, si applicano diverse regole di interazione.</span><span class="sxs-lookup"><span data-stu-id="6988a-150">Even on the latest tablet devices (whose screens can be as big as laptop screens), different interaction rules apply.</span></span> <span data-ttu-id="6988a-151">L'input basato sul tocco funziona meglio con i pulsanti e i collegamenti più ampi e non è possibile passare il puntatore del mouse su un menu a comparsa.</span><span class="sxs-lookup"><span data-stu-id="6988a-151">Touch-based input works best with larger buttons and links spread further apart, and there's no way to hover a mouse cursor over a fly-out menu.</span></span>
2. <span data-ttu-id="6988a-152">***Risolvere il problema nel client* :** con un utilizzo accurato di CSS e [miglioramento progressivo](http://en.wikipedia.org/wiki/Progressive_enhancement) è possibile creare markup, stili e script che si adattano a qualsiasi browser che li esegue.</span><span class="sxs-lookup"><span data-stu-id="6988a-152">***Solve the problem on the client* –** With careful use of CSS and [progressive enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement) you can create markup, styles, and scripts that adapt to whatever browser is running them.</span></span> <span data-ttu-id="6988a-153">Con le [query supporti CSS 3](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), ad esempio, è possibile creare un layout a più colonne che si converte in un layout a colonna singola sui dispositivi le cui schermate sono più strette rispetto alla soglia selezionata.</span><span class="sxs-lookup"><span data-stu-id="6988a-153">For example, with [CSS 3 media queries](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), you could create a multi-column layout that turns into a single column layout on devices whose screens are narrower than a chosen threshold.</span></span> 

    - <span data-ttu-id="6988a-154">**Vantaggio**: ottimizza il rendering per il dispositivo specifico in uso, anche per i dispositivi futuri sconosciuti in base a qualsiasi caratteristica dello schermo e di input</span><span class="sxs-lookup"><span data-stu-id="6988a-154">**Advantage**: Optimizes rendering for the specific device in use, even for unknown future devices according to whatever screen and input characteristics they have</span></span>
    - <span data-ttu-id="6988a-155">**Vantaggio**: consente di condividere con facilità la logica sul lato server in tutti i tipi di dispositivi, ovvero la duplicazione minima del codice o il lavoro richiesto</span><span class="sxs-lookup"><span data-stu-id="6988a-155">**Advantage**: Easily lets you share server-side logic across all device types – minimal duplication of code or effort</span></span>
    - <span data-ttu-id="6988a-156">**Svantaggio**: i dispositivi mobili sono talmente diversi dai dispositivi desktop che è possibile che le pagine mobili siano completamente diverse dalle pagine desktop, mostrando informazioni diverse.</span><span class="sxs-lookup"><span data-stu-id="6988a-156">**Disadvantage**: Mobile devices are so different from desktop devices that you may really want your mobile pages to be completely different from your desktop pages, showing different information.</span></span> <span data-ttu-id="6988a-157">Tali variazioni possono risultare inefficienti o impossibili da ottenere in modo affidabile tramite il solo CSS, in particolare considerando il modo in cui i dispositivi meno recenti interpretano le regole CSS.</span><span class="sxs-lookup"><span data-stu-id="6988a-157">Such variations can be inefficient or impossible to achieve robustly through CSS alone, especially considering how inconsistently older devices interpret CSS rules.</span></span> <span data-ttu-id="6988a-158">Questa operazione è particolarmente valida per gli attributi CSS 3.</span><span class="sxs-lookup"><span data-stu-id="6988a-158">This is particularly true of CSS 3 attributes.</span></span>
    - <span data-ttu-id="6988a-159">**Svantaggio**: non fornisce alcun supporto per la variazione della logica sul lato server e dei flussi di lavoro per dispositivi diversi.</span><span class="sxs-lookup"><span data-stu-id="6988a-159">**Disadvantage**: Provides no support for varying server-side logic and workflows for different devices.</span></span> <span data-ttu-id="6988a-160">Non è possibile, ad esempio, implementare un flusso di lavoro di estrazione del carrello acquisti semplificato per gli utenti mobili per mezzo di un solo CSS.</span><span class="sxs-lookup"><span data-stu-id="6988a-160">You can't, for example, implement a simplified shopping cart checkout workflow for mobile users by means of CSS alone.</span></span>
    - <span data-ttu-id="6988a-161">**Svantaggio**: uso inefficiente della larghezza di banda.</span><span class="sxs-lookup"><span data-stu-id="6988a-161">**Disadvantage**: Inefficient bandwidth use.</span></span> <span data-ttu-id="6988a-162">È possibile che il server debba trasmettere il markup e gli stili applicabili a tutti i dispositivi possibili, anche se il dispositivo di destinazione userà solo un subset di tali informazioni.</span><span class="sxs-lookup"><span data-stu-id="6988a-162">You server may have to transmit the markup and styles that apply to all possible devices, even though the target device will only use a subset of that information.</span></span>
3. <span data-ttu-id="6988a-163">***Risolvere il problema nel server* :** Se il server è in grado di accedere al dispositivo o almeno alle caratteristiche del dispositivo, ad esempio le dimensioni dello schermo e il metodo di input, e se si tratta di un dispositivo mobile, può eseguire logica diversa e restituire un markup HTML diverso.</span><span class="sxs-lookup"><span data-stu-id="6988a-163">***Solve the problem on the server* –** If your server knows what device is accessing it – or at least the characteristics of that device, such as its screen size and input method, and whether it's a mobile device – it can run different logic and output different HTML markup.</span></span> 

    - <span data-ttu-id="6988a-164">**Vantaggi:** Massima flessibilità.</span><span class="sxs-lookup"><span data-stu-id="6988a-164">**Advantage:** Maximum flexibility.</span></span> <span data-ttu-id="6988a-165">Non esiste alcun limite a quanto è possibile variare la logica lato server per i dispositivi mobili o ottimizzare il markup per il layout desiderato, specifico del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6988a-165">There's no limit to how much you can vary your server-side logic for mobiles or optimize your markup for the desired, device-specific layout.</span></span>
    - <span data-ttu-id="6988a-166">**Vantaggi:** Uso efficiente della larghezza di banda.</span><span class="sxs-lookup"><span data-stu-id="6988a-166">**Advantage:** Efficient bandwidth use.</span></span> <span data-ttu-id="6988a-167">È sufficiente trasmettere le informazioni di markup e di stile che verranno usate dal dispositivo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="6988a-167">You only need to transmit the markup and styling information that the target device is going to use.</span></span>
    - <span data-ttu-id="6988a-168">**Svantaggio:** A volte impone la ripetizione di sforzi o codice (ad esempio, per creare copie simili ma leggermente diverse delle pagine Web Form o delle visualizzazioni MVC).</span><span class="sxs-lookup"><span data-stu-id="6988a-168">**Disadvantage:** Sometimes forces repetition of effort or code (e.g., making you create similar but slightly different copies of your Web Forms pages or MVC views).</span></span> <span data-ttu-id="6988a-169">Laddove possibile, sarà necessario eseguire il factoring della logica comune in un livello o servizio sottostante, ma ancora alcune parti del codice dell'interfaccia utente o del markup potrebbero essere duplicate e quindi mantenute in parallelo.</span><span class="sxs-lookup"><span data-stu-id="6988a-169">Where possible you will factor out common logic into an underlying layer or service, but still, some parts of your UI code or markup may have to be duplicated and then maintained in parallel.</span></span>
    - <span data-ttu-id="6988a-170">**Svantaggio:** Il rilevamento del dispositivo non è semplice.</span><span class="sxs-lookup"><span data-stu-id="6988a-170">**Disadvantage:** Device detection is not trivial.</span></span> <span data-ttu-id="6988a-171">Richiede un elenco o un database di tipi di dispositivi noti e le relative caratteristiche (che potrebbero non essere sempre aggiornati) e non è garantito che corrispondano accuratamente a ogni richiesta in ingresso.</span><span class="sxs-lookup"><span data-stu-id="6988a-171">It requires a list or database of known device types and their characteristics (which may not always be perfectly up-to-date) and isn't guaranteed to accurately match every incoming request.</span></span> <span data-ttu-id="6988a-172">Questo documento descrive alcune opzioni e i relativi problemi in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="6988a-172">This document describes some options and their pitfalls later.</span></span>

<span data-ttu-id="6988a-173">Per ottenere risultati ottimali, la maggior parte degli sviluppatori trova la necessità di combinare le opzioni (2) e (3).</span><span class="sxs-lookup"><span data-stu-id="6988a-173">To get the best results, most developers find they need to combine options (2) and (3).</span></span> <span data-ttu-id="6988a-174">Le differenze stilistiche secondarie sono più adatte per il client usando CSS o persino JavaScript, mentre le differenze principali tra i dati, il flusso di lavoro o il markup sono implementate in modo più efficace nel codice sul lato server.</span><span class="sxs-lookup"><span data-stu-id="6988a-174">Minor stylistic differences are best accommodated on the client using CSS or even JavaScript, whereas major differences in data, workflow, or markup are most effectively implemented in server-side code.</span></span>

### <a name="this-paper-focuses-on-server-side-techniques"></a><span data-ttu-id="6988a-175">Questo documento è incentrato sulle tecniche lato server</span><span class="sxs-lookup"><span data-stu-id="6988a-175">This paper focuses on server-side techniques</span></span>

<span data-ttu-id="6988a-176">Poiché ASP.NET Web Form e MVC sono entrambe principalmente tecnologie lato server, questo white paper si focalizzerà sulle tecniche lato server che consentono di produrre markup e logica diversi per i browser per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-176">Since ASP.NET Web Forms and MVC are both primarily server-side technologies, this white paper will focus on server-side techniques that let you produce different markup and logic for mobile browsers.</span></span> <span data-ttu-id="6988a-177">Naturalmente, è anche possibile combinare questo aspetto con qualsiasi tecnica lato client (ad esempio, le query multimediali CSS 3, il miglioramento progressivo del codice JavaScript), ma si tratta di una questione di progettazione Web rispetto allo sviluppo ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6988a-177">Of course, you can also combine this with any client-side technique (e.g., CSS 3 media queries, progressive-enhancement JavaScript), but that's more a matter of web design than ASP.NET development.</span></span>

## <a name="browser-and-device-detection"></a><span data-ttu-id="6988a-178">Rilevamento di dispositivi e browser</span><span class="sxs-lookup"><span data-stu-id="6988a-178">Browser and device detection</span></span>

<span data-ttu-id="6988a-179">Il prerequisito principale per tutte le tecniche lato server per il supporto dei dispositivi mobili è quello di conoscere il dispositivo usato dal visitatore.</span><span class="sxs-lookup"><span data-stu-id="6988a-179">The key prerequisite for all server-side techniques for supporting mobile devices is to know what device your visitor is using.</span></span> <span data-ttu-id="6988a-180">Di fatto, anche meglio di sapere che il produttore e il numero di modello del dispositivo sono consapevoli delle *caratteristiche* del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6988a-180">In fact, even better than knowing the manufacturer and model number of that device is knowing the *characteristics* of the device.</span></span> <span data-ttu-id="6988a-181">Le caratteristiche possono includere:</span><span class="sxs-lookup"><span data-stu-id="6988a-181">Characteristics may include:</span></span>

- <span data-ttu-id="6988a-182">Si tratta di un dispositivo mobile?</span><span class="sxs-lookup"><span data-stu-id="6988a-182">Is it a mobile device?</span></span>
- <span data-ttu-id="6988a-183">Metodo di input (mouse/tastiera, tocco, tastiera, joystick,...)</span><span class="sxs-lookup"><span data-stu-id="6988a-183">Input method (mouse/keyboard, touch, keypad, joystick, …)</span></span>
- <span data-ttu-id="6988a-184">Dimensioni dello schermo (fisicamente e in pixel)</span><span class="sxs-lookup"><span data-stu-id="6988a-184">Screen size (physically and in pixels)</span></span>
- <span data-ttu-id="6988a-185">Supporti e formati di dati supportati</span><span class="sxs-lookup"><span data-stu-id="6988a-185">Supported media and data formats</span></span>
- <span data-ttu-id="6988a-186">Altro.</span><span class="sxs-lookup"><span data-stu-id="6988a-186">Etc.</span></span>

<span data-ttu-id="6988a-187">È preferibile prendere decisioni in base alle caratteristiche rispetto al numero del modello, perché in questo modo si sarà in grado di gestire i dispositivi futuri.</span><span class="sxs-lookup"><span data-stu-id="6988a-187">It's better to make decisions based on characteristics than model number, because then you'll be better equipped to handle future devices.</span></span>

### <a name="using-aspnets-built-in-browser-detection-support"></a><span data-ttu-id="6988a-188">Utilizzando ASP. Supporto del rilevamento incorporato del browser di NET</span><span class="sxs-lookup"><span data-stu-id="6988a-188">Using ASP.NET's built-in browser detection support</span></span>

<span data-ttu-id="6988a-189">I Web Form ASP.NET e gli sviluppatori MVC possono individuare immediatamente caratteristiche importanti di un browser di visita esaminando le proprietà dell'oggetto *Request. browser* .</span><span class="sxs-lookup"><span data-stu-id="6988a-189">ASP.NET Web Forms and MVC developers can immediately discover important characteristics of a visiting browser by inspecting properties of the *Request.Browser* object.</span></span> <span data-ttu-id="6988a-190">Vedere ad esempio</span><span class="sxs-lookup"><span data-stu-id="6988a-190">For example, see</span></span>

- <span data-ttu-id="6988a-191">Request.Browser.IsMobileDevice</span><span class="sxs-lookup"><span data-stu-id="6988a-191">Request.Browser.IsMobileDevice</span></span>
- <span data-ttu-id="6988a-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span><span class="sxs-lookup"><span data-stu-id="6988a-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span></span>
- <span data-ttu-id="6988a-193">Request.Browser.ScreenPixelsWidth</span><span class="sxs-lookup"><span data-stu-id="6988a-193">Request.Browser.ScreenPixelsWidth</span></span>
- <span data-ttu-id="6988a-194">Request.Browser.SupportsXmlHttp</span><span class="sxs-lookup"><span data-stu-id="6988a-194">Request.Browser.SupportsXmlHttp</span></span>
- <span data-ttu-id="6988a-195">...e molti altri</span><span class="sxs-lookup"><span data-stu-id="6988a-195">…and many others</span></span>

<span data-ttu-id="6988a-196">Dietro le quinte, la piattaforma ASP.NET corrisponde all'intestazione HTTP dell' *agente utente* (UA) in ingresso per le espressioni regolari in un set di file XML di definizione del browser.</span><span class="sxs-lookup"><span data-stu-id="6988a-196">Behind the scenes, the ASP.NET platform matches the incoming *User-Agent* (UA) HTTP header against regular expressions in a set of Browser Definition XML files.</span></span> <span data-ttu-id="6988a-197">Per impostazione predefinita, la piattaforma include definizioni per molti dispositivi mobili comuni ed è possibile aggiungere file di definizione del browser personalizzati per altri utenti che si desidera riconoscere.</span><span class="sxs-lookup"><span data-stu-id="6988a-197">By default the platform includes definitions for many common mobile devices, and you can add custom Browser Definition files for others you wish to recognize.</span></span> <span data-ttu-id="6988a-198">Per ulteriori informazioni, vedere la pagina MSDN relativa ai [controlli server Web e alle funzionalità del Browser ASP.NET](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span><span class="sxs-lookup"><span data-stu-id="6988a-198">For more details, see the MSDN page [ASP.NET Web Server Controls and Browser Capabilities](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span></span>

### <a name="using-the-wurfl-device-database-via-51degreesmobi-foundation"></a><span data-ttu-id="6988a-199">Uso del database di dispositivi WURFL tramite 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="6988a-199">Using the WURFL device database via 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="6988a-200">Mentre ASP. Il supporto per il rilevamento incorporato del browser di NET sarà sufficiente per molte applicazioni, in due casi principali, quando potrebbe non essere sufficiente:</span><span class="sxs-lookup"><span data-stu-id="6988a-200">While ASP.NET's built-in browser detection support will be sufficient for many applications, there are two main cases when it might not be enough:</span></span>

- <span data-ttu-id="6988a-201">***Si desidera riconoscere i dispositivi più recenti***, senza creare manualmente i file di definizione del browser.</span><span class="sxs-lookup"><span data-stu-id="6988a-201">***You want to recognize the latest devices***(without manually creating Browser Definition files for them).</span></span> <span data-ttu-id="6988a-202">Si noti che i file di definizione del browser di .NET 4 non sono abbastanza recenti per riconoscere Windows Phone 7, telefoni Android, browser opera per dispositivi mobili o iPad Apple.</span><span class="sxs-lookup"><span data-stu-id="6988a-202">Note that .NET 4's Browser Definition files are not recent enough to recognize Windows Phone 7, Android phones, Opera Mobile browsers, or Apple iPads.</span></span>
- <span data-ttu-id="6988a-203">Sono ***necessarie informazioni più dettagliate sulle funzionalità del dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="6988a-203">***You need more detailed information about device capabilities***.</span></span> <span data-ttu-id="6988a-204">Potrebbe essere necessario conoscere il metodo di input di un dispositivo (ad esempio, il tastierino Touch vs) o i formati audio supportati dal browser.</span><span class="sxs-lookup"><span data-stu-id="6988a-204">You may need to know about a device's input method (e.g., touch vs keypad), or what audio formats the browser supports.</span></span> <span data-ttu-id="6988a-205">Queste informazioni non sono disponibili nei file di definizione del browser standard.</span><span class="sxs-lookup"><span data-stu-id="6988a-205">This information isn't available in the standard Browser Definition files.</span></span>

<span data-ttu-id="6988a-206">Il [progetto WURFL ( *Wireless Universal Resource file* )](http://wurfl.sourceforge.net/) mantiene più aggiornate e dettagliate informazioni sui dispositivi mobili attualmente in uso.</span><span class="sxs-lookup"><span data-stu-id="6988a-206">The [*Wireless Universal Resource File* (WURFL) project](http://wurfl.sourceforge.net/) maintains much more up-to-date and detailed information about mobile devices in use today.</span></span>

<span data-ttu-id="6988a-207">La novità per gli sviluppatori .NET è che ASP. La funzionalità di rilevamento del browser di NET è estensibile ed è quindi possibile ottimizzarla per superare questi problemi.</span><span class="sxs-lookup"><span data-stu-id="6988a-207">The great news for .NET developers is that ASP.NET's browser detection feature is extensible, so it's possible to enhance it to overcome these problems.</span></span> <span data-ttu-id="6988a-208">Ad esempio, è possibile aggiungere la libreria open source [*51Degrees.mobi Foundation*](https://github.com/51Degrees/dotNET-Device-Detection) al progetto.</span><span class="sxs-lookup"><span data-stu-id="6988a-208">For example, you can add the open source [*51Degrees.mobi Foundation*](https://github.com/51Degrees/dotNET-Device-Detection) library to your project.</span></span> <span data-ttu-id="6988a-209">Si tratta di un provider di funzionalità del browser o di ASP.NET IHttpModule (utilizzabile sia in Web Form che in applicazioni MVC), che legge direttamente i dati di WURFL e li associa ad ASP. Meccanismo di rilevamento del browser incorporato di NET.</span><span class="sxs-lookup"><span data-stu-id="6988a-209">It's an ASP.NET IHttpModule or Browser Capabilities Provider (usable on both Web Forms and MVC applications), that directly reads WURFL data and hooks it into ASP.NET's built-in browser detection mechanism.</span></span> <span data-ttu-id="6988a-210">Dopo aver installato il modulo, *Request. browser* conterrà improvvisamente informazioni molto più accurate e dettagliate: riconoscerà correttamente molti dei dispositivi citati in precedenza ed elenca le funzionalità (incluse le funzionalità aggiuntive, ad esempio il metodo di input).</span><span class="sxs-lookup"><span data-stu-id="6988a-210">Once you've installed the module, *Request.Browser* will suddenly contain a lot more accurate and detailed information: it will correctly recognize many of the devices previously mentioned and list their capabilities (including additional capabilities such as input method).</span></span> <span data-ttu-id="6988a-211">Per ulteriori informazioni, vedere la documentazione del progetto.</span><span class="sxs-lookup"><span data-stu-id="6988a-211">See the project's documentation for more details.</span></span>

## <a name="how-web-forms-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="6988a-212">Come le applicazioni Web Form possono presentare pagine specifiche per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-212">How Web Forms applications can present mobile-specific pages</span></span>

<span data-ttu-id="6988a-213">Per impostazione predefinita, ecco come una nuova applicazione Web Forms viene visualizzata nei dispositivi mobili comuni:</span><span class="sxs-lookup"><span data-stu-id="6988a-213">By default, here's how a brand new Web Forms application displays on common mobile devices:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image1.png)

<span data-ttu-id="6988a-214">Chiaramente, nessuno dei due layout sembra molto intuitivo. Questa pagina è stata progettata per un monitoraggio di grandi dimensioni e orientato al paesaggio, non per un piccolo schermo orientato al ritratto.</span><span class="sxs-lookup"><span data-stu-id="6988a-214">Clearly, neither layout looks very mobile-friendly – this page was designed for a large, landscape-oriented monitor, not for a small portrait-oriented screen.</span></span> <span data-ttu-id="6988a-215">Quindi, cosa è possibile fare?</span><span class="sxs-lookup"><span data-stu-id="6988a-215">So what can you do about it?</span></span>

<span data-ttu-id="6988a-216">Come illustrato in precedenza in questo documento, è possibile personalizzare le pagine per i dispositivi mobili in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="6988a-216">As discussed earlier in this paper, there are many ways to tailor your pages for mobile devices.</span></span> <span data-ttu-id="6988a-217">Alcune tecniche sono basate su server, altre vengono eseguite sul client.</span><span class="sxs-lookup"><span data-stu-id="6988a-217">Some techniques are server-based, others run on the client.</span></span>

### <a name="creating-a-mobile-specific-master-page"></a><span data-ttu-id="6988a-218">Creazione di una pagina master specifica per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-218">Creating a mobile-specific master page</span></span>

<span data-ttu-id="6988a-219">A seconda dei requisiti, è possibile utilizzare gli stessi Web Form per tutti i visitatori, ma sono presenti due pagine master separate: una per i visitatori desktop, un'altra per i visitatori per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-219">Depending on your requirements, you may be able to use the same Web Forms for all visitors, but have two separate master pages: one for desktop visitors, another for mobile visitors.</span></span> <span data-ttu-id="6988a-220">Questo offre la flessibilità necessaria per modificare il foglio di stile CSS o il markup HTML di primo livello in base ai dispositivi mobili, senza forzare la duplicazione di qualsiasi logica di pagina.</span><span class="sxs-lookup"><span data-stu-id="6988a-220">This gives you the flexibility of changing the CSS stylesheet or your top-level HTML markup to suit mobile devices, without forcing you to duplicate any page logic.</span></span>

<span data-ttu-id="6988a-221">Questa operazione è facile.</span><span class="sxs-lookup"><span data-stu-id="6988a-221">This is easy to do.</span></span> <span data-ttu-id="6988a-222">Ad esempio, è possibile aggiungere un gestore PreInit come il seguente a un Web Form:</span><span class="sxs-lookup"><span data-stu-id="6988a-222">For example, you can add a PreInit handler such as the following to a Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample1.cs)]

<span data-ttu-id="6988a-223">A questo punto, creare una pagina master denominata mobile. master nella cartella di primo livello dell'applicazione e verrà usata quando viene rilevato un dispositivo mobile.</span><span class="sxs-lookup"><span data-stu-id="6988a-223">Now, create a master page called Mobile.Master in the top-level folder of your application, and it will be used when a mobile device is detected.</span></span> <span data-ttu-id="6988a-224">Se necessario, la pagina master per dispositivi mobili può fare riferimento a un foglio di stile CSS specifico per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-224">Your mobile master page can reference a mobile-specific CSS stylesheet if necessary.</span></span> <span data-ttu-id="6988a-225">I visitatori desktop visualizzeranno ancora la pagina master predefinita, non quella mobile.</span><span class="sxs-lookup"><span data-stu-id="6988a-225">Desktop visitors will still see your default master page, not the mobile one.</span></span>

### <a name="creating-independent-mobile-specific-web-forms"></a><span data-ttu-id="6988a-226">Creazione di Web Form indipendenti specifici per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-226">Creating independent mobile-specific Web Forms</span></span>

<span data-ttu-id="6988a-227">Per garantire la massima flessibilità, è possibile passare molto di più rispetto alla semplice presenza di pagine master separate per diversi tipi di dispositivi.</span><span class="sxs-lookup"><span data-stu-id="6988a-227">For maximum flexibility, you can go much further than just having separate master pages for different device types.</span></span> <span data-ttu-id="6988a-228">È possibile implementare due *insiemi completamente distinti di pagine Web Form* , uno per i browser desktop, un altro set per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-228">You can implement two *totally separate sets of Web Forms pages* – one set for desktop browsers, another set for mobiles.</span></span> <span data-ttu-id="6988a-229">Questa operazione è ottimale se si desidera presentare informazioni o flussi di lavoro molto diversi ai visitatori mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-229">This works best if you want to present very different information or workflows to mobile visitors.</span></span> <span data-ttu-id="6988a-230">Il resto di questa sezione descrive in modo dettagliato questo approccio.</span><span class="sxs-lookup"><span data-stu-id="6988a-230">The rest of this section describes this approach in detail.</span></span>

<span data-ttu-id="6988a-231">Supponendo che sia già disponibile un'applicazione Web Form progettata per i browser desktop, il modo più semplice per procedere consiste nel creare una sottocartella denominata "mobile" all'interno del progetto e compilare le pagine per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-231">Assuming you already have a Web Forms application designed for desktop browsers, the easiest way to proceed is to create a subfolder called "Mobile" within your project, and build your mobile pages there.</span></span> <span data-ttu-id="6988a-232">È possibile creare un intero sito secondario, con pagine master, fogli di stile e pagine, usando tutte le stesse tecniche usate per qualsiasi altra applicazione Web Form.</span><span class="sxs-lookup"><span data-stu-id="6988a-232">You can construct an entire sub-site, with its own master pages, style sheets, and pages, using all the same techniques that you'd use for any other Web Forms application.</span></span> <span data-ttu-id="6988a-233">Non è necessariamente necessario produrre un equivalente mobile per *ogni* pagina del sito desktop; è possibile scegliere quale subset di funzionalità è opportuno per i visitatori mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-233">You don't necessarily need to produce a mobile equivalent for *every* page in your desktop site; you can choose what subset of functionality makes sense for mobile visitors.</span></span>

<span data-ttu-id="6988a-234">Le pagine per dispositivi mobili possono condividere risorse statiche comuni (ad esempio immagini, JavaScript o file CSS) con le pagine normali, se lo si desidera.</span><span class="sxs-lookup"><span data-stu-id="6988a-234">Your mobile pages can share common static resources (such as images, JavaScript, or CSS files) with your regular pages if you wish.</span></span> <span data-ttu-id="6988a-235">Poiché la cartella "mobile" *non* verrà contrassegnata come applicazione separata quando è ospitata in IIS (si tratta semplicemente di una semplice sottocartella di pagine Web Form), condividerà anche la stessa configurazione, i dati della sessione e altre infrastrutture delle pagine desktop.</span><span class="sxs-lookup"><span data-stu-id="6988a-235">Since your "Mobile" folder will *not* be marked as a separate application when hosted in IIS (it's just a simple subfolder of Web Forms pages), it will also share all the same configuration, Session data, and other infrastructure as your desktop pages.</span></span>

> [!NOTE]
> <span data-ttu-id="6988a-236">Poiché questo approccio prevede in genere una duplicazione del codice (è probabile che le pagine mobili condividano alcune analogie con le pagine desktop), è importante eseguire il factoring di qualsiasi logica di business comune o di codice di accesso ai dati in un livello o un servizio sottostante condiviso.</span><span class="sxs-lookup"><span data-stu-id="6988a-236">Since this approach usually involves some duplication of code (mobile pages are likely to share some similarities with desktop pages), it's important to factor out any common business logic or data access code into a shared underlying layer or service.</span></span> <span data-ttu-id="6988a-237">In caso contrario, sarà necessario raddoppiare la creazione e la gestione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6988a-237">Otherwise, you'll double the effort of creating and maintaining your application.</span></span>

#### <a name="redirecting-mobile-visitors-to-your-mobile-pages"></a><span data-ttu-id="6988a-238">Reindirizzamento dei visitatori mobili alle pagine per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-238">Redirecting mobile visitors to your mobile pages</span></span>

<span data-ttu-id="6988a-239">Spesso è utile reindirizzare i visitatori mobili alle pagine per dispositivi mobili solo alla *prima* richiesta nella sessione di esplorazione (e non a ogni richiesta nella sessione), perché:</span><span class="sxs-lookup"><span data-stu-id="6988a-239">It's often convenient to redirect mobile visitors to the mobile pages only on the *first* request in their browsing session (and not on every request in their session), because:</span></span>

- <span data-ttu-id="6988a-240">È quindi possibile consentire ai visitatori mobili di accedere alle pagine desktop se desiderano, ma è sufficiente inserire un collegamento nella pagina master che passa a "versione desktop".</span><span class="sxs-lookup"><span data-stu-id="6988a-240">You can then easily allow mobile visitors to access your desktop pages if they wish – just put a link on your master page that goes to "Desktop version".</span></span> <span data-ttu-id="6988a-241">Il visitatore non verrà reindirizzato di nuovo a una pagina mobile, perché non è più la prima richiesta nella sessione.</span><span class="sxs-lookup"><span data-stu-id="6988a-241">The visitor won't be redirected back to a mobile page, because it's no longer the first request in their session.</span></span>
- <span data-ttu-id="6988a-242">Evita il rischio di interferire con le richieste per le risorse dinamiche condivise tra le parti desktop e mobili del sito (ad esempio, se si dispone di un Web Form comune che sia il desktop che le parti mobili del sito vengono visualizzate in un IFRAME o in alcuni gestori Ajax)</span><span class="sxs-lookup"><span data-stu-id="6988a-242">It avoids the risk of interfering with requests for any dynamic resources shared between desktop and mobile parts of your site (e.g., if you have a common Web Form that both desktop and mobile parts of your site display in an IFRAME, or certain Ajax handlers)</span></span>

<span data-ttu-id="6988a-243">A tale scopo, è possibile inserire la logica di reindirizzamento in una **sessione\_metodo Start** .</span><span class="sxs-lookup"><span data-stu-id="6988a-243">To do this, you can place your redirection logic in a **Session\_Start** method.</span></span> <span data-ttu-id="6988a-244">Ad esempio, aggiungere il metodo seguente al file Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="6988a-244">For example, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample2.cs)]

#### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="6988a-245">Configurazione dell'autenticazione basata su form per rispettare le pagine per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-245">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="6988a-246">Si noti che l'autenticazione basata su form si basa su alcuni presupposti su dove può reindirizzare i visitatori durante e dopo il processo di autenticazione:</span><span class="sxs-lookup"><span data-stu-id="6988a-246">Note that Forms Authentication makes certain assumptions about where it can redirect visitors during and after the authentication process:</span></span>

- <span data-ttu-id="6988a-247">Quando un utente deve essere autenticato, l'autenticazione basata su form reindirizza i dati alla pagina di accesso del desktop, indipendentemente dal fatto che si tratti di un utente desktop o mobile (perché è presente *solo un URL di accesso* ).</span><span class="sxs-lookup"><span data-stu-id="6988a-247">When a user needs to be authenticated, Forms Authentication will redirect them to your desktop login page, regardless of whether they're a desktop or mobile user (because it only has a concept of *one* login URL).</span></span> <span data-ttu-id="6988a-248">Supponendo che si desideri applicare uno stile alla pagina di accesso per dispositivi mobili in modo diverso, è necessario migliorare la pagina di accesso del desktop in modo da reindirizzare gli utenti mobili a una pagina di accesso per dispositivi mobili separata.</span><span class="sxs-lookup"><span data-stu-id="6988a-248">Assuming you want to style your mobile login page differently, you need to enhance your desktop login page so that it redirects mobile users to a separate mobile login page.</span></span> <span data-ttu-id="6988a-249">Ad esempio, aggiungere il codice seguente al code-behind della pagina di accesso **Desktop** :</span><span class="sxs-lookup"><span data-stu-id="6988a-249">For example, add the following code to your **desktop** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample3.cs)]
- <span data-ttu-id="6988a-250">Dopo che un utente ha eseguito l'accesso, per impostazione predefinita l'autenticazione basata su form viene reindirizzata all'home page Desktop (perché è presente *solo una pagina predefinita)* .</span><span class="sxs-lookup"><span data-stu-id="6988a-250">After a user successfully logs in, Forms Authentication will by default redirect them to your desktop home page (because it only has a concept of *one* default page).</span></span> <span data-ttu-id="6988a-251">È necessario migliorare la pagina di accesso per dispositivi mobili in modo che venga reindirizzata al home page mobile dopo un accesso riuscito.</span><span class="sxs-lookup"><span data-stu-id="6988a-251">You need to enhance your mobile login page so that it redirects to the mobile home page after a successful log-in.</span></span> <span data-ttu-id="6988a-252">Ad esempio, aggiungere il codice seguente al code-behind della pagina di accesso per **dispositivi mobili** :</span><span class="sxs-lookup"><span data-stu-id="6988a-252">For example, add the following code to your **mobile** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample4.cs)]
  
  <span data-ttu-id="6988a-253">Questo codice presuppone che la pagina disponga di un controllo server di accesso denominato LoginUser, come nel modello di progetto predefinito.</span><span class="sxs-lookup"><span data-stu-id="6988a-253">This code assumes your page has a Login server control called LoginUser, as in the default project template.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="6988a-254">Uso della memorizzazione nella cache di output</span><span class="sxs-lookup"><span data-stu-id="6988a-254">Working with Output Caching</span></span>

<span data-ttu-id="6988a-255">Se si usa la memorizzazione nella cache di output, per impostazione predefinita è possibile che un utente desktop visiti un determinato URL (causando la memorizzazione nella cache dell'output), seguito da un utente mobile che quindi riceve l'output del desktop memorizzato nella cache.</span><span class="sxs-lookup"><span data-stu-id="6988a-255">If you're using output caching, beware that by default it's possible for a desktop user to visit a certain URL (causing its output to be cached), followed by a mobile user who then receives the cached desktop output.</span></span> <span data-ttu-id="6988a-256">Questo avviso si applica se si sta semplicemente variando la pagina master in base al tipo di dispositivo o se si implementano Web Form completamente distinti per ogni tipo di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6988a-256">This warning applies whether you're just varying your master page by device type, or implementing totally separate Web Forms per device type.</span></span>

<span data-ttu-id="6988a-257">Per evitare il problema, è possibile indicare a ASP.NET di variare la voce della cache a seconda che il visitatore stia usando un dispositivo mobile.</span><span class="sxs-lookup"><span data-stu-id="6988a-257">To avoid the problem, you can instruct ASP.NET to vary the cache entry according to whether the visitor is using a mobile device.</span></span> <span data-ttu-id="6988a-258">Aggiungere un parametro VaryByCustom alla dichiarazione OutputCache della pagina come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="6988a-258">Add a VaryByCustom parameter to your page's OutputCache declaration as follows:</span></span>

[!code-aspx[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample5.aspx)]

<span data-ttu-id="6988a-259">Definire quindi *IsMobileDevice* come parametro della cache personalizzata aggiungendo l'override del metodo seguente al file Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="6988a-259">Next, define *isMobileDevice* as a custom cache parameter by adding the following method override to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample6.cs)]

<span data-ttu-id="6988a-260">In questo modo, i visitatori mobili della pagina non riceveranno l'output inserito in precedenza nella cache da un visitatore desktop.</span><span class="sxs-lookup"><span data-stu-id="6988a-260">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="6988a-261">Esempio funzionante</span><span class="sxs-lookup"><span data-stu-id="6988a-261">A working example</span></span>

<span data-ttu-id="6988a-262">Per vedere le tecniche in azione, scaricare [gli esempi di codice di questo white paper](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="6988a-262">To see these techniques in action, download [this white paper's code samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="6988a-263">L'applicazione di esempio Web Form reindirizza automaticamente gli utenti mobili a un set di pagine specifiche per dispositivi mobili in una sottocartella denominata mobile.</span><span class="sxs-lookup"><span data-stu-id="6988a-263">The Web Forms sample application automatically redirects mobile users to a set of mobile-specific pages in a subfolder called Mobile.</span></span> <span data-ttu-id="6988a-264">Il markup e lo stile di tali pagine sono ottimizzati in modo ottimale per i browser per dispositivi mobili, come si può notare dagli screenshot seguenti:</span><span class="sxs-lookup"><span data-stu-id="6988a-264">The markup and styling of those pages is better optimized for mobile browsers, as you can see from the following screenshots:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image2.png)

<span data-ttu-id="6988a-265">Per altri suggerimenti sull'ottimizzazione del markup e CSS per i browser per dispositivi mobili, vedere la sezione "applicazione di stili a pagine mobili per i browser per dispositivi mobili" più avanti in questo documento.</span><span class="sxs-lookup"><span data-stu-id="6988a-265">For more tips about optimizing your markup and CSS for mobile browsers, see the section "Styling mobile pages for mobile browsers" later in this document.</span></span>

## <a name="how-aspnet-mvc-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="6988a-266">Come le applicazioni MVC ASP.NET possono presentare pagine specifiche per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-266">How ASP.NET MVC applications can present mobile-specific pages</span></span>

<span data-ttu-id="6988a-267">Poiché il modello Model-View-Controller separa la logica dell'applicazione (nei controller) dalla logica di presentazione (nelle visualizzazioni), è possibile scegliere uno degli approcci seguenti per gestire il supporto mobile nel codice lato server:</span><span class="sxs-lookup"><span data-stu-id="6988a-267">Since the Model-View-Controller pattern decouples application logic (in controllers) from presentation logic (in views), you can choose from any of the following approaches to handling mobile support in server-side code:</span></span>

1. <span data-ttu-id="6988a-268">\*\**utilizzano gli stessi controller e le stesse visualizzazioni per i browser desktop e per dispositivi mobili, ma eseguono il rendering delle visualizzazioni con layout Razor diversi a seconda del tipo di dispositivo *.**</span><span class="sxs-lookup"><span data-stu-id="6988a-268">\***Use the same controllers and views for both desktop and mobile browsers, but render the views with different Razor layouts depending on the device type\*.**</span></span> <span data-ttu-id="6988a-269">Questa opzione funziona meglio se si visualizzano dati identici in tutti i dispositivi, ma si vogliono semplicemente fornire fogli di stile CSS diversi o modificare alcuni elementi HTML di primo livello per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-269">This option works best if you're displaying identical data on all devices, but simply want to supply different CSS stylesheets or change a few top-level HTML elements for mobiles.</span></span>
2. <span data-ttu-id="6988a-270">***Usare gli stessi controller per i browser desktop e per dispositivi mobili, ma per eseguire il rendering di visualizzazioni diverse a seconda del tipo di dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="6988a-270">***Use the same controllers for both desktop and mobile browsers, but render different views depending on the device type***.</span></span> <span data-ttu-id="6988a-271">Questa opzione funziona meglio se si visualizzano approssimativamente gli stessi dati e si forniscono gli stessi flussi di lavoro per gli utenti finali, ma si vuole eseguire il rendering di markup HTML molto diverso per adattarsi al dispositivo in uso.</span><span class="sxs-lookup"><span data-stu-id="6988a-271">This option works best if you're displaying roughly the same data and providing the same workflows for end users, but want to render very different HTML markup to suit the device being used.</span></span>
3. <span data-ttu-id="6988a-272">\*\**creare aree separate per i browser desktop e per dispositivi mobili, implementando controller e visualizzazioni indipendenti per ogni *.**</span><span class="sxs-lookup"><span data-stu-id="6988a-272">\***Create separate areas for desktop and mobile browsers, implementing independent controllers and views for each\*.**</span></span> <span data-ttu-id="6988a-273">Questa opzione funziona meglio se si visualizzano schermate molto diverse, che contengono informazioni diverse e che portano l'utente attraverso flussi di lavoro diversi ottimizzati per il proprio tipo di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6988a-273">This option works best if you're displaying very different screens, containing different information and leading the user through different workflows optimized for their device type.</span></span> <span data-ttu-id="6988a-274">Potrebbe significare una ripetizione del codice, ma è possibile ridurre il rischio eseguendo il factoring della logica comune in un livello o servizio sottostante.</span><span class="sxs-lookup"><span data-stu-id="6988a-274">It may mean some repetition of code, but you can minimize that by factoring out common logic into an underlying layer or service.</span></span>

<span data-ttu-id="6988a-275">Se si vuole usare la **prima** opzione e variare solo il layout Razor per ogni tipo di dispositivo, è molto semplice.</span><span class="sxs-lookup"><span data-stu-id="6988a-275">If you want to take the **first** option and vary only the Razor layout per device type, it's very easy.</span></span> <span data-ttu-id="6988a-276">È sufficiente modificare il file \_ViewStart. cshtml come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="6988a-276">Just modify your \_ViewStart.cshtml file as follows:</span></span>

[!code-cshtml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample7.cshtml)]

<span data-ttu-id="6988a-277">A questo punto è possibile creare un layout specifico per dispositivi mobili denominato \_LayoutMobile. cshtml con una struttura di pagina e regole CSS ottimizzate per i dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-277">Now you can create a mobile-specific layout called \_LayoutMobile.cshtml with a page structure and CSS rules optimized for mobile devices.</span></span>

<span data-ttu-id="6988a-278">Se si vuole usare la **seconda** opzione per eseguire il rendering di visualizzazioni completamente diverse in base al tipo di dispositivo del visitatore, vedere il [post di Blog di Scott hanselr](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span><span class="sxs-lookup"><span data-stu-id="6988a-278">If you want to take the **second** option render totally different views according to the visitor's device type, see [Scott Hanselman's blog post](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span></span>

<span data-ttu-id="6988a-279">Il resto di questo documento è incentrato sulla **terza** opzione, ovvero la creazione di controller *e* visualizzazioni distinti per i dispositivi mobili, in modo da poter controllare esattamente quale subset di funzionalità è disponibile per i visitatori mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-279">The rest of this paper focuses on the **third** option – creating separate controllers *and* views for mobile devices – so you can control exactly what subset of functionality is offered for mobile visitors.</span></span>

### <a name="setting-up-a-mobile-area-within-your-aspnet-mvc-application"></a><span data-ttu-id="6988a-280">Configurazione di un'area mobile all'interno dell'applicazione ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="6988a-280">Setting up a Mobile area within your ASP.NET MVC application</span></span>

<span data-ttu-id="6988a-281">È possibile aggiungere un'area denominata "mobile" a un'applicazione MVC ASP.NET esistente nel modo normale: fare clic con il pulsante destro del mouse sul nome del progetto in Esplora soluzioni, quindi scegliere Aggiungi area.</span><span class="sxs-lookup"><span data-stu-id="6988a-281">You can add an area called "Mobile" to an existing ASP.NET MVC application in the normal way: right-click on your project name in Solution Explorer, then choose Add à Area.</span></span> <span data-ttu-id="6988a-282">È quindi possibile aggiungere controller e visualizzazioni come per qualsiasi altra area all'interno di un'applicazione MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6988a-282">You can then add controllers and views as you would for any other area within an ASP.NET MVC application.</span></span> <span data-ttu-id="6988a-283">Ad esempio, aggiungere all'area mobile un nuovo controller denominato HomeController che funge da Home page per i visitatori mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-283">For example, add to your Mobile area a new controller called HomeController to act as a homepage for mobile visitors.</span></span>

### <a name="ensuring-the-url-mobile-reaches-the-mobile-homepage"></a><span data-ttu-id="6988a-284">Verificare che l'URL/mobile raggiunga la Home page per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-284">Ensuring the URL /Mobile reaches the mobile homepage</span></span>

<span data-ttu-id="6988a-285">Se si vuole che l'URL/mobile raggiunga l'azione index in HomeController all'interno dell'area mobile, è necessario apportare due modifiche minime alla configurazione di routing.</span><span class="sxs-lookup"><span data-stu-id="6988a-285">If you want the URL /Mobile to reach the Index action on HomeController inside your Mobile area, you will need to make two small changes to your routing configuration.</span></span> <span data-ttu-id="6988a-286">Aggiornare prima di tutto la classe MobileAreaRegistration in modo che HomeController sia il controller predefinito nell'area mobile, come illustrato nel codice seguente:</span><span class="sxs-lookup"><span data-stu-id="6988a-286">First, update your MobileAreaRegistration class so that HomeController is the default controller in your Mobile area, as shown in the following code:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample8.cs)]

<span data-ttu-id="6988a-287">Ciò significa che la Home page per dispositivi mobili verrà ora posizionata in/mobile, anziché/Mobile/Home, perché "Home" è ora il nome del controller predefinito in modo implicito per le pagine per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-287">This means the mobile homepage will now be located at /Mobile, rather than /Mobile/Home, because "Home" is now the implicitly default controller name for mobile pages.</span></span>

<span data-ttu-id="6988a-288">Si noti quindi che aggiungendo un secondo HomeController all'applicazione (ad esempio, il dispositivo mobile, oltre a quello esistente), si disporrà della normale Home page del desktop.</span><span class="sxs-lookup"><span data-stu-id="6988a-288">Next, note that by adding a second HomeController to your application (i.e., the mobile one, in addition to the existing desktop one), you'll have broken your regular desktop homepage.</span></span> <span data-ttu-id="6988a-289">Avrà esito negativo con l'errore "*sono stati trovati più tipi che corrispondono al controller denominato ' Home '* ".</span><span class="sxs-lookup"><span data-stu-id="6988a-289">It will fail with the error "*Multiple types were found that match the controller named 'Home'*".</span></span> <span data-ttu-id="6988a-290">Per risolvere questo problema, aggiornare la configurazione del routing di primo livello (in Global.asax.cs) per specificare che il HomeController desktop deve avere la priorità in caso di ambiguità:</span><span class="sxs-lookup"><span data-stu-id="6988a-290">To resolve this, update your top-level routing configuration (in Global.asax.cs) to specify that your desktop HomeController should take priority when there's ambiguity:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample9.cs)]

<span data-ttu-id="6988a-291">A questo punto, l'errore verrà tolto e l'URL http:\/\/*yoursite*/raggiungerà la Home page del desktop e http:\/\/*yoursite*/mobile/raggiungerà la Home page per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-291">Now the error will go away, and the URL http:\/\/*yoursite*/ will reach the desktop homepage, and http:\/\/*yoursite*/mobile/ will reach the mobile homepage.</span></span>

### <a name="redirecting-mobile-visitors-to-your-mobile-area"></a><span data-ttu-id="6988a-292">Reindirizzamento dei visitatori mobili all'area mobile</span><span class="sxs-lookup"><span data-stu-id="6988a-292">Redirecting mobile visitors to your mobile area</span></span>

<span data-ttu-id="6988a-293">In ASP.NET MVC sono presenti molti punti di estensibilità diversi, quindi esistono molti modi possibili per inserire la logica di reindirizzamento.</span><span class="sxs-lookup"><span data-stu-id="6988a-293">There are many different extensibility points in ASP.NET MVC, so there are many possible ways to inject redirection logic.</span></span> <span data-ttu-id="6988a-294">Una semplice opzione consiste nel creare un attributo di filtro, [RedirectMobileDevicesToMobileArea], che esegua un reindirizzamento se vengono soddisfatte le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6988a-294">One neat option is to create a filter attribute, [RedirectMobileDevicesToMobileArea], that performs a redirection if the following conditions are met:</span></span>

1. <span data-ttu-id="6988a-295">Si tratta della prima richiesta nella sessione dell'utente (ad esempio, Session. IsNewSession è uguale a true)</span><span class="sxs-lookup"><span data-stu-id="6988a-295">It's the first request in the user's session (i.e., Session.IsNewSession equals true)</span></span>
2. <span data-ttu-id="6988a-296">La richiesta deriva da un browser per dispositivi mobili (ad esempio, Request. browser. IsMobileDevice è uguale a true)</span><span class="sxs-lookup"><span data-stu-id="6988a-296">The request comes from a mobile browser (i.e., Request.Browser.IsMobileDevice equals true)</span></span>
3. <span data-ttu-id="6988a-297">L'utente non sta già richiedendo una risorsa nell'area mobile (ad esempio, la parte del *percorso* dell'URL non inizia con/mobile)</span><span class="sxs-lookup"><span data-stu-id="6988a-297">The user is not already requesting a resource in the mobile area (i.e., the *path* part of the URL does not begin with /Mobile)</span></span>

<span data-ttu-id="6988a-298">L'esempio scaricabile incluso in questo white paper include un'implementazione di questa logica.</span><span class="sxs-lookup"><span data-stu-id="6988a-298">The downloadable sample included with this white paper includes an implementation of this logic.</span></span> <span data-ttu-id="6988a-299">Viene implementato come filtro di autorizzazione derivato da AuthorizeAttribute, il che significa che può funzionare correttamente anche se si usa la memorizzazione nella cache di output. in caso contrario, se un visitatore Desktop accede per la prima volta a un determinato URL, l'output del desktop potrebbe essere memorizzato nella cache e quindi servito visitatori mobili successivi).</span><span class="sxs-lookup"><span data-stu-id="6988a-299">It's implemented as an authorization filter, derived from AuthorizeAttribute, which means it can work correctly even if you are using output caching (otherwise, if a desktop visitor first accesses a certain URL, the desktop output might be cached and then served to subsequent mobile visitors).</span></span>

<span data-ttu-id="6988a-300">Poiché si tratta di un filtro, è possibile scegliere di applicarlo a controller e azioni specifici, ad esempio</span><span class="sxs-lookup"><span data-stu-id="6988a-300">As it's a filter, you can choose either to apply it to specific controllers and actions, e.g.,</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample10.cs)]

<span data-ttu-id="6988a-301">…</span><span class="sxs-lookup"><span data-stu-id="6988a-301">…</span></span> <span data-ttu-id="6988a-302">in alternativa, è possibile applicarla a tutti i controller e le azioni come *filtro globale* MVC 3 nel file Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="6988a-302">or you can apply it to all controllers and actions as an MVC 3 *global filter* in your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample11.cs)]

<span data-ttu-id="6988a-303">Nell'esempio scaricabile viene inoltre illustrato come creare sottoclassi di questo attributo che reindirizza a percorsi specifici all'interno dell'area mobile.</span><span class="sxs-lookup"><span data-stu-id="6988a-303">The downloadable sample also demonstrates how you can create subclasses of this attribute that redirect to specific locations within your mobile area.</span></span> <span data-ttu-id="6988a-304">Ciò significa che, ad esempio, è possibile:</span><span class="sxs-lookup"><span data-stu-id="6988a-304">This means, for example, you can:</span></span>

- <span data-ttu-id="6988a-305">Registrare un filtro globale come illustrato in precedenza per inviare i visitatori mobili alla Home page per dispositivi mobili per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="6988a-305">Register a global filter as shown above that sends mobile visitors to the mobile homepage by default.</span></span>
- <span data-ttu-id="6988a-306">Applicare anche un filtro [RedirectMobileDevicesToMobileProductPage] speciale a un'azione "Visualizza prodotto" che porta i visitatori mobili alla versione per dispositivi mobili di qualsiasi pagina del prodotto richiesta.</span><span class="sxs-lookup"><span data-stu-id="6988a-306">Also apply a special [RedirectMobileDevicesToMobileProductPage] filter to a "view product" action that takes mobile visitors to the mobile version of whatever product page they had requested.</span></span>
- <span data-ttu-id="6988a-307">Applicare anche altre sottoclassi speciali del filtro a azioni specifiche, reindirizzando i visitatori mobili alla pagina mobile equivalente</span><span class="sxs-lookup"><span data-stu-id="6988a-307">Also apply other special subclasses of the filter to specific actions, redirecting mobile visitors to the equivalent mobile page</span></span>

### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="6988a-308">Configurazione dell'autenticazione basata su form per rispettare le pagine per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-308">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="6988a-309">Se si usa l'autenticazione basata su form, tenere presente che quando un utente deve eseguire l'accesso, reindirizza automaticamente l'utente a un singolo URL di "accesso" specifico, che per impostazione predefinita è **/account/logon**.</span><span class="sxs-lookup"><span data-stu-id="6988a-309">If you're using Forms Authentication, you should note that when a user needs to log in, it automatically redirects the user to a single specific "log on" URL, which by default is **/Account/LogOn**.</span></span> <span data-ttu-id="6988a-310">Questo significa che gli utenti mobili potrebbero essere reindirizzati all'azione "Accedi" del desktop.</span><span class="sxs-lookup"><span data-stu-id="6988a-310">This means that mobile users may be redirected to your desktop "log on" action.</span></span>

<span data-ttu-id="6988a-311">Per evitare questo problema, aggiungere la logica all'azione "Accedi" al desktop in modo da reindirizzare gli utenti mobili a un'azione "Accedi" per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-311">To avoid this problem, add logic to your desktop "log on" action so that it redirects mobile users again to a mobile "log on" action.</span></span> <span data-ttu-id="6988a-312">Se si usa il modello di applicazione MVC ASP.NET predefinito, aggiornare l'azione di accesso di AccountController come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="6988a-312">If you're using the default ASP.NET MVC application template, update AccountController's LogOn action as follows:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample12.cs)]

<span data-ttu-id="6988a-313">…</span><span class="sxs-lookup"><span data-stu-id="6988a-313">…</span></span> <span data-ttu-id="6988a-314">implementare quindi un'azione di "accesso" specifica per dispositivi mobili in un controller denominato AccountController nell'area mobile.</span><span class="sxs-lookup"><span data-stu-id="6988a-314">and then implement a suitable mobile-specific "log on" action on a controller called AccountController in your Mobile area.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="6988a-315">Uso della memorizzazione nella cache di output</span><span class="sxs-lookup"><span data-stu-id="6988a-315">Working with Output Caching</span></span>

<span data-ttu-id="6988a-316">Se si usa il filtro [OutputCache], è necessario forzare la voce della cache a variare in base al tipo di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6988a-316">If you're using the [OutputCache] filter, you must force the cache entry to vary by device type.</span></span> <span data-ttu-id="6988a-317">Ad esempio, scrivere:</span><span class="sxs-lookup"><span data-stu-id="6988a-317">For example, write:</span></span>

[!code-javascript[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample13.js)]

<span data-ttu-id="6988a-318">Aggiungere quindi il metodo seguente al file Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="6988a-318">Then, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample14.cs)]

<span data-ttu-id="6988a-319">In questo modo, i visitatori mobili della pagina non riceveranno l'output inserito in precedenza nella cache da un visitatore desktop.</span><span class="sxs-lookup"><span data-stu-id="6988a-319">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="6988a-320">Esempio funzionante</span><span class="sxs-lookup"><span data-stu-id="6988a-320">A working example</span></span>

<span data-ttu-id="6988a-321">Per vedere le tecniche in azione, scaricare [gli esempi di codice associati a questo white paper](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="6988a-321">To see these techniques in action, download [this white paper's code associated samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="6988a-322">L'esempio include un'applicazione ASP.NET MVC 3 (Release Candidate) migliorata per supportare i dispositivi mobili usando i metodi descritti in precedenza.</span><span class="sxs-lookup"><span data-stu-id="6988a-322">The sample includes an ASP.NET MVC 3 (Release Candidate) application enhanced to support mobile devices using the methods described above.</span></span>

## <a name="further-guidance-and-suggestions"></a><span data-ttu-id="6988a-323">Ulteriori indicazioni e suggerimenti</span><span class="sxs-lookup"><span data-stu-id="6988a-323">Further guidance and suggestions</span></span>

<span data-ttu-id="6988a-324">La discussione seguente si applica sia ai Web Form che agli sviluppatori MVC che usano le tecniche descritte in questo documento.</span><span class="sxs-lookup"><span data-stu-id="6988a-324">The following discussion applies both to Web Forms and MVC developers who are using the techniques covered in this document.</span></span>

### <a name="enhancing-your-redirection-logic-using-51degreesmobi-foundation"></a><span data-ttu-id="6988a-325">Miglioramento della logica di reindirizzamento con 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="6988a-325">Enhancing your redirection logic using 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="6988a-326">La logica di reindirizzamento mostrata in questo documento potrebbe essere perfettamente sufficiente per l'applicazione, ma non funzionerà se è necessario disabilitare le sessioni o con i browser per dispositivi mobili che rifiutano i cookie (non possono avere sessioni), perché non saprà se una determinata richiesta è il primo dal visitatore.</span><span class="sxs-lookup"><span data-stu-id="6988a-326">The redirection logic shown in this document may be perfectly sufficient for your application, but it won't work if you need to disable sessions, or with mobile browsers that reject cookies (these can't have sessions), because it won't know whether a given request is the first one from that visitor.</span></span>

<span data-ttu-id="6988a-327">Si è già appreso come Open Source 51Degrees.mobi Foundation può migliorare l'accuratezza di ASP. Rilevamento del browser NET.</span><span class="sxs-lookup"><span data-stu-id="6988a-327">You already learned how the open source 51Degrees.mobi Foundation can improve the accuracy of ASP.NET's browser detection.</span></span> <span data-ttu-id="6988a-328">Dispone inoltre di una capacità incorporata di reindirizzare i visitatori mobili a posizioni specifiche configurate nel file Web. config. È in grado di funzionare senza dipendere da sessioni ASP.NET (e di conseguenza cookie) archiviando un log temporaneo di hash delle intestazioni HTTP dei visitatori e degli indirizzi IP, in modo da sapere se ogni richiesta è la prima a partire da un dato visualizzatore.</span><span class="sxs-lookup"><span data-stu-id="6988a-328">It also has a built-in ability to redirect mobile visitors to specific locations configured in Web.config. It's able to work without depending on ASP.NET Sessions (and hence cookies) by storing a temporary log of hashes of visitors' HTTP headers and IP addresses, so it knows whether or not each request is the first one from a given vistor.</span></span>

<span data-ttu-id="6988a-329">L'elemento seguente aggiunto alla sezione fiftyOne del file Web. config reindirizza la prima richiesta da un dispositivo mobile rilevato alla pagina ~/Mobile/Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="6988a-329">The following element added to the fiftyOne section of the web.config file will redirect the first request from a detected mobile device to the page ~/Mobile/Default.aspx.</span></span> <span data-ttu-id="6988a-330">Tutte le richieste alle pagine nella cartella mobile *non* verranno reindirizzate, indipendentemente dal tipo di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6988a-330">Any requests to pages under the Mobile folder will *not* be redirected, regardless of device type.</span></span> <span data-ttu-id="6988a-331">Se il dispositivo mobile è rimasto inattivo per un periodo di 20 minuti o più, il dispositivo verrà dimenticato e le successive richieste verranno considerate come nuove a scopo di reindirizzamento.</span><span class="sxs-lookup"><span data-stu-id="6988a-331">If the mobile device has been inactive for a period of 20 minutes or more the device will be forgotten and subsequent requests will be treated as new ones for the purposes of redirection.</span></span>

[!code-xml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample15.xml)]

<span data-ttu-id="6988a-332">Per ulteriori informazioni, vedere la [documentazione di 51Degrees.mobi Foundation](https://github.com/51Degrees/dotNET-Device-Detection).</span><span class="sxs-lookup"><span data-stu-id="6988a-332">For more details, see [51degrees.mobi Foundation documentation](https://github.com/51Degrees/dotNET-Device-Detection).</span></span>

> [!NOTE]
> <span data-ttu-id="6988a-333">È *possibile* usare la funzionalità di reindirizzamento di 51Degrees.mobi Foundation nelle applicazioni ASP.NET MVC, ma è necessario definire la configurazione del reindirizzamento in termini di URL semplici, non in termini di parametri di routing o di inserimento di filtri MVC sulle azioni.</span><span class="sxs-lookup"><span data-stu-id="6988a-333">You *can* use 51Degrees.mobi Foundation's redirection feature on ASP.NET MVC applications, but you will need to define your redirection configuration in terms of plain URLs, not in terms of routing parameters or by putting MVC filters on actions.</span></span> <span data-ttu-id="6988a-334">Questo perché (al momento della stesura di questo documento) 51Degrees.mobi Foundation non riconosce i filtri o il routing.</span><span class="sxs-lookup"><span data-stu-id="6988a-334">This is because (at the time of writing) 51Degrees.mobi Foundation does not recognize filters or routing.</span></span>

### <a name="disabling-transcoders-and-proxy-servers"></a><span data-ttu-id="6988a-335">Disabilitazione di transcodificatori e server proxy</span><span class="sxs-lookup"><span data-stu-id="6988a-335">Disabling Transcoders and Proxy Servers</span></span>

<span data-ttu-id="6988a-336">Gli operatori di rete mobile hanno due obiettivi generali nell'approccio alla rete Internet mobile:</span><span class="sxs-lookup"><span data-stu-id="6988a-336">Mobile network operators have two broad objectives in their approach to the mobile internet:</span></span>

1. <span data-ttu-id="6988a-337">Fornire il maggior contenuto pertinente possibile</span><span class="sxs-lookup"><span data-stu-id="6988a-337">Provide as much relevant content as possible</span></span>
2. <span data-ttu-id="6988a-338">Massimizzare il numero di clienti che possono condividere la larghezza di banda di rete radio limitata</span><span class="sxs-lookup"><span data-stu-id="6988a-338">Maximize the number of customers who can share the limited radio network bandwidth</span></span>

<span data-ttu-id="6988a-339">Poiché la maggior parte delle pagine Web è stata progettata per schermi di grandi dimensioni e connessioni a banda larga fissa, molti operatori utilizzano i *transcodificatori* o i *server proxy* che modificano dinamicamente il contenuto Web.</span><span class="sxs-lookup"><span data-stu-id="6988a-339">Since most web pages were designed for large desktop-sized screens and fast fixed-line broadband connections, many operators use *transcoders* or *proxy servers* that dynamically alter web content.</span></span> <span data-ttu-id="6988a-340">Potrebbero modificare il markup HTML o il CSS in base a schermi più piccoli (soprattutto per "telefoni di funzionalità" che non dispongono della potenza di elaborazione per gestire i layout complessi) e possono ricomprimere le immagini (riducendo significativamente la qualità) per migliorare le velocità di recapito delle pagine.</span><span class="sxs-lookup"><span data-stu-id="6988a-340">They may modify your HTML markup or CSS to suit smaller screens (especially for "feature phones" that lack the processing power to handle complex layouts), and they may recompress your images (significantly reducing their quality) to improve page delivery speeds.</span></span>

<span data-ttu-id="6988a-341">Tuttavia, se si è scelto di produrre una versione ottimizzata per dispositivi mobili del sito, è probabile che l'operatore di rete non interferisca con altri.</span><span class="sxs-lookup"><span data-stu-id="6988a-341">But if you've taken the effort to produce a mobile-optimized version of your site, you probably don't want the network operator to interfere with it any further.</span></span> <span data-ttu-id="6988a-342">È possibile aggiungere la riga seguente alla pagina\_evento di caricamento in qualsiasi Web Form ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="6988a-342">You can add the following line to the Page\_Load event in any ASP.NET Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample16.cs)]

<span data-ttu-id="6988a-343">In alternativa, per un controller MVC ASP.NET, è possibile aggiungere l'override del metodo seguente in modo che venga applicato a tutte le azioni sul controller:</span><span class="sxs-lookup"><span data-stu-id="6988a-343">Or, for an ASP.NET MVC controller, you could add the following method override so that it applies to all actions on that controller:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample17.cs)]

<span data-ttu-id="6988a-344">Il messaggio HTTP risultante informa i proxy e i transcodificatori conformi a W3C di non modificare il contenuto.</span><span class="sxs-lookup"><span data-stu-id="6988a-344">The resulting HTTP message informs W3C compliant transcoders and proxies not to alter content.</span></span> <span data-ttu-id="6988a-345">Naturalmente, non vi è alcuna garanzia che gli operatori di rete mobile rispettino questo messaggio.</span><span class="sxs-lookup"><span data-stu-id="6988a-345">Of course, there is no guarantee that mobile network operators will respect this message.</span></span>

### <a name="styling-mobile-pages-for-mobile-browsers"></a><span data-ttu-id="6988a-346">Applicazione di stili a pagine mobili per browser per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="6988a-346">Styling mobile pages for mobile browsers</span></span>

<span data-ttu-id="6988a-347">Esula dall'ambito di questo documento descrive in dettaglio quali tipi di markup HTML funzionano correttamente o quali tecniche di progettazione Web ottimizzano l'usabilità su dispositivi specifici.</span><span class="sxs-lookup"><span data-stu-id="6988a-347">It's beyond the scope of this document to describe in great detail what kinds of HTML markup work correctly or which web design techniques maximize usability on particular devices.</span></span> <span data-ttu-id="6988a-348">È possibile trovare un layout sufficientemente semplice, ottimizzato per una schermata di dimensioni mobili, senza usare i trucchi di posizionamento HTML o CSS inaffidabili.</span><span class="sxs-lookup"><span data-stu-id="6988a-348">It's up to you to find a sufficiently simple layout, optimized for a mobile-sized screen, without using unreliable HTML or CSS positioning tricks.</span></span> <span data-ttu-id="6988a-349">Una tecnica importante che vale la pena citare, tuttavia, è il *tag meta del viewport*.</span><span class="sxs-lookup"><span data-stu-id="6988a-349">One important technique worth mentioning, however, is the *viewport meta tag*.</span></span>

<span data-ttu-id="6988a-350">Alcuni moderni browser per dispositivi mobili, nel tentativo di visualizzare le pagine Web per i monitor desktop, eseguono il rendering della pagina in un'area di disegno virtuale, nota anche come "viewport" (ad esempio, il viewport virtuale è 980 pixel di larghezza su iPhone e 850 pixel di larghezza in opera mobile per impostazione predefinita) e quindi ridimensionare il risultato per adattarlo ai pixel fisici dello schermo.</span><span class="sxs-lookup"><span data-stu-id="6988a-350">Certain modern mobile browsers, in an effort display web pages meant for desktop monitors, render the page on a virtual canvas, also called "viewport" (e.g., the virtual viewport is 980 pixels wide on iPhone, and 850 pixels wide on Opera Mobile by default) and then scale the result down to fit onto the screen's physical pixels.</span></span> <span data-ttu-id="6988a-351">L'utente può quindi eseguire lo zoom avanti e il panning intorno al viewport.</span><span class="sxs-lookup"><span data-stu-id="6988a-351">The user can then zoom in and pan around that viewport.</span></span> <span data-ttu-id="6988a-352">Questo offre il vantaggio di consentire al browser di visualizzare la pagina nel layout previsto, ma presenta anche lo svantaggio che impone lo zoom e la panoramica, il che risulta inappropriato per l'utente.</span><span class="sxs-lookup"><span data-stu-id="6988a-352">This has the advantage that it lets the browser display the page in its intended layout, but it's also has the disadvantage that it forces zooming and panning, which is inconvenient for the user.</span></span> <span data-ttu-id="6988a-353">Se si sta progettando per dispositivi mobili, è preferibile progettare per uno schermo ridotto in modo che non sia necessario lo scorrimento orizzontale o lo scorrimento orizzontale.</span><span class="sxs-lookup"><span data-stu-id="6988a-353">If you're designing for mobile, it's better to design for a narrow screen so that no zooming or horizontal scrolling is necessary.</span></span>

<span data-ttu-id="6988a-354">Un modo per indicare al browser per dispositivi mobili la larghezza del viewport deve essere tramite il tag meta del *viewport* non standard.</span><span class="sxs-lookup"><span data-stu-id="6988a-354">A way to tell the mobile browser how wide the viewport should be is through the nonstandard *viewport* meta tag.</span></span> <span data-ttu-id="6988a-355">Ad esempio, se si aggiunge il codice seguente alla sezione HEAD della pagina,</span><span class="sxs-lookup"><span data-stu-id="6988a-355">For example, if you add the following to your page's HEAD section,</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample18.html)]

<span data-ttu-id="6988a-356">…</span><span class="sxs-lookup"><span data-stu-id="6988a-356">…</span></span> <span data-ttu-id="6988a-357">il supporto dei browser per smartphone consiste quindi nel layout della pagina in un'area di disegno virtuale di 480 pixel.</span><span class="sxs-lookup"><span data-stu-id="6988a-357">then supporting smartphone browsers will lay out the page on a 480-pixel wide virtual canvas.</span></span> <span data-ttu-id="6988a-358">Ciò significa che se gli elementi HTML definiscono le larghezze in percentuale, le percentuali verranno interpretate rispetto alla larghezza di 480 pixel, non alla larghezza predefinita del viewport.</span><span class="sxs-lookup"><span data-stu-id="6988a-358">This means that if your HTML elements define their widths in percentage terms, the percentages will be interpreted with respect to this 480-pixel width, not the default viewport width.</span></span> <span data-ttu-id="6988a-359">Di conseguenza, è meno probabile che l'utente debba eseguire lo zoom e la panoramica orizzontalmente, migliorando notevolmente l'esperienza di esplorazione dei dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="6988a-359">As a result, the user is less likely to have to zoom and pan horizontally – considerably improving the mobile browsing experience.</span></span>

<span data-ttu-id="6988a-360">Se si vuole che la larghezza del viewport corrisponda ai pixel fisici del dispositivo, è possibile specificare quanto segue:</span><span class="sxs-lookup"><span data-stu-id="6988a-360">If you want the viewport width to match the device's physical pixels, you can specify the following:</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample19.html)]

<span data-ttu-id="6988a-361">Per il corretto funzionamento di questa operazione, non è necessario forzare in modo esplicito gli elementi a superare tale larghezza (ad esempio, usando un attributo *Width* o una proprietà CSS); in caso contrario, il browser verrà forzato a usare un viewport più grande indipendentemente.</span><span class="sxs-lookup"><span data-stu-id="6988a-361">For this to work correctly, you must not explicitly force elements to exceed that width (e.g., using a *width* attribute or CSS property), otherwise the browser will be forced to use a larger viewport regardless.</span></span> <span data-ttu-id="6988a-362">Vedere anche: [altre informazioni sul tag viewport non standard](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span><span class="sxs-lookup"><span data-stu-id="6988a-362">See also: [more details about the nonstandard viewport tag](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span></span>

<span data-ttu-id="6988a-363">La maggior parte degli smartphone moderni supporta il *doppio orientamento*: possono essere mantenuti in modalità verticale o orizzontale.</span><span class="sxs-lookup"><span data-stu-id="6988a-363">Most modern smartphones support *dual orientation*: they can be held in either portrait or landscape mode.</span></span> <span data-ttu-id="6988a-364">Pertanto, è importante non creare presupposti sulla larghezza dello schermo, in pixel.</span><span class="sxs-lookup"><span data-stu-id="6988a-364">So, it's important not to make assumptions about the screen width in pixels.</span></span> <span data-ttu-id="6988a-365">Non presupporre neanche che la larghezza dello schermo sia fissa, in quanto l'utente può riorientare il dispositivo mentre si trova nella pagina.</span><span class="sxs-lookup"><span data-stu-id="6988a-365">Don't even assume that the screen width is fixed, because the user can re-orient their device while they are on your page.</span></span>

<span data-ttu-id="6988a-366">I dispositivi Windows Mobile e BlackBerry meno recenti possono anche accettare i tag meta seguenti nell'intestazione di pagina per informare che il contenuto è stato ottimizzato per dispositivi mobili e pertanto non deve essere trasformato.</span><span class="sxs-lookup"><span data-stu-id="6988a-366">Older Windows Mobile and Blackberry devices may also accept the following meta tags in the page header to inform them content has been optimized for mobile and therefore should not be transformed.</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample20.html)]

## <a name="additional-resources"></a><span data-ttu-id="6988a-367">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="6988a-367">Additional Resources</span></span>

<span data-ttu-id="6988a-368">Per un elenco di emulatori e simulatori di dispositivi mobili che è possibile usare per testare l'applicazione Web ASP.NET per dispositivi mobili, vedere la pagina [simulare i dispositivi mobili più diffusi per i test](../mobile/device-simulators.md).</span><span class="sxs-lookup"><span data-stu-id="6988a-368">For a list of mobile device emulators and simulators you can use to test your mobile ASP.NET web application, see the page [Simulate popular mobile devices for testing](../mobile/device-simulators.md).</span></span>

## <a name="credits"></a><span data-ttu-id="6988a-369">Crediti</span><span class="sxs-lookup"><span data-stu-id="6988a-369">Credits</span></span>

- <span data-ttu-id="6988a-370">Autore primario: Steven Sanderson</span><span class="sxs-lookup"><span data-stu-id="6988a-370">Primary author: Steven Sanderson</span></span>
- <span data-ttu-id="6988a-371">Revisori/writer di contenuti aggiuntivi: James Rosewell, Mikael Söderström, Scott Hanselr, Scott Hunter</span><span class="sxs-lookup"><span data-stu-id="6988a-371">Reviewers / additional content writers: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span></span>
