---
uid: identity/overview/getting-started/aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider
title: "ASP.NET Identity: Uso dell'archiviazione MySQL con un Provider MySQL EntityFramework (C#)-ASP.NET 4.x"
author: maumar
description: Questa esercitazione illustra come sostituire il meccanismo di archiviazione di dati predefinito per ASP.NET Identity con Entity Framework (provider di SQL client) con un essere ampliati o ridotti di MySQL...
ms.author: riande
ms.date: 12/10/2013
ms.assetid: 15253312-a92c-43ba-908e-b5dacd3d08b8
ms.custom: seoapril2019
msc.legacyurl: /identity/overview/getting-started/aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider
msc.type: authoredcontent
ms.openlocfilehash: e89ed139657c5ce9ddcc56879946c62038919483
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/06/2019
ms.locfileid: "65121452"
---
# <a name="aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider-c"></a><span data-ttu-id="ac8b3-103">ASP.NET Identity: uso dell'archiviazione MySQL con un provider MySQL EntityFramework (C#)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-103">ASP.NET Identity: Using MySQL Storage with an EntityFramework MySQL Provider (C#)</span></span>

<span data-ttu-id="ac8b3-104">by [Maurycy Markowski](https://github.com/maumar), [Raquel Soares De Almeida](https://github.com/raquelsa), [Robert McMurray](https://github.com/rmcmurray)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-104">by [Maurycy Markowski](https://github.com/maumar), [Raquel Soares De Almeida](https://github.com/raquelsa), [Robert McMurray](https://github.com/rmcmurray)</span></span>

> <span data-ttu-id="ac8b3-105">Questa esercitazione illustra come sostituire il meccanismo di archiviazione di dati predefinito per [ **ASP.NET Identity** ](introduction-to-aspnet-identity.md) con Entity Framework (provider di SQL client) con un provider di MySQL.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-105">This tutorial shows you how to replace the default data storage mechanism for [**ASP.NET Identity**](introduction-to-aspnet-identity.md) with EntityFramework (SQL client provider) with a MySQL provider.</span></span>

<span data-ttu-id="ac8b3-106">In questa esercitazione verranno trattati gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-106">The following topics will be covered in this tutorial:</span></span>

- <span data-ttu-id="ac8b3-107">Creazione di un database MySQL in Azure</span><span class="sxs-lookup"><span data-stu-id="ac8b3-107">Creating a MySQL database on Azure</span></span>
- <span data-ttu-id="ac8b3-108">Creazione di un'applicazione MVC usando il modello MVC di Visual Studio 2013</span><span class="sxs-lookup"><span data-stu-id="ac8b3-108">Creating an MVC application using Visual Studio 2013 MVC template</span></span>
- <span data-ttu-id="ac8b3-109">Configurazione di Entity Framework per lavorare con un provider di database MySQL</span><span class="sxs-lookup"><span data-stu-id="ac8b3-109">Configuring EntityFramework to work with a MySQL database provider</span></span>
- <span data-ttu-id="ac8b3-110">Esecuzione dell'applicazione per verificare i risultati</span><span class="sxs-lookup"><span data-stu-id="ac8b3-110">Running the application to verify the results</span></span>

<span data-ttu-id="ac8b3-111">Al termine di questa esercitazione, si avrà un'applicazione MVC con ASP.NET Identity archiviare che utilizza un database MySQL in cui è ospitato in Azure.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-111">At the end of this tutorial, you will have an MVC application with the ASP.NET Identity store that is using a MySQL database that is hosted in Azure.</span></span>

## <a name="creating-a-mysql-database-instance-on-azure"></a><span data-ttu-id="ac8b3-112">Creazione di un'istanza di database MySQL in Azure</span><span class="sxs-lookup"><span data-stu-id="ac8b3-112">Creating a MySQL database instance on Azure</span></span>

1. <span data-ttu-id="ac8b3-113">Accedere al [portale di Azure](https://go.microsoft.com/fwlink/?linkid=529715&amp;clcid=0x409).</span><span class="sxs-lookup"><span data-stu-id="ac8b3-113">Log in to the [Azure Portal](https://go.microsoft.com/fwlink/?linkid=529715&amp;clcid=0x409).</span></span>
2. <span data-ttu-id="ac8b3-114">Fare clic su **NEW** nella parte inferiore della pagina e quindi selezionare **STORE**:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-114">Click **NEW** at the bottom of the page, and then select **STORE**:</span></span>

    [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image2.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image1.png)
3. <span data-ttu-id="ac8b3-115">Nel **Choose e componente aggiuntivo** procedura guidata, selezionare **ClearDB MySQL Database**e quindi fare clic sui **Avanti** freccia nella parte inferiore del frame:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-115">In the **Choose and Add-on** wizard, select **ClearDB MySQL Database**, and then click the **Next** arrow at the bottom of the frame:</span></span>

   <span data-ttu-id="ac8b3-116">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-116">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-117">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image4.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-117">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image4.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image3.png)</span></span>
4. <span data-ttu-id="ac8b3-118">Mantenere il valore predefinito **gratuito** pianificare, modificare il **nome** al **IdentityMySQLDatabase**, selezionare l'area più vicina all'utente e quindi fare clic su di **Avanti** freccia nella parte inferiore del frame:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-118">Keep the default **Free** plan, change the **NAME** to **IdentityMySQLDatabase**, select the region that is nearest to you, and then click the **Next** arrow at the bottom of the frame:</span></span>

   <span data-ttu-id="ac8b3-119">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-119">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-120">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image6.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-120">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image6.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image5.png)</span></span>
5. <span data-ttu-id="ac8b3-121">Scegliere il **acquisto** segno di spunta per completare la creazione del database.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-121">Click the **PURCHASE** checkmark to complete the database creation.</span></span>

   <span data-ttu-id="ac8b3-122">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-122">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-123">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image8.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-123">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image8.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image7.png)</span></span>
6. <span data-ttu-id="ac8b3-124">Dopo aver creato il database, è possibile gestirlo dal **ONS** scheda nel portale di gestione.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-124">After your database has been created, you can manage it from the **ADD-ONS** tab in the management portal.</span></span> <span data-ttu-id="ac8b3-125">Per recuperare le informazioni di connessione per il database, fare clic su **le informazioni di connessione** nella parte inferiore della pagina:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-125">To retrieve the connection information for your database, click **CONNECTION INFO** at the bottom of the page:</span></span>

   <span data-ttu-id="ac8b3-126">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-126">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-127">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image10.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-127">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image10.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image9.png)</span></span>
7. <span data-ttu-id="ac8b3-128">Copiare la stringa di connessione facendo clic sul pulsante Copia per il **CONNECTIONSTRING** campo e salvare il file, si userà queste informazioni più avanti in questa esercitazione per l'applicazione MVC:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-128">Copy the connection string by clicking on the copy button by the **CONNECTIONSTRING** field and save it; you will use this information later in this tutorial for your MVC application:</span></span>

   <span data-ttu-id="ac8b3-129">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-129">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-130">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image12.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-130">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image12.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image11.png)</span></span>

## <a name="creating-an-mvc-application-project"></a><span data-ttu-id="ac8b3-131">Creazione di un progetto di applicazione MVC</span><span class="sxs-lookup"><span data-stu-id="ac8b3-131">Creating an MVC application project</span></span>

<span data-ttu-id="ac8b3-132">Per completare la procedura descritta in questa sezione dell'esercitazione, è necessario innanzitutto installare [Visual Studio Express 2013 per il Web](https://go.microsoft.com/fwlink/?LinkId=299058) oppure [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span><span class="sxs-lookup"><span data-stu-id="ac8b3-132">To complete the steps in this section of the tutorial, you will first need to install [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span></span> <span data-ttu-id="ac8b3-133">Dopo aver installato Visual Studio, usare la procedura seguente per creare un nuovo progetto di applicazione MVC:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-133">Once Visual Studio has been installed, use the following steps to create a new MVC application project:</span></span>

1. <span data-ttu-id="ac8b3-134">Open Visual Studio 2103.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-134">Open Visual Studio 2103.</span></span>
2. <span data-ttu-id="ac8b3-135">Fare clic su **nuovo progetto** dal **avviare** pagina oppure è possibile fare clic sui **File** menu e quindi **nuovo progetto**:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-135">Click **New Project** from the **Start** page, or you can click the **File** menu and then **New Project**:</span></span>

   <span data-ttu-id="ac8b3-136">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-136">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-137">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image2.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-137">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image2.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image1.jpg)</span></span>
3. <span data-ttu-id="ac8b3-138">Quando la **nuovo progetto** verrà visualizzata la finestra di dialogo, espandere **Visual c#** nell'elenco dei modelli, quindi fare clic su **Web**e selezionare **applicazione Web ASP.NET**.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-138">When the **New Project** dialog box is displayed, expand **Visual C#** in the list of templates, then click **Web**, and select **ASP.NET Web Application**.</span></span> <span data-ttu-id="ac8b3-139">Denominare il progetto **IdentityMySQLDemo** e quindi fare clic su **OK**:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-139">Name your project **IdentityMySQLDemo** and then click **OK**:</span></span>

   <span data-ttu-id="ac8b3-140">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-140">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-141">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image14.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-141">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image14.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image13.png)</span></span>
4. <span data-ttu-id="ac8b3-142">Nel **nuovo progetto ASP.NET** finestra di dialogo, seleziona la **MVC** templatewith le opzioni predefinite; questo verrà configurare **account utente individuali** come metodo di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-142">In the **New ASP.NET Project** dialog, select the **MVC** templatewith the default options; this will configure **Individual User Accounts** as the authentication method.</span></span> <span data-ttu-id="ac8b3-143">Fare clic su **OK**:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-143">Click **OK**:</span></span>

   <span data-ttu-id="ac8b3-144">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-144">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-145">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image16.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-145">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image16.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image15.png)</span></span>

## <a name="configure-entityframework-to-work-with-a-mysql-database"></a><span data-ttu-id="ac8b3-146">Configurare Entity Framework per lavorare con un database MySQL</span><span class="sxs-lookup"><span data-stu-id="ac8b3-146">Configure EntityFramework to work with a MySQL database</span></span>

### <a name="update-the-entity-framework-assembly-for-your-project"></a><span data-ttu-id="ac8b3-147">Aggiornare l'assembly di Entity Framework per il progetto</span><span class="sxs-lookup"><span data-stu-id="ac8b3-147">Update the Entity Framework assembly for your project</span></span>

<span data-ttu-id="ac8b3-148">L'applicazione MVC che è stato creato dal modello di Visual Studio 2013 contiene un riferimento al [EntityFramework 6.0.0](http://www.nuget.org/packages/EntityFramework) del pacchetto, ma vi sono stati degli aggiornamenti a tale assembly fin dal suo rilascio contenenti significativo miglioramenti delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-148">The MVC application that was created from the Visual Studio 2013 template contains a reference to the [EntityFramework 6.0.0](http://www.nuget.org/packages/EntityFramework) package, but there have been updates to that assembly since its release which contain significant performance improvements.</span></span> <span data-ttu-id="ac8b3-149">Per usare questi aggiornamenti più recenti nell'applicazione, usare la procedura seguente.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-149">In order to use these latest updates in your application, use the following steps.</span></span>

1. <span data-ttu-id="ac8b3-150">Aprire il progetto MVC in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-150">Open your MVC project in Visual Studio.</span></span>
2. <span data-ttu-id="ac8b3-151">Fare clic su **strumenti**, quindi fare clic su **Gestione pacchetti NuGet**, quindi fare clic su **Console di Gestione pacchetti**:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-151">Click **Tools**, then click **NuGet Package Manager**, and then click **Package Manager Console**:</span></span>

   <span data-ttu-id="ac8b3-152">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-152">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-153">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image18.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-153">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image18.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image17.png)</span></span>
3. <span data-ttu-id="ac8b3-154">Il **Console di gestione pacchetti** verranno visualizzati nella parte inferiore di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-154">The **Package Manager Console** will appear in the bottom section of Visual Studio.</span></span> <span data-ttu-id="ac8b3-155">Tipo di &quot; **Update-Package EntityFramework** &quot; e premere INVIO:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-155">Type &quot;**Update-Package EntityFramework**&quot; and press Enter:</span></span>

   <span data-ttu-id="ac8b3-156">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-156">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-157">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image20.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-157">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image20.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image19.png)</span></span>

### <a name="install-the-mysql-provider-for-entityframework"></a><span data-ttu-id="ac8b3-158">Installare il provider di MySQL per Entity Framework</span><span class="sxs-lookup"><span data-stu-id="ac8b3-158">Install the MySQL provider for EntityFramework</span></span>

<span data-ttu-id="ac8b3-159">Affinché Entity Framework per connettersi al database MySQL, è necessario installare un provider di MySQL.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-159">In order for EntityFramework to connect to MySQL database, you need to install a MySQL provider.</span></span> <span data-ttu-id="ac8b3-160">A tale scopo, aprire il **Console di gestione pacchetti** e digitare &quot; **MySql.Data.Entity Install-Package - Pre**&quot;, quindi premere INVIO.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-160">To do so, open the **Package Manager Console** and type &quot;**Install-Package MySql.Data.Entity -Pre**&quot;, and then press Enter.</span></span>

> [!NOTE]
> <span data-ttu-id="ac8b3-161">Si tratta di una versione non definitiva dell'assembly e di conseguenza può contenere bug.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-161">This is a pre-release version of the assembly, and as such it may contain bugs.</span></span> <span data-ttu-id="ac8b3-162">Non si utilizzino una versione non definitiva del provider nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-162">You should not use a pre-release version of the provider in production.</span></span>

<span data-ttu-id="ac8b3-163">[Fare clic sull'immagine seguente per espanderlo.]</span><span class="sxs-lookup"><span data-stu-id="ac8b3-163">[Click the following image to expand it.]</span></span>

[![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image22.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image21.png)

### <a name="making-project-configuration-changes-to-the-webconfig-file-for-your-application"></a><span data-ttu-id="ac8b3-164">Apportare modifiche alla configurazione di progetto nel file Web. config per l'applicazione</span><span class="sxs-lookup"><span data-stu-id="ac8b3-164">Making project configuration changes to the Web.config file for your application</span></span>

<span data-ttu-id="ac8b3-165">In questa sezione che si configureranno di Entity Framework per utilizzare il provider di MySQL appena installata, registrare la factory del provider MySQL e aggiungere la stringa di connessione da Azure.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-165">In this section you will configure the Entity Framework to use the MySQL provider that you just installed, register the MySQL provider factory, and add your connection string from Azure.</span></span>

> [!NOTE]
> <span data-ttu-id="ac8b3-166">Negli esempi seguenti contengono una versione di assembly specifici per MySql.Data.dll.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-166">The following examples contain a specific assembly version for MySql.Data.dll.</span></span> <span data-ttu-id="ac8b3-167">Se la versione dell'assembly viene modificato, è necessario modificare le impostazioni di configurazione appropriato con la versione corretta.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-167">If the assembly version changes, you will need to modify the appropriate configuration settings with the correct version.</span></span>

1. <span data-ttu-id="ac8b3-168">Aprire il file Web. config per il progetto in Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-168">Open the Web.config file for your project in Visual Studio 2013.</span></span>
2. <span data-ttu-id="ac8b3-169">Individuare le impostazioni di configurazione seguente, che definiscono il provider di database predefinito e la factory per Entity Framework:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-169">Locate the following configuration settings, which define the default database provider and factory for the Entity Framework:</span></span>

    [!code-xml[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample1.xml)]
3. <span data-ttu-id="ac8b3-170">Sostituire le impostazioni di configurazione con il codice seguente, che verrà configurato di Entity Framework per utilizzare il provider di MySQL:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-170">Replace those configuration settings with the following, which will configure the Entity Framework to use the MySQL provider:</span></span>

    [!code-xml[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample2.xml)]
4. <span data-ttu-id="ac8b3-171">Individuare il &lt;connectionStrings&gt; sezione e sostituirlo con il codice seguente, che consentiranno di definire la stringa di connessione del database MySQL ospitato in Azure (si noti che il valore di providerName anche è stato modificato dal originale):</span><span class="sxs-lookup"><span data-stu-id="ac8b3-171">Locate the &lt;connectionStrings&gt; section and replace it with the following code, which will define the connection string for your MySQL database that is hosted on Azure (note that providerName value has also been changed from the original):</span></span>

    [!code-xml[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample3.xml?highlight=3-4)]

### <a name="adding-custom-migrationhistory-context"></a><span data-ttu-id="ac8b3-172">Aggiunta rapida MigrationHistory personalizzato</span><span class="sxs-lookup"><span data-stu-id="ac8b3-172">Adding custom MigrationHistory context</span></span>

<span data-ttu-id="ac8b3-173">Code First di Entity Framework Usa un **MigrationHistory** tabella per tenere traccia delle modifiche al modello e per garantire la coerenza tra lo schema di database e dello schema concettuale.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-173">Entity Framework Code First uses a **MigrationHistory** table to keep track of model changes and to ensure the consistency between the database schema and conceptual schema.</span></span> <span data-ttu-id="ac8b3-174">Tuttavia, questa tabella non funziona per MySQL per impostazione predefinita perché la chiave primaria è troppo grande.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-174">However, this table does not work for MySQL by default because the primary key is too large.</span></span> <span data-ttu-id="ac8b3-175">Per risolvere questo problema, è necessario compattare le dimensioni della chiave per la tabella.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-175">To remedy this situation, you will need to shrink the key size for that table.</span></span> <span data-ttu-id="ac8b3-176">A tale scopo, procedere come segue:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-176">To do so, use the following steps:</span></span>

1. <span data-ttu-id="ac8b3-177">Le informazioni sullo schema per questa tabella viene acquisite un **HistoryContext**, che può essere modificato come qualsiasi altra **DbContext**.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-177">The schema information for this table is captured in a **HistoryContext**, which can be modified as any other **DbContext**.</span></span> <span data-ttu-id="ac8b3-178">A tale scopo, aggiungere un nuovo file di classe denominato **MySqlHistoryContext.cs** al progetto e sostituirne il contenuto con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-178">To do so, add a new class file named **MySqlHistoryContext.cs** to the project, and replace its contents with the following code:</span></span>

    [!code-csharp[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample4.cs)]
2. <span data-ttu-id="ac8b3-179">Successivamente sarà necessario configurare Entity Framework per l'uso di modificata **HistoryContext**, invece di quello predefinito.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-179">Next you will need to configure Entity Framework to use the modified **HistoryContext**, rather than default one.</span></span> <span data-ttu-id="ac8b3-180">Questa operazione può essere eseguita sfruttando le funzionalità di configurazione basato sul codice.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-180">This can be done by leveraging code-based configuration features.</span></span> <span data-ttu-id="ac8b3-181">A tale scopo, aggiungere file di classe denominato **MySqlConfiguration.cs** al progetto e sostituirne il contenuto con:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-181">To do so, add new class file named **MySqlConfiguration.cs** to your project and replace its contents with:</span></span>

    [!code-csharp[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample5.cs)]

### <a name="creating-a-custom-entityframework-initializer-for-applicationdbcontext"></a><span data-ttu-id="ac8b3-182">Creazione di un inizializzatore personalizzato in EntityFramework per ApplicationDbContext</span><span class="sxs-lookup"><span data-stu-id="ac8b3-182">Creating a custom EntityFramework initializer for ApplicationDbContext</span></span>

<span data-ttu-id="ac8b3-183">Il provider di MySQL è disponibile in questa esercitazione non supporta attualmente le migrazioni di Entity Framework, pertanto sarà necessario usare gli inizializzatori del modello per la connessione al database.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-183">The MySQL provider that is featured in this tutorial does not currently support Entity Framework migrations, so you will need to use model initializers in order to connect to the database.</span></span> <span data-ttu-id="ac8b3-184">Poiché questa esercitazione Usa un'istanza di MySQL in Azure, è necessario creare un inizializzatore personalizzato in Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-184">Because this tutorial is using a MySQL instance on Azure, you will need to create a custom Entity Framework initializer.</span></span>

> [!NOTE]
> <span data-ttu-id="ac8b3-185">Questo passaggio non è necessario se ci si connette a un'istanza di SQL Server in Azure o se si usa un database in cui è ospitato in locale.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-185">This step is not required if you are connecting to a SQL Server instance on Azure or if you are using a database that is hosted on premises.</span></span>

<span data-ttu-id="ac8b3-186">Per creare un inizializzatore personalizzato in Entity Framework per MySQL, procedere come segue:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-186">To create a custom Entity Framework initializer for MySQL, use the following steps:</span></span>

1. <span data-ttu-id="ac8b3-187">Aggiungere un nuovo file di classe denominato **MySqlInitializer.cs** è per il progetto e sostituire il contenuto con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-187">Add a new class file named **MySqlInitializer.cs** to the project, and replace it's contents with the following code:</span></span>

    [!code-csharp[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample6.cs?highlight=23)]
2. <span data-ttu-id="ac8b3-188">Aprire il **IdentityModels.cs** file per il progetto, che si trova nella **modelli** directory e sostituire il contenuto con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-188">Open the **IdentityModels.cs** file for your project, which is located in the **Models** directory, and replace it's contents with the following:</span></span>

    [!code-csharp[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample7.cs)]

## <a name="running-the-application-and-verifying-the-database"></a><span data-ttu-id="ac8b3-189">Esecuzione dell'applicazione e verifica del database</span><span class="sxs-lookup"><span data-stu-id="ac8b3-189">Running the application and verifying the database</span></span>

<span data-ttu-id="ac8b3-190">Dopo aver completato i passaggi nelle sezioni precedenti, è consigliabile testare il database.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-190">Once you have completed the steps in the preceding sections, you should test your database.</span></span> <span data-ttu-id="ac8b3-191">A tale scopo, procedere come segue:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-191">To do so, use the following steps:</span></span>

1. <span data-ttu-id="ac8b3-192">Premere **Ctrl + F5** per compilare ed eseguire l'applicazione web.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-192">Press **Ctrl + F5** to build and run the web application.</span></span>
2. <span data-ttu-id="ac8b3-193">Scegliere il **registrare** scheda nella parte superiore della pagina:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-193">Click the **Register** tab on the top of the page:</span></span>

   <span data-ttu-id="ac8b3-194">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-194">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-195">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image4.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image3.jpg)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-195">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image4.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image3.jpg)</span></span>
3. <span data-ttu-id="ac8b3-196">Immettere un nuovo nome utente e una password e quindi fare clic su **registrare**:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-196">Enter a new user name and password, and then click **Register**:</span></span>

   <span data-ttu-id="ac8b3-197">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-197">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-198">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image24.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-198">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image24.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image23.png)</span></span>
4. <span data-ttu-id="ac8b3-199">A questo punto vengono create le tabelle di ASP.NET Identity nel Database di MySQL, e l'utente è registrato e connesso all'applicazione:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-199">At this point the ASP.NET Identity tables are created on the MySQL Database, and the user is registered and logged into the application:</span></span>

   <span data-ttu-id="ac8b3-200">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-200">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-201">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image6.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image5.jpg)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-201">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image6.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image5.jpg)</span></span>

### <a name="installing-mysql-workbench-tool-to-verify-the-data"></a><span data-ttu-id="ac8b3-202">Installazione dello strumento MySQL Workbench per verificare i dati</span><span class="sxs-lookup"><span data-stu-id="ac8b3-202">Installing MySQL Workbench tool to verify the data</span></span>

1. <span data-ttu-id="ac8b3-203">Installare il **MySQL Workbench** dello strumento di [pagina di download di MySQL](http://dev.mysql.com/downloads/windows/installer/)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-203">Install the **MySQL Workbench** tool from the [MySQL downloads page](http://dev.mysql.com/downloads/windows/installer/)</span></span>
2. <span data-ttu-id="ac8b3-204">Nell'installazione guidata: **Selezione delle caratteristiche** scheda, seleziona **MySQL Workbench** sotto **applicazioni** sezione.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-204">In the installation wizard: **Feature Selection** tab, select **MySQL Workbench** under **applications** section.</span></span>
3. <span data-ttu-id="ac8b3-205">Avviare l'app e aggiungere una nuova connessione utilizzando i dati di stringa di connessione del database MySQL di Azure creato al colmare questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-205">Launch the app and add a new connection using the connection string data from the Azure MySQL database you created at the begging of this tutorial.</span></span>
4. <span data-ttu-id="ac8b3-206">Dopo avere stabilito la connessione, esaminare i **ASP.NET Identity** le tabelle create nel **IdentityMySQLDatabase.**</span><span class="sxs-lookup"><span data-stu-id="ac8b3-206">After establishing the connection, inspect the **ASP.NET Identity** tables created on the **IdentityMySQLDatabase.**</span></span>
5. <span data-ttu-id="ac8b3-207">Si noterà che tutte le identità di ASP.NET richiesto le tabelle vengono create come illustrato nell'immagine seguente:</span><span class="sxs-lookup"><span data-stu-id="ac8b3-207">You will see that all ASP.NET Identity required tables are created as shown in the image below:</span></span>

   <span data-ttu-id="ac8b3-208">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-208">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-209">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image8.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image7.jpg)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-209">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image8.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image7.jpg)</span></span>
6. <span data-ttu-id="ac8b3-210">Esaminare i **aspnetusers** ad esempio di tabella per cercare le voci di registrazione di nuovi utenti.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-210">Inspect the **aspnetusers** table for instance to check for the entries as you register new users.</span></span>

   <span data-ttu-id="ac8b3-211">[Fare clic sull'immagine seguente per espanderlo.</span><span class="sxs-lookup"><span data-stu-id="ac8b3-211">[Click the following image to expand it.</span></span> <span data-ttu-id="ac8b3-212">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image26.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ac8b3-212">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image26.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image25.png)</span></span>
