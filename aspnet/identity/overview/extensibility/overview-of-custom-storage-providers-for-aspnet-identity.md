---
uid: identity/overview/extensibility/overview-of-custom-storage-providers-for-aspnet-identity
title: Panoramica dei provider di archiviazione personalizzati per ASP.NET Identity-ASP.NET 4. x
author: Rick-Anderson
description: ASP.NET Identity è un sistema estensibile che consente di creare un provider di archiviazione personalizzato e di inserirlo nell'applicazione senza rielaborare l'applicazione...
ms.author: riande
ms.date: 10/13/2014
ms.assetid: 681a9204-462e-4260-9a0b-19f0644d6ad7
ms.custom: seoapril2019
msc.legacyurl: /identity/overview/extensibility/overview-of-custom-storage-providers-for-aspnet-identity
msc.type: authoredcontent
ms.openlocfilehash: 21baedf6285b411f89627df9ca25d47a2a42e387
ms.sourcegitcommit: 88fc80e3f65aebdf61ec9414810ddbc31c543f04
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/22/2020
ms.locfileid: "76519102"
---
# <a name="overview-of-custom-storage-providers-for-aspnet-identity"></a><span data-ttu-id="c04e1-103">Panoramica dei provider di archiviazione personalizzati per ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="c04e1-103">Overview of Custom Storage Providers for ASP.NET Identity</span></span>

<span data-ttu-id="c04e1-104">da [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="c04e1-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="c04e1-105">ASP.NET Identity è un sistema estensibile che consente di creare un provider di archiviazione personalizzato e di inserirlo nell'applicazione senza riutilizzare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c04e1-105">ASP.NET Identity is an extensible system which enables you to create your own storage provider and plug it into your application without re-working the application.</span></span> <span data-ttu-id="c04e1-106">In questo argomento viene descritto come creare un provider di archiviazione personalizzato per ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="c04e1-106">This topic describes how to create a customized storage provider for ASP.NET Identity.</span></span> <span data-ttu-id="c04e1-107">Vengono illustrati i concetti importanti per la creazione di un provider di archiviazione personalizzato, ma non si tratta di una procedura dettagliata per l'implementazione di un provider di archiviazione personalizzato.</span><span class="sxs-lookup"><span data-stu-id="c04e1-107">It covers the important concepts for creating your own storage provider, but it is not step-by-step walkthrough of implementing a custom storage provider.</span></span>
> 
> <span data-ttu-id="c04e1-108">Per un esempio di implementazione di un provider di archiviazione personalizzato, vedere [implementazione di un provider di archiviazione MySQL ASP.NET Identity personalizzato](implementing-a-custom-mysql-aspnet-identity-storage-provider.md).</span><span class="sxs-lookup"><span data-stu-id="c04e1-108">For an example of implementing a custom storage provider, see [Implementing a Custom MySQL ASP.NET Identity Storage Provider](implementing-a-custom-mysql-aspnet-identity-storage-provider.md).</span></span>
> 
> <span data-ttu-id="c04e1-109">Questo argomento è stato aggiornato per ASP.NET Identity 2,0.</span><span class="sxs-lookup"><span data-stu-id="c04e1-109">This topic was updated for ASP.NET Identity 2.0.</span></span>
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="c04e1-110">Versioni del software usate nell'esercitazione</span><span class="sxs-lookup"><span data-stu-id="c04e1-110">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="c04e1-111">Visual Studio 2013 con Update 2</span><span class="sxs-lookup"><span data-stu-id="c04e1-111">Visual Studio 2013 with Update 2</span></span>
> - <span data-ttu-id="c04e1-112">ASP.NET Identity 2</span><span class="sxs-lookup"><span data-stu-id="c04e1-112">ASP.NET Identity 2</span></span>

## <a name="introduction"></a><span data-ttu-id="c04e1-113">Introduzione</span><span class="sxs-lookup"><span data-stu-id="c04e1-113">Introduction</span></span>

<span data-ttu-id="c04e1-114">Per impostazione predefinita, il sistema ASP.NET Identity archivia le informazioni sugli utenti in un database SQL Server e USA Entity Framework Code First per creare il database.</span><span class="sxs-lookup"><span data-stu-id="c04e1-114">By default, the ASP.NET Identity system stores user information in a SQL Server database, and uses Entity Framework Code First to create the database.</span></span> <span data-ttu-id="c04e1-115">Per molte applicazioni, questo approccio funziona correttamente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-115">For many applications, this approach works well.</span></span> <span data-ttu-id="c04e1-116">Tuttavia, è preferibile usare un tipo diverso di meccanismo di persistenza, ad esempio l'archiviazione tabelle di Azure, oppure è possibile che si disponga già di tabelle di database con una struttura molto diversa rispetto all'implementazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="c04e1-116">However, you may prefer to use a different type of persistence mechanism, such as Azure Table Storage, or you may already have database tables with a very different structure than the default implementation.</span></span> <span data-ttu-id="c04e1-117">In entrambi i casi, è possibile scrivere un provider personalizzato per il meccanismo di archiviazione e collegare tale provider nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c04e1-117">In either case, you can write a customized provider for your storage mechanism and plug that provider into your application.</span></span>

<span data-ttu-id="c04e1-118">ASP.NET Identity è incluso per impostazione predefinita in molti dei modelli di Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="c04e1-118">ASP.NET Identity is included by default in many of the Visual Studio 2013 templates.</span></span> <span data-ttu-id="c04e1-119">È possibile ottenere gli aggiornamenti ASP.NET Identity tramite il [pacchetto NuGet Microsoft ASPNET Identity EntityFramework](http://www.nuget.org/packages/Microsoft.AspNet.Identity.EntityFramework/).</span><span class="sxs-lookup"><span data-stu-id="c04e1-119">You can get updates to ASP.NET Identity through [Microsoft AspNet Identity EntityFramework NuGet package](http://www.nuget.org/packages/Microsoft.AspNet.Identity.EntityFramework/).</span></span>

<span data-ttu-id="c04e1-120">In questo argomento sono incluse le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="c04e1-120">This topic includes the following sections:</span></span>

- [<span data-ttu-id="c04e1-121">Informazioni sull'architettura</span><span class="sxs-lookup"><span data-stu-id="c04e1-121">Understand the architecture</span></span>](#architecture)
- [<span data-ttu-id="c04e1-122">Informazioni sui dati archiviati</span><span class="sxs-lookup"><span data-stu-id="c04e1-122">Understand the data that is stored</span></span>](#data)
- [<span data-ttu-id="c04e1-123">Creare il livello di accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="c04e1-123">Create the data access layer</span></span>](#dal)
- [<span data-ttu-id="c04e1-124">Personalizzare la classe utente</span><span class="sxs-lookup"><span data-stu-id="c04e1-124">Customize the user class</span></span>](#user)
- [<span data-ttu-id="c04e1-125">Personalizzare l'archivio utenti</span><span class="sxs-lookup"><span data-stu-id="c04e1-125">Customize the user store</span></span>](#userstore)
- [<span data-ttu-id="c04e1-126">Personalizzare la classe Role</span><span class="sxs-lookup"><span data-stu-id="c04e1-126">Customize the role class</span></span>](#role)
- [<span data-ttu-id="c04e1-127">Personalizzare l'archivio dei ruoli</span><span class="sxs-lookup"><span data-stu-id="c04e1-127">Customize the role store</span></span>](#rolestore)
- [<span data-ttu-id="c04e1-128">Riconfigurare l'applicazione per l'uso di un nuovo provider di archiviazione</span><span class="sxs-lookup"><span data-stu-id="c04e1-128">Reconfigure application to use new storage provider</span></span>](#reconfigure)
- [<span data-ttu-id="c04e1-129">Altre implementazioni dei provider di archiviazione personalizzati</span><span class="sxs-lookup"><span data-stu-id="c04e1-129">Other implementations of custom storage providers</span></span>](#other)

<a id="architecture"></a>
## <a name="understand-the-architecture"></a><span data-ttu-id="c04e1-130">Informazioni sull'architettura</span><span class="sxs-lookup"><span data-stu-id="c04e1-130">Understand the architecture</span></span>

<span data-ttu-id="c04e1-131">ASP.NET Identity è costituito da classi denominate Manager e archivi.</span><span class="sxs-lookup"><span data-stu-id="c04e1-131">ASP.NET Identity consists of classes called managers and stores.</span></span> <span data-ttu-id="c04e1-132">I responsabili sono classi generali che uno sviluppatore di applicazioni usa per eseguire operazioni, ad esempio la creazione di un utente, nel sistema di ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="c04e1-132">Managers are high-level classes which an application developer uses to perform operations, such as creating a user, in the ASP.NET Identity system.</span></span> <span data-ttu-id="c04e1-133">Gli archivi sono classi di livello inferiore che specificano il modo in cui le entità, ad esempio utenti e ruoli, vengono rese permanente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-133">Stores are lower-level classes that specify how entities, such as users and roles, are persisted.</span></span> <span data-ttu-id="c04e1-134">Gli archivi sono strettamente collegati al meccanismo di persistenza, ma i responsabili sono separati dai negozi, il che significa che è possibile sostituire il meccanismo di persistenza senza compromettere l'intera applicazione.</span><span class="sxs-lookup"><span data-stu-id="c04e1-134">Stores are closely coupled with the persistence mechanism, but managers are decoupled from stores which means you can replace the persistence mechanism without disrupting the entire application.</span></span>

<span data-ttu-id="c04e1-135">Il diagramma seguente illustra il modo in cui l'applicazione Web interagisce con i Manager e gli archivi interagiscono con il livello di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="c04e1-135">The following diagram shows how your web application interacts with the managers, and stores interact with the data access layer.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image1.png)

<span data-ttu-id="c04e1-136">Per creare un provider di archiviazione personalizzato per ASP.NET Identity, è necessario creare l'origine dati, il livello di accesso ai dati e le classi di archivio che interagiscono con questo livello di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="c04e1-136">To create a customized storage provider for ASP.NET Identity, you have to create the data source, the data access layer, and the store classes that interact with this data access layer.</span></span> <span data-ttu-id="c04e1-137">È possibile continuare a utilizzare le stesse API di gestione per eseguire operazioni sui dati dell'utente, ma ora i dati vengono salvati in un sistema di archiviazione diverso.</span><span class="sxs-lookup"><span data-stu-id="c04e1-137">You can continue using the same manager APIs to perform data operations on the user but now that data is saved to a different storage system.</span></span>

<span data-ttu-id="c04e1-138">Non è necessario personalizzare le classi Manager perché quando si crea una nuova istanza di UserManager o RoleManager si fornisce il tipo della classe utente e si passa un'istanza della classe Store come argomento.</span><span class="sxs-lookup"><span data-stu-id="c04e1-138">You do not need to customize the manager classes because when creating a new instance of UserManager or RoleManager you provide the type of the user class and pass an instance of the store class as an argument.</span></span> <span data-ttu-id="c04e1-139">Questo approccio consente di collegare le classi personalizzate alla struttura esistente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-139">This approach enables you to plug your customized classes into the existing structure.</span></span> <span data-ttu-id="c04e1-140">Si vedrà come creare un'istanza di UserManager e RoleManager con le classi di archivio personalizzate nella sezione [riconfigurare l'applicazione per usare il nuovo provider di archiviazione](#reconfigure).</span><span class="sxs-lookup"><span data-stu-id="c04e1-140">You will see how to instantiate UserManager and RoleManager with your customized store classes in the section [Reconfigure application to use new storage provider](#reconfigure).</span></span>

<a id="data"></a>
## <a name="understand-the-data-that-is-stored"></a><span data-ttu-id="c04e1-141">Informazioni sui dati archiviati</span><span class="sxs-lookup"><span data-stu-id="c04e1-141">Understand the data that is stored</span></span>

<span data-ttu-id="c04e1-142">Per implementare un provider di archiviazione personalizzato, è necessario comprendere i tipi di dati utilizzati con ASP.NET Identity e decidere quali funzionalità sono rilevanti per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c04e1-142">To implement a custom storage provider, you must understand the types of data used with ASP.NET Identity, and decide which features are relevant to your application.</span></span>

| <span data-ttu-id="c04e1-143">Data</span><span class="sxs-lookup"><span data-stu-id="c04e1-143">Data</span></span> | <span data-ttu-id="c04e1-144">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c04e1-144">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c04e1-145">Utenti di</span><span class="sxs-lookup"><span data-stu-id="c04e1-145">Users</span></span> | <span data-ttu-id="c04e1-146">Utenti registrati del sito Web.</span><span class="sxs-lookup"><span data-stu-id="c04e1-146">Registered users of your web site.</span></span> <span data-ttu-id="c04e1-147">Include l'ID utente e il nome utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-147">Includes the user Id and user name.</span></span> <span data-ttu-id="c04e1-148">Potrebbe includere una password con hash se gli utenti eseguono l'accesso con credenziali specifiche per il sito (invece di usare le credenziali di un sito esterno come Facebook) e l'indicatore di sicurezza per indicare se sono state apportate modifiche alle credenziali utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-148">Might include a hashed password if users log in with credentials that are specific to your site (rather than using credentials from an external site like Facebook), and security stamp to indicate whether anything has changed in the user credentials.</span></span> <span data-ttu-id="c04e1-149">Potrebbe includere anche l'indirizzo di posta elettronica, il numero di telefono, se è abilitata l'autenticazione a due fattori, il numero corrente di accessi non riusciti e se un account è stato bloccato.</span><span class="sxs-lookup"><span data-stu-id="c04e1-149">Might also include email address, phone number, whether two factor authentication is enabled, the current number of failed logins, and whether an account has been locked.</span></span> |
| <span data-ttu-id="c04e1-150">Attestazioni utente</span><span class="sxs-lookup"><span data-stu-id="c04e1-150">User Claims</span></span> | <span data-ttu-id="c04e1-151">Set di istruzioni (o attestazioni) sull'utente che rappresenta l'identità dell'utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-151">A set of statements (or claims) about the user that represent the user's identity.</span></span> <span data-ttu-id="c04e1-152">Consente di abilitare un'espressione maggiore dell'identità dell'utente che può essere eseguita tramite i ruoli.</span><span class="sxs-lookup"><span data-stu-id="c04e1-152">Can enable greater expression of the user's identity than can be achieved through roles.</span></span> |
| <span data-ttu-id="c04e1-153">Account di accesso utente</span><span class="sxs-lookup"><span data-stu-id="c04e1-153">User Logins</span></span> | <span data-ttu-id="c04e1-154">Informazioni sul provider di autenticazione esterno, ad esempio Facebook, da usare per la registrazione in un utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-154">Information about the external authentication provider (like Facebook) to use when logging in a user.</span></span> |
| <span data-ttu-id="c04e1-155">Ruoli di</span><span class="sxs-lookup"><span data-stu-id="c04e1-155">Roles</span></span> | <span data-ttu-id="c04e1-156">Gruppi di autorizzazione per il sito.</span><span class="sxs-lookup"><span data-stu-id="c04e1-156">Authorization groups for your site.</span></span> <span data-ttu-id="c04e1-157">Include l'ID del ruolo e il nome del ruolo (ad esempio, "admin" o "Employee").</span><span class="sxs-lookup"><span data-stu-id="c04e1-157">Includes the role Id and role name (like "Admin" or "Employee").</span></span> |

<a id="dal"></a>
## <a name="create-the-data-access-layer"></a><span data-ttu-id="c04e1-158">Creare il livello di accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="c04e1-158">Create the data access layer</span></span>

<span data-ttu-id="c04e1-159">In questo argomento si presuppone che l'utente abbia familiarità con il meccanismo di persistenza che si intende usare e come creare entità per tale meccanismo.</span><span class="sxs-lookup"><span data-stu-id="c04e1-159">This topic assumes you are familiar with the persistence mechanism that you are going to use and how to create entities for that mechanism.</span></span> <span data-ttu-id="c04e1-160">In questo argomento non vengono fornite informazioni dettagliate su come creare i repository o le classi di accesso ai dati. al contrario, vengono forniti alcuni suggerimenti sulle decisioni di progettazione che è necessario apportare quando si lavora con ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="c04e1-160">This topic does not provide details about how to create the repositories or data access classes; instead, it provides some suggestions about the design decisions you need to make when working with ASP.NET Identity.</span></span>

<span data-ttu-id="c04e1-161">Quando si progettano i repository per un provider di archiviazione personalizzato, è possibile avere una grande libertà.</span><span class="sxs-lookup"><span data-stu-id="c04e1-161">You have a lot of freedom when designing the repositories for a customized store provider.</span></span> <span data-ttu-id="c04e1-162">È sufficiente creare repository per le funzionalità che si intende usare nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c04e1-162">You only need to create repositories for features that you intend to use in your application.</span></span> <span data-ttu-id="c04e1-163">Se, ad esempio, non si utilizzano ruoli nell'applicazione, non è necessario creare spazio di archiviazione per ruoli o ruoli utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-163">For example, if you are not using roles in your application, you do not need to create storage for roles or user roles.</span></span> <span data-ttu-id="c04e1-164">La tecnologia e l'infrastruttura esistente possono richiedere una struttura molto diversa dall'implementazione predefinita di ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="c04e1-164">Your technology and existing infrastructure may require a structure that is very different from the default implementation of ASP.NET Identity.</span></span> <span data-ttu-id="c04e1-165">Nel livello di accesso ai dati fornire la logica per lavorare con la struttura dei repository.</span><span class="sxs-lookup"><span data-stu-id="c04e1-165">In your data access layer, you provide the logic to work with the structure of your repositories.</span></span>

<span data-ttu-id="c04e1-166">Per un'implementazione MySQL di repository di dati per ASP.NET Identity 2,0, vedere [MySQLIdentity. SQL](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/MySQLIdentity.sql).</span><span class="sxs-lookup"><span data-stu-id="c04e1-166">For a MySQL implementation of data repositories for ASP.NET Identity 2.0, see [MySQLIdentity.sql](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/MySQLIdentity.sql).</span></span>

<span data-ttu-id="c04e1-167">Nel livello di accesso ai dati fornire la logica per salvare i dati da ASP.NET Identity all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="c04e1-167">In the data access layer, you provide the logic to save the data from ASP.NET Identity to your data source.</span></span> <span data-ttu-id="c04e1-168">Il livello di accesso ai dati per il provider di archiviazione personalizzato potrebbe includere le classi seguenti per archiviare le informazioni relative a utenti e ruoli.</span><span class="sxs-lookup"><span data-stu-id="c04e1-168">The data access layer for your customized storage provider might include the following classes to store user and role information.</span></span>

| <span data-ttu-id="c04e1-169">Classe</span><span class="sxs-lookup"><span data-stu-id="c04e1-169">Class</span></span> | <span data-ttu-id="c04e1-170">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c04e1-170">Description</span></span> | <span data-ttu-id="c04e1-171">Esempio</span><span class="sxs-lookup"><span data-stu-id="c04e1-171">Example</span></span> |
| --- | --- | --- |
| <span data-ttu-id="c04e1-172">Contesto</span><span class="sxs-lookup"><span data-stu-id="c04e1-172">Context</span></span> | <span data-ttu-id="c04e1-173">Incapsula le informazioni per la connessione al meccanismo di persistenza e l'esecuzione di query.</span><span class="sxs-lookup"><span data-stu-id="c04e1-173">Encapsulates the information to connect to your persistence mechanism and execute queries.</span></span> <span data-ttu-id="c04e1-174">Questa classe è fondamentale per il livello di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="c04e1-174">This class is central to your data access layer.</span></span> <span data-ttu-id="c04e1-175">Per le altre classi di dati è necessaria un'istanza di questa classe per eseguire le operazioni.</span><span class="sxs-lookup"><span data-stu-id="c04e1-175">The other data classes will require an instance of this class to perform their operations.</span></span> <span data-ttu-id="c04e1-176">Si inizializzano inoltre le classi dell'archivio con un'istanza di questa classe.</span><span class="sxs-lookup"><span data-stu-id="c04e1-176">You will also initialize your store classes with an instance of this class.</span></span> | [<span data-ttu-id="c04e1-177">MySQLDatabase</span><span class="sxs-lookup"><span data-stu-id="c04e1-177">MySQLDatabase</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/MySQLDatabase.cs) |
| <span data-ttu-id="c04e1-178">Archiviazione utente</span><span class="sxs-lookup"><span data-stu-id="c04e1-178">User Storage</span></span> | <span data-ttu-id="c04e1-179">Archivia e recupera le informazioni utente, ad esempio il nome utente e l'hash della password.</span><span class="sxs-lookup"><span data-stu-id="c04e1-179">Stores and retrieves user information (such as user name and password hash).</span></span> | [<span data-ttu-id="c04e1-180">UserTable (MySQL)</span><span class="sxs-lookup"><span data-stu-id="c04e1-180">UserTable (MySQL)</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserTable.cs) |
| <span data-ttu-id="c04e1-181">Archiviazione del ruolo</span><span class="sxs-lookup"><span data-stu-id="c04e1-181">Role Storage</span></span> | <span data-ttu-id="c04e1-182">Archivia e recupera le informazioni sui ruoli, ad esempio il nome del ruolo.</span><span class="sxs-lookup"><span data-stu-id="c04e1-182">Stores and retrieves role information (such as the role name).</span></span> | [<span data-ttu-id="c04e1-183">RoleTable (MySQL)</span><span class="sxs-lookup"><span data-stu-id="c04e1-183">RoleTable (MySQL)</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/RoleTable.cs) |
| <span data-ttu-id="c04e1-184">Archiviazione UserClaims</span><span class="sxs-lookup"><span data-stu-id="c04e1-184">UserClaims Storage</span></span> | <span data-ttu-id="c04e1-185">Archivia e recupera le informazioni sull'attestazione utente, ad esempio il tipo di attestazione e il valore.</span><span class="sxs-lookup"><span data-stu-id="c04e1-185">Stores and retrieves user claim information (such as the claim type and value).</span></span> | [<span data-ttu-id="c04e1-186">UserClaimsTable (MySQL)</span><span class="sxs-lookup"><span data-stu-id="c04e1-186">UserClaimsTable (MySQL)</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserClaimsTable.cs) |
| <span data-ttu-id="c04e1-187">Archiviazione UserLogins</span><span class="sxs-lookup"><span data-stu-id="c04e1-187">UserLogins Storage</span></span> | <span data-ttu-id="c04e1-188">Archivia e recupera le informazioni di accesso dell'utente, ad esempio un provider di autenticazione esterno.</span><span class="sxs-lookup"><span data-stu-id="c04e1-188">Stores and retrieves user login information (such as an external authentication provider).</span></span> | [<span data-ttu-id="c04e1-189">UserLoginsTable (MySQL)</span><span class="sxs-lookup"><span data-stu-id="c04e1-189">UserLoginsTable (MySQL)</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserLoginsTable.cs) |
| <span data-ttu-id="c04e1-190">Archiviazione UserRole</span><span class="sxs-lookup"><span data-stu-id="c04e1-190">UserRole Storage</span></span> | <span data-ttu-id="c04e1-191">Archivia e recupera i ruoli assegnati a un utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-191">Stores and retrieves which roles a user is assigned to.</span></span> | [<span data-ttu-id="c04e1-192">UserRoleTable (MySQL)</span><span class="sxs-lookup"><span data-stu-id="c04e1-192">UserRoleTable (MySQL)</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserRoleTable.cs) |

<span data-ttu-id="c04e1-193">Anche in questo caso, è necessario implementare solo le classi che si intende usare nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c04e1-193">Again, you only need to implement the classes that you intend to use in your application.</span></span>

<span data-ttu-id="c04e1-194">Nelle classi di accesso ai dati si fornisce il codice per eseguire operazioni sui dati per il meccanismo di persistenza specifico.</span><span class="sxs-lookup"><span data-stu-id="c04e1-194">In the data access classes, you provide code to perform data operations for your particular persistence mechanism.</span></span> <span data-ttu-id="c04e1-195">All'interno dell'implementazione di MySQL, ad esempio, la classe UserTable contiene un metodo per inserire un nuovo record nella tabella di database users.</span><span class="sxs-lookup"><span data-stu-id="c04e1-195">For example, within the MySQL implementation, the UserTable class contains a method to insert a new record into the Users database table.</span></span> <span data-ttu-id="c04e1-196">La variabile denominata `_database` è un'istanza della classe MySQLDatabase.</span><span class="sxs-lookup"><span data-stu-id="c04e1-196">The variable named `_database` is an instance of the MySQLDatabase class.</span></span>

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample1.cs)]

<span data-ttu-id="c04e1-197">Dopo aver creato le classi di accesso ai dati, è necessario creare classi di archivio che chiamano i metodi specifici nel livello di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="c04e1-197">After creating your data access classes, you must create store classes that call the specific methods in the data access layer.</span></span>

<a id="user"></a>
## <a name="customize-the-user-class"></a><span data-ttu-id="c04e1-198">Personalizzare la classe utente</span><span class="sxs-lookup"><span data-stu-id="c04e1-198">Customize the user class</span></span>

<span data-ttu-id="c04e1-199">Quando si implementa un provider di archiviazione personalizzato, è necessario creare una classe utente equivalente alla classe [IdentityUser](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework.identityuser(v=vs.108).aspx) nello spazio dei nomi [Microsoft. ASP. NET. Identity. EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) :</span><span class="sxs-lookup"><span data-stu-id="c04e1-199">When implementing your own storage provider, you must create a user class which is equivalent to the [IdentityUser](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework.identityuser(v=vs.108).aspx) class in the [Microsoft.ASP.NET.Identity.EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) namespace:</span></span>

<span data-ttu-id="c04e1-200">Il diagramma seguente illustra la classe IdentityUser che è necessario creare e l'interfaccia da implementare in questa classe.</span><span class="sxs-lookup"><span data-stu-id="c04e1-200">The following diagram shows the IdentityUser class that you must create and the interface to implement in this class.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image2.png)

<span data-ttu-id="c04e1-201">L'interfaccia [IUser&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613291(v=vs.108).aspx) definisce le proprietà che il usermanager tenta di chiamare durante l'esecuzione delle operazioni richieste.</span><span class="sxs-lookup"><span data-stu-id="c04e1-201">The [IUser&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613291(v=vs.108).aspx) interface defines the properties that the UserManager attempts to call when performing requested operations.</span></span> <span data-ttu-id="c04e1-202">L'interfaccia contiene due proprietà-ID e UserName.</span><span class="sxs-lookup"><span data-stu-id="c04e1-202">The interface contains two properties - Id and UserName.</span></span> <span data-ttu-id="c04e1-203">L'interfaccia [IUser&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613291(v=vs.108).aspx) consente di specificare il tipo di chiave per l'utente tramite il parametro generico **TKey** .</span><span class="sxs-lookup"><span data-stu-id="c04e1-203">The [IUser&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613291(v=vs.108).aspx) interface enables you to specify the type of the key for the user through the generic **TKey** parameter.</span></span> <span data-ttu-id="c04e1-204">Il tipo della proprietà ID corrisponde al valore del parametro TKey.</span><span class="sxs-lookup"><span data-stu-id="c04e1-204">The type of the Id property matches the value of the TKey parameter.</span></span>

<span data-ttu-id="c04e1-205">Il Framework di identità fornisce anche l'interfaccia [IUser](https://msdn.microsoft.com/library/microsoft.aspnet.identity.iuser(v=vs.108).aspx) (senza il parametro generico) quando si vuole usare un valore stringa per la chiave.</span><span class="sxs-lookup"><span data-stu-id="c04e1-205">The Identity framework also provides the [IUser](https://msdn.microsoft.com/library/microsoft.aspnet.identity.iuser(v=vs.108).aspx) interface (without the generic parameter) when you want to use a string value for the key.</span></span>

<span data-ttu-id="c04e1-206">La classe IdentityUser implementa IUser e contiene proprietà o costruttori aggiuntivi per gli utenti sul sito Web.</span><span class="sxs-lookup"><span data-stu-id="c04e1-206">The IdentityUser class implements IUser and contains any additional properties or constructors for users on your web site.</span></span> <span data-ttu-id="c04e1-207">Nell'esempio seguente viene illustrata una classe IdentityUser che usa un numero intero per la chiave.</span><span class="sxs-lookup"><span data-stu-id="c04e1-207">The following example shows an IdentityUser class that uses an integer for the key.</span></span> <span data-ttu-id="c04e1-208">Il campo ID è impostato su **int** in modo che corrisponda al valore del parametro generico.</span><span class="sxs-lookup"><span data-stu-id="c04e1-208">The Id field is set to **int** to match the value of the generic parameter.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample2.cs)]

 <span data-ttu-id="c04e1-209">Per un'implementazione completa, vedere [IdentityUser (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/IdentityUser.cs).</span><span class="sxs-lookup"><span data-stu-id="c04e1-209">For a complete implementation, see [IdentityUser (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/IdentityUser.cs).</span></span> 

<a id="userstore"></a>
## <a name="customize-the-user-store"></a><span data-ttu-id="c04e1-210">Personalizzare l'archivio utenti</span><span class="sxs-lookup"><span data-stu-id="c04e1-210">Customize the user store</span></span>

<span data-ttu-id="c04e1-211">Si crea anche una classe userStore ambito che fornisce i metodi per tutte le operazioni sui dati dell'utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-211">You also create a UserStore class that provides the methods for all data operations on the user.</span></span> <span data-ttu-id="c04e1-212">Questa classe è equivalente alla classe [userstore ambito&lt;TUser&gt;](https://msdn.microsoft.com/library/dn315446(v=vs.108).aspx) nello spazio dei nomi [Microsoft. ASP. NET. Identity. EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) .</span><span class="sxs-lookup"><span data-stu-id="c04e1-212">This class is equivalent to the [UserStore&lt;TUser&gt;](https://msdn.microsoft.com/library/dn315446(v=vs.108).aspx) class in the [Microsoft.ASP.NET.Identity.EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) namespace.</span></span> <span data-ttu-id="c04e1-213">Nella classe userStore ambito si implementa il [IUserStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613276(v=vs.108).aspx) e una qualsiasi delle interfacce facoltative.</span><span class="sxs-lookup"><span data-stu-id="c04e1-213">In your UserStore class, you implement the [IUserStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613276(v=vs.108).aspx) and any of the optional interfaces.</span></span> <span data-ttu-id="c04e1-214">È possibile selezionare le interfacce facoltative da implementare in base alle funzionalità che si desidera fornire nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c04e1-214">You select which optional interfaces to implement based on the functionality you wish to provide in your application.</span></span>

<span data-ttu-id="c04e1-215">Nell'immagine seguente viene illustrata la classe userStore ambito che è necessario creare e le interfacce pertinenti.</span><span class="sxs-lookup"><span data-stu-id="c04e1-215">The following image shows the UserStore class you must create and the relevant interfaces.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image3.png)

<span data-ttu-id="c04e1-216">Il modello di progetto predefinito in Visual Studio contiene codice che presuppone che molte delle interfacce opzionali siano state implementate nell'archivio utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-216">The default project template in Visual Studio contains code that assumes many of the optional interfaces have been implemented in the user store.</span></span> <span data-ttu-id="c04e1-217">Se si usa il modello predefinito con un archivio utente personalizzato, è necessario implementare le interfacce facoltative nell'archivio utente o modificare il codice del modello in modo che non chiami più metodi nelle interfacce non implementate.</span><span class="sxs-lookup"><span data-stu-id="c04e1-217">If you are using the default template with a customized user store, you must either implement optional interfaces in your user store or alter the template code to no longer call methods in the interfaces you have not implemented.</span></span>

 <span data-ttu-id="c04e1-218">Nell'esempio seguente viene illustrata una semplice classe di archivio utenti.</span><span class="sxs-lookup"><span data-stu-id="c04e1-218">The following example shows a simple user store class.</span></span> <span data-ttu-id="c04e1-219">Il parametro generico **TUser** accetta il tipo della classe utente che in genere è la classe IdentityUser definita.</span><span class="sxs-lookup"><span data-stu-id="c04e1-219">The **TUser** generic parameter takes the type of your user class which usually is the IdentityUser class you defined.</span></span> <span data-ttu-id="c04e1-220">Il parametro generico **TKey** accetta il tipo della chiave utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-220">The **TKey** generic parameter takes the type of your user key.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample3.cs)]

 <span data-ttu-id="c04e1-221">In questo esempio, il costruttore che accetta un parametro denominato *database* di tipo ExampleDatabase è solo un esempio di come passare la classe di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="c04e1-221">In this example, the constructor that takes a parameter named *database* of type ExampleDatabase is only an illustration of how to pass in your data access class.</span></span> <span data-ttu-id="c04e1-222">Ad esempio, nell'implementazione di MySQL, questo costruttore accetta un parametro di tipo MySQLDatabase.</span><span class="sxs-lookup"><span data-stu-id="c04e1-222">For example, in the MySQL implementation, this constructor takes a parameter of type MySQLDatabase.</span></span> 

<span data-ttu-id="c04e1-223">All'interno della classe userStore ambito, è possibile usare le classi di accesso ai dati create per eseguire operazioni.</span><span class="sxs-lookup"><span data-stu-id="c04e1-223">Within your UserStore class, you use the data access classes that you created to perform operations.</span></span> <span data-ttu-id="c04e1-224">Nell'implementazione di MySQL, ad esempio, la classe userStore ambito ha il Metodo CreateAsync che usa un'istanza di UserTable per inserire un nuovo record.</span><span class="sxs-lookup"><span data-stu-id="c04e1-224">For example, in the MySQL implementation, the UserStore class has the CreateAsync method which uses an instance of UserTable to insert a new record.</span></span> <span data-ttu-id="c04e1-225">Il metodo **Insert** sull'oggetto **userTable** è lo stesso metodo illustrato nella sezione precedente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-225">The **Insert** method on the **userTable** object is the same method that was shown in the previous section.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample4.cs)]

### <a name="interfaces-to-implement-when-customizing-user-store"></a><span data-ttu-id="c04e1-226">Interfacce da implementare quando si Personalizza l'archivio utenti</span><span class="sxs-lookup"><span data-stu-id="c04e1-226">Interfaces to implement when customizing user store</span></span>

<span data-ttu-id="c04e1-227">L'immagine successiva Mostra ulteriori dettagli sulle funzionalità definite in ogni interfaccia.</span><span class="sxs-lookup"><span data-stu-id="c04e1-227">The next image shows more details about the functionality defined in each interface.</span></span> <span data-ttu-id="c04e1-228">Tutte le interfacce opzionali ereditano da IUserStore.</span><span class="sxs-lookup"><span data-stu-id="c04e1-228">All of the optional interfaces inherit from IUserStore.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image4.png)

- <span data-ttu-id="c04e1-229">**IUserStore**</span><span class="sxs-lookup"><span data-stu-id="c04e1-229">**IUserStore**</span></span>  
  <span data-ttu-id="c04e1-230">L'interfaccia [IUserStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613278(v=vs.108).aspx) è l'unica interfaccia che è necessario implementare nell'archivio utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-230">The [IUserStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613278(v=vs.108).aspx) interface is the only interface you must implement in your user store.</span></span> <span data-ttu-id="c04e1-231">Definisce i metodi per la creazione, l'aggiornamento, l'eliminazione e il recupero degli utenti.</span><span class="sxs-lookup"><span data-stu-id="c04e1-231">It defines methods for creating, updating, deleting, and retrieving users.</span></span>
- <span data-ttu-id="c04e1-232">**IUserClaimStore**</span><span class="sxs-lookup"><span data-stu-id="c04e1-232">**IUserClaimStore**</span></span>  
  <span data-ttu-id="c04e1-233">L'interfaccia [IUserClaimStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613265(v=vs.108).aspx) definisce i metodi che è necessario implementare nell'archivio utente per abilitare le attestazioni utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-233">The [IUserClaimStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613265(v=vs.108).aspx) interface defines the methods you must implement in your user store to enable user claims.</span></span> <span data-ttu-id="c04e1-234">Contiene metodi o aggiunta, rimozione e recupero di attestazioni utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-234">It contains methods or adding, removing and retrieving user claims.</span></span>
- <span data-ttu-id="c04e1-235">**IUserLoginStore**</span><span class="sxs-lookup"><span data-stu-id="c04e1-235">**IUserLoginStore**</span></span>  
  <span data-ttu-id="c04e1-236">Il [IUserLoginStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613272(v=vs.108).aspx) definisce i metodi che è necessario implementare nell'archivio utente per abilitare i provider di autenticazione esterni.</span><span class="sxs-lookup"><span data-stu-id="c04e1-236">The [IUserLoginStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613272(v=vs.108).aspx) defines the methods you must implement in your user store to enable external authentication providers.</span></span> <span data-ttu-id="c04e1-237">Contiene i metodi per l'aggiunta, la rimozione e il recupero degli account di accesso utente e un metodo per il recupero di un utente in base alle informazioni di accesso.</span><span class="sxs-lookup"><span data-stu-id="c04e1-237">It contains methods for adding, removing and retrieving user logins, and a method for retrieving a user based on the login information.</span></span>
- <span data-ttu-id="c04e1-238">**IUserRoleStore**</span><span class="sxs-lookup"><span data-stu-id="c04e1-238">**IUserRoleStore**</span></span>  
  <span data-ttu-id="c04e1-239">L'interfaccia [IUserRoleStore&lt;TKey, TUser&gt;](https://msdn.microsoft.com/library/dn613276(v=vs.108).aspx) definisce i metodi che è necessario implementare nell'archivio utente per eseguire il mapping di un utente a un ruolo.</span><span class="sxs-lookup"><span data-stu-id="c04e1-239">The [IUserRoleStore&lt;TKey, TUser&gt;](https://msdn.microsoft.com/library/dn613276(v=vs.108).aspx) interface defines the methods you must implement in your user store to map a user to a role.</span></span> <span data-ttu-id="c04e1-240">Contiene i metodi per aggiungere, rimuovere e recuperare i ruoli di un utente e un metodo per verificare se un utente è assegnato a un ruolo.</span><span class="sxs-lookup"><span data-stu-id="c04e1-240">It contains methods to add, remove, and retrieve a user's roles, and a method to check if a user is assigned to a role.</span></span>
- <span data-ttu-id="c04e1-241">**IUserPasswordStore**</span><span class="sxs-lookup"><span data-stu-id="c04e1-241">**IUserPasswordStore**</span></span>  
  <span data-ttu-id="c04e1-242">L'interfaccia [IUserPasswordStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613273(v=vs.108).aspx) definisce i metodi che è necessario implementare nell'archivio utente per rendere permanente le password con hash.</span><span class="sxs-lookup"><span data-stu-id="c04e1-242">The [IUserPasswordStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613273(v=vs.108).aspx) interface defines the methods you must implement in your user store to persist hashed passwords.</span></span> <span data-ttu-id="c04e1-243">Contiene i metodi per ottenere e impostare la password con hash e un metodo che indica se l'utente ha impostato una password.</span><span class="sxs-lookup"><span data-stu-id="c04e1-243">It contains methods for getting and setting the hashed password, and a method that indicates whether the user has set a password.</span></span>
- <span data-ttu-id="c04e1-244">**IUserSecurityStampStore**</span><span class="sxs-lookup"><span data-stu-id="c04e1-244">**IUserSecurityStampStore**</span></span>  
  <span data-ttu-id="c04e1-245">L'interfaccia [IUserSecurityStampStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613277(v=vs.108).aspx) definisce i metodi che è necessario implementare nell'archivio utente per usare un indicatore di sicurezza per indicare se le informazioni sull'account dell'utente sono state modificate.</span><span class="sxs-lookup"><span data-stu-id="c04e1-245">The [IUserSecurityStampStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613277(v=vs.108).aspx) interface defines the methods you must implement in your user store to use a security stamp for indicating whether the user's account information has changed.</span></span> <span data-ttu-id="c04e1-246">Questo timbro viene aggiornato quando un utente modifica la password o aggiunge o rimuove gli account di accesso.</span><span class="sxs-lookup"><span data-stu-id="c04e1-246">This stamp is updated when a user changes the password, or adds or removes logins.</span></span> <span data-ttu-id="c04e1-247">Contiene i metodi per ottenere e impostare l'indicatore di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="c04e1-247">It contains methods for getting and setting the security stamp.</span></span>
- <span data-ttu-id="c04e1-248">**IUserTwoFactorStore**</span><span class="sxs-lookup"><span data-stu-id="c04e1-248">**IUserTwoFactorStore**</span></span>  
  <span data-ttu-id="c04e1-249">L'interfaccia [IUserTwoFactorStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613279(v=vs.108).aspx) definisce i metodi che è necessario implementare per implementare l'autenticazione a due fattori.</span><span class="sxs-lookup"><span data-stu-id="c04e1-249">The [IUserTwoFactorStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613279(v=vs.108).aspx) interface defines the methods you must implement to implement two factor authentication.</span></span> <span data-ttu-id="c04e1-250">Contiene i metodi per ottenere e impostare se per un utente è abilitata l'autenticazione a due fattori.</span><span class="sxs-lookup"><span data-stu-id="c04e1-250">It contains methods for getting and setting whether two factor authentication is enabled for a user.</span></span>
- <span data-ttu-id="c04e1-251">**IUserPhoneNumberStore**</span><span class="sxs-lookup"><span data-stu-id="c04e1-251">**IUserPhoneNumberStore**</span></span>  
  <span data-ttu-id="c04e1-252">L'interfaccia [IUserPhoneNumberStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613275(v=vs.108).aspx) definisce i metodi che è necessario implementare per archiviare i numeri di telefono dell'utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-252">The [IUserPhoneNumberStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613275(v=vs.108).aspx) interface defines the methods you must implement to store user phone numbers.</span></span> <span data-ttu-id="c04e1-253">Contiene i metodi per ottenere e impostare il numero di telefono e se il numero di telefono è confermato.</span><span class="sxs-lookup"><span data-stu-id="c04e1-253">It contains methods for getting and setting the phone number and whether the phone number is confirmed.</span></span>
- <span data-ttu-id="c04e1-254">**IUserEmailStore**</span><span class="sxs-lookup"><span data-stu-id="c04e1-254">**IUserEmailStore**</span></span>  
  <span data-ttu-id="c04e1-255">L'interfaccia [IUserEmailStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613143(v=vs.108).aspx) definisce i metodi che è necessario implementare per archiviare gli indirizzi di posta elettronica dell'utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-255">The [IUserEmailStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613143(v=vs.108).aspx) interface defines the methods you must implement to store user email addresses.</span></span> <span data-ttu-id="c04e1-256">Contiene i metodi per ottenere e impostare l'indirizzo di posta elettronica e verificare se il messaggio di posta elettronica è confermato.</span><span class="sxs-lookup"><span data-stu-id="c04e1-256">It contains methods for getting and setting the email address and whether the email is confirmed.</span></span>
- <span data-ttu-id="c04e1-257">**IUserLockoutStore**</span><span class="sxs-lookup"><span data-stu-id="c04e1-257">**IUserLockoutStore**</span></span>  
  <span data-ttu-id="c04e1-258">L'interfaccia [IUserLockoutStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613271(v=vs.108).aspx) definisce i metodi che è necessario implementare per archiviare informazioni sul blocco di un account.</span><span class="sxs-lookup"><span data-stu-id="c04e1-258">The [IUserLockoutStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613271(v=vs.108).aspx) interface defines the methods you must implement to store information about locking an account.</span></span> <span data-ttu-id="c04e1-259">Contiene i metodi per ottenere il numero corrente di tentativi di accesso non riusciti, ottenere e impostare se è possibile bloccare l'account, ottenere e impostare la data di fine blocco, incrementare il numero di tentativi non riusciti e reimpostare il numero di tentativi non riusciti.</span><span class="sxs-lookup"><span data-stu-id="c04e1-259">It contains methods for getting the current number of failed access attempts, getting and setting whether the account can be locked, getting and setting the lock out end date, incrementing the number of failed attempts, and resetting the number of failed attempts.</span></span>
- <span data-ttu-id="c04e1-260">**IQueryableUserStore**</span><span class="sxs-lookup"><span data-stu-id="c04e1-260">**IQueryableUserStore**</span></span>  
  <span data-ttu-id="c04e1-261">L'interfaccia [IQueryableUserStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613267(v=vs.108).aspx) definisce i membri che è necessario implementare per fornire un archivio utenti Queryable.</span><span class="sxs-lookup"><span data-stu-id="c04e1-261">The [IQueryableUserStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613267(v=vs.108).aspx) interface defines the members you must implement to provide a queryable user store.</span></span> <span data-ttu-id="c04e1-262">Contiene una proprietà che contiene gli utenti che eseguono query.</span><span class="sxs-lookup"><span data-stu-id="c04e1-262">It contains a property that holds the queryable users.</span></span>

  <span data-ttu-id="c04e1-263">Implementare le interfacce necessarie nell'applicazione. ad esempio, le interfacce IUserClaimStore, IUserLoginStore, IUserRoleStore, IUserPasswordStore e IUserSecurityStampStore, come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="c04e1-263">You implement the interfaces that are needed in your application; such as, the IUserClaimStore, IUserLoginStore, IUserRoleStore, IUserPasswordStore, and IUserSecurityStampStore interfaces as shown below.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample5.cs)]

<span data-ttu-id="c04e1-264">Per un'implementazione completa (incluse tutte le interfacce), vedere [userStore ambito (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserStore.cs).</span><span class="sxs-lookup"><span data-stu-id="c04e1-264">For a complete implementation (including all of interfaces), see [UserStore (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserStore.cs).</span></span>

### <a name="identityuserclaim-identityuserlogin-and-identityuserrole"></a><span data-ttu-id="c04e1-265">IdentityUserClaim, IdentityUserLogin e IdentityUserRole</span><span class="sxs-lookup"><span data-stu-id="c04e1-265">IdentityUserClaim, IdentityUserLogin, and IdentityUserRole</span></span>

<span data-ttu-id="c04e1-266">Lo spazio dei nomi Microsoft. AspNet. Identity. EntityFramework contiene le implementazioni delle classi [IdentityUserClaim](https://msdn.microsoft.com/library/dn613250(v=vs.108).aspx), [IdentityUserLogin](https://msdn.microsoft.com/library/dn613251(v=vs.108).aspx)e [IdentityUserRole](https://msdn.microsoft.com/library/dn613252(v=vs.108).aspx) .</span><span class="sxs-lookup"><span data-stu-id="c04e1-266">The Microsoft.AspNet.Identity.EntityFramework namespace contains implementations of the [IdentityUserClaim](https://msdn.microsoft.com/library/dn613250(v=vs.108).aspx), [IdentityUserLogin](https://msdn.microsoft.com/library/dn613251(v=vs.108).aspx), and [IdentityUserRole](https://msdn.microsoft.com/library/dn613252(v=vs.108).aspx) classes.</span></span> <span data-ttu-id="c04e1-267">Se si usano queste funzionalità, è possibile creare versioni personalizzate di queste classi e definire le proprietà per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c04e1-267">If you are using these features, you may want to create your own versions of these classes and define the properties for your application.</span></span> <span data-ttu-id="c04e1-268">Tuttavia, a volte è più efficiente non caricare queste entità in memoria durante l'esecuzione di operazioni di base, ad esempio l'aggiunta o la rimozione di un'attestazione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="c04e1-268">However, sometimes it is more efficient to not load these entities into memory when performing basic operations (such as adding or removing a user's claim).</span></span> <span data-ttu-id="c04e1-269">Al contrario, le classi dell'archivio back-end possono eseguire queste operazioni direttamente sull'origine dati.</span><span class="sxs-lookup"><span data-stu-id="c04e1-269">Instead, the backend store classes can execute these operations directly on the data source.</span></span> <span data-ttu-id="c04e1-270">Ad esempio, il metodo userStore ambito. GetClaimsAsync () può chiamare userClaimTable. FindByUserId (User. ID) per eseguire direttamente una query sulla tabella e restituire un elenco di attestazioni.</span><span class="sxs-lookup"><span data-stu-id="c04e1-270">For example, the UserStore.GetClaimsAsync() method can call the userClaimTable.FindByUserId(user.Id) method to execute a query on that table directly and return a list of claims.</span></span>

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample6.cs)]

<a id="role"></a>
## <a name="customize-the-role-class"></a><span data-ttu-id="c04e1-271">Personalizzare la classe Role</span><span class="sxs-lookup"><span data-stu-id="c04e1-271">Customize the role class</span></span>

<span data-ttu-id="c04e1-272">Quando si implementa un provider di archiviazione personalizzato, è necessario creare una classe Role equivalente alla classe [IdentityRole](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework.identityrole(v=vs.108).aspx) nello spazio dei nomi [Microsoft. ASP. NET. Identity. EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) :</span><span class="sxs-lookup"><span data-stu-id="c04e1-272">When implementing your own storage provider, you must create a role class which is equivalent to the [IdentityRole](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework.identityrole(v=vs.108).aspx) class in the [Microsoft.ASP.NET.Identity.EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) namespace:</span></span>

<span data-ttu-id="c04e1-273">Il diagramma seguente illustra la classe IdentityRole che è necessario creare e l'interfaccia da implementare in questa classe.</span><span class="sxs-lookup"><span data-stu-id="c04e1-273">The following diagram shows the IdentityRole class that you must create and the interface to implement in this class.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image5.png)

<span data-ttu-id="c04e1-274">L'interfaccia [IRole&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613268(v=vs.108).aspx) definisce le proprietà che il roleManager tenta di chiamare durante l'esecuzione delle operazioni richieste.</span><span class="sxs-lookup"><span data-stu-id="c04e1-274">The [IRole&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613268(v=vs.108).aspx) interface defines the properties that the RoleManager attempts to call when performing requested operations.</span></span> <span data-ttu-id="c04e1-275">L'interfaccia contiene due proprietà-ID e nome.</span><span class="sxs-lookup"><span data-stu-id="c04e1-275">The interface contains two properties - Id and Name.</span></span> <span data-ttu-id="c04e1-276">L'interfaccia [IRole&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613268(v=vs.108).aspx) consente di specificare il tipo di chiave per il ruolo tramite il parametro generico **TKey** .</span><span class="sxs-lookup"><span data-stu-id="c04e1-276">The [IRole&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613268(v=vs.108).aspx) interface enables you to specify the type of the key for the role through the generic **TKey** parameter.</span></span> <span data-ttu-id="c04e1-277">Il tipo della proprietà ID corrisponde al valore del parametro TKey.</span><span class="sxs-lookup"><span data-stu-id="c04e1-277">The type of the Id property matches the value of the TKey parameter.</span></span>

<span data-ttu-id="c04e1-278">Il Framework di identità fornisce anche l'interfaccia [IRole](https://msdn.microsoft.com/library/microsoft.aspnet.identity.irole(v=vs.108).aspx) (senza il parametro generico) quando si vuole usare un valore stringa per la chiave.</span><span class="sxs-lookup"><span data-stu-id="c04e1-278">The Identity framework also provides the [IRole](https://msdn.microsoft.com/library/microsoft.aspnet.identity.irole(v=vs.108).aspx) interface (without the generic parameter) when you want to use a string value for the key.</span></span>

<span data-ttu-id="c04e1-279">Nell'esempio seguente viene illustrata una classe IdentityRole che usa un numero intero per la chiave.</span><span class="sxs-lookup"><span data-stu-id="c04e1-279">The following example shows an IdentityRole class that uses an integer for the key.</span></span> <span data-ttu-id="c04e1-280">Il campo ID è impostato su int in modo che corrisponda al valore del parametro generico.</span><span class="sxs-lookup"><span data-stu-id="c04e1-280">The Id field is set to int to match the value of the generic parameter.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample7.cs)]

 <span data-ttu-id="c04e1-281">Per un'implementazione completa, vedere [IdentityRole (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/IdentityRole.cs).</span><span class="sxs-lookup"><span data-stu-id="c04e1-281">For a complete implementation, see [IdentityRole (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/IdentityRole.cs).</span></span> 

<a id="rolestore"></a>
## <a name="customize-the-role-store"></a><span data-ttu-id="c04e1-282">Personalizzare l'archivio dei ruoli</span><span class="sxs-lookup"><span data-stu-id="c04e1-282">Customize the role store</span></span>

<span data-ttu-id="c04e1-283">Si crea anche una classe nell'rolestore che fornisce i metodi per tutte le operazioni di dati sui ruoli.</span><span class="sxs-lookup"><span data-stu-id="c04e1-283">You also create a RoleStore class that provides the methods for all data operations on roles.</span></span> <span data-ttu-id="c04e1-284">Questa classe è equivalente alla classe [nell'rolestore&lt;TRole&gt;](https://msdn.microsoft.com/library/dn468181(v=vs.108).aspx) nello spazio dei nomi Microsoft. ASP. NET. Identity. EntityFramework.</span><span class="sxs-lookup"><span data-stu-id="c04e1-284">This class is equivalent to the [RoleStore&lt;TRole&gt;](https://msdn.microsoft.com/library/dn468181(v=vs.108).aspx) class in the Microsoft.ASP.NET.Identity.EntityFramework namespace.</span></span> <span data-ttu-id="c04e1-285">Nella classe nell'rolestore si implementa [IRoleStore&lt;TRole, tkey&gt;](https://msdn.microsoft.com/library/dn613266(v=vs.108).aspx) e, facoltativamente, l'interfaccia [IQueryableRoleStore&lt;TRole, TKey&gt;](https://msdn.microsoft.com/library/dn613262(v=vs.108).aspx) .</span><span class="sxs-lookup"><span data-stu-id="c04e1-285">In your RoleStore class, you implement the [IRoleStore&lt;TRole, TKey&gt;](https://msdn.microsoft.com/library/dn613266(v=vs.108).aspx) and optionally the [IQueryableRoleStore&lt;TRole, TKey&gt;](https://msdn.microsoft.com/library/dn613262(v=vs.108).aspx) interface.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image6.png)

<span data-ttu-id="c04e1-286">Nell'esempio seguente viene illustrata una classe di archivio ruoli.</span><span class="sxs-lookup"><span data-stu-id="c04e1-286">The following example shows a role store class.</span></span> <span data-ttu-id="c04e1-287">Il parametro generico TRole accetta il tipo della classe Role che in genere è la classe IdentityRole definita.</span><span class="sxs-lookup"><span data-stu-id="c04e1-287">The TRole generic parameter takes the type of your role class which usually is the IdentityRole class you defined.</span></span> <span data-ttu-id="c04e1-288">Il parametro generico TKey accetta il tipo della chiave Role.</span><span class="sxs-lookup"><span data-stu-id="c04e1-288">The TKey generic parameter takes the type of your role key.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample8.cs)]

- <span data-ttu-id="c04e1-289">**IRoleStore&lt;TRole&gt;**</span><span class="sxs-lookup"><span data-stu-id="c04e1-289">**IRoleStore&lt;TRole&gt;**</span></span>  
  <span data-ttu-id="c04e1-290">L'interfaccia [IRoleStore](https://msdn.microsoft.com/library/dn468195.aspx) definisce i metodi da implementare nella classe dell'archivio dei ruoli.</span><span class="sxs-lookup"><span data-stu-id="c04e1-290">The [IRoleStore](https://msdn.microsoft.com/library/dn468195.aspx) interface defines the methods to implement in your role store class.</span></span> <span data-ttu-id="c04e1-291">Contiene i metodi per la creazione, l'aggiornamento, l'eliminazione e il recupero di ruoli.</span><span class="sxs-lookup"><span data-stu-id="c04e1-291">It contains methods for creating, updating, deleting and retrieving roles.</span></span>
- <span data-ttu-id="c04e1-292">**RoleStore&lt;TRole&gt;**</span><span class="sxs-lookup"><span data-stu-id="c04e1-292">**RoleStore&lt;TRole&gt;**</span></span>  
  <span data-ttu-id="c04e1-293">Per personalizzare nell'rolestore, creare una classe che implementi l'interfaccia IRoleStore.</span><span class="sxs-lookup"><span data-stu-id="c04e1-293">To customize RoleStore, create a class that implements the IRoleStore interface.</span></span> <span data-ttu-id="c04e1-294">È necessario implementare questa classe solo se si desidera utilizzare i ruoli nel sistema.</span><span class="sxs-lookup"><span data-stu-id="c04e1-294">You only have to implement this class if want to use roles on your system.</span></span> <span data-ttu-id="c04e1-295">Il costruttore che accetta un parametro denominato *database* di tipo ExampleDatabase è solo un esempio di come passare la classe di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="c04e1-295">The constructor that takes a parameter named *database* of type ExampleDatabase is only an illustration of how to pass in your data access class.</span></span> <span data-ttu-id="c04e1-296">Ad esempio, nell'implementazione di MySQL, questo costruttore accetta un parametro di tipo MySQLDatabase.</span><span class="sxs-lookup"><span data-stu-id="c04e1-296">For example, in the MySQL implementation, this constructor takes a parameter of type MySQLDatabase.</span></span>  
  
  <span data-ttu-id="c04e1-297">Per un'implementazione completa, vedere [nell'rolestore (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/RoleStore.cs) .</span><span class="sxs-lookup"><span data-stu-id="c04e1-297">For a complete implementation, see [RoleStore (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/RoleStore.cs) .</span></span>

<a id="reconfigure"></a>
## <a name="reconfigure-application-to-use-new-storage-provider"></a><span data-ttu-id="c04e1-298">Riconfigurare l'applicazione per l'uso di un nuovo provider di archiviazione</span><span class="sxs-lookup"><span data-stu-id="c04e1-298">Reconfigure application to use new storage provider</span></span>

<span data-ttu-id="c04e1-299">È stato implementato il nuovo provider di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="c04e1-299">You have implemented your new storage provider.</span></span> <span data-ttu-id="c04e1-300">A questo punto, è necessario configurare l'applicazione per l'uso di questo provider di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="c04e1-300">Now, you must configure your application to use this storage provider.</span></span> <span data-ttu-id="c04e1-301">Se il provider di archiviazione predefinito è stato incluso nel progetto, è necessario rimuovere il provider predefinito e sostituirlo con il provider.</span><span class="sxs-lookup"><span data-stu-id="c04e1-301">If the default storage provider was included in your project, you must remove the default provider and replace it with your provider.</span></span>

### <a name="replace-default-storage-provider-in-mvc-project"></a><span data-ttu-id="c04e1-302">Sostituisci provider di archiviazione predefinito nel progetto MVC</span><span class="sxs-lookup"><span data-stu-id="c04e1-302">Replace default storage provider in MVC project</span></span>

1. <span data-ttu-id="c04e1-303">Nella finestra **Gestisci pacchetti NuGet** disinstallare il pacchetto **Microsoft ASP.NET Identity EntityFramework** .</span><span class="sxs-lookup"><span data-stu-id="c04e1-303">In the **Manage NuGet Packages** window, uninstall the **Microsoft ASP.NET Identity EntityFramework** package.</span></span> <span data-ttu-id="c04e1-304">È possibile trovare questo pacchetto eseguendo una ricerca nei pacchetti installati per Identity. EntityFramework.</span><span class="sxs-lookup"><span data-stu-id="c04e1-304">You can find this package by searching in the Installed packages for Identity.EntityFramework.</span></span>  
    <span data-ttu-id="c04e1-305">![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image7.png) verrà chiesto se si desidera disinstallare anche Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="c04e1-305">![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image7.png) You will be asked if you also want to uninstall Entity Framework.</span></span> <span data-ttu-id="c04e1-306">Se non è necessario in altre parti dell'applicazione, è possibile disinstallarla.</span><span class="sxs-lookup"><span data-stu-id="c04e1-306">If you do not need it in other parts of your application, you can uninstall it.</span></span>
2. <span data-ttu-id="c04e1-307">Nel file IdentityModels.cs nella cartella Models eliminare o impostare come commento le classi **ApplicationUser** e **ApplicationDbContext** .</span><span class="sxs-lookup"><span data-stu-id="c04e1-307">In the IdentityModels.cs file in the Models folder, delete or comment out the **ApplicationUser** and **ApplicationDbContext** classes.</span></span> <span data-ttu-id="c04e1-308">In un'applicazione MVC è possibile eliminare l'intero file IdentityModels.cs.</span><span class="sxs-lookup"><span data-stu-id="c04e1-308">In an MVC application, you can delete the entire IdentityModels.cs file.</span></span> <span data-ttu-id="c04e1-309">In un'applicazione Web Form, eliminare le due classi, ma assicurarsi di lasciare la classe helper che si trova anche nel file IdentityModels.cs.</span><span class="sxs-lookup"><span data-stu-id="c04e1-309">In a Web Forms application, delete the two classes but make sure you keep the helper class that is also located in the IdentityModels.cs file.</span></span>
3. <span data-ttu-id="c04e1-310">Se il provider di archiviazione si trova in un progetto separato, aggiungervi un riferimento nell'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="c04e1-310">If your storage provider resides in a separate project, add a reference to it in your web application.</span></span>
4. <span data-ttu-id="c04e1-311">Sostituire tutti i riferimenti a `using Microsoft.AspNet.Identity.EntityFramework;` con un'istruzione using per lo spazio dei nomi del provider di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="c04e1-311">Replace all references to `using Microsoft.AspNet.Identity.EntityFramework;` with a using statement for the namespace of your storage provider.</span></span>
5. <span data-ttu-id="c04e1-312">Nella classe **Startup.auth.cs** modificare il metodo **ConfigureAuth** in modo da usare una singola istanza del contesto appropriato.</span><span class="sxs-lookup"><span data-stu-id="c04e1-312">In the **Startup.Auth.cs** class, change the **ConfigureAuth** method to use a single instance of the appropriate context.</span></span> 

    [!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample9.cs?highlight=3)]
6. <span data-ttu-id="c04e1-313">Nella cartella di avvio dell'app\_aprire **IdentityConfig.cs**.</span><span class="sxs-lookup"><span data-stu-id="c04e1-313">In the App\_Start folder, open **IdentityConfig.cs**.</span></span> <span data-ttu-id="c04e1-314">Nella classe ApplicationUserManager modificare il metodo **create** per restituire un gestore utenti che usa l'archivio utente personalizzato.</span><span class="sxs-lookup"><span data-stu-id="c04e1-314">In the ApplicationUserManager class, change the **Create** method to return a user manager that uses your customized user store.</span></span> 

    [!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample10.cs?highlight=3)]
7. <span data-ttu-id="c04e1-315">Sostituire tutti i riferimenti a **ApplicationUser** con **IdentityUser**.</span><span class="sxs-lookup"><span data-stu-id="c04e1-315">Replace all references to **ApplicationUser** with **IdentityUser**.</span></span>
8. <span data-ttu-id="c04e1-316">Il progetto predefinito include alcuni membri della classe User che non sono definiti nell'Interfaccia IUser; ad esempio posta elettronica, PasswordHash e GenerateUserIdentityAsync.</span><span class="sxs-lookup"><span data-stu-id="c04e1-316">The default project includes some members in user class which are not defined in the IUser interface; such as Email, PasswordHash, and GenerateUserIdentityAsync.</span></span> <span data-ttu-id="c04e1-317">Se la classe utente non dispone di questi membri, sarà necessario implementarli o modificare il codice che utilizza tali membri.</span><span class="sxs-lookup"><span data-stu-id="c04e1-317">If your user class does not have these members, you must either implement them or change the code that uses these members.</span></span>
9. <span data-ttu-id="c04e1-318">Se sono state create istanze di RoleManager, modificare il codice in modo da usare la nuova classe nell'rolestore.</span><span class="sxs-lookup"><span data-stu-id="c04e1-318">If you have created any instances of RoleManager, change that code to use your new RoleStore class.</span></span>  

    [!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample11.cs)]
10. <span data-ttu-id="c04e1-319">Il progetto predefinito è progettato per una classe utente che dispone di un valore stringa per la chiave.</span><span class="sxs-lookup"><span data-stu-id="c04e1-319">The default project is designed for a user class that has a string value for the key.</span></span> <span data-ttu-id="c04e1-320">Se la classe utente ha un tipo diverso per la chiave, ad esempio un numero intero, è necessario modificare il progetto in modo che funzioni con il tipo.</span><span class="sxs-lookup"><span data-stu-id="c04e1-320">If your user class has a different type for the key (such as an integer), you must change the project to work with your type.</span></span> <span data-ttu-id="c04e1-321">Vedere [modificare la chiave primaria per gli utenti in ASP.NET Identity](change-primary-key-for-users-in-aspnet-identity.md).</span><span class="sxs-lookup"><span data-stu-id="c04e1-321">See [Change Primary Key for Users in ASP.NET Identity](change-primary-key-for-users-in-aspnet-identity.md).</span></span>
11. <span data-ttu-id="c04e1-322">Se necessario, aggiungere la stringa di connessione al file Web. config.</span><span class="sxs-lookup"><span data-stu-id="c04e1-322">If needed, add the connection string to the Web.config file.</span></span>

<a id="other"></a>
## <a name="other-resources"></a><span data-ttu-id="c04e1-323">Altre risorse</span><span class="sxs-lookup"><span data-stu-id="c04e1-323">Other resources</span></span>

- <span data-ttu-id="c04e1-324">Blog: [implementazione di ASP.NET Identity](http://odetocode.com/blogs/scott/archive/2014/01/20/implementing-asp-net-identity.aspx)</span><span class="sxs-lookup"><span data-stu-id="c04e1-324">Blog: [Implementing ASP.NET Identity](http://odetocode.com/blogs/scott/archive/2014/01/20/implementing-asp-net-identity.aspx)</span></span>
- <span data-ttu-id="c04e1-325">Esercitazione e codice GIT: [Simple. Data ASP.NET Identity Provider](http://designcoderelease.blogspot.co.uk/2015/03/simpledata-aspnet-identity-provider.html)</span><span class="sxs-lookup"><span data-stu-id="c04e1-325">Tutorial and GIT code: [Simple.Data Asp.Net Identity Provider](http://designcoderelease.blogspot.co.uk/2015/03/simpledata-aspnet-identity-provider.html)</span></span>
- <span data-ttu-id="c04e1-326">Esercitazione:[configurazione degli account Identity di base e puntando a un database esterno](http://typecastexception.com/post/2013/10/27/Configuring-Db-Connection-and-Code-First-Migration-for-Identity-Accounts-in-ASPNET-MVC-5-and-Visual-Studio-2013.aspx).</span><span class="sxs-lookup"><span data-stu-id="c04e1-326">Tutorial:[Setting up the basic Identity accounts, and pointing them at an external DB](http://typecastexception.com/post/2013/10/27/Configuring-Db-Connection-and-Code-First-Migration-for-Identity-Accounts-in-ASPNET-MVC-5-and-Visual-Studio-2013.aspx).</span></span> <span data-ttu-id="c04e1-327">Per [@xivSolutions](https://twitter.com/xivSolutions).</span><span class="sxs-lookup"><span data-stu-id="c04e1-327">By [@xivSolutions](https://twitter.com/xivSolutions).</span></span>
- <span data-ttu-id="c04e1-328">Esercitazione[: implementazione di un provider di archiviazione ASP.NET Identity MySQL personalizzato](implementing-a-custom-mysql-aspnet-identity-storage-provider.md)</span><span class="sxs-lookup"><span data-stu-id="c04e1-328">Tutorial[: Implementing a Custom MySQL ASP.NET Identity Storage Provider](implementing-a-custom-mysql-aspnet-identity-storage-provider.md)</span></span>
- <span data-ttu-id="c04e1-329">[Entità codefluent](http://blog.codefluententities.com/2014/04/30/asp-net-identity-v2-and-codefluent-entities/) per [SoftFluent](http://www.softfluent.com/)</span><span class="sxs-lookup"><span data-stu-id="c04e1-329">[CodeFluent Entities](http://blog.codefluententities.com/2014/04/30/asp-net-identity-v2-and-codefluent-entities/) by [SoftFluent](http://www.softfluent.com/)</span></span>
- <span data-ttu-id="c04e1-330">[Archiviazione tabelle di Azure](https://www.nuget.org/packages/accidentalfish.aspnet.identity.azure/) di James Randall.</span><span class="sxs-lookup"><span data-stu-id="c04e1-330">[Azure Table Storage](https://www.nuget.org/packages/accidentalfish.aspnet.identity.azure/) by James Randall.</span></span>
- <span data-ttu-id="c04e1-331">Archiviazione tabelle di Azure: [ASPNET. Identity. TableStorage](https://github.com/stuartleeks/leeksnet.AspNet.Identity.TableStorage) by [@stuartleeks](https://twitter.com/stuartleeks).</span><span class="sxs-lookup"><span data-stu-id="c04e1-331">Azure Table Storage: [AspNet.Identity.TableStorage](https://github.com/stuartleeks/leeksnet.AspNet.Identity.TableStorage) by [@stuartleeks](https://twitter.com/stuartleeks).</span></span>
- [<span data-ttu-id="c04e1-332">CouchDB/Cloudy di Daniel Wertheim.</span><span class="sxs-lookup"><span data-stu-id="c04e1-332">CouchDB / Cloudant by Daniel Wertheim.</span></span>](https://github.com/danielwertheim/mycouch.aspnet.identity)
- <span data-ttu-id="c04e1-333">Elastic eseg[h: identità elastica](https://github.com/bmbsqd/elastic-identity) di Bombsquad ab.</span><span class="sxs-lookup"><span data-stu-id="c04e1-333">Elastic Searc[h: Elastic Identity](https://github.com/bmbsqd/elastic-identity) by Bombsquad AB.</span></span>
- <span data-ttu-id="c04e1-334">[MongoDB](http://www.nuget.org/packages/MongoDB.AspNet.Identity/) di Jonathan Sheely Jonathan Sheely.</span><span class="sxs-lookup"><span data-stu-id="c04e1-334">[MongoDB](http://www.nuget.org/packages/MongoDB.AspNet.Identity/) by Jonathan Sheely Jonathan Sheely.</span></span>
- <span data-ttu-id="c04e1-335">[NHibernate. AspNet. Identity](https://github.com/milesibastos/NHibernate.AspNet.Identity) di Antônio Milesi Bastos.</span><span class="sxs-lookup"><span data-stu-id="c04e1-335">[NHibernate.AspNet.Identity](https://github.com/milesibastos/NHibernate.AspNet.Identity) by Antônio Milesi Bastos.</span></span>
- <span data-ttu-id="c04e1-336">[RavenDB](http://www.nuget.org/packages/AspNet.Identity.RavenDB/1.0.0) per [@tourismgeek](https://twitter.com/tourismgeek).</span><span class="sxs-lookup"><span data-stu-id="c04e1-336">[RavenDB](http://www.nuget.org/packages/AspNet.Identity.RavenDB/1.0.0) by [@tourismgeek](https://twitter.com/tourismgeek).</span></span>
- <span data-ttu-id="c04e1-337">[RavenDB. AspNet. Identity](https://github.com/ILMServices/RavenDB.AspNet.Identity) di [ILMServices](http://www.ilmservice.com/).</span><span class="sxs-lookup"><span data-stu-id="c04e1-337">[RavenDB.AspNet.Identity](https://github.com/ILMServices/RavenDB.AspNet.Identity) by [ILMServices](http://www.ilmservice.com/).</span></span>
- <span data-ttu-id="c04e1-338">Redis: [Redis. AspNet. Identity](https://github.com/aminjam/Redis.AspNet.Identity)</span><span class="sxs-lookup"><span data-stu-id="c04e1-338">Redis: [Redis.AspNet.Identity](https://github.com/aminjam/Redis.AspNet.Identity)</span></span>
- <span data-ttu-id="c04e1-339">Modelli T4 per generare il codice EF per un archivio utente "database First": [ASPNET. Identity. EntityFramework](https://github.com/cbfrank/AspNet.Identity.EntityFramework)</span><span class="sxs-lookup"><span data-stu-id="c04e1-339">T4 Templates to generate EF code for a "database first" user store: [AspNet.Identity.EntityFramework](https://github.com/cbfrank/AspNet.Identity.EntityFramework)</span></span>
