---
uid: web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
title: Assegnazione di ruoli agli utenti (c#) | Microsoft Docs
author: rick-anderson
description: In questa esercitazione creeremo due pagine ASP.NET per agevolare la gestione degli utenti appartengono a quali ruoli. La prima pagina includerà le funzionalità per vedere quali...
ms.author: riande
ms.date: 03/24/2008
ms.assetid: d522639a-5aca-421e-9a76-d73f95607f57
msc.legacyurl: /web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
msc.type: authoredcontent
ms.openlocfilehash: 93a0af00d9e32e044f408a1ca8a2cea73e906d66
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/09/2019
ms.locfileid: "59380288"
---
# <a name="assigning-roles-to-users-c"></a><span data-ttu-id="03032-104">Assegnazione di ruoli agli utenti (C#)</span><span class="sxs-lookup"><span data-stu-id="03032-104">Assigning Roles to Users (C#)</span></span>

<span data-ttu-id="03032-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="03032-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="03032-106">[Scaricare il codice](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) o [Scarica il PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="03032-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span></span>

> <span data-ttu-id="03032-107">In questa esercitazione creeremo due pagine ASP.NET per agevolare la gestione degli utenti appartengono a quali ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-107">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="03032-108">La prima pagina includerà le funzionalità per vedere quali utenti appartengono a un determinato ruolo, i ruoli a cui appartiene un utente specifico e la possibilità di assegnare o rimuovere un utente specifico da un particolare ruolo.</span><span class="sxs-lookup"><span data-stu-id="03032-108">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="03032-109">Nella seconda pagina aumenterà il controllo CreateUserWizard in modo che includa un passaggio per specificare i ruoli a cui appartiene l'utente appena creato.</span><span class="sxs-lookup"><span data-stu-id="03032-109">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="03032-110">Ciò è utile negli scenari in cui è in grado di creare nuovi account utente amministratore.</span><span class="sxs-lookup"><span data-stu-id="03032-110">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>


## <a name="introduction"></a><span data-ttu-id="03032-111">Introduzione</span><span class="sxs-lookup"><span data-stu-id="03032-111">Introduction</span></span>

<span data-ttu-id="03032-112">Il <a id="_msoanchor_1"> </a> [esercitazione precedente](creating-and-managing-roles-cs.md) esaminato il framework di ruoli e le `SqlRoleProvider`; è stato illustrato come utilizzare il `Roles` classe da creare, recuperare ed eliminare ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-112">The <a id="_msoanchor_1"></a>[previous tutorial](creating-and-managing-roles-cs.md) examined the Roles framework and the `SqlRoleProvider`; we saw how to use the `Roles` class to create, retrieve, and delete roles.</span></span> <span data-ttu-id="03032-113">Oltre alla creazione ed eliminazione di ruoli, è necessario essere in grado di assegnare o rimuovere utenti da un ruolo.</span><span class="sxs-lookup"><span data-stu-id="03032-113">In addition to creating and deleting roles, we need to be able to assign or remove users from a role.</span></span> <span data-ttu-id="03032-114">Purtroppo, ASP.NET non viene fornito con tutti i controlli Web per la gestione di ciò che gli utenti appartengono a quali ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-114">Unfortunately, ASP.NET does not ship with any Web controls for managing what users belong to what roles.</span></span> <span data-ttu-id="03032-115">In alternativa, è necessario creare proprie pagine ASP.NET per la gestione di queste associazioni.</span><span class="sxs-lookup"><span data-stu-id="03032-115">Instead, we must create our own ASP.NET pages to manage these associations.</span></span> <span data-ttu-id="03032-116">La buona notizia è che l'aggiunta e rimozione di utenti ai ruoli è piuttosto semplice.</span><span class="sxs-lookup"><span data-stu-id="03032-116">The good news is that adding and removing users to roles is quite easy.</span></span> <span data-ttu-id="03032-117">Il `Roles` classe contiene numerosi metodi per l'aggiunta di uno o più utenti a uno o più ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-117">The `Roles` class contains a number of methods for adding one or more users to one or more roles.</span></span>

<span data-ttu-id="03032-118">In questa esercitazione creeremo due pagine ASP.NET per agevolare la gestione degli utenti appartengono a quali ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-118">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="03032-119">La prima pagina includerà le funzionalità per vedere quali utenti appartengono a un determinato ruolo, i ruoli a cui appartiene un utente specifico e la possibilità di assegnare o rimuovere un utente specifico da un particolare ruolo.</span><span class="sxs-lookup"><span data-stu-id="03032-119">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="03032-120">Nella seconda pagina aumenterà il controllo CreateUserWizard in modo che includa un passaggio per specificare i ruoli a cui appartiene l'utente appena creato.</span><span class="sxs-lookup"><span data-stu-id="03032-120">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="03032-121">Ciò è utile negli scenari in cui è in grado di creare nuovi account utente amministratore.</span><span class="sxs-lookup"><span data-stu-id="03032-121">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

<span data-ttu-id="03032-122">Iniziamo!</span><span class="sxs-lookup"><span data-stu-id="03032-122">Let's get started!</span></span>

## <a name="listing-what-users-belong-to-what-roles"></a><span data-ttu-id="03032-123">Elenca gli utenti che appartengono a quali ruoli</span><span class="sxs-lookup"><span data-stu-id="03032-123">Listing What Users Belong To What Roles</span></span>

<span data-ttu-id="03032-124">Il primo ordine di importanza per questa esercitazione consiste nel creare una pagina web da cui gli utenti possono essere assegnati ai ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-124">The first order of business for this tutorial is to create a web page from which users can be assigned to roles.</span></span> <span data-ttu-id="03032-125">Prima che si sono relative a noi con le procedure per assegnare gli utenti a ruoli, è possibile concentrare l'attenzione su come determinare quali utenti appartengono a quali ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-125">Before we concern ourselves with how to assign users to roles, let's first concentrate on how to determine what users belong to what roles.</span></span> <span data-ttu-id="03032-126">Esistono due modi per visualizzare queste informazioni: "dal ruolo" o ""utente.</span><span class="sxs-lookup"><span data-stu-id="03032-126">There are two ways to display this information: "by role" or "by user."</span></span> <span data-ttu-id="03032-127">È possibile consentire il visitatore selezionare un ruolo e quindi visualizzarli tutti gli utenti che appartengono al ruolo (visualizzazione "dal ruolo") o è stato possibile richiedere il visitatore per selezionare un utente e quindi visualizzarli i ruoli assegnati all'utente (visualizzazione "dall'utente").</span><span class="sxs-lookup"><span data-stu-id="03032-127">We could allow the visitor to select a role and then show them all of the users that belong to the role (the "by role" display), or we could prompt the visitor to select a user and then show them the roles assigned to that user (the "by user" display).</span></span>

<span data-ttu-id="03032-128">La visualizzazione "dal ruolo" è utile nei casi in cui vuole conoscere il set di utenti che appartengono a un ruolo specifico; il visitatore la visualizzazione "dall'utente" è ideale quando i visitatori devono conoscere i ruoli di un utente specifico.</span><span class="sxs-lookup"><span data-stu-id="03032-128">The "by role" view is useful in circumstances where the visitor wants to know the set of users that belong to a particular role; the "by user" view is ideal when the visitor needs to know a particular user's role(s).</span></span> <span data-ttu-id="03032-129">È possibile che la pagina includa sia "role" e "dall'utente" interfacce.</span><span class="sxs-lookup"><span data-stu-id="03032-129">Let's have our page include both "by role" and "by user" interfaces.</span></span>

<span data-ttu-id="03032-130">Si inizierà con la creazione dell'interfaccia "dall'utente".</span><span class="sxs-lookup"><span data-stu-id="03032-130">We will start with creating the "by user" interface.</span></span> <span data-ttu-id="03032-131">Questa interfaccia sarà costituito da un elenco di riepilogo e un elenco di caselle di controllo.</span><span class="sxs-lookup"><span data-stu-id="03032-131">This interface will consist of a drop-down list and a list of checkboxes.</span></span> <span data-ttu-id="03032-132">L'elenco a discesa viene popolato con il set di utenti nel sistema. le caselle di controllo permette di enumerare i ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-132">The drop-down list will be populated with the set of users in the system; the checkboxes will enumerate the roles.</span></span> <span data-ttu-id="03032-133">Selezionando un utente dall'elenco a discesa controllerà questi ruoli a cui che appartiene l'utente.</span><span class="sxs-lookup"><span data-stu-id="03032-133">Selecting a user from the drop-down list will check those roles the user belongs to.</span></span> <span data-ttu-id="03032-134">La persona visitando la pagina può quindi selezionare o deselezionare le caselle di controllo per aggiungere o rimuovere l'utente selezionato dalla ruoli corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="03032-134">The person visiting the page can then check or uncheck the checkboxes to add or remove the selected user from the corresponding roles.</span></span>

> [!NOTE]
> <span data-ttu-id="03032-135">Usando un elenco a discesa elenco all'account utente non è la scelta ideale per siti Web in cui possono essere presenti centinaia di account utente.</span><span class="sxs-lookup"><span data-stu-id="03032-135">Using a drop-down list to list the user accounts is not an ideal choice for websites where there may be hundreds of user accounts.</span></span> <span data-ttu-id="03032-136">Un elenco di riepilogo a discesa è progettato per consentire all'utente di selezionare un elemento da un relativamente breve elenco di opzioni.</span><span class="sxs-lookup"><span data-stu-id="03032-136">A drop-down list is designed to allow a user to pick one item from a relatively short list of options.</span></span> <span data-ttu-id="03032-137">Diventa rapidamente scomodo man mano che aumenta il numero di elementi dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="03032-137">It quickly becomes unwieldy as the number of list items grows.</span></span> <span data-ttu-id="03032-138">Se si sta creando un sito Web che avrà un numero potenzialmente elevato di account utente, è possibile provare a usare un'interfaccia utente alternative, ad esempio un controllo GridView paginabile o un'interfaccia filtrabile che elenca richiede il visitatore per scegliere una lettera e quindi solo Mostra gli utenti il cui nome utente inizi con la lettera selezionata.</span><span class="sxs-lookup"><span data-stu-id="03032-138">If you are building a website that will have potentially large numbers of user accounts, you may want to consider using an alternative user interface, such as a pageable GridView or a filterable interface that lists prompts the visitor to choose a letter and then only shows those users whose username starts with the selected letter.</span></span>


## <a name="step-1-building-the-by-user-user-interface"></a><span data-ttu-id="03032-139">Passaggio 1: Creazione dell'interfaccia utente "Dall'utente"</span><span class="sxs-lookup"><span data-stu-id="03032-139">Step 1: Building the "By User" User Interface</span></span>

<span data-ttu-id="03032-140">Aprire il `UsersAndRoles.aspx` pagina.</span><span class="sxs-lookup"><span data-stu-id="03032-140">Open the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="03032-141">Nella parte superiore della pagina, aggiungere un controllo etichetta Web denominato `ActionStatus` e cancellare il `Text` proprietà.</span><span class="sxs-lookup"><span data-stu-id="03032-141">At the top of the page, add a Label Web control named `ActionStatus` and clear out its `Text` property.</span></span> <span data-ttu-id="03032-142">Si userà l'etichetta per fornire commenti e suggerimenti sulle azioni eseguite, la visualizzazione dei messaggi, ad esempio, "Tito utente è stato aggiunto al ruolo Administrators" o "Jisun utente è stato rimosso dal ruolo supervisori."</span><span class="sxs-lookup"><span data-stu-id="03032-142">We will use this Label to provide feedback on the actions performed, displaying messages like, "User Tito has been added to the Administrators role," or "User Jisun has been removed from the Supervisors role."</span></span> <span data-ttu-id="03032-143">Per rendere questi sono i messaggi, impostare l'etichetta `CssClass` proprietà su "Important".</span><span class="sxs-lookup"><span data-stu-id="03032-143">In order to make these messages stand out, set the Label's `CssClass` property to "Important".</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample1.aspx)]

<span data-ttu-id="03032-144">Successivamente, aggiungere la seguente definizione di classe CSS per il `Styles.css` foglio di stile:</span><span class="sxs-lookup"><span data-stu-id="03032-144">Next, add the following CSS class definition to the `Styles.css` stylesheet:</span></span>

[!code-css[Main](assigning-roles-to-users-cs/samples/sample2.css)]

<span data-ttu-id="03032-145">Questa definizione CSS indica al browser per visualizzare l'etichetta con un tipo di carattere di grandi dimensioni, di colore rosso.</span><span class="sxs-lookup"><span data-stu-id="03032-145">This CSS definition instructs the browser to display the Label using a large, red font.</span></span> <span data-ttu-id="03032-146">Figura 1 mostra questo effetto tramite la progettazione di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="03032-146">Figure 1 shows this effect through the Visual Studio Designer.</span></span>


[![T<span data-ttu-id="03032-147">Risultati di proprietà dell'etichetta he CssClass in una grande, tipo di carattere rosso]</span><span class="sxs-lookup"><span data-stu-id="03032-147">he Label's CssClass Property Results in a Large, Red Font]</span></span>(assigning-roles-to-users-cs/_static/image2.png)](assigning-roles-to-users-cs/_static/image1.png)

<span data-ttu-id="03032-148">**Figura 1**: L'etichetta `CssClass` proprietà genererà una grande, tipo di carattere rosso ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="03032-148">**Figure 1**: The Label's `CssClass` Property Results in a Large, Red Font  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image3.png))</span></span>


<span data-ttu-id="03032-149">Successivamente, aggiungere un controllo DropDownList alla pagina, impostare relativi `ID` proprietà `UserList`e impostare il `AutoPostBack` proprietà su True.</span><span class="sxs-lookup"><span data-stu-id="03032-149">Next, add a DropDownList to the page, set its `ID` property to `UserList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="03032-150">Si userà questo DropDownList per elencare tutti gli utenti nel sistema.</span><span class="sxs-lookup"><span data-stu-id="03032-150">We will use this DropDownList to list all of the users in the system.</span></span> <span data-ttu-id="03032-151">Questo controllo DropDownList verrà associata a una raccolta di oggetti MembershipUser.</span><span class="sxs-lookup"><span data-stu-id="03032-151">This DropDownList will be bound to a collection of MembershipUser objects.</span></span> <span data-ttu-id="03032-152">Dal momento che il controllo DropDownList per visualizzare la proprietà UserName dell'oggetto MembershipUser (e usarlo come valore degli elementi dell'elenco), impostare il controllo DropDownList `DataTextField` e `DataValueField` proprietà su "UserName".</span><span class="sxs-lookup"><span data-stu-id="03032-152">Because we want the DropDownList to display the UserName property of the MembershipUser object (and use it as the value of the list items), set the DropDownList's `DataTextField` and `DataValueField` properties to "UserName".</span></span>

<span data-ttu-id="03032-153">Sotto il controllo DropDownList, aggiungere un controllo Repeater denominato `UsersRoleList`.</span><span class="sxs-lookup"><span data-stu-id="03032-153">Underneath the DropDownList, add a Repeater named `UsersRoleList`.</span></span> <span data-ttu-id="03032-154">Il Repeater elencherà tutti i ruoli del sistema come una serie di caselle di controllo.</span><span class="sxs-lookup"><span data-stu-id="03032-154">This Repeater will list all of the roles in the system as a series of checkboxes.</span></span> <span data-ttu-id="03032-155">Definire il Repeater `ItemTemplate` utilizzando il seguente markup dichiarativo:</span><span class="sxs-lookup"><span data-stu-id="03032-155">Define the Repeater's `ItemTemplate` using the following declarative markup:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample3.aspx)]

<span data-ttu-id="03032-156">Il `ItemTemplate` markup include un singolo controllo casella di controllo Web denominato `RoleCheckBox`.</span><span class="sxs-lookup"><span data-stu-id="03032-156">The `ItemTemplate` markup includes a single CheckBox Web control named `RoleCheckBox`.</span></span> <span data-ttu-id="03032-157">La casella di controllo `AutoPostBack` è impostata su True e il `Text` proprietà è associata a `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="03032-157">The CheckBox's `AutoPostBack` property is set to True and the `Text` property is bound to `Container.DataItem`.</span></span> <span data-ttu-id="03032-158">L'obiettivo è semplicemente la sintassi di associazione dati `Container.DataItem` , infatti, il framework di ruoli restituisce l'elenco di nomi di ruolo come una matrice di stringhe ed è questa matrice di stringhe che eseguiremo l'associazione al controllo Repeater.</span><span class="sxs-lookup"><span data-stu-id="03032-158">The reason the databinding syntax is simply `Container.DataItem` is because the Roles framework returns the list of role names as a string array, and it is this string array that we will be binding to the Repeater.</span></span> <span data-ttu-id="03032-159">Una descrizione dettagliata del motivo per cui questa sintassi consente di visualizzare il contenuto della matrice associata a un controllo Web esula dall'ambito di questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="03032-159">A thorough description of why this syntax is used to display the contents of an array bound to a data Web control is beyond the scope of this tutorial.</span></span> <span data-ttu-id="03032-160">Per altre informazioni al riguardo, consultare [associazione di una matrice scalare a un controllo Web](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="03032-160">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="03032-161">Markup dichiarativo dell'interfaccia "dall'utente" a questo punto dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="03032-161">At this point your "by user" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample4.aspx)]

<span data-ttu-id="03032-162">A questo punto siamo pronti a scrivere il codice per associare il set di account utente a DropDownList e il set di ruoli a Repeater.</span><span class="sxs-lookup"><span data-stu-id="03032-162">We are now ready to write the code to bind the set of user accounts to the DropDownList and the set of roles to the Repeater.</span></span> <span data-ttu-id="03032-163">Nella classe code-behind della pagina, aggiungere un metodo denominato `BindUsersToUserList` e un altro denominato `BindRolesList`, usando il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="03032-163">In the page's code-behind class, add a method named `BindUsersToUserList` and another named `BindRolesList`, using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample5.cs)]

<span data-ttu-id="03032-164">Il `BindUsersToUserList` metodo consente di recuperare tutti gli account utente nel sistema tramite il [ `Membership.GetAllUsers` metodo](https://msdn.microsoft.com/library/dy8swhya.aspx).</span><span class="sxs-lookup"><span data-stu-id="03032-164">The `BindUsersToUserList` method retrieves all of the user accounts in the system via the [`Membership.GetAllUsers` method](https://msdn.microsoft.com/library/dy8swhya.aspx).</span></span> <span data-ttu-id="03032-165">Restituisce un [ `MembershipUserCollection` oggetto](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), che è una raccolta di [ `MembershipUser` istanze](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="03032-165">This returns a [`MembershipUserCollection` object](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), which is a collection of [`MembershipUser` instances](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span></span> <span data-ttu-id="03032-166">Questa raccolta viene quindi associata ai `UserList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="03032-166">This collection is then bound to the `UserList` DropDownList.</span></span> <span data-ttu-id="03032-167">Il `MembershipUser` istanze di tale struttura la raccolta contiene una varietà di proprietà, ad esempio `UserName`, `Email`, `CreationDate`, e `IsOnline`.</span><span class="sxs-lookup"><span data-stu-id="03032-167">The `MembershipUser` instances that makeup the collection contain a variety of properties, like `UserName`, `Email`, `CreationDate`, and `IsOnline`.</span></span> <span data-ttu-id="03032-168">Per indicare a DropDownList per visualizzare il valore della `UserName` proprietà, assicurarsi che il `UserList` del controllo DropDownList `DataTextField` e `DataValueField` proprietà sono state impostate su "UserName".</span><span class="sxs-lookup"><span data-stu-id="03032-168">In order to instruct the DropDownList to display the value of the `UserName` property, ensure that the `UserList` DropDownList's `DataTextField` and `DataValueField` properties have been set to "UserName".</span></span>

> [!NOTE]
> <span data-ttu-id="03032-169">Il `Membership.GetAllUsers` metodo presenta due overload: uno che non accetta alcun parametro di input e restituisce tutti gli utenti e uno che accetta valori interi per l'indice della pagina e dimensioni di pagina e restituisce solo il subset di utenti specificato.</span><span class="sxs-lookup"><span data-stu-id="03032-169">The `Membership.GetAllUsers` method has two overloads: one that accepts no input parameters and returns all of the users, and one that takes in integer values for the page index and page size, and returns only the specified subset of the users.</span></span> <span data-ttu-id="03032-170">Quando sono presenti grandi quantità di account utente visualizzato in un elemento dell'interfaccia utente paginabile, il secondo overload è utilizzabile per pagina in modo più efficiente attraverso gli utenti poiché restituisce solo il subset preciso di account utente anziché a tutti gli elementi.</span><span class="sxs-lookup"><span data-stu-id="03032-170">When there are large amounts of user accounts being displayed in a pageable user interface element, the second overload can be used to more efficiently page through the users since it returns just the precise subset of user accounts rather than all of them.</span></span>


<span data-ttu-id="03032-171">Il `BindRolesToList` metodo inizia chiamando le `Roles` della classe [ `GetAllRoles` metodo](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), che restituisce una matrice di stringhe contenente i ruoli del sistema.</span><span class="sxs-lookup"><span data-stu-id="03032-171">The `BindRolesToList` method starts by calling the `Roles` class's [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), which returns a string array containing the roles in the system.</span></span> <span data-ttu-id="03032-172">Questa matrice di stringhe viene quindi associata a Repeater.</span><span class="sxs-lookup"><span data-stu-id="03032-172">This string array is then bound to the Repeater.</span></span>

<span data-ttu-id="03032-173">Infine, dobbiamo chiamare questi due metodi, quando la pagina viene caricata.</span><span class="sxs-lookup"><span data-stu-id="03032-173">Finally, we need to call these two methods when the page is first loaded.</span></span> <span data-ttu-id="03032-174">Aggiungere il codice seguente al gestore eventi `Page_Load` :</span><span class="sxs-lookup"><span data-stu-id="03032-174">Add the following code to the `Page_Load` event handler:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample6.cs)]

<span data-ttu-id="03032-175">Con questo codice, si consiglia di visitare la pagina tramite un browser. la schermata dovrebbe essere simile alla figura 2.</span><span class="sxs-lookup"><span data-stu-id="03032-175">With this code in place, take a moment to visit the page through a browser; your screen should look similar to Figure 2.</span></span> <span data-ttu-id="03032-176">Tutti gli account utente vengono popolati nell'elenco a discesa elenco e, di sotto, ogni ruolo viene visualizzato come una casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="03032-176">All of the user accounts are populated in the drop-down list and, underneath that, each role appears as a checkbox.</span></span> <span data-ttu-id="03032-177">Perché lo abbiamo impostato il `AutoPostBack` proprietà del controllo DropDownList e caselle di controllo su True, modifica utente selezionato o selezionare o deselezionare un ruolo determina un postback.</span><span class="sxs-lookup"><span data-stu-id="03032-177">Because we set the `AutoPostBack` properties of the DropDownList and CheckBoxes to True, changing the selected user or checking or unchecking a role causes a postback.</span></span> <span data-ttu-id="03032-178">Viene eseguita alcuna azione, tuttavia, poiché è ancora necessario scrivere codice per gestire queste azioni.</span><span class="sxs-lookup"><span data-stu-id="03032-178">No action is performed, however, because we have yet to write code to handle these actions.</span></span> <span data-ttu-id="03032-179">Che verranno affrontati queste attività in due sezioni successive.</span><span class="sxs-lookup"><span data-stu-id="03032-179">We'll tackle these tasks in the next two sections.</span></span>


[![T<span data-ttu-id="03032-180">egli pagina consente di visualizzare gli utenti e ruoli]</span><span class="sxs-lookup"><span data-stu-id="03032-180">he Page Displays the Users and Roles]</span></span>(assigning-roles-to-users-cs/_static/image5.png)](assigning-roles-to-users-cs/_static/image4.png)

<span data-ttu-id="03032-181">**Figura 2**: La pagina Visualizza gli utenti e ruoli ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="03032-181">**Figure 2**: The Page Displays the Users and Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image6.png))</span></span>


### <a name="checking-the-roles-the-selected-user-belongs-to"></a><span data-ttu-id="03032-182">Controllare i ruoli selezionato appartiene l'utente</span><span class="sxs-lookup"><span data-stu-id="03032-182">Checking the Roles the Selected User Belongs To</span></span>

<span data-ttu-id="03032-183">Quando la pagina viene caricata o ogni volta che il visitatore consente di selezionare un nuovo utente nell'elenco a discesa, è necessario aggiornare il `UsersRoleList`di caselle di controllo in modo che un determinato ruolo casella di controllo solo se l'utente selezionato appartiene a tale ruolo.</span><span class="sxs-lookup"><span data-stu-id="03032-183">When the page is first loaded, or whenever the visitor selects a new user from the drop-down list, we need to update the `UsersRoleList`'s checkboxes so that a given role checkbox is checked only if the selected user belongs to that role.</span></span> <span data-ttu-id="03032-184">A tale scopo, creare un metodo denominato `CheckRolesForSelectedUser` con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="03032-184">To accomplish this, create a method named `CheckRolesForSelectedUser` with the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample7.cs)]

<span data-ttu-id="03032-185">Il codice sopra riportato viene avviato, determinando l'utente selezionato.</span><span class="sxs-lookup"><span data-stu-id="03032-185">The above code starts by determining who the selected user is.</span></span> <span data-ttu-id="03032-186">Quindi utilizza la classe di ruoli [ `GetRolesForUser(userName)` metodo](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) restituire set di ruoli come una matrice di stringhe dell'utente specificato.</span><span class="sxs-lookup"><span data-stu-id="03032-186">It then uses the Roles class's [`GetRolesForUser(userName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) to return the specified user's set of roles as a string array.</span></span> <span data-ttu-id="03032-187">Successivamente, vengono enumerati gli elementi del controllo Repeater e ogni elemento `RoleCheckBox` casella di controllo a livello di codice viene fatto riferimento.</span><span class="sxs-lookup"><span data-stu-id="03032-187">Next, the Repeater's items are enumerated and each item's `RoleCheckBox` CheckBox is programmatically referenced.</span></span> <span data-ttu-id="03032-188">La casella di controllo è selezionata solo se il ruolo corrisponde a è contenuto all'interno di `selectedUsersRoles` matrice di stringhe.</span><span class="sxs-lookup"><span data-stu-id="03032-188">The CheckBox is checked only if the role it corresponds to is contained within the `selectedUsersRoles` string array.</span></span>

> [!NOTE]
> <span data-ttu-id="03032-189">Il `selectedUserRoles.Contains<string>(...)` sintassi non verrà compilato se si usa ASP.NET versione 2.0.</span><span class="sxs-lookup"><span data-stu-id="03032-189">The `selectedUserRoles.Contains<string>(...)` syntax will not compile if you are using ASP.NET version 2.0.</span></span> <span data-ttu-id="03032-190">Il `Contains<string>` metodo fa parte il [libreria LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query), che è una novità di ASP.NET 3.5.</span><span class="sxs-lookup"><span data-stu-id="03032-190">The `Contains<string>` method is part of the [LINQ library](http://en.wikipedia.org/wiki/Language_Integrated_Query), which is new to ASP.NET 3.5.</span></span> <span data-ttu-id="03032-191">Se si sta ancora usando ASP.NET versione 2.0, usare il [ `Array.IndexOf<string>` metodo](https://msdn.microsoft.com/library/eha9t187.aspx) invece.</span><span class="sxs-lookup"><span data-stu-id="03032-191">If you are still using ASP.NET version 2.0, use the [`Array.IndexOf<string>` method](https://msdn.microsoft.com/library/eha9t187.aspx) instead.</span></span>


<span data-ttu-id="03032-192">Il `CheckRolesForSelectedUser` metodo deve essere chiamata in due casi: quando la pagina viene caricata e ogni volta che il `UserList` indice selezionato del controllo DropDownList è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="03032-192">The `CheckRolesForSelectedUser` method needs to be called in two cases: when the page is first loaded and whenever the `UserList` DropDownList's selected index is changed.</span></span> <span data-ttu-id="03032-193">Pertanto, chiamare questo metodo dal `Page_Load` gestore dell'evento (dopo le chiamate a `BindUsersToUserList` e `BindRolesToList`).</span><span class="sxs-lookup"><span data-stu-id="03032-193">Therefore, call this method from the `Page_Load` event handler (after the calls to `BindUsersToUserList` and `BindRolesToList`).</span></span> <span data-ttu-id="03032-194">Inoltre, creare un gestore eventi per il controllo DropDownList `SelectedIndexChanged` eventi e chiamare il metodo da tale posizione.</span><span class="sxs-lookup"><span data-stu-id="03032-194">Also, create an event handler for the DropDownList's `SelectedIndexChanged` event and call this method from there.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample8.cs)]

<span data-ttu-id="03032-195">Con questo codice, è possibile testare la pagina tramite il browser.</span><span class="sxs-lookup"><span data-stu-id="03032-195">With this code in place, you can test the page through the browser.</span></span> <span data-ttu-id="03032-196">Tuttavia, poiché il `UsersAndRoles.aspx` pagina attualmente non ha la possibilità di assegnare utenti a ruoli, gli utenti non hanno i ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-196">However, since the `UsersAndRoles.aspx` page currently lacks the ability to assign users to roles, no users have roles.</span></span> <span data-ttu-id="03032-197">Verrà creata l'interfaccia per l'assegnazione di utenti ai ruoli in qualche secondo, in modo che è possibile sfruttare la parola che questo codice funziona e verificare che esegue l'operazione in un secondo momento, oppure è possibile aggiungere manualmente utenti ai ruoli mediante l'inserimento di record nel `aspnet_UsersInRoles` tabella per testare questo functi a questo punto onality.</span><span class="sxs-lookup"><span data-stu-id="03032-197">We will create the interface for assigning users to roles in a moment, so you can either take my word that this code works and verify that it does so later, or you can manually add users to roles by inserting records into the `aspnet_UsersInRoles` table in order to test this functionality now.</span></span>

### <a name="assigning-and-removing-users-from-roles"></a><span data-ttu-id="03032-198">Assegnazione e rimuovendo utenti dai ruoli</span><span class="sxs-lookup"><span data-stu-id="03032-198">Assigning and Removing Users from Roles</span></span>

<span data-ttu-id="03032-199">Quando il visitatore controlla o deseleziona una casella di controllo nel `UsersRoleList` Repeater, dobbiamo aggiungere o rimuovere l'utente selezionato dal ruolo corrispondente.</span><span class="sxs-lookup"><span data-stu-id="03032-199">When the visitor checks or unchecks a CheckBox in the `UsersRoleList` Repeater we need to add or remove the selected user from the corresponding role.</span></span> <span data-ttu-id="03032-200">La casella di controllo `AutoPostBack` viene attualmente impostata su True, che determina un postback in qualsiasi momento una casella di controllo nel Repeater è selezionato o deselezionato.</span><span class="sxs-lookup"><span data-stu-id="03032-200">The CheckBox's `AutoPostBack` property is currently set to True, which causes a postback anytime a CheckBox in the Repeater is checked or unchecked.</span></span> <span data-ttu-id="03032-201">In breve, è necessario creare un gestore eventi per la casella di controllo `CheckChanged` evento.</span><span class="sxs-lookup"><span data-stu-id="03032-201">In short, we need to create an event handler for the CheckBox's `CheckChanged` event.</span></span> <span data-ttu-id="03032-202">Poiché la casella di controllo si trova in un controllo Repeater, è necessario aggiungere manualmente l'impianto di gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="03032-202">Since the CheckBox is in a Repeater control, we need to manually add the event handler plumbing.</span></span> <span data-ttu-id="03032-203">Iniziare aggiungendo il gestore eventi per la classe code-behind come un `protected` metodo, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="03032-203">Start by adding the event handler to the code-behind class as a `protected` method, like so:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample9.cs)]

<span data-ttu-id="03032-204">Verranno restituiti per scrivere il codice per questo gestore eventi a breve.</span><span class="sxs-lookup"><span data-stu-id="03032-204">We will return to write the code for this event handler in a moment.</span></span> <span data-ttu-id="03032-205">Prima di tutto punto è necessario completare le operazioni di base di gestione degli eventi.</span><span class="sxs-lookup"><span data-stu-id="03032-205">But first let's complete the event handling plumbing.</span></span> <span data-ttu-id="03032-206">Dalla casella di controllo all'interno di Repeater `ItemTemplate`, aggiungere `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span><span class="sxs-lookup"><span data-stu-id="03032-206">From the CheckBox within the Repeater's `ItemTemplate`, add `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span></span> <span data-ttu-id="03032-207">Collega questa sintassi il `RoleCheckBox_CheckChanged` gestore dell'evento per il `RoleCheckBox`del `CheckedChanged` evento.</span><span class="sxs-lookup"><span data-stu-id="03032-207">This syntax wires the `RoleCheckBox_CheckChanged` event handler to the `RoleCheckBox`'s `CheckedChanged` event.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample10.aspx)]

<span data-ttu-id="03032-208">L'attività finale consiste nel completare il `RoleCheckBox_CheckChanged` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="03032-208">Our final task is to complete the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="03032-209">È necessario iniziare facendo riferimento il controllo casella di controllo che ha generato l'evento, perché questa istanza casella di controllo per indicare quale ruolo è stato selezionato o deselezionato tramite relativi `Text` e `Checked` proprietà.</span><span class="sxs-lookup"><span data-stu-id="03032-209">We need to start by referencing the CheckBox control that raised the event because this CheckBox instance tells us what role was checked or unchecked via its `Text` and `Checked` properties.</span></span> <span data-ttu-id="03032-210">Queste informazioni e il nome utente dell'utente selezionato è aggiungere o rimuovere l'utente dal ruolo tramite il `Roles` della classe [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) oppure [ `RemoveUserFromRole` metodo](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span><span class="sxs-lookup"><span data-stu-id="03032-210">Using this information along with the UserName of the selected user, we add or remove the user from the role via the `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) or [`RemoveUserFromRole` method](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample11.cs)]

<span data-ttu-id="03032-211">Il codice sopra riportato viene avviato a livello di codice facendo riferimento alla casella di controllo che ha generato l'evento, che è disponibile tramite il `sender` parametro di input.</span><span class="sxs-lookup"><span data-stu-id="03032-211">The above code starts by programmatically referencing the CheckBox that raised the event, which is available via the `sender` input parameter.</span></span> <span data-ttu-id="03032-212">Se la casella di controllo è selezionata, l'utente selezionato viene aggiunto al ruolo specificato, in caso contrario, che vengono rimossi dal ruolo.</span><span class="sxs-lookup"><span data-stu-id="03032-212">If the CheckBox is checked, the selected user is added to the specified role, otherwise they are removed from the role.</span></span> <span data-ttu-id="03032-213">In entrambi i casi il `ActionStatus` etichetta viene visualizzato un messaggio di riepilogo l'azione appena eseguita.</span><span class="sxs-lookup"><span data-stu-id="03032-213">In either case, the `ActionStatus` Label displays a message summarizing the action just performed.</span></span>

<span data-ttu-id="03032-214">Si consiglia di testare questa pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="03032-214">Take a moment to test out this page through a browser.</span></span> <span data-ttu-id="03032-215">Selezionare utente Tito e quindi aggiungere Tito ai supervisori sia agli amministratori di ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-215">Select user Tito and then add Tito to both the Administrators and Supervisors roles.</span></span>


[![T<span data-ttu-id="03032-216">Ito è stato aggiunto per gli amministratori e ruoli supervisori]</span><span class="sxs-lookup"><span data-stu-id="03032-216">ito Has Been Added to the Administrators and Supervisors Roles]</span></span>(assigning-roles-to-users-cs/_static/image8.png)](assigning-roles-to-users-cs/_static/image7.png)

<span data-ttu-id="03032-217">**Figura 3**: Tito è stato aggiunto per gli amministratori e ruoli supervisori ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="03032-217">**Figure 3**: Tito Has Been Added to the Administrators and Supervisors Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image9.png))</span></span>


<span data-ttu-id="03032-218">Selezionare quindi l'utente Bruce nell'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="03032-218">Next, select user Bruce from the drop-down list.</span></span> <span data-ttu-id="03032-219">È presente un postback e caselle di controllo del controllo Repeater vengono aggiornati tramite il `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="03032-219">There is a postback and the Repeater's CheckBoxes are updated via the `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="03032-220">Poiché Bruce ancora non appartiene ad alcun ruolo, le due caselle di controllo sono deselezionati.</span><span class="sxs-lookup"><span data-stu-id="03032-220">Since Bruce does not yet belong to any roles, the two checkboxes are unchecked.</span></span> <span data-ttu-id="03032-221">Aggiungere quindi Bruce al ruolo supervisori.</span><span class="sxs-lookup"><span data-stu-id="03032-221">Next, add Bruce to the Supervisors role.</span></span>


[![B<span data-ttu-id="03032-222">ruce è stato aggiunto al ruolo supervisori]</span><span class="sxs-lookup"><span data-stu-id="03032-222">ruce Has Been Added to the Supervisors Role]</span></span>(assigning-roles-to-users-cs/_static/image11.png)](assigning-roles-to-users-cs/_static/image10.png)

<span data-ttu-id="03032-223">**Figura 4**: Bruce è stato aggiunto al ruolo supervisori ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="03032-223">**Figure 4**: Bruce Has Been Added to the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image12.png))</span></span>


<span data-ttu-id="03032-224">Per verificare ulteriormente le funzionalità del `CheckRolesForSelectedUser` (metodo), selezionare un utente diverso da Tito o Bruce.</span><span class="sxs-lookup"><span data-stu-id="03032-224">To further verify the functionality of the `CheckRolesForSelectedUser` method, select a user other than Tito or Bruce.</span></span> <span data-ttu-id="03032-225">Si noti come le caselle di controllo sono automaticamente deselezionati, che indica che non appartiene ad alcun ruolo.</span><span class="sxs-lookup"><span data-stu-id="03032-225">Note how the checkboxes are automatically unchecked, denoting that they do not belong to any roles.</span></span> <span data-ttu-id="03032-226">Tornare a Tito.</span><span class="sxs-lookup"><span data-stu-id="03032-226">Return to Tito.</span></span> <span data-ttu-id="03032-227">È necessario verificare i supervisori sia agli amministratori di caselle di controllo.</span><span class="sxs-lookup"><span data-stu-id="03032-227">Both the Administrators and Supervisors checkboxes should be checked.</span></span>

## <a name="step-2-building-the-by-roles-user-interface"></a><span data-ttu-id="03032-228">Passaggio 2: Creazione dell'interfaccia utente "Dai ruoli"</span><span class="sxs-lookup"><span data-stu-id="03032-228">Step 2: Building the "By Roles" User Interface</span></span>

<span data-ttu-id="03032-229">A questo punto si have completato l'interfaccia "dagli utenti" e pronti a iniziare affronta l'interfaccia "dai ruoli".</span><span class="sxs-lookup"><span data-stu-id="03032-229">At this point we have completed the "by users" interface and are ready to start tackling the "by roles" interface.</span></span> <span data-ttu-id="03032-230">L'interfaccia "dai ruoli" richiede all'utente di selezionare un ruolo da un elenco di riepilogo a discesa e quindi Visualizza il set di utenti che appartengono a tale ruolo in un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="03032-230">The "by roles" interface prompts the user to select a role from a drop-down list and then displays the set of users that belong to that role in a GridView.</span></span>

<span data-ttu-id="03032-231">Aggiungere un altro controllo DropDownList per il `UsersAndRoles.aspx` pagina.</span><span class="sxs-lookup"><span data-stu-id="03032-231">Add another DropDownList control to the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="03032-232">Posizionare il presente sotto il controllo Repeater, denominarlo `RoleList`e impostare il `AutoPostBack` proprietà su True.</span><span class="sxs-lookup"><span data-stu-id="03032-232">Place this one beneath the Repeater control, name it `RoleList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="03032-233">Di sotto, aggiungere un controllo GridView e denominarlo `RolesUserList`.</span><span class="sxs-lookup"><span data-stu-id="03032-233">Underneath that, add a GridView and name it `RolesUserList`.</span></span> <span data-ttu-id="03032-234">Questo controllo GridView elencherà gli utenti che appartengono al ruolo selezionato.</span><span class="sxs-lookup"><span data-stu-id="03032-234">This GridView will list the users that belong to the selected role.</span></span> <span data-ttu-id="03032-235">Impostare il controllo GridView `AutoGenerateColumns` la proprietà su False, aggiungere un TemplateField alla griglia `Columns` raccolta e set relativo `HeaderText` proprietà su "Utenti".</span><span class="sxs-lookup"><span data-stu-id="03032-235">Set the GridView's `AutoGenerateColumns` property to False, add a TemplateField to the grid's `Columns` collection, and set its `HeaderText` property to "Users".</span></span> <span data-ttu-id="03032-236">Definire il TemplateField `ItemTemplate` in modo che venga visualizzato il valore dell'espressione di Data Binding `Container.DataItem` nel `Text` proprietà di un'etichetta denominata `UserNameLabel`.</span><span class="sxs-lookup"><span data-stu-id="03032-236">Define the TemplateField's `ItemTemplate` so that it displays the value of the databinding expression `Container.DataItem` in the `Text` property of a Label named `UserNameLabel`.</span></span>

<span data-ttu-id="03032-237">Dopo l'aggiunta e configurazione di GridView, markup dichiarativo dell'interfaccia "dal ruolo" dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="03032-237">After adding and configuring the GridView, your "by role" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample12.aspx)]

<span data-ttu-id="03032-238">È necessario popolare il `RoleList` DropDownList con il set di ruoli del sistema.</span><span class="sxs-lookup"><span data-stu-id="03032-238">We need to populate the `RoleList` DropDownList with the set of roles in the system.</span></span> <span data-ttu-id="03032-239">A tale scopo, aggiornare il `BindRolesToList` metodo in modo che associa la matrice di stringhe restituito dal `Roles.GetAllRoles` metodo per il `RolesList` DropDownList (così come il `UsersRoleList` Repeater).</span><span class="sxs-lookup"><span data-stu-id="03032-239">To accomplish this, update the `BindRolesToList` method so that is binds the string array returned by the `Roles.GetAllRoles` method to the `RolesList` DropDownList (as well as the `UsersRoleList` Repeater).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample13.cs)]

<span data-ttu-id="03032-240">Le ultime due righe nel `BindRolesToList` metodo sono state aggiunte ad per associare il set di ruoli per il `RoleList` controllo DropDownList.</span><span class="sxs-lookup"><span data-stu-id="03032-240">The last two lines in the `BindRolesToList` method have been added to bind the set of roles to the `RoleList` DropDownList control.</span></span> <span data-ttu-id="03032-241">Figura 5 mostra il risultato finale quando viene visualizzato tramite un browser, un elenco di riepilogo a discesa popolato con i ruoli del sistema.</span><span class="sxs-lookup"><span data-stu-id="03032-241">Figure 5 shows the end result when viewed through a browser – a drop-down list populated with the system's roles.</span></span>


[![T<span data-ttu-id="03032-242">he ruoli vengono visualizzati in RoleList DropDownList]</span><span class="sxs-lookup"><span data-stu-id="03032-242">he Roles are Displayed in the RoleList DropDownList]</span></span>(assigning-roles-to-users-cs/_static/image14.png)](assigning-roles-to-users-cs/_static/image13.png)

<span data-ttu-id="03032-243">**Figura 5**: I ruoli vengono visualizzati nei `RoleList` DropDownList ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="03032-243">**Figure 5**: The Roles are Displayed in the `RoleList` DropDownList  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image15.png))</span></span>


### <a name="displaying-the-users-that-belong-to-the-selected-role"></a><span data-ttu-id="03032-244">Visualizzare gli utenti che appartengono al ruolo selezionato</span><span class="sxs-lookup"><span data-stu-id="03032-244">Displaying the Users That Belong To the Selected Role</span></span>

<span data-ttu-id="03032-245">Quando la pagina viene caricata oppure quando è selezionato un nuovo ruolo dal `RoleList` DropDownList, è necessario visualizzare l'elenco di utenti che appartengono a tale ruolo in GridView.</span><span class="sxs-lookup"><span data-stu-id="03032-245">When the page is first loaded, or when a new role is selected from the `RoleList` DropDownList, we need to display the list of users that belong to that role in the GridView.</span></span> <span data-ttu-id="03032-246">Creare un metodo denominato `DisplayUsersBelongingToRole` usando il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="03032-246">Create a method named `DisplayUsersBelongingToRole` using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample14.cs)]

<span data-ttu-id="03032-247">Il metodo inizia recuperando il ruolo selezionato dal `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="03032-247">This method starts by getting the selected role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="03032-248">Quindi, utilizza il [ `Roles.GetUsersInRole(roleName)` metodo](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) per recuperare una matrice di stringhe dei nomi utente degli utenti che appartengono a tale ruolo.</span><span class="sxs-lookup"><span data-stu-id="03032-248">It then uses the [`Roles.GetUsersInRole(roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) to retrieve a string array of the UserNames of the users that belong to that role.</span></span> <span data-ttu-id="03032-249">Questa matrice viene quindi associata ai `RolesUserList` GridView.</span><span class="sxs-lookup"><span data-stu-id="03032-249">This array is then bound to the `RolesUserList` GridView.</span></span>

<span data-ttu-id="03032-250">Questo metodo deve essere chiamata in due casi: quando la pagina viene caricata inizialmente e quando il ruolo selezionato nel `RoleList` DropDownList modifiche.</span><span class="sxs-lookup"><span data-stu-id="03032-250">This method needs to be called in two circumstances: when the page is initially loaded and when the selected role in the `RoleList` DropDownList changes.</span></span> <span data-ttu-id="03032-251">Di conseguenza, aggiornare il `Page_Load` gestore dell'evento in modo che questo metodo viene richiamato dopo la chiamata a `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="03032-251">Therefore, update the `Page_Load` event handler so that this method is invoked after the call to `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="03032-252">Successivamente, creare un gestore eventi per il `RoleList`del `SelectedIndexChanged` evento e questo metodo viene chiamato da qui, troppo.</span><span class="sxs-lookup"><span data-stu-id="03032-252">Next, create an event handler for the `RoleList`'s `SelectedIndexChanged` event, and call this method from there, too.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample15.cs)]

<span data-ttu-id="03032-253">Con questo codice attivo, il `RolesUserList` GridView deve visualizzare gli utenti che appartengono al ruolo selezionato.</span><span class="sxs-lookup"><span data-stu-id="03032-253">With this code in place, the `RolesUserList` GridView should display those users that belong to the selected role.</span></span> <span data-ttu-id="03032-254">Come illustrato nella figura 6, il ruolo supervisori è costituito da due membri: Bruce e Tito.</span><span class="sxs-lookup"><span data-stu-id="03032-254">As Figure 6 shows, the Supervisors role consists of two members: Bruce and Tito.</span></span>


[![T<span data-ttu-id="03032-255">GridView sono elencati gli utenti che appartengono al ruolo selezionato]</span><span class="sxs-lookup"><span data-stu-id="03032-255">he GridView Lists Those Users That Belong to the Selected Role]</span></span>(assigning-roles-to-users-cs/_static/image17.png)](assigning-roles-to-users-cs/_static/image16.png)

<span data-ttu-id="03032-256">**Figura 6**: I GridView sono elencati quelli gli utenti che appartengono al ruolo selezionato ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="03032-256">**Figure 6**: The GridView Lists Those Users That Belong to the Selected Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image18.png))</span></span>


### <a name="removing-users-from-the-selected-role"></a><span data-ttu-id="03032-257">Rimozione di utenti dal ruolo selezionato</span><span class="sxs-lookup"><span data-stu-id="03032-257">Removing Users from the Selected Role</span></span>

<span data-ttu-id="03032-258">È possibile aumentare il `RolesUserList` GridView in modo che includa una colonna di "Rimuovi" pulsanti.</span><span class="sxs-lookup"><span data-stu-id="03032-258">Let's augment the `RolesUserList` GridView so that it includes a column of "Remove" buttons.</span></span> <span data-ttu-id="03032-259">Facendo clic sul pulsante "Rimuovi" per un particolare utente verranno rimossi da tale ruolo.</span><span class="sxs-lookup"><span data-stu-id="03032-259">Clicking the "Remove" button for a particular user will remove them from that role.</span></span>

<span data-ttu-id="03032-260">Iniziare aggiungendo un campo pulsante Delete a GridView.</span><span class="sxs-lookup"><span data-stu-id="03032-260">Start by adding a Delete button field to the GridView.</span></span> <span data-ttu-id="03032-261">Impostare questo campo vengono visualizzati come più segnalato sinistra e modificare le `DeleteText` proprietà da "Delete" (predefinito) a "Remove".</span><span class="sxs-lookup"><span data-stu-id="03032-261">Make this field appear as the left most filed and change its `DeleteText` property from "Delete" (the default) to "Remove".</span></span>


[![A<span data-ttu-id="03032-262">GG il]</span><span class="sxs-lookup"><span data-stu-id="03032-262">dd the]</span></span>(assigning-roles-to-users-cs/_static/image20.png)](assigning-roles-to-users-cs/_static/image19.png)

<span data-ttu-id="03032-263">**Figura 7**: Aggiungere il pulsante "Rimuovi" per il controllo GridView ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="03032-263">**Figure 7**: Add the "Remove" Button to the GridView  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image21.png))</span></span>


<span data-ttu-id="03032-264">Quando si fa clic sul pulsante "Rimuovi" un postback previsioni e del controllo GridView `RowDeleting` viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="03032-264">When the "Remove" button is clicked a postback ensues and the GridView's `RowDeleting` event is raised.</span></span> <span data-ttu-id="03032-265">È necessario creare un gestore eventi per questo evento e scrivere il codice che consente di rimuovere l'utente dal ruolo selezionato.</span><span class="sxs-lookup"><span data-stu-id="03032-265">We need to create an event handler for this event and write code that removes the user from the selected role.</span></span> <span data-ttu-id="03032-266">Creare il gestore dell'evento e quindi aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="03032-266">Create the event handler and then add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample16.cs)]

<span data-ttu-id="03032-267">Il codice avvia determinando il nome del ruolo selezionato.</span><span class="sxs-lookup"><span data-stu-id="03032-267">The code starts by determining the selected role name.</span></span> <span data-ttu-id="03032-268">Viene quindi a livello di programmazione i riferimenti di `UserNameLabel` controllo dalla riga di cui è stato fatto clic sul cui pulsante "Rimuovi" per determinare il nome utente dell'utente da rimuovere.</span><span class="sxs-lookup"><span data-stu-id="03032-268">It then programmatically references the `UserNameLabel` control from the row whose "Remove" button was clicked in order to determine the UserName of the user to remove.</span></span> <span data-ttu-id="03032-269">L'utente viene quindi rimosso dal ruolo tramite una chiamata verso la `Roles.RemoveUserFromRole` (metodo).</span><span class="sxs-lookup"><span data-stu-id="03032-269">The user is then removed from the role via a call to the `Roles.RemoveUserFromRole` method.</span></span> <span data-ttu-id="03032-270">Il `RolesUserList` GridView vengono quindi aggiornati e viene visualizzato un messaggio tramite la `ActionStatus` controllo etichetta.</span><span class="sxs-lookup"><span data-stu-id="03032-270">The `RolesUserList` GridView is then refreshed and a message is displayed via the `ActionStatus` Label control.</span></span>

> [!NOTE]
> <span data-ttu-id="03032-271">Il pulsante "Rimuovi" non richiede una sorta di conferma da parte dell'utente prima di rimuovere l'utente dal ruolo.</span><span class="sxs-lookup"><span data-stu-id="03032-271">The "Remove" button does not require any sort of confirmation from the user before removing the user from the role.</span></span> <span data-ttu-id="03032-272">È consigliabile aggiungere un certo livello di conferma dell'utente.</span><span class="sxs-lookup"><span data-stu-id="03032-272">I invite you to add some level of user confirmation.</span></span> <span data-ttu-id="03032-273">Uno dei modi più semplici per confermare un'azione è tramite una finestra di dialogo di conferma dal lato client.</span><span class="sxs-lookup"><span data-stu-id="03032-273">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="03032-274">Per altre informazioni su questa tecnica, vedere [aggiunta di conferma dal lato Client quando Elimina](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span><span class="sxs-lookup"><span data-stu-id="03032-274">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span></span>


<span data-ttu-id="03032-275">Figura 8 mostra la pagina dopo che l'utente Tito è stato rimosso dal gruppo supervisori.</span><span class="sxs-lookup"><span data-stu-id="03032-275">Figure 8 shows the page after user Tito has been removed from the Supervisors group.</span></span>


[![A<span data-ttu-id="03032-276">Las, Tito non è più un supervisore]</span><span class="sxs-lookup"><span data-stu-id="03032-276">las, Tito is No Longer a Supervisor]</span></span>(assigning-roles-to-users-cs/_static/image23.png)](assigning-roles-to-users-cs/_static/image22.png)

<span data-ttu-id="03032-277">**Figura 8**: Che si verifichi Tito non è più un supervisore ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="03032-277">**Figure 8**: Alas, Tito is No Longer a Supervisor  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image24.png))</span></span>


### <a name="adding-new-users-to-the-selected-role"></a><span data-ttu-id="03032-278">Aggiunta di nuovi utenti al ruolo selezionato</span><span class="sxs-lookup"><span data-stu-id="03032-278">Adding New Users to the Selected Role</span></span>

<span data-ttu-id="03032-279">Con la rimozione di utenti dal ruolo selezionato, il visitatore per questa pagina inoltre deve essere in grado di aggiungere un utente al ruolo selezionato.</span><span class="sxs-lookup"><span data-stu-id="03032-279">Along with removing users from the selected role, the visitor to this page should also be able to add a user to the selected role.</span></span> <span data-ttu-id="03032-280">L'interfaccia ottimo per l'aggiunta di un utente al ruolo selezionato dipende dal numero di account utente che previsti.</span><span class="sxs-lookup"><span data-stu-id="03032-280">The best interface for adding a user to the selected role depends on the number of user accounts you expect to have.</span></span> <span data-ttu-id="03032-281">Se il sito Web conterrà solo alcuni account utente dozzine o meno, è possibile usare un controllo DropDownList qui.</span><span class="sxs-lookup"><span data-stu-id="03032-281">If your website will house just a few dozen user accounts or less, you could use a DropDownList here.</span></span> <span data-ttu-id="03032-282">Se potrebbero essere presenti migliaia di account utente, si desidera includere un'interfaccia utente che consente il visitatore per spostarsi tra gli account, cercare un account specifico, o filtrare gli account utente in qualche altro modo.</span><span class="sxs-lookup"><span data-stu-id="03032-282">If there might be thousands of user accounts, you would want to include a user interface that permits the visitor to page through the accounts, search for a particular account, or filter the user accounts in some other fashion.</span></span>

<span data-ttu-id="03032-283">Per questa pagina è possibile usare un'interfaccia molto semplice che funziona indipendentemente dal numero di account utente nel sistema.</span><span class="sxs-lookup"><span data-stu-id="03032-283">For this page let's use a very simple interface that works regardless of the number of user accounts in the system.</span></span> <span data-ttu-id="03032-284">In particolare, si userà una casella di testo, che richiede il visitatore per digitare il nome utente dell'utente che vuole aggiungere al ruolo selezionato.</span><span class="sxs-lookup"><span data-stu-id="03032-284">Namely, we will use a TextBox, prompting the visitor to type in the username of the user she wants to add to the selected role.</span></span> <span data-ttu-id="03032-285">Se non esiste alcun utente con lo stesso nome, o se l'utente è già un membro del ruolo, verrà visualizzato un messaggio in `ActionStatus` etichetta.</span><span class="sxs-lookup"><span data-stu-id="03032-285">If no user with that name exists, or if the user is already a member of the role, we'll display a message in `ActionStatus` Label.</span></span> <span data-ttu-id="03032-286">Ma se l'utente esiste e non è un membro del ruolo, si verrà aggiunti al ruolo e aggiornare la griglia.</span><span class="sxs-lookup"><span data-stu-id="03032-286">But if the user exists and is not a member of the role, we'll add them to the role and refresh the grid.</span></span>

<span data-ttu-id="03032-287">Aggiungere una casella di testo e un pulsante sotto il controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="03032-287">Add a TextBox and Button beneath the GridView.</span></span> <span data-ttu-id="03032-288">Impostare la casella di testo `ID` al `UserNameToAddToRole` e impostare il pulsante `ID` e `Text` le proprietà da `AddUserToRoleButton` e "Aggiunta al ruolo utente", rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="03032-288">Set the TextBox's `ID` to `UserNameToAddToRole` and set the Button's `ID` and `Text` properties to `AddUserToRoleButton` and "Add User to Role", respectively.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample17.aspx)]

<span data-ttu-id="03032-289">A questo punto, creare un `Click` gestore dell'evento per il `AddUserToRoleButton` e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="03032-289">Next, create a `Click` event handler for the `AddUserToRoleButton` and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample18.cs)]

<span data-ttu-id="03032-290">La maggior parte del codice di `Click` gestore eventi esegue vari controlli di convalida.</span><span class="sxs-lookup"><span data-stu-id="03032-290">The majority of the code in the `Click` event handler performs various validation checks.</span></span> <span data-ttu-id="03032-291">Assicura che il visitatore specificato un nome utente nel `UserNameToAddToRole` casella di testo che l'utente esiste nel sistema e che non appartengono già al ruolo selezionato.</span><span class="sxs-lookup"><span data-stu-id="03032-291">It ensures that the visitor supplied a username in the `UserNameToAddToRole` TextBox, that the user exists in the system, and that they don't already belong to the selected role.</span></span> <span data-ttu-id="03032-292">Se uno di questi controlli ha esito negativo, viene visualizzato un messaggio appropriato nella `ActionStatus` e il gestore dell'evento è terminato.</span><span class="sxs-lookup"><span data-stu-id="03032-292">If any of these checks fails, an appropriate message is displayed in `ActionStatus` and the event handler is exited.</span></span> <span data-ttu-id="03032-293">Se tutti i controlli di esito positivo, l'utente viene aggiunto al ruolo tramite il `Roles.AddUserToRole` (metodo).</span><span class="sxs-lookup"><span data-stu-id="03032-293">If all of the checks pass, the user is added to the role via the `Roles.AddUserToRole` method.</span></span> <span data-ttu-id="03032-294">In seguito, la casella di testo del `Text` proprietà è stata rimossa, il controllo GridView, viene aggiornato e `ActionStatus` etichetta viene visualizzato un messaggio che indica che l'utente specificato sia stato aggiunto correttamente al ruolo selezionato.</span><span class="sxs-lookup"><span data-stu-id="03032-294">Following that, the TextBox's `Text` property is cleared out, the GridView is refreshed, and the `ActionStatus` Label displays a message indicating that the specified user was successfully added to the selected role.</span></span>

> [!NOTE]
> <span data-ttu-id="03032-295">Per assicurarsi che l'utente specificato non appartiene già al ruolo selezionato, viene usato il [ `Roles.IsUserInRole(userName, roleName)` metodo](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), che restituisce un valore booleano che indica se *userName* è un membro del *roleName*.</span><span class="sxs-lookup"><span data-stu-id="03032-295">To ensure that the specified user does not already belong to the selected role, we use the [`Roles.IsUserInRole(userName, roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), which returns a Boolean value indicating whether *userName* is a member of *roleName*.</span></span> <span data-ttu-id="03032-296">Si userà questo metodo nuovamente nel <a id="_msoanchor_2"> </a> [esercitazione successiva](role-based-authorization-cs.md) quando si esamina l'autorizzazione basata sui ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-296">We will use this method again in the <a id="_msoanchor_2"></a>[next tutorial](role-based-authorization-cs.md) when we look at role-based authorization.</span></span>


<span data-ttu-id="03032-297">Visita la pagina tramite un browser e selezionare il ruolo supervisori dal `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="03032-297">Visit the page through a browser and select the Supervisors role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="03032-298">Provare a immettere un nome utente non valido, verrà visualizzato un messaggio che spiega che l'utente non esiste nel sistema.</span><span class="sxs-lookup"><span data-stu-id="03032-298">Try entering an invalid username – you should see a message explaining that the user does not exist in the system.</span></span>


[![Y<span data-ttu-id="03032-299">unità organizzativa non è possibile aggiungere un utente Non esistente a un ruolo]</span><span class="sxs-lookup"><span data-stu-id="03032-299">ou Cannot Add a Non-Existent User to a Role]</span></span>(assigning-roles-to-users-cs/_static/image26.png)](assigning-roles-to-users-cs/_static/image25.png)

<span data-ttu-id="03032-300">**Figura 9**: È possibile aggiungere un utente Non esistente a un ruolo ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="03032-300">**Figure 9**: You Cannot Add a Non-Existent User to a Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image27.png))</span></span>


<span data-ttu-id="03032-301">Ora provare ad aggiungere un utente valido.</span><span class="sxs-lookup"><span data-stu-id="03032-301">Now try adding a valid user.</span></span> <span data-ttu-id="03032-302">Proseguire e aggiungere nuovamente Tito al ruolo supervisori.</span><span class="sxs-lookup"><span data-stu-id="03032-302">Go ahead and re-add Tito to the Supervisors role.</span></span>


[![T<span data-ttu-id="03032-303">Greco è ancora una volta un supervisore!]</span><span class="sxs-lookup"><span data-stu-id="03032-303">ito Is Once Again a Supervisor!]</span></span>(assigning-roles-to-users-cs/_static/image29.png)](assigning-roles-to-users-cs/_static/image28.png)

<span data-ttu-id="03032-304">**Figura 10**: Tito è ancora una volta un supervisore.</span><span class="sxs-lookup"><span data-stu-id="03032-304">**Figure 10**: Tito Is Once Again a Supervisor!</span></span>  <span data-ttu-id="03032-305">([Fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="03032-305">([Click to view full-size image](assigning-roles-to-users-cs/_static/image30.png))</span></span>


## <a name="step-3-cross-updating-the-by-user-and-by-role-interfaces"></a><span data-ttu-id="03032-306">Passaggio 3: L'aggiornamento tra la "User" e "Dal ruolo" interfacce</span><span class="sxs-lookup"><span data-stu-id="03032-306">Step 3: Cross-Updating the "By User" and "By Role" Interfaces</span></span>

<span data-ttu-id="03032-307">Il `UsersAndRoles.aspx` nella pagina sono disponibili due interfacce distinte per la gestione di utenti e ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-307">The `UsersAndRoles.aspx` page offers two distinct interfaces for managing users and roles.</span></span> <span data-ttu-id="03032-308">Attualmente, queste due interfacce di agiscono indipendentemente uno da altro, pertanto è possibile che una modifica apportata in un'unica interfaccia verrà non propagata immediatamente negli altri.</span><span class="sxs-lookup"><span data-stu-id="03032-308">Currently, these two interfaces act independently of one another so it is possible that a change made in one interface will not be reflected immediately in the other.</span></span> <span data-ttu-id="03032-309">Ad esempio, si supponga che il visitatore per la pagina Seleziona il ruolo supervisori dal `RoleList` DropDownList, in cui sono elencati Bruce e Tito come relativi membri.</span><span class="sxs-lookup"><span data-stu-id="03032-309">For example, imagine that the visitor to the page selects the Supervisors role from the `RoleList` DropDownList, which lists Bruce and Tito as its members.</span></span> <span data-ttu-id="03032-310">Successivamente, il visitatore seleziona Tito dal `UserList` DropDownList, che consente di archiviare le caselle di controllo agli amministratori e i supervisori il `UsersRoleList` Repeater.</span><span class="sxs-lookup"><span data-stu-id="03032-310">Next, the visitor selects Tito from the `UserList` DropDownList, which checks the Administrators and Supervisors checkboxes in the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="03032-311">Se il visitor deseleziona quindi il ruolo di Supervisore da Repeater, Tito viene rimosso dal ruolo supervisori, ma questa modifica non viene riflessa nell'interfaccia "dal ruolo".</span><span class="sxs-lookup"><span data-stu-id="03032-311">If the visitor then unchecks the Supervisor role from the Repeater, Tito is removed from the Supervisors role, but this modification is not reflected in the "by role" interface.</span></span> <span data-ttu-id="03032-312">Il controllo GridView viene comunque visualizzata Tito come membro del ruolo supervisori.</span><span class="sxs-lookup"><span data-stu-id="03032-312">The GridView will still show Tito as being a member of the Supervisors role.</span></span>

<span data-ttu-id="03032-313">Per risolvere il problema è necessario aggiorna il GridView ogni volta che un ruolo è selezionato o deselezionato dal `UsersRoleList` Repeater.</span><span class="sxs-lookup"><span data-stu-id="03032-313">To fix this we need to refresh the GridView whenever a role is checked or unchecked from the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="03032-314">Allo stesso modo, è necessario aggiornare il Repeater ogni volta che un utente viene rimosso o aggiunto a un ruolo dall'interfaccia "dal ruolo".</span><span class="sxs-lookup"><span data-stu-id="03032-314">Likewise, we need to refresh the Repeater whenever a user is removed or added to a role from the "by role" interface.</span></span>

<span data-ttu-id="03032-315">Il controllo Repeater nell'interfaccia "dall'utente" viene aggiornato mediante la chiamata di `CheckRolesForSelectedUser` (metodo).</span><span class="sxs-lookup"><span data-stu-id="03032-315">The Repeater in the "by user" interface is refreshed by calling the `CheckRolesForSelectedUser` method.</span></span> <span data-ttu-id="03032-316">L'interfaccia "dal ruolo" può essere modificato nel `RolesUserList` GridView `RowDeleting` gestore dell'evento e il `AddUserToRoleButton` del pulsante `Click` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="03032-316">The "by role" interface can be modified in the `RolesUserList` GridView's `RowDeleting` event handler and the `AddUserToRoleButton` Button's `Click` event handler.</span></span> <span data-ttu-id="03032-317">Di conseguenza, dobbiamo chiamare il `CheckRolesForSelectedUser` metodo da ognuno di questi metodi.</span><span class="sxs-lookup"><span data-stu-id="03032-317">Therefore, we need to call the `CheckRolesForSelectedUser` method from each of these methods.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample19.cs)]

<span data-ttu-id="03032-318">Allo stesso modo, il controllo GridView nell'interfaccia "dal ruolo" vengono aggiornati chiamando il `DisplayUsersBelongingToRole` metodo e l'interfaccia "dall'utente" viene modificato tramite la `RoleCheckBox_CheckChanged` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="03032-318">Similarly, the GridView in the "by role" interface is refreshed by calling the `DisplayUsersBelongingToRole` method and the "by user" interface is modified through the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="03032-319">Di conseguenza, dobbiamo chiamare il `DisplayUsersBelongingToRole` metodo da questo gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="03032-319">Therefore, we need to call the `DisplayUsersBelongingToRole` method from this event handler.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample20.cs)]

<span data-ttu-id="03032-320">Con queste modifiche al codice secondario, il "dall'utente" e "dal ruolo" interfacce ora correttamente cross-aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="03032-320">With these minor code changes, the "by user" and "by role" interfaces now correctly cross-update.</span></span> <span data-ttu-id="03032-321">Per verificarlo, visitare la pagina tramite un browser e selezionare Tito e supervisori dal `UserList` e `RoleList` controlli DropDownList, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="03032-321">To verify this, visit the page through a browser and select Tito and Supervisors from the `UserList` and `RoleList` DropDownLists, respectively.</span></span> <span data-ttu-id="03032-322">Si noti che quando si deseleziona il ruolo supervisori per Tito da Repeater nell'interfaccia "dall'utente", Tito viene rimosso automaticamente dalla GridView nell'interfaccia "dal ruolo".</span><span class="sxs-lookup"><span data-stu-id="03032-322">Note that as you uncheck the Supervisors role for Tito from the Repeater in the "by user" interface, Tito is automatically removed from the GridView in the "by role" interface.</span></span> <span data-ttu-id="03032-323">Aggiunta di Tito nuovamente al ruolo supervisori dall'interfaccia "dal ruolo" automaticamente controlli nuovamente la casella di controllo supervisori nell'interfaccia "dall'utente".</span><span class="sxs-lookup"><span data-stu-id="03032-323">Adding Tito back to the Supervisors role from the "by role" interface automatically re-checks the Supervisors checkbox in the "by user" interface.</span></span>

## <a name="step-4-customizing-the-createuserwizard-to-include-a-specify-roles-step"></a><span data-ttu-id="03032-324">Passaggio 4: Personalizzazione CreateUserWizard per includere un passaggio "Specificare ruoli"</span><span class="sxs-lookup"><span data-stu-id="03032-324">Step 4: Customizing the CreateUserWizard to Include a "Specify Roles" Step</span></span>

<span data-ttu-id="03032-325">Nel <a id="_msoanchor_3"> </a> [ *creazione degli account utente* ](../membership/creating-user-accounts-cs.md) esercitazione è stato illustrato come usare il controllo CreateUserWizard Web per fornire un'interfaccia per la creazione di un nuovo account utente.</span><span class="sxs-lookup"><span data-stu-id="03032-325">In the <a id="_msoanchor_3"></a>[*Creating User Accounts*](../membership/creating-user-accounts-cs.md) tutorial we saw how to use the CreateUserWizard Web control to provide an interface for creating a new user account.</span></span> <span data-ttu-id="03032-326">Il controllo CreateUserWizard può essere usato in uno dei due modi:</span><span class="sxs-lookup"><span data-stu-id="03032-326">The CreateUserWizard control can be used in one of two ways:</span></span>

- <span data-ttu-id="03032-327">Per consentire ai visitatori di creare il proprio account utente nel sito, e</span><span class="sxs-lookup"><span data-stu-id="03032-327">As a means for visitors to create their own user account on the site, and</span></span>
- <span data-ttu-id="03032-328">Per consentire agli amministratori di creare nuovi account</span><span class="sxs-lookup"><span data-stu-id="03032-328">As a means for administrators to create new accounts</span></span>

<span data-ttu-id="03032-329">Nel primo caso, usare un visitatore visiti il sito e compila CreateUserWizard, immettendo le proprie informazioni per eseguire la registrazione nel sito.</span><span class="sxs-lookup"><span data-stu-id="03032-329">In the first use case, a visitor comes to the site and fills out the CreateUserWizard, entering their information in order to register on the site.</span></span> <span data-ttu-id="03032-330">Nel secondo caso, un amministratore crea un nuovo account da un altro utente.</span><span class="sxs-lookup"><span data-stu-id="03032-330">In the second case, an administrator creates a new account for another person.</span></span>

<span data-ttu-id="03032-331">Quando viene creato un account da un amministratore di un'altra persona, potrebbe essere utile consentire all'amministratore di specificare i ruoli a cui appartiene il nuovo account utente.</span><span class="sxs-lookup"><span data-stu-id="03032-331">When an account is being created by an administrator for some other person, it might be helpful to allow the administrator to specify what roles the new user account belongs to.</span></span> <span data-ttu-id="03032-332">Nel <a id="_msoanchor_4"> </a> [ *Storing* *informazioni utente aggiuntive* ](../membership/storing-additional-user-information-cs.md) esercitazione è stato illustrato come personalizzare il CreateUserWizard aggiungendo altri `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="03032-332">In the <a id="_msoanchor_4"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we saw how to customize the CreateUserWizard by adding additional `WizardSteps`.</span></span> <span data-ttu-id="03032-333">Ecco come aggiungere un passaggio aggiuntivo per CreateUserWizard per specificare i nuovi ruoli dell'utente.</span><span class="sxs-lookup"><span data-stu-id="03032-333">Let's look at how to add an additional step to the CreateUserWizard in order to specify the new user's roles.</span></span>

<span data-ttu-id="03032-334">Aprire il `CreateUserWizardWithRoles.aspx` pagina e aggiungere un controllo CreateUserWizard denominato `RegisterUserWithRoles`.</span><span class="sxs-lookup"><span data-stu-id="03032-334">Open the `CreateUserWizardWithRoles.aspx` page and add a CreateUserWizard control named `RegisterUserWithRoles`.</span></span> <span data-ttu-id="03032-335">Impostare il controllo `ContinueDestinationPageUrl` proprietà su "~ / default. aspx".</span><span class="sxs-lookup"><span data-stu-id="03032-335">Set the control's `ContinueDestinationPageUrl` property to "~/Default.aspx".</span></span> <span data-ttu-id="03032-336">Poiché l'idea è che un amministratore utilizzerà questo controllo CreateUserWizard per creare nuovi account utente, impostare il controllo `LoginCreatedUser` proprietà su False.</span><span class="sxs-lookup"><span data-stu-id="03032-336">Because the idea here is that an administrator will be using this CreateUserWizard control to create new user accounts, set the control's `LoginCreatedUser` property to False.</span></span> <span data-ttu-id="03032-337">Ciò `LoginCreatedUser` proprietà specifica se il visitor automaticamente per l'accesso l'utente appena creato e il valore predefinito è true.</span><span class="sxs-lookup"><span data-stu-id="03032-337">This `LoginCreatedUser` property specifies whether the visitor is automatically logged on as the just-created user, and it defaults to True.</span></span> <span data-ttu-id="03032-338">È impostato su False poiché quando un amministratore crea un nuovo account si vuole mantenere quest'ultimo accesso eseguito come se stesso.</span><span class="sxs-lookup"><span data-stu-id="03032-338">We set it to False because when an administrator creates a new account we want to keep him signed in as himself.</span></span>

<span data-ttu-id="03032-339">Selezionare quindi il "Aggiungi/Rimuovi `WizardSteps`..." dallo Smart Tag del CreateUserWizard e aggiungere una nuova `WizardStep`, l'impostazione relativa `ID` a `SpecifyRolesStep`.</span><span class="sxs-lookup"><span data-stu-id="03032-339">Next, select the "Add/Remove `WizardSteps`…" option from the CreateUserWizard's Smart Tag and add a new `WizardStep`, setting its `ID` to `SpecifyRolesStep`.</span></span> <span data-ttu-id="03032-340">Spostare il `SpecifyRolesStep WizardStep` in modo che si tratta di dopo il passaggio "Sign Up for Your New Account", ma prima del passaggio "Complete".</span><span class="sxs-lookup"><span data-stu-id="03032-340">Move the `SpecifyRolesStep WizardStep` so that it comes after the "Sign Up for Your New Account" step, but before the "Complete" step.</span></span> <span data-ttu-id="03032-341">Impostare il `WizardStep`del `Title` proprietà su "specificare"Roles, relativo `StepType` proprietà `Step`e il relativo `AllowReturn` proprietà su False.</span><span class="sxs-lookup"><span data-stu-id="03032-341">Set the `WizardStep`'s `Title` property to "Specify Roles", its `StepType` property to `Step`, and its `AllowReturn` property to False.</span></span>


[![A<span data-ttu-id="03032-342">GG il]</span><span class="sxs-lookup"><span data-stu-id="03032-342">dd the]</span></span>(assigning-roles-to-users-cs/_static/image32.png)](assigning-roles-to-users-cs/_static/image31.png)

<span data-ttu-id="03032-343">**Figura 11**: Aggiungere "Specificare ruoli" `WizardStep` a CreateUserWizard ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="03032-343">**Figure 11**: Add the "Specify Roles" `WizardStep` to the CreateUserWizard  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image33.png))</span></span>


<span data-ttu-id="03032-344">Dopo questa modifica markup dichiarativo di CreateUserWizard dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="03032-344">After this change your CreateUserWizard's declarative markup should look like the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample21.aspx)]

<span data-ttu-id="03032-345">In "Specificare ruoli" `WizardStep`, aggiungere un controllo CheckBoxList denominato `RoleList`.</span><span class="sxs-lookup"><span data-stu-id="03032-345">In the "Specify Roles" `WizardStep`, add a CheckBoxList named `RoleList`.</span></span> <span data-ttu-id="03032-346">Questo CheckBoxList elencherà i ruoli disponibili, l'abilitazione di persona visitando la pagina controllare i ruoli a cui appartiene l'utente appena creato.</span><span class="sxs-lookup"><span data-stu-id="03032-346">This CheckBoxList will list the available roles, enabling the person visiting the page to check what roles the newly created user belongs to.</span></span>

<span data-ttu-id="03032-347">Abbiamo ancora due attività di codifica: prima di tutto è necessario popolare il `RoleList` CheckBoxList con i ruoli del sistema; in secondo luogo, è necessario aggiungere l'utente creato per i ruoli selezionati quando l'utente sposta il passaggio "Specificare ruoli" con il passaggio "Completa".</span><span class="sxs-lookup"><span data-stu-id="03032-347">We are left with two coding tasks: first we must populate the `RoleList` CheckBoxList with the roles in the system; second, we need to add the created user to the selected roles when the user moves from the "Specify Roles" step to the "Complete" step.</span></span> <span data-ttu-id="03032-348">Permette di eseguire la prima attività di `Page_Load` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="03032-348">We can accomplish the first task in the `Page_Load` event handler.</span></span> <span data-ttu-id="03032-349">Nell'esempio di codice a livello di programmazione i riferimenti di `RoleList` casella di controllo nella prima visita la pagina e associa i ruoli del sistema ad esso.</span><span class="sxs-lookup"><span data-stu-id="03032-349">The following code programmatically references the `RoleList` CheckBox on the first visit to the page and binds the roles in the system to it.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample22.cs)]

<span data-ttu-id="03032-350">Il codice precedente dovrebbe risultare familiare.</span><span class="sxs-lookup"><span data-stu-id="03032-350">The above code should look familiar.</span></span> <span data-ttu-id="03032-351">Nel <a id="_msoanchor_5"> </a> [ *Storing* *informazioni utente aggiuntive* ](../membership/storing-additional-user-information-cs.md) esercitazione viene usato due `FindControl` istruzioni per fare riferimento a un controllo Web all'interno di un oggetto personalizzato `WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="03032-351">In the <a id="_msoanchor_5"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we used two `FindControl` statements to reference a Web control from within a custom `WizardStep`.</span></span> <span data-ttu-id="03032-352">E il codice che associa i ruoli a CheckBoxList è stato ricavato da precedentemente in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="03032-352">And the code that binds the roles to the CheckBoxList was taken from earlier in this tutorial.</span></span>

<span data-ttu-id="03032-353">Per eseguire la seconda attività di programmazione, che è necessario conoscere quando il passaggio "Specificare ruoli" è stato completato.</span><span class="sxs-lookup"><span data-stu-id="03032-353">In order to perform the second programming task we need to know when the "Specify Roles" step has been completed.</span></span> <span data-ttu-id="03032-354">Tenere presente che CreateUserWizard è un `ActiveStepChanged` evento, che viene attivato ogni volta che il visitatore consente di passare da un unico passaggio a un altro.</span><span class="sxs-lookup"><span data-stu-id="03032-354">Recall that the CreateUserWizard has an `ActiveStepChanged` event, which fires each time the visitor navigates from one step to another.</span></span> <span data-ttu-id="03032-355">Qui è possibile determinare se l'utente ha raggiunto il passaggio "Completa". In questo caso, è necessario aggiungere l'utente per i ruoli selezionati.</span><span class="sxs-lookup"><span data-stu-id="03032-355">Here we can determine if the user has reached the "Complete" step; if so, we need to add the user to the selected roles.</span></span>

<span data-ttu-id="03032-356">Creare un gestore eventi per il `ActiveStepChanged` eventi e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="03032-356">Create an event handler for the `ActiveStepChanged` event and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample23.cs)]

<span data-ttu-id="03032-357">Se l'utente ha appena raggiunto il passaggio "Completed", il gestore dell'evento enumera gli elementi del `RoleList` CheckBoxList e l'utente appena creato viene assegnato ai ruoli selezionati.</span><span class="sxs-lookup"><span data-stu-id="03032-357">If the user has just reached the "Completed" step, the event handler enumerates the items of the `RoleList` CheckBoxList and the just-created user is assigned to the selected roles.</span></span>

<span data-ttu-id="03032-358">Visitare questa pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="03032-358">Visit this page through a browser.</span></span> <span data-ttu-id="03032-359">Il primo passaggio nella CreateUserWizard è il passaggio "Sign Up for Your New Account" standard, che viene richiesto per il nuovo nome utente, password, indirizzo di posta elettronica e altre informazioni sulla chiave.</span><span class="sxs-lookup"><span data-stu-id="03032-359">The first step in the CreateUserWizard is the standard "Sign Up for Your New Account" step, which prompts for the new user's username, password, email, and other key information.</span></span> <span data-ttu-id="03032-360">Immettere le informazioni per creare un nuovo utente denominato Wanda.</span><span class="sxs-lookup"><span data-stu-id="03032-360">Enter the information to create a new user named Wanda.</span></span>


[![C<span data-ttu-id="03032-361">Crea un nuovo Wanda denominato di utente]</span><span class="sxs-lookup"><span data-stu-id="03032-361">reate a New User Named Wanda]</span></span>(assigning-roles-to-users-cs/_static/image35.png)](assigning-roles-to-users-cs/_static/image34.png)

<span data-ttu-id="03032-362">**Figura 12**: Creare un nuovo Wanda denominato di utente ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="03032-362">**Figure 12**: Create a New User Named Wanda  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image36.png))</span></span>


<span data-ttu-id="03032-363">Fare clic sul pulsante "Create User".</span><span class="sxs-lookup"><span data-stu-id="03032-363">Click the "Create User" button.</span></span> <span data-ttu-id="03032-364">CreateUserWizard chiama internamente il `Membership.CreateUser` metodo, la creazione del nuovo account utente, quindi passa al passaggio successivo, "specifica ruoli".</span><span class="sxs-lookup"><span data-stu-id="03032-364">The CreateUserWizard internally calls the `Membership.CreateUser` method, creating the new user account, and then progresses to the next step, "Specify Roles."</span></span> <span data-ttu-id="03032-365">Di seguito sono elencati i ruoli del sistema.</span><span class="sxs-lookup"><span data-stu-id="03032-365">Here the system roles are listed.</span></span> <span data-ttu-id="03032-366">Selezionare la casella di controllo supervisori e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="03032-366">Check the Supervisors checkbox and click Next.</span></span>


[![M<span data-ttu-id="03032-367">ritaglio Wanda un membro del ruolo supervisori]</span><span class="sxs-lookup"><span data-stu-id="03032-367">ake Wanda a Member of the Supervisors Role]</span></span>(assigning-roles-to-users-cs/_static/image38.png)](assigning-roles-to-users-cs/_static/image37.png)

<span data-ttu-id="03032-368">**Figura 13**: Rendere un membro del ruolo supervisori Wanda ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="03032-368">**Figure 13**: Make Wanda a Member of the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image39.png))</span></span>


<span data-ttu-id="03032-369">Selezione di Avanti provoca un postback e gli aggiornamenti di `ActiveStep` al passaggio "Completa".</span><span class="sxs-lookup"><span data-stu-id="03032-369">Clicking Next causes a postback and updates the `ActiveStep` to the "Complete" step.</span></span> <span data-ttu-id="03032-370">Nel `ActiveStepChanged` gestore eventi, l'account utente creati di recente viene assegnato al ruolo supervisori.</span><span class="sxs-lookup"><span data-stu-id="03032-370">In the `ActiveStepChanged` event handler, the recently-created user account is assigned to the Supervisors role.</span></span> <span data-ttu-id="03032-371">Per verificarlo, tornare al `UsersAndRoles.aspx` pagina e selezionare i supervisori dal `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="03032-371">To verify this, return to the `UsersAndRoles.aspx` page and select Supervisors from the `RoleList` DropDownList.</span></span> <span data-ttu-id="03032-372">Come illustrato nella figura 14, Supervisor sono ora costituita da tre utenti: Bruce Tito e Wanda.</span><span class="sxs-lookup"><span data-stu-id="03032-372">As Figure 14 shows, the Supervisors are now made up of three users: Bruce, Tito, and Wanda.</span></span>


[![B<span data-ttu-id="03032-373">sono tutti i supervisori ruce, Tito e Wanda]</span><span class="sxs-lookup"><span data-stu-id="03032-373">ruce, Tito, and Wanda are All Supervisors]</span></span>(assigning-roles-to-users-cs/_static/image41.png)](assigning-roles-to-users-cs/_static/image40.png)

<span data-ttu-id="03032-374">**Figura 14**: Bruce Tito e Wanda sono tutti i supervisori ([fare clic per visualizzare l'immagine con dimensioni normali](assigning-roles-to-users-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="03032-374">**Figure 14**: Bruce, Tito, and Wanda are All Supervisors  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image42.png))</span></span>


## <a name="summary"></a><span data-ttu-id="03032-375">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="03032-375">Summary</span></span>

<span data-ttu-id="03032-376">Il framework di ruoli offre i metodi per il recupero di informazioni sui ruoli e i metodi per determinare quali utenti appartengono a un ruolo specifico di un utente specifico.</span><span class="sxs-lookup"><span data-stu-id="03032-376">The Roles framework offers methods for retrieving information about a particular user's roles and methods for determining what users belong to a specified role.</span></span> <span data-ttu-id="03032-377">Inoltre, esistono diversi metodi per l'aggiunta e rimozione di uno o più utenti a uno o più ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-377">Furthermore, there are a number of methods for adding and removing one or more users to one or more roles.</span></span> <span data-ttu-id="03032-378">In questa esercitazione ci siamo concentrati su due di questi metodi: `AddUserToRole` e `RemoveUserFromRole`.</span><span class="sxs-lookup"><span data-stu-id="03032-378">In this tutorial we focused on just two of these methods: `AddUserToRole` and `RemoveUserFromRole`.</span></span> <span data-ttu-id="03032-379">Esistono altre varianti progettate per aggiungere più utenti a un singolo ruolo e per assegnare più ruoli a un singolo utente.</span><span class="sxs-lookup"><span data-stu-id="03032-379">There are additional variants designed to add multiple users to a single role and to assign multiple roles to a single user.</span></span>

<span data-ttu-id="03032-380">Questa esercitazione è inoltre incluso uno sguardo di estendere il controllo CreateUserWizard per includere un `WizardStep` per specificare i ruoli dell'utente appena creato.</span><span class="sxs-lookup"><span data-stu-id="03032-380">This tutorial also included a look at extending the CreateUserWizard control to include a `WizardStep` to specify the newly-created user's roles.</span></span> <span data-ttu-id="03032-381">Tale passaggio può essere utile un amministratore di semplificare il processo di creazione di account utente per i nuovi utenti.</span><span class="sxs-lookup"><span data-stu-id="03032-381">Such a step could help an administrator streamline the process of creating user accounts for new users.</span></span>

<span data-ttu-id="03032-382">A questo punto abbiamo visto come creare ed eliminare i ruoli e su come aggiungere e rimuovere utenti dai ruoli.</span><span class="sxs-lookup"><span data-stu-id="03032-382">At this point we have seen how to create and delete roles and how to add and remove users from roles.</span></span> <span data-ttu-id="03032-383">Ma è ancora vedere autorizzazione basata sui ruoli applicazione.</span><span class="sxs-lookup"><span data-stu-id="03032-383">But we have yet to look at applying role-based authorization.</span></span> <span data-ttu-id="03032-384">Nel <a id="_msoanchor_6"> </a> [esercitazione seguente](role-based-authorization-cs.md) si esaminerà la definizione di regole di autorizzazione URL del ruolo per ruolo, nonché come illustrato per limitare le funzionalità a livello di pagina basata su ruoli dell'utente attualmente connesso.</span><span class="sxs-lookup"><span data-stu-id="03032-384">In the <a id="_msoanchor_6"></a>[following tutorial](role-based-authorization-cs.md) we will look at defining URL authorization rules on a role-by-role basis, as well as how to limit page-level functionality based on the currently logged in user's roles.</span></span>

<span data-ttu-id="03032-385">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="03032-385">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="03032-386">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="03032-386">Further Reading</span></span>

<span data-ttu-id="03032-387">Per altre informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="03032-387">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="03032-388">Panoramica sullo strumento Amministrazione sito Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="03032-388">ASP.NET Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/library/ms228053.aspx)
- [<span data-ttu-id="03032-389">Esame di ASP. Appartenenza, ruoli e profilo di rete</span><span class="sxs-lookup"><span data-stu-id="03032-389">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="03032-390">In sequenza il proprio strumento Amministrazione sito Web</span><span class="sxs-lookup"><span data-stu-id="03032-390">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="03032-391">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="03032-391">About the Author</span></span>

<span data-ttu-id="03032-392">Scott Mitchell, autore di più libri e fondatore di 4GuysFromRolla.com, ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="03032-392">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="03032-393">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="03032-393">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="03032-394">Il suo ultimo libro si intitola  *[Sams Teach Yourself ASP.NET 2.0 in 24 ore](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="03032-394">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="03032-395">È possibile contattarlo Scott [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) o il suo blog all'indirizzo [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="03032-395">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="03032-396">Ringraziamenti speciali...</span><span class="sxs-lookup"><span data-stu-id="03032-396">Special Thanks To…</span></span>

<span data-ttu-id="03032-397">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="03032-397">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="03032-398">Il revisore capo di questa esercitazione è stata Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="03032-398">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="03032-399">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="03032-399">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="03032-400">In questo caso, Inviami un messaggio nella [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="03032-400">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="03032-401">[Precedente](creating-and-managing-roles-cs.md)
> [Successivo](role-based-authorization-cs.md)</span><span class="sxs-lookup"><span data-stu-id="03032-401">[Previous](creating-and-managing-roles-cs.md)
[Next](role-based-authorization-cs.md)</span></span>
