---
uid: web-forms/overview/older-versions-security/membership/creating-user-accounts-cs
title: Creazione di account utenteC#() | Microsoft Docs
author: rick-anderson
description: In questa esercitazione verrà illustrato l'utilizzo del Framework di appartenenza (tramite l'oggetto SqlMembershipProvider) per creare nuovi account utente. Si vedrà come creare nuovi Stati Uniti...
ms.author: riande
ms.date: 01/18/2008
ms.assetid: f175278c-6079-4d91-b9b4-2493ed43d9ec
msc.legacyurl: /web-forms/overview/older-versions-security/membership/creating-user-accounts-cs
msc.type: authoredcontent
ms.openlocfilehash: 955592320e7d36c7ae3b9c03a361bee2183f1776
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/28/2019
ms.locfileid: "74625238"
---
# <a name="creating-user-accounts-c"></a><span data-ttu-id="36ec1-104">Creazione di account utente (C#)</span><span class="sxs-lookup"><span data-stu-id="36ec1-104">Creating User Accounts (C#)</span></span>

<span data-ttu-id="36ec1-105">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="36ec1-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="36ec1-106">[Scarica codice](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_CS.zip) o [Scarica PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="36ec1-106">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_CS.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_cs.pdf)</span></span>

> <span data-ttu-id="36ec1-107">In questa esercitazione verrà illustrato l'utilizzo del Framework di appartenenza (tramite l'oggetto SqlMembershipProvider) per creare nuovi account utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-107">In this tutorial we will explore using the Membership framework (via the SqlMembershipProvider) to create new user accounts.</span></span> <span data-ttu-id="36ec1-108">Si vedrà come creare nuovi utenti a livello di codice e tramite ASP. Controllo CreateUserWizard incorporato di NET.</span><span class="sxs-lookup"><span data-stu-id="36ec1-108">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>

## <a name="introduction"></a><span data-ttu-id="36ec1-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="36ec1-109">Introduction</span></span>

<span data-ttu-id="36ec1-110"><a id="_msoanchor_1"> </a>Nell' [esercitazione precedente](creating-the-membership-schema-in-sql-server-cs.md) è stato installato lo schema dei servizi dell'applicazione in un database, in cui sono state aggiunte le tabelle, le viste e le stored procedure necessarie per la `SqlMembershipProvider` e la `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-110">In the <a id="_msoanchor_1"></a>[preceding tutorial](creating-the-membership-schema-in-sql-server-cs.md) we installed the application services schema in a database, which added the tables, views, and stored procedures needed by the `SqlMembershipProvider` and `SqlRoleProvider`.</span></span> <span data-ttu-id="36ec1-111">Questa operazione ha creato l'infrastruttura necessaria per il resto delle esercitazioni di questa serie.</span><span class="sxs-lookup"><span data-stu-id="36ec1-111">This created the infrastructure we will need for the remainder of the tutorials in this series.</span></span> <span data-ttu-id="36ec1-112">In questa esercitazione verrà illustrato l'uso del Framework di appartenenza (tramite il `SqlMembershipProvider`) per creare nuovi account utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-112">In this tutorial we will explore using the Membership framework (via the `SqlMembershipProvider`) to create new user accounts.</span></span> <span data-ttu-id="36ec1-113">Si vedrà come creare nuovi utenti a livello di codice e tramite ASP. Controllo CreateUserWizard incorporato di NET.</span><span class="sxs-lookup"><span data-stu-id="36ec1-113">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>

<span data-ttu-id="36ec1-114">Oltre ad apprendere come creare nuovi account utente, sarà necessario aggiornare anche il sito Web demo creato per l'esercitazione *<a id="_msoanchor_2"></a>[Panoramica dell'autenticazione basata su form](../introduction/an-overview-of-forms-authentication-cs.md)* tutorial e quindi migliorato nell'esercitazione relativa alla configurazione dell' *<a id="https://www.asp.net/learn/security/tutorial-03-cs.aspx"></a>autenticazione basata su form e agli argomenti avanzati*.</span><span class="sxs-lookup"><span data-stu-id="36ec1-114">In addition to learning how to create new user accounts, we will also need to update the demo website we first created in the *<a id="_msoanchor_2"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-cs.md)* tutorial and then enhanced in the *<a id="https://www.asp.net/learn/security/tutorial-03-cs.aspx"></a> Forms Authentication Configuration and Advanced Topics* tutorial.</span></span> <span data-ttu-id="36ec1-115">L'applicazione Web demo include una pagina di accesso che convalida le credenziali degli utenti da coppie di nome utente/password hardcoded.</span><span class="sxs-lookup"><span data-stu-id="36ec1-115">Our demo web application has a login page that validates users' credentials against hard-coded username/password pairs.</span></span> <span data-ttu-id="36ec1-116">Inoltre, `Global.asax` include codice che crea oggetti `IPrincipal` e `IIdentity` personalizzati per gli utenti autenticati.</span><span class="sxs-lookup"><span data-stu-id="36ec1-116">Moreover, `Global.asax` includes code that creates custom `IPrincipal` and `IIdentity` objects for authenticated users.</span></span> <span data-ttu-id="36ec1-117">La pagina di accesso viene aggiornata per convalidare le credenziali degli utenti rispetto al Framework di appartenenza e rimuovere l'entità personalizzata e la logica di identità.</span><span class="sxs-lookup"><span data-stu-id="36ec1-117">We will update the login page to validate users' credentials against the Membership framework and remove the custom principal and identity logic.</span></span>

<span data-ttu-id="36ec1-118">Iniziamo!</span><span class="sxs-lookup"><span data-stu-id="36ec1-118">Let's get started!</span></span>

## <a name="the-forms-authentication-and-membership-checklist"></a><span data-ttu-id="36ec1-119">Elenco di controllo per l'autenticazione basata su form e l'appartenenza</span><span class="sxs-lookup"><span data-stu-id="36ec1-119">The Forms Authentication and Membership Checklist</span></span>

<span data-ttu-id="36ec1-120">Prima di iniziare a lavorare con il framework delle appartenenze, è opportuno esaminare i passaggi importanti che abbiamo intrapreso per raggiungere questo punto.</span><span class="sxs-lookup"><span data-stu-id="36ec1-120">Before we begin working with the Membership framework, let's take a moment to review the important steps we have taken to reach this point.</span></span> <span data-ttu-id="36ec1-121">Quando si utilizza il Framework di appartenenza con la `SqlMembershipProvider` in uno scenario di autenticazione basata su form, è necessario eseguire i passaggi seguenti prima di implementare la funzionalità di appartenenza nell'applicazione Web:</span><span class="sxs-lookup"><span data-stu-id="36ec1-121">When using the Membership framework with the `SqlMembershipProvider` in a forms-based authentication scenario, the following steps need to be performed prior to implementing Membership functionality in your web application:</span></span>

1. <span data-ttu-id="36ec1-122">**Abilitare l'autenticazione basata su form.**</span><span class="sxs-lookup"><span data-stu-id="36ec1-122">**Enable forms-based authentication.**</span></span> <span data-ttu-id="36ec1-123">Come illustrato in *<a id="_msoanchor_4"></a>[panoramica dell'autenticazione basata su form](../introduction/an-overview-of-forms-authentication-cs.md)* , l'autenticazione basata su form è abilitata modificando `Web.config` e impostando l'attributo `<authentication>` dell'elemento `mode` su `Forms`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-123">As we discussed in *<a id="_msoanchor_4"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-cs.md)*, forms authentication is enabled by editing `Web.config` and setting the `<authentication>` element's `mode` attribute to `Forms`.</span></span> <span data-ttu-id="36ec1-124">Con l'autenticazione basata su form abilitata, ogni richiesta in ingresso viene esaminata per un *ticket di autenticazione basata su form*, che, se presente, identifica il richiedente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-124">With forms authentication enabled, each incoming request is examined for a *forms authentication ticket*, which, if present, identifies the requestor.</span></span>
2. <span data-ttu-id="36ec1-125">**Aggiungere lo schema dei servizi dell'applicazione al database appropriato.**</span><span class="sxs-lookup"><span data-stu-id="36ec1-125">**Add the application services schema to the appropriate database.**</span></span> <span data-ttu-id="36ec1-126">Quando si usa il `SqlMembershipProvider` è necessario installare lo schema dei servizi dell'applicazione in un database.</span><span class="sxs-lookup"><span data-stu-id="36ec1-126">When using the `SqlMembershipProvider` we need to install the application services schema to a database.</span></span> <span data-ttu-id="36ec1-127">Questo schema viene in genere aggiunto allo stesso database che include il modello di dati dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="36ec1-127">Usually this schema is added to the same database that holds the application's data model.</span></span> <span data-ttu-id="36ec1-128">Per eseguire questa operazione, è stato visualizzata l'esercitazione *<a id="_msoanchor_5"></a>[Creato lo schema di appartenenza in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* utilizzando lo strumento `aspnet_regsql.exe`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-128">The *<a id="_msoanchor_5"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* tutorial looked at using the `aspnet_regsql.exe` tool to accomplish this.</span></span>
3. <span data-ttu-id="36ec1-129">**Personalizzare le impostazioni dell'applicazione Web in modo che facciano riferimento al database dal passaggio 2.**</span><span class="sxs-lookup"><span data-stu-id="36ec1-129">**Customize the Web Application's Settings to reference the database from step 2.**</span></span> <span data-ttu-id="36ec1-130">L'esercitazione *creazione dello schema di appartenenza in SQL Server* Mostra due modi per configurare l'applicazione Web in modo che il `SqlMembershipProvider` utilizzerà il database selezionato nel passaggio 2: modificando il nome della stringa di connessione `LocalSqlServer`; oppure aggiungendo un nuovo provider registrato all'elenco dei provider del Framework di appartenenza e personalizzando il nuovo provider per l'utilizzo del database dal passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="36ec1-130">The *Creating the Membership Schema in SQL Server* tutorial showed two ways to configure the web application so that the `SqlMembershipProvider` would use the database selected in step 2: by modifying the `LocalSqlServer` connection string name; or by adding a new registered provider to the list of Membership framework providers and customizing that new provider to use the database from step 2.</span></span>

<span data-ttu-id="36ec1-131">Quando si compila un'applicazione Web che usa il `SqlMembershipProvider` e l'autenticazione basata su form, è necessario eseguire questi tre passaggi prima di usare la classe `Membership` o i controlli Web di accesso ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="36ec1-131">When building a web application that uses the `SqlMembershipProvider` and forms-based authentication, you will need to perform these three steps before using the `Membership` class or the ASP.NET Login Web controls.</span></span> <span data-ttu-id="36ec1-132">Poiché questi passaggi sono già stati eseguiti nelle esercitazioni precedenti, è possibile iniziare a usare il framework delle appartenenze.</span><span class="sxs-lookup"><span data-stu-id="36ec1-132">Since we already performed these steps in previous tutorials, we are ready to start using the Membership framework!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="36ec1-133">Passaggio 1: Aggiunta di nuove pagine ASP.NET</span><span class="sxs-lookup"><span data-stu-id="36ec1-133">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="36ec1-134">In questa esercitazione e nei tre successivi verranno esaminate varie funzioni e funzionalità correlate all'appartenenza.</span><span class="sxs-lookup"><span data-stu-id="36ec1-134">In this tutorial and the next three we will be examining various Membership-related functions and capabilities.</span></span> <span data-ttu-id="36ec1-135">Per implementare gli argomenti esaminati in queste esercitazioni, è necessaria una serie di pagine di ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="36ec1-135">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="36ec1-136">Si creeranno quindi le pagine e un file della mappa del sito `(Web.sitemap)`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-136">Let's create those pages and then a site map file `(Web.sitemap)`.</span></span>

<span data-ttu-id="36ec1-137">Per iniziare, creare una nuova cartella nel progetto denominata `Membership`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-137">Start by creating a new folder in the project named `Membership`.</span></span> <span data-ttu-id="36ec1-138">Successivamente, aggiungere cinque nuove pagine di ASP.NET alla cartella `Membership`, collegando ogni pagina alla pagina master `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-138">Next, add five new ASP.NET pages to the `Membership` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="36ec1-139">Denominare le pagine:</span><span class="sxs-lookup"><span data-stu-id="36ec1-139">Name the pages:</span></span>

- `CreatingUserAccounts.aspx`
- `UserBasedAuthorization.aspx`
- `EnhancedCreateUserWizard.aspx`
- `AdditionalUserInfo.aspx`
- `Guestbook.aspx`

<span data-ttu-id="36ec1-140">A questo punto la Esplora soluzioni del progetto dovrebbe essere simile a quella mostrata nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="36ec1-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>

<span data-ttu-id="36ec1-141">[![sono state aggiunte cinque nuove pagine alla cartella delle appartenenze](creating-user-accounts-cs/_static/image2.png)](creating-user-accounts-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-141">[![Five New Pages Have Been Added to the Membership Folder](creating-user-accounts-cs/_static/image2.png)](creating-user-accounts-cs/_static/image1.png)</span></span>

<span data-ttu-id="36ec1-142">**Figura 1**: Sono state aggiunte cinque nuove pagine alla cartella `Membership` ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-142">**Figure 1**: Five New Pages Have Been Added to the `Membership` Folder  ([Click to view full-size image](creating-user-accounts-cs/_static/image3.png))</span></span>

<span data-ttu-id="36ec1-143">A questo punto, ogni pagina deve disporre dei due controlli contenuto, uno per ogni ContentPlaceHolders della pagina master: `MainContent` e `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-143">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample1.aspx)]

<span data-ttu-id="36ec1-144">Tenere presente che il markup predefinito di `LoginContent` ContentPlaceHolder Visualizza un collegamento per l'accesso o la disconnessione dal sito, a seconda che l'utente sia autenticato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-144">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="36ec1-145">Tuttavia, la presenza del controllo del contenuto `Content2` sostituisce il markup predefinito della pagina master.</span><span class="sxs-lookup"><span data-stu-id="36ec1-145">The presence of the `Content2` Content control, however, overrides the master page's default markup.</span></span> <span data-ttu-id="36ec1-146">Come illustrato nell'esercitazione *<a id="_msoanchor_6"></a>[panoramica dell'autenticazione basata su form](../introduction/an-overview-of-forms-authentication-cs.md)* , questa operazione è utile nelle pagine in cui non si desidera visualizzare le opzioni relative all'account di accesso nella colonna a sinistra.</span><span class="sxs-lookup"><span data-stu-id="36ec1-146">As we discussed in *<a id="_msoanchor_6"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-cs.md)* tutorial, this is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="36ec1-147">Per queste cinque pagine, tuttavia, si vuole visualizzare il markup predefinito della pagina master per il `LoginContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="36ec1-147">For these five pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="36ec1-148">Rimuovere quindi il markup dichiarativo per il controllo contenuto `Content2`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-148">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="36ec1-149">Al termine di questa operazione, ogni markup della pagina deve contenere un solo controllo contenuto.</span><span class="sxs-lookup"><span data-stu-id="36ec1-149">After doing so, each of the five page's markup should contain just one Content control.</span></span>

## <a name="step-2-creating-the-site-map"></a><span data-ttu-id="36ec1-150">Passaggio 2: Creazione della mappa del sito</span><span class="sxs-lookup"><span data-stu-id="36ec1-150">Step 2: Creating the Site Map</span></span>

<span data-ttu-id="36ec1-151">Tutti i siti Web, tranne quelli più banali, devono implementare una forma di interfaccia utente di navigazione.</span><span class="sxs-lookup"><span data-stu-id="36ec1-151">All but the most trivial websites need to implement some form of a navigational user interface.</span></span> <span data-ttu-id="36ec1-152">L'interfaccia utente di navigazione può essere un semplice elenco di collegamenti alle varie sezioni del sito.</span><span class="sxs-lookup"><span data-stu-id="36ec1-152">The navigation user interface may be a simple list of links to the various sections of the site.</span></span> <span data-ttu-id="36ec1-153">In alternativa, questi collegamenti possono essere disposti in menu o visualizzazioni albero.</span><span class="sxs-lookup"><span data-stu-id="36ec1-153">Alternatively, these links may be arranged into menus or tree views.</span></span> <span data-ttu-id="36ec1-154">Poiché gli sviluppatori di pagine, la creazione dell'interfaccia utente di spostamento è solo la metà della storia.</span><span class="sxs-lookup"><span data-stu-id="36ec1-154">As page developers, creating the navigational user interface is only half of the story.</span></span> <span data-ttu-id="36ec1-155">Sono necessari anche alcuni mezzi per definire la struttura logica del sito in modo gestibile e aggiornabile.</span><span class="sxs-lookup"><span data-stu-id="36ec1-155">We also need some means to define the site's logical structure in a maintainable and updateable fashion.</span></span> <span data-ttu-id="36ec1-156">Quando si aggiungono nuove pagine o si rimuovono le pagine esistenti, è necessario essere in grado di aggiornare una singola origine, ovvero la mappa del sito, e apportare le modifiche riflesse nell'interfaccia utente di spostamento del sito.</span><span class="sxs-lookup"><span data-stu-id="36ec1-156">As new pages are added or existing pages removed, we want to be able to update a single source – the site map – and have those modifications reflected across the site's navigational user interface.</span></span>

<span data-ttu-id="36ec1-157">Queste due attività, definendo la mappa del sito e implementando un'interfaccia utente di spostamento basata sulla mappa del sito, sono facili da realizzare grazie al framework della mappa del sito e ai controlli Web di spostamento aggiunti in ASP.NET versione 2,0.</span><span class="sxs-lookup"><span data-stu-id="36ec1-157">These two tasks – defining the site map and implementing a navigational user interface based on the site map – are easy to accomplish thanks to the Site Map framework and the Navigation Web controls added in ASP.NET version 2.0.</span></span> <span data-ttu-id="36ec1-158">Il Framework della mappa del sito consente a uno sviluppatore di definire una mappa del sito e quindi di accedervi tramite un'API a livello di codice (la [classe`SiteMap`](https://msdn.microsoft.com/library/system.web.sitemap.aspx)).</span><span class="sxs-lookup"><span data-stu-id="36ec1-158">The Site Map framework allows for a developer to define a site map and then to access it through a programmatic API (the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx)).</span></span> <span data-ttu-id="36ec1-159">I controlli Web di spostamento incorporati includono un [controllo menu](https://msdn.microsoft.com/library/bz09dy46.aspx), il [controllo TreeView](https://msdn.microsoft.com/library/3eafky27.aspx)e il [controllo SiteMapPath](https://msdn.microsoft.com/library/3eafky27.aspx).</span><span class="sxs-lookup"><span data-stu-id="36ec1-159">The built-in Navigation Web controls include a [Menu control](https://msdn.microsoft.com/library/bz09dy46.aspx), the [TreeView control](https://msdn.microsoft.com/library/3eafky27.aspx), and the [SiteMapPath control](https://msdn.microsoft.com/library/3eafky27.aspx).</span></span>

<span data-ttu-id="36ec1-160">Come i Framework di appartenenza e ruoli, il Framework della mappa del sito è compilato in cima al [modello del provider](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="36ec1-160">Like the Membership and Roles frameworks, the Site Map framework is built atop the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx).</span></span> <span data-ttu-id="36ec1-161">Il processo della classe del provider della mappa del sito genera la struttura in memoria utilizzata dalla classe `SiteMap` da un archivio dati persistente, ad esempio un file XML o una tabella di database.</span><span class="sxs-lookup"><span data-stu-id="36ec1-161">The job of the Site Map provider class is to generate the in-memory structure used by the `SiteMap` class from a persistent data store, such as an XML file or a database table.</span></span> <span data-ttu-id="36ec1-162">Il .NET Framework viene fornito con un provider della mappa del sito predefinito che legge i dati della mappa del sito da un file XML ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)) e questo è il provider che verrà usato in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="36ec1-162">The .NET Framework ships with a default Site Map provider that reads the site map data from an XML file ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)), and this is the provider we will be using in this tutorial.</span></span> <span data-ttu-id="36ec1-163">Per alcune implementazioni del provider della mappa del sito alternative, fare riferimento alla sezione ulteriori letture alla fine di questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="36ec1-163">For some alternate Site Map provider implementations, refer to the Further Readings section at the end of this tutorial.</span></span>

<span data-ttu-id="36ec1-164">Il provider della mappa del sito predefinito prevede un file XML formattato in modo corretto denominato `Web.sitemap` per esistere la directory radice.</span><span class="sxs-lookup"><span data-stu-id="36ec1-164">The default Site Map provider expects a properly-formatted XML file named `Web.sitemap` to exist the root directory.</span></span> <span data-ttu-id="36ec1-165">Poiché si utilizza questo provider predefinito, è necessario aggiungere tale file e definire la struttura della mappa del sito nel formato XML appropriato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-165">Since we are using this default provider, we need to add such a file and define the site map's structure in the appropriate XML format.</span></span> <span data-ttu-id="36ec1-166">Per aggiungere il file, fare clic con il pulsante destro del mouse sul nome del progetto in Esplora soluzioni e scegliere Aggiungi nuovo elemento.</span><span class="sxs-lookup"><span data-stu-id="36ec1-166">To add the file, right-click on the project name in Solution Explorer and choose Add New Item.</span></span> <span data-ttu-id="36ec1-167">Nella finestra di dialogo scegliere di aggiungere un file di tipo Mappa del sito denominato `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-167">From the dialog box, opt to add a file of type Site Map named `Web.sitemap`.</span></span>

<span data-ttu-id="36ec1-168">[![aggiungere un file denominato Web. sitemap alla directory radice del progetto](creating-user-accounts-cs/_static/image5.png)](creating-user-accounts-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-168">[![Add a File Named Web.sitemap to the Project's Root Directory](creating-user-accounts-cs/_static/image5.png)](creating-user-accounts-cs/_static/image4.png)</span></span>

<span data-ttu-id="36ec1-169">**Figura 2**: Aggiungere un file denominato `Web.sitemap` alla directory radice del progetto ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-169">**Figure 2**: Add a File Named `Web.sitemap` to the Project's Root Directory  ([Click to view full-size image](creating-user-accounts-cs/_static/image6.png))</span></span>

<span data-ttu-id="36ec1-170">Il file della mappa del sito XML definisce la struttura del sito Web come gerarchia.</span><span class="sxs-lookup"><span data-stu-id="36ec1-170">The XML site map file defines the website's structure as a hierarchy.</span></span> <span data-ttu-id="36ec1-171">Questa relazione gerarchica viene modellata nel file XML tramite il lignaggio degli elementi `<siteMapNode>`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-171">This hierarchical relationship is modeled in the XML file via the ancestry of the `<siteMapNode>` elements.</span></span> <span data-ttu-id="36ec1-172">Il `Web.sitemap` deve iniziare con un nodo padre `<siteMap>` con una precisione `<siteMapNode>` figlio.</span><span class="sxs-lookup"><span data-stu-id="36ec1-172">The `Web.sitemap` must start with a `<siteMap>` parent node that has precisely one `<siteMapNode>` child.</span></span> <span data-ttu-id="36ec1-173">Questo elemento `<siteMapNode>` di primo livello rappresenta la radice della gerarchia e può avere un numero arbitrario di nodi discendenti.</span><span class="sxs-lookup"><span data-stu-id="36ec1-173">This top-level `<siteMapNode>` element represents the root of the hierarchy, and may have an arbitrary number of descendent nodes.</span></span> <span data-ttu-id="36ec1-174">Ogni elemento `<siteMapNode>` deve includere un attributo `title` e può includere facoltativamente gli attributi `url` e `description`, tra gli altri. ogni attributo `url` non vuoto deve essere univoco.</span><span class="sxs-lookup"><span data-stu-id="36ec1-174">Each `<siteMapNode>` element must include a `title` attribute and may optionally include `url` and `description` attributes, among others; each non-empty `url` attribute must be unique.</span></span>

<span data-ttu-id="36ec1-175">Immettere il codice XML seguente nel file di `Web.sitemap`:</span><span class="sxs-lookup"><span data-stu-id="36ec1-175">Enter the following XML into the `Web.sitemap` file:</span></span>

[!code-xml[Main](creating-user-accounts-cs/samples/sample2.xml)]

<span data-ttu-id="36ec1-176">Il markup precedente della mappa del sito definisce la gerarchia illustrata nella figura 3.</span><span class="sxs-lookup"><span data-stu-id="36ec1-176">The above site map markup defines the hierarchy shown in Figure 3.</span></span>

<span data-ttu-id="36ec1-177">[![la mappa del sito rappresenta una struttura di navigazione gerarchica](creating-user-accounts-cs/_static/image8.png)](creating-user-accounts-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-177">[![The Site Map Represents a Hierarchical Navigational Structure](creating-user-accounts-cs/_static/image8.png)](creating-user-accounts-cs/_static/image7.png)</span></span>

<span data-ttu-id="36ec1-178">**Figura 3**: La mappa del sito rappresenta una struttura di navigazione gerarchica ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-178">**Figure 3**: The Site Map Represents a Hierarchical Navigational Structure  ([Click to view full-size image](creating-user-accounts-cs/_static/image9.png))</span></span>

## <a name="step-3-updating-the-master-page-to-include-a-navigational-user-interface"></a><span data-ttu-id="36ec1-179">Passaggio 3: Aggiornamento della pagina master per includere un'interfaccia utente di spostamento</span><span class="sxs-lookup"><span data-stu-id="36ec1-179">Step 3: Updating the Master Page to Include a Navigational User Interface</span></span>

<span data-ttu-id="36ec1-180">ASP.NET include una serie di controlli Web correlati alla navigazione per la progettazione di un'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-180">ASP.NET includes a number of navigation-related Web controls for designing a user interface.</span></span> <span data-ttu-id="36ec1-181">Sono inclusi i controlli menu, TreeView e SiteMapPath.</span><span class="sxs-lookup"><span data-stu-id="36ec1-181">These include the Menu, TreeView, and the SiteMapPath controls.</span></span> <span data-ttu-id="36ec1-182">I controlli menu e TreeView eseguono il rendering della struttura della mappa del sito rispettivamente in un menu o in un albero, mentre il SiteMapPath visualizza una navigazione che mostra il nodo corrente visitato e i relativi predecessori.</span><span class="sxs-lookup"><span data-stu-id="36ec1-182">The Menu and TreeView controls render the site map structure in a menu or a tree, respectively, whereas the SiteMapPath displays a breadcrumb that shows the current node being visited as well as its ancestors.</span></span> <span data-ttu-id="36ec1-183">I dati della mappa del sito possono essere associati ad altri controlli Web di dati tramite SiteMapDataSource ed è possibile accedervi a livello di codice tramite la classe `SiteMap`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-183">The site map data can be bound to other data Web controls using the SiteMapDataSource and can be accessed programmatically via the `SiteMap` class.</span></span>

<span data-ttu-id="36ec1-184">Poiché una discussione approfondita del Framework della mappa del sito e dei controlli di navigazione esula dall'ambito di questa serie di esercitazioni, invece di dedicare tempo alla creazione di un'interfaccia utente per la navigazione, è possibile prendere in prestito quella usata nel mio *[lavoro con i dati nella](../../data-access/index.md)* serie di esercitazioni di ASP.NET 2,0, che usa un controllo Repeater per visualizzare un elenco di collegamenti di navigazione con due</span><span class="sxs-lookup"><span data-stu-id="36ec1-184">Since a thorough discussion of the Site Map framework and the Navigation controls is beyond the scope of this tutorial series, rather than spend time crafting our own navigational user interface let's instead borrow the one used in my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series, which uses a Repeater control to display a two-deep bulleted list of navigation links, as shown in Figure 4.</span></span>

### <a name="adding-a-two-level-list-of-links-in-the-left-column"></a><span data-ttu-id="36ec1-185">Aggiunta di un elenco a due livelli di collegamenti nella colonna a sinistra</span><span class="sxs-lookup"><span data-stu-id="36ec1-185">Adding a Two-Level List of Links in the Left Column</span></span>

<span data-ttu-id="36ec1-186">Per creare questa interfaccia, aggiungere il markup dichiarativo seguente alla colonna sinistra della pagina master `Site.master` dove il testo "TODO: Il menu viene visualizzato qui... " si trova attualmente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-186">To create this interface, add the following declarative markup to the `Site.master` master page's left column where the text "TODO: Menu will go here..." currently resides.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample3.aspx)]

<span data-ttu-id="36ec1-187">Il markup precedente associa un controllo Repeater denominato `menu` a un oggetto SiteMapDataSource, che restituisce la gerarchia della mappa del sito definita nel `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-187">The above markup binds a Repeater control named `menu` to a SiteMapDataSource, which returns the site map hierarchy defined in `Web.sitemap`.</span></span> <span data-ttu-id="36ec1-188">Poiché la [proprietà`ShowStartingNode`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) del controllo SiteMapDataSource è impostata su false, inizia a restituire la gerarchia della mappa del sito iniziando con i discendenti del nodo "Home".</span><span class="sxs-lookup"><span data-stu-id="36ec1-188">Since the SiteMapDataSource control's [`ShowStartingNode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) is set to False it starts returning the site map's hierarchy starting with the descendents of the "Home" node.</span></span> <span data-ttu-id="36ec1-189">Il Repeater Visualizza ognuno di questi nodi (attualmente solo "appartenenza") in un elemento `<li>`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-189">The Repeater displays each of these nodes (currently just "Membership") in an `<li>` element.</span></span> <span data-ttu-id="36ec1-190">Un altro ripetitore interno Visualizza quindi gli elementi figlio del nodo corrente in un elenco non ordinato annidato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-190">Another, inner Repeater then displays the current node's children in a nested unordered list.</span></span>

<span data-ttu-id="36ec1-191">Nella figura 4 viene illustrato l'output di rendering del markup precedente con la struttura della mappa del sito creata nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="36ec1-191">Figure 4 shows the above markup's rendered output with the site map structure we created in Step 2.</span></span> <span data-ttu-id="36ec1-192">Il ripetitore esegue il rendering del markup di elenco non ordinato vaniglia; le regole dei fogli di stile CSS definite in `Styles.css` sono responsabili del layout estetico piacevole.</span><span class="sxs-lookup"><span data-stu-id="36ec1-192">The Repeater renders vanilla unordered list markup; the cascading style sheet rules defined in `Styles.css` are responsible for the aesthetically-pleasing layout.</span></span> <span data-ttu-id="36ec1-193">Per una descrizione più dettagliata del funzionamento del markup precedente, vedere l'esercitazione [pagine master e navigazione nel sito](https://asp.net/learn/data-access/tutorial-03-cs.aspx) .</span><span class="sxs-lookup"><span data-stu-id="36ec1-193">For a more detailed description of how the above markup works, refer to the [Master Pages and Site Navigation](https://asp.net/learn/data-access/tutorial-03-cs.aspx) tutorial.</span></span>

<span data-ttu-id="36ec1-194">[![l'interfaccia utente di spostamento viene sottoposta a rendering utilizzando elenchi annidati non ordinati](creating-user-accounts-cs/_static/image11.png)](creating-user-accounts-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-194">[![The Navigational User Interface is Rendered Using Nested Unordered Lists](creating-user-accounts-cs/_static/image11.png)](creating-user-accounts-cs/_static/image10.png)</span></span>

<span data-ttu-id="36ec1-195">**Figura 4**: Viene eseguito il rendering dell'interfaccia utente di spostamento utilizzando elenchi annidati non ordinati ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-195">**Figure 4**: The Navigational User Interface is Rendered Using Nested Unordered Lists  ([Click to view full-size image](creating-user-accounts-cs/_static/image12.png))</span></span>

### <a name="adding-breadcrumb-navigation"></a><span data-ttu-id="36ec1-196">Aggiunta dell'esplorazione di navigazione</span><span class="sxs-lookup"><span data-stu-id="36ec1-196">Adding Breadcrumb Navigation</span></span>

<span data-ttu-id="36ec1-197">Oltre all'elenco dei collegamenti nella colonna a sinistra, è possibile visualizzare una [navigazione](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29)per ogni pagina.</span><span class="sxs-lookup"><span data-stu-id="36ec1-197">In addition to the list of links in the left column, let's also have each page display a [breadcrumb](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29).</span></span> <span data-ttu-id="36ec1-198">Una navigazione è un elemento dell'interfaccia utente di spostamento che mostra rapidamente agli utenti la posizione corrente all'interno della gerarchia dei siti.</span><span class="sxs-lookup"><span data-stu-id="36ec1-198">A breadcrumb is a navigational user interface element that quickly shows users their current position within the site hierarchy.</span></span> <span data-ttu-id="36ec1-199">Il controllo SiteMapPath usa il Framework della mappa del sito per determinare la posizione della pagina corrente nella mappa del sito e quindi Visualizza una navigazione in base a queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="36ec1-199">The SiteMapPath control uses the Site Map framework to determine the current page's location in the site map and then displays a breadcrumb based on this information.</span></span>

<span data-ttu-id="36ec1-200">In particolare, aggiungere un elemento `<span>` all'intestazione `<div>` dell'elemento della pagina master e impostare l'attributo `class` del nuovo elemento `<span>` su "navigazione".</span><span class="sxs-lookup"><span data-stu-id="36ec1-200">Specifically, add a `<span>` element to the master page's header `<div>` element, and set the new `<span>` element's `class` attribute to "breadcrumb".</span></span> <span data-ttu-id="36ec1-201">La classe `Styles.css` contiene una regola per una classe di "navigazione". Aggiungere quindi un oggetto SiteMapPath al nuovo elemento `<span>`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-201">(The `Styles.css` class contains a rule for a "breadcrumb" class.) Next, add a SiteMapPath to this new `<span>` element.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample4.aspx)]

<span data-ttu-id="36ec1-202">Nella figura 5 viene illustrato l'output del SiteMapPath quando si visita `~/Membership/CreatingUserAccounts.aspx`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-202">Figure 5 shows the output of the SiteMapPath when visiting `~/Membership/CreatingUserAccounts.aspx`.</span></span>

<span data-ttu-id="36ec1-203">[![la navigazione Visualizza la pagina corrente e i relativi predecessori nella mappa del sito](creating-user-accounts-cs/_static/image14.png)](creating-user-accounts-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-203">[![The Breadcrumb Displays the Current Page and its Ancestors in the Site Map](creating-user-accounts-cs/_static/image14.png)](creating-user-accounts-cs/_static/image13.png)</span></span>

<span data-ttu-id="36ec1-204">**Figura 5**: La navigazione Visualizza la pagina corrente e i relativi predecessori nella mappa del sito ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-204">**Figure 5**: The Breadcrumb Displays the Current Page and its Ancestors in the Site Map  ([Click to view full-size image](creating-user-accounts-cs/_static/image15.png))</span></span>

## <a name="step-4-removing-the-custom-principal-and-identity-logic"></a><span data-ttu-id="36ec1-205">Passaggio 4: Rimozione dell'entità personalizzata e della logica di identità</span><span class="sxs-lookup"><span data-stu-id="36ec1-205">Step 4: Removing the Custom Principal and Identity Logic</span></span>

<span data-ttu-id="36ec1-206">Nell'esercitazione sulla *<a id="_msoanchor_7"></a>[configurazione dell'autenticazione basata su form e sugli argomenti avanzati](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md)* è stato illustrato come associare oggetti Principal e Identity personalizzati all'utente autenticato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-206">In the *<a id="_msoanchor_7"></a>[Forms Authentication Configuration and Advanced Topics](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md)* tutorial we saw how to associate custom principal and identity objects to the authenticated user.</span></span> <span data-ttu-id="36ec1-207">Questa operazione è stata eseguita creando un gestore eventi in `Global.asax` per l'evento `PostAuthenticateRequest` dell'applicazione, che viene attivato dopo che il `FormsAuthenticationModule` ha autenticato l'utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-207">We accomplished this by creating an event handler in `Global.asax` for the application's `PostAuthenticateRequest` event, which fires after the `FormsAuthenticationModule` has authenticated the user.</span></span> <span data-ttu-id="36ec1-208">In questo gestore eventi è stato sostituito il `GenericPrincipal` e `FormsIdentity` oggetti aggiunti dalla `FormsAuthenticationModule` con gli oggetti `CustomPrincipal` e `CustomIdentity` creati in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="36ec1-208">In this event handler we replaced the `GenericPrincipal` and `FormsIdentity` objects added by the `FormsAuthenticationModule` with the `CustomPrincipal` and `CustomIdentity` objects we created in that tutorial.</span></span>

<span data-ttu-id="36ec1-209">Sebbene gli oggetti Principal e Identity personalizzati siano utili in determinati scenari, nella maggior parte dei casi gli oggetti `GenericPrincipal` e `FormsIdentity` sono sufficienti.</span><span class="sxs-lookup"><span data-stu-id="36ec1-209">While custom principal and identity objects are useful in certain scenarios, in most cases the `GenericPrincipal` and `FormsIdentity` objects are sufficient.</span></span> <span data-ttu-id="36ec1-210">Di conseguenza, ritengo utile tornare al comportamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="36ec1-210">Consequently, I think it would be worthwhile to return to the default behavior.</span></span> <span data-ttu-id="36ec1-211">Apportare questa modifica rimuovendo o impostando come commento il gestore dell'evento `PostAuthenticateRequest` oppure eliminando completamente il file di `Global.asax`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-211">Make this change by either removing or commenting out the `PostAuthenticateRequest` event handler or by deleting the `Global.asax` file entirely.</span></span>

## <a name="step-5-programmatically-creating-a-new-user"></a><span data-ttu-id="36ec1-212">Passaggio 5: Creazione a livello di codice di un nuovo utente</span><span class="sxs-lookup"><span data-stu-id="36ec1-212">Step 5: Programmatically Creating a New User</span></span>

<span data-ttu-id="36ec1-213">Per creare un nuovo account utente tramite il Framework di appartenenza, usare il [metodo di`CreateUser`](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx)della classe `Membership`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-213">To create a new user account through the Membership framework use the `Membership` class's [`CreateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx).</span></span> <span data-ttu-id="36ec1-214">Questo metodo dispone di parametri di input per il nome utente, la password e altri campi correlati all'utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-214">This method has input parameters for the username, password, and other user-related fields.</span></span> <span data-ttu-id="36ec1-215">Alla chiamata, delega la creazione del nuovo account utente al provider di appartenenze configurato, quindi restituisce un [`MembershipUser` oggetto](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) che rappresenta l'account utente appena creato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-215">On invocation, it delegates the creation of the new user account to the configured Membership provider and then returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) representing the just-created user account.</span></span>

<span data-ttu-id="36ec1-216">Il metodo `CreateUser` dispone di quattro overload, ognuno dei quali accetta un numero diverso di parametri di input:</span><span class="sxs-lookup"><span data-stu-id="36ec1-216">The `CreateUser` method has four overloads, each accepting a different number of input parameters:</span></span>

- [`CreateUser(username, password)`](https://msdn.microsoft.com/library/d8t4h2es.aspx)
- [`CreateUser(username, password, email)`](https://msdn.microsoft.com/library/t8yy6w3h.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, MembershipCreateStatus)`](https://msdn.microsoft.com/library/82xx2e62.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, providerUserKey, MembershipCreateStatus)`](https://msdn.microsoft.com/library/ms152012.aspx)

<span data-ttu-id="36ec1-217">Questi quattro overload differiscono per la quantità di informazioni raccolte.</span><span class="sxs-lookup"><span data-stu-id="36ec1-217">These four overloads differ on the amount of information that is collected.</span></span> <span data-ttu-id="36ec1-218">Il primo overload, ad esempio, richiede solo il nome utente e la password per il nuovo account utente, mentre il secondo richiede anche l'indirizzo di posta elettronica dell'utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-218">The first overload, for example, requires just the username and password for the new user account, whereas the second one also requires the user's email address.</span></span>

<span data-ttu-id="36ec1-219">Questi overload sono disponibili perché le informazioni necessarie per creare un nuovo account utente dipendono dalle impostazioni di configurazione del provider di appartenenze.</span><span class="sxs-lookup"><span data-stu-id="36ec1-219">These overloads exist because the information needed to create a new user account depends on the Membership provider's configuration settings.</span></span> <span data-ttu-id="36ec1-220">Nell'esercitazione *<a id="_msoanchor_8"></a>[creazione dello schema di appartenenza in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* è stato esaminato come specificare le impostazioni di configurazione del provider di appartenenza in `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-220">In the *<a id="_msoanchor_8"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* tutorial we examined specifying Membership provider configuration settings in `Web.config`.</span></span> <span data-ttu-id="36ec1-221">Nella tabella 2 è incluso un elenco completo delle impostazioni di configurazione.</span><span class="sxs-lookup"><span data-stu-id="36ec1-221">Table 2 included a complete list of the configuration settings.</span></span>

<span data-ttu-id="36ec1-222">Una di queste impostazioni di configurazione del provider di appartenenze che influisca sui `CreateUser` overload che possono essere usati è l'impostazione `requiresQuestionAndAnswer`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-222">One such Membership provider configuration setting that impacts what `CreateUser` overloads may be used is the `requiresQuestionAndAnswer` setting.</span></span> <span data-ttu-id="36ec1-223">Se `requiresQuestionAndAnswer` è impostato su `true` (impostazione predefinita), quando si crea un nuovo account utente è necessario specificare una domanda e una risposta di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="36ec1-223">If `requiresQuestionAndAnswer` is set to `true` (the default), then when creating a new user account we must specify a security question and answer.</span></span> <span data-ttu-id="36ec1-224">Queste informazioni vengono usate in un secondo momento se l'utente deve reimpostare o modificare la password.</span><span class="sxs-lookup"><span data-stu-id="36ec1-224">This information is later used if the user needs to reset or change their password.</span></span> <span data-ttu-id="36ec1-225">In particolare, in quel momento vengono visualizzate le domande di sicurezza e devono immettere la risposta corretta per poter reimpostare o modificare la password.</span><span class="sxs-lookup"><span data-stu-id="36ec1-225">Specifically, at that time they are shown the security question and they must enter the correct answer in order to reset or change their password.</span></span> <span data-ttu-id="36ec1-226">Di conseguenza, se la `requiresQuestionAndAnswer` è impostata su `true` quindi la chiamata di uno dei primi due overload `CreateUser` genera un'eccezione perché la domanda e la risposta di sicurezza risultano mancanti.</span><span class="sxs-lookup"><span data-stu-id="36ec1-226">Consequently, if the `requiresQuestionAndAnswer` is set to `true` then calling either of the first two `CreateUser` overloads results in an exception because the security question and answer are missing.</span></span> <span data-ttu-id="36ec1-227">Poiché l'applicazione è attualmente configurata in modo da richiedere una domanda e una risposta di sicurezza, sarà necessario usare uno degli ultimi due overload quando si crea l'utente a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="36ec1-227">Since our application is currently configured to require a security question and answer, we will need to use one of the latter two overloads when creating user's programmatically.</span></span>

<span data-ttu-id="36ec1-228">Per illustrare l'uso del metodo `CreateUser`, è possibile creare un'interfaccia utente in cui viene richiesto all'utente il nome, la password, la posta elettronica e una risposta a una domanda di sicurezza predefinita.</span><span class="sxs-lookup"><span data-stu-id="36ec1-228">To illustrate using the `CreateUser` method, let's create a user interface where we prompt the user for their name, password, email, and an answer to a pre-defined security question.</span></span> <span data-ttu-id="36ec1-229">Aprire la pagina `CreatingUserAccounts.aspx` nella cartella `Membership` e aggiungere i controlli Web seguenti al controllo contenuto:</span><span class="sxs-lookup"><span data-stu-id="36ec1-229">Open the `CreatingUserAccounts.aspx` page in the `Membership` folder and add the following Web controls to the Content control:</span></span>

- <span data-ttu-id="36ec1-230">Casella di testo denominata `Username`</span><span class="sxs-lookup"><span data-stu-id="36ec1-230">A TextBox named `Username`</span></span>
- <span data-ttu-id="36ec1-231">Casella di testo denominata `Password`, la cui proprietà `TextMode` è impostata su `Password`</span><span class="sxs-lookup"><span data-stu-id="36ec1-231">A TextBox named `Password`, whose `TextMode` property is set to `Password`</span></span>
- <span data-ttu-id="36ec1-232">Casella di testo denominata `Email`</span><span class="sxs-lookup"><span data-stu-id="36ec1-232">A TextBox named `Email`</span></span>
- <span data-ttu-id="36ec1-233">Un'etichetta denominata `SecurityQuestion` con la relativa proprietà `Text` cancellata</span><span class="sxs-lookup"><span data-stu-id="36ec1-233">A Label named `SecurityQuestion` with its `Text` property cleared out</span></span>
- <span data-ttu-id="36ec1-234">Casella di testo denominata `SecurityAnswer`</span><span class="sxs-lookup"><span data-stu-id="36ec1-234">A TextBox named `SecurityAnswer`</span></span>
- <span data-ttu-id="36ec1-235">Un pulsante denominato `CreateAccountButton` la cui proprietà Text è impostata su "Create the user account"</span><span class="sxs-lookup"><span data-stu-id="36ec1-235">A Button named `CreateAccountButton` whose Text property is set to "Create the User Account"</span></span>
- <span data-ttu-id="36ec1-236">Un controllo etichetta denominato `CreateAccountResults` con la relativa proprietà `Text` cancellata</span><span class="sxs-lookup"><span data-stu-id="36ec1-236">A Label control named `CreateAccountResults` with its `Text` property cleared out</span></span>

<span data-ttu-id="36ec1-237">A questo punto la schermata dovrebbe essere simile a quella mostrata nella figura 6.</span><span class="sxs-lookup"><span data-stu-id="36ec1-237">At this point your screen should look similar to the screen shot shown in Figure 6.</span></span>

<span data-ttu-id="36ec1-238">[![aggiungere i vari controlli Web alla pagina CreatingUserAccounts. aspx](creating-user-accounts-cs/_static/image17.png)](creating-user-accounts-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-238">[![Add the Various Web Controls to the CreatingUserAccounts.aspx Page](creating-user-accounts-cs/_static/image17.png)](creating-user-accounts-cs/_static/image16.png)</span></span>

<span data-ttu-id="36ec1-239">**Figura 6**: Aggiungere i vari controlli Web alla pagina `CreatingUserAccounts.aspx` ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-239">**Figure 6**: Add the Various Web Controls to the `CreatingUserAccounts.aspx` Page  ([Click to view full-size image](creating-user-accounts-cs/_static/image18.png))</span></span>

<span data-ttu-id="36ec1-240">L'etichetta `SecurityQuestion` e la casella di testo `SecurityAnswer` sono destinate a visualizzare una domanda di sicurezza predefinita e a raccogliere la risposta dell'utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-240">The `SecurityQuestion` Label and `SecurityAnswer` TextBox are intended to display a pre-defined security question and collect the user's answer.</span></span> <span data-ttu-id="36ec1-241">Si noti che la domanda e la risposta di sicurezza vengono archiviate in base all'utente, pertanto è possibile consentire a ogni utente di definire una domanda di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="36ec1-241">Note that both the security question and answer are stored on a user-by-user basis, so it is possible to allow each user to define their own security question.</span></span> <span data-ttu-id="36ec1-242">Tuttavia, per questo esempio ho deciso di usare una domanda di sicurezza universale, ovvero: "Qual è il tuo colore preferito?"</span><span class="sxs-lookup"><span data-stu-id="36ec1-242">However, for this example I have decided to use a universal security question, namely: "What is your favorite color?"</span></span>

<span data-ttu-id="36ec1-243">Per implementare questa domanda di sicurezza predefinita, aggiungere una costante alla classe code-behind della pagina denominata `passwordQuestion`, assegnando la domanda di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="36ec1-243">To implement this pre-defined security question, add a constant to the page's code-behind class named `passwordQuestion`, assigning it the security question.</span></span> <span data-ttu-id="36ec1-244">Quindi, nel gestore dell'evento `Page_Load` assegnare questa costante alla proprietà `Text` dell'etichetta `SecurityQuestion`:</span><span class="sxs-lookup"><span data-stu-id="36ec1-244">Then, in the `Page_Load` event handler, assign this constant to the `SecurityQuestion` Label's `Text` property:</span></span>

[!code-csharp[Main](creating-user-accounts-cs/samples/sample5.cs)]

<span data-ttu-id="36ec1-245">Successivamente, creare un gestore eventi per l'evento `Click` del `CreateAccountButton`e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="36ec1-245">Next, create an event handler for the `CreateAccountButton`'s `Click` event and add the following code:</span></span>

[!code-csharp[Main](creating-user-accounts-cs/samples/sample6.cs)]

<span data-ttu-id="36ec1-246">Il gestore dell'evento `Click` inizia definendo una variabile denominata `createStatus` di tipo [`MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx).</span><span class="sxs-lookup"><span data-stu-id="36ec1-246">The `Click` event handler starts by defining a variable named `createStatus` of type [`MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx).</span></span> <span data-ttu-id="36ec1-247">`MembershipCreateStatus` è un'enumerazione che indica lo stato dell'operazione di `CreateUser`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-247">`MembershipCreateStatus` is an enumeration that indicates the status of the `CreateUser` operation.</span></span> <span data-ttu-id="36ec1-248">Se, ad esempio, l'account utente viene creato correttamente, l'istanza di `MembershipCreateStatus` risultante verrà impostata sul valore `Success`; d'altra parte, se l'operazione ha esito negativo perché esiste già un utente con lo stesso nome utente, verrà impostato sul valore `DuplicateUserName`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-248">For example, if the user account is created successfully, the resulting `MembershipCreateStatus` instance will be set to a value of `Success`; on the other hand, if the operation fails because there already exists a user with the same username, it will be set to a value of `DuplicateUserName`.</span></span> <span data-ttu-id="36ec1-249">Nell'overload `CreateUser` si usa, è necessario passare un'istanza di `MembershipCreateStatus` nel metodo come parametro `out`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-249">In the `CreateUser` overload we use, we need to pass a `MembershipCreateStatus` instance into the method as an `out` parameter.</span></span> <span data-ttu-id="36ec1-250">Questo parametro è impostato sul valore appropriato all'interno del metodo `CreateUser` ed è possibile esaminarne il valore dopo la chiamata al metodo per determinare se l'account utente è stato creato correttamente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-250">This parameter is set to the appropriate value within the `CreateUser` method, and we can examine its value after the method call to determine whether the user account was successfully created.</span></span>

<span data-ttu-id="36ec1-251">Dopo aver chiamato `CreateUser`, passando `createStatus`, un'istruzione `switch` viene utilizzata per restituire un messaggio appropriato a seconda del valore assegnato a `createStatus`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-251">After calling `CreateUser`, passing in `createStatus`, a `switch` statement is used to output an appropriate message depending on the value assigned to `createStatus`.</span></span> <span data-ttu-id="36ec1-252">Figures 7 Mostra l'output quando un nuovo utente è stato creato correttamente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-252">Figures 7 shows the output when a new user has successfully been created.</span></span> <span data-ttu-id="36ec1-253">Le figure 8 e 9 mostrano l'output quando l'account utente non viene creato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-253">Figures 8 and 9 show the output when the user account is not created.</span></span> <span data-ttu-id="36ec1-254">Nella figura 8, il visitatore ha immesso una password di cinque lettere, che non soddisfa i requisiti di complessità della password specificati nelle impostazioni di configurazione del provider di appartenenze.</span><span class="sxs-lookup"><span data-stu-id="36ec1-254">In Figure 8, the visitor entered a five-letter password, which does not meet the password strength requirements spelled out in the Membership provider's configuration settings.</span></span> <span data-ttu-id="36ec1-255">Nella figura 9 il visitatore sta provando a creare un account utente con un nome utente esistente (quello creato nella figura 7).</span><span class="sxs-lookup"><span data-stu-id="36ec1-255">In Figure 9, the visitor is attempting to create a user account with an existing username (the one created in Figure 7).</span></span>

<span data-ttu-id="36ec1-256">[![un nuovo account utente creato correttamente](creating-user-accounts-cs/_static/image20.png)](creating-user-accounts-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-256">[![A New User Account is Successfully Created](creating-user-accounts-cs/_static/image20.png)](creating-user-accounts-cs/_static/image19.png)</span></span>

<span data-ttu-id="36ec1-257">**Figura 7**: Creazione di un nuovo account utente completata ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-257">**Figure 7**: A New User Account is Successfully Created  ([Click to view full-size image](creating-user-accounts-cs/_static/image21.png))</span></span>

<span data-ttu-id="36ec1-258">[![l'account utente non è stato creato perché la password fornita è troppo debole](creating-user-accounts-cs/_static/image23.png)](creating-user-accounts-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-258">[![The User Account is Not Created Because the Supplied Password is Too Weak](creating-user-accounts-cs/_static/image23.png)](creating-user-accounts-cs/_static/image22.png)</span></span>

<span data-ttu-id="36ec1-259">**Figura 8**: L'account utente non è stato creato perché la password fornita è troppo debole ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-259">**Figure 8**: The User Account is Not Created Because the Supplied Password is Too Weak  ([Click to view full-size image](creating-user-accounts-cs/_static/image24.png))</span></span>

<span data-ttu-id="36ec1-260">[![l'account utente non è stato creato perché il nome utente è già in uso](creating-user-accounts-cs/_static/image26.png)](creating-user-accounts-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-260">[![The User Account is Not Created Because the Username is Already in Use](creating-user-accounts-cs/_static/image26.png)](creating-user-accounts-cs/_static/image25.png)</span></span>

<span data-ttu-id="36ec1-261">**Figura 9**: L'account utente non è stato creato perché il nome utente è già in uso ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-261">**Figure 9**: The User Account is Not Created Because the Username is Already in Use  ([Click to view full-size image](creating-user-accounts-cs/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="36ec1-262">È possibile che si stia chiedendo come determinare l'esito positivo o negativo quando si usa uno dei primi due overload del metodo `CreateUser`, nessuno dei quali ha un parametro di tipo `MembershipCreateStatus`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-262">You may be wondering how to determine success or failure when using one of the first two `CreateUser` method overloads, neither of which has a parameter of type `MembershipCreateStatus`.</span></span> <span data-ttu-id="36ec1-263">Questi primi due overload generano un' [eccezione`MembershipCreateUserException`](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx) in caso di errore, che include una [Proprietà`StatusCode`](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx) di tipo `MembershipCreateStatus`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-263">These first two overloads throw a [`MembershipCreateUserException` exception](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx) in the face of a failure, which includes a [`StatusCode` property](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx) of type `MembershipCreateStatus`.</span></span>

<span data-ttu-id="36ec1-264">Dopo aver creato alcuni account utente, verificare che gli account siano stati creati elencando il contenuto delle tabelle `aspnet_Users` e `aspnet_Membership` nel database `SecurityTutorials.mdf`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-264">After creating a few user accounts, verify that the accounts have been created by listing the contents of the `aspnet_Users` and `aspnet_Membership` tables in the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="36ec1-265">Come illustrato nella figura 10, ho aggiunto due utenti tramite la pagina `CreatingUserAccounts.aspx`: Tito e Bruce.</span><span class="sxs-lookup"><span data-stu-id="36ec1-265">As Figure 10 shows, I have added two users via the `CreatingUserAccounts.aspx` page: Tito and Bruce.</span></span>

<span data-ttu-id="36ec1-266">[![sono presenti due utenti nell'archivio utenti di appartenenza: Tito e Bruce](creating-user-accounts-cs/_static/image29.png)](creating-user-accounts-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-266">[![There are Two Users in the Membership User Store: Tito and Bruce](creating-user-accounts-cs/_static/image29.png)](creating-user-accounts-cs/_static/image28.png)</span></span>

<span data-ttu-id="36ec1-267">**Figura 10**: Sono presenti due utenti nell'archivio utenti di appartenenza: Tito e Bruce ([fare clic per visualizzare l'immagine a dimensione intera](creating-user-accounts-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-267">**Figure 10**: There are Two Users in the Membership User Store: Tito and Bruce  ([Click to view full-size image](creating-user-accounts-cs/_static/image30.png))</span></span>

<span data-ttu-id="36ec1-268">Mentre l'archivio utenti di appartenenza include ora le informazioni sull'account Bruce e Tito, è ancora necessario implementare la funzionalità che consente a Bruce o Tito di accedere al sito.</span><span class="sxs-lookup"><span data-stu-id="36ec1-268">While the Membership user store now includes Bruce and Tito's account information, we have yet to implement functionality that allows for Bruce or Tito to log on to the site.</span></span> <span data-ttu-id="36ec1-269">Attualmente, `Login.aspx` convalida le credenziali dell'utente rispetto a un set hardcoded di coppie nome utente/password, che *non convalida le* credenziali fornite rispetto al framework delle appartenenze.</span><span class="sxs-lookup"><span data-stu-id="36ec1-269">Currently, `Login.aspx` validates the user's credentials against a hard-coded set of username/password pairs – it does *not* validate the supplied credentials against the Membership framework.</span></span> <span data-ttu-id="36ec1-270">Per visualizzare ora i nuovi account utente nel `aspnet_Users` e `aspnet_Membership` le tabelle dovranno essere sufficienti.</span><span class="sxs-lookup"><span data-stu-id="36ec1-270">For now seeing the new user accounts in the `aspnet_Users` and `aspnet_Membership` tables will have to suffice.</span></span> <span data-ttu-id="36ec1-271">Nell'esercitazione successiva, *<a id="_msoanchor_9"></a>[convalida delle credenziali utente rispetto all'archivio utenti di appartenenza](validating-user-credentials-against-the-membership-user-store-cs.md)* , la pagina di accesso verrà aggiornata in modo da convalidare l'archivio delle appartenenze.</span><span class="sxs-lookup"><span data-stu-id="36ec1-271">In the next tutorial, *<a id="_msoanchor_9"></a>[Validating User Credentials Against the Membership User Store](validating-user-credentials-against-the-membership-user-store-cs.md)*, we will update the login page to validate against the Membership store.</span></span>

> [!NOTE]
> <span data-ttu-id="36ec1-272">Se non viene visualizzato alcun utente nel database di `SecurityTutorials.mdf`, è possibile che l'applicazione Web utilizzi il provider di appartenenze predefinito, `AspNetSqlMembershipProvider`, che usa il database di `ASPNETDB.mdf` come archivio utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-272">If you do not see any users in your `SecurityTutorials.mdf` database, it may be because your web application is using the default Membership provider, `AspNetSqlMembershipProvider`, which uses the `ASPNETDB.mdf` database as its user store.</span></span> <span data-ttu-id="36ec1-273">Per determinare se questo è il problema, fare clic sul pulsante Aggiorna nel Esplora soluzioni.</span><span class="sxs-lookup"><span data-stu-id="36ec1-273">To determine if this is the problem, click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="36ec1-274">Questo è il problema se è stato aggiunto un database denominato `ASPNETDB.mdf` alla cartella `App_Data`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-274">If a database named `ASPNETDB.mdf` has been added to the `App_Data` folder, this is the problem.</span></span> <span data-ttu-id="36ec1-275">Tornare al passaggio 4 dell'esercitazione *<a id="_msoanchor_10"></a>[creazione dello schema di appartenenza in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* per istruzioni su come configurare correttamente il provider di appartenenze.</span><span class="sxs-lookup"><span data-stu-id="36ec1-275">Return to Step 4 of the *<a id="_msoanchor_10"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-cs.md)* tutorial for instructions on how to properly configure the Membership provider.</span></span>

<span data-ttu-id="36ec1-276">Nella maggior parte degli scenari di creazione di account utente, il visitatore viene presentato con alcune interfacce per immettere il nome utente, la password, la posta elettronica e altre informazioni essenziali, a quel punto viene creato un nuovo account.</span><span class="sxs-lookup"><span data-stu-id="36ec1-276">In most create user account scenarios, the visitor is presented with some interface to enter their username, password, email, and other essential information, at which point a new account is created.</span></span> <span data-ttu-id="36ec1-277">In questo passaggio è stato illustrato come creare manualmente un'interfaccia e quindi come usare il metodo `Membership.CreateUser` per aggiungere a livello di codice il nuovo account utente in base agli input dell'utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-277">In this step we looked at building such an interface by hand and then saw how to use the `Membership.CreateUser` method to programmatically add the new user account based on the user's inputs.</span></span> <span data-ttu-id="36ec1-278">Il nostro codice, tuttavia, ha appena creato il nuovo account utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-278">Our code, however, just created the new user account.</span></span> <span data-ttu-id="36ec1-279">Non ha eseguito alcuna azione di completamento, ad esempio l'accesso dell'utente al sito con l'account utente appena creato o l'invio di un messaggio di posta elettronica di conferma all'utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-279">It did not perform any follow up actions, like logging in the user to the site under the just-created user account, or sending a confirmation email to the user.</span></span> <span data-ttu-id="36ec1-280">Questi passaggi aggiuntivi richiedono codice aggiuntivo nel gestore dell'evento `Click` del pulsante.</span><span class="sxs-lookup"><span data-stu-id="36ec1-280">These additional steps would require additional code in the Button's `Click` event handler.</span></span>

<span data-ttu-id="36ec1-281">ASP.NET viene fornito con il controllo CreateUserWizard, progettato per gestire il processo di creazione dell'account utente, dal rendering di un'interfaccia utente per la creazione di nuovi account utente, alla creazione dell'account nel Framework di appartenenza e all'esecuzione di post-account attività di creazione, ad esempio l'invio di un messaggio di posta elettronica di conferma e la registrazione dell'utente appena creato nel sito.</span><span class="sxs-lookup"><span data-stu-id="36ec1-281">ASP.NET ships with the CreateUserWizard control, which is designed to handle the user account creation process, from rendering a user interface for creating new user accounts, to creating the account in the Membership framework and performing post-account creation tasks, such as sending a confirmation email and logging the just-created user into the site.</span></span> <span data-ttu-id="36ec1-282">L'utilizzo del controllo CreateUserWizard è semplice quanto trascinare il controllo CreateUserWizard dalla casella degli strumenti in una pagina, quindi impostare alcune proprietà.</span><span class="sxs-lookup"><span data-stu-id="36ec1-282">Using the CreateUserWizard control is as simple as dragging the CreateUserWizard control from the Toolbox onto a page, and then setting a few properties.</span></span> <span data-ttu-id="36ec1-283">Nella maggior parte dei casi non è necessario scrivere una sola riga di codice.</span><span class="sxs-lookup"><span data-stu-id="36ec1-283">In most cases, you won't need to write a single line of code.</span></span> <span data-ttu-id="36ec1-284">Questo controllo nifty verrà esaminato in dettaglio nel passaggio 6.</span><span class="sxs-lookup"><span data-stu-id="36ec1-284">We will explore this nifty control in detail in Step 6.</span></span>

<span data-ttu-id="36ec1-285">Se i nuovi account utente vengono creati solo tramite una tipica pagina Web di creazione di account, è improbabile che sia necessario scrivere codice che usa il metodo `CreateUser`, perché il controllo CreateUserWizard sarà in grado di soddisfare le proprie esigenze.</span><span class="sxs-lookup"><span data-stu-id="36ec1-285">If new user accounts are only created through a typical Create Account web page, it is unlikely that you will ever need to write code that uses the `CreateUser` method, as the CreateUserWizard control will likely meet your needs.</span></span> <span data-ttu-id="36ec1-286">Tuttavia, il metodo `CreateUser` è utile negli scenari in cui è necessaria un'esperienza utente di creazione di account con personalizzazione elevata o quando è necessario creare nuovi account utente a livello di codice tramite un'interfaccia alternativa.</span><span class="sxs-lookup"><span data-stu-id="36ec1-286">However, the `CreateUser` method is handy in scenarios where you need a highly customized Create Account user experience or when you need to programmatically create new user accounts through an alternative interface.</span></span> <span data-ttu-id="36ec1-287">Ad esempio, potrebbe essere presente una pagina che consente a un utente di caricare un file XML che contiene informazioni sull'utente da un'altra applicazione.</span><span class="sxs-lookup"><span data-stu-id="36ec1-287">For example, you might have a page that allows a user to upload an XML file that contains user information from some other application.</span></span> <span data-ttu-id="36ec1-288">La pagina potrebbe analizzare il contenuto del file XML caricato e creare un nuovo account per ogni utente rappresentato nel codice XML chiamando il metodo `CreateUser`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-288">The page might parses the contents of the uploaded XML file and create a new account for each user represented in the XML by calling the `CreateUser` method.</span></span>

## <a name="step-6-creating-a-new-user-with-the-createuserwizard-control"></a><span data-ttu-id="36ec1-289">Passaggio 6: Creazione di un nuovo utente con il controllo CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="36ec1-289">Step 6: Creating a New User with the CreateUserWizard Control</span></span>

<span data-ttu-id="36ec1-290">ASP.NET viene fornito con una serie di controlli Web di accesso.</span><span class="sxs-lookup"><span data-stu-id="36ec1-290">ASP.NET ships with a number of Login Web controls.</span></span> <span data-ttu-id="36ec1-291">Questi controlli facilitano molti scenari comuni relativi agli account utente e agli account di accesso.</span><span class="sxs-lookup"><span data-stu-id="36ec1-291">These controls aid in many common user account- and login-related scenarios.</span></span> <span data-ttu-id="36ec1-292">Il [controllo CreateUserWizard](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx) è un controllo di questo tipo progettato per presentare un'interfaccia utente per l'aggiunta di un nuovo account utente al framework delle appartenenze.</span><span class="sxs-lookup"><span data-stu-id="36ec1-292">The [CreateUserWizard control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx) is one such control that is designed to present a user interface for adding a new user account to the Membership framework.</span></span>

<span data-ttu-id="36ec1-293">Come molti altri controlli Web correlati all'accesso, l'oggetto CreateUserWizard può essere utilizzato senza scrivere una sola riga di codice.</span><span class="sxs-lookup"><span data-stu-id="36ec1-293">Like many of the other Login-related Web controls, the CreateUserWizard can be used without writing a single line of code.</span></span> <span data-ttu-id="36ec1-294">Fornisce un'interfaccia utente in modo intuitivo in base alle impostazioni di configurazione del provider di appartenenze e chiama internamente il metodo `CreateUser` della classe `Membership` dopo che l'utente immette le informazioni necessarie e fa clic sul pulsante "Crea utente".</span><span class="sxs-lookup"><span data-stu-id="36ec1-294">It intuitively provides a user interface based on the Membership provider's configuration settings and internally calls the `Membership` class's `CreateUser` method after the user enters the necessary information and clicks the "Create User" button.</span></span> <span data-ttu-id="36ec1-295">Il controllo CreateUserWizard è estremamente personalizzabile.</span><span class="sxs-lookup"><span data-stu-id="36ec1-295">The CreateUserWizard control is extremely customizable.</span></span> <span data-ttu-id="36ec1-296">Durante le varie fasi del processo di creazione dell'account, viene generato un host di eventi.</span><span class="sxs-lookup"><span data-stu-id="36ec1-296">There are a host of events that fire during various stages of the account creation process.</span></span> <span data-ttu-id="36ec1-297">È possibile creare i gestori eventi, se necessario, per inserire la logica personalizzata nel flusso di lavoro di creazione dell'account.</span><span class="sxs-lookup"><span data-stu-id="36ec1-297">We can create event handlers, as needed, to inject custom logic into the account creation workflow.</span></span> <span data-ttu-id="36ec1-298">Inoltre, l'aspetto di CreateUserWizard è molto flessibile.</span><span class="sxs-lookup"><span data-stu-id="36ec1-298">Furthermore, the CreateUserWizard's appearance is very flexible.</span></span> <span data-ttu-id="36ec1-299">Sono disponibili numerose proprietà che definiscono l'aspetto dell'interfaccia predefinita; Se necessario, il controllo può essere convertito in un modello o è possibile aggiungere "passaggi" per la registrazione utente aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="36ec1-299">There are a number of properties that define the appearance of the default interface; if necessary, the control can be converted into a template or additional user registration "steps" may be added.</span></span>

<span data-ttu-id="36ec1-300">Iniziamo con un'occhiata all'uso dell'interfaccia e del comportamento predefiniti del controllo CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="36ec1-300">Let's start with a look at using the CreateUserWizard control's default interface and behavior.</span></span> <span data-ttu-id="36ec1-301">Si esaminerà quindi come personalizzare l'aspetto tramite le proprietà e gli eventi del controllo.</span><span class="sxs-lookup"><span data-stu-id="36ec1-301">We'll then explore how to customize the appearance via the control's properties and events.</span></span>

### <a name="examining-the-createuserwizards-default-interface-and-behavior"></a><span data-ttu-id="36ec1-302">Esame dell'interfaccia e del comportamento predefiniti di CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="36ec1-302">Examining the CreateUserWizard's Default Interface and Behavior</span></span>

<span data-ttu-id="36ec1-303">Tornare alla pagina `CreatingUserAccounts.aspx` nella cartella `Membership`, passare alla modalità progettazione o divisione, quindi aggiungere un controllo CreateUserWizard nella parte superiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="36ec1-303">Return to the `CreatingUserAccounts.aspx` page in the `Membership` folder, switch to the Design or Split mode, and then add a CreateUserWizard control to the top of the page.</span></span> <span data-ttu-id="36ec1-304">Il controllo CreateUserWizard viene archiviato nella sezione controlli di accesso della casella degli strumenti.</span><span class="sxs-lookup"><span data-stu-id="36ec1-304">The CreateUserWizard control is filed under the Toolbox's Login controls section.</span></span> <span data-ttu-id="36ec1-305">Dopo l'aggiunta del controllo, impostare la relativa proprietà `ID` su `RegisterUser`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-305">After adding the control, set its `ID` property to `RegisterUser`.</span></span> <span data-ttu-id="36ec1-306">Come illustrato nella figura 11, l'oggetto CreateUserWizard esegue il rendering di un'interfaccia con caselle di testo per il nome utente, la password, l'indirizzo di posta elettronica, la domanda e la risposta di sicurezza del nuovo utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-306">As the screen shot in Figure 11 shows, the CreateUserWizard renders an interface with textboxes for the new user's username, password, email address, and security question and answer.</span></span>

<span data-ttu-id="36ec1-307">[![il controllo CreateUserWizard esegue il rendering di un'interfaccia utente di creazione generica](creating-user-accounts-cs/_static/image32.png)](creating-user-accounts-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-307">[![The CreateUserWizard Control Renders a Generic Create User Interface](creating-user-accounts-cs/_static/image32.png)](creating-user-accounts-cs/_static/image31.png)</span></span>

<span data-ttu-id="36ec1-308">**Figura 11**: Il controllo CreateUserWizard esegue il rendering di un'interfaccia utente di creazione generica ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-308">**Figure 11**: The CreateUserWizard Control Renders a Generic Create User Interface  ([Click to view full-size image](creating-user-accounts-cs/_static/image33.png))</span></span>

<span data-ttu-id="36ec1-309">A questo punto, è necessario confrontare l'interfaccia utente predefinita generata dal controllo CreateUserWizard con l'interfaccia creata nel passaggio 5.</span><span class="sxs-lookup"><span data-stu-id="36ec1-309">Let's take a moment to compare the default user interface generated by the CreateUserWizard control with the interface we created in Step 5.</span></span> <span data-ttu-id="36ec1-310">Per i principianti, il controllo CreateUserWizard consente al visitatore di specificare la domanda e la risposta di sicurezza, mentre l'interfaccia creata manualmente usava una domanda di sicurezza predefinita.</span><span class="sxs-lookup"><span data-stu-id="36ec1-310">For starters, the CreateUserWizard control allows the visitor to specify both the security question and answer, whereas our manually-created interface used a pre-defined security question.</span></span> <span data-ttu-id="36ec1-311">L'interfaccia del controllo CreateUserWizard include anche controlli di convalida, mentre era ancora necessario implementare la convalida sui campi del form dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="36ec1-311">The CreateUserWizard control's interface also includes validation controls, whereas we had yet to implement validation on our interface's form fields.</span></span> <span data-ttu-id="36ec1-312">E l'interfaccia di controllo CreateUserWizard include una casella di testo "Confirm password" (insieme a un oggetto CompareValidator) per garantire che il testo immesso nelle caselle di testo "password" e "Confronta password" sia uguale.</span><span class="sxs-lookup"><span data-stu-id="36ec1-312">And the CreateUserWizard control interface includes a "Confirm Password" textbox (along with a CompareValidator to ensure that the text entered the "Password" and "Compare Password" textboxes are equal).</span></span>

<span data-ttu-id="36ec1-313">L'aspetto interessante è che il controllo CreateUserWizard consulta le impostazioni di configurazione del provider di appartenenza durante il rendering dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-313">What's interesting is that the CreateUserWizard control consults the Membership provider's configuration settings when rendering its user interface.</span></span> <span data-ttu-id="36ec1-314">Le caselle di testo domande e risposte di sicurezza, ad esempio, vengono visualizzate solo se `requiresQuestionAndAnswer` è impostato su true.</span><span class="sxs-lookup"><span data-stu-id="36ec1-314">For example, the security question and answer textboxes are only displayed if `requiresQuestionAndAnswer` is set to True.</span></span> <span data-ttu-id="36ec1-315">Allo stesso modo, CreateUserWizard aggiunge automaticamente un controllo RegularExpressionValidator per garantire che vengano soddisfatti i requisiti di complessità della password e imposta le proprietà `ErrorMessage` e `ValidationExpression` in base alle impostazioni di configurazione `minRequiredPasswordLength`, `minRequiredNonalphanumericCharacters`e `passwordStrengthRegularExpression`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-315">Likewise, CreateUserWizard automatically adds a RegularExpressionValidator control to ensure that the password strength requirements are met, and sets its `ErrorMessage` and `ValidationExpression` properties based on the `minRequiredPasswordLength`, `minRequiredNonalphanumericCharacters`, and `passwordStrengthRegularExpression` configuration settings.</span></span>

<span data-ttu-id="36ec1-316">Il controllo CreateUserWizard, come implica il nome, deriva dal controllo della [procedura guidata](https://msdn.microsoft.com/library/s2etd1ek.aspx).</span><span class="sxs-lookup"><span data-stu-id="36ec1-316">The CreateUserWizard control, as its name implies, is derived from the [Wizard control](https://msdn.microsoft.com/library/s2etd1ek.aspx).</span></span> <span data-ttu-id="36ec1-317">I controlli della procedura guidata sono progettati per fornire un'interfaccia per il completamento delle attività in più passaggi.</span><span class="sxs-lookup"><span data-stu-id="36ec1-317">Wizard controls are designed to provide an interface for completing multi-step tasks.</span></span> <span data-ttu-id="36ec1-318">Un controllo della procedura guidata può avere un numero arbitrario di `WizardSteps`, ciascuno dei quali è un modello che definisce i controlli HTML e Web per tale passaggio.</span><span class="sxs-lookup"><span data-stu-id="36ec1-318">A Wizard control may have an arbitrary number of `WizardSteps`, each of which is a template that defines the HTML and Web controls for that step.</span></span> <span data-ttu-id="36ec1-319">Il controllo della procedura guidata visualizza inizialmente il primo `WizardStep`, insieme ai controlli di navigazione che consentono all'utente di passare da un passaggio a quello successivo o di tornare ai passaggi precedenti.</span><span class="sxs-lookup"><span data-stu-id="36ec1-319">The Wizard control initially displays the first `WizardStep`, along with navigation controls that permit the user to proceed from one step to the next, or to return to previous steps.</span></span>

<span data-ttu-id="36ec1-320">Come illustrato nel markup dichiarativo nella figura 11, l'interfaccia predefinita del controllo CreateUserWizard include due `WizardSteps:`</span><span class="sxs-lookup"><span data-stu-id="36ec1-320">As the declarative markup in Figure 11 shows, the CreateUserWizard control's default interface includes two `WizardSteps:`</span></span>

- <span data-ttu-id="36ec1-321">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) : esegue il rendering dell'interfaccia per raccogliere informazioni per la creazione del nuovo account utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-321">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) – renders the interface to collect information for creating the new user account.</span></span> <span data-ttu-id="36ec1-322">Questo è il passaggio illustrato nella figura 11.</span><span class="sxs-lookup"><span data-stu-id="36ec1-322">This is the step shown in Figure 11.</span></span>
- <span data-ttu-id="36ec1-323">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) : esegue il rendering di un messaggio che indica che l'account è stato creato correttamente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-323">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) – renders a message indicating that the account has successfully been created.</span></span>

<span data-ttu-id="36ec1-324">L'aspetto e il comportamento di CreateUserWizard possono essere modificati convertendo uno di questi passaggi nei modelli o aggiungendo il proprio `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-324">The CreateUserWizard's appearance and behavior can be modified by converting either of these steps to templates, or by adding your own `WizardSteps`.</span></span> <span data-ttu-id="36ec1-325">Si esaminerà l'aggiunta di un `WizardStep` all'interfaccia di registrazione nell'esercitazione *archiviare informazioni aggiuntive sull'utente* .</span><span class="sxs-lookup"><span data-stu-id="36ec1-325">We will look at adding a `WizardStep` to the registration interface in the *Storing Additional User Information* tutorial.</span></span>

<span data-ttu-id="36ec1-326">Viene ora visualizzato il controllo CreateUserWizard in azione.</span><span class="sxs-lookup"><span data-stu-id="36ec1-326">Let's see the CreateUserWizard control in action.</span></span> <span data-ttu-id="36ec1-327">Visitare la pagina `CreatingUserAccounts.aspx` tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="36ec1-327">Visit the `CreatingUserAccounts.aspx` page through a browser.</span></span> <span data-ttu-id="36ec1-328">Per iniziare, immettere alcuni valori non validi nell'interfaccia di CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="36ec1-328">Start by entering some invalid values into the CreateUserWizard's interface.</span></span> <span data-ttu-id="36ec1-329">Provare ad immettere una password non conforme ai requisiti di complessità della password o lasciare vuota la casella di testo "nome utente".</span><span class="sxs-lookup"><span data-stu-id="36ec1-329">Try entering a password that doesn't conform to the password strength requirements, or leaving the "User Name" textbox empty.</span></span> <span data-ttu-id="36ec1-330">In CreateUserWizard verrà visualizzato un messaggio di errore appropriato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-330">The CreateUserWizard will display an appropriate error message.</span></span> <span data-ttu-id="36ec1-331">Nella figura 12 viene illustrato l'output quando si tenta di creare un utente con una password non sufficientemente complessa.</span><span class="sxs-lookup"><span data-stu-id="36ec1-331">Figure 12 shows the output when attempting to create a user with an insufficiently strong password.</span></span>

<span data-ttu-id="36ec1-332">[![CreateUserWizard inserisce automaticamente i controlli di convalida](creating-user-accounts-cs/_static/image35.png)](creating-user-accounts-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-332">[![The CreateUserWizard Automatically Injects Validation Controls](creating-user-accounts-cs/_static/image35.png)](creating-user-accounts-cs/_static/image34.png)</span></span>

<span data-ttu-id="36ec1-333">**Figura 12**: CreateUserWizard inserisce automaticamente i controlli di convalida ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-333">**Figure 12**: The CreateUserWizard Automatically Injects Validation Controls  ([Click to view full-size image](creating-user-accounts-cs/_static/image36.png))</span></span>

<span data-ttu-id="36ec1-334">Immettere quindi i valori appropriati in CreateUserWizard e fare clic sul pulsante "Crea utente".</span><span class="sxs-lookup"><span data-stu-id="36ec1-334">Next, enter appropriate values into the CreateUserWizard and click the "Create User" button.</span></span> <span data-ttu-id="36ec1-335">Supponendo che siano stati immessi i campi obbligatori e che il livello di attendibilità della password sia sufficiente, CreateUserWizard creerà un nuovo account utente tramite il Framework di appartenenza e quindi visualizzerà l'interfaccia del `CompleteWizardStep`(vedere la figura 13).</span><span class="sxs-lookup"><span data-stu-id="36ec1-335">Assuming the required fields have been entered and the password's strength is sufficient, the CreateUserWizard will create a new user account through the Membership framework and then display the `CompleteWizardStep`'s interface (see Figure 13).</span></span> <span data-ttu-id="36ec1-336">Dietro le quinte, CreateUserWizard chiama il metodo `Membership.CreateUser`, esattamente come nel passaggio 5.</span><span class="sxs-lookup"><span data-stu-id="36ec1-336">Behind the scenes, the CreateUserWizard calls the `Membership.CreateUser` method, just like we did in Step 5.</span></span>

<span data-ttu-id="36ec1-337">[![un nuovo account utente è stato creato correttamente](creating-user-accounts-cs/_static/image38.png)](creating-user-accounts-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-337">[![A New User Account has Successfully Been Created](creating-user-accounts-cs/_static/image38.png)](creating-user-accounts-cs/_static/image37.png)</span></span>

<span data-ttu-id="36ec1-338">**Figura 13**: È stato creato un nuovo account utente ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-338">**Figure 13**: A New User Account has Successfully Been Created  ([Click to view full-size image](creating-user-accounts-cs/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="36ec1-339">Come illustrato nella figura 13, l'interfaccia del `CompleteWizardStep`include un pulsante continua.</span><span class="sxs-lookup"><span data-stu-id="36ec1-339">As Figure 13 shows, the `CompleteWizardStep`'s interface includes a Continue button.</span></span> <span data-ttu-id="36ec1-340">Tuttavia, a questo punto, facendo clic su di esso viene semplicemente eseguito un postback, lasciando il visitatore nella stessa pagina.</span><span class="sxs-lookup"><span data-stu-id="36ec1-340">However, at this point clicking it just performs a postback, leaving the visitor on the same page.</span></span> <span data-ttu-id="36ec1-341">Nella sezione "personalizzazione dell'aspetto e del comportamento di CreateUserWizard tramite le relative proprietà" si esaminerà come è possibile fare in modo che questo pulsante invii il visitatore a `Default.aspx` o a un'altra pagina.</span><span class="sxs-lookup"><span data-stu-id="36ec1-341">In the "Customizing the CreateUserWizard's Appearance and Behavior Through Its Properties" section we will look at how you can have this button send the visitor to `Default.aspx` (or some other page).</span></span>

<span data-ttu-id="36ec1-342">Dopo aver creato un nuovo account utente, tornare a Visual Studio ed esaminare le tabelle `aspnet_Users` e `aspnet_Membership`, come illustrato nella figura 10, per verificare che l'account sia stato creato correttamente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-342">After creating a new user account, return to Visual Studio and examine the `aspnet_Users` and `aspnet_Membership` tables like we did in Figure 10 to verify that the account was successfully created.</span></span>

### <a name="customizing-the-createuserwizards-behavior-and-appearance-through-its-properties"></a><span data-ttu-id="36ec1-343">Personalizzazione del comportamento e dell'aspetto di CreateUserWizard tramite le relative proprietà</span><span class="sxs-lookup"><span data-stu-id="36ec1-343">Customizing the CreateUserWizard's Behavior and Appearance Through Its Properties</span></span>

<span data-ttu-id="36ec1-344">È possibile personalizzare CreateUserWizard in diversi modi, tramite proprietà, `WizardSteps`e gestori eventi.</span><span class="sxs-lookup"><span data-stu-id="36ec1-344">The CreateUserWizard can be customized in a variety of ways, through properties, `WizardSteps`, and event handlers.</span></span> <span data-ttu-id="36ec1-345">In questa sezione verrà illustrato come personalizzare l'aspetto del controllo tramite le relative proprietà. la sezione successiva esamina l'estensione del comportamento del controllo tramite i gestori eventi.</span><span class="sxs-lookup"><span data-stu-id="36ec1-345">In this section we will look at how to customize the control's appearance through its properties; the next section looks at extending the control's behavior through event handlers.</span></span>

<span data-ttu-id="36ec1-346">Praticamente tutto il testo visualizzato nell'interfaccia utente predefinita del controllo CreateUserWizard può essere personalizzato tramite la relativa pletora di proprietà.</span><span class="sxs-lookup"><span data-stu-id="36ec1-346">Virtually all of the text displayed in the CreateUserWizard control's default user interface can be customized through its plethora of properties.</span></span> <span data-ttu-id="36ec1-347">Ad esempio, le etichette "nome utente", "password", "conferma password", "posta elettronica", "domanda di sicurezza" e "risposta di sicurezza" visualizzate a sinistra delle caselle di testo possono essere personalizzate rispettivamente dalle proprietà [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx), [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx), [`ConfirmPasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx), [`EmailLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx), [`QuestionLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx)e [`AnswerLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx) .</span><span class="sxs-lookup"><span data-stu-id="36ec1-347">For example, the "User Name", "Password", "Confirm Password", "E-mail", "Security Question", and "Security Answer" labels displayed to the left of the textboxes can be customized by the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx), [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx), [`ConfirmPasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx), [`EmailLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx), [`QuestionLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx), and [`AnswerLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx) properties, respectively.</span></span> <span data-ttu-id="36ec1-348">Analogamente, esistono proprietà che consentono di specificare il testo per i pulsanti "Crea utente" e "continua" nel `CreateUserWizardStep` e `CompleteWizardStep`, nonché se questi pulsanti vengono visualizzati come pulsanti, LinkButton o ImageButton.</span><span class="sxs-lookup"><span data-stu-id="36ec1-348">Likewise, there are properties for specifying the text for the "Create User" and "Continue" buttons in the `CreateUserWizardStep` and `CompleteWizardStep`, as well as if these buttons are rendered as Buttons, LinkButtons, or ImageButtons.</span></span>

<span data-ttu-id="36ec1-349">I colori, i bordi, i tipi di carattere e altri elementi visivi sono configurabili tramite un host di proprietà di stile.</span><span class="sxs-lookup"><span data-stu-id="36ec1-349">The colors, borders, fonts, and other visual elements are configurable through a host of style properties.</span></span> <span data-ttu-id="36ec1-350">Il controllo CreateUserWizard ha le proprietà di stile del controllo Web comuni, `BackColor`, `BorderStyle`, `CssClass`, `Font`e così via, e sono disponibili diverse proprietà di stile per la definizione dell'aspetto per sezioni specifiche dell'interfaccia di CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="36ec1-350">The CreateUserWizard control itself has the common Web control style properties – `BackColor`, `BorderStyle`, `CssClass`, `Font`, and so on – and there are a number of style properties for defining the appearance for particular sections of the CreateUserWizard's interface.</span></span> <span data-ttu-id="36ec1-351">La [proprietà`TextBoxStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx), ad esempio, definisce gli stili per le caselle di testo nella `CreateUserWizardStep`, mentre la [Proprietà`TitleTextStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx) definisce lo stile del titolo ("iscriversi al nuovo account").</span><span class="sxs-lookup"><span data-stu-id="36ec1-351">The [`TextBoxStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx), for instance, defines the styles for the textboxes in the `CreateUserWizardStep`, while the [`TitleTextStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx) defines the style for the title ("Sign Up for Your New Account").</span></span>

<span data-ttu-id="36ec1-352">Oltre alle proprietà correlate all'aspetto, esistono diverse proprietà che influiscono sul comportamento del controllo CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="36ec1-352">In addition to the appearance-related properties, there are a number of properties that affect the CreateUserWizard control's behavior.</span></span> <span data-ttu-id="36ec1-353">La [proprietà`DisplayCancelButton`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx), se impostata su true, Visualizza un pulsante Annulla accanto al pulsante "Crea utente" (il valore predefinito è false).</span><span class="sxs-lookup"><span data-stu-id="36ec1-353">The [`DisplayCancelButton` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx), if set to True, displays a Cancel button next to the "Create User" button (the default value is False).</span></span> <span data-ttu-id="36ec1-354">Se viene visualizzato il pulsante Annulla, assicurarsi di impostare anche la [proprietà`CancelDestinationPageUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx), che specifica la pagina a cui viene inviato l'utente dopo aver fatto clic su Annulla.</span><span class="sxs-lookup"><span data-stu-id="36ec1-354">If you display the Cancel button, be sure to also set the [`CancelDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx), which specifies the page the user is sent to after clicking Cancel.</span></span> <span data-ttu-id="36ec1-355">Come indicato nella sezione precedente, il pulsante continua nell'interfaccia del `CompleteWizardStep`causa un postback, ma lascia il visitatore nella stessa pagina.</span><span class="sxs-lookup"><span data-stu-id="36ec1-355">As noted in the previous section, the Continue button in the `CompleteWizardStep`'s interface causes a postback, but leaves the visitor on the same page.</span></span> <span data-ttu-id="36ec1-356">Per inviare il visitatore ad altre pagine dopo aver fatto clic sul pulsante continue (continua), è sufficiente specificare l'URL nella [proprietà`ContinueDestinationPageUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="36ec1-356">To send the visitor to some other page after clicking the Continue button, simply specify the URL in the [`ContinueDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span></span>

<span data-ttu-id="36ec1-357">Verrà ora aggiornato il controllo `RegisterUser` CreateUserWizard per visualizzare un pulsante Annulla e per inviare il visitatore a `Default.aspx` quando si fa clic sui pulsanti Annulla o continua.</span><span class="sxs-lookup"><span data-stu-id="36ec1-357">Let's update the `RegisterUser` CreateUserWizard control to show a Cancel button and to send the visitor to `Default.aspx` when the Cancel or Continue buttons are clicked.</span></span> <span data-ttu-id="36ec1-358">A tale scopo, impostare la proprietà `DisplayCancelButton` su true e le proprietà `CancelDestinationPageUrl` e `ContinueDestinationPageUrl` su "~/default.aspx".</span><span class="sxs-lookup"><span data-stu-id="36ec1-358">To accomplish this, set the `DisplayCancelButton` property to True and both the `CancelDestinationPageUrl` and `ContinueDestinationPageUrl` properties to "~/Default.aspx".</span></span> <span data-ttu-id="36ec1-359">Nella figura 14 viene illustrato l'oggetto CreateUserWizard aggiornato quando viene visualizzato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="36ec1-359">Figure 14 shows the updated CreateUserWizard when viewed through a browser.</span></span>

<span data-ttu-id="36ec1-360">[![CreateUserWizardStep include un pulsante Annulla](creating-user-accounts-cs/_static/image41.png)](creating-user-accounts-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-360">[![The CreateUserWizardStep Includes a Cancel Button](creating-user-accounts-cs/_static/image41.png)](creating-user-accounts-cs/_static/image40.png)</span></span>

<span data-ttu-id="36ec1-361">**Figura 14**: Il `CreateUserWizardStep` include un pulsante Annulla ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-361">**Figure 14**: The `CreateUserWizardStep` Includes a Cancel Button  ([Click to view full-size image](creating-user-accounts-cs/_static/image42.png))</span></span>

<span data-ttu-id="36ec1-362">Quando un visitatore immette un nome utente, una password, un indirizzo di posta elettronica e una domanda e una risposta di sicurezza e fa clic su "Crea utente", viene creato un nuovo account utente e il visitatore è connesso come utente appena creato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-362">When a visitor enters a username, password, email address, and security question and answer and clicks "Create User," a new user account is created and the visitor is logged in as that newly created user.</span></span> <span data-ttu-id="36ec1-363">Supponendo che la persona che visita la pagina stia creando un nuovo account per se stesso, questo è probabilmente il comportamento desiderato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-363">Assuming that the person visiting the page is creating a new account for themselves, this is likely the desired behavior.</span></span> <span data-ttu-id="36ec1-364">Tuttavia, può essere utile consentire agli amministratori di aggiungere nuovi account utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-364">However, you may want to allow Administrators to add new user accounts.</span></span> <span data-ttu-id="36ec1-365">In questo modo, verrà creato l'account utente, ma l'amministratore rimarrà connesso come amministratore e non come account appena creato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-365">In doing so, the user account would be created, but the Administrator would remain logged in as an Administrator (and not as the newly created account).</span></span> <span data-ttu-id="36ec1-366">Questo comportamento può essere modificato tramite la proprietà booleana [`LoginCreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span><span class="sxs-lookup"><span data-stu-id="36ec1-366">This behavior can be modified through the Boolean [`LoginCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span></span>

<span data-ttu-id="36ec1-367">Gli account utente nel Framework di appartenenza contengono un flag approvato; Gli utenti che non sono approvati non sono in grado di accedere al sito.</span><span class="sxs-lookup"><span data-stu-id="36ec1-367">User accounts in the Membership framework contain an approved flag; users who are not approved are unable to log into the site.</span></span> <span data-ttu-id="36ec1-368">Per impostazione predefinita, un account appena creato è contrassegnato come approvato, consentendo all'utente di accedere immediatamente al sito.</span><span class="sxs-lookup"><span data-stu-id="36ec1-368">By default, a newly created account is marked as approved, allowing the user to log into the site immediately.</span></span> <span data-ttu-id="36ec1-369">È tuttavia possibile avere nuovi account utente contrassegnati come non approvati.</span><span class="sxs-lookup"><span data-stu-id="36ec1-369">It is possible, however, to have new user accounts marked as unapproved.</span></span> <span data-ttu-id="36ec1-370">Potrebbe essere necessario che un amministratore approvi manualmente i nuovi utenti prima di poter eseguire l'accesso. in alternativa, è possibile verificare che l'indirizzo di posta elettronica immesso al momento dell'iscrizione sia valido prima di consentire a un utente di effettuare l'accesso.</span><span class="sxs-lookup"><span data-stu-id="36ec1-370">Perhaps you want an Administrator to manually approve new users before they can log in; or maybe you want to verify that the email address entered at signup is valid before permitting a user to log on.</span></span> <span data-ttu-id="36ec1-371">Qualunque sia il caso, è possibile fare in modo che l'account utente appena creato venga contrassegnato come non approvato impostando la [proprietà`DisableCreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx) del controllo CreateUserWizard su true (il valore predefinito è false).</span><span class="sxs-lookup"><span data-stu-id="36ec1-371">Whatever the case may be, you can have the newly created user account marked as unapproved by setting the CreateUserWizard control's [`DisableCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx) to True (the default is False).</span></span>

<span data-ttu-id="36ec1-372">Altre proprietà relative al comportamento di nota includono `AutoGeneratePassword` e `MailDefinition`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-372">Other behavior-related properties of note include `AutoGeneratePassword` and `MailDefinition`.</span></span> <span data-ttu-id="36ec1-373">Se la [proprietà`AutoGeneratePassword`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx) è impostata su true, nel `CreateUserWizardStep` non vengono visualizzate le caselle di testo "password" e "conferma password"; la password dell'utente appena creata viene invece generata automaticamente utilizzando il [metodo`GeneratePassword`](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx)della classe `Membership`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-373">If the [`AutoGeneratePassword` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx) is set to True, the `CreateUserWizardStep` does not display the "Password" and "Confirm Password" textboxes; instead, the newly-created user's password is automatically generated using the `Membership` class's [`GeneratePassword` method](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx).</span></span> <span data-ttu-id="36ec1-374">Il metodo `GeneratePassword` costruisce una password di lunghezza specificata e con un numero sufficiente di caratteri non alfanumerici per soddisfare i requisiti di complessità della password configurati.</span><span class="sxs-lookup"><span data-stu-id="36ec1-374">The `GeneratePassword` method constructs a password of a specified length and with a sufficient number of non-alphanumeric characters to satisfy the configured password strength requirements.</span></span>

<span data-ttu-id="36ec1-375">La [proprietà`MailDefinition`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) è utile se si desidera inviare un messaggio di posta elettronica all'indirizzo di posta elettronica specificato durante il processo di creazione dell'account.</span><span class="sxs-lookup"><span data-stu-id="36ec1-375">The [`MailDefinition` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) is useful if you want to send an email to the email address specified during the account creation process.</span></span> <span data-ttu-id="36ec1-376">La proprietà `MailDefinition` include una serie di sottoproprietà per la definizione delle informazioni sul messaggio di posta elettronica costruito.</span><span class="sxs-lookup"><span data-stu-id="36ec1-376">The `MailDefinition` property includes a series of subproperties for defining information about the constructed email message.</span></span> <span data-ttu-id="36ec1-377">Queste sottoproprietà includono opzioni come `Subject`, `Priority`, `IsBodyHtml`, `From`, `CC`e `BodyFileName`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-377">These subproperties include options like `Subject`, `Priority`, `IsBodyHtml`, `From`, `CC`, and `BodyFileName`.</span></span> <span data-ttu-id="36ec1-378">La [proprietà`BodyFileName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx) punta a un file di testo o HTML che contiene il corpo del messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="36ec1-378">The [`BodyFileName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx) points to a text or HTML file that contains the body for the email message.</span></span> <span data-ttu-id="36ec1-379">Il corpo supporta due segnaposto predefiniti: `<%UserName%>` e `<%Password%>`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-379">The body supports two pre-defined placeholders: `<%UserName%>` and `<%Password%>`.</span></span> <span data-ttu-id="36ec1-380">Questi segnaposto, se presenti nel file di `BodyFileName`, verranno sostituiti con il nome e la password dell'utente appena creato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-380">These placeholders, if present in the `BodyFileName` file, will be replaced with the just-created user's name and password.</span></span>

> [!NOTE]
> <span data-ttu-id="36ec1-381">La proprietà `MailDefinition` del controllo `CreateUserWizard` specifica solo i dettagli relativi al messaggio di posta elettronica inviato quando viene creato un nuovo account.</span><span class="sxs-lookup"><span data-stu-id="36ec1-381">The `CreateUserWizard` control's `MailDefinition` property just specifies details about the email message that is sent when a new account is created.</span></span> <span data-ttu-id="36ec1-382">Non include informazioni dettagliate sul modo in cui il messaggio di posta elettronica viene effettivamente inviato, ovvero se viene utilizzato un server SMTP o una directory di destinazione della posta elettronica, le informazioni di autenticazione e così via.</span><span class="sxs-lookup"><span data-stu-id="36ec1-382">It does not include any details on how the email message is actually sent (that is, whether an SMTP server or mail drop directory is used, any authentication information, and so on).</span></span> <span data-ttu-id="36ec1-383">Questi dettagli di basso livello devono essere definiti nella sezione `<system.net>` in `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-383">These low-level details need to be defined in the `<system.net>` section in `Web.config`.</span></span> <span data-ttu-id="36ec1-384">Per altre informazioni su queste impostazioni di configurazione e sull'invio di messaggi di posta elettronica da ASP.NET 2,0 in generale, vedere le [domande frequenti in SystemNetMail.com](http://www.systemnetmail.com/) e il mio articolo [invio di messaggi di posta elettronica in ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="36ec1-384">For more information on these configuration settings and on sending email from ASP.NET 2.0 in general, refer to the [FAQs at SystemNetMail.com](http://www.systemnetmail.com/) and my article, [Sending Email in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span></span>

### <a name="extending-the-createuserwizards-behavior-using-event-handlers"></a><span data-ttu-id="36ec1-385">Estensione del comportamento di CreateUserWizard mediante i gestori eventi</span><span class="sxs-lookup"><span data-stu-id="36ec1-385">Extending the CreateUserWizard's Behavior Using Event Handlers</span></span>

<span data-ttu-id="36ec1-386">Il controllo CreateUserWizard genera un certo numero di eventi durante il relativo flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="36ec1-386">The CreateUserWizard control raises a number of events during its workflow.</span></span> <span data-ttu-id="36ec1-387">Ad esempio, dopo che un visitatore immette il nome utente, la password e altre informazioni pertinenti e fa clic sul pulsante "Crea utente", il controllo CreateUserWizard genera il relativo [evento`CreatingUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span><span class="sxs-lookup"><span data-stu-id="36ec1-387">For example, after a visitor enters their username, password, and other pertinent information and clicks the "Create User" button, the CreateUserWizard control raises its [`CreatingUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span></span> <span data-ttu-id="36ec1-388">Se si verifica un problema durante il processo di creazione, viene generato l' [evento`CreateUserError`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) ; Tuttavia, se l'utente viene creato correttamente, viene generato l' [evento`CreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) .</span><span class="sxs-lookup"><span data-stu-id="36ec1-388">If there is a problem during the create process, the [`CreateUserError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) is fired; however, if the user is successfully created, then the [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) is raised.</span></span> <span data-ttu-id="36ec1-389">Sono presenti eventi di controllo CreateUserWizard aggiuntivi che vengono generati, ma questi sono i tre più tedeschi.</span><span class="sxs-lookup"><span data-stu-id="36ec1-389">There are additional CreateUserWizard control events that get raised, but these are the three most germane ones.</span></span>

<span data-ttu-id="36ec1-390">In alcuni scenari è possibile che si desideri accedere al flusso di lavoro di CreateUserWizard, che è possibile eseguire creando un gestore eventi per l'evento appropriato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-390">In certain scenarios we may want to tap into the CreateUserWizard workflow, which we can do by creating an event handler for the appropriate event.</span></span> <span data-ttu-id="36ec1-391">Per illustrare questo problema, è possibile migliorare il controllo `RegisterUser` CreateUserWizard per includere una convalida personalizzata sul nome utente e la password.</span><span class="sxs-lookup"><span data-stu-id="36ec1-391">To illustrate this, let's enhance the `RegisterUser` CreateUserWizard control to include some custom validation on the username and password.</span></span> <span data-ttu-id="36ec1-392">In particolare, viene migliorato il CreateUserWizard in modo che i nomi utente non possano contenere spazi iniziali o finali e il nome utente non può essere visualizzato in un punto qualsiasi della password.</span><span class="sxs-lookup"><span data-stu-id="36ec1-392">In particular, let's enhance our CreateUserWizard so that usernames cannot contain leading or trailing spaces and the username cannot appear anywhere in the password.</span></span> <span data-ttu-id="36ec1-393">In breve, si vuole impedire a un utente di creare un nome utente come "Scott" o avere una combinazione di nome utente/password, ad esempio "Scott" e "Scott. 1234".</span><span class="sxs-lookup"><span data-stu-id="36ec1-393">In short, we want to prevent someone from creating a username like "Scott ", or having a username/password combination like "Scott" and "Scott.1234".</span></span>

<span data-ttu-id="36ec1-394">A tale scopo, verrà creato un gestore eventi per l'evento `CreatingUser` per eseguire i controlli di convalida aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="36ec1-394">To accomplish this we will create an event handler for the `CreatingUser` event to perform our extra validation checks.</span></span> <span data-ttu-id="36ec1-395">Se i dati forniti non sono validi, è necessario annullare il processo di creazione.</span><span class="sxs-lookup"><span data-stu-id="36ec1-395">If the supplied data is not valid we need to cancel the creation process.</span></span> <span data-ttu-id="36ec1-396">Per visualizzare un messaggio che informa che il nome utente o la password non è valida, è inoltre necessario aggiungere un controllo Web Label alla pagina.</span><span class="sxs-lookup"><span data-stu-id="36ec1-396">We also need to add a Label Web control to the page to display a message explaining that the username or password is invalid.</span></span> <span data-ttu-id="36ec1-397">Per iniziare, aggiungere un controllo Label sotto il controllo CreateUserWizard, impostarne la proprietà `ID` su `InvalidUserNameOrPasswordMessage` e la relativa proprietà `ForeColor` su `Red`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-397">Start by adding a Label control beneath the CreateUserWizard control, setting its `ID` property to `InvalidUserNameOrPasswordMessage` and its `ForeColor` property to `Red`.</span></span> <span data-ttu-id="36ec1-398">Cancellare la proprietà `Text` e impostare le proprietà `EnableViewState` e `Visible` su false.</span><span class="sxs-lookup"><span data-stu-id="36ec1-398">Clear out its `Text` property and set its `EnableViewState` and `Visible` properties to False.</span></span>

[!code-aspx[Main](creating-user-accounts-cs/samples/sample7.aspx)]

<span data-ttu-id="36ec1-399">Successivamente, creare un gestore eventi per l'evento `CreatingUser` del controllo CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="36ec1-399">Next, create an event handler for the CreateUserWizard control's `CreatingUser` event.</span></span> <span data-ttu-id="36ec1-400">Per creare un gestore eventi, selezionare il controllo nella finestra di progettazione e quindi passare al Finestra Proprietà.</span><span class="sxs-lookup"><span data-stu-id="36ec1-400">To create an event handler, select the control in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="36ec1-401">Da qui, fare clic sull'icona del fulmine, quindi fare doppio clic sull'evento appropriato per creare il gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="36ec1-401">From there, click on the lightning bolt icon and then double-click the appropriate event to create the event handler.</span></span>

<span data-ttu-id="36ec1-402">Aggiungere il codice seguente al gestore eventi `CreatingUser` :</span><span class="sxs-lookup"><span data-stu-id="36ec1-402">Add the following code to the `CreatingUser` event handler:</span></span>

[!code-csharp[Main](creating-user-accounts-cs/samples/sample8.cs)]

<span data-ttu-id="36ec1-403">Si noti che il nome utente e la password immessi nel controllo CreateUserWizard sono disponibili rispettivamente tramite le proprietà [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx) e [`Password`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx).</span><span class="sxs-lookup"><span data-stu-id="36ec1-403">Note that the username and password entered into the CreateUserWizard control are available through its [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx), respectively.</span></span> <span data-ttu-id="36ec1-404">Queste proprietà vengono usate nel gestore eventi precedente per determinare se il nome utente specificato contiene spazi iniziali o finali e se il nome utente viene trovato all'interno della password.</span><span class="sxs-lookup"><span data-stu-id="36ec1-404">We use these properties in the above event handler to determine whether the supplied username contains leading or trailing spaces and whether the username is found within the password.</span></span> <span data-ttu-id="36ec1-405">Se viene soddisfatta una di queste condizioni, nell'etichetta `InvalidUserNameOrPasswordMessage` viene visualizzato un messaggio di errore e la proprietà `e.Cancel` del gestore eventi è impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-405">If either of these conditions is met, an error message is displayed in the `InvalidUserNameOrPasswordMessage` Label and the event handler's `e.Cancel` property is set to `true`.</span></span> <span data-ttu-id="36ec1-406">Se `e.Cancel` è impostato su `true`, l'oggetto CreateUserWizard consente di eseguire il cortocircuito del flusso di lavoro, annullando il processo di creazione dell'account utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-406">If `e.Cancel` is set to `true`, the CreateUserWizard short-circuits its workflow, effectively cancelling the user account creation process.</span></span>

<span data-ttu-id="36ec1-407">Nella figura 15 viene illustrata una schermata di `CreatingUserAccounts.aspx` quando l'utente immette un nome utente con spazi iniziali.</span><span class="sxs-lookup"><span data-stu-id="36ec1-407">Figure 15 shows a screen shot of `CreatingUserAccounts.aspx` when the user enters a username with leading spaces.</span></span>

<span data-ttu-id="36ec1-408">[![nomi utente con spazi iniziali o finali non sono consentiti](creating-user-accounts-cs/_static/image44.png)](creating-user-accounts-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="36ec1-408">[![Usernames with Leading or Trailing Spaces are not Permitted](creating-user-accounts-cs/_static/image44.png)](creating-user-accounts-cs/_static/image43.png)</span></span>

<span data-ttu-id="36ec1-409">**Figura 15**: I nomi utente con spazi iniziali o finali non sono consentiti ([fare clic per visualizzare l'immagine con dimensioni complete](creating-user-accounts-cs/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="36ec1-409">**Figure 15**: Usernames with Leading or Trailing Spaces are not Permitted  ([Click to view full-size image](creating-user-accounts-cs/_static/image45.png))</span></span>

> [!NOTE]
> <span data-ttu-id="36ec1-410">Viene visualizzato un esempio di utilizzo del controllo dell'evento CreateUserWizard `CreatedUser` nell'esercitazione relativa all' *<a id="_msoanchor_11"></a>[archiviazione di informazioni aggiuntive sull'utente](storing-additional-user-information-cs.md)* .</span><span class="sxs-lookup"><span data-stu-id="36ec1-410">We will see an example of using the CreateUserWizard control's `CreatedUser` event in the *<a id="_msoanchor_11"></a>[Storing Additional User Information](storing-additional-user-information-cs.md)* tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="36ec1-411">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="36ec1-411">Summary</span></span>

<span data-ttu-id="36ec1-412">Il metodo `CreateUser` della classe `Membership` crea un nuovo account utente nel framework delle appartenenze.</span><span class="sxs-lookup"><span data-stu-id="36ec1-412">The `Membership` class's `CreateUser` method creates a new user account in the Membership framework.</span></span> <span data-ttu-id="36ec1-413">Questa operazione viene eseguita delegando la chiamata al provider di appartenenze configurato.</span><span class="sxs-lookup"><span data-stu-id="36ec1-413">It does so by delegating the call to the configured Membership provider.</span></span> <span data-ttu-id="36ec1-414">Nel caso del `SqlMembershipProvider`, il metodo `CreateUser` aggiunge un record alle tabelle del database `aspnet_Users` e `aspnet_Membership`.</span><span class="sxs-lookup"><span data-stu-id="36ec1-414">In the case of the `SqlMembershipProvider`, the `CreateUser` method adds a record to the `aspnet_Users` and `aspnet_Membership` database tables.</span></span>

<span data-ttu-id="36ec1-415">Sebbene sia possibile creare nuovi account utente a livello di codice, come illustrato nel passaggio 5, un approccio più rapido e semplice consiste nell'usare il controllo CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="36ec1-415">While new user accounts can be created programmatically (as we saw in Step 5), a faster and easier approach is to use the CreateUserWizard control.</span></span> <span data-ttu-id="36ec1-416">Questo controllo esegue il rendering di un'interfaccia utente in più passaggi per la raccolta di informazioni utente e la creazione di un nuovo utente nel framework delle appartenenze.</span><span class="sxs-lookup"><span data-stu-id="36ec1-416">This control renders a multi-step user interface for collecting user information and creating a new user in the Membership framework.</span></span> <span data-ttu-id="36ec1-417">Dietro le quinte, questo controllo Usa lo stesso metodo di `Membership.CreateUser` esaminato nel passaggio 5, ma il controllo crea l'interfaccia utente, i controlli di convalida e risponde agli errori di creazione dell'account utente senza dover scrivere una leccata di codice.</span><span class="sxs-lookup"><span data-stu-id="36ec1-417">Underneath the covers, this control uses the same `Membership.CreateUser` method as examined in Step 5, but the control creates the user interface, validation controls, and responds to user account creation errors without having to write a lick of code.</span></span>

<span data-ttu-id="36ec1-418">A questo punto sono disponibili le funzionalità per la creazione di nuovi account utente.</span><span class="sxs-lookup"><span data-stu-id="36ec1-418">At this point we have the functionality in place to create new user accounts.</span></span> <span data-ttu-id="36ec1-419">Tuttavia, la pagina di accesso viene comunque convalidata in base a quelle hardcoded specificate nella seconda esercitazione.</span><span class="sxs-lookup"><span data-stu-id="36ec1-419">However, the login page still is validating against those hard-coded credentials we specified back in the second tutorial.</span></span> <span data-ttu-id="36ec1-420"><a id="_msoanchor_12"> </a>Nell' [esercitazione successiva](validating-user-credentials-against-the-membership-user-store-cs.md) verrà aggiornata `Login.aspx` per convalidare le credenziali fornite dall'utente rispetto al framework delle appartenenze.</span><span class="sxs-lookup"><span data-stu-id="36ec1-420">In the <a id="_msoanchor_12"></a>[next tutorial](validating-user-credentials-against-the-membership-user-store-cs.md) we will update `Login.aspx` to validate the user's supplied credentials against the Membership framework.</span></span>

<span data-ttu-id="36ec1-421">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="36ec1-421">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="36ec1-422">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="36ec1-422">Further Reading</span></span>

<span data-ttu-id="36ec1-423">Per ulteriori informazioni sugli argomenti trattati in questa esercitazione, fare riferimento alle risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="36ec1-423">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="36ec1-424">Documentazione tecnica di `CreateUser`</span><span class="sxs-lookup"><span data-stu-id="36ec1-424">`CreateUser` Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.security.membershipprovider.createuser.aspx)
- [<span data-ttu-id="36ec1-425">Cenni preliminari sul controllo CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="36ec1-425">CreateUserWizard Control Overview</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx)
- [<span data-ttu-id="36ec1-426">Creazione di un provider della mappa del sito basato su file System</span><span class="sxs-lookup"><span data-stu-id="36ec1-426">Creating a File System-Based Site Map Provider</span></span>](http://aspnet.4guysfromrolla.com/articles/020106-1.aspx)
- [<span data-ttu-id="36ec1-427">Creazione di un'interfaccia utente dettagliata con il controllo procedura guidata ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="36ec1-427">Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)
- [<span data-ttu-id="36ec1-428">Esame della navigazione nel sito di ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="36ec1-428">Examining ASP.NET 2.0's Site Navigation</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [<span data-ttu-id="36ec1-429">Pagine master e spostamento nel sito</span><span class="sxs-lookup"><span data-stu-id="36ec1-429">Master Pages and Site Navigation</span></span>](https://asp.net/learn/data-access/tutorial-03-vb.aspx)
- [<span data-ttu-id="36ec1-430">Provider della mappa del sito SQL in attesa</span><span class="sxs-lookup"><span data-stu-id="36ec1-430">The SQL Site Map Provider You've Been Waiting For</span></span>](https://msdn.microsoft.com/msdnmag/issues/06/02/WickedCode/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="36ec1-431">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="36ec1-431">About the Author</span></span>

<span data-ttu-id="36ec1-432">Scott Mitchell, autore di più libri ASP/ASP. NET e fondatore di 4GuysFromRolla.com, collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="36ec1-432">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="36ec1-433">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="36ec1-433">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="36ec1-434">Il suo ultimo libro è *[Sams Teach Yourself ASP.NET 2,0 in 24 ore](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="36ec1-434">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="36ec1-435">Scott può essere raggiunto in [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) o tramite il suo blog al [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="36ec1-435">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="36ec1-436">Ringraziamento speciale a...</span><span class="sxs-lookup"><span data-stu-id="36ec1-436">Special Thanks To…</span></span>

<span data-ttu-id="36ec1-437">Questa serie di esercitazioni è stata esaminata da molti revisori utili.</span><span class="sxs-lookup"><span data-stu-id="36ec1-437">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="36ec1-438">Il revisore principale di questa esercitazione era Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="36ec1-438">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="36ec1-439">Sei interessato a esaminare i miei prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="36ec1-439">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="36ec1-440">In tal caso, rilasciare una riga in [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="36ec1-440">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="36ec1-441">[Precedente](creating-the-membership-schema-in-sql-server-cs.md)
> [Successivo](validating-user-credentials-against-the-membership-user-store-cs.md)</span><span class="sxs-lookup"><span data-stu-id="36ec1-441">[Previous](creating-the-membership-schema-in-sql-server-cs.md)
[Next](validating-user-credentials-against-the-membership-user-store-cs.md)</span></span>
