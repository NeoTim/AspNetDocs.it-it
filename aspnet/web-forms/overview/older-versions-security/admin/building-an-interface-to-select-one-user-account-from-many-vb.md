---
uid: web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
title: Compilazione di un'interfaccia per la selezione di un account utente da molti (VB) | Microsoft Docs
author: rick-anderson
description: In questa esercitazione verrà compilata un'interfaccia utente con una griglia filtrabile di paging. In particolare, l'interfaccia utente è costituita da una serie di LinkButton per...
ms.author: riande
ms.date: 04/01/2008
ms.assetid: da53380c-a16b-41c7-a20d-24343c735c52
msc.legacyurl: /web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
msc.type: authoredcontent
ms.openlocfilehash: 6c711cdaab113d589d9c2535cb1b422de3f38103
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/28/2019
ms.locfileid: "74614810"
---
# <a name="building-an-interface-to-select-one-user-account-from-many-vb"></a><span data-ttu-id="60596-104">Creazione di un'interfaccia per la selezione di un account utente tra diversi account (VB)</span><span class="sxs-lookup"><span data-stu-id="60596-104">Building an Interface to Select One User Account from Many (VB)</span></span>

<span data-ttu-id="60596-105">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="60596-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="60596-106">[Scarica codice](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.12.zip) o [Scarica PDF](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="60596-106">[Download Code](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.12.zip) or [Download PDF](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_vb.pdf)</span></span>

> <span data-ttu-id="60596-107">In questa esercitazione verrà compilata un'interfaccia utente con una griglia filtrabile di paging.</span><span class="sxs-lookup"><span data-stu-id="60596-107">In this tutorial we will build a user interface with a paged, filterable grid.</span></span> <span data-ttu-id="60596-108">In particolare, l'interfaccia utente sarà costituita da una serie di LinkButton per filtrare i risultati in base alla lettera iniziale del nome utente e da un controllo GridView per visualizzare gli utenti corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="60596-108">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="60596-109">Si inizierà elencando tutti gli account utente in un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="60596-109">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="60596-110">Quindi, nel passaggio 3, si aggiungeranno gli LinkButton del filtro.</span><span class="sxs-lookup"><span data-stu-id="60596-110">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="60596-111">Il passaggio 4 esamina il paging dei risultati filtrati.</span><span class="sxs-lookup"><span data-stu-id="60596-111">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="60596-112">L'interfaccia costruita nei passaggi da 2 a 4 verrà usata nelle esercitazioni successive per eseguire attività amministrative per un determinato account utente.</span><span class="sxs-lookup"><span data-stu-id="60596-112">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

## <a name="introduction"></a><span data-ttu-id="60596-113">Introduzione</span><span class="sxs-lookup"><span data-stu-id="60596-113">Introduction</span></span>

<span data-ttu-id="60596-114">Nell'esercitazione <a id="_msoanchor_1"> </a> [*assegnazione dei ruoli agli utenti*](../roles/assigning-roles-to-users-vb.md) è stata creata un'interfaccia rudimentale che consente a un amministratore di selezionare un utente e gestirne i ruoli.</span><span class="sxs-lookup"><span data-stu-id="60596-114">In the <a id="_msoanchor_1"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-vb.md) tutorial, we created a rudimentary interface for an administrator to select a user and manage her roles.</span></span> <span data-ttu-id="60596-115">In particolare, l'interfaccia ha presentato all'amministratore un elenco a discesa di tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="60596-115">Specifically, the interface presented the administrator with a drop-down list of all of the users.</span></span> <span data-ttu-id="60596-116">Un'interfaccia di questo tipo è utile quando sono presenti, a sua volta, un account utente, ma è difficile per i siti con centinaia o migliaia di account.</span><span class="sxs-lookup"><span data-stu-id="60596-116">Such an interface is suitable when there are but a dozen or so user accounts, but is unwieldy for sites with hundreds or thousands of accounts.</span></span> <span data-ttu-id="60596-117">Una griglia filtrabile di paging è un'interfaccia utente più adatta per i siti Web con basi utente di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="60596-117">A paged, filterable grid is more suitable user interface for websites with large user bases.</span></span>

<span data-ttu-id="60596-118">In questa esercitazione verrà compilata un'interfaccia utente di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="60596-118">In this tutorial we will build such a user interface.</span></span> <span data-ttu-id="60596-119">In particolare, l'interfaccia utente sarà costituita da una serie di LinkButton per filtrare i risultati in base alla lettera iniziale del nome utente e da un controllo GridView per visualizzare gli utenti corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="60596-119">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="60596-120">Si inizierà elencando tutti gli account utente in un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="60596-120">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="60596-121">Quindi, nel passaggio 3, si aggiungeranno gli LinkButton del filtro.</span><span class="sxs-lookup"><span data-stu-id="60596-121">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="60596-122">Il passaggio 4 esamina il paging dei risultati filtrati.</span><span class="sxs-lookup"><span data-stu-id="60596-122">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="60596-123">L'interfaccia costruita nei passaggi da 2 a 4 verrà usata nelle esercitazioni successive per eseguire attività amministrative per un determinato account utente.</span><span class="sxs-lookup"><span data-stu-id="60596-123">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

<span data-ttu-id="60596-124">Iniziamo!</span><span class="sxs-lookup"><span data-stu-id="60596-124">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="60596-125">Passaggio 1: aggiunta di nuove pagine di ASP.NET</span><span class="sxs-lookup"><span data-stu-id="60596-125">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="60596-126">In questa esercitazione e nei prossimi due verranno esaminate varie funzioni e funzionalità correlate all'amministrazione.</span><span class="sxs-lookup"><span data-stu-id="60596-126">In this tutorial and the next two we will be examining various administration-related functions and capabilities.</span></span> <span data-ttu-id="60596-127">Per implementare gli argomenti esaminati in queste esercitazioni, è necessaria una serie di pagine di ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="60596-127">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="60596-128">È ora di creare queste pagine e aggiornare la mappa del sito.</span><span class="sxs-lookup"><span data-stu-id="60596-128">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="60596-129">Per iniziare, creare una nuova cartella nel progetto denominata `Administration`.</span><span class="sxs-lookup"><span data-stu-id="60596-129">Start by creating a new folder in the project named `Administration`.</span></span> <span data-ttu-id="60596-130">Aggiungere quindi due nuove pagine di ASP.NET alla cartella, collegando ogni pagina alla pagina master `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="60596-130">Next, add two new ASP.NET pages to the folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="60596-131">Denominare le pagine:</span><span class="sxs-lookup"><span data-stu-id="60596-131">Name the pages:</span></span>

- `ManageUsers.aspx`
- `UserInformation.aspx`

<span data-ttu-id="60596-132">Aggiungere anche due pagine alla directory radice del sito Web: `ChangePassword.aspx` e `RecoverPassword.aspx`.</span><span class="sxs-lookup"><span data-stu-id="60596-132">Also add two pages to the website's root directory: `ChangePassword.aspx` and `RecoverPassword.aspx`.</span></span>

<span data-ttu-id="60596-133">A questo punto, queste quattro pagine hanno due controlli contenuto, uno per ogni ContentPlaceHolders della pagina master: `MainContent` e `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="60596-133">These four pages should, at this point, have two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample1.aspx)]

<span data-ttu-id="60596-134">Si desidera visualizzare il markup predefinito della pagina master per il `LoginContent` ContentPlaceHolder per queste pagine.</span><span class="sxs-lookup"><span data-stu-id="60596-134">We want to show the master page's default markup for the `LoginContent` ContentPlaceHolder for these pages.</span></span> <span data-ttu-id="60596-135">Rimuovere quindi il markup dichiarativo per il controllo contenuto `Content2`.</span><span class="sxs-lookup"><span data-stu-id="60596-135">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="60596-136">Al termine di questa operazione, il markup delle pagine deve contenere solo un controllo contenuto.</span><span class="sxs-lookup"><span data-stu-id="60596-136">After doing so, the pages' markup should contain just one Content control.</span></span>

<span data-ttu-id="60596-137">Le pagine ASP.NET della cartella `Administration` sono destinate esclusivamente agli utenti amministratori.</span><span class="sxs-lookup"><span data-stu-id="60596-137">The ASP.NET pages in the `Administration` folder are intended solely for administrative users.</span></span> <span data-ttu-id="60596-138">È stato aggiunto un ruolo di amministratore al sistema nell' <a id="_msoanchor_2"> </a>esercitazione [*creazione e gestione dei ruoli*](../roles/creating-and-managing-roles-vb.md) . consente di limitare l'accesso a queste due pagine a questo ruolo.</span><span class="sxs-lookup"><span data-stu-id="60596-138">We added an Administrators role to the system in the <a id="_msoanchor_2"></a>[*Creating and Managing Roles*](../roles/creating-and-managing-roles-vb.md) tutorial; restrict access to these two pages to this role.</span></span> <span data-ttu-id="60596-139">A tale scopo, aggiungere un file di `Web.config` alla cartella `Administration` e configurare il relativo elemento `<authorization>` per ammettere gli utenti nel ruolo Administrators e per negare tutti gli altri.</span><span class="sxs-lookup"><span data-stu-id="60596-139">To accomplish this, add a `Web.config` file to the `Administration` folder and configure its `<authorization>` element to admit users in the Administrators role and to deny all others.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample2.xml)]

<span data-ttu-id="60596-140">A questo punto la Esplora soluzioni del progetto dovrebbe essere simile a quella mostrata nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="60596-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>

<span data-ttu-id="60596-141">[![quattro nuove pagine e un file Web. config sono stati aggiunti al sito Web](building-an-interface-to-select-one-user-account-from-many-vb/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="60596-141">[![Four New Pages and a Web.config File Have Been Added to the Website](building-an-interface-to-select-one-user-account-from-many-vb/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image1.png)</span></span>

<span data-ttu-id="60596-142">**Figura 1**: sono state aggiunte quattro nuove pagine e un File di `Web.config` al sito Web ([fare clic per visualizzare l'immagine con dimensioni complete](building-an-interface-to-select-one-user-account-from-many-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="60596-142">**Figure 1**: Four New Pages and a `Web.config` File Have Been Added to the Website ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image3.png))</span></span>

<span data-ttu-id="60596-143">Infine, aggiornare la mappa del sito (`Web.sitemap`) per includere una voce nella pagina `ManageUsers.aspx`.</span><span class="sxs-lookup"><span data-stu-id="60596-143">Finally, update the site map (`Web.sitemap`) to include an entry to the `ManageUsers.aspx` page.</span></span> <span data-ttu-id="60596-144">Aggiungere il codice XML seguente dopo il `<siteMapNode>` aggiunto per le esercitazioni sui ruoli.</span><span class="sxs-lookup"><span data-stu-id="60596-144">Add the following XML after the `<siteMapNode>` we added for the Roles tutorials.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample3.xml)]

<span data-ttu-id="60596-145">Con la mappa del sito aggiornata, visitare il sito tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="60596-145">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="60596-146">Come illustrato nella figura 2, la navigazione a sinistra include ora gli elementi per le esercitazioni sull'amministrazione.</span><span class="sxs-lookup"><span data-stu-id="60596-146">As Figure 2 shows, the navigation on the left now includes items for the Administration tutorials.</span></span>

<span data-ttu-id="60596-147">[![la mappa del sito include un nodo denominato amministrazione utenti](building-an-interface-to-select-one-user-account-from-many-vb/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="60596-147">[![The Site Map Includes a Node Titled User Administration](building-an-interface-to-select-one-user-account-from-many-vb/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image4.png)</span></span>

<span data-ttu-id="60596-148">**Figura 2**: la mappa del sito include un nodo denominato amministrazione utenti ([fare clic per visualizzare l'immagine con dimensioni complete](building-an-interface-to-select-one-user-account-from-many-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="60596-148">**Figure 2**: The Site Map Includes a Node Titled User Administration ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image6.png))</span></span>

## <a name="step-2-listing-all-user-accounts-in-a-gridview"></a><span data-ttu-id="60596-149">Passaggio 2: elenco di tutti gli account utente in un controllo GridView</span><span class="sxs-lookup"><span data-stu-id="60596-149">Step 2: Listing All User Accounts in a GridView</span></span>

<span data-ttu-id="60596-150">L'obiettivo finale di questa esercitazione è creare una griglia filtrabile di paging tramite la quale un amministratore può selezionare un account utente da gestire.</span><span class="sxs-lookup"><span data-stu-id="60596-150">Our end goal for this tutorial is to create a paged, filterable grid through which an administrator can select a user account to manage.</span></span> <span data-ttu-id="60596-151">Per iniziare, elencare *tutti* gli utenti in GridView.</span><span class="sxs-lookup"><span data-stu-id="60596-151">Let's start by listing *all* users in a GridView.</span></span> <span data-ttu-id="60596-152">Una volta completata questa operazione, si aggiungeranno le interfacce e le funzionalità di filtro e paging.</span><span class="sxs-lookup"><span data-stu-id="60596-152">Once this is complete, we will add the filtering and paging interfaces and functionality.</span></span>

<span data-ttu-id="60596-153">Aprire la pagina `ManageUsers.aspx` nella cartella `Administration` e aggiungere un controllo GridView, impostando il `ID` su `UserAccounts` in un attimo, si scriverà il codice per associare il set di account utente a GridView usando il metodo `Membership` della classe `GetAllUsers`.</span><span class="sxs-lookup"><span data-stu-id="60596-153">Open the `ManageUsers.aspx` page in the `Administration` folder and add a GridView, setting its `ID` to `UserAccounts` In a moment, we will write code to bind the set of user accounts to the GridView using the `Membership` class's `GetAllUsers` method.</span></span> <span data-ttu-id="60596-154">Come illustrato nelle esercitazioni precedenti, il metodo `GetAllUsers` restituisce un oggetto `MembershipUserCollection`, ovvero una raccolta di oggetti di `MembershipUser`.</span><span class="sxs-lookup"><span data-stu-id="60596-154">As discussed in earlier tutorials, the `GetAllUsers` method returns a `MembershipUserCollection` object, which is a collection of `MembershipUser` objects.</span></span> <span data-ttu-id="60596-155">Ogni `MembershipUser` della raccolta include proprietà quali `UserName`, `Email`, `IsApproved`e così via.</span><span class="sxs-lookup"><span data-stu-id="60596-155">Each `MembershipUser` in the collection includes properties like `UserName`, `Email`, `IsApproved`, and so on.</span></span>

<span data-ttu-id="60596-156">Per visualizzare le informazioni sull'account utente desiderate in GridView, impostare la proprietà `AutoGenerateColumns` di GridView su false e aggiungere BoundField per le proprietà `UserName`, `Email`e `Comment` e CheckBoxFields per le proprietà `IsApproved`, `IsLockedOut`e `IsOnline`.</span><span class="sxs-lookup"><span data-stu-id="60596-156">In order to display the desired user account information in the GridView, set the GridView's `AutoGenerateColumns` property to False and add BoundFields for the `UserName`, `Email`, and `Comment` properties and CheckBoxFields for the `IsApproved`, `IsLockedOut`, and `IsOnline` properties.</span></span> <span data-ttu-id="60596-157">Questa configurazione può essere applicata tramite il markup dichiarativo del controllo o tramite la finestra di dialogo campi.</span><span class="sxs-lookup"><span data-stu-id="60596-157">This configuration can be applied through the control's declarative markup or via the Fields dialog box.</span></span> <span data-ttu-id="60596-158">Nella figura 3 viene illustrata una schermata della finestra di dialogo campi dopo che la casella di controllo genera automaticamente campi è stata deselezionata e i BoundField e CheckBoxFields sono stati aggiunti e configurati.</span><span class="sxs-lookup"><span data-stu-id="60596-158">Figure 3 shows a screen shot of the Fields dialog box after the Auto-generate fields checkbox has been unchecked and the BoundFields and CheckBoxFields have been added and configured.</span></span>

<span data-ttu-id="60596-159">[![aggiungere tre BoundField e tre CheckBoxFields al GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="60596-159">[![Add Three BoundFields and Three CheckBoxFields to the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image7.png)</span></span>

<span data-ttu-id="60596-160">**Figura 3**: aggiungere tre BoundField e tre CheckBoxFields al GridView ([fare clic per visualizzare l'immagine con dimensioni complete](building-an-interface-to-select-one-user-account-from-many-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="60596-160">**Figure 3**: Add Three BoundFields and Three CheckBoxFields to the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image9.png))</span></span>

<span data-ttu-id="60596-161">Dopo aver configurato GridView, verificare che il markup dichiarativo sia simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="60596-161">After configuring your GridView, ensure that its declarative markup resembles the following:</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample4.aspx)]

<span data-ttu-id="60596-162">Successivamente, è necessario scrivere il codice che associa gli account utente a GridView.</span><span class="sxs-lookup"><span data-stu-id="60596-162">Next, we need to write code that binds the user accounts to the GridView.</span></span> <span data-ttu-id="60596-163">Creare un metodo denominato `BindUserAccounts` per eseguire questa attività e quindi chiamarlo dal gestore dell'evento `Page_Load` nella prima pagina visita.</span><span class="sxs-lookup"><span data-stu-id="60596-163">Create a method named `BindUserAccounts` to perform this task and then call it from the `Page_Load` event handler on the first page visit.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample5.vb)]

<span data-ttu-id="60596-164">È possibile eseguire il test della pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="60596-164">Take a moment to test the page through a browser.</span></span> <span data-ttu-id="60596-165">Come illustrato nella figura 4, il `UserAccounts` GridView elenca il nome utente, l'indirizzo di posta elettronica e altre informazioni sull'account pertinente per tutti gli utenti del sistema.</span><span class="sxs-lookup"><span data-stu-id="60596-165">As Figure 4 shows, the `UserAccounts` GridView lists the username, email address, and other pertinent account information for all users in the system.</span></span>

<span data-ttu-id="60596-166">[![gli account utente sono elencati in GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="60596-166">[![The User Accounts are Listed in the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image10.png)</span></span>

<span data-ttu-id="60596-167">**Figura 4**: gli account utente sono elencati in GridView ([fare clic per visualizzare l'immagine con dimensioni complete](building-an-interface-to-select-one-user-account-from-many-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="60596-167">**Figure 4**: The User Accounts are Listed in the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image12.png))</span></span>

## <a name="step-3-filtering-the-results-by-the-first-letter-of-the-username"></a><span data-ttu-id="60596-168">Passaggio 3: filtrare i risultati in base alla prima lettera del nome utente</span><span class="sxs-lookup"><span data-stu-id="60596-168">Step 3: Filtering the Results by the First Letter of the Username</span></span>

<span data-ttu-id="60596-169">Attualmente il `UserAccounts` GridView Mostra *tutti* gli account utente.</span><span class="sxs-lookup"><span data-stu-id="60596-169">Currently the `UserAccounts` GridView shows *all* of the user accounts.</span></span> <span data-ttu-id="60596-170">Per i siti Web con centinaia o migliaia di account utente, è essenziale che l'utente sia in grado di ridurre rapidamente gli account visualizzati.</span><span class="sxs-lookup"><span data-stu-id="60596-170">For websites with hundreds or thousands of user accounts, it is imperative that user be able to quickly pare down the displayed accounts.</span></span> <span data-ttu-id="60596-171">Questa operazione può essere eseguita aggiungendo filtri LinkButton alla pagina.</span><span class="sxs-lookup"><span data-stu-id="60596-171">This can be accomplished by adding filtering LinkButtons to the page.</span></span> <span data-ttu-id="60596-172">Si aggiungono 27 LinkButton alla pagina: uno denominato tutti insieme a un LinkButton per ogni lettera dell'alfabeto.</span><span class="sxs-lookup"><span data-stu-id="60596-172">Let's add 27 LinkButtons to the page: one titled All along with one LinkButton for each letter of the alphabet.</span></span> <span data-ttu-id="60596-173">Se un visitatore fa clic su tutti gli LinkButton, GridView visualizzerà tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="60596-173">If a visitor clicks the All LinkButton, the GridView will show all of the users.</span></span> <span data-ttu-id="60596-174">Se si fa clic su una determinata lettera, verranno visualizzati solo gli utenti il cui nome utente inizia con la lettera selezionata.</span><span class="sxs-lookup"><span data-stu-id="60596-174">If they click a particular letter, only those users whose username starts with the selected letter will be displayed.</span></span>

<span data-ttu-id="60596-175">La prima attività consiste nell'aggiungere i 27 controlli LinkButton.</span><span class="sxs-lookup"><span data-stu-id="60596-175">Our first task is to add the 27 LinkButton controls.</span></span> <span data-ttu-id="60596-176">Un'opzione consiste nel creare i 27 LinkButton in modo dichiarativo, uno alla volta.</span><span class="sxs-lookup"><span data-stu-id="60596-176">One option would be to create the 27 LinkButtons declaratively, one at a time.</span></span> <span data-ttu-id="60596-177">Un approccio più flessibile consiste nell'utilizzare un controllo Repeater con un `ItemTemplate` che esegue il rendering di un LinkButton e quindi associa le opzioni di filtro al Repeater come matrice di `String`.</span><span class="sxs-lookup"><span data-stu-id="60596-177">A more flexible approach is to use a Repeater control with an `ItemTemplate` that renders a LinkButton and then binds the filtering options to the Repeater as a `String` array.</span></span>

<span data-ttu-id="60596-178">Per iniziare, aggiungere un controllo Repeater alla pagina sopra il `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="60596-178">Start by adding a Repeater control to the page above the `UserAccounts` GridView.</span></span> <span data-ttu-id="60596-179">Impostare la proprietà `ID` del Repeater su `FilteringUI` configurare i modelli del Repeater in modo che il relativo `ItemTemplate` esegua il rendering di un LinkButton le cui proprietà `Text` e `CommandName` sono associate all'elemento di matrice corrente.</span><span class="sxs-lookup"><span data-stu-id="60596-179">Set the Repeater's `ID` property to `FilteringUI` Configure the Repeater's templates so that its `ItemTemplate` renders a LinkButton whose `Text` and `CommandName` properties are bound to the current array element.</span></span> <span data-ttu-id="60596-180">Come illustrato nell'esercitazione <a id="_msoanchor_3"> </a> [*assegnazione dei ruoli agli utenti*](../roles/assigning-roles-to-users-vb.md) , questa operazione può essere eseguita usando la sintassi di associazione dati `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="60596-180">As we saw in the <a id="_msoanchor_3"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-vb.md) tutorial, this can be accomplished using the `Container.DataItem` databinding syntax.</span></span> <span data-ttu-id="60596-181">Utilizzare la `SeparatorTemplate` del Repeater per visualizzare una linea verticale tra ogni collegamento.</span><span class="sxs-lookup"><span data-stu-id="60596-181">Use the Repeater's `SeparatorTemplate` to display a vertical line between each link.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample6.aspx)]

<span data-ttu-id="60596-182">Per popolare questo Repeater con le opzioni di filtro desiderate, creare un metodo denominato `BindFilteringUI`.</span><span class="sxs-lookup"><span data-stu-id="60596-182">To populate this Repeater with the desired filtering options, create a method named `BindFilteringUI`.</span></span> <span data-ttu-id="60596-183">Assicurarsi di chiamare questo metodo dal gestore eventi `Page_Load` al primo caricamento della pagina.</span><span class="sxs-lookup"><span data-stu-id="60596-183">Be sure to call this method from the `Page_Load` event handler on the first page load.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample7.vb)]

<span data-ttu-id="60596-184">Questo metodo specifica le opzioni di filtro come elementi nella matrice di `String` `filterOptions` per ogni elemento nella matrice, il ripetitore eseguirà il rendering di un LinkButton con la relativa `Text` e `CommandName` le proprietà assegnate al valore dell'elemento della matrice.</span><span class="sxs-lookup"><span data-stu-id="60596-184">This method specifies the filtering options as elements in the `String` array `filterOptions` For each element in the array, the Repeater will render a LinkButton with its `Text` and `CommandName` properties assigned to the value of the array element.</span></span>

<span data-ttu-id="60596-185">Nella figura 5 viene illustrata la pagina `ManageUsers.aspx` se visualizzata tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="60596-185">Figure 5 shows the `ManageUsers.aspx` page when viewed through a browser.</span></span>

<span data-ttu-id="60596-186">[![il Repeater elenca 27 i filtri LinkButton](building-an-interface-to-select-one-user-account-from-many-vb/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="60596-186">[![The Repeater Lists 27 Filtering LinkButtons](building-an-interface-to-select-one-user-account-from-many-vb/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image13.png)</span></span>

<span data-ttu-id="60596-187">**Figura 5**: il Repeater elenca 27 controlli LinkButton di filtro ([fare clic per visualizzare l'immagine con dimensioni complete](building-an-interface-to-select-one-user-account-from-many-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="60596-187">**Figure 5**: The Repeater Lists 27 Filtering LinkButtons ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image15.png))</span></span>

> [!NOTE]
> <span data-ttu-id="60596-188">I nomi utente possono iniziare con qualsiasi carattere, inclusi i numeri e la punteggiatura.</span><span class="sxs-lookup"><span data-stu-id="60596-188">Usernames may start with any character, including numbers and punctuation.</span></span> <span data-ttu-id="60596-189">Per visualizzare questi account, l'amministratore dovrà utilizzare l'opzione all LinkButton.</span><span class="sxs-lookup"><span data-stu-id="60596-189">In order to view these accounts, the administrator will have to use the All LinkButton option.</span></span> <span data-ttu-id="60596-190">In alternativa, è possibile aggiungere un LinkButton per restituire tutti gli account utente che iniziano con un numero.</span><span class="sxs-lookup"><span data-stu-id="60596-190">Alternatively, you could add a LinkButton to return all user accounts that start with a number.</span></span> <span data-ttu-id="60596-191">Lo lascio come esercizio per il lettore.</span><span class="sxs-lookup"><span data-stu-id="60596-191">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="60596-192">Se si fa clic su uno degli LinkButton di filtro, viene generato un postback e viene generato l'evento `ItemCommand` del ripetitore, ma non viene apportata alcuna modifica alla griglia perché è ancora necessario scrivere il codice per filtrare i risultati.</span><span class="sxs-lookup"><span data-stu-id="60596-192">Clicking any of the filtering LinkButtons causes a postback and raises the Repeater's `ItemCommand` event, but there's no change in the grid because we've yet to write any code to filter the results.</span></span> <span data-ttu-id="60596-193">La classe `Membership` include un [metodo`FindUsersByName`](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) che restituisce gli account utente il cui nome utente corrisponde a un criterio di ricerca specificato.</span><span class="sxs-lookup"><span data-stu-id="60596-193">The `Membership` class includes a [`FindUsersByName` method](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) that returns those user accounts whose username matches a specified search pattern.</span></span> <span data-ttu-id="60596-194">È possibile utilizzare questo metodo per recuperare solo gli account utente i cui nomi utente iniziano con la lettera specificata dal `CommandName` del LinkButton filtrato selezionato.</span><span class="sxs-lookup"><span data-stu-id="60596-194">We can use this method to retrieve just those user accounts whose usernames start with the letter specified by the `CommandName` of the filtered LinkButton that was clicked.</span></span>

<span data-ttu-id="60596-195">Per iniziare, aggiornare la classe code-behind della pagina `ManageUser.aspx` in modo che includa una proprietà denominata `UsernameToMatch` questa proprietà mantiene la stringa del filtro nome utente nei postback:</span><span class="sxs-lookup"><span data-stu-id="60596-195">Start by updating the `ManageUser.aspx` page's code-behind class so that it includes a property named `UsernameToMatch` This property persists the username filter string across postbacks:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample8.vb)]

<span data-ttu-id="60596-196">La proprietà `UsernameToMatch` archivia il valore che viene assegnato alla raccolta `ViewState` usando il valore UsernameToMatch della chiave.</span><span class="sxs-lookup"><span data-stu-id="60596-196">The `UsernameToMatch` property stores its value it is assigned into the `ViewState` collection using the key �UsernameToMatch�.</span></span> <span data-ttu-id="60596-197">Quando il valore di questa proprietà viene letto, verifica se esiste un valore nella raccolta `ViewState`; in caso contrario, restituisce il valore predefinito, una stringa vuota.</span><span class="sxs-lookup"><span data-stu-id="60596-197">When this property's value is read, it checks to see if a value exists in the `ViewState` collection; if not, it returns the default value, an empty string.</span></span> <span data-ttu-id="60596-198">La proprietà `UsernameToMatch` presenta un modello comune, ovvero rende permanente un valore per visualizzare lo stato in modo che tutte le modifiche apportate alla proprietà vengano mantenute tra i postback.</span><span class="sxs-lookup"><span data-stu-id="60596-198">The `UsernameToMatch` property exhibits a common pattern, namely persisting a value to view state so that any changes to the property are persisted across postbacks.</span></span> <span data-ttu-id="60596-199">Per ulteriori informazioni su questo modello, vedere [informazioni sullo stato di visualizzazione ASP.NET](https://msdn.microsoftn-us/library/ms972976.aspx).</span><span class="sxs-lookup"><span data-stu-id="60596-199">For more information on this pattern, read [Understanding ASP.NET View State](https://msdn.microsoftn-us/library/ms972976.aspx).</span></span>

<span data-ttu-id="60596-200">Aggiornare quindi il metodo `BindUserAccounts` in modo che, invece di chiamare `Membership.GetAllUsers`, chiami `Membership.FindUsersByName`, passando il valore della proprietà `UsernameToMatch` accodato con il carattere jolly SQL%.</span><span class="sxs-lookup"><span data-stu-id="60596-200">Next, update the `BindUserAccounts` method so that instead of calling `Membership.GetAllUsers`, it calls `Membership.FindUsersByName`, passing in the value of the `UsernameToMatch` property appended with the SQL wildcard character, %.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample9.vb)]

<span data-ttu-id="60596-201">Per visualizzare solo gli utenti il cui nome utente inizia con la lettera A, impostare la proprietà `UsernameToMatch` su un oggetto e quindi chiamare `BindUserAccounts` questa operazione provocherebbe una chiamata a `Membership.FindUsersByName("A%")`, che restituirà tutti gli utenti il cui nome utente inizia con. Analogamente, per restituire *tutti* gli utenti, assegnare una stringa vuota alla proprietà `UsernameToMatch` in modo che il metodo `BindUserAccounts` richiami `Membership.FindUsersByName("%")`, restituendo tutti gli account utente</span><span class="sxs-lookup"><span data-stu-id="60596-201">To display just those users whose username starts with the letter A, set the `UsernameToMatch` property to A and then call `BindUserAccounts` This would result in a call to `Membership.FindUsersByName("A%")`, which will return all users whose username starts with A. Likewise, to return *all* users, assign an empty string to the `UsernameToMatch` property so that the `BindUserAccounts` method will invoke `Membership.FindUsersByName("%")`, thereby returning all user accounts.</span></span>

<span data-ttu-id="60596-202">Creare un gestore eventi per l'evento `ItemCommand` del ripetitore.</span><span class="sxs-lookup"><span data-stu-id="60596-202">Create an event handler for the Repeater's `ItemCommand` event.</span></span> <span data-ttu-id="60596-203">Questo evento viene generato ogni volta che si fa clic su uno degli LinkButton di filtro; viene passato il valore `CommandName` di LinkButton selezionato tramite l'oggetto `RepeaterCommandEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="60596-203">This event is raised whenever one of the filter LinkButtons is clicked; it is passed the clicked LinkButton's `CommandName` value through the `RepeaterCommandEventArgs` object.</span></span> <span data-ttu-id="60596-204">È necessario assegnare il valore appropriato alla proprietà `UsernameToMatch` e quindi chiamare il metodo `BindUserAccounts`.</span><span class="sxs-lookup"><span data-stu-id="60596-204">We need to assign the appropriate value to the `UsernameToMatch` property and then call the `BindUserAccounts` method.</span></span> <span data-ttu-id="60596-205">Se il `CommandName` è all, assegnare una stringa vuota a `UsernameToMatch` in modo che tutti gli account utente vengano visualizzati.</span><span class="sxs-lookup"><span data-stu-id="60596-205">If the `CommandName` is All, assign an empty string to `UsernameToMatch` so that all user accounts are displayed.</span></span> <span data-ttu-id="60596-206">In caso contrario, assegnare il valore `CommandName` a `UsernameToMatch`</span><span class="sxs-lookup"><span data-stu-id="60596-206">Otherwise, assign the `CommandName` value to `UsernameToMatch`</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample10.vb)]

<span data-ttu-id="60596-207">Con questo codice, testare la funzionalità di filtro.</span><span class="sxs-lookup"><span data-stu-id="60596-207">With this code in place, test out the filtering functionality.</span></span> <span data-ttu-id="60596-208">Quando la pagina viene visitata per la prima volta, vengono visualizzati tutti gli account utente (fare riferimento alla figura 5).</span><span class="sxs-lookup"><span data-stu-id="60596-208">When the page is first visited, all user accounts are displayed (refer back to Figure 5).</span></span> <span data-ttu-id="60596-209">Se si fa clic su un LinkButton, viene visualizzato un postback e i risultati vengono filtrati, visualizzando solo gli account utente che iniziano con.</span><span class="sxs-lookup"><span data-stu-id="60596-209">Clicking the A LinkButton causes a postback and filters the results, displaying only those user accounts that start with A .</span></span>

<span data-ttu-id="60596-210">[![utilizzare gli LinkButton di filtro per visualizzare gli utenti il cui nome utente inizia con una determinata lettera](building-an-interface-to-select-one-user-account-from-many-vb/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="60596-210">[![Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter](building-an-interface-to-select-one-user-account-from-many-vb/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image16.png)</span></span>

<span data-ttu-id="60596-211">**Figura 6**: usare gli LinkButton di filtro per visualizzare gli utenti il cui nome utente inizia con una determinata lettera ([fare clic per visualizzare l'immagine con dimensioni complete](building-an-interface-to-select-one-user-account-from-many-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="60596-211">**Figure 6**: Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image18.png))</span></span>

## <a name="step-4-updating-the-gridview-to-use-paging"></a><span data-ttu-id="60596-212">Passaggio 4: aggiornamento di GridView per l'uso del paging</span><span class="sxs-lookup"><span data-stu-id="60596-212">Step 4: Updating the GridView to Use Paging</span></span>

<span data-ttu-id="60596-213">Il controllo GridView illustrato nelle figure 5 e 6 elenca tutti i record restituiti dal metodo `FindUsersByName`.</span><span class="sxs-lookup"><span data-stu-id="60596-213">The GridView shown in Figures 5 and 6 lists all of the records returned from the `FindUsersByName` method.</span></span> <span data-ttu-id="60596-214">Se sono presenti centinaia o migliaia di account utente, questo può comportare un sovraccarico di informazioni durante la visualizzazione di tutti gli account (come nel caso in cui si fa clic sul LinkButton tutti o quando inizialmente si visita la pagina).</span><span class="sxs-lookup"><span data-stu-id="60596-214">If there are hundreds or thousands of user accounts this can lead to information overload when viewing all of the accounts (as is the case when clicking the All LinkButton or when initially visiting the page).</span></span> <span data-ttu-id="60596-215">Per aiutare a presentare gli account utente in blocchi più gestibili, configurare GridView per visualizzare 10 account utente alla volta.</span><span class="sxs-lookup"><span data-stu-id="60596-215">To help present the user accounts in more manageable chunks, let's configure the GridView to display 10 user accounts at a time.</span></span>

<span data-ttu-id="60596-216">Il controllo GridView offre due tipi di paging:</span><span class="sxs-lookup"><span data-stu-id="60596-216">The GridView control offers two types of paging:</span></span>

- <span data-ttu-id="60596-217">**Paging predefinito** -facile da implementare, ma inefficiente.</span><span class="sxs-lookup"><span data-stu-id="60596-217">**Default paging** - easy to implement, but inefficient.</span></span> <span data-ttu-id="60596-218">In breve, con il paging predefinito, GridView prevede *tutti* i record dalla relativa origine dati.</span><span class="sxs-lookup"><span data-stu-id="60596-218">In a nutshell, with default paging the GridView expects *all* of the records from its data source.</span></span> <span data-ttu-id="60596-219">Viene quindi visualizzata solo la pagina di record appropriata.</span><span class="sxs-lookup"><span data-stu-id="60596-219">It then only displays the appropriate page of records.</span></span>
- <span data-ttu-id="60596-220">**Paging personalizzato** : richiede più lavoro da implementare, ma è più efficiente del paging predefinito perché con il paging personalizzato l'origine dati restituisce solo il set preciso di record da visualizzare.</span><span class="sxs-lookup"><span data-stu-id="60596-220">**Custom paging** - requires more work to implement, but is more efficient than default paging because with custom paging the data source returns only the precise set of records to display.</span></span>

<span data-ttu-id="60596-221">La differenza di prestazioni tra il paging predefinito e quello personalizzato può essere piuttosto sostanziale durante il paging di migliaia di record.</span><span class="sxs-lookup"><span data-stu-id="60596-221">The performance difference between default and custom paging can be quite substantial when paging through thousands of records.</span></span> <span data-ttu-id="60596-222">Poiché si sta compilando questa interfaccia presumendo che ci siano centinaia o migliaia di account utente, si userà il paging personalizzato.</span><span class="sxs-lookup"><span data-stu-id="60596-222">Because we are building this interface assuming that there may be hundreds or thousands of user accounts, let's use custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="60596-223">Per una discussione più approfondita sulle differenze tra il paging predefinito e quello personalizzato, nonché i problemi correlati all'implementazione del paging personalizzato, vedere l'articolo relativo al [paging efficiente in grandi quantità di dati](https://asp.net/learn/data-access/tutorial-25-vb.aspx).</span><span class="sxs-lookup"><span data-stu-id="60596-223">For a more thorough discussion on the differences between default and custom paging, as well as the challenges involved in implementing custom paging, refer to [Efficiently Paging Through Large Amounts of Data](https://asp.net/learn/data-access/tutorial-25-vb.aspx).</span></span> <span data-ttu-id="60596-224">Per un'analisi della differenza di prestazioni tra il paging predefinito e quello personalizzato, vedere [paging personalizzato in ASP.NET con SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="60596-224">For some analysis of the performance difference between default and custom paging, see [Custom Paging in ASP.NET with SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span></span>

<span data-ttu-id="60596-225">Per implementare il paging personalizzato, è necessario prima di tutto un meccanismo in base al quale recuperare il subset preciso di record visualizzati dal controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="60596-225">To implement custom paging we first need some mechanism by which to retrieve the precise subset of records being displayed by the GridView.</span></span> <span data-ttu-id="60596-226">La novità è che il metodo `FindUsersByName` della classe `Membership` dispone di un overload che consente di specificare l'indice e le dimensioni della pagina e restituisce solo gli account utente che rientrano in tale intervallo di record.</span><span class="sxs-lookup"><span data-stu-id="60596-226">The good news is that the `Membership` class's `FindUsersByName` method has an overload that allows us to specify the page index and page size, and returns only those user accounts that fall within that range of records.</span></span>

<span data-ttu-id="60596-227">In particolare, questo overload ha la firma seguente: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span><span class="sxs-lookup"><span data-stu-id="60596-227">In particular, this overload has the following signature: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span></span>

<span data-ttu-id="60596-228">Il parametro *pageIndex* specifica la pagina degli account utente da restituire; *pageSize* indica il numero di record da visualizzare per ogni pagina.</span><span class="sxs-lookup"><span data-stu-id="60596-228">The *pageIndex* parameter specifies the page of user accounts to return; *pageSize* indicates how many records to display per page.</span></span> <span data-ttu-id="60596-229">Il parametro *totalRecords* è un parametro `ByRef` che restituisce il numero totale di account utente nell'archivio utente.</span><span class="sxs-lookup"><span data-stu-id="60596-229">The *totalRecords* parameter is a `ByRef` parameter that returns the number of total user accounts in the user store.</span></span>

> [!NOTE]
> <span data-ttu-id="60596-230">I dati restituiti da `FindUsersByName` sono ordinati in base al nome utente; non è possibile personalizzare i criteri di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="60596-230">The data returned by `FindUsersByName` is sorted by username; the sort criteria cannot be customized.</span></span>

<span data-ttu-id="60596-231">GridView può essere configurato in modo da utilizzare il paging personalizzato, ma solo quando è associato a un controllo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="60596-231">The GridView can be configured to utilize custom paging, but only when bound to an ObjectDataSource control.</span></span> <span data-ttu-id="60596-232">Affinché il controllo ObjectDataSource implementi il paging personalizzato, richiede due metodi: uno a cui viene passato un indice della riga iniziale e il numero massimo di record da visualizzare e restituisce il subset preciso di record che rientrano in tale intervallo; e un metodo che restituisce il numero totale di record di cui viene eseguito il paging.</span><span class="sxs-lookup"><span data-stu-id="60596-232">For the ObjectDataSource control to implement custom paging, it requires two methods: one that is passed a start row index and the maximum number of records to display, and returns the precise subset of records that fall within that span; and a method that returns the total number of records being paged through.</span></span> <span data-ttu-id="60596-233">L'overload `FindUsersByName` accetta un indice e una dimensione di pagina e restituisce il numero totale di record tramite un parametro di `ByRef`.</span><span class="sxs-lookup"><span data-stu-id="60596-233">The `FindUsersByName` overload accepts a page index and page size, and returns the total number of records through a `ByRef` parameter.</span></span> <span data-ttu-id="60596-234">Quindi, esiste un'interfaccia non corrispondente.</span><span class="sxs-lookup"><span data-stu-id="60596-234">So there is an interface mismatch here.</span></span>

<span data-ttu-id="60596-235">Un'opzione consiste nel creare una classe proxy che espone l'interfaccia prevista da ObjectDataSource, quindi chiama internamente il metodo `FindUsersByName`.</span><span class="sxs-lookup"><span data-stu-id="60596-235">One option would be to create a proxy class that exposes the interface the ObjectDataSource expects, and then internally calls the `FindUsersByName` method.</span></span> <span data-ttu-id="60596-236">Un'altra opzione, e quella da usare per questo articolo, consiste nel creare un'interfaccia di paging personalizzata e usarla invece dell'interfaccia di paging incorporata di GridView.</span><span class="sxs-lookup"><span data-stu-id="60596-236">Another option - and the one we'll use for this article - is to create our own paging interface and use that instead of the GridView's built-in paging interface.</span></span>

### <a name="creating-a-first-previous-next-last-paging-interface"></a><span data-ttu-id="60596-237">Creazione di una prima, precedente, successiva, ultima interfaccia di paging</span><span class="sxs-lookup"><span data-stu-id="60596-237">Creating a First, Previous, Next, Last Paging Interface</span></span>

<span data-ttu-id="60596-238">Verrà ora compilata un'interfaccia di paging con i primi, i precedenti, i successivi e gli ultimi LinkButton.</span><span class="sxs-lookup"><span data-stu-id="60596-238">Let's build a paging interface with First, Previous, Next, and Last LinkButtons.</span></span> <span data-ttu-id="60596-239">Il primo LinkButton, quando si fa clic su di esso, porta l'utente alla prima pagina di dati, mentre l'operazione precedente lo restituirà alla pagina precedente.</span><span class="sxs-lookup"><span data-stu-id="60596-239">The First LinkButton, when clicked, will take the user to the first page of data, whereas Previous will return him to the previous page.</span></span> <span data-ttu-id="60596-240">Analogamente, Next e Last sposteranno l'utente rispettivamente nella pagina successiva e nell'ultima pagina.</span><span class="sxs-lookup"><span data-stu-id="60596-240">Likewise, Next and Last will move the user to the next and last page, respectively.</span></span> <span data-ttu-id="60596-241">Aggiungere i quattro controlli LinkButton sotto la `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="60596-241">Add the four LinkButton controls beneath the `UserAccounts` GridView.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample11.aspx)]

<span data-ttu-id="60596-242">Successivamente, creare un gestore eventi per ogni evento di `Click` di LinkButton.</span><span class="sxs-lookup"><span data-stu-id="60596-242">Next, create an event handler for each of the LinkButton's `Click` events.</span></span>

<span data-ttu-id="60596-243">Nella figura 7 vengono illustrati i quattro LinkButton quando vengono visualizzati tramite la visualizzazione di progettazione di Visual Web Developer.</span><span class="sxs-lookup"><span data-stu-id="60596-243">Figure 7 shows the four LinkButtons when viewed through the Visual Web Developer Design view.</span></span>

<span data-ttu-id="60596-244">[![aggiungere LinkButton First, Previous, Next e Last sotto GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="60596-244">[![Add First, Previous, Next, and Last LinkButtons Beneath the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image19.png)</span></span>

<span data-ttu-id="60596-245">**Figura 7**: aggiungere LinkButton First, Previous, Next e Last sotto GridView ([fare clic per visualizzare l'immagine con dimensioni complete](building-an-interface-to-select-one-user-account-from-many-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="60596-245">**Figure 7**: Add First, Previous, Next, and Last LinkButtons Beneath the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image21.png))</span></span>

### <a name="keeping-track-of-the-current-page-index"></a><span data-ttu-id="60596-246">Tenere traccia dell'indice della pagina corrente</span><span class="sxs-lookup"><span data-stu-id="60596-246">Keeping Track of the Current Page Index</span></span>

<span data-ttu-id="60596-247">Quando un utente visita la pagina `ManageUsers.aspx` o fa clic su uno dei pulsanti di filtro, si desidera visualizzare la prima pagina di dati nel controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="60596-247">When a user first visits the `ManageUsers.aspx` page or clicks one of the filtering buttons, we want to display the first page of data in the GridView.</span></span> <span data-ttu-id="60596-248">Quando l'utente fa clic su uno degli LinkButton di navigazione, tuttavia, è necessario aggiornare l'indice della pagina.</span><span class="sxs-lookup"><span data-stu-id="60596-248">When the user clicks one of the navigation LinkButtons, however, we need to update the page index.</span></span> <span data-ttu-id="60596-249">Per mantenere l'indice di pagina e il numero di record da visualizzare per pagina, aggiungere le due proprietà seguenti alla classe code-behind della pagina:</span><span class="sxs-lookup"><span data-stu-id="60596-249">To maintain the page index and the number of records to display per page, add the following two properties to the page's code-behind class:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample12.vb)]

<span data-ttu-id="60596-250">Analogamente alla proprietà `UsernameToMatch`, la proprietà `PageIndex` Salva in modo permanente il relativo valore per visualizzare lo stato.</span><span class="sxs-lookup"><span data-stu-id="60596-250">Like the `UsernameToMatch` property, the `PageIndex` property persists its value to view state.</span></span> <span data-ttu-id="60596-251">La proprietà di sola lettura `PageSize` restituisce un valore hardcoded, 10.</span><span class="sxs-lookup"><span data-stu-id="60596-251">The read-only `PageSize` property returns a hard-coded value, 10.</span></span> <span data-ttu-id="60596-252">Invito il lettore interessato ad aggiornare questa proprietà per usare lo stesso modello di `PageIndex`e quindi per aumentare la pagina `ManageUsers.aspx` in modo che la persona che visita la pagina possa specificare il numero di account utente da visualizzare per ogni pagina.</span><span class="sxs-lookup"><span data-stu-id="60596-252">I invite the interested reader to update this property to use the same pattern as `PageIndex`, and then to augment the `ManageUsers.aspx` page such that the person visiting the page can specify how many user accounts to display per page.</span></span>

### <a name="retrieving-just-the-current-pages-records-updating-the-page-index-and-enabling-and-disabling-the-paging-interface-linkbuttons"></a><span data-ttu-id="60596-253">Recupero solo dei record della pagina corrente, aggiornamento dell'indice della pagina e abilitazione e disabilitazione degli LinkButton dell'interfaccia di paging</span><span class="sxs-lookup"><span data-stu-id="60596-253">Retrieving Just the Current Page's Records, Updating the Page Index, and Enabling and Disabling the Paging Interface LinkButtons</span></span>

<span data-ttu-id="60596-254">Con l'interfaccia di paging sul posto e le proprietà `PageIndex` e `PageSize` aggiunte, è possibile aggiornare il metodo `BindUserAccounts` in modo che usi l'overload di `FindUsersByName` appropriato.</span><span class="sxs-lookup"><span data-stu-id="60596-254">With the paging interface in place and the `PageIndex` and `PageSize` properties added, we are ready to update the `BindUserAccounts` method so that it uses the appropriate `FindUsersByName` overload.</span></span> <span data-ttu-id="60596-255">Inoltre, è necessario che questo metodo consenta di abilitare o disabilitare l'interfaccia di paging a seconda della pagina visualizzata.</span><span class="sxs-lookup"><span data-stu-id="60596-255">Additionally, we need to have this method enable or disable the paging interface depending on what page is being displayed.</span></span> <span data-ttu-id="60596-256">Quando si visualizza la prima pagina di dati, è necessario disabilitare il primo e il collegamento precedente; È necessario disabilitare Next e Last per visualizzare l'ultima pagina.</span><span class="sxs-lookup"><span data-stu-id="60596-256">When viewing the first page of data, the First and Previous links should be disabled; Next and Last should be disabled when viewing the last page.</span></span>

<span data-ttu-id="60596-257">Aggiornare il metodo `BindUserAccounts` con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="60596-257">Update the `BindUserAccounts` method with the following code:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample13.vb)]

<span data-ttu-id="60596-258">Si noti che il numero totale di record di cui viene eseguito il paging è determinato dall'ultimo parametro del metodo `FindUsersByName`.</span><span class="sxs-lookup"><span data-stu-id="60596-258">Note that the total number of records being paged through is determined by the last parameter of the `FindUsersByName` method.</span></span> <span data-ttu-id="60596-259">Dopo che la pagina specificata degli account utente viene restituita, i quattro LinkButton sono abilitati o disabilitati, a seconda che venga visualizzata la prima o l'ultima pagina di dati.</span><span class="sxs-lookup"><span data-stu-id="60596-259">After the specified page of user accounts are returned, the four LinkButtons are either enabled or disabled, depending on whether the first or last page of data is being viewed.</span></span>

<span data-ttu-id="60596-260">L'ultimo passaggio consiste nel scrivere il codice per i quattro gestori di eventi `Click` di LinkButton.</span><span class="sxs-lookup"><span data-stu-id="60596-260">The last step is to write the code for the four LinkButtons' `Click` event handlers.</span></span> <span data-ttu-id="60596-261">Questi gestori di eventi devono aggiornare la proprietà `PageIndex` e quindi riassociare i dati al GridView tramite una chiamata a `BindUserAccounts` i primi gestori di eventi, precedenti e successivi sono molto semplici.</span><span class="sxs-lookup"><span data-stu-id="60596-261">These event handlers need to update the `PageIndex` property and then rebind the data to the GridView via a call to `BindUserAccounts` The First, Previous, and Next event handlers are very simple.</span></span> <span data-ttu-id="60596-262">Il gestore dell'evento `Click` per l'ultimo LinkButton, tuttavia, è un po' più complesso perché è necessario determinare il numero di record visualizzati per determinare l'ultimo indice di pagina.</span><span class="sxs-lookup"><span data-stu-id="60596-262">The `Click` event handler for the Last LinkButton, however, is a bit more complex because we need to determine how many records are being displayed in order to determine the last page index.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample14.vb)]

<span data-ttu-id="60596-263">Nelle figure 8 e 9 è illustrata l'interfaccia di paging personalizzata.</span><span class="sxs-lookup"><span data-stu-id="60596-263">Figures 8 and 9 show the custom paging interface in action.</span></span> <span data-ttu-id="60596-264">Nella figura 8 viene illustrata la pagina `ManageUsers.aspx` quando si visualizza la prima pagina di dati per tutti gli account utente.</span><span class="sxs-lookup"><span data-stu-id="60596-264">Figure 8 shows the `ManageUsers.aspx` page when viewing the first page of data for all user accounts.</span></span> <span data-ttu-id="60596-265">Si noti che vengono visualizzati solo 10 dei 13 account.</span><span class="sxs-lookup"><span data-stu-id="60596-265">Note that only 10 of the 13 accounts are displayed.</span></span> <span data-ttu-id="60596-266">Facendo clic sul collegamento successivo o ultimo viene generato un postback, viene aggiornato il `PageIndex` a 1 e viene associata la seconda pagina degli account utente alla griglia (vedere la figura 9).</span><span class="sxs-lookup"><span data-stu-id="60596-266">Clicking the Next or Last link causes a postback, updates the `PageIndex` to 1, and binds the second page of user accounts to the grid (see Figure 9).</span></span>

<span data-ttu-id="60596-267">[![vengono visualizzati i primi 10 account utente](building-an-interface-to-select-one-user-account-from-many-vb/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="60596-267">[![The First 10 User Accounts are Displayed](building-an-interface-to-select-one-user-account-from-many-vb/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image22.png)</span></span>

<span data-ttu-id="60596-268">**Figura 8**: vengono visualizzati i primi 10 account utente ([fare clic per visualizzare l'immagine con dimensioni complete](building-an-interface-to-select-one-user-account-from-many-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="60596-268">**Figure 8**: The First 10 User Accounts are Displayed ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image24.png))</span></span>

<span data-ttu-id="60596-269">[![facendo clic sul collegamento successivo viene visualizzata la seconda pagina degli account utente](building-an-interface-to-select-one-user-account-from-many-vb/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="60596-269">[![Clicking the Next Link Displays the Second Page of User Accounts](building-an-interface-to-select-one-user-account-from-many-vb/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image25.png)</span></span>

<span data-ttu-id="60596-270">**Figura 9**: facendo clic sul collegamento successivo viene visualizzata la seconda pagina di account utente ([fare clic per visualizzare l'immagine con dimensioni complete](building-an-interface-to-select-one-user-account-from-many-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="60596-270">**Figure 9**: Clicking the Next Link Displays the Second Page of User Accounts ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image27.png))</span></span>

## <a name="summary"></a><span data-ttu-id="60596-271">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="60596-271">Summary</span></span>

<span data-ttu-id="60596-272">Gli amministratori devono spesso selezionare un utente dall'elenco di account.</span><span class="sxs-lookup"><span data-stu-id="60596-272">Administrators often need to select a user from the list of accounts.</span></span> <span data-ttu-id="60596-273">Nelle esercitazioni precedenti è stato esaminato l'uso di un elenco a discesa popolato con gli utenti, ma questo approccio non può essere ridimensionato correttamente.</span><span class="sxs-lookup"><span data-stu-id="60596-273">In previous tutorials we looked at using a drop-down list populated with the users, but this approach does not scale well.</span></span> <span data-ttu-id="60596-274">In questa esercitazione è stata illustrata un'alternativa migliore: un'interfaccia filtrabile i cui risultati vengono visualizzati in un GridView di paging.</span><span class="sxs-lookup"><span data-stu-id="60596-274">In this tutorial we explored a better alternative: a filterable interface whose results are displayed in a paged GridView.</span></span> <span data-ttu-id="60596-275">Con questa interfaccia utente, gli amministratori possono individuare e selezionare un account utente in modo rapido ed efficiente tra le migliaia.</span><span class="sxs-lookup"><span data-stu-id="60596-275">With this user interface, administrators can quickly and efficiently locate and select one user account among thousands.</span></span>

<span data-ttu-id="60596-276">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="60596-276">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="60596-277">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="60596-277">Further Reading</span></span>

<span data-ttu-id="60596-278">Per ulteriori informazioni sugli argomenti trattati in questa esercitazione, fare riferimento alle risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="60596-278">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="60596-279">Paging personalizzato in ASP.NET con SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="60596-279">Custom Paging in ASP.NET with SQL Server 2005</span></span>](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)
- [<span data-ttu-id="60596-280">Paging efficiente in grandi quantità di dati</span><span class="sxs-lookup"><span data-stu-id="60596-280">Efficiently Paging Through Large Amounts of Data</span></span>](https://asp.net/learn/data-access/tutorial-25-vb.aspx)
- [<span data-ttu-id="60596-281">Implementazione dello strumento di amministrazione del sito Web</span><span class="sxs-lookup"><span data-stu-id="60596-281">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="60596-282">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="60596-282">About the Author</span></span>

<span data-ttu-id="60596-283">Scott Mitchell, autore di più libri ASP/ASP. NET e fondatore di 4GuysFromRolla.com, collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="60596-283">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="60596-284">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="60596-284">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="60596-285">Il suo ultimo libro è *[Sams Teach Yourself ASP.NET 2,0 in 24 ore](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="60596-285">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="60596-286">Scott può essere raggiunto in [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) o tramite il suo blog al [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="60596-286">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="60596-287">Grazie speciale</span><span class="sxs-lookup"><span data-stu-id="60596-287">Special Thanks To</span></span>

<span data-ttu-id="60596-288">Questa serie di esercitazioni è stata esaminata da molti revisori utili.</span><span class="sxs-lookup"><span data-stu-id="60596-288">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="60596-289">Il revisore responsabile di questa esercitazione è Alicja Maziarz.</span><span class="sxs-lookup"><span data-stu-id="60596-289">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="60596-290">Sei interessato a esaminare i miei prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="60596-290">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="60596-291">In caso affermativo, rilasciare una riga in</span><span class="sxs-lookup"><span data-stu-id="60596-291">If so, drop me a line at</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="60596-292">[Precedente](unlocking-and-approving-user-accounts-cs.md)
> [Successivo](recovering-and-changing-passwords-vb.md)</span><span class="sxs-lookup"><span data-stu-id="60596-292">[Previous](unlocking-and-approving-user-accounts-cs.md)
[Next](recovering-and-changing-passwords-vb.md)</span></span>
