---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal
title: Pagamento e pagamento con PayPal Documenti Microsoft
author: Erikre
description: Questa serie di esercitazioni insegnerà le nozioni di base per la creazione di un'applicazione Web Form ASP.NET utilizzando ASP.NET 4.5 e Microsoft Visual Studio Express 2013 per noi...
ms.author: riande
ms.date: 09/08/2014
ms.assetid: 664ec95e-b0c9-4f43-a39f-798d0f2a7e08
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal
msc.type: authoredcontent
ms.openlocfilehash: 62d00a86c6c5845fb894896df65002c7086d039f
ms.sourcegitcommit: ce28244209db8615bc9bdd576a2e2c88174d318d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2020
ms.locfileid: "80676055"
---
# <a name="checkout-and-payment-with-paypal"></a><span data-ttu-id="1efd6-103">Completamento della transazione e pagamento con PayPal</span><span class="sxs-lookup"><span data-stu-id="1efd6-103">Checkout and Payment with PayPal</span></span>

<span data-ttu-id="1efd6-104">da parte di [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="1efd6-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="1efd6-105">[Scarica Wingtip Toys Sample Project (C)](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) o [Scarica E-book (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="1efd6-105">[Download Wingtip Toys Sample Project (C#)](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="1efd6-106">Questa serie di esercitazioni illustra le nozioni di base per la creazione di un'applicazione Web Form ASP.NET utilizzando ASP.NET 4.5 e Microsoft Visual Studio Express 2013 per Web.</span><span class="sxs-lookup"><span data-stu-id="1efd6-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="1efd6-107">Per accompagnare questa serie di esercitazioni, è disponibile un progetto di Visual Studio 2013 [con codice sorgente C .](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409)</span><span class="sxs-lookup"><span data-stu-id="1efd6-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>

<span data-ttu-id="1efd6-108">Questa esercitazione descrive come modificare l'applicazione di esempio Wingtip Toys per includere l'autorizzazione utente, la registrazione e il pagamento tramite PayPal.This tutorial describes how to modify the Wingtip Toys sample application to include user authorization, registration, and payment using PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-108">This tutorial describes how to modify the Wingtip Toys sample application to include user authorization, registration, and payment using PayPal.</span></span> <span data-ttu-id="1efd6-109">Solo gli utenti che hanno effettuato l'accesso avranno l'autorizzazione per l'acquisto di prodotti.</span><span class="sxs-lookup"><span data-stu-id="1efd6-109">Only users who are logged in will have authorization to purchase products.</span></span> <span data-ttu-id="1efd6-110">La funzionalità di registrazione utente incorporata del modello di progetto Web Form ASP.NET 4.5 include già gran parte di ciò che è necessario.</span><span class="sxs-lookup"><span data-stu-id="1efd6-110">The ASP.NET 4.5 Web Forms project template's built-in user registration functionality already includes much of what you need.</span></span> <span data-ttu-id="1efd6-111">Si aggiungerà la funzionalità PayPal Express Checkout.</span><span class="sxs-lookup"><span data-stu-id="1efd6-111">You will add PayPal Express Checkout functionality.</span></span> <span data-ttu-id="1efd6-112">In questa esercitazione si utilizza l'ambiente di test per sviluppatori PayPal, quindi non verranno trasferiti fondi effettivi.</span><span class="sxs-lookup"><span data-stu-id="1efd6-112">In this tutorial you be using the PayPal developer testing environment, so no actual funds will be transferred.</span></span> <span data-ttu-id="1efd6-113">Alla fine dell'esercitazione, testerai l'applicazione selezionando i prodotti da aggiungere al carrello, facendo clic sul pulsante checkout e trasferendo i dati al sito web di test di PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-113">At the end of the tutorial, you will test the application by selecting products to add to the shopping cart, clicking the checkout button, and transferring data to the PayPal testing web site.</span></span> <span data-ttu-id="1efd6-114">Sul sito web di test PayPal, confermerai le informazioni di spedizione e pagamento e tornerai alla domanda di esempio Locale Wingtip Toys per confermare e completare l'acquisto.</span><span class="sxs-lookup"><span data-stu-id="1efd6-114">On the PayPal testing web site, you will confirm your shipping and payment information and then return to the local Wingtip Toys sample application to confirm and complete the purchase.</span></span>

<span data-ttu-id="1efd6-115">Ci sono diversi processori di pagamento di terze parti esperti che si specializzano in shopping online che affrontano la scalabilità e la sicurezza.</span><span class="sxs-lookup"><span data-stu-id="1efd6-115">There are several experienced third-party payment processors that specialize in online shopping that address scalability and security.</span></span> <span data-ttu-id="1efd6-116">ASP.NET sviluppatori di ASP.NET dovrebbero considerare i vantaggi di utilizzare una soluzione di pagamento di terze parti prima di implementare una soluzione di acquisto e acquisto.</span><span class="sxs-lookup"><span data-stu-id="1efd6-116">ASP.NET developers should consider the advantages of utilizing a third party payment solution before implementing a shopping and purchasing solution.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="1efd6-117">L'applicazione di esempio Wingtip Toys è stata progettata per mostrare concetti e funzionalità di ASP.NET specifici disponibili per ASP.NET gli sviluppatori Web.</span><span class="sxs-lookup"><span data-stu-id="1efd6-117">The Wingtip Toys sample application was designed to shown specific ASP.NET concepts and features available to ASP.NET web developers.</span></span> <span data-ttu-id="1efd6-118">Questa applicazione di esempio non è stata ottimizzata per tutte le possibili circostanze in materia di scalabilità e sicurezza.</span><span class="sxs-lookup"><span data-stu-id="1efd6-118">This sample application was not optimized for all possible circumstances in regard to scalability and security.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="1efd6-119">Contenuto dell'esercitazione:</span><span class="sxs-lookup"><span data-stu-id="1efd6-119">What you'll learn:</span></span>

- <span data-ttu-id="1efd6-120">Come limitare l'accesso a pagine specifiche in una cartella.</span><span class="sxs-lookup"><span data-stu-id="1efd6-120">How to restrict access to specific pages in a folder.</span></span>
- <span data-ttu-id="1efd6-121">Come creare un carrello della spesa noto da un carrello della spesa anonimo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-121">How to create a known shopping cart from an anonymous shopping cart.</span></span>
- <span data-ttu-id="1efd6-122">Come abilitare SSL per il progetto.</span><span class="sxs-lookup"><span data-stu-id="1efd6-122">How to enable SSL for the project.</span></span>
- <span data-ttu-id="1efd6-123">Come aggiungere un provider OAuth al progetto.</span><span class="sxs-lookup"><span data-stu-id="1efd6-123">How to add an OAuth provider to the project.</span></span>
- <span data-ttu-id="1efd6-124">Come utilizzare PayPal per acquistare prodotti utilizzando l'ambiente di test PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-124">How to use PayPal to purchase products using the PayPal testing environment.</span></span>
- <span data-ttu-id="1efd6-125">Come visualizzare i dettagli da PayPal in un controllo **DetailsView.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-125">How to display details from PayPal in a **DetailsView** control.</span></span>
- <span data-ttu-id="1efd6-126">Come aggiornare il database dell'applicazione Wingtip Toys con i dettagli ottenuti da PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-126">How to update the database of the Wingtip Toys application with details obtained from PayPal.</span></span>

## <a name="adding-order-tracking"></a><span data-ttu-id="1efd6-127">Aggiunta di tracciabilità ordine</span><span class="sxs-lookup"><span data-stu-id="1efd6-127">Adding Order Tracking</span></span>

<span data-ttu-id="1efd6-128">In questa esercitazione verranno create due nuove classi per tenere traccia dei dati dall'ordine creato da un utente.</span><span class="sxs-lookup"><span data-stu-id="1efd6-128">In this tutorial, you'll create two new classes to track data from the order a user has created.</span></span> <span data-ttu-id="1efd6-129">Le classi monitoreranno i dati relativi alle informazioni di spedizione, al totale dell'acquisto e alla conferma del pagamento.</span><span class="sxs-lookup"><span data-stu-id="1efd6-129">The classes will track data regarding shipping information, purchase total, and payment confirmation.</span></span>

### <a name="add-the-order-and-orderdetail-model-classes"></a><span data-ttu-id="1efd6-130">Aggiungere le classi del modello Order e OrderDetailAdd the Order and OrderDetail Model Classes</span><span class="sxs-lookup"><span data-stu-id="1efd6-130">Add the Order and OrderDetail Model Classes</span></span>

<span data-ttu-id="1efd6-131">In precedenza in questa serie di esercitazioni è stato definito `Category`lo `Product`schema `CartItem` per le categorie, i prodotti e gli elementi del carrello mediante la creazione delle classi , e nella cartella *Models* .</span><span class="sxs-lookup"><span data-stu-id="1efd6-131">Earlier in this tutorial series, you defined the schema for categories, products, and shopping cart items by creating the `Category`, `Product`, and `CartItem` classes in the *Models* folder.</span></span> <span data-ttu-id="1efd6-132">A questo punto si aggiungeranno due nuove classi per definire lo schema per l'ordine dei prodotti e i dettagli dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="1efd6-132">Now you will add two new classes to define the schema for the product order and the details of the order.</span></span>

1. <span data-ttu-id="1efd6-133">Nella cartella **Modelli** aggiungere una nuova classe denominata *Order.cs*.</span><span class="sxs-lookup"><span data-stu-id="1efd6-133">In the **Models** folder, add a new class named *Order.cs*.</span></span>   
   <span data-ttu-id="1efd6-134">Il nuovo file di classe viene visualizzato nell'editor.</span><span class="sxs-lookup"><span data-stu-id="1efd6-134">The new class file is displayed in the editor.</span></span>
2. <span data-ttu-id="1efd6-135">Sostituire il codice predefinito con quello riportato di seguito:</span><span class="sxs-lookup"><span data-stu-id="1efd6-135">Replace the default code with the following:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample1.cs)]
3. <span data-ttu-id="1efd6-136">Aggiungere *una* classe OrderDetail.cs alla cartella *Models.Add* an OrderDetail.cs class to the Models folder.</span><span class="sxs-lookup"><span data-stu-id="1efd6-136">Add an *OrderDetail.cs* class to the *Models* folder.</span></span>
4. <span data-ttu-id="1efd6-137">Sostituire il codice predefinito con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="1efd6-137">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample2.cs)]

<span data-ttu-id="1efd6-138">Le `Order` `OrderDetail` classi e contengono lo schema per definire le informazioni sull'ordine utilizzate per l'acquisto e la spedizione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-138">The `Order` and `OrderDetail` classes contain the schema to define the order information used for purchasing and shipping.</span></span>

<span data-ttu-id="1efd6-139">Inoltre, sarà necessario aggiornare la classe di contesto del database che gestisce le classi di entità e che fornisce l'accesso ai dati al database.</span><span class="sxs-lookup"><span data-stu-id="1efd6-139">In addition, you will need to update the database context class that manages the entity classes and that provides data access to the database.</span></span> <span data-ttu-id="1efd6-140">A tale scopo, si aggiungeranno `OrderDetail` le classi `ProductContext` Order e model appena create alla classe.</span><span class="sxs-lookup"><span data-stu-id="1efd6-140">To do this, you will add the newly created Order and `OrderDetail` model classes to `ProductContext` class.</span></span>

1. <span data-ttu-id="1efd6-141">In **Esplora soluzioni**individuare e aprire il file *di ProductContext.cs.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-141">In **Solution Explorer**, find and open the *ProductContext.cs* file.</span></span>
2. <span data-ttu-id="1efd6-142">Aggiungere il codice evidenziato al file *ProductContext.cs* come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="1efd6-142">Add the highlighted code to the *ProductContext.cs* file as shown below:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample3.cs?highlight=14-15)]

<span data-ttu-id="1efd6-143">Come accennato in precedenza in questa serie `System.Data.Entity` di esercitazioni, il codice nel file di *ProductContext.cs* aggiunge lo spazio dei nomi in modo da avere accesso a tutte le funzionalità di base di Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1efd6-143">As mentioned previously in this tutorial series, the code in the *ProductContext.cs* file adds the `System.Data.Entity` namespace so that you have access to all the core functionality of the Entity Framework.</span></span> <span data-ttu-id="1efd6-144">Questa funzionalità include la possibilità di eseguire query, inserire, aggiornare ed eliminare dati utilizzando oggetti fortemente tipizzati.</span><span class="sxs-lookup"><span data-stu-id="1efd6-144">This functionality includes the capability to query, insert, update, and delete data by working with strongly typed objects.</span></span> <span data-ttu-id="1efd6-145">Il codice precedente `ProductContext` nella classe aggiunge l'accesso `OrderDetail` Entity Framework alle classi e e appena aggiunte. `Order`</span><span class="sxs-lookup"><span data-stu-id="1efd6-145">The above code in the `ProductContext` class adds Entity Framework access to the newly added `Order` and `OrderDetail` classes.</span></span>

## <a name="adding-checkout-access"></a><span data-ttu-id="1efd6-146">Aggiunta dell'accesso all'estrazione</span><span class="sxs-lookup"><span data-stu-id="1efd6-146">Adding Checkout Access</span></span>

<span data-ttu-id="1efd6-147">L'applicazione di esempio Wingtip Toys consente agli utenti anonimi di rivedere e aggiungere prodotti a un carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="1efd6-147">The Wingtip Toys sample application allows anonymous users to review and add products to a shopping cart.</span></span> <span data-ttu-id="1efd6-148">Tuttavia, quando gli utenti anonimi scelgono di acquistare i prodotti aggiunti al carrello, devono accedere al sito.</span><span class="sxs-lookup"><span data-stu-id="1efd6-148">However, when anonymous users choose to purchase the products they added to the shopping cart, they must log on to the site.</span></span> <span data-ttu-id="1efd6-149">Una volta effettuato l'accesso, possono accedere alle pagine con restrizioni dell'applicazione Web che gestiscono il processo di estrazione e acquisto.</span><span class="sxs-lookup"><span data-stu-id="1efd6-149">Once they have logged on, they can access the restricted pages of the Web application that handle the checkout and purchase process.</span></span> <span data-ttu-id="1efd6-150">Queste pagine con restrizioni sono contenute nella cartella *Checkout* dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-150">These restricted pages are contained in the *Checkout* folder of the application.</span></span>

### <a name="add-a-checkout-folder-and-pages"></a><span data-ttu-id="1efd6-151">Aggiungere una cartella e pagine di estrazione</span><span class="sxs-lookup"><span data-stu-id="1efd6-151">Add a Checkout Folder and Pages</span></span>

<span data-ttu-id="1efd6-152">Ora creerai la cartella *Checkout* e le pagine in essa in essa in essa in essa contenuto che il cliente vedrà durante il processo di checkout.</span><span class="sxs-lookup"><span data-stu-id="1efd6-152">You will now create the *Checkout* folder and the pages in it that the customer will see during the checkout process.</span></span> <span data-ttu-id="1efd6-153">Queste pagine verranno aggiornate più avanti in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-153">You will update these pages later in this tutorial.</span></span>

1. <span data-ttu-id="1efd6-154">Fare clic con il pulsante destro del mouse sul nome del progetto (**Wingtip Toys**) in **Esplora soluzioni** e selezionare **Aggiungi nuova cartella**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-154">Right-click the project name (**Wingtip Toys**) in **Solution Explorer** and select **Add a New Folder**.</span></span> 

    ![Checkout e pagamento con PayPal - Nuova cartella](checkout-and-payment-with-paypal/_static/image1.png)
2. <span data-ttu-id="1efd6-156">Assegnare alla nuova cartella il nome *Estrai*.</span><span class="sxs-lookup"><span data-stu-id="1efd6-156">Name the new folder *Checkout*.</span></span>
3. <span data-ttu-id="1efd6-157">Fare clic con il pulsante destro del mouse sulla cartella *Checkout,* quindi scegliere **Aggiungi**-&gt;**nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-157">Right-click the *Checkout* folder and then select **Add**-&gt;**New Item**.</span></span> 

    ![Checkout e pagamento con PayPal - Nuovo articolo](checkout-and-payment-with-paypal/_static/image2.png)
4. <span data-ttu-id="1efd6-159">La finestra di dialogo **Aggiungi nuovo elemento** viene visualizzata.</span><span class="sxs-lookup"><span data-stu-id="1efd6-159">The **Add New Item** dialog box is displayed.</span></span>
5. <span data-ttu-id="1efd6-160">Selezionare il gruppo di modelli **Web** **di Visual C.**  - &gt;</span><span class="sxs-lookup"><span data-stu-id="1efd6-160">Select the **Visual C#** -&gt; **Web** templates group on the left.</span></span> <span data-ttu-id="1efd6-161">Quindi, dal riquadro centrale, selezionare **Web Form con pagina master**e denominarlo *CheckoutStart.aspx*.</span><span class="sxs-lookup"><span data-stu-id="1efd6-161">Then, from the middle pane, select **Web Form with Master Page**and name it *CheckoutStart.aspx*.</span></span> 

    ![Checkout e pagamento con PayPal - Finestra di dialogo Aggiungi nuovo elemento](checkout-and-payment-with-paypal/_static/image3.png)
6. <span data-ttu-id="1efd6-163">Come in precedenza, selezionare il file *Site.Master* come pagina master.</span><span class="sxs-lookup"><span data-stu-id="1efd6-163">As before, select the *Site.Master* file as the master page.</span></span>
7. <span data-ttu-id="1efd6-164">Aggiungere le seguenti pagine aggiuntive alla cartella *Checkout* utilizzando la stessa procedura descritta in precedenza:</span><span class="sxs-lookup"><span data-stu-id="1efd6-164">Add the following additional pages to the *Checkout* folder using the same steps above:</span></span>   

    - <span data-ttu-id="1efd6-165">CheckReview.aspx</span><span class="sxs-lookup"><span data-stu-id="1efd6-165">CheckoutReview.aspx</span></span>
    - <span data-ttu-id="1efd6-166">CheckoutComplete.aspx</span><span class="sxs-lookup"><span data-stu-id="1efd6-166">CheckoutComplete.aspx</span></span>
    - <span data-ttu-id="1efd6-167">CheckoutCancel.aspx</span><span class="sxs-lookup"><span data-stu-id="1efd6-167">CheckoutCancel.aspx</span></span>
    - <span data-ttu-id="1efd6-168">CheckoutError.aspx</span><span class="sxs-lookup"><span data-stu-id="1efd6-168">CheckoutError.aspx</span></span>

### <a name="add-a-webconfig-file"></a><span data-ttu-id="1efd6-169">Aggiungere un file Web.config</span><span class="sxs-lookup"><span data-stu-id="1efd6-169">Add a Web.config File</span></span>

<span data-ttu-id="1efd6-170">Aggiungendo un nuovo file *Web.config* alla cartella *Checkout,* sarà possibile limitare l'accesso a tutte le pagine contenute nella cartella.</span><span class="sxs-lookup"><span data-stu-id="1efd6-170">By adding a new *Web.config* file to the *Checkout* folder, you will be able to restrict access to all the pages contained in the folder.</span></span>

1. <span data-ttu-id="1efd6-171">Fare clic con il pulsante destro del mouse sulla cartella *Checkout* e selezionare **Aggiungi**  - &gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-171">Right-click the *Checkout* folder and select **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="1efd6-172">La finestra di dialogo **Aggiungi nuovo elemento** viene visualizzata.</span><span class="sxs-lookup"><span data-stu-id="1efd6-172">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="1efd6-173">Selezionare il gruppo di modelli **Web** **di Visual C.**  - &gt;</span><span class="sxs-lookup"><span data-stu-id="1efd6-173">Select the **Visual C#** -&gt; **Web** templates group on the left.</span></span> <span data-ttu-id="1efd6-174">Quindi, nel riquadro centrale selezionare File di **configurazione Web**, accettare il nome predefinito *Web.config*, quindi scegliere **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-174">Then, from the middle pane, select **Web Configuration File**, accept the default name of *Web.config*, and then select **Add**.</span></span>
3. <span data-ttu-id="1efd6-175">Sostituire il contenuto XML esistente nel file *Web.config* con il contenuto seguente:</span><span class="sxs-lookup"><span data-stu-id="1efd6-175">Replace the existing XML content in the *Web.config* file with the following:</span></span>  

    [!code-xml[Main](checkout-and-payment-with-paypal/samples/sample4.xml)]
4. <span data-ttu-id="1efd6-176">Salvare il file *Web.config*.</span><span class="sxs-lookup"><span data-stu-id="1efd6-176">Save the *Web.config* file.</span></span>

<span data-ttu-id="1efd6-177">Il file *Web.config* specifica che a tutti gli utenti sconosciuti dell'applicazione Web deve essere negato l'accesso alle pagine contenute nella cartella *Checkout.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-177">The *Web.config* file specifies that all unknown users of the Web application must be denied access to the pages contained in the *Checkout* folder.</span></span> <span data-ttu-id="1efd6-178">Tuttavia, se l'utente ha registrato un account ed è connesso, sarà un utente noto e avrà accesso alle pagine nella cartella *Checkout.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-178">However, if the user has registered an account and is logged on, they will be a known user and will have access to the pages in the *Checkout* folder.</span></span>

<span data-ttu-id="1efd6-179">È importante notare che ASP.NET configurazione segue una gerarchia, in cui ogni file *Web.config* applica le impostazioni di configurazione alla cartella in cui si trova e a tutte le directory figlio sottostanti.</span><span class="sxs-lookup"><span data-stu-id="1efd6-179">It's important to note that ASP.NET configuration follows a hierarchy, where each *Web.config* file applies configuration settings to the folder that it is in and to all of the child directories below it.</span></span>

<a id="SSLWebForms"></a>
## <a name="enable-ssl-for-the-project"></a><span data-ttu-id="1efd6-180">Abilitare SSL per il progetto</span><span class="sxs-lookup"><span data-stu-id="1efd6-180">Enable SSL for the Project</span></span>

 <span data-ttu-id="1efd6-181">Secure Sockets Layer (SSL) è un protocollo definito per consentire ai server Web e ai client Web di comunicare in modo più sicuro tramite l'uso della crittografia.</span><span class="sxs-lookup"><span data-stu-id="1efd6-181">Secure Sockets Layer (SSL) is a protocol defined to allow Web servers and Web clients to communicate more securely through the use of encryption.</span></span> <span data-ttu-id="1efd6-182">Quando non si usa SSL, i dati inviati tra il client e il server possono essere soggetti allo sniffing dei pacchetti da qualsiasi soggetto con accesso fisico alla rete.</span><span class="sxs-lookup"><span data-stu-id="1efd6-182">When SSL is not used, data sent between the client and server is open to packet sniffing by anyone with physical access to the network.</span></span> <span data-ttu-id="1efd6-183">Inoltre, numerosi schemi di autenticazione comuni non sono sicuri sul protocollo HTTP normale.</span><span class="sxs-lookup"><span data-stu-id="1efd6-183">Additionally, several common authentication schemes are not secure over plain HTTP.</span></span> <span data-ttu-id="1efd6-184">In particolare, l'autenticazione di base e l'autenticazione basata su form inviano credenziali non crittografate.</span><span class="sxs-lookup"><span data-stu-id="1efd6-184">In particular, Basic authentication and forms authentication send unencrypted credentials.</span></span> <span data-ttu-id="1efd6-185">Per essere sicuri, questi schemi di autenticazione devono usare il protocollo SSL.</span><span class="sxs-lookup"><span data-stu-id="1efd6-185">To be secure, these authentication schemes must use SSL.</span></span> 

1. <span data-ttu-id="1efd6-186">In **Esplora soluzioni**fare clic sul progetto **WingtipToys,** quindi premere **F4** per visualizzare la finestra **Proprietà.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-186">In **Solution Explorer**, click the **WingtipToys** project, then press **F4** to display the **Properties** window.</span></span>
2. <span data-ttu-id="1efd6-187">Impostare SSL `true`abilitato **su** .</span><span class="sxs-lookup"><span data-stu-id="1efd6-187">Change **SSL Enabled** to `true`.</span></span>
3. <span data-ttu-id="1efd6-188">Copiare **l'URL SSL** in modo da poterlo utilizzare in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="1efd6-188">Copy the **SSL URL** so you can use it later.</span></span>   
 <span data-ttu-id="1efd6-189">L'URL SSL `https://localhost:44300/` sarà a meno che non sia stato precedentemente creato siti Web SSL (come illustrato di seguito).</span><span class="sxs-lookup"><span data-stu-id="1efd6-189">The SSL URL will be `https://localhost:44300/` unless you've previously created SSL Web Sites (as shown below).</span></span>   
    <span data-ttu-id="1efd6-190">![Proprietà del progetto](checkout-and-payment-with-paypal/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="1efd6-190">![Project Properties](checkout-and-payment-with-paypal/_static/image4.png)</span></span>
4. <span data-ttu-id="1efd6-191">In **Esplora soluzioni**fare clic con il pulsante destro del mouse sul progetto **WingtipToys** e **scegliere Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-191">In **Solution Explorer**, right click the **WingtipToys** project and click **Properties**.</span></span>
5. <span data-ttu-id="1efd6-192">Nella scheda a sinistra fare clic su **Web**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-192">In the left tab, click **Web**.</span></span>
6. <span data-ttu-id="1efd6-193">Modificare **l'URL del progetto** per utilizzare l'URL **SSL** salvato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="1efd6-193">Change the **Project Url** to use the **SSL URL** that you saved earlier.</span></span>   
    <span data-ttu-id="1efd6-194">![Proprietà del progetto Web](checkout-and-payment-with-paypal/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="1efd6-194">![Project Web Properties](checkout-and-payment-with-paypal/_static/image5.png)</span></span>
7. <span data-ttu-id="1efd6-195">Per salvare la pagina, premere **CTRL+S**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-195">Save the page by pressing **CTRL+S**.</span></span>
8. <span data-ttu-id="1efd6-196">Premete **Ctrl e F5** per eseguire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-196">Press **Ctrl+F5** to run the application.</span></span> <span data-ttu-id="1efd6-197">In Visual Studio verrà visualizzata un'opzione che consente di evitare eventuali avvisi SSL.</span><span class="sxs-lookup"><span data-stu-id="1efd6-197">Visual Studio will display an option to allow you to avoid SSL warnings.</span></span>
9. <span data-ttu-id="1efd6-198">Fare clic su **Sì** per considerare attendibile il certificato SSL di IIS Express e continuare.</span><span class="sxs-lookup"><span data-stu-id="1efd6-198">Click **Yes** to trust the IIS Express SSL certificate and continue.</span></span>   
    <span data-ttu-id="1efd6-199">![Dettagli del certificato SSL di IIS Express](checkout-and-payment-with-paypal/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="1efd6-199">![IIS Express SSL certificate details](checkout-and-payment-with-paypal/_static/image6.png)</span></span>  
 <span data-ttu-id="1efd6-200"> Verrà visualizzato un avviso di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="1efd6-200">A Security Warning is displayed.</span></span>
10. <span data-ttu-id="1efd6-201">Fare clic su **Sì** per installare il certificato per l'host locale.</span><span class="sxs-lookup"><span data-stu-id="1efd6-201">Click **Yes** to install the certificate to your localhost.</span></span>   
    <span data-ttu-id="1efd6-202">![Finestra di dialogo Avviso di sicurezza](checkout-and-payment-with-paypal/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1efd6-202">![Security Warning dialog box](checkout-and-payment-with-paypal/_static/image7.png)</span></span>  
 <span data-ttu-id="1efd6-203"> Verrà visualizzata la finestra del browser.</span><span class="sxs-lookup"><span data-stu-id="1efd6-203">The browser window will be displayed.</span></span>

<span data-ttu-id="1efd6-204">È ora possibile testare facilmente l'applicazione Web in locale utilizzando SSL.</span><span class="sxs-lookup"><span data-stu-id="1efd6-204">You can now easily test your Web application locally using SSL.</span></span>

<a id="OAuthWebForms"></a>
## <a name="add-an-oauth-20-provider"></a><span data-ttu-id="1efd6-205">Aggiungere un provider OAuth 2.0</span><span class="sxs-lookup"><span data-stu-id="1efd6-205">Add an OAuth 2.0 Provider</span></span>

<span data-ttu-id="1efd6-206">ASP.NET Web Form offre opzioni avanzate per l'appartenenza e l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-206">ASP.NET Web Forms provides enhanced options for membership and authentication.</span></span> <span data-ttu-id="1efd6-207">Questi miglioramenti includono OAuth.These enhancements include OAuth.</span><span class="sxs-lookup"><span data-stu-id="1efd6-207">These enhancements include OAuth.</span></span> <span data-ttu-id="1efd6-208">OAuth è un protocollo aperto che consente l'autorizzazione sicura in un metodo semplice e standard da applicazioni web, mobile e desktop.</span><span class="sxs-lookup"><span data-stu-id="1efd6-208">OAuth is an open protocol that allows secure authorization in a simple and standard method from web, mobile, and desktop applications.</span></span> <span data-ttu-id="1efd6-209">Il modello Web Form ASP.NET utilizza OAuth per esporre Facebook, Twitter, Google e Microsoft come provider di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-209">The ASP.NET Web Forms template uses OAuth to expose Facebook, Twitter, Google and Microsoft as authentication providers.</span></span> <span data-ttu-id="1efd6-210">Anche se questa esercitazione utilizza solo Google come provider di autenticazione, è possibile modificare facilmente il codice per utilizzare uno qualsiasi dei provider.</span><span class="sxs-lookup"><span data-stu-id="1efd6-210">Although this tutorial uses only Google as the authentication provider, you can easily modify the code to use any of the providers.</span></span> <span data-ttu-id="1efd6-211">I passaggi per implementare altri provider sono molto simili a quelli che si vedranno in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-211">The steps to implement other providers are very similar to the steps you will see in this tutorial.</span></span>

<span data-ttu-id="1efd6-212">Oltre all'autenticazione, nell'esercitazione verranno utilizzati anche i ruoli per implementare l'autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-212">In addition to authentication, the tutorial will also use roles to implement authorization.</span></span> <span data-ttu-id="1efd6-213">Solo gli utenti aggiunti al ruolo `canEdit` saranno in grado di modificare i dati, ovvero creare, modificare o eliminare i contatti.</span><span class="sxs-lookup"><span data-stu-id="1efd6-213">Only those users you add to the `canEdit` role will be able to change data (create, edit, or delete contacts).</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="1efd6-214">Le applicazioni Windows Live accettano solo un URL attivo per un sito Web funzionante, pertanto non è possibile utilizzare un URL del sito Web locale per il test degli accessi.</span><span class="sxs-lookup"><span data-stu-id="1efd6-214">Windows Live applications only accept a live URL for a working website, so you cannot use a local website URL for testing logins.</span></span>

<span data-ttu-id="1efd6-215">La procedura seguente consente di aggiungere un provider di autenticazione Google.</span><span class="sxs-lookup"><span data-stu-id="1efd6-215">The following steps will allow you to add a Google authentication provider.</span></span>

1. <span data-ttu-id="1efd6-216">Aprire il file *Di avvio\_dell'app, Startup.Auth.cs.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-216">Open the *App\_Start\Startup.Auth.cs* file.</span></span>
2. <span data-ttu-id="1efd6-217">Rimuovere i caratteri di commento dal metodo `app.UseGoogleAuthentication()` in modo da ottenere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="1efd6-217">Remove the comment characters from the `app.UseGoogleAuthentication()` method so that the method appears as follows:</span></span> 

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample5.cs)]
3. <span data-ttu-id="1efd6-218">Passare a [Google Developers Console](https://console.developers.google.com/).</span><span class="sxs-lookup"><span data-stu-id="1efd6-218">Navigate to the [Google Developers Console](https://console.developers.google.com/).</span></span> <span data-ttu-id="1efd6-219">Sarà necessario eseguire l'accesso con l'account di posta elettronica per sviluppatori di Google (gmail.com).</span><span class="sxs-lookup"><span data-stu-id="1efd6-219">You will also need to sign-in with your Google developer email account (gmail.com).</span></span> <span data-ttu-id="1efd6-220">Se non si dispone di un account Google, selezionare il collegamento **Crea un account** .</span><span class="sxs-lookup"><span data-stu-id="1efd6-220">If you do not have a Google account, select the **Create an account** link.</span></span>   
   <span data-ttu-id="1efd6-221">Verrà quindi visualizzata la pagina **Google Developers Console**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-221">Next, you'll see the **Google Developers Console**.</span></span>   
    <span data-ttu-id="1efd6-222">![Google Developers Console](checkout-and-payment-with-paypal/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="1efd6-222">![Google Developers Console](checkout-and-payment-with-paypal/_static/image8.png)</span></span>
4. <span data-ttu-id="1efd6-223">Fare clic sul pulsante **Crea progetto** e immettere un nome e un ID del progetto (è possibile utilizzare i valori predefiniti).</span><span class="sxs-lookup"><span data-stu-id="1efd6-223">Click the **Create Project** button and enter a project name and ID (you can use the default values).</span></span> <span data-ttu-id="1efd6-224">Quindi, fare clic sulla **casella di controllo dell'accordo** e sul pulsante **Crea.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-224">Then, click the **agreement checkbox** and the **Create** button.</span></span>  

    ![Google - Nuovo progetto](checkout-and-payment-with-paypal/_static/image9.png)

   <span data-ttu-id="1efd6-226">In pochi secondi verrà creato il nuovo progetto e il browser visualizzerà la pagina dei nuovi progetti.</span><span class="sxs-lookup"><span data-stu-id="1efd6-226">In a few seconds the new project will be created and your browser will display the new projects page.</span></span>
5. <span data-ttu-id="1efd6-227">Nella scheda sinistra fare clic su \*\* &amp; Autenticazione API\*\*, quindi su **Credenziali**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-227">In the left tab, click **APIs &amp; auth**, and then click **Credentials**.</span></span>
6. <span data-ttu-id="1efd6-228">Fare clic su **Crea nuovo ID client** in **OAuth**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-228">Click the **Create New Client ID** under **OAuth**.</span></span>   
   <span data-ttu-id="1efd6-229">Verrà visualizzata la finestra di dialogo **Create Client ID** .</span><span class="sxs-lookup"><span data-stu-id="1efd6-229">The **Create Client ID** dialog will be displayed.</span></span>   
    <span data-ttu-id="1efd6-230">![Google - creare ID Client](checkout-and-payment-with-paypal/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="1efd6-230">![Google - Create Client ID](checkout-and-payment-with-paypal/_static/image10.png)</span></span>
7. <span data-ttu-id="1efd6-231">Nella finestra di dialogo **Crea ID client** mantenere **l'applicazione Web** predefinita per il tipo di applicazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-231">In the **Create Client ID** dialog, keep the default **Web application** for the application type.</span></span>
8. <span data-ttu-id="1efd6-232">Impostare **Origini JavaScript autorizzate** sull'URL SSL usato`https://localhost:44300/` in precedenza in questa esercitazione (a meno che non siano stati creati altri progetti SSL).</span><span class="sxs-lookup"><span data-stu-id="1efd6-232">Set the **Authorized JavaScript Origins** to the SSL URL you used earlier in this tutorial (`https://localhost:44300/` unless you've created other SSL projects).</span></span>   
   <span data-ttu-id="1efd6-233">Questo URL rappresenta l'origine dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-233">This URL is the origin for your application.</span></span> <span data-ttu-id="1efd6-234">Per questo esempio, sarà necessario immettere solo l'URL di test localhost.</span><span class="sxs-lookup"><span data-stu-id="1efd6-234">For this sample, you will only enter the localhost test URL.</span></span> <span data-ttu-id="1efd6-235">Tuttavia, è possibile immettere più URL per tenere conto di localhost e produzione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-235">However, you can enter multiple URLs to account for localhost and production.</span></span>
9. <span data-ttu-id="1efd6-236">Per **Authorized Redirect URI** immettere le impostazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="1efd6-236">Set the **Authorized Redirect URI** to the following:</span></span> 

    [!code-html[Main](checkout-and-payment-with-paypal/samples/sample6.html)]

   <span data-ttu-id="1efd6-237">Questo valore è l'URI che verrà usato da ASP.NET OAuth per comunicare con il server OAuth di Google.</span><span class="sxs-lookup"><span data-stu-id="1efd6-237">This value is the URI that ASP.NET OAuth users to communicate with the google OAuth server.</span></span> <span data-ttu-id="1efd6-238">Ricorda l'URL SSL `https://localhost:44300/` che hai utilizzato sopra (a meno che tu non abbia creato altri progetti SSL).</span><span class="sxs-lookup"><span data-stu-id="1efd6-238">Remember the SSL URL you used above (    `https://localhost:44300/` unless you've created other SSL projects).</span></span>
10. <span data-ttu-id="1efd6-239">Fare clic sul pulsante **Crea ID client.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-239">Click the **Create Client ID** button.</span></span>
11. <span data-ttu-id="1efd6-240">Nel menu a sinistra della Console per sviluppatori Google, fai clic sulla voce di menu **della schermata Consenso,** quindi imposta il tuo indirizzo email e il nome del prodotto.</span><span class="sxs-lookup"><span data-stu-id="1efd6-240">On the left menu of the Google Developers Console, click the **Consent screen** menu item, then set your email address and product name.</span></span> <span data-ttu-id="1efd6-241">Una volta completato il modulo, fare clic su **Salva**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-241">When you have completed the form, click **Save**.</span></span>
12. <span data-ttu-id="1efd6-242">Fai clic sulla voce di menu **API,** scorri verso il basso e fai clic sul pulsante **Off** accanto all'API **di Google.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-242">Click the **APIs** menu item, scroll down and click the **off** button next to **Google+ API**.</span></span>   
    <span data-ttu-id="1efd6-243">L'accettazione di questa opzione consente di abilitare l'API di Google.</span><span class="sxs-lookup"><span data-stu-id="1efd6-243">Accepting this option will enable the Google+ API.</span></span>
13. <span data-ttu-id="1efd6-244">È inoltre necessario aggiornare il pacchetto Microsoft.Owin NuGet alla versione 3.0.0.You must also update the **Microsoft.Owin** NuGet package to version 3.0.0.</span><span class="sxs-lookup"><span data-stu-id="1efd6-244">You must also update the **Microsoft.Owin** NuGet package to version 3.0.0.</span></span>   
    <span data-ttu-id="1efd6-245">Dal menu **Strumenti** , selezionare **NuGet Gestione pacchetti** e quindi selezionare Gestisci pacchetti **NuGet per soluzione**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-245">From the **Tools** menu, select **NuGet Package Manager** and then select **Manage NuGet Packages for Solution**.</span></span>  
    <span data-ttu-id="1efd6-246">Nella finestra **Gestisci pacchetti NuGet** individuare e aggiornare il pacchetto **Microsoft.Owin** alla versione 3.0.0.</span><span class="sxs-lookup"><span data-stu-id="1efd6-246">From the **Manage NuGet Packages** window, find and update the **Microsoft.Owin** package to version 3.0.0.</span></span>
14. <span data-ttu-id="1efd6-247">In Visual Studio `UseGoogleAuthentication` aggiornare il metodo della pagina *Startup.Auth.cs* copiando e incollando l'ID **client** e il **segreto client** nel metodo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-247">In Visual Studio, update the `UseGoogleAuthentication` method of the *Startup.Auth.cs* page by copying and pasting the **Client ID** and **Client Secret** into the method.</span></span> <span data-ttu-id="1efd6-248">I valori **ID client** e **Segreto client** illustrati di seguito sono esempi e non funzioneranno.</span><span class="sxs-lookup"><span data-stu-id="1efd6-248">The **Client ID** and **Client Secret** values shown below are samples and will not work.</span></span> 

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample7.cs?highlight=64-65)]
15. <span data-ttu-id="1efd6-249">Per compilare ed eseguire l'applicazione, premere **CTRL e F5.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-249">Press **CTRL+F5** to build and run the application.</span></span> <span data-ttu-id="1efd6-250">Fare clic sul collegamento **Accedi** .</span><span class="sxs-lookup"><span data-stu-id="1efd6-250">Click the **Log in** link.</span></span>
16. <span data-ttu-id="1efd6-251">In **Utilizzare un altro servizio per accedere,** fai clic su **Google**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-251">Under **Use another service to log in**, click **Google**.</span></span>  
    <span data-ttu-id="1efd6-252">![Accesso](checkout-and-payment-with-paypal/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="1efd6-252">![Log in](checkout-and-payment-with-paypal/_static/image11.png)</span></span>
17. <span data-ttu-id="1efd6-253">Se hai bisogno di inserire le tue credenziali, sarai reindirizzato al sito di Google dove inserisci le tue credenziali.</span><span class="sxs-lookup"><span data-stu-id="1efd6-253">If you need to enter your credentials, you will be redirected to the google site where you will enter your credentials.</span></span>  
    ![Google - accesso](checkout-and-payment-with-paypal/_static/image12.png)
18. <span data-ttu-id="1efd6-255">Dopo aver immesso le credenziali, verrà richiesto di concedere le autorizzazioni per l'applicazione Web appena creata.</span><span class="sxs-lookup"><span data-stu-id="1efd6-255">After you enter your credentials, you will be prompted to give permissions to the web application you just created.</span></span>  
    ![Account del servizio di progetto predefinito](checkout-and-payment-with-paypal/_static/image13.png)
19. <span data-ttu-id="1efd6-257">Fare clic su **Accetta**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-257">Click **Accept**.</span></span> <span data-ttu-id="1efd6-258">Ora sarai reindirizzato alla pagina **Register** dell'applicazione **WingtipToys** dove potrai registrare il tuo account Google.</span><span class="sxs-lookup"><span data-stu-id="1efd6-258">You will now be redirected back to the **Register** page of the **WingtipToys** application where you can register your Google account.</span></span>  
    <span data-ttu-id="1efd6-259">![Registrare con l'Account Google](checkout-and-payment-with-paypal/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="1efd6-259">![Register with your Google Account](checkout-and-payment-with-paypal/_static/image14.png)</span></span>
20. <span data-ttu-id="1efd6-260">Sarà possibile modificare il nome di registrazione dell'indirizzo di posta elettronica locale usato per l'account Gmail, anche se in generale è preferibile mantenere l'alias di posta elettronica predefinito, ovvero quello usato per l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-260">You have the option of changing the local email registration name used for your Gmail account, but you generally want to keep the default email alias (that is, the one you used for authentication).</span></span> <span data-ttu-id="1efd6-261">Fare clic su **Accedi** come mostrato sopra.</span><span class="sxs-lookup"><span data-stu-id="1efd6-261">Click **Log in** as shown above.</span></span>

### <a name="modifying-login-functionality"></a><span data-ttu-id="1efd6-262">Modifica della funzionalità di accesso</span><span class="sxs-lookup"><span data-stu-id="1efd6-262">Modifying Login Functionality</span></span>

<span data-ttu-id="1efd6-263">Come accennato in precedenza in questa serie di esercitazioni, gran parte della funzionalità di registrazione utente è stata inclusa nel modello Web Form ASP.NET per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="1efd6-263">As previously mentioned in this tutorial series, much of the user registration functionality has been included in the ASP.NET Web Forms template by default.</span></span> <span data-ttu-id="1efd6-264">A questo punto si modificheranno le pagine predefinite `MigrateCart` *Login.aspx* e *Register.aspx* per chiamare il metodo .</span><span class="sxs-lookup"><span data-stu-id="1efd6-264">Now you will modify the default *Login.aspx* and *Register.aspx* pages to call the `MigrateCart` method.</span></span> <span data-ttu-id="1efd6-265">Il `MigrateCart` metodo associa un utente appena connesso a un carrello acquisti anonimo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-265">The `MigrateCart` method associates a newly logged in user with an anonymous shopping cart.</span></span> <span data-ttu-id="1efd6-266">Associando l'utente e il carrello, l'applicazione di esempio Wingtip Toys sarà in grado di mantenere il carrello dell'utente tra una visita e l'altra.</span><span class="sxs-lookup"><span data-stu-id="1efd6-266">By associating the user and shopping cart, the Wingtip Toys sample application will be able to maintain the shopping cart of the user between visits.</span></span>

1. <span data-ttu-id="1efd6-267">In **Esplora soluzioni**individuare e aprire la cartella *Account.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-267">In **Solution Explorer**, find and open the *Account* folder.</span></span>
2. <span data-ttu-id="1efd6-268">Modificare la pagina code-behind denominata *Login.aspx.cs* per includere il codice evidenziato in giallo, in modo che venga visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-268">Modify the code-behind page named *Login.aspx.cs* to include the code highlighted in yellow, so that it appears as follows:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample8.cs?highlight=41-43)]
3. <span data-ttu-id="1efd6-269">Salvare il file *di Login.aspx.cs.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-269">Save the *Login.aspx.cs* file.</span></span>

<span data-ttu-id="1efd6-270">Per il momento, è possibile ignorare l'avviso che non esiste alcuna definizione per il `MigrateCart` metodo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-270">For now, you can ignore the warning that there is no definition for the `MigrateCart` method.</span></span> <span data-ttu-id="1efd6-271">Si aggiungerà un po 'più avanti in questo tutorial.</span><span class="sxs-lookup"><span data-stu-id="1efd6-271">You will be adding it a bit later in this tutorial.</span></span>

<span data-ttu-id="1efd6-272">Il *Login.aspx.cs* file code-behind supporta un metodo LogIn.The code-behind file supports a LogIn method.</span><span class="sxs-lookup"><span data-stu-id="1efd6-272">The *Login.aspx.cs* code-behind file supports a LogIn method.</span></span> <span data-ttu-id="1efd6-273">Esaminando la pagina Login.aspx, si noterà che questa pagina include un pulsante `LogIn` "Accedi" che quando si fa clic attiva il gestore nel code-behind.</span><span class="sxs-lookup"><span data-stu-id="1efd6-273">By inspecting the Login.aspx page, you'll see that this page includes a "Log in" button that when click triggers the `LogIn` handler on the code-behind.</span></span>

<span data-ttu-id="1efd6-274">Quando `Login` viene chiamato il metodo sul *Login.aspx.cs,* viene `usersShoppingCart` creata una nuova istanza del carrello.</span><span class="sxs-lookup"><span data-stu-id="1efd6-274">When the `Login` method on the *Login.aspx.cs* is called, a new instance of the shopping cart named `usersShoppingCart` is created.</span></span> <span data-ttu-id="1efd6-275">L'ID del carrello (un GUID) viene `cartId` recuperato e impostato sulla variabile.</span><span class="sxs-lookup"><span data-stu-id="1efd6-275">The ID of the shopping cart (a GUID) is retrieved and set to the `cartId` variable.</span></span> <span data-ttu-id="1efd6-276">Quindi, `MigrateCart` viene chiamato il metodo `cartId` , passando sia il e il nome dell'utente connesso a questo metodo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-276">Then, the `MigrateCart` method is called, passing both the `cartId` and the name of the logged-in user to this method.</span></span> <span data-ttu-id="1efd6-277">Quando viene eseguita la migrazione del carrello, il GUID utilizzato per identificare il carrello anonimo viene sostituito con il nome utente.</span><span class="sxs-lookup"><span data-stu-id="1efd6-277">When the shopping cart is migrated, the GUID used to identify the anonymous shopping cart is replaced with the user name.</span></span>

<span data-ttu-id="1efd6-278">Oltre a modificare *il* Login.aspx.cs file code-behind per eseguire la migrazione del carrello quando l'utente esegue l'accesso, è necessario modificare anche il *file code-behind Register.aspx.cs* per eseguire la migrazione del carrello quando l'utente crea un nuovo account ed esegue l'accesso.</span><span class="sxs-lookup"><span data-stu-id="1efd6-278">In addition to modifying the *Login.aspx.cs* code-behind file to migrate the shopping cart when the user logs in, you must also modify the *Register.aspx.cs code-behind file* to migrate the shopping cart when the user creates a new account and logs in.</span></span>

1. <span data-ttu-id="1efd6-279">Nella cartella *Account* aprire il file code-behind denominato *Register.aspx.cs*.</span><span class="sxs-lookup"><span data-stu-id="1efd6-279">In the *Account* folder, open the code-behind file named *Register.aspx.cs*.</span></span>
2. <span data-ttu-id="1efd6-280">Modificare il file code-behind includendo il codice in giallo, in modo che venga visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-280">Modify the code-behind file by including the code in yellow, so that it appears as follows:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample9.cs?highlight=28-32)]
3. <span data-ttu-id="1efd6-281">Salvare il file *Register.aspx.cs.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-281">Save the *Register.aspx.cs* file.</span></span> <span data-ttu-id="1efd6-282">Ancora una volta, ignorare `MigrateCart` l'avviso relativo al metodo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-282">Once again, ignore the warning about the `MigrateCart` method.</span></span>

<span data-ttu-id="1efd6-283">Si noti che il `CreateUser_Click` codice utilizzato nel gestore eventi `LogIn` è molto simile al codice utilizzato nel metodo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-283">Notice that the code you used in the `CreateUser_Click` event handler is very similar to the code you used in the `LogIn` method.</span></span> <span data-ttu-id="1efd6-284">Quando l'utente si connette o accede al `MigrateCart` sito, verrà effettuata una chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-284">When the user registers or logs in to the site, a call to the `MigrateCart` method will be made.</span></span>

## <a name="migrating-the-shopping-cart"></a><span data-ttu-id="1efd6-285">Migrazione del carrello</span><span class="sxs-lookup"><span data-stu-id="1efd6-285">Migrating the Shopping Cart</span></span>

<span data-ttu-id="1efd6-286">Dopo aver aggiornato il processo di accesso e registrazione, è possibile aggiungere `MigrateCart` il codice per eseguire la migrazione del carrello utilizzando il metodo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-286">Now that you have the log-in and registration process updated, you can add the code to migrate the shopping cart using the `MigrateCart` method.</span></span>

1. <span data-ttu-id="1efd6-287">In **Esplora soluzioni**individuare la cartella *Logic* e aprire il file di classe *ShoppingCartActions.cs.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-287">In **Solution Explorer**, find the *Logic* folder and open the *ShoppingCartActions.cs* class file.</span></span>
2. <span data-ttu-id="1efd6-288">Aggiungere il codice evidenziato in giallo al codice esistente nel file *di ShoppingCartActions.cs,* in modo che il codice nel file *di ShoppingCartActions.cs* venga visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-288">Add the code highlighted in yellow to the existing code in the *ShoppingCartActions.cs* file, so that the code in the *ShoppingCartActions.cs* file appears as follows:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample10.cs?highlight=215-224)]

<span data-ttu-id="1efd6-289">Il `MigrateCart` metodo utilizza il cartId esistente per trovare il carrello dell'utente.</span><span class="sxs-lookup"><span data-stu-id="1efd6-289">The `MigrateCart` method uses the existing cartId to find the shopping cart of the user.</span></span> <span data-ttu-id="1efd6-290">Successivamente, il codice scorre in ciclo tutti gli `CartId` elementi del carrello e sostituisce la proprietà (come specificato dallo `CartItem` schema) con il nome utente connesso.</span><span class="sxs-lookup"><span data-stu-id="1efd6-290">Next, the code loops through all the shopping cart items and replaces the `CartId` property (as specified by the `CartItem` schema) with the logged-in user name.</span></span>

### <a name="updating-the-database-connection"></a><span data-ttu-id="1efd6-291">Aggiornamento della connessione al database</span><span class="sxs-lookup"><span data-stu-id="1efd6-291">Updating the Database Connection</span></span>

<span data-ttu-id="1efd6-292">Se si segue questa esercitazione utilizzando l'applicazione di esempio Wingtip Toys **predefinita,** è necessario ricreare il database delle appartenenze predefinito.</span><span class="sxs-lookup"><span data-stu-id="1efd6-292">If you are following this tutorial using the **prebuilt** Wingtip Toys sample application, you must recreate the default membership database.</span></span> <span data-ttu-id="1efd6-293">Modificando la stringa di connessione predefinita, il database delle appartenenze verrà creato alla successiva esecuzione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-293">By modifying the default connection string, the membership database will be created the next time the application runs.</span></span>

1. <span data-ttu-id="1efd6-294">Aprire il file *Web.config* nella radice del progetto.</span><span class="sxs-lookup"><span data-stu-id="1efd6-294">Open the *Web.config* file at the root of the project.</span></span>
2. <span data-ttu-id="1efd6-295">Aggiornare la stringa di connessione predefinita in modo che venga visualizzata come segue:Update the default connection string so that it appears as follows:</span><span class="sxs-lookup"><span data-stu-id="1efd6-295">Update the default connection string so that it appears as follows:</span></span>   

    [!code-xml[Main](checkout-and-payment-with-paypal/samples/sample11.xml)]

<a id="PayPalWebForms"></a>
## <a name="integrating-paypal"></a><span data-ttu-id="1efd6-296">Integrazione di PayPal</span><span class="sxs-lookup"><span data-stu-id="1efd6-296">Integrating PayPal</span></span>

<span data-ttu-id="1efd6-297">PayPal è una piattaforma di fatturazione basata sul web che accetta pagamenti da parte di commercianti online.</span><span class="sxs-lookup"><span data-stu-id="1efd6-297">PayPal is a web-based billing platform that accepts payments by online merchants.</span></span> <span data-ttu-id="1efd6-298">Questa esercitazione spiega quindi come integrare la funzionalità di check-in rapida di PayPal nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-298">This tutorial next explains how to integrate PayPal's Express Checkout functionality into your application.</span></span> <span data-ttu-id="1efd6-299">Express Checkout consente ai tuoi clienti di utilizzare PayPal per pagare gli articoli che hanno aggiunto al carrello.</span><span class="sxs-lookup"><span data-stu-id="1efd6-299">Express Checkout allows your customers to use PayPal to pay for the items they have added to their shopping cart.</span></span>

### <a name="create-paypal-test-accounts"></a><span data-ttu-id="1efd6-300">Creazione di account di test PayPal</span><span class="sxs-lookup"><span data-stu-id="1efd6-300">Create PayPal Test Accounts</span></span>

<span data-ttu-id="1efd6-301">Per utilizzare l'ambiente di test PayPal, è necessario creare e verificare un account di test per sviluppatori.</span><span class="sxs-lookup"><span data-stu-id="1efd6-301">To use the PayPal testing environment, you must create and verify a developer test account.</span></span> <span data-ttu-id="1efd6-302">Utilizzerai l'account di test per sviluppatori per creare un account di test dell'acquirente e un account di test del venditore.</span><span class="sxs-lookup"><span data-stu-id="1efd6-302">You will use the developer test account to create a buyer test account and a seller test account.</span></span> <span data-ttu-id="1efd6-303">Le credenziali dell'account di test per sviluppatori consentiranno inoltre all'applicazione di esempio Wingtip Toys di accedere all'ambiente di test PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-303">The developer test account credentials also will allow the Wingtip Toys sample application to access the PayPal testing environment.</span></span>

1. <span data-ttu-id="1efd6-304">In un browser, accedi al sito di test per sviluppatori PayPal:</span><span class="sxs-lookup"><span data-stu-id="1efd6-304">In a browser, navigate to the PayPal developer testing site:</span></span>   
    [https://developer.paypal.com](https://developer.paypal.com/)
2. <span data-ttu-id="1efd6-305">Se non hai un account sviluppatore PayPal, crea un nuovo account facendo clic su **Iscriviti**e seguendo la procedura di iscrizione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-305">If you don't have a PayPal developer account, create a new account by clicking **Sign Up**and following the sign up steps.</span></span> <span data-ttu-id="1efd6-306">Se si dispone di un account sviluppatore PayPal esistente, accedere facendo clic su **Accedi**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-306">If you have an existing PayPal developer account, sign in by clicking **Log In**.</span></span> <span data-ttu-id="1efd6-307">Avrai bisogno del tuo account sviluppatore PayPal per testare l'applicazione di esempio Wingtip Toys più avanti in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-307">You will need your PayPal developer account to test the Wingtip Toys sample application later in this tutorial.</span></span>
3. <span data-ttu-id="1efd6-308">Se ti sei appena registrato per il tuo account sviluppatore PayPal, potrebbe essere necessario verificare il tuo account sviluppatore PayPal con PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-308">If you have just signed up for your PayPal developer account, you may need to verify your PayPal developer account with PayPal.</span></span> <span data-ttu-id="1efd6-309">Puoi verificare il tuo account seguendo la procedura che PayPal ha inviato al tuo account email.</span><span class="sxs-lookup"><span data-stu-id="1efd6-309">You can verify your account by following the steps that PayPal sent to your email account.</span></span> <span data-ttu-id="1efd6-310">Dopo aver verificato il tuo account sviluppatore PayPal, accedi nuovamente al sito di test per sviluppatori PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-310">Once you have verified your PayPal developer account, log back into the PayPal developer testing site.</span></span>
4. <span data-ttu-id="1efd6-311">Dopo aver effettuato l'accesso al sito per sviluppatori PayPal con il tuo account sviluppatore PayPal, devi creare un account di prova dell'acquirente PayPal se non ne hai già uno.</span><span class="sxs-lookup"><span data-stu-id="1efd6-311">After you are logged in to the PayPal developer site with your PayPal developer account you need to create a PayPal buyer test account if you don't already have one.</span></span> <span data-ttu-id="1efd6-312">Per creare un account di test dell'acquirente, nel sito PayPal fare clic sulla scheda **Applicazioni** e quindi su **Account sandbox**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-312">To create a buyer test account, on the PayPal site click the **Applications** tab and then click **Sandbox accounts**.</span></span>   
 <span data-ttu-id="1efd6-313">Viene visualizzata la pagina **Account di test sandbox.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-313">The **Sandbox test accounts** page is shown.</span></span>   

    > [!NOTE] 
    > 
    > <span data-ttu-id="1efd6-314">Il sito PayPal Developer fornisce già un account di test commerciante.</span><span class="sxs-lookup"><span data-stu-id="1efd6-314">The PayPal Developer site already provides a merchant test account.</span></span>

    ![Checkout e pagamento con PayPal - Conti di prova sandbox](checkout-and-payment-with-paypal/_static/image15.png)
5. <span data-ttu-id="1efd6-316">Nella pagina Account di test sandbox fare clic su **Crea account.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-316">On the Sandbox test accounts page, click **Create Account**.</span></span>
6. <span data-ttu-id="1efd6-317">Nella pagina **Crea account** di prova scegliere l'indirizzo di posta elettronica e la password dell'account di test dell'acquirente a scelta.</span><span class="sxs-lookup"><span data-stu-id="1efd6-317">On the **Create test account** page choose a buyer test account email and password of your choice.</span></span>   

    > [!NOTE] 
    > 
    > <span data-ttu-id="1efd6-318">Avrete bisogno degli indirizzi e-mail dell'acquirente e la password per testare l'applicazione di esempio Wingtip Toys alla fine di questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-318">You will need the buyer email addresses and password to test the Wingtip Toys sample application at the end of this tutorial.</span></span>

    ![Checkout e pagamento con PayPal - Conti di prova sandbox](checkout-and-payment-with-paypal/_static/image16.png)
7. <span data-ttu-id="1efd6-320">Crea l'account di test dell'acquirente facendo clic sul pulsante **Crea account.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-320">Create the buyer test account by clicking the **Create Account** button.</span></span>  
 <span data-ttu-id="1efd6-321">Viene visualizzata la pagina **Account di test sandbox.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-321">The **Sandbox Test accounts** page is displayed.</span></span> 

    ![Checkout e pagamento con PayPal - Conti PayPal](checkout-and-payment-with-paypal/_static/image17.png)
8. <span data-ttu-id="1efd6-323">Nella pagina **Account di test sandbox** fare clic sull'account di posta elettronica del **facilitatore.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-323">On the **Sandbox test accounts** page, click the **facilitator** email account.</span></span>  
    <span data-ttu-id="1efd6-324">**Vengono** visualizzate le opzioni Profilo e **Notifica.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-324">**Profile** and **Notification** options appear.</span></span>
9. <span data-ttu-id="1efd6-325">Seleziona l'opzione **Profilo,** quindi fai clic su **Credenziali API** per visualizzare le credenziali API per l'account di test del commerciante.</span><span class="sxs-lookup"><span data-stu-id="1efd6-325">Select the **Profile** option, then click **API credentials** to view your API credentials for the merchant test account.</span></span>
10. <span data-ttu-id="1efd6-326">Copiare le credenziali dell'API TEST nel blocco note.</span><span class="sxs-lookup"><span data-stu-id="1efd6-326">Copy the TEST API credentials to notepad.</span></span>

<span data-ttu-id="1efd6-327">Per effettuare chiamate API dall'applicazione di esempio Wingtip Toys all'ambiente di testing PayPal sono necessarie le credenziali DELL'API TEST classica visualizzate (nome utente, password e firma).</span><span class="sxs-lookup"><span data-stu-id="1efd6-327">You will need your displayed Classic TEST API credentials (Username, Password, and Signature) to make API calls from the Wingtip Toys sample application to the PayPal testing environment.</span></span> <span data-ttu-id="1efd6-328">Le credenziali verranno aggiunte nel passaggio successivo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-328">You will add the credentials in the next step.</span></span>

### <a name="add-paypal-class-and-api-credentials"></a><span data-ttu-id="1efd6-329">Aggiungere le credenziali API e classe PayPalAdd PayPal Class and API Credentials</span><span class="sxs-lookup"><span data-stu-id="1efd6-329">Add PayPal Class and API Credentials</span></span>

<span data-ttu-id="1efd6-330">Inserirai la maggior parte del codice PayPal in un'unica classe.</span><span class="sxs-lookup"><span data-stu-id="1efd6-330">You will place the majority of the PayPal code into a single class.</span></span> <span data-ttu-id="1efd6-331">Questa classe contiene i metodi utilizzati per comunicare con PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-331">This class contains the methods used to communicate with PayPal.</span></span> <span data-ttu-id="1efd6-332">Inoltre, aggiungerai le tue credenziali PayPal a questa classe.</span><span class="sxs-lookup"><span data-stu-id="1efd6-332">Also, you will add your PayPal credentials to this class.</span></span>

1. <span data-ttu-id="1efd6-333">Nell'applicazione di esempio Wingtip Toys in Visual Studio fare clic con il pulsante destro del mouse sulla cartella **Logic** , quindi **scegliere Aggiungi**  - &gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-333">In the Wingtip Toys sample application within Visual Studio, right-click the **Logic** folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="1efd6-334">La finestra di dialogo **Aggiungi nuovo elemento** viene visualizzata.</span><span class="sxs-lookup"><span data-stu-id="1efd6-334">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="1efd6-335">Nel riquadro **Installato a** sinistra del riquadro Installato di Visual **C,** selezionare **Codice**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-335">Under **Visual C#** from the **Installed** pane on the left, select **Code**.</span></span>
3. <span data-ttu-id="1efd6-336">Nel riquadro centrale selezionare **Classe**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-336">From the middle pane, select **Class**.</span></span> <span data-ttu-id="1efd6-337">Denominare questa nuova classe **PayPalFunctions.cs**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-337">Name this new class **PayPalFunctions.cs**.</span></span>
4. <span data-ttu-id="1efd6-338">Fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-338">Click **Add**.</span></span>  
   <span data-ttu-id="1efd6-339">Il nuovo file di classe viene visualizzato nell'editor.</span><span class="sxs-lookup"><span data-stu-id="1efd6-339">The new class file is displayed in the editor.</span></span>
5. <span data-ttu-id="1efd6-340">Sostituire il codice predefinito con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="1efd6-340">Replace the default code with the following code:</span></span>  

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample12.cs)]
6. <span data-ttu-id="1efd6-341">Aggiungere le credenziali dell'API Commerciante (nome utente, password e firma) visualizzate in precedenza in questa esercitazione in modo da poter effettuare chiamate di funzione all'ambiente di test PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-341">Add the Merchant API credentials (Username, Password, and Signature) that you displayed earlier in this tutorial so that you can make function calls to the PayPal testing environment.</span></span>  

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample13.cs)]

> [!NOTE] 
> 
> <span data-ttu-id="1efd6-342">In questa applicazione di esempio si aggiungono semplicemente le credenziali a un file di C .</span><span class="sxs-lookup"><span data-stu-id="1efd6-342">In this sample application you are simply adding credentials to a C# file (.cs).</span></span> <span data-ttu-id="1efd6-343">Tuttavia, in una soluzione implementata, è consigliabile crittografare le credenziali in un file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-343">However, in a implemented solution, you should consider encrypting your credentials in a configuration file.</span></span>

<span data-ttu-id="1efd6-344">La classe NVPAPICaller contiene la maggior parte delle funzionalità Di PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-344">The NVPAPICaller class contains the majority of the PayPal functionality.</span></span> <span data-ttu-id="1efd6-345">Il codice nella classe fornisce i metodi necessari per effettuare un acquisto di prova dall'ambiente di test PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-345">The code in the class provides the methods needed to make a test purchase from the PayPal testing environment.</span></span> <span data-ttu-id="1efd6-346">Per effettuare acquisti vengono utilizzate le seguenti tre funzioni PayPal:</span><span class="sxs-lookup"><span data-stu-id="1efd6-346">The following three PayPal functions are used to make purchases:</span></span>

- <span data-ttu-id="1efd6-347">Funzione `SetExpressCheckout`</span><span class="sxs-lookup"><span data-stu-id="1efd6-347">`SetExpressCheckout` function</span></span>
- <span data-ttu-id="1efd6-348">Funzione `GetExpressCheckoutDetails`</span><span class="sxs-lookup"><span data-stu-id="1efd6-348">`GetExpressCheckoutDetails` function</span></span>
- <span data-ttu-id="1efd6-349">Funzione `DoExpressCheckoutPayment`</span><span class="sxs-lookup"><span data-stu-id="1efd6-349">`DoExpressCheckoutPayment` function</span></span>

<span data-ttu-id="1efd6-350">Il `ShortcutExpressCheckout` metodo raccoglie le informazioni di acquisto di prova `SetExpressCheckout` e i dettagli del prodotto dal carrello e chiama la funzione PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-350">The `ShortcutExpressCheckout` method collects the test purchase information and product details from the shopping cart and calls the `SetExpressCheckout` PayPal function.</span></span> <span data-ttu-id="1efd6-351">Il `GetCheckoutDetails` metodo conferma i dettagli `GetExpressCheckoutDetails` dell'acquisto e chiama la funzione PayPal prima di effettuare l'acquisto del test.</span><span class="sxs-lookup"><span data-stu-id="1efd6-351">The `GetCheckoutDetails` method confirms purchase details and calls the `GetExpressCheckoutDetails` PayPal function before making the test purchase.</span></span> <span data-ttu-id="1efd6-352">Il `DoCheckoutPayment` metodo completa l'acquisto di test `DoExpressCheckoutPayment` dall'ambiente di test chiamando la funzione PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-352">The `DoCheckoutPayment` method completes the test purchase from the testing environment by calling the `DoExpressCheckoutPayment` PayPal function.</span></span> <span data-ttu-id="1efd6-353">Il codice rimanente supporta i metodi e il processo PayPal, ad esempio la codifica di stringhe, la decodifica di stringhe, l'elaborazione di matrici e la determinazione delle credenziali.</span><span class="sxs-lookup"><span data-stu-id="1efd6-353">The remaining code supports the PayPal methods and process, such as encoding strings, decoding strings, processing arrays, and determining credentials.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="1efd6-354">PayPal consente di includere dettagli di acquisto opzionali in base alle [specifiche API di PayPal.](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&amp;content_ID=developer/e_howto_api_nvp_r_SetExpressCheckout)</span><span class="sxs-lookup"><span data-stu-id="1efd6-354">PayPal allows you to include optional purchase details based on [PayPal's API specification](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&amp;content_ID=developer/e_howto_api_nvp_r_SetExpressCheckout).</span></span> <span data-ttu-id="1efd6-355">Estendendo il codice nell'applicazione di esempio Wingtip Toys, è possibile includere dettagli di localizzazione, descrizioni dei prodotti, imposte, un numero di servizio clienti e molti altri campi facoltativi.</span><span class="sxs-lookup"><span data-stu-id="1efd6-355">By extending the code in the Wingtip Toys sample application, you can include localization details, product descriptions, tax, a customer service number, as well as many other optional fields.</span></span>

<span data-ttu-id="1efd6-356">Si noti che gli URL return e cancel specificati nel metodo **ShortcutExpressCheckout** utilizzano un numero di porta.</span><span class="sxs-lookup"><span data-stu-id="1efd6-356">Notice that the return and cancel URLs that are specified in the **ShortcutExpressCheckout** method use a port number.</span></span>

[!code-html[Main](checkout-and-payment-with-paypal/samples/sample14.html)]

<span data-ttu-id="1efd6-357">Quando Visual Web Developer esegue un progetto Web utilizzando SSL, in genere la porta 44300 viene utilizzata per il server Web.</span><span class="sxs-lookup"><span data-stu-id="1efd6-357">When Visual Web Developer runs a web project using SSL, commonly the port 44300 is used for the web server.</span></span> <span data-ttu-id="1efd6-358">Come illustrato in precedenza, il numero di porta è 44300.</span><span class="sxs-lookup"><span data-stu-id="1efd6-358">As shown above, the port number is 44300.</span></span> <span data-ttu-id="1efd6-359">Quando si esegue l'applicazione, è possibile visualizzare un numero di porta diverso.</span><span class="sxs-lookup"><span data-stu-id="1efd6-359">When you run the application, you could see a different port number.</span></span> <span data-ttu-id="1efd6-360">Il numero di porta deve essere impostato correttamente nel codice in modo da poter eseguire correttamente l'applicazione di esempio Wingtip Toys alla fine di questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-360">Your port number needs to be correctly set in the code so that you can successful run the Wingtip Toys sample application at the end of this tutorial.</span></span> <span data-ttu-id="1efd6-361">Nella sezione successiva di questa esercitazione viene illustrato come recuperare il numero di porta host locale e aggiornare la classe PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-361">The next section of this tutorial explains how to retrieve the local host port number and update the PayPal class.</span></span>

### <a name="update-the-localhost-port-number-in-the-paypal-class"></a><span data-ttu-id="1efd6-362">Aggiornare il numero di porta LocalHost nella classe PayPal</span><span class="sxs-lookup"><span data-stu-id="1efd6-362">Update the LocalHost Port Number in the PayPal Class</span></span>

<span data-ttu-id="1efd6-363">L'applicazione di esempio Wingtip Toys acquista prodotti accedendo al sito di test PayPal e tornando all'istanza locale dell'applicazione di esempio Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="1efd6-363">The Wingtip Toys sample application purchases products by navigating to the PayPal testing site and returning to your local instance of the Wingtip Toys sample application.</span></span> <span data-ttu-id="1efd6-364">Per fare in modo che PayPal torni all'URL corretto, è necessario specificare il numero di porta dell'applicazione di esempio in esecuzione localmente nel codice PayPal indicato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="1efd6-364">In order to have PayPal return to the correct URL, you need to specify the port number of the locally running sample application in the PayPal code mentioned above.</span></span>

1. <span data-ttu-id="1efd6-365">Fare clic con il pulsante destro del mouse sul nome del progetto (**WingtipToys**) in **Esplora soluzioni** e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-365">Right-click the project name (**WingtipToys**) in **Solution Explorer** and select **Properties**.</span></span>
2. <span data-ttu-id="1efd6-366">Nella colonna sinistra, selezionare la scheda **Web.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-366">In the left column, select the **Web** tab.</span></span>
3. <span data-ttu-id="1efd6-367">Recuperare il numero di porta dalla casella **URL progetto.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-367">Retrieve the port number from the **Project Url** box.</span></span>
4. <span data-ttu-id="1efd6-368">Se necessario, `returnURL` aggiornare e `cancelURL` nella`NVPAPICaller`classe PayPal ( ) nel file *PayPalFunctions.cs* per utilizzare il numero di porta dell'applicazione Web:</span><span class="sxs-lookup"><span data-stu-id="1efd6-368">If needed, update the `returnURL` and `cancelURL` in the PayPal class (`NVPAPICaller`) in the *PayPalFunctions.cs* file to use the port number of your web application:</span></span>   

    [!code-html[Main](checkout-and-payment-with-paypal/samples/sample15.html?highlight=1-2)]

<span data-ttu-id="1efd6-369">A questo punto il codice aggiunto corrisponderà alla porta prevista per l'applicazione Web locale.</span><span class="sxs-lookup"><span data-stu-id="1efd6-369">Now the code that you added will match the expected port for your local Web application.</span></span> <span data-ttu-id="1efd6-370">PayPal sarà in grado di tornare all'URL corretto sul computer locale.</span><span class="sxs-lookup"><span data-stu-id="1efd6-370">PayPal will be able to return to the correct URL on your local machine.</span></span>

### <a name="add-the-paypal-checkout-button"></a><span data-ttu-id="1efd6-371">Aggiungere il pulsante PayPal Checkout</span><span class="sxs-lookup"><span data-stu-id="1efd6-371">Add the PayPal Checkout Button</span></span>

<span data-ttu-id="1efd6-372">Ora che le funzioni PayPal principali sono state aggiunte all'applicazione di esempio, è possibile iniziare ad aggiungere il markup e il codice necessari per chiamare queste funzioni.</span><span class="sxs-lookup"><span data-stu-id="1efd6-372">Now that the primary PayPal functions have been added to the sample application, you can begin adding the markup and code needed to call these functions.</span></span> <span data-ttu-id="1efd6-373">In primo luogo, è necessario aggiungere il pulsante di checkout che l'utente vedrà sulla pagina del carrello.</span><span class="sxs-lookup"><span data-stu-id="1efd6-373">First, you must add the checkout button that the user will see on the shopping cart page.</span></span>

1. <span data-ttu-id="1efd6-374">Aprire il file *ShoppingCart.aspx.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-374">Open the *ShoppingCart.aspx* file.</span></span>
2. <span data-ttu-id="1efd6-375">Scorrere fino alla fine del `<!--Checkout Placeholder -->` file e trovare il commento.</span><span class="sxs-lookup"><span data-stu-id="1efd6-375">Scroll to the bottom of the file and find the `<!--Checkout Placeholder -->` comment.</span></span>
3. <span data-ttu-id="1efd6-376">Sostituire il commento `ImageButton` con un controllo in modo che il contrassegno verso l'alto venga sostituito come segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-376">Replace the comment with an `ImageButton` control so that the mark up is replaced as follows:</span></span>  

    [!code-aspx[Main](checkout-and-payment-with-paypal/samples/sample16.aspx)]
4. <span data-ttu-id="1efd6-377">Nel file *ShoppingCart.aspx.cs,* `UpdateBtn_Click` dopo il gestore eventi vicino `CheckOutBtn_Click` alla fine del file, aggiungere il gestore eventi:</span><span class="sxs-lookup"><span data-stu-id="1efd6-377">In the *ShoppingCart.aspx.cs* file, after the `UpdateBtn_Click` event handler near the end of the file, add the `CheckOutBtn_Click` event handler:</span></span>  

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample17.cs)]
5. <span data-ttu-id="1efd6-378">Sempre nel file *ShoppingCart.aspx.cs* aggiungere un `CheckoutBtn`riferimento a , in modo che il pulsante della nuova immagine sia referenziato come segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-378">Also in the *ShoppingCart.aspx.cs* file, add a reference to the `CheckoutBtn`, so that the new image button is referenced as follows:</span></span>  

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample18.cs?highlight=18)]
6. <span data-ttu-id="1efd6-379">Salvare le modifiche apportate sia al file *ShoppingCart.aspx* che al file *ShoppingCart.aspx.cs.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-379">Save your changes to both the *ShoppingCart.aspx* file and the *ShoppingCart.aspx.cs* file.</span></span>
7. <span data-ttu-id="1efd6-380">Dal menu , selezionare **Debug**-&gt;**Build WingtipToys**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-380">From the menu, select **Debug**-&gt;**Build WingtipToys**.</span></span>  
   <span data-ttu-id="1efd6-381">Il progetto verrà ricompilato con il controllo **ImageButton** appena aggiunto.</span><span class="sxs-lookup"><span data-stu-id="1efd6-381">The project will be rebuilt with the newly added **ImageButton** control.</span></span>

### <a name="send-purchase-details-to-paypal"></a><span data-ttu-id="1efd6-382">Invia i dettagli dell'acquisto a PayPal</span><span class="sxs-lookup"><span data-stu-id="1efd6-382">Send Purchase Details to PayPal</span></span>

<span data-ttu-id="1efd6-383">Quando l'utente fa clic sul pulsante **Checkout** nella pagina del carrello della spesa (*ShoppingCart.aspx*), inizierà il processo di acquisto.</span><span class="sxs-lookup"><span data-stu-id="1efd6-383">When the user clicks the **Checkout** button on the shopping cart page (*ShoppingCart.aspx*), they'll begin the purchase process.</span></span> <span data-ttu-id="1efd6-384">Il codice seguente chiama la prima funzione PayPal necessaria per acquistare i prodotti.</span><span class="sxs-lookup"><span data-stu-id="1efd6-384">The following code calls the first PayPal function needed to purchase products.</span></span>

1. <span data-ttu-id="1efd6-385">Dalla cartella *Estrai* aprire il file code-behind denominato *CheckoutStart.aspx.cs*.</span><span class="sxs-lookup"><span data-stu-id="1efd6-385">From the *Checkout* folder, open the code-behind file named *CheckoutStart.aspx.cs*.</span></span>   
   <span data-ttu-id="1efd6-386">Assicurarsi di aprire il file code-behind.</span><span class="sxs-lookup"><span data-stu-id="1efd6-386">Be sure to open the code-behind file.</span></span>
2. <span data-ttu-id="1efd6-387">Sostituire il codice esistente con quello seguente:</span><span class="sxs-lookup"><span data-stu-id="1efd6-387">Replace the existing code with the following:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample19.cs)]

<span data-ttu-id="1efd6-388">Quando l'utente dell'applicazione fa clic sul pulsante **Checkout** nella pagina del carrello, il browser passerà alla pagina *CheckoutStart.aspx.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-388">When the user of the application clicks the **Checkout** button on the shopping cart page, the browser will navigate to the *CheckoutStart.aspx* page.</span></span> <span data-ttu-id="1efd6-389">Quando viene caricata la pagina `ShortcutExpressCheckout` *CheckoutStart.aspx,* viene chiamato il metodo .</span><span class="sxs-lookup"><span data-stu-id="1efd6-389">When the *CheckoutStart.aspx* page loads, the `ShortcutExpressCheckout` method is called.</span></span> <span data-ttu-id="1efd6-390">A questo punto, l'utente viene trasferito al sito Web di test PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-390">At this point, the user is transferred to the PayPal testing web site.</span></span> <span data-ttu-id="1efd6-391">Sul sito PayPal, l'utente immette le proprie credenziali PayPal, esamina i dettagli di acquisto, accetta l'accordo PayPal e torna all'applicazione di esempio Wingtip Toys in cui il `ShortcutExpressCheckout` metodo viene completato.</span><span class="sxs-lookup"><span data-stu-id="1efd6-391">On the PayPal site, the user enters their PayPal credentials, reviews the purchase details, accepts the PayPal agreement and returns to the Wingtip Toys sample application where the `ShortcutExpressCheckout` method completes.</span></span> <span data-ttu-id="1efd6-392">Al `ShortcutExpressCheckout` termine del metodo, l'utente verrà reindirizzato alla pagina `ShortcutExpressCheckout` *CheckoutReview.aspx* specificata nel metodo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-392">When the `ShortcutExpressCheckout` method is complete, it will redirect the user to the *CheckoutReview.aspx* page specified in the `ShortcutExpressCheckout` method.</span></span> <span data-ttu-id="1efd6-393">Ciò consente all'utente di esaminare i dettagli dell'ordine dall'applicazione di esempio Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="1efd6-393">This allows the user to review the order details from within the Wingtip Toys sample application.</span></span>

### <a name="review-order-details"></a><span data-ttu-id="1efd6-394">Revisione dei dettagli dell'ordine</span><span class="sxs-lookup"><span data-stu-id="1efd6-394">Review Order Details</span></span>

<span data-ttu-id="1efd6-395">Dopo il ritorno da PayPal, la pagina *CheckoutReview.aspx* dell'applicazione di esempio Wingtip Toys visualizza i dettagli dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="1efd6-395">After returning from PayPal, the *CheckoutReview.aspx* page of the Wingtip Toys sample application displays the order details.</span></span> <span data-ttu-id="1efd6-396">Questa pagina consente all'utente di esaminare i dettagli dell'ordine prima di acquistare i prodotti.</span><span class="sxs-lookup"><span data-stu-id="1efd6-396">This page allows the user to review the order details before purchasing the products.</span></span> <span data-ttu-id="1efd6-397">La pagina *CheckoutReview.aspx* deve essere creata come segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-397">The *CheckoutReview.aspx* page must be created as follows:</span></span>

1. <span data-ttu-id="1efd6-398">Nella cartella *Checkout* aprire la pagina denominata *CheckoutReview.aspx*.</span><span class="sxs-lookup"><span data-stu-id="1efd6-398">In the *Checkout* folder, open the page named *CheckoutReview.aspx*.</span></span>
2. <span data-ttu-id="1efd6-399">Sostituire il markup esistente con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-399">Replace the existing markup with the following:</span></span>   

    [!code-aspx[Main](checkout-and-payment-with-paypal/samples/sample20.aspx)]
3. <span data-ttu-id="1efd6-400">Aprire la pagina code-behind denominata *CheckoutReview.aspx.cs* e sostituire il codice esistente con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-400">Open the code-behind page named *CheckoutReview.aspx.cs* and replace the existing code with the following:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample21.cs)]

<span data-ttu-id="1efd6-401">Il controllo **DetailsView** viene utilizzato per visualizzare i dettagli dell'ordine restituiti da PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-401">The **DetailsView** control is used to display the order details that have been returned from PayPal.</span></span> <span data-ttu-id="1efd6-402">Inoltre, il codice precedente salva i dettagli dell'ordine `OrderDetail` nel database Wingtip Toys come oggetto.</span><span class="sxs-lookup"><span data-stu-id="1efd6-402">Also, the above code saves the order details to the Wingtip Toys database as an `OrderDetail` object.</span></span> <span data-ttu-id="1efd6-403">Quando l'utente fa clic sul pulsante **Ordine di completamento,** vengono reindirizzati alla pagina *CheckoutComplete.aspx.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-403">When the user clicks on the **Complete Order** button, they are redirected to the *CheckoutComplete.aspx* page.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="1efd6-404">**mancia**</span><span class="sxs-lookup"><span data-stu-id="1efd6-404">**Tip**</span></span>
> 
> <span data-ttu-id="1efd6-405">Nel markup della pagina *CheckoutReview.aspx,* `<ItemStyle>` si noti che il tag viene utilizzato per modificare lo stile degli elementi all'interno del **controllo DetailsView** nella parte inferiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="1efd6-405">In the markup of the *CheckoutReview.aspx* page, notice that the `<ItemStyle>` tag is used to change the style of the items within the **DetailsView** control near the bottom of the page.</span></span> <span data-ttu-id="1efd6-406">Visualizzando la pagina in **visualizzazione Progettazione** (selezionando **Progettazione** nell'angolo inferiore sinistro di Visual Studio), quindi selezionando il controllo **DetailsView** e selezionando lo **smart tag** (l'icona a freccia nella parte superiore destra del controllo), sarà possibile visualizzare le **attività detailsView**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-406">By viewing the page in **Design View** (by selecting **Design** at the lower left corner of Visual Studio), then selecting the **DetailsView** control, and selecting the **Smart Tag** (the arrow icon at the top right of the control), you will be able to see the **DetailsView Tasks**.</span></span>
> 
> ![Checkout e pagamento con PayPal - Modifica campi](checkout-and-payment-with-paypal/_static/image18.png)
> 
> <span data-ttu-id="1efd6-408">Selezionando **Modifica campi**, verrà visualizzata la finestra di dialogo **Campi.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-408">By selecting **Edit Fields**, the **Fields** dialog box will appear.</span></span> <span data-ttu-id="1efd6-409">In questa finestra di dialogo è possibile controllare facilmente le proprietà visive, ad esempio **ItemStyle**, del **controllo DetailsView.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-409">In this dialog box you can easily control the visual properties, such as **ItemStyle**, of the **DetailsView** control.</span></span>
> 
> ![Checkout e pagamento con PayPal - Finestra di dialogo Campi](checkout-and-payment-with-paypal/_static/image19.png)

### <a name="complete-purchase"></a><span data-ttu-id="1efd6-411">Acquisto completo</span><span class="sxs-lookup"><span data-stu-id="1efd6-411">Complete Purchase</span></span>

<span data-ttu-id="1efd6-412">*CheckoutComplete.aspx* pagina effettua l'acquisto da PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-412">*CheckoutComplete.aspx* page makes the purchase from PayPal.</span></span> <span data-ttu-id="1efd6-413">Come accennato in precedenza, l'utente deve fare clic sul pulsante **Ordine di completamento** prima che l'applicazione passerà alla pagina *CheckoutComplete.aspx.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-413">As mentioned above, the user must click on the **Complete Order** button before the application will navigate to the *CheckoutComplete.aspx* page.</span></span>

1. <span data-ttu-id="1efd6-414">Nella cartella *Checkout* aprire la pagina *denominata CheckoutComplete.aspx*.</span><span class="sxs-lookup"><span data-stu-id="1efd6-414">In the *Checkout* folder, open the page named *CheckoutComplete.aspx*.</span></span>
2. <span data-ttu-id="1efd6-415">Sostituire il markup esistente con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-415">Replace the existing markup with the following:</span></span>   

    [!code-aspx[Main](checkout-and-payment-with-paypal/samples/sample22.aspx)]
3. <span data-ttu-id="1efd6-416">Aprire la pagina code-behind denominata *CheckoutComplete.aspx.cs* e sostituire il codice esistente con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-416">Open the code-behind page named *CheckoutComplete.aspx.cs* and replace the existing code with the following:</span></span>   

    [!code-csharp[Main](checkout-and-payment-with-paypal/samples/sample23.cs)]

<span data-ttu-id="1efd6-417">Quando viene caricata la pagina `DoCheckoutPayment` *CheckoutComplete.aspx,* viene chiamato il metodo .</span><span class="sxs-lookup"><span data-stu-id="1efd6-417">When the *CheckoutComplete.aspx* page is loaded, the `DoCheckoutPayment` method is called.</span></span> <span data-ttu-id="1efd6-418">Come accennato `DoCheckoutPayment` in precedenza, il metodo completa l'acquisto dall'ambiente di test PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-418">As mentioned earlier, the `DoCheckoutPayment` method completes the purchase from the PayPal testing environment.</span></span> <span data-ttu-id="1efd6-419">Una volta che PayPal ha completato l'acquisto dell'ordine, `ID` la pagina *CheckoutComplete.aspx* visualizza una transazione di pagamento per l'acquirente.</span><span class="sxs-lookup"><span data-stu-id="1efd6-419">Once PayPal has completed the purchase of the order, the *CheckoutComplete.aspx* page displays a payment transaction `ID` to the purchaser.</span></span>

### <a name="handle-cancel-purchase"></a><span data-ttu-id="1efd6-420">Gestire Annulla acquisto</span><span class="sxs-lookup"><span data-stu-id="1efd6-420">Handle Cancel Purchase</span></span>

<span data-ttu-id="1efd6-421">Se l'utente decide di annullare l'acquisto, verrà indirizzato alla pagina *CheckoutCancel.aspx* in cui verrà visualizzato che l'ordine è stato annullato.</span><span class="sxs-lookup"><span data-stu-id="1efd6-421">If the user decides to cancel the purchase, they will be directed to the *CheckoutCancel.aspx* page where they will see that their order has been cancelled.</span></span>

1. <span data-ttu-id="1efd6-422">Aprire la pagina denominata *CheckoutCancel.aspx* nella cartella *Checkout.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-422">Open the page named *CheckoutCancel.aspx* in the *Checkout* folder.</span></span>
2. <span data-ttu-id="1efd6-423">Sostituire il markup esistente con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-423">Replace the existing markup with the following:</span></span>   

    [!code-aspx[Main](checkout-and-payment-with-paypal/samples/sample24.aspx)]

### <a name="handle-purchase-errors"></a><span data-ttu-id="1efd6-424">Gestire gli errori di acquisto</span><span class="sxs-lookup"><span data-stu-id="1efd6-424">Handle Purchase Errors</span></span>

<span data-ttu-id="1efd6-425">Gli errori durante il processo di acquisto verranno gestiti dalla pagina *CheckoutError.aspx.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-425">Errors during the purchase process will be handled by the *CheckoutError.aspx* page.</span></span> <span data-ttu-id="1efd6-426">Il code-behind della pagina *CheckoutStart.aspx,* la pagina *CheckoutReview.aspx* e la pagina *CheckoutComplete.aspx* verranno reindirizzati alla pagina *CheckoutError.aspx* se si verifica un errore.</span><span class="sxs-lookup"><span data-stu-id="1efd6-426">The code-behind of the *CheckoutStart.aspx* page, the *CheckoutReview.aspx* page, and the *CheckoutComplete.aspx* page will each redirect to the *CheckoutError.aspx* page if an error occurs.</span></span>

1. <span data-ttu-id="1efd6-427">Aprire la pagina denominata *CheckoutError.aspx* nella cartella *Checkout.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-427">Open the page named *CheckoutError.aspx* in the *Checkout* folder.</span></span>
2. <span data-ttu-id="1efd6-428">Sostituire il markup esistente con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="1efd6-428">Replace the existing markup with the following:</span></span>   

    [!code-aspx[Main](checkout-and-payment-with-paypal/samples/sample25.aspx)]

<span data-ttu-id="1efd6-429">La pagina *CheckoutError.aspx* viene visualizzata con i dettagli dell'errore quando si verifica un errore durante il processo di estrazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-429">The *CheckoutError.aspx* page is displayed with the error details when an error occurs during the checkout process.</span></span>

## <a name="running-the-application"></a><span data-ttu-id="1efd6-430">Esecuzione dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="1efd6-430">Running the Application</span></span>

<span data-ttu-id="1efd6-431">Eseguire l'applicazione per vedere come acquistare i prodotti.</span><span class="sxs-lookup"><span data-stu-id="1efd6-431">Run the application to see how to purchase products.</span></span> <span data-ttu-id="1efd6-432">Si noti che verrà eseguito nell'ambiente di test PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-432">Note that you will be running in the PayPal testing environment.</span></span> <span data-ttu-id="1efd6-433">Non si scambiano denaro reale.</span><span class="sxs-lookup"><span data-stu-id="1efd6-433">No actual money is being exchanged.</span></span>

1. <span data-ttu-id="1efd6-434">Assicurarsi che tutti i file vengono salvati in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1efd6-434">Make sure all your files are saved in Visual Studio.</span></span>
2. <span data-ttu-id="1efd6-435">Aprire un browser Web [https://developer.paypal.com](https://developer.paypal.com/)e passare a .</span><span class="sxs-lookup"><span data-stu-id="1efd6-435">Open a Web browser and navigate to [https://developer.paypal.com](https://developer.paypal.com/).</span></span>
3. <span data-ttu-id="1efd6-436">Accedi con il tuo account sviluppatore PayPal che hai creato in precedenza in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="1efd6-436">Login with your PayPal developer account that you created earlier in this tutorial.</span></span>  
   <span data-ttu-id="1efd6-437">Per la sandbox per sviluppatori di PayPal, [https://developer.paypal.com](https://developer.paypal.com/) è necessario effettuare l'accesso per testare il checkout espresso.</span><span class="sxs-lookup"><span data-stu-id="1efd6-437">For PayPal's developer sandbox, you need to be logged in at [https://developer.paypal.com](https://developer.paypal.com/) to test express checkout.</span></span> <span data-ttu-id="1efd6-438">Questo vale solo per i test sandbox di PayPal, non per l'ambiente live di PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-438">This only applies to PayPal's sandbox testing, not to PayPal's live environment.</span></span>
4. <span data-ttu-id="1efd6-439">In Visual Studio premere F5 per eseguire l'applicazione di esempio Wingtip Toys.In Visual Studio, press **F5** to run the Wingtip Toys sample application.</span><span class="sxs-lookup"><span data-stu-id="1efd6-439">In Visual Studio, press **F5** to run the Wingtip Toys sample application.</span></span>  
   <span data-ttu-id="1efd6-440">Dopo la ricompilazione del database, il browser verrà aperto e verrà visualizzata la pagina *Default.aspx.*</span><span class="sxs-lookup"><span data-stu-id="1efd6-440">After the database rebuilds, the browser will open and show the *Default.aspx* page.</span></span>
5. <span data-ttu-id="1efd6-441">Aggiungere tre prodotti diversi al carrello selezionando la categoria di prodotto, ad esempio "Auto" e quindi facendo clic su **Aggiungi al carrello** accanto a ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="1efd6-441">Add three different products to the shopping cart by selecting the product category, such as "Cars" and then clicking **Add to Cart** next to each product.</span></span>  
   <span data-ttu-id="1efd6-442">Il carrello visualizzerà il prodotto selezionato.</span><span class="sxs-lookup"><span data-stu-id="1efd6-442">The shopping cart will display the product you have selected.</span></span>
6. <span data-ttu-id="1efd6-443">Fai clic sul pulsante **PayPal** per effettuare il checkout.</span><span class="sxs-lookup"><span data-stu-id="1efd6-443">Click the **PayPal** button to checkout.</span></span> 

    ![Checkout e pagamento con PayPal - Carrello](checkout-and-payment-with-paypal/_static/image20.png)

   <span data-ttu-id="1efd6-445">Per l'estrazione è necessario disporre di un account utente per l'applicazione di esempio Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="1efd6-445">Checking out will require that you have a user account for the Wingtip Toys sample application.</span></span>
7. <span data-ttu-id="1efd6-446">Fai clic sul link **Google** a destra della pagina per accedere con un account email gmail.com esistente.</span><span class="sxs-lookup"><span data-stu-id="1efd6-446">Click the **Google** link on the right of the page to log in with an existing gmail.com email account.</span></span>  
   <span data-ttu-id="1efd6-447">Se non si dispone di un account gmail.com, è possibile crearne uno a scopo di test presso [www.gmail.com](https://www.gmail.com/).</span><span class="sxs-lookup"><span data-stu-id="1efd6-447">If you do not have a gmail.com account, you can create one for testing purposes at [www.gmail.com](https://www.gmail.com/).</span></span> <span data-ttu-id="1efd6-448">È inoltre possibile utilizzare un account locale standard facendo clic su "Registra".</span><span class="sxs-lookup"><span data-stu-id="1efd6-448">You can also use a standard local account by clicking "Register".</span></span> 

    ![Checkout e pagamento con PayPal - Log in](checkout-and-payment-with-paypal/_static/image21.png)
8. <span data-ttu-id="1efd6-450">Accedi con il tuo account gmail e la password.</span><span class="sxs-lookup"><span data-stu-id="1efd6-450">Sign in with your gmail account and password.</span></span> 

    ![Checkout e pagamento con PayPal - Accesso Gmail](checkout-and-payment-with-paypal/_static/image22.png)
9. <span data-ttu-id="1efd6-452">Fare clic sul pulsante **Accedi** per registrare l'account gmail con il nome utente dell'applicazione di esempio Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="1efd6-452">Click the **Log in** button to register your gmail account with your Wingtip Toys sample application user name.</span></span> 

    ![Checkout e pagamento con PayPal - Registro conto](checkout-and-payment-with-paypal/_static/image23.png)
10. <span data-ttu-id="1efd6-454">Sul sito di prova PayPal, aggiungi l'indirizzo email e la password **dell'acquirente** creati in precedenza in questa esercitazione, quindi fai clic sul pulsante **Accedi.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-454">On the PayPal test site, add your **buyer** email address and password that you created earlier in this tutorial, then click the **Log In** button.</span></span> 

    ![Checkout e pagamento con PayPal - Sign-In PayPal](checkout-and-payment-with-paypal/_static/image24.png)
11. <span data-ttu-id="1efd6-456">Accetta le norme payPal e fai clic sul pulsante **Accetto e continua.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-456">Agree to the PayPal policy and click the **Agree and Continue** button.</span></span>  
    <span data-ttu-id="1efd6-457">Tieni presente che questa pagina viene visualizzata solo la prima volta che utilizzi questo conto PayPal.</span><span class="sxs-lookup"><span data-stu-id="1efd6-457">Note that this page is only displayed the first time you use this PayPal account.</span></span> <span data-ttu-id="1efd6-458">Si noti ancora una volta che questo è un conto di prova, non viene scambiato denaro reale.</span><span class="sxs-lookup"><span data-stu-id="1efd6-458">Again note that this is a test account, no real money is exchanged.</span></span> 

    ![Checkout e pagamento con PayPal - Politica PayPal](checkout-and-payment-with-paypal/_static/image25.png)
12. <span data-ttu-id="1efd6-460">Esaminare le informazioni sull'ordine nella pagina di revisione dell'ambiente di test PayPal e fare clic su **Continua**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-460">Review the order information on the PayPal testing environment review page and click **Continue**.</span></span> 

    ![Checkout e pagamento con PayPal - Informazioni sulla revisione](checkout-and-payment-with-paypal/_static/image26.png)
13. <span data-ttu-id="1efd6-462">Nella pagina *CheckoutReview.aspx* verificare l'importo dell'ordine e visualizzare l'indirizzo di spedizione generato.</span><span class="sxs-lookup"><span data-stu-id="1efd6-462">On the *CheckoutReview.aspx* page, verify the order amount and view the generated shipping address.</span></span> <span data-ttu-id="1efd6-463">Quindi, fare clic sul pulsante **Completa ordine.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-463">Then, click the **Complete Order** button.</span></span> 

    ![Checkout e pagamento con PayPal - Recensione dell'ordine](checkout-and-payment-with-paypal/_static/image27.png)
14. <span data-ttu-id="1efd6-465">Viene visualizzata la pagina **CheckoutComplete.aspx** con un ID transazione di pagamento.</span><span class="sxs-lookup"><span data-stu-id="1efd6-465">The **CheckoutComplete.aspx** page is displayed with a payment transaction ID.</span></span> 

    ![Checkout e pagamento con PayPal - Checkout completato](checkout-and-payment-with-paypal/_static/image28.png)

<a id="ReviewDBWebForms"></a>
## <a name="reviewing-the-database"></a><span data-ttu-id="1efd6-467">Revisione del database</span><span class="sxs-lookup"><span data-stu-id="1efd6-467">Reviewing the Database</span></span>

<span data-ttu-id="1efd6-468">Esaminando i dati aggiornati nel database dell'applicazione di esempio Wingtip Toys dopo l'esecuzione dell'applicazione, è possibile notare che l'applicazione ha registrato correttamente l'acquisto dei prodotti.</span><span class="sxs-lookup"><span data-stu-id="1efd6-468">By reviewing the updated data in the Wingtip Toys sample application database after running the application, you can see that the application successfully recorded the purchase of the products.</span></span>

<span data-ttu-id="1efd6-469">È possibile esaminare i dati contenuti nel file di database *Wingtiptoys.mdf* utilizzando la finestra **Esplora database** (finestra**Esplora server** in Visual Studio) come è stato fatto in precedenza in questa serie di esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="1efd6-469">You can inspect the data contained in the *Wingtiptoys.mdf* database file by using the **Database Explorer** window (**Server Explorer** window in Visual Studio) as you did earlier in this tutorial series.</span></span>

1. <span data-ttu-id="1efd6-470">Chiudere la finestra del browser se è ancora aperta.</span><span class="sxs-lookup"><span data-stu-id="1efd6-470">Close the browser window if it is still open.</span></span>
2. <span data-ttu-id="1efd6-471">In Visual Studio selezionare l'icona **Mostra tutti i file** nella parte superiore di Esplora **soluzioni** per espandere la cartella **Dati\_app.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-471">In Visual Studio, select the **Show All Files** icon at the top of **Solution Explorer** to allow you to expand the **App\_Data** folder.</span></span>
3. <span data-ttu-id="1efd6-472">Espandere la cartella **\_App Data.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-472">Expand the **App\_Data** folder.</span></span>  
 <span data-ttu-id="1efd6-473">Potrebbe essere necessario selezionare l'icona **Mostra tutti i file** per la cartella.</span><span class="sxs-lookup"><span data-stu-id="1efd6-473">You may need to select the **Show All Files** icon for the folder.</span></span>
4. <span data-ttu-id="1efd6-474">Fare clic con il pulsante destro del mouse sul file di database *Wingtiptoys.mdf* e scegliere **Apri**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-474">Right-click the *Wingtiptoys.mdf* database file and select **Open**.</span></span>  
    <span data-ttu-id="1efd6-475">Verrà visualizzato **Esplora server.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-475">**Server Explorer** is displayed.</span></span>
5. <span data-ttu-id="1efd6-476">Espandere la cartella **Tabelle** .</span><span class="sxs-lookup"><span data-stu-id="1efd6-476">Expand the **Tables** folder.</span></span>
6. <span data-ttu-id="1efd6-477">Fare clic con il pulsante destro del mouse sulla tabella **Orders**e scegliere **Mostra dati tabella**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-477">Right-click the **Orders**table and select **Show Table Data**.</span></span>  
 <span data-ttu-id="1efd6-478">Viene visualizzata la tabella **Ordini.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-478">The **Orders** table is displayed.</span></span>
7. <span data-ttu-id="1efd6-479">Esaminare la colonna **PaymentTransactionID** per confermare le transazioni riuscite.</span><span class="sxs-lookup"><span data-stu-id="1efd6-479">Review the **PaymentTransactionID** column to confirm successful transactions.</span></span> 

    ![Checkout e pagamento con PayPal - Banca dati delle recensioni](checkout-and-payment-with-paypal/_static/image29.png)
8. <span data-ttu-id="1efd6-481">Chiudere la finestra della tabella **Ordini.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-481">Close the **Orders** table window.</span></span>
9. <span data-ttu-id="1efd6-482">In Esplora server fare clic con il pulsante destro del mouse sulla tabella **OrderDetails** e scegliere **Mostra dati tabella**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-482">In the Server Explorer, right-click the **OrderDetails** table and select **Show Table Data**.</span></span>
10. <span data-ttu-id="1efd6-483">Esaminare `OrderId` `Username` i valori e nella tabella **OrderDetails.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-483">Review the `OrderId` and `Username` values in the **OrderDetails** table.</span></span> <span data-ttu-id="1efd6-484">Si noti che `OrderId` `Username` questi valori corrispondono ai valori e inclusi nella tabella **Orders.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-484">Note that these values match the `OrderId` and `Username` values included in the **Orders** table.</span></span>
11. <span data-ttu-id="1efd6-485">Chiudere la finestra della tabella **OrderDetails.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-485">Close the **OrderDetails** table window.</span></span>
12. <span data-ttu-id="1efd6-486">Fare clic con il pulsante destro del mouse sul file di database Wingtip Toys (*Wingtiptoys.mdf*) e scegliere **Chiudi connessione**.</span><span class="sxs-lookup"><span data-stu-id="1efd6-486">Right-click the Wingtip Toys database file (*Wingtiptoys.mdf*) and select **Close Connection**.</span></span>
13. <span data-ttu-id="1efd6-487">Se la finestra **Esplora soluzioni** non viene visualizzata, fare clic su **Esplora soluzioni** nella parte inferiore della finestra **Esplora server** per visualizzare nuovamente **Esplora soluzioni.**</span><span class="sxs-lookup"><span data-stu-id="1efd6-487">If you do not see the **Solution Explorer** window, click **Solution Explorer** at the bottom of the **Server Explorer** window to show the **Solution Explorer** again.</span></span>

## <a name="summary"></a><span data-ttu-id="1efd6-488">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="1efd6-488">Summary</span></span>

<span data-ttu-id="1efd6-489">In questa esercitazione sono stati aggiunti schemi di dettaglio dell'ordine e dell'ordine per tenere traccia dell'acquisto di prodotti.</span><span class="sxs-lookup"><span data-stu-id="1efd6-489">In this tutorial you added order and order detail schemas to track the purchase of products.</span></span> <span data-ttu-id="1efd6-490">È stata inoltre integrata la funzionalità PayPal nell'applicazione di esempio Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="1efd6-490">You also integrated PayPal functionality into the Wingtip Toys sample application.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="1efd6-491">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="1efd6-491">Additional Resources</span></span>

<span data-ttu-id="1efd6-492">[Cenni preliminari sulla configurazione di ASP.NET](https://msdn.microsoft.com/library/ms178683(v=vs.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="1efd6-492">[ASP.NET Configuration Overview](https://msdn.microsoft.com/library/ms178683(v=vs.100).aspx)</span></span>  
[<span data-ttu-id="1efd6-493">Distribuire un'app Web Form di ASP.NET sicura con appartenenza, OAuth e database SQL al servizio app di AzureDeploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to Azure App Service</span><span class="sxs-lookup"><span data-stu-id="1efd6-493">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to Azure App Service</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)  
[<span data-ttu-id="1efd6-494">Microsoft Azure - Versione di valutazione gratuita</span><span class="sxs-lookup"><span data-stu-id="1efd6-494">Microsoft Azure - Free Trial</span></span>](https://azure.microsoft.com/pricing/free-trial/)

## <a name="disclaimer"></a><span data-ttu-id="1efd6-495">Dichiarazione di non responsabilità</span><span class="sxs-lookup"><span data-stu-id="1efd6-495">Disclaimer</span></span>

<span data-ttu-id="1efd6-496">Questa esercitazione contiene codice di esempio.</span><span class="sxs-lookup"><span data-stu-id="1efd6-496">This tutorial contains sample code.</span></span> <span data-ttu-id="1efd6-497">Tale codice di esempio viene fornito "così com'è" senza garanzia di alcun tipo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-497">Such sample code is provided "as is" without warranty of any kind.</span></span> <span data-ttu-id="1efd6-498">Di conseguenza, Microsoft non garantisce l'accuratezza, l'integrità o la qualità del codice di esempio.</span><span class="sxs-lookup"><span data-stu-id="1efd6-498">Accordingly, Microsoft does not guarantee the accuracy, integrity, or quality of the sample code.</span></span> <span data-ttu-id="1efd6-499">L'utente accetta di utilizzare il codice di esempio a proprio rischio e pericolo.</span><span class="sxs-lookup"><span data-stu-id="1efd6-499">You agree to use the sample code at your own risk.</span></span> <span data-ttu-id="1efd6-500">In nessun caso Microsoft sarà responsabile per l'utente in alcun modo per qualsiasi codice di esempio, contenuto, inclusi, ma non limitati a, eventuali errori o omissioni in qualsiasi codice di esempio, contenuto o qualsiasi perdita o danno di qualsiasi tipo sostenuto a seguito dell'uso di qualsiasi codice di esempio.</span><span class="sxs-lookup"><span data-stu-id="1efd6-500">Under no circumstances will Microsoft be liable to you in any way for any sample code, content, including but not limited to, any errors or omissions in any sample code, content, or any loss or damage of any kind incurred as a result of the use of any sample code.</span></span> <span data-ttu-id="1efd6-501">L'utente viene informato e accetta di indennizzare, salvare e mantenere Microsoft innocuo da e contro qualsiasi perdita, reclamo di perdita, infortunio o danno di qualsiasi tipo, comprese, senza limitazioni, quelle causate da o derivanti da materiale che pubblichi, trasmetti, usi o fai affidamento su includendo, ma non limitato, le opinioni espresse in esso contenute.</span><span class="sxs-lookup"><span data-stu-id="1efd6-501">You are hereby notified and do hereby agree to indemnify, save and hold Microsoft harmless from and against any and all loss, claims of loss, injury or damage of any kind including, without limitation, those occasioned by or arising from material that you post, transmit, use or rely on including, but not limited to, the views expressed therein.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1efd6-502">[Successivo](shopping-cart.md)
> [precedente](membership-and-administration.md)</span><span class="sxs-lookup"><span data-stu-id="1efd6-502">[Previous](shopping-cart.md)
[Next](membership-and-administration.md)</span></span>
