---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
title: Appartenenza e amministrazione | Microsoft Docs
author: Erikre
description: Questa serie di esercitazioni insegnerà le nozioni di base della creazione di un'applicazione Web Form ASP.NET con ASP.NET 4.5 e Microsoft Visual Studio Express 2013 per Microsoft...
ms.author: riande
ms.date: 09/08/2014
ms.assetid: 732a2316-e49f-4f72-becd-0cd72f14457e
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
msc.type: authoredcontent
ms.openlocfilehash: 23d08d5a05a8321fbc794e2c9b54cc39c9b5baf6
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/01/2019
ms.locfileid: "57031058"
---
<a name="membership-and-administration"></a><span data-ttu-id="485b0-103">Appartenenza e amministrazione</span><span class="sxs-lookup"><span data-stu-id="485b0-103">Membership and Administration</span></span>
====================
<span data-ttu-id="485b0-104">da [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="485b0-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="485b0-105">[Scaricare progetto di esempio Wingtip Toys (c#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) o [Scarica l'E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="485b0-105">[Download Wingtip Toys Sample Project (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="485b0-106">Questa serie di esercitazioni insegnerà le nozioni di base della creazione di un'applicazione Web Form ASP.NET con ASP.NET 4.5 e Microsoft Visual Studio Express 2013 per Web.</span><span class="sxs-lookup"><span data-stu-id="485b0-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="485b0-107">Un Visual Studio 2013 [progetto con codice sorgente c#](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) complemento a questa serie di esercitazioni è disponibile.</span><span class="sxs-lookup"><span data-stu-id="485b0-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>


<span data-ttu-id="485b0-108">Questa esercitazione illustra come aggiornare l'applicazione di esempio Wingtip Toys per aggiungere un ruolo personalizzato e usare ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="485b0-108">This tutorial shows you how to update the Wingtip Toys sample application to add a custom role and use ASP.NET Identity.</span></span> <span data-ttu-id="485b0-109">Viene inoltre illustrato come implementare una pagina di amministrazione da cui l'utente con un ruolo personalizzato è possibile aggiungere e rimuovere i prodotti dal sito Web.</span><span class="sxs-lookup"><span data-stu-id="485b0-109">It also shows you how to implement an administration page from which the user with a custom role can add and remove products from the website.</span></span>

<span data-ttu-id="485b0-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) è il sistema di appartenenze utilizzato per compilare un'applicazione web ASP.NET ed è disponibile in ASP.NET 4.5.</span><span class="sxs-lookup"><span data-stu-id="485b0-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) is the membership system used to build ASP.NET web application and is available in ASP.NET 4.5.</span></span> <span data-ttu-id="485b0-111">ASP.NET Identity viene usato il modello di progetto Web Form di Visual Studio 2013, nonché i modelli per [ASP.NET MVC](../../../../mvc/index.md), [API Web ASP.NET](../../../../web-api/index.md), e [applicazione a pagina singola ASP.NET](../../../../single-page-application/index.md).</span><span class="sxs-lookup"><span data-stu-id="485b0-111">ASP.NET Identity is used in the Visual Studio 2013 Web Forms project template, as well as the templates for [ASP.NET MVC](../../../../mvc/index.md), [ASP.NET Web API](../../../../web-api/index.md), and [ASP.NET Single Page Application](../../../../single-page-application/index.md).</span></span> <span data-ttu-id="485b0-112">Anche in particolare, è possibile installare il sistema di identità di ASP.NET con NuGet quando si inizia con un'applicazione Web vuota.</span><span class="sxs-lookup"><span data-stu-id="485b0-112">You can also specifically install the ASP.NET Identity system using NuGet when you start with an empty Web application.</span></span> <span data-ttu-id="485b0-113">Tuttavia, in questa serie di esercitazioni usano i **Web Form**projecttemplate, che include il sistema di identità di ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="485b0-113">However, in this tutorial series you use the **Web Forms**projecttemplate, which includes the ASP.NET Identity system.</span></span> <span data-ttu-id="485b0-114">ASP.NET Identity rende più facile l'integrazione dei dati di profili specifici dell'utente con i dati dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-114">ASP.NET Identity makes it easy to integrate user-specific profile data with application data.</span></span> <span data-ttu-id="485b0-115">ASP.NET Identity consente, inoltre, è possibile scegliere il modello di persistenza per i profili utente nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-115">Also, ASP.NET Identity allows you to choose the persistence model for user profiles in your application.</span></span> <span data-ttu-id="485b0-116">È possibile archiviare i dati in un database di SQL Server o un altro archivio dati, inclusi *NoSQL* gli archivi dati, ad esempio tabelle di archiviazione Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="485b0-116">You can store the data in a SQL Server database or another data store, including *NoSQL* data stores such as Windows Azure Storage Tables.</span></span>

<span data-ttu-id="485b0-117">Questa esercitazione si basa sull'esercitazione precedente denominata "Completamento della transazione e pagamento con PayPal" della serie di esercitazioni di Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="485b0-117">This tutorial builds on the previous tutorial titled "Checkout and Payment with PayPal" in the Wingtip Toys tutorial series.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="485b0-118">Che cosa si apprenderà come:</span><span class="sxs-lookup"><span data-stu-id="485b0-118">What you'll learn:</span></span>

- <span data-ttu-id="485b0-119">Come usare il codice per aggiungere un ruolo personalizzato e un utente all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-119">How to use code to add a custom role and a user to the application.</span></span>
- <span data-ttu-id="485b0-120">Come limitare l'accesso alla cartella di amministrazione, pagina.</span><span class="sxs-lookup"><span data-stu-id="485b0-120">How to restrict access to the administration folder and page.</span></span>
- <span data-ttu-id="485b0-121">Come per la navigazione per l'utente a cui appartiene il ruolo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="485b0-121">How to provide navigation for the user that belongs to the custom role.</span></span>
- <span data-ttu-id="485b0-122">Come usare l'associazione di modelli per popolare una [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) controllo con le categorie di prodotti.</span><span class="sxs-lookup"><span data-stu-id="485b0-122">How to use model binding to populate a [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) control with product categories.</span></span>
- <span data-ttu-id="485b0-123">Come caricare un file per l'applicazione web usando il [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) controllo.</span><span class="sxs-lookup"><span data-stu-id="485b0-123">How to upload a file to the web application using the [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) control.</span></span>
- <span data-ttu-id="485b0-124">Come usare i controlli di convalida per implementare la convalida dell'input.</span><span class="sxs-lookup"><span data-stu-id="485b0-124">How to use validation controls to implement input validation.</span></span>
- <span data-ttu-id="485b0-125">Come aggiungere e rimuovere i prodotti dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-125">How to add and remove products from the application.</span></span>

## <a name="these-features-are-included-in-the-tutorial"></a><span data-ttu-id="485b0-126">Queste funzionalità sono inclusi nell'esercitazione:</span><span class="sxs-lookup"><span data-stu-id="485b0-126">These features are included in the tutorial:</span></span>

- <span data-ttu-id="485b0-127">Identità ASP.NET</span><span class="sxs-lookup"><span data-stu-id="485b0-127">ASP.NET Identity</span></span>
- <span data-ttu-id="485b0-128">Configurazione e l'autorizzazione</span><span class="sxs-lookup"><span data-stu-id="485b0-128">Configuration and Authorization</span></span>
- <span data-ttu-id="485b0-129">Associazione di modelli</span><span class="sxs-lookup"><span data-stu-id="485b0-129">Model Binding</span></span>
- <span data-ttu-id="485b0-130">Convalida discreta</span><span class="sxs-lookup"><span data-stu-id="485b0-130">Unobtrusive Validation</span></span>

<span data-ttu-id="485b0-131">Web Form ASP.NET offre funzionalità di appartenenza.</span><span class="sxs-lookup"><span data-stu-id="485b0-131">ASP.NET Web Forms provides membership capabilities.</span></span> <span data-ttu-id="485b0-132">Usando il modello predefinito, si ottengono funzionalità di appartenenza incorporata che è possibile utilizzare immediatamente quando viene eseguita l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-132">By using the default template, you have built-in membership functionality that you can immediately use when the application runs.</span></span> <span data-ttu-id="485b0-133">Questa esercitazione illustra come usare ASP.NET Identity per aggiungere un ruolo personalizzato e assegnare un utente a tale ruolo.</span><span class="sxs-lookup"><span data-stu-id="485b0-133">This tutorial shows you how to use ASP.NET Identity to add a custom role and assign a user to that role.</span></span> <span data-ttu-id="485b0-134">Si apprenderà come limitare l'accesso alla cartella administration.</span><span class="sxs-lookup"><span data-stu-id="485b0-134">You will learn how to restrict access to the administration folder.</span></span> <span data-ttu-id="485b0-135">Si aggiungerà una pagina della cartella amministrazione che consente a un utente con un ruolo personalizzato per aggiungere e rimuovere i prodotti e visualizzare in anteprima un prodotto dopo che è stato aggiunto.</span><span class="sxs-lookup"><span data-stu-id="485b0-135">You'll add a page to the administration folder that allows a user with a custom role to add and remove products, and to preview a product after it has been added.</span></span>

## <a name="adding-a-custom-role"></a><span data-ttu-id="485b0-136">Aggiunta di un ruolo personalizzato</span><span class="sxs-lookup"><span data-stu-id="485b0-136">Adding a Custom Role</span></span>

<span data-ttu-id="485b0-137">Uso di ASP.NET Identity, è possibile aggiungere un ruolo personalizzato e assegnare un utente a tale ruolo tramite il codice.</span><span class="sxs-lookup"><span data-stu-id="485b0-137">Using ASP.NET Identity, you can add a custom role and assign a user to that role using code.</span></span>

1. <span data-ttu-id="485b0-138">Nella **Esplora soluzioni**, fare clic sui *logica* cartella e creare una nuova classe.</span><span class="sxs-lookup"><span data-stu-id="485b0-138">In **Solution Explorer**, right-click on the *Logic* folder and create a new class.</span></span>
2. <span data-ttu-id="485b0-139">Denominare la nuova classe *RoleActions.cs*.</span><span class="sxs-lookup"><span data-stu-id="485b0-139">Name the new class *RoleActions.cs*.</span></span>
3. <span data-ttu-id="485b0-140">Modificare il codice in modo che venga visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="485b0-140">Modify the code so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample1.cs?highlight=8)]
4. <span data-ttu-id="485b0-141">Nelle **Esplora soluzioni**, aprire il *Global.asax.cs* file.</span><span class="sxs-lookup"><span data-stu-id="485b0-141">In **Solution Explorer**, open the *Global.asax.cs* file.</span></span>
5. <span data-ttu-id="485b0-142">Modificare il *Global.asax.cs* file aggiungendo il codice evidenziato in giallo in modo che venga visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="485b0-142">Modify the *Global.asax.cs* file by adding the code highlighted in yellow so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample2.cs?highlight=11,26-28)]
6. <span data-ttu-id="485b0-143">Si noti che `AddUserAndRole` è sottolineato in rosso.</span><span class="sxs-lookup"><span data-stu-id="485b0-143">Notice that `AddUserAndRole` is underlined in red.</span></span> <span data-ttu-id="485b0-144">Fare doppio clic il codice AddUserAndRole.</span><span class="sxs-lookup"><span data-stu-id="485b0-144">Double-click the AddUserAndRole code.</span></span>  
   <span data-ttu-id="485b0-145">La lettera "A" all'inizio del metodo evidenziato verrà sottolineata.</span><span class="sxs-lookup"><span data-stu-id="485b0-145">The letter "A" at the beginning of the highlighted method will be underlined.</span></span>
7. <span data-ttu-id="485b0-146">La lettera "A" del mouse e scegliere l'interfaccia utente che consente di generare uno stub di metodo per la `AddUserAndRole` (metodo).</span><span class="sxs-lookup"><span data-stu-id="485b0-146">Hover over the letter "A" and click the UI that allows you to generate a method stub for the `AddUserAndRole` method.</span></span> 

    ![L'appartenenza e Advministration - genera Stub metodo](membership-and-administration/_static/image1.png)
8. <span data-ttu-id="485b0-148">Fare clic sull'opzione intitolato:</span><span class="sxs-lookup"><span data-stu-id="485b0-148">Click the option titled:</span></span>  
    `Generate method stub for "AddUserAndRole" in "WingtipToys.Logic.RoleActions"`
9. <span data-ttu-id="485b0-149">Aprire il *RoleActions.cs* del file dalle *per la logica* cartella.</span><span class="sxs-lookup"><span data-stu-id="485b0-149">Open the *RoleActions.cs* file from the *Logic* folder.</span></span>  
   <span data-ttu-id="485b0-150">Il `AddUserAndRole` metodo è stato aggiunto al file della classe.</span><span class="sxs-lookup"><span data-stu-id="485b0-150">The `AddUserAndRole` method has been added to the class file.</span></span>
10. <span data-ttu-id="485b0-151">Modificare il *RoleActions.cs* file rimuovendo il `NotImplementedeException` e aggiungendo il codice evidenziato in giallo, in modo che venga visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="485b0-151">Modify the *RoleActions.cs* file by removing the `NotImplementedeException` and adding the code highlighted in yellow, so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample3.cs?highlight=5-7,15-51)]

<span data-ttu-id="485b0-152">Il codice sopra riportato innanzitutto stabilisce un contesto di database per il database di appartenenza.</span><span class="sxs-lookup"><span data-stu-id="485b0-152">The above code first establishes a database context for the membership database.</span></span> <span data-ttu-id="485b0-153">Il database di appartenenza viene archiviato anche un *mdf* del file nei *App\_dati* cartella.</span><span class="sxs-lookup"><span data-stu-id="485b0-153">The membership database is also stored as an *.mdf* file in the *App\_Data* folder.</span></span> <span data-ttu-id="485b0-154">Sarà in grado di visualizzare il database dopo il primo utente ha effettuato l'accesso a questa applicazione web.</span><span class="sxs-lookup"><span data-stu-id="485b0-154">You will be able to view this database once the first user has signed in to this web application.</span></span> 

> [!NOTE] 
> 
> <span data-ttu-id="485b0-155">Se si desidera archiviare i dati di appartenenza con i dati del prodotto, è possibile utilizzare lo stesso **DbContext** usato per archiviare i dati del prodotto nel codice precedente.</span><span class="sxs-lookup"><span data-stu-id="485b0-155">If you wish to store the membership data along with the product data, you can consider using the same **DbContext** that you used to store the product data in the above code.</span></span>


 <span data-ttu-id="485b0-156">Il *interne* (parola chiave) è un modificatore di accesso per tipi (ad esempio le classi) e i membri dei tipi (ad esempio metodi o proprietà).</span><span class="sxs-lookup"><span data-stu-id="485b0-156">The *internal* keyword is an access modifier for types (such as classes) and type members (such as methods or properties).</span></span> <span data-ttu-id="485b0-157">Tipi interni o i membri sono accessibili solo all'interno dei file contenuti nell'assembly stesso *(con estensione dll* file).</span><span class="sxs-lookup"><span data-stu-id="485b0-157">Internal types or members are accessible only within files contained in the same assembly *(.dll* file).</span></span> <span data-ttu-id="485b0-158">Quando si compila l'applicazione, un file di assembly *(con estensione dll*) viene creato che contiene il codice che viene eseguito quando si esegue l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-158">When you build your application, an assembly file *(.dll*) is created that contains the code that is executed when you run your application.</span></span> 

<span data-ttu-id="485b0-159">Oggetto `RoleStore` oggetto, che fornisce la gestione dei ruoli, viene creato in base al contesto di database.</span><span class="sxs-lookup"><span data-stu-id="485b0-159">A `RoleStore` object, which provides role management, is created based on the database context.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="485b0-160">Si noti che durante la `RoleStore` viene creato l'oggetto utilizza un oggetto generico `IdentityRole` tipo.</span><span class="sxs-lookup"><span data-stu-id="485b0-160">Notice that when the `RoleStore` object is created it uses a Generic `IdentityRole` type.</span></span> <span data-ttu-id="485b0-161">Ciò significa che il `RoleStore` può solo contenere `IdentityRole` oggetti.</span><span class="sxs-lookup"><span data-stu-id="485b0-161">This means that the `RoleStore` is only allowed to contain `IdentityRole` objects.</span></span> <span data-ttu-id="485b0-162">Anche con i Generics, le risorse in memoria vengono gestite meglio.</span><span class="sxs-lookup"><span data-stu-id="485b0-162">Also by using Generics, resources in memory are handled better.</span></span>


<span data-ttu-id="485b0-163">Successivamente, il `RoleManager` dell'oggetto, viene creato in base il `RoleStore` oggetto appena creato.</span><span class="sxs-lookup"><span data-stu-id="485b0-163">Next, the `RoleManager` object, is created based on the `RoleStore` object that you just created.</span></span> <span data-ttu-id="485b0-164">il `RoleManager` API che consente di salvare automaticamente le modifiche a correlate al ruolo di oggetto espone il `RoleStore`.</span><span class="sxs-lookup"><span data-stu-id="485b0-164">the `RoleManager` object exposes role related API which can be used to automatically save changes to the `RoleStore`.</span></span> <span data-ttu-id="485b0-165">Il `RoleManager` può solo contenere `IdentityRole` oggetti perché il codice Usa il `<IdentityRole>` tipo generico.</span><span class="sxs-lookup"><span data-stu-id="485b0-165">The `RoleManager` is only allowed to contain `IdentityRole` objects because the code uses the `<IdentityRole>` Generic type.</span></span>

<span data-ttu-id="485b0-166">Si chiama il `RoleExists` metodo per determinare se il ruolo "canEdit" è presente nel database delle appartenenze.</span><span class="sxs-lookup"><span data-stu-id="485b0-166">You call the `RoleExists` method to determine if the "canEdit" role is present in the membership database.</span></span> <span data-ttu-id="485b0-167">In caso contrario, si creerà il ruolo.</span><span class="sxs-lookup"><span data-stu-id="485b0-167">If it is not, you create the role.</span></span>

<span data-ttu-id="485b0-168">Creazione di `UserManager` oggetto sembra essere più complessi del `RoleManager` controllare, tuttavia è quasi identica a quella.</span><span class="sxs-lookup"><span data-stu-id="485b0-168">Creating the `UserManager` object appears to be more complicated than the `RoleManager` control, however it is nearly the same.</span></span> <span data-ttu-id="485b0-169">È sufficiente codificata in una riga invece di più versioni.</span><span class="sxs-lookup"><span data-stu-id="485b0-169">It is just coded on one line rather than several.</span></span> <span data-ttu-id="485b0-170">In questo caso, il parametro che si sta passando viene creata l'istanza come un nuovo oggetto contenuto in parentesi.</span><span class="sxs-lookup"><span data-stu-id="485b0-170">Here, the parameter that you are passing is instantiating as a new object contained in the parenthesis.</span></span>

<span data-ttu-id="485b0-171">Successivamente viene creato l'utente "canEditUser" creando un nuovo `ApplicationUser` oggetto.</span><span class="sxs-lookup"><span data-stu-id="485b0-171">Next you create the "canEditUser" user by creating a new `ApplicationUser` object.</span></span> <span data-ttu-id="485b0-172">Quindi, se crei correttamente l'utente, aggiungere l'utente al nuovo ruolo.</span><span class="sxs-lookup"><span data-stu-id="485b0-172">Then, if you successfully create the user, you add the user to the new role.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="485b0-173">La gestione degli errori verrà aggiornato durante l'esercitazione "ASP.NET Error Handling" più avanti in questa serie di esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="485b0-173">The error handling will be updated during the "ASP.NET Error Handling" tutorial later in this tutorial series.</span></span>


<span data-ttu-id="485b0-174">Al successivo avvio dell'applicazione, l'utente denominato "canEditUser" verrà aggiunto come il ruolo "canEdit" dell'applicazione denominato.</span><span class="sxs-lookup"><span data-stu-id="485b0-174">The next time the application starts, the user named "canEditUser" will be added as the role named "canEdit" of the application.</span></span> <span data-ttu-id="485b0-175">Più avanti in questa esercitazione, sarà l'accesso come utente "canEditUser" per visualizzare le funzionalità aggiuntive che si verranno aggiunti durante questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-175">Later in this tutorial, you will login as the "canEditUser" user to display additional capabilities that you will added during this tutorial.</span></span> <span data-ttu-id="485b0-176">Per informazioni dettagliate API su ASP.NET Identity, vedere la [ASPNET Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span><span class="sxs-lookup"><span data-stu-id="485b0-176">For API details about ASP.NET Identity, see the [Microsoft.AspNet.Identity Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span></span> <span data-ttu-id="485b0-177">Per altre informazioni sull'inizializzazione il sistema di identità di ASP.NET, vedere la [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span><span class="sxs-lookup"><span data-stu-id="485b0-177">For additional details about initializing the ASP.NET Identity system, see the [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span></span>

### <a name="restricting-access-to-the-administration-page"></a><span data-ttu-id="485b0-178">Limitare l'accesso alla pagina di amministrazione</span><span class="sxs-lookup"><span data-stu-id="485b0-178">Restricting Access to the Administration Page</span></span>

<span data-ttu-id="485b0-179">L'applicazione di esempio Wingtip Toys consente agli utenti anonimi e agli utenti registrati visualizzare e acquistare i prodotti.</span><span class="sxs-lookup"><span data-stu-id="485b0-179">The Wingtip Toys sample application allows both anonymous users and logged-in users to view and purchase products.</span></span> <span data-ttu-id="485b0-180">Tuttavia, l'utente ha eseguito l'accesso con il ruolo "canEdit" personalizzato può accedere a una pagina con restrizioni per poter aggiungere e rimuovere i prodotti.</span><span class="sxs-lookup"><span data-stu-id="485b0-180">However, the logged-in user that has the custom "canEdit" role can access a restricted page in order to add and remove products.</span></span>

#### <a name="add-an-administration-folder-and-page"></a><span data-ttu-id="485b0-181">Aggiungere una cartella di amministrazione e pagina</span><span class="sxs-lookup"><span data-stu-id="485b0-181">Add an Administration Folder and Page</span></span>

<span data-ttu-id="485b0-182">Successivamente, si creerà una cartella denominata *Admin* applicazione di esempio per l'utente "canEditUser" che appartiene al ruolo personalizzato di Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="485b0-182">Next, you will create a folder named *Admin* for the "canEditUser" user belonging to the custom role of the Wingtip Toys sample application.</span></span>

1. <span data-ttu-id="485b0-183">Fare clic sul nome del progetto (**Wingtip Toys**) nel **Esplora soluzioni** e selezionare **Add**  - &gt; **nuova cartella**.</span><span class="sxs-lookup"><span data-stu-id="485b0-183">Right-click the project name (**Wingtip Toys**) in **Solution Explorer** and select **Add** -&gt; **New Folder**.</span></span>
2. <span data-ttu-id="485b0-184">Denominare la nuova cartella *Admin*.</span><span class="sxs-lookup"><span data-stu-id="485b0-184">Name the new folder *Admin*.</span></span>
3. <span data-ttu-id="485b0-185">Fare doppio clic il *Admin* cartella e quindi selezionare **Add**  - &gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="485b0-185">Right-click the *Admin* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="485b0-186">Verrà visualizzata la finestra di dialogo **Aggiungi nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="485b0-186">The **Add New Item** dialog box is displayed.</span></span>
4. <span data-ttu-id="485b0-187">Selezionare il <strong>Visual c#</strong> - &gt; <strong>Web</strong> gruppo di modelli a sinistra.</span><span class="sxs-lookup"><span data-stu-id="485b0-187">Select the <strong>Visual C#</strong>-&gt; <strong>Web</strong> templates group on the left.</span></span> <span data-ttu-id="485b0-188">Nell'elenco al centro, selezionare <strong>Web Form con pagina Master</strong>, denominarlo <em>AdminPage.aspx</em><strong>,</strong> e quindi selezionare <strong>Aggiungi</strong>.</span><span class="sxs-lookup"><span data-stu-id="485b0-188">From the middle list, select <strong>Web Form with Master Page</strong>,name it <em>AdminPage.aspx</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
5. <span data-ttu-id="485b0-189">Selezionare il *Site. master* del file della pagina master e quindi scegliere **OK**.</span><span class="sxs-lookup"><span data-stu-id="485b0-189">Select the *Site.Master* file as the master page, and then choose **OK**.</span></span>

#### <a name="add-a-webconfig-file"></a><span data-ttu-id="485b0-190">Aggiungere un File Web. config</span><span class="sxs-lookup"><span data-stu-id="485b0-190">Add a Web.config File</span></span>

<span data-ttu-id="485b0-191">Aggiungendo un *Web. config* del file per il *Admin* cartella, è possibile limitare l'accesso alla pagina contenuta nella cartella.</span><span class="sxs-lookup"><span data-stu-id="485b0-191">By adding a *Web.config* file to the *Admin* folder, you can restrict access to the page contained in the folder.</span></span>

1. <span data-ttu-id="485b0-192">Fare doppio clic il *Admin* cartella e selezionare **Add**  - &gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="485b0-192">Right-click the *Admin* folder and select **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="485b0-193">Verrà visualizzata la finestra di dialogo **Aggiungi nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="485b0-193">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="485b0-194">Nell'elenco di modelli web di Visual c#, selezionare <strong>Web. config</strong>dall'elenco al centro, accettare il nome predefinito della <em>Web. config</em><strong>,</strong> e quindi selezionare <strong>Aggiungere</strong>.</span><span class="sxs-lookup"><span data-stu-id="485b0-194">From the list of Visual C# web templates, select <strong>Web Configuration File</strong>from the middle list, accept the default name of <em>Web.config</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
3. <span data-ttu-id="485b0-195">Sostituire il contenuto nel codice XML esistente di *Web. config* file con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="485b0-195">Replace the existing XML content in the *Web.config* file with the following:</span></span>  

    [!code-xml[Main](membership-and-administration/samples/sample4.xml)]

<span data-ttu-id="485b0-196">Salvare il *Web. config* file.</span><span class="sxs-lookup"><span data-stu-id="485b0-196">Save the *Web.config* file.</span></span> <span data-ttu-id="485b0-197">Il *Web. config* file specifica che soltanto l'utente che appartengono al ruolo "canEdit" dell'applicazione può accedere alla pagina contenuta nel *Admin* cartella.</span><span class="sxs-lookup"><span data-stu-id="485b0-197">The *Web.config* file specifies that only user belonging to the "canEdit" role of the application can access the page contained in the *Admin* folder.</span></span>

### <a name="including-custom-role-navigation"></a><span data-ttu-id="485b0-198">Inclusi lo spostamento di un ruolo personalizzato</span><span class="sxs-lookup"><span data-stu-id="485b0-198">Including Custom Role Navigation</span></span>

<span data-ttu-id="485b0-199">Per consentire all'utente del ruolo "canEdit" personalizzato passare alla sezione Amministrazione dell'applicazione, è necessario aggiungere un collegamento per il *Site. master* pagina.</span><span class="sxs-lookup"><span data-stu-id="485b0-199">To enable the user of the custom "canEdit" role to navigate to the administration section of the application, you must add a link to the *Site.Master* page.</span></span> <span data-ttu-id="485b0-200">Solo gli utenti che appartengono al ruolo "canEdit" saranno in grado di vedere le **Admin** collegare e accedere alla sezione di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-200">Only users that belong to the "canEdit" role will be able to see the **Admin** link and access the administration section.</span></span>

1. <span data-ttu-id="485b0-201">In Esplora soluzioni, trovare e aprire il *Site. master* pagina.</span><span class="sxs-lookup"><span data-stu-id="485b0-201">In Solution Explorer, find and open the *Site.Master* page.</span></span>
2. <span data-ttu-id="485b0-202">Per creare un collegamento per l'utente del ruolo "canEdit", aggiungere il markup evidenziato in giallo nell'elenco non ordinato seguente `<ul>` elemento in modo che l'elenco viene visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="485b0-202">To create a link for the user of the "canEdit" role, add the markup highlighted in yellow to the following unordered list `<ul>` element so that the list appears as follows:</span></span>  

    [!code-html[Main](membership-and-administration/samples/sample5.html?highlight=2-3)]
3. <span data-ttu-id="485b0-203">Aprire il *Site.Master.cs* file.</span><span class="sxs-lookup"><span data-stu-id="485b0-203">Open the *Site.Master.cs* file.</span></span> <span data-ttu-id="485b0-204">Rendere la **Admin** collegamento visibile solo all'utente "canEditUser" aggiungendo il codice evidenziato in giallo per il `Page_Load` gestore.</span><span class="sxs-lookup"><span data-stu-id="485b0-204">Make the **Admin** link visible only to the "canEditUser" user by adding the code highlighted in yellow to the `Page_Load` handler.</span></span> <span data-ttu-id="485b0-205">Il `Page_Load` gestore apparirà come segue:</span><span class="sxs-lookup"><span data-stu-id="485b0-205">The `Page_Load` handler will appear as follows:</span></span>   

    [!code-csharp[Main](membership-and-administration/samples/sample6.cs?highlight=3-6)]

<span data-ttu-id="485b0-206">Quando la pagina viene caricata, il codice controlla se l'utente ha eseguito l'accesso dispone del ruolo di "canEdit".</span><span class="sxs-lookup"><span data-stu-id="485b0-206">When the page loads, the code checks whether the logged-in user has the role of "canEdit".</span></span> <span data-ttu-id="485b0-207">Se l'utente appartiene al ruolo "canEdit", l'elemento span contenente il collegamento per il *AdminPage.aspx* pagina (e, di conseguenza, il collegamento all'interno dell'estensione) viene reso visibile.</span><span class="sxs-lookup"><span data-stu-id="485b0-207">If the user belongs to the "canEdit" role, the span element containing the link to the *AdminPage.aspx* page (and consequently the link inside the span) is made visible.</span></span>

### <a name="enabling-product-administration"></a><span data-ttu-id="485b0-208">Abilitazione dell'amministrazione del prodotto</span><span class="sxs-lookup"><span data-stu-id="485b0-208">Enabling Product Administration</span></span>

<span data-ttu-id="485b0-209">Finora, aver creato il ruolo "canEdit" e aggiungere un utente di "canEditUser", una cartella di amministrazione e da una pagina di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-209">So far, you have created the "canEdit" role and added an "canEditUser" user, an administration folder, and an administration page.</span></span> <span data-ttu-id="485b0-210">Si dispongano di impostare i diritti di accesso per la cartella di amministrazione e la pagina e avrà aggiunto un collegamento di navigazione per l'utente del ruolo "canEdit" all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-210">You have set access rights for the administration folder and page, and have added a navigation link for the user of the "canEdit" role to the application.</span></span> <span data-ttu-id="485b0-211">Successivamente, verrà aggiunto il markup per il *AdminPage.aspx* pagina e scrivere il codice per il *AdminPage.aspx.cs* file code-behind che consentirà all'utente con il ruolo "canEdit" aggiungere e rimuovere i prodotti.</span><span class="sxs-lookup"><span data-stu-id="485b0-211">Next, you will add markup to the *AdminPage.aspx* page and code to the *AdminPage.aspx.cs* code-behind file that will enable the user with the "canEdit" role to add and remove products.</span></span>

1. <span data-ttu-id="485b0-212">Nella **Esplora soluzioni**, aprire il *AdminPage.aspx* del file dal *Admin* cartella.</span><span class="sxs-lookup"><span data-stu-id="485b0-212">In **Solution Explorer**, open the *AdminPage.aspx* file from the *Admin* folder.</span></span>
2. <span data-ttu-id="485b0-213">Sostituire il markup esistente con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="485b0-213">Replace the existing markup with the following:</span></span>  

    [!code-aspx[Main](membership-and-administration/samples/sample7.aspx)]
3. <span data-ttu-id="485b0-214">Successivamente, aprire il *AdminPage.aspx.cs* file code-behind facendo clic con il *AdminPage.aspx* e scegliendo **Visualizza codice**.</span><span class="sxs-lookup"><span data-stu-id="485b0-214">Next, open the *AdminPage.aspx.cs* code-behind file by right-clicking the *AdminPage.aspx* and clicking **View Code**.</span></span>
4. <span data-ttu-id="485b0-215">Sostituire il codice esistente nel *AdminPage.aspx.cs* file code-behind con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="485b0-215">Replace the existing code in the *AdminPage.aspx.cs* code-behind file with the following code:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample8.cs)]

<span data-ttu-id="485b0-216">Il codice immesso per il *AdminPage.aspx.cs* file code-behind, una classe denominata `AddProducts` esegue il lavoro effettivo dell'aggiunta di prodotti nel database.</span><span class="sxs-lookup"><span data-stu-id="485b0-216">In the code that you entered for the *AdminPage.aspx.cs* code-behind file, a class called `AddProducts` does the actual work of adding products to the database.</span></span> <span data-ttu-id="485b0-217">Questa classe non esiste ancora, in modo che si creerà ora.</span><span class="sxs-lookup"><span data-stu-id="485b0-217">This class doesn't exist yet, so you will create it now.</span></span>

1. <span data-ttu-id="485b0-218">Nella **Esplora soluzioni**, fare doppio clic il *per la logica* cartella e quindi selezionare **Add**  - &gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="485b0-218">In **Solution Explorer**, right-click the *Logic* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="485b0-219">Verrà visualizzata la finestra di dialogo **Aggiungi nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="485b0-219">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="485b0-220">Selezionare il **Visual c#**  - &gt; **codice** gruppo di modelli a sinistra.</span><span class="sxs-lookup"><span data-stu-id="485b0-220">Select the **Visual C#** -&gt; **Code** templates group on the left.</span></span> <span data-ttu-id="485b0-221">Quindi, selezionare **classe**dalla parte centrale elencare e denominarlo *AddProducts.cs*.</span><span class="sxs-lookup"><span data-stu-id="485b0-221">Then, select **Class**from the middle list and name it *AddProducts.cs*.</span></span>   
   <span data-ttu-id="485b0-222">Viene visualizzato il nuovo file di classe.</span><span class="sxs-lookup"><span data-stu-id="485b0-222">The new class file is displayed.</span></span>
3. <span data-ttu-id="485b0-223">Sostituire il codice esistente con quello seguente:</span><span class="sxs-lookup"><span data-stu-id="485b0-223">Replace the existing code with the following:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample9.cs)]

<span data-ttu-id="485b0-224">Il *AdminPage.aspx* pagina consente all'utente che appartengono al ruolo "canEdit" aggiungere e rimuovere i prodotti.</span><span class="sxs-lookup"><span data-stu-id="485b0-224">The *AdminPage.aspx* page allows the user belonging to the "canEdit" role to add and remove products.</span></span> <span data-ttu-id="485b0-225">Quando viene aggiunto un nuovo prodotto, i dettagli sul prodotto vengono convalidati e quindi immessi nel database.</span><span class="sxs-lookup"><span data-stu-id="485b0-225">When a new product is added, the details about the product are validated and then entered into the database.</span></span> <span data-ttu-id="485b0-226">Il nuovo prodotto è immediatamente disponibile per tutti gli utenti dell'applicazione web.</span><span class="sxs-lookup"><span data-stu-id="485b0-226">The new product is immediately available to all users of the web application.</span></span>

#### <a name="unobtrusive-validation"></a><span data-ttu-id="485b0-227">Convalida discreta</span><span class="sxs-lookup"><span data-stu-id="485b0-227">Unobtrusive Validation</span></span>

<span data-ttu-id="485b0-228">I dettagli del prodotto fornito dall'utente sul *AdminPage.aspx* pagina vengono convalidati mediante i controlli di convalida (`RequiredFieldValidator` e `RegularExpressionValidator`).</span><span class="sxs-lookup"><span data-stu-id="485b0-228">The product details that the user provides on the *AdminPage.aspx* page are validated using validation controls (`RequiredFieldValidator` and `RegularExpressionValidator`).</span></span> <span data-ttu-id="485b0-229">Questi controlli usano automaticamente la convalida discreta.</span><span class="sxs-lookup"><span data-stu-id="485b0-229">These controls automatically use unobtrusive validation.</span></span> <span data-ttu-id="485b0-230">La convalida discreta consente i controlli di convalida da usare JavaScript per la logica di convalida lato client, ovvero che la pagina non richiede una corsa al server da convalidare.</span><span class="sxs-lookup"><span data-stu-id="485b0-230">Unobtrusive validation allows the validation controls to use JavaScript for client-side validation logic, which means the page does not require a trip to the server to be validated.</span></span> <span data-ttu-id="485b0-231">Per impostazione predefinita, la convalida discreta è incluso nel *Web. config* file basato sull'impostazione di configurazione seguenti:</span><span class="sxs-lookup"><span data-stu-id="485b0-231">By default, unobtrusive validation is included in the *Web.config* file based on the following configuration setting:</span></span>

[!code-xml[Main](membership-and-administration/samples/sample10.xml)]

#### <a name="regular-expressions"></a><span data-ttu-id="485b0-232">Espressioni regolari</span><span class="sxs-lookup"><span data-stu-id="485b0-232">Regular Expressions</span></span>

<span data-ttu-id="485b0-233">Il prezzo del prodotto sul *AdminPage.aspx* pagina viene convalidata utilizzando un **RegularExpressionValidator** controllo.</span><span class="sxs-lookup"><span data-stu-id="485b0-233">The product price on the *AdminPage.aspx* page is validated using a **RegularExpressionValidator** control.</span></span> <span data-ttu-id="485b0-234">Questo controllo verifica che il valore di controllo di input associato (la casella di testo "AddProductPrice") corrisponde al pattern specificato dall'espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="485b0-234">This control validates whether the value of the associated input control (the "AddProductPrice" TextBox) matches the pattern specified by the regular expression.</span></span> <span data-ttu-id="485b0-235">Un'espressione regolare è una notazione di criteri di ricerca che consente di individuare rapidamente e corrispondono a modelli di caratteri specifica.</span><span class="sxs-lookup"><span data-stu-id="485b0-235">A regular expression is a pattern-matching notation that enables you to quickly find and match specific character patterns.</span></span> <span data-ttu-id="485b0-236">Il **RegularExpressionValidator** controllo include una proprietà denominata `ValidationExpression` che contiene l'espressione regolare utilizzata per convalidare l'input di prezzo, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="485b0-236">The **RegularExpressionValidator** control includes a property named `ValidationExpression` that contains the regular expression used to validate price input, as shown below:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample11.aspx)]

#### <a name="fileupload-control"></a><span data-ttu-id="485b0-237">Controllo fileUpload</span><span class="sxs-lookup"><span data-stu-id="485b0-237">FileUpload Control</span></span>

<span data-ttu-id="485b0-238">Oltre ai controlli di input e convalida, è stato aggiunto il **FileUpload** controllare per il *AdminPage.aspx* pagina.</span><span class="sxs-lookup"><span data-stu-id="485b0-238">In addition to the input and validation controls, you added the **FileUpload** control to the *AdminPage.aspx* page.</span></span> <span data-ttu-id="485b0-239">Questo controllo offre la possibilità di caricare i file.</span><span class="sxs-lookup"><span data-stu-id="485b0-239">This control provides the capability to upload files.</span></span> <span data-ttu-id="485b0-240">In questo caso, si consente solo i file di immagine da caricare.</span><span class="sxs-lookup"><span data-stu-id="485b0-240">In this case, you are only allowing image files to be uploaded.</span></span> <span data-ttu-id="485b0-241">Nel file code-behind (*AdminPage.aspx.cs*), quando il `AddProductButton` fa, il codice controlla il `HasFile` proprietà del **FileUpload** controllo.</span><span class="sxs-lookup"><span data-stu-id="485b0-241">In the code-behind file (*AdminPage.aspx.cs*), when the `AddProductButton` is clicked, the code checks the `HasFile` property of the **FileUpload** control.</span></span> <span data-ttu-id="485b0-242">Se il controllo dispone di un file e se il tipo di file (in base all'estensione) è consentito, l'immagine viene salvata per il *immagini* cartella e il *immagini/Thumbs* cartella dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-242">If the control has a file and if the file type (based on file extension) is allowed, the image is saved to the *Images* folder and the *Images/Thumbs* folder of the application.</span></span>

#### <a name="model-binding"></a><span data-ttu-id="485b0-243">Associazione di modelli</span><span class="sxs-lookup"><span data-stu-id="485b0-243">Model Binding</span></span>

<span data-ttu-id="485b0-244">In precedenza in questa serie di esercitazioni è stato usato l'associazione di modelli per popolare una **ListView** (controllo), un **FormsView** (controllo), una **GridView** (controllo) e un  **Un controllo DetailView** controllo.</span><span class="sxs-lookup"><span data-stu-id="485b0-244">Earlier in this tutorial series you used model binding to populate a **ListView** control, a **FormsView** control, a **GridView** control, and a **DetailView** control.</span></span> <span data-ttu-id="485b0-245">In questa esercitazione, si usa l'associazione di modelli per popolare una **DropDownList** controllo con un elenco delle categorie di prodotti.</span><span class="sxs-lookup"><span data-stu-id="485b0-245">In this tutorial, you use model binding to populate a **DropDownList** control with a list of product categories.</span></span>

<span data-ttu-id="485b0-246">Il markup che è stato aggiunto per il *AdminPage.aspx* file contiene una **DropDownList** controllo denominato `DropDownAddCategory`:</span><span class="sxs-lookup"><span data-stu-id="485b0-246">The markup that you added to the *AdminPage.aspx* file contains a **DropDownList** control called `DropDownAddCategory`:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample12.aspx)]

<span data-ttu-id="485b0-247">Si usa l'associazione di modelli per popolare questo **DropDownList** impostando il `ItemType` attributo e il `SelectMethod` attributo.</span><span class="sxs-lookup"><span data-stu-id="485b0-247">You use model binding to populate this **DropDownList** by setting the `ItemType` attribute and the `SelectMethod` attribute.</span></span> <span data-ttu-id="485b0-248">Il `ItemType` attributo specifica l'uso di `WingtipToys.Models.Category` digitare durante il popolamento del controllo.</span><span class="sxs-lookup"><span data-stu-id="485b0-248">The `ItemType` attribute specifies that you use the `WingtipToys.Models.Category` type when populating the control.</span></span> <span data-ttu-id="485b0-249">È definito questo tipo all'inizio di questa serie di esercitazioni creando il `Category` classe (mostrato sotto).</span><span class="sxs-lookup"><span data-stu-id="485b0-249">You defined this type at the beginning of this tutorial series by creating the `Category` class (shown below).</span></span> <span data-ttu-id="485b0-250">Il `Category` classe si trova nel *modelli* cartella all'interno di *Category.cs* file.</span><span class="sxs-lookup"><span data-stu-id="485b0-250">The `Category` class is in the *Models* folder inside the *Category.cs* file.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample13.cs)]

<span data-ttu-id="485b0-251">Il `SelectMethod` attributo del **DropDownList** controllo specifica l'uso di `GetCategories` metodo (mostrato sotto) che è incluso nel file code-behind (*AdminPage.aspx.cs*).</span><span class="sxs-lookup"><span data-stu-id="485b0-251">The `SelectMethod` attribute of the **DropDownList** control specifies that you use the `GetCategories` method (shown below) that is included in the code-behind file (*AdminPage.aspx.cs*).</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample14.cs)]

<span data-ttu-id="485b0-252">Questo metodo specifica che un `IQueryable` interfaccia viene utilizzata per valutare una query su un `Category` tipo.</span><span class="sxs-lookup"><span data-stu-id="485b0-252">This method specifies that an `IQueryable` interface is used to evaluate a query against a `Category` type.</span></span> <span data-ttu-id="485b0-253">Il valore restituito viene utilizzato per popolare la **DropDownList** nel markup della pagina (*AdminPage.aspx*).</span><span class="sxs-lookup"><span data-stu-id="485b0-253">The returned value is used to populate the **DropDownList** in the markup of the page (*AdminPage.aspx*).</span></span>

<span data-ttu-id="485b0-254">Il testo visualizzato per ogni elemento nell'elenco viene specificato impostando il `DataTextField` attributo.</span><span class="sxs-lookup"><span data-stu-id="485b0-254">The text displayed for each item in the list is specified by setting the `DataTextField` attribute.</span></span> <span data-ttu-id="485b0-255">Il `DataTextField` attributo viene utilizzato il `CategoryName` delle `Category` classe (illustrato in precedenza) per visualizzare ogni categoria nel **DropDownList** controllo.</span><span class="sxs-lookup"><span data-stu-id="485b0-255">The `DataTextField` attribute uses the `CategoryName` of the `Category` class (shown above) to display each category in the **DropDownList** control.</span></span> <span data-ttu-id="485b0-256">Il valore effettivo che viene passato quando viene selezionato un elemento nel **DropDownList** controllo basato sul `DataValueField` attributo.</span><span class="sxs-lookup"><span data-stu-id="485b0-256">The actual value that is passed when an item is selected in the **DropDownList** control is based on the `DataValueField` attribute.</span></span> <span data-ttu-id="485b0-257">Il `DataValueField` attributo è impostato il `CategoryID` come definire nel `Category` classe (illustrato in precedenza).</span><span class="sxs-lookup"><span data-stu-id="485b0-257">The `DataValueField` attribute is set to the `CategoryID` as define in the `Category` class (shown above).</span></span>

### <a name="how-the-application-will-work"></a><span data-ttu-id="485b0-258">Il funzionamento dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="485b0-258">How the Application Will Work</span></span>

<span data-ttu-id="485b0-259">Quando l'utente che appartengono al ruolo "canEdit" passa alla pagina per la prima volta, il `DropDownAddCategory` **DropDownList** controllo venga popolato come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="485b0-259">When the user belonging to the "canEdit" role navigates to the page for the first time, the `DropDownAddCategory`**DropDownList** control is populated as described above.</span></span> <span data-ttu-id="485b0-260">Il `DropDownRemoveProduct` **DropDownList** controllo viene anche popolato con i prodotti con lo stesso approccio.</span><span class="sxs-lookup"><span data-stu-id="485b0-260">The `DropDownRemoveProduct`**DropDownList** control is also populated with products using the same approach.</span></span> <span data-ttu-id="485b0-261">L'utente che appartengono al ruolo "canEdit" seleziona il tipo di categoria e aggiunge i dettagli del prodotto (**Name**, **descrizione**, **prezzo**, e **Filediimmagine**).</span><span class="sxs-lookup"><span data-stu-id="485b0-261">The user belonging to the "canEdit" role selects the category type and adds product details (**Name**, **Description**, **Price**, and **Image File**).</span></span> <span data-ttu-id="485b0-262">Quando l'utente che appartengono al ruolo "canEdit" Seleziona le **Aggiungi prodotto** pulsante, il `AddProductButton_Click` gestore dell'evento viene attivato.</span><span class="sxs-lookup"><span data-stu-id="485b0-262">When the user belonging to the "canEdit" role clicks the **Add Product** button, the `AddProductButton_Click` event handler is triggered.</span></span> <span data-ttu-id="485b0-263">Il `AddProductButton_Click` gestore dell'evento che si trova nel file code-behind (*AdminPage.aspx.cs*) controlla il file di immagine per assicurarsi che corrispondano ai tipi di file consentiti *(con estensione gif*, *PNG*, *JPEG*, o *jpg*).</span><span class="sxs-lookup"><span data-stu-id="485b0-263">The `AddProductButton_Click` event handler located in the code-behind file (*AdminPage.aspx.cs*) checks the image file to make sure it matches the allowed file types *(.gif*, *.png*, *.jpeg*, or *.jpg*).</span></span> <span data-ttu-id="485b0-264">Quindi, viene salvato il file di immagine in una cartella dell'applicazione di esempio Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="485b0-264">Then, the image file is saved into a folder of the Wingtip Toys sample application.</span></span> <span data-ttu-id="485b0-265">Successivamente, il nuovo prodotto viene aggiunto al database.</span><span class="sxs-lookup"><span data-stu-id="485b0-265">Next, the new product is added to the database.</span></span> <span data-ttu-id="485b0-266">Per eseguire l'aggiunta di un nuovo prodotto, una nuova istanza di `AddProducts` classe viene creata e denominata products.</span><span class="sxs-lookup"><span data-stu-id="485b0-266">To accomplish adding a new product, a new instance of the `AddProducts` class is created and named products.</span></span> <span data-ttu-id="485b0-267">Il `AddProducts` classe dispone di un metodo denominato `AddProduct`, e l'oggetto prodotti chiama questo metodo per aggiungere prodotti al database.</span><span class="sxs-lookup"><span data-stu-id="485b0-267">The `AddProducts` class has a method named `AddProduct`, and the products object calls this method to add products to the database.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample15.cs)]

<span data-ttu-id="485b0-268">Se il codice viene aggiunto correttamente il nuovo prodotto al database, la pagina viene ricaricata con il valore di stringa di query `ProductAction=add`.</span><span class="sxs-lookup"><span data-stu-id="485b0-268">If the code successfully adds the new product to the database, the page is reloaded with the query string value `ProductAction=add`.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample16.cs)]

<span data-ttu-id="485b0-269">Quando si ricarica la pagina, la stringa di query è incluso nell'URL.</span><span class="sxs-lookup"><span data-stu-id="485b0-269">When the page reloads, the query string is included in the URL.</span></span> <span data-ttu-id="485b0-270">Per ricaricare la pagina, l'utente che appartengono al ruolo "canEdit" è possibile visualizzare immediatamente gli aggiornamenti nel **DropDownList** ai controlli le *AdminPage.aspx* pagina.</span><span class="sxs-lookup"><span data-stu-id="485b0-270">By reloading the page, the user belonging to the "canEdit" role can immediately see the updates in the **DropDownList** controls on the *AdminPage.aspx* page.</span></span> <span data-ttu-id="485b0-271">Inoltre, includendo la stringa di query con l'URL, la pagina può visualizzare un messaggio di conferma all'utente che appartengono al ruolo "canEdit".</span><span class="sxs-lookup"><span data-stu-id="485b0-271">Also, by including the query string with the URL, the page can display a success message to the user belonging to the "canEdit" role.</span></span>

<span data-ttu-id="485b0-272">Quando la *AdminPage.aspx* pagina ricaricamenti, il `Page_Load` eventi viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="485b0-272">When the *AdminPage.aspx* page reloads, the `Page_Load` event is called.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample17.cs)]

<span data-ttu-id="485b0-273">Il `Page_Load` gestore eventi controlla il valore di stringa di query e determina se visualizzare un messaggio di conferma.</span><span class="sxs-lookup"><span data-stu-id="485b0-273">The `Page_Load` event handler checks the query string value and determines whether to show a success message.</span></span>

## <a name="running-the-application"></a><span data-ttu-id="485b0-274">Esecuzione dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="485b0-274">Running the Application</span></span>

<span data-ttu-id="485b0-275">È possibile eseguire l'applicazione ora per vedere come è possibile aggiungere, delete e update elementi nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="485b0-275">You can run the application now to see how you can add, delete, and update items in the shopping cart.</span></span> <span data-ttu-id="485b0-276">Il totale del carrello riporterà il costo totale di tutti gli elementi nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="485b0-276">The shopping cart total will reflect the total cost of all items in the shopping cart.</span></span>

1. <span data-ttu-id="485b0-277">In Esplora soluzioni, premere **F5** per eseguire l'applicazione di esempio Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="485b0-277">In Solution Explorer, press **F5** to run the Wingtip Toys sample application.</span></span>  
   <span data-ttu-id="485b0-278">Il browser si apre e Mostra le *default. aspx* pagina.</span><span class="sxs-lookup"><span data-stu-id="485b0-278">The browser opens and shows the *Default.aspx* page.</span></span>
2. <span data-ttu-id="485b0-279">Scegliere il **Accedi** collegamento nella parte superiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="485b0-279">Click the **Log in** link at the top of the page.</span></span> 

    ![L'appartenenza e amministrazione - Log nel collegamento](membership-and-administration/_static/image2.png)

   <span data-ttu-id="485b0-281">Il *aspx* viene visualizzata la pagina.</span><span class="sxs-lookup"><span data-stu-id="485b0-281">The *Login.aspx* page is displayed.</span></span>
3. <span data-ttu-id="485b0-282">Usare il seguente nome utente e la password:</span><span class="sxs-lookup"><span data-stu-id="485b0-282">Use the following user name and password:</span></span>  
   <span data-ttu-id="485b0-283">Nome utente: canEditUser@wingtiptoys.com</span><span class="sxs-lookup"><span data-stu-id="485b0-283">User name: canEditUser@wingtiptoys.com</span></span>  
   <span data-ttu-id="485b0-284">Password: Pa$$word1</span><span class="sxs-lookup"><span data-stu-id="485b0-284">Password: Pa$$word1</span></span> 

    ![Appartenenza e amministrazione - pagina di accesso](membership-and-administration/_static/image3.png)
4. <span data-ttu-id="485b0-286">Scegliere il **Accedi** pulsante nella parte inferiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="485b0-286">Click the **Log in** button near the bottom of the page.</span></span>
5. <span data-ttu-id="485b0-287">Nella parte superiore della pagina successiva, selezionare la **Admin** collegamento per passare alle *AdminPage.aspx* pagina.</span><span class="sxs-lookup"><span data-stu-id="485b0-287">At the top of the next page, select the **Admin** link to navigate to the *AdminPage.aspx* page.</span></span> 

    ![L'appartenenza e amministrazione: collegamento di amministrazione](membership-and-administration/_static/image4.png)
6. <span data-ttu-id="485b0-289">Per testare la convalida dell'input, selezionare la **Aggiungi prodotto** pulsante senza aggiungere i dettagli del prodotto.</span><span class="sxs-lookup"><span data-stu-id="485b0-289">To test the input validation, click the **Add Product** button without adding any product details.</span></span> 

    ![Appartenenza e amministrazione - pagina di amministrazione](membership-and-administration/_static/image5.png)

   <span data-ttu-id="485b0-291">Si noti che vengono visualizzati i messaggi di campo obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="485b0-291">Notice that the required field messages are displayed.</span></span>
7. <span data-ttu-id="485b0-292">Aggiungere i dettagli per un nuovo prodotto e quindi scegliere il **Aggiungi prodotto** pulsante.</span><span class="sxs-lookup"><span data-stu-id="485b0-292">Add the details for a new product, and then click the **Add Product** button.</span></span> 

    ![Appartenenza e amministrazione - Aggiungi prodotto](membership-and-administration/_static/image6.png)
8. <span data-ttu-id="485b0-294">Selezionare **prodotti** dal menu di spostamento superiore per visualizzare il nuovo prodotto è stato aggiunto.</span><span class="sxs-lookup"><span data-stu-id="485b0-294">Select **Products** from the top navigation menu to view the new product you added.</span></span> 

    ![Appartenenza e amministrazione - prodotto nuovo Show](membership-and-administration/_static/image7.png)
9. <span data-ttu-id="485b0-296">Scegliere il **Admin** collegamento per tornare alla pagina di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-296">Click the **Admin** link to return to the administration page.</span></span>
10. <span data-ttu-id="485b0-297">Nel **rimuovere prodotto** sezione della pagina, selezionare il nuovo prodotto aggiunto nel **DropDownListBox**.</span><span class="sxs-lookup"><span data-stu-id="485b0-297">In the **Remove Product** section of the page, select the new product you added in the **DropDownListBox**.</span></span>
11. <span data-ttu-id="485b0-298">Scegliere il **rimuovere prodotto** pulsante per rimuovere il nuovo prodotto dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-298">Click the **Remove Product** button to remove the new product from the application.</span></span> 

    ![Appartenenza e amministrazione - Rimuovi prodotto](membership-and-administration/_static/image8.png)
12. <span data-ttu-id="485b0-300">Selezionare **prodotti** dal menu di spostamento superiore per confermare che il prodotto è stata rimossa.</span><span class="sxs-lookup"><span data-stu-id="485b0-300">Select **Products** from the top navigation menu to confirm that the product has been removed.</span></span>
13. <span data-ttu-id="485b0-301">Fare clic su **disconnettersi** esista la modalità di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="485b0-301">Click **Log off** to exist administration mode.</span></span>   
    <span data-ttu-id="485b0-302">Si noti che il riquadro di spostamento in alto non viene più visualizzato il **Admin** voce di menu.</span><span class="sxs-lookup"><span data-stu-id="485b0-302">Notice that the top navigation pane no longer shows the **Admin** menu item.</span></span>

## <a name="summary"></a><span data-ttu-id="485b0-303">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="485b0-303">Summary</span></span>

<span data-ttu-id="485b0-304">In questa esercitazione aggiunto un ruolo personalizzato e un utente appartenente al ruolo personalizzato, accesso limitato alla cartella di amministrazione, pagina e forniti navigazione per l'utente che appartengono al ruolo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="485b0-304">In this tutorial, you added a custom role and a user belonging to the custom role, restricted access to the administration folder and page, and provided navigation for the user belonging to the custom role.</span></span> <span data-ttu-id="485b0-305">Associazione di modelli è utilizzato per popolare una **DropDownList** controllo con i dati.</span><span class="sxs-lookup"><span data-stu-id="485b0-305">You used model binding to populate a **DropDownList** control with data.</span></span> <span data-ttu-id="485b0-306">È stato implementato il **FileUpload** controllo e i controlli di convalida.</span><span class="sxs-lookup"><span data-stu-id="485b0-306">You implemented the **FileUpload** control and validation controls.</span></span> <span data-ttu-id="485b0-307">Inoltre, si è appreso come aggiungere e rimuovere i prodotti da un database.</span><span class="sxs-lookup"><span data-stu-id="485b0-307">Also, you have learned how to add and remove products from a database.</span></span> <span data-ttu-id="485b0-308">Nella prossima esercitazione, verrà illustrato come implementare il routing di ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="485b0-308">In the next tutorial, you'll learn how to implement ASP.NET routing.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="485b0-309">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="485b0-309">Additional Resources</span></span>

<span data-ttu-id="485b0-310">[Web. config - elemento authorization](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="485b0-310">[Web.config - authorization Element](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span></span>  
[<span data-ttu-id="485b0-311">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="485b0-311">ASP.NET Identity</span></span>](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md)  
[<span data-ttu-id="485b0-312">Distribuire un'App di moduli Web ASP.NET sicura con appartenenza, OAuth e Database SQL in un sito Web Azure</span><span class="sxs-lookup"><span data-stu-id="485b0-312">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to an Azure Web Site</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)  
[<span data-ttu-id="485b0-313">Microsoft Azure - versione di valutazione gratuita</span><span class="sxs-lookup"><span data-stu-id="485b0-313">Microsoft Azure - Free Trial</span></span>](https://azure.microsoft.com/pricing/free-trial/)

> [!div class="step-by-step"]
> <span data-ttu-id="485b0-314">[Precedente](checkout-and-payment-with-paypal.md)
> [Successivo](url-routing.md)</span><span class="sxs-lookup"><span data-stu-id="485b0-314">[Previous](checkout-and-payment-with-paypal.md)
[Next](url-routing.md)</span></span>
