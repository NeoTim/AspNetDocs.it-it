---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
title: Appartenenza e amministrazione | Microsoft Docs
author: Erikre
description: Questa serie di esercitazioni illustra le nozioni di base per la creazione di un'applicazione Web Form ASP.NET con ASP.NET 4,5 e Microsoft Visual Studio Express 2013...
ms.author: riande
ms.date: 09/08/2014
ms.assetid: 732a2316-e49f-4f72-becd-0cd72f14457e
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
msc.type: authoredcontent
ms.openlocfilehash: ab00bc90bfc767d06e747be6dfb973245b5aae88
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78546739"
---
# <a name="membership-and-administration"></a><span data-ttu-id="59397-103">Appartenenza e amministrazione</span><span class="sxs-lookup"><span data-stu-id="59397-103">Membership and Administration</span></span>

<span data-ttu-id="59397-104">di [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="59397-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="59397-105">[Scaricare il progetto di esempio WingtipC#Toys ()](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) o [scaricare l'E-Book (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="59397-105">[Download Wingtip Toys Sample Project (C#)](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="59397-106">Questa serie di esercitazioni illustra le nozioni di base per la creazione di un'applicazione Web Form ASP.NET con ASP.NET 4,5 e Microsoft Visual Studio Express 2013 per il Web.</span><span class="sxs-lookup"><span data-stu-id="59397-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="59397-107">Per accompagnare questa serie di esercitazioni è disponibile un [progetto Visual Studio 2013 C# con codice sorgente](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) .</span><span class="sxs-lookup"><span data-stu-id="59397-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>

<span data-ttu-id="59397-108">Questa esercitazione illustra come aggiornare l'applicazione di esempio Wingtip Toys per aggiungere un ruolo personalizzato e usare ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="59397-108">This tutorial shows you how to update the Wingtip Toys sample application to add a custom role and use ASP.NET Identity.</span></span> <span data-ttu-id="59397-109">Viene inoltre illustrato come implementare una pagina di amministrazione dalla quale l'utente con un ruolo personalizzato può aggiungere e rimuovere prodotti dal sito Web.</span><span class="sxs-lookup"><span data-stu-id="59397-109">It also shows you how to implement an administration page from which the user with a custom role can add and remove products from the website.</span></span>

<span data-ttu-id="59397-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) è il sistema di appartenenze usato per compilare l'applicazione Web ASP.NET ed è disponibile in ASP.NET 4,5.</span><span class="sxs-lookup"><span data-stu-id="59397-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) is the membership system used to build ASP.NET web application and is available in ASP.NET 4.5.</span></span> <span data-ttu-id="59397-111">ASP.NET Identity viene utilizzato nel modello di progetto Web Form Visual Studio 2013, nonché nei modelli per l' [applicazione a pagina singola](../../../../single-page-application/index.md) [ASP.NET MVC](../../../../mvc/index.md), [API Web ASP.NET](../../../../web-api/index.md)e ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="59397-111">ASP.NET Identity is used in the Visual Studio 2013 Web Forms project template, as well as the templates for [ASP.NET MVC](../../../../mvc/index.md), [ASP.NET Web API](../../../../web-api/index.md), and [ASP.NET Single Page Application](../../../../single-page-application/index.md).</span></span> <span data-ttu-id="59397-112">È anche possibile installare in modo specifico il sistema di ASP.NET Identity usando NuGet quando si inizia con un'applicazione Web vuota.</span><span class="sxs-lookup"><span data-stu-id="59397-112">You can also specifically install the ASP.NET Identity system using NuGet when you start with an empty Web application.</span></span> <span data-ttu-id="59397-113">Tuttavia, in questa serie di esercitazioni viene usato il ProjectTemplate **Web Form**, che include il sistema di ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="59397-113">However, in this tutorial series you use the **Web Forms**projecttemplate, which includes the ASP.NET Identity system.</span></span> <span data-ttu-id="59397-114">ASP.NET Identity semplifica l'integrazione dei dati di profilo specifici dell'utente con i dati dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="59397-114">ASP.NET Identity makes it easy to integrate user-specific profile data with application data.</span></span> <span data-ttu-id="59397-115">ASP.NET Identity consente inoltre di scegliere il modello di persistenza dei profili utente nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="59397-115">Also, ASP.NET Identity allows you to choose the persistence model for user profiles in your application.</span></span> <span data-ttu-id="59397-116">È possibile archiviare i dati in un database SQL Server o in un altro archivio dati, inclusi gli archivi dati *NoSQL* , ad esempio le tabelle di archiviazione di Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="59397-116">You can store the data in a SQL Server database or another data store, including *NoSQL* data stores such as Windows Azure Storage Tables.</span></span>

<span data-ttu-id="59397-117">Questa esercitazione si basa sull'esercitazione precedente intitolata "Checkout e pagamento con PayPal" nella serie di esercitazioni su Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="59397-117">This tutorial builds on the previous tutorial titled "Checkout and Payment with PayPal" in the Wingtip Toys tutorial series.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="59397-118">Contenuto dell'esercitazione:</span><span class="sxs-lookup"><span data-stu-id="59397-118">What you'll learn:</span></span>

- <span data-ttu-id="59397-119">Come usare il codice per aggiungere un ruolo personalizzato e un utente all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="59397-119">How to use code to add a custom role and a user to the application.</span></span>
- <span data-ttu-id="59397-120">Come limitare l'accesso alla cartella e alla pagina di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="59397-120">How to restrict access to the administration folder and page.</span></span>
- <span data-ttu-id="59397-121">Come fornire la navigazione per l'utente che appartiene al ruolo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="59397-121">How to provide navigation for the user that belongs to the custom role.</span></span>
- <span data-ttu-id="59397-122">Come utilizzare l'associazione di modelli per popolare un controllo [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) con categorie di prodotti.</span><span class="sxs-lookup"><span data-stu-id="59397-122">How to use model binding to populate a [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) control with product categories.</span></span>
- <span data-ttu-id="59397-123">Come caricare un file nell'applicazione Web usando il controllo [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="59397-123">How to upload a file to the web application using the [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) control.</span></span>
- <span data-ttu-id="59397-124">Come usare i controlli di convalida per implementare la convalida dell'input.</span><span class="sxs-lookup"><span data-stu-id="59397-124">How to use validation controls to implement input validation.</span></span>
- <span data-ttu-id="59397-125">Come aggiungere e rimuovere prodotti dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="59397-125">How to add and remove products from the application.</span></span>

## <a name="these-features-are-included-in-the-tutorial"></a><span data-ttu-id="59397-126">Queste funzionalità sono incluse nell'esercitazione:</span><span class="sxs-lookup"><span data-stu-id="59397-126">These features are included in the tutorial:</span></span>

- <span data-ttu-id="59397-127">Identità ASP.NET</span><span class="sxs-lookup"><span data-stu-id="59397-127">ASP.NET Identity</span></span>
- <span data-ttu-id="59397-128">Configurazione e autorizzazione</span><span class="sxs-lookup"><span data-stu-id="59397-128">Configuration and Authorization</span></span>
- <span data-ttu-id="59397-129">Associazione di modelli</span><span class="sxs-lookup"><span data-stu-id="59397-129">Model Binding</span></span>
- <span data-ttu-id="59397-130">Convalida non intrusiva</span><span class="sxs-lookup"><span data-stu-id="59397-130">Unobtrusive Validation</span></span>

<span data-ttu-id="59397-131">ASP.NET Web Form fornisce funzionalità di appartenenza.</span><span class="sxs-lookup"><span data-stu-id="59397-131">ASP.NET Web Forms provides membership capabilities.</span></span> <span data-ttu-id="59397-132">Utilizzando il modello predefinito, sono disponibili funzionalità di appartenenza predefinite che è possibile utilizzare immediatamente durante l'esecuzione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="59397-132">By using the default template, you have built-in membership functionality that you can immediately use when the application runs.</span></span> <span data-ttu-id="59397-133">Questa esercitazione illustra come usare ASP.NET Identity per aggiungere un ruolo personalizzato e assegnare un utente a tale ruolo.</span><span class="sxs-lookup"><span data-stu-id="59397-133">This tutorial shows you how to use ASP.NET Identity to add a custom role and assign a user to that role.</span></span> <span data-ttu-id="59397-134">Si apprenderà come limitare l'accesso alla cartella di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="59397-134">You will learn how to restrict access to the administration folder.</span></span> <span data-ttu-id="59397-135">Si aggiungerà una pagina alla cartella di amministrazione che consente a un utente con un ruolo personalizzato di aggiungere e rimuovere prodotti e di visualizzare in anteprima un prodotto dopo che è stato aggiunto.</span><span class="sxs-lookup"><span data-stu-id="59397-135">You'll add a page to the administration folder that allows a user with a custom role to add and remove products, and to preview a product after it has been added.</span></span>

## <a name="adding-a-custom-role"></a><span data-ttu-id="59397-136">Aggiunta di un ruolo personalizzato</span><span class="sxs-lookup"><span data-stu-id="59397-136">Adding a Custom Role</span></span>

<span data-ttu-id="59397-137">Utilizzando ASP.NET Identity, è possibile aggiungere un ruolo personalizzato e assegnare un utente a tale ruolo utilizzando il codice.</span><span class="sxs-lookup"><span data-stu-id="59397-137">Using ASP.NET Identity, you can add a custom role and assign a user to that role using code.</span></span>

1. <span data-ttu-id="59397-138">In **Esplora soluzioni**fare clic con il pulsante destro del mouse sulla cartella della *logica* e creare una nuova classe.</span><span class="sxs-lookup"><span data-stu-id="59397-138">In **Solution Explorer**, right-click on the *Logic* folder and create a new class.</span></span>
2. <span data-ttu-id="59397-139">Assegnare alla nuova classe il nome *RoleActions.cs*.</span><span class="sxs-lookup"><span data-stu-id="59397-139">Name the new class *RoleActions.cs*.</span></span>
3. <span data-ttu-id="59397-140">Modificare il codice in modo che venga visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="59397-140">Modify the code so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample1.cs?highlight=8)]
4. <span data-ttu-id="59397-141">In **Esplora soluzioni**aprire il file *Global.asax.cs* .</span><span class="sxs-lookup"><span data-stu-id="59397-141">In **Solution Explorer**, open the *Global.asax.cs* file.</span></span>
5. <span data-ttu-id="59397-142">Modificare il file *Global.asax.cs* aggiungendo il codice evidenziato in giallo, in modo che venga visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="59397-142">Modify the *Global.asax.cs* file by adding the code highlighted in yellow so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample2.cs?highlight=11,26-28)]
6. <span data-ttu-id="59397-143">Si noti che `AddUserAndRole` è sottolineato in rosso.</span><span class="sxs-lookup"><span data-stu-id="59397-143">Notice that `AddUserAndRole` is underlined in red.</span></span> <span data-ttu-id="59397-144">Fare doppio clic sul codice AddUserAndRole.</span><span class="sxs-lookup"><span data-stu-id="59397-144">Double-click the AddUserAndRole code.</span></span>  
   <span data-ttu-id="59397-145">La lettera "A" all'inizio del metodo evidenziato sarà sottolineata.</span><span class="sxs-lookup"><span data-stu-id="59397-145">The letter "A" at the beginning of the highlighted method will be underlined.</span></span>
7. <span data-ttu-id="59397-146">Passare il puntatore sulla lettera "A" e fare clic sull'interfaccia utente che consente di generare uno stub del metodo per il metodo `AddUserAndRole`.</span><span class="sxs-lookup"><span data-stu-id="59397-146">Hover over the letter "A" and click the UI that allows you to generate a method stub for the `AddUserAndRole` method.</span></span> 

    ![Appartenenza e amministrazione-genera stub metodo](membership-and-administration/_static/image1.png)
8. <span data-ttu-id="59397-148">Fare clic sull'opzione denominata:</span><span class="sxs-lookup"><span data-stu-id="59397-148">Click the option titled:</span></span>  
    `Generate method stub for "AddUserAndRole" in "WingtipToys.Logic.RoleActions"`
9. <span data-ttu-id="59397-149">Aprire il file *RoleActions.cs* dalla cartella *logica* .</span><span class="sxs-lookup"><span data-stu-id="59397-149">Open the *RoleActions.cs* file from the *Logic* folder.</span></span>  
   <span data-ttu-id="59397-150">Il metodo `AddUserAndRole` è stato aggiunto al file di classe.</span><span class="sxs-lookup"><span data-stu-id="59397-150">The `AddUserAndRole` method has been added to the class file.</span></span>
10. <span data-ttu-id="59397-151">Modificare il file *RoleActions.cs* rimuovendo il `NotImplementedException` e aggiungendo il codice evidenziato in giallo, in modo che venga visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="59397-151">Modify the *RoleActions.cs* file by removing the `NotImplementedException` and adding the code highlighted in yellow, so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample3.cs?highlight=5-7,15-51)]

<span data-ttu-id="59397-152">Il codice precedente stabilisce innanzitutto un contesto di database per il database delle appartenenze.</span><span class="sxs-lookup"><span data-stu-id="59397-152">The above code first establishes a database context for the membership database.</span></span> <span data-ttu-id="59397-153">Il database delle appartenenze viene inoltre archiviato come file con *estensione MDF* nella cartella *app\_data* .</span><span class="sxs-lookup"><span data-stu-id="59397-153">The membership database is also stored as an *.mdf* file in the *App\_Data* folder.</span></span> <span data-ttu-id="59397-154">Sarà possibile visualizzare il database dopo che il primo utente ha eseguito l'accesso a questa applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="59397-154">You will be able to view this database once the first user has signed in to this web application.</span></span> 

> [!NOTE] 
> 
> <span data-ttu-id="59397-155">Se si desidera archiviare i dati di appartenenza insieme ai dati del prodotto, è possibile utilizzare lo stesso **DbContext** utilizzato per archiviare i dati del prodotto nel codice riportato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="59397-155">If you wish to store the membership data along with the product data, you can consider using the same **DbContext** that you used to store the product data in the above code.</span></span>

 <span data-ttu-id="59397-156">La parola chiave *Internal* è un modificatore di accesso per i tipi, ad esempio le classi, e i membri del tipo (ad esempio metodi o proprietà).</span><span class="sxs-lookup"><span data-stu-id="59397-156">The *internal* keyword is an access modifier for types (such as classes) and type members (such as methods or properties).</span></span> <span data-ttu-id="59397-157">I tipi o i membri interni sono accessibili solo all'interno di file contenuti nello stesso assembly (file con *estensione dll* ).</span><span class="sxs-lookup"><span data-stu-id="59397-157">Internal types or members are accessible only within files contained in the same assembly *(.dll* file).</span></span> <span data-ttu-id="59397-158">Quando si compila l'applicazione, viene creato un file di assembly *(con estensione dll*) che contiene il codice che viene eseguito quando si esegue l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="59397-158">When you build your application, an assembly file *(.dll*) is created that contains the code that is executed when you run your application.</span></span> 

<span data-ttu-id="59397-159">Un oggetto `RoleStore`, che fornisce la gestione dei ruoli, viene creato in base al contesto del database.</span><span class="sxs-lookup"><span data-stu-id="59397-159">A `RoleStore` object, which provides role management, is created based on the database context.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="59397-160">Si noti che quando viene creato l'oggetto `RoleStore`, viene usato un tipo di `IdentityRole` generico.</span><span class="sxs-lookup"><span data-stu-id="59397-160">Notice that when the `RoleStore` object is created it uses a Generic `IdentityRole` type.</span></span> <span data-ttu-id="59397-161">Ciò significa che l'`RoleStore` è consentita solo per contenere `IdentityRole` oggetti.</span><span class="sxs-lookup"><span data-stu-id="59397-161">This means that the `RoleStore` is only allowed to contain `IdentityRole` objects.</span></span> <span data-ttu-id="59397-162">Inoltre, utilizzando i generics, le risorse in memoria sono gestite meglio.</span><span class="sxs-lookup"><span data-stu-id="59397-162">Also by using Generics, resources in memory are handled better.</span></span>

<span data-ttu-id="59397-163">Successivamente, l'oggetto `RoleManager` viene creato in base all'oggetto `RoleStore` appena creato.</span><span class="sxs-lookup"><span data-stu-id="59397-163">Next, the `RoleManager` object, is created based on the `RoleStore` object that you just created.</span></span> <span data-ttu-id="59397-164">l'oggetto `RoleManager` espone l'API relativa ai ruoli che può essere usata per salvare automaticamente le modifiche apportate al `RoleStore`.</span><span class="sxs-lookup"><span data-stu-id="59397-164">the `RoleManager` object exposes role related API which can be used to automatically save changes to the `RoleStore`.</span></span> <span data-ttu-id="59397-165">Il `RoleManager` può contenere solo oggetti `IdentityRole` perché il codice usa il tipo generico `<IdentityRole>`.</span><span class="sxs-lookup"><span data-stu-id="59397-165">The `RoleManager` is only allowed to contain `IdentityRole` objects because the code uses the `<IdentityRole>` Generic type.</span></span>

<span data-ttu-id="59397-166">Chiamare il metodo `RoleExists` per determinare se il ruolo "canEdit" è presente nel database delle appartenenze.</span><span class="sxs-lookup"><span data-stu-id="59397-166">You call the `RoleExists` method to determine if the "canEdit" role is present in the membership database.</span></span> <span data-ttu-id="59397-167">In caso contrario, è necessario creare il ruolo.</span><span class="sxs-lookup"><span data-stu-id="59397-167">If it is not, you create the role.</span></span>

<span data-ttu-id="59397-168">La creazione dell'oggetto `UserManager` sembra essere più complessa rispetto al controllo `RoleManager`, ma è quasi uguale.</span><span class="sxs-lookup"><span data-stu-id="59397-168">Creating the `UserManager` object appears to be more complicated than the `RoleManager` control, however it is nearly the same.</span></span> <span data-ttu-id="59397-169">Viene appena codificata in una riga anziché in più.</span><span class="sxs-lookup"><span data-stu-id="59397-169">It is just coded on one line rather than several.</span></span> <span data-ttu-id="59397-170">In questo caso, il parametro passato sta creando un'istanza come nuovo oggetto contenuto nella parentesi.</span><span class="sxs-lookup"><span data-stu-id="59397-170">Here, the parameter that you are passing is instantiating as a new object contained in the parenthesis.</span></span>

<span data-ttu-id="59397-171">Successivamente, creare l'utente "canEditUser" creando un nuovo oggetto `ApplicationUser`.</span><span class="sxs-lookup"><span data-stu-id="59397-171">Next you create the "canEditUser" user by creating a new `ApplicationUser` object.</span></span> <span data-ttu-id="59397-172">Quindi, se l'utente è stato creato correttamente, l'utente viene aggiunto al nuovo ruolo.</span><span class="sxs-lookup"><span data-stu-id="59397-172">Then, if you successfully create the user, you add the user to the new role.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="59397-173">La gestione degli errori verrà aggiornata durante l'esercitazione "gestione degli errori ASP.NET" più avanti in questa serie di esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="59397-173">The error handling will be updated during the "ASP.NET Error Handling" tutorial later in this tutorial series.</span></span>

<span data-ttu-id="59397-174">Al successivo avvio dell'applicazione, l'utente denominato "canEditUser" verrà aggiunto come ruolo denominato "canEdit" dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="59397-174">The next time the application starts, the user named "canEditUser" will be added as the role named "canEdit" of the application.</span></span> <span data-ttu-id="59397-175">Più avanti in questa esercitazione si effettuerà l'accesso come utente "canEditUser" per visualizzare le funzionalità aggiuntive che si aggiungeranno durante questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="59397-175">Later in this tutorial, you will login as the "canEditUser" user to display additional capabilities that you will added during this tutorial.</span></span> <span data-ttu-id="59397-176">Per informazioni dettagliate sull'API ASP.NET Identity, vedere lo [spazio dei nomi Microsoft. AspNet. Identity](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span><span class="sxs-lookup"><span data-stu-id="59397-176">For API details about ASP.NET Identity, see the [Microsoft.AspNet.Identity Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span></span> <span data-ttu-id="59397-177">Per ulteriori informazioni sull'inizializzazione del sistema di ASP.NET Identity, vedere [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span><span class="sxs-lookup"><span data-stu-id="59397-177">For additional details about initializing the ASP.NET Identity system, see the [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span></span>

### <a name="restricting-access-to-the-administration-page"></a><span data-ttu-id="59397-178">Limitazione dell'accesso alla pagina di amministrazione</span><span class="sxs-lookup"><span data-stu-id="59397-178">Restricting Access to the Administration Page</span></span>

<span data-ttu-id="59397-179">L'applicazione di esempio Wingtip Toys consente a utenti anonimi e utenti connessi di visualizzare e acquistare i prodotti.</span><span class="sxs-lookup"><span data-stu-id="59397-179">The Wingtip Toys sample application allows both anonymous users and logged-in users to view and purchase products.</span></span> <span data-ttu-id="59397-180">Tuttavia, l'utente che ha eseguito l'accesso con il ruolo "canEdit" personalizzato può accedere a una pagina con restrizioni per aggiungere e rimuovere i prodotti.</span><span class="sxs-lookup"><span data-stu-id="59397-180">However, the logged-in user that has the custom "canEdit" role can access a restricted page in order to add and remove products.</span></span>

#### <a name="add-an-administration-folder-and-page"></a><span data-ttu-id="59397-181">Aggiungere una cartella di amministrazione e una pagina</span><span class="sxs-lookup"><span data-stu-id="59397-181">Add an Administration Folder and Page</span></span>

<span data-ttu-id="59397-182">Si creerà quindi una cartella denominata *admin* per l'utente "canEditUser" appartenente al ruolo personalizzato dell'applicazione di esempio Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="59397-182">Next, you will create a folder named *Admin* for the "canEditUser" user belonging to the custom role of the Wingtip Toys sample application.</span></span>

1. <span data-ttu-id="59397-183">Fare clic con il pulsante destro del mouse sul nome del progetto (**Wingtip Toys**) in **Esplora soluzioni** e scegliere **Aggiungi** -&gt; **nuova cartella**.</span><span class="sxs-lookup"><span data-stu-id="59397-183">Right-click the project name (**Wingtip Toys**) in **Solution Explorer** and select **Add** -&gt; **New Folder**.</span></span>
2. <span data-ttu-id="59397-184">Assegnare un nome alla nuova cartella *admin*.</span><span class="sxs-lookup"><span data-stu-id="59397-184">Name the new folder *Admin*.</span></span>
3. <span data-ttu-id="59397-185">Fare clic con il pulsante destro del mouse sulla cartella *Amministrazione* , quindi scegliere **Aggiungi** -&gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="59397-185">Right-click the *Admin* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="59397-186">Verrà visualizzata la finestra di dialogo **Aggiungi nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="59397-186">The **Add New Item** dialog box is displayed.</span></span>
4. <span data-ttu-id="59397-187">Selezionare il <strong>gruppo C# Visual</strong>-&gt; modelli <strong>Web</strong> a sinistra.</span><span class="sxs-lookup"><span data-stu-id="59397-187">Select the <strong>Visual C#</strong>-&gt; <strong>Web</strong> templates group on the left.</span></span> <span data-ttu-id="59397-188">Dall'elenco centrale selezionare <strong>Web Form con la pagina master</strong>, denominarlo <em>AdminPage. aspx</em><strong>e quindi</strong> selezionare <strong>Aggiungi</strong>.</span><span class="sxs-lookup"><span data-stu-id="59397-188">From the middle list, select <strong>Web Form with Master Page</strong>,name it <em>AdminPage.aspx</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
5. <span data-ttu-id="59397-189">Selezionare il file *site. master* come pagina master, quindi scegliere **OK**.</span><span class="sxs-lookup"><span data-stu-id="59397-189">Select the *Site.Master* file as the master page, and then choose **OK**.</span></span>

#### <a name="add-a-webconfig-file"></a><span data-ttu-id="59397-190">Aggiungere un file Web. config</span><span class="sxs-lookup"><span data-stu-id="59397-190">Add a Web.config File</span></span>

<span data-ttu-id="59397-191">Aggiungendo un file *Web. config* alla cartella *amministratore* , è possibile limitare l'accesso alla pagina contenuta nella cartella.</span><span class="sxs-lookup"><span data-stu-id="59397-191">By adding a *Web.config* file to the *Admin* folder, you can restrict access to the page contained in the folder.</span></span>

1. <span data-ttu-id="59397-192">Fare clic con il pulsante destro del mouse sulla cartella *Amministrazione* e scegliere **Aggiungi** -&gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="59397-192">Right-click the *Admin* folder and select **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="59397-193">Verrà visualizzata la finestra di dialogo **Aggiungi nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="59397-193">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="59397-194">Dall'elenco di modelli Web C# visivi, selezionare <strong>file di configurazione Web</strong>dall'elenco centrale, accettare il nome predefinito di <em>Web. config</em><strong>,</strong> quindi selezionare <strong>Aggiungi</strong>.</span><span class="sxs-lookup"><span data-stu-id="59397-194">From the list of Visual C# web templates, select <strong>Web Configuration File</strong>from the middle list, accept the default name of <em>Web.config</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
3. <span data-ttu-id="59397-195">Sostituire il contenuto XML esistente nel file *Web.config* con il contenuto seguente:</span><span class="sxs-lookup"><span data-stu-id="59397-195">Replace the existing XML content in the *Web.config* file with the following:</span></span>  

    [!code-xml[Main](membership-and-administration/samples/sample4.xml)]

<span data-ttu-id="59397-196">Salvare il file *Web.config* .</span><span class="sxs-lookup"><span data-stu-id="59397-196">Save the *Web.config* file.</span></span> <span data-ttu-id="59397-197">Il file *Web. config* specifica che solo l'utente che appartiene al ruolo "canEdit" dell'applicazione può accedere alla pagina contenuta nella cartella *admin* .</span><span class="sxs-lookup"><span data-stu-id="59397-197">The *Web.config* file specifies that only user belonging to the "canEdit" role of the application can access the page contained in the *Admin* folder.</span></span>

### <a name="including-custom-role-navigation"></a><span data-ttu-id="59397-198">Inclusione dell'esplorazione del ruolo personalizzato</span><span class="sxs-lookup"><span data-stu-id="59397-198">Including Custom Role Navigation</span></span>

<span data-ttu-id="59397-199">Per consentire all'utente del ruolo "canEdit" personalizzato di passare alla sezione amministrazione dell'applicazione, è necessario aggiungere un collegamento alla pagina *site. master* .</span><span class="sxs-lookup"><span data-stu-id="59397-199">To enable the user of the custom "canEdit" role to navigate to the administration section of the application, you must add a link to the *Site.Master* page.</span></span> <span data-ttu-id="59397-200">Solo gli utenti che appartengono al ruolo "canEdit" saranno in grado di visualizzare il collegamento **amministratore** e accedere alla sezione amministrazione.</span><span class="sxs-lookup"><span data-stu-id="59397-200">Only users that belong to the "canEdit" role will be able to see the **Admin** link and access the administration section.</span></span>

1. <span data-ttu-id="59397-201">In Esplora soluzioni individuare e aprire la pagina *site. master* .</span><span class="sxs-lookup"><span data-stu-id="59397-201">In Solution Explorer, find and open the *Site.Master* page.</span></span>
2. <span data-ttu-id="59397-202">Per creare un collegamento per l'utente del ruolo "canEdit", aggiungere il markup evidenziato in giallo all'elenco non ordinato seguente `<ul>` elemento in modo che l'elenco venga visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="59397-202">To create a link for the user of the "canEdit" role, add the markup highlighted in yellow to the following unordered list `<ul>` element so that the list appears as follows:</span></span>  

    [!code-html[Main](membership-and-administration/samples/sample5.html?highlight=2-3)]
3. <span data-ttu-id="59397-203">Aprire il file *site.master.cs* .</span><span class="sxs-lookup"><span data-stu-id="59397-203">Open the *Site.Master.cs* file.</span></span> <span data-ttu-id="59397-204">Rendere il collegamento **amministratore** visibile solo all'utente "canEditUser" aggiungendo il codice evidenziato in giallo al gestore `Page_Load`.</span><span class="sxs-lookup"><span data-stu-id="59397-204">Make the **Admin** link visible only to the "canEditUser" user by adding the code highlighted in yellow to the `Page_Load` handler.</span></span> <span data-ttu-id="59397-205">Il gestore `Page_Load` verrà visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="59397-205">The `Page_Load` handler will appear as follows:</span></span>   

    [!code-csharp[Main](membership-and-administration/samples/sample6.cs?highlight=3-6)]

<span data-ttu-id="59397-206">Quando la pagina viene caricata, il codice controlla se l'utente connesso ha il ruolo di "canEdit".</span><span class="sxs-lookup"><span data-stu-id="59397-206">When the page loads, the code checks whether the logged-in user has the role of "canEdit".</span></span> <span data-ttu-id="59397-207">Se l'utente appartiene al ruolo "canEdit", l'elemento Span contenente il collegamento alla pagina *AdminPage. aspx* (e di conseguenza il collegamento nell'intervallo) viene reso visibile.</span><span class="sxs-lookup"><span data-stu-id="59397-207">If the user belongs to the "canEdit" role, the span element containing the link to the *AdminPage.aspx* page (and consequently the link inside the span) is made visible.</span></span>

### <a name="enabling-product-administration"></a><span data-ttu-id="59397-208">Abilitazione dell'amministrazione del prodotto</span><span class="sxs-lookup"><span data-stu-id="59397-208">Enabling Product Administration</span></span>

<span data-ttu-id="59397-209">Fino a questo punto, è stato creato il ruolo "canEdit" e sono stati aggiunti un utente "canEditUser", una cartella di amministrazione e una pagina di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="59397-209">So far, you have created the "canEdit" role and added an "canEditUser" user, an administration folder, and an administration page.</span></span> <span data-ttu-id="59397-210">Sono stati impostati i diritti di accesso per la cartella e la pagina di amministrazione e è stato aggiunto un collegamento di navigazione per l'utente del ruolo "canEdit" all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="59397-210">You have set access rights for the administration folder and page, and have added a navigation link for the user of the "canEdit" role to the application.</span></span> <span data-ttu-id="59397-211">Successivamente, si aggiungerà il markup alla pagina *AdminPage. aspx* e al codice al file code-behind *AdminPage.aspx.cs* che consentirà all'utente con il ruolo "canEdit" di aggiungere e rimuovere i prodotti.</span><span class="sxs-lookup"><span data-stu-id="59397-211">Next, you will add markup to the *AdminPage.aspx* page and code to the *AdminPage.aspx.cs* code-behind file that will enable the user with the "canEdit" role to add and remove products.</span></span>

1. <span data-ttu-id="59397-212">In **Esplora soluzioni**aprire il file *AdminPage. aspx* dalla cartella *admin* .</span><span class="sxs-lookup"><span data-stu-id="59397-212">In **Solution Explorer**, open the *AdminPage.aspx* file from the *Admin* folder.</span></span>
2. <span data-ttu-id="59397-213">Sostituire il markup esistente con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="59397-213">Replace the existing markup with the following:</span></span>  

    [!code-aspx[Main](membership-and-administration/samples/sample7.aspx)]
3. <span data-ttu-id="59397-214">Successivamente, aprire il file code-behind *AdminPage.aspx.cs* facendo clic con il pulsante destro del mouse su *AdminPage. aspx* e scegliendo **Visualizza codice**.</span><span class="sxs-lookup"><span data-stu-id="59397-214">Next, open the *AdminPage.aspx.cs* code-behind file by right-clicking the *AdminPage.aspx* and clicking **View Code**.</span></span>
4. <span data-ttu-id="59397-215">Sostituire il codice esistente nel file code-behind *AdminPage.aspx.cs* con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="59397-215">Replace the existing code in the *AdminPage.aspx.cs* code-behind file with the following code:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample8.cs)]

<span data-ttu-id="59397-216">Nel codice immesso per il file code-behind *AdminPage.aspx.cs* , una classe denominata `AddProducts` esegue le operazioni effettive di aggiunta di prodotti al database.</span><span class="sxs-lookup"><span data-stu-id="59397-216">In the code that you entered for the *AdminPage.aspx.cs* code-behind file, a class called `AddProducts` does the actual work of adding products to the database.</span></span> <span data-ttu-id="59397-217">Questa classe non esiste ancora, quindi verrà creata ora.</span><span class="sxs-lookup"><span data-stu-id="59397-217">This class doesn't exist yet, so you will create it now.</span></span>

1. <span data-ttu-id="59397-218">In **Esplora soluzioni**fare clic con il pulsante destro del mouse sulla cartella *logica* , quindi scegliere **Aggiungi** -&gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="59397-218">In **Solution Explorer**, right-click the *Logic* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="59397-219">Verrà visualizzata la finestra di dialogo **Aggiungi nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="59397-219">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="59397-220">Selezionare il **gruppo C# Visual** -&gt; modelli di **codice** a sinistra.</span><span class="sxs-lookup"><span data-stu-id="59397-220">Select the **Visual C#** -&gt; **Code** templates group on the left.</span></span> <span data-ttu-id="59397-221">Quindi, selezionare **classe**nell'elenco centrale e denominarla *AddProducts.cs*.</span><span class="sxs-lookup"><span data-stu-id="59397-221">Then, select **Class**from the middle list and name it *AddProducts.cs*.</span></span>   
   <span data-ttu-id="59397-222">Viene visualizzato il nuovo file di classe.</span><span class="sxs-lookup"><span data-stu-id="59397-222">The new class file is displayed.</span></span>
3. <span data-ttu-id="59397-223">Sostituire il codice esistente con quello seguente:</span><span class="sxs-lookup"><span data-stu-id="59397-223">Replace the existing code with the following:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample9.cs)]

<span data-ttu-id="59397-224">La pagina *AdminPage. aspx* consente all'utente che appartiene al ruolo "canEdit" di aggiungere e rimuovere i prodotti.</span><span class="sxs-lookup"><span data-stu-id="59397-224">The *AdminPage.aspx* page allows the user belonging to the "canEdit" role to add and remove products.</span></span> <span data-ttu-id="59397-225">Quando viene aggiunto un nuovo prodotto, i dettagli relativi al prodotto vengono convalidati e quindi immessi nel database.</span><span class="sxs-lookup"><span data-stu-id="59397-225">When a new product is added, the details about the product are validated and then entered into the database.</span></span> <span data-ttu-id="59397-226">Il nuovo prodotto è immediatamente disponibile per tutti gli utenti dell'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="59397-226">The new product is immediately available to all users of the web application.</span></span>

#### <a name="unobtrusive-validation"></a><span data-ttu-id="59397-227">Convalida non intrusiva</span><span class="sxs-lookup"><span data-stu-id="59397-227">Unobtrusive Validation</span></span>

<span data-ttu-id="59397-228">I dettagli del prodotto forniti dall'utente nella pagina *AdminPage. aspx* vengono convalidati utilizzando i controlli di convalida (`RequiredFieldValidator` e `RegularExpressionValidator`).</span><span class="sxs-lookup"><span data-stu-id="59397-228">The product details that the user provides on the *AdminPage.aspx* page are validated using validation controls (`RequiredFieldValidator` and `RegularExpressionValidator`).</span></span> <span data-ttu-id="59397-229">Questi controlli utilizzano automaticamente la convalida non intrusiva.</span><span class="sxs-lookup"><span data-stu-id="59397-229">These controls automatically use unobtrusive validation.</span></span> <span data-ttu-id="59397-230">La convalida non intrusiva consente ai controlli di convalida di utilizzare JavaScript per la logica di convalida lato client, il che significa che la pagina non richiede un viaggio al server per la convalida.</span><span class="sxs-lookup"><span data-stu-id="59397-230">Unobtrusive validation allows the validation controls to use JavaScript for client-side validation logic, which means the page does not require a trip to the server to be validated.</span></span> <span data-ttu-id="59397-231">Per impostazione predefinita, la convalida non intrusiva è inclusa nel file *Web. config* in base all'impostazione di configurazione seguente:</span><span class="sxs-lookup"><span data-stu-id="59397-231">By default, unobtrusive validation is included in the *Web.config* file based on the following configuration setting:</span></span>

[!code-xml[Main](membership-and-administration/samples/sample10.xml)]

#### <a name="regular-expressions"></a><span data-ttu-id="59397-232">Espressioni regolari</span><span class="sxs-lookup"><span data-stu-id="59397-232">Regular Expressions</span></span>

<span data-ttu-id="59397-233">Il prezzo del prodotto nella pagina *AdminPage. aspx* viene convalidato tramite un controllo **RegularExpressionValidator** .</span><span class="sxs-lookup"><span data-stu-id="59397-233">The product price on the *AdminPage.aspx* page is validated using a **RegularExpressionValidator** control.</span></span> <span data-ttu-id="59397-234">Questo controllo consente di verificare se il valore del controllo di input associato (la casella di testo "AddProductPrice") corrisponde al modello specificato dall'espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="59397-234">This control validates whether the value of the associated input control (the "AddProductPrice" TextBox) matches the pattern specified by the regular expression.</span></span> <span data-ttu-id="59397-235">Un'espressione regolare è una notazione corrispondente che consente di trovare e confrontare rapidamente modelli di caratteri specifici.</span><span class="sxs-lookup"><span data-stu-id="59397-235">A regular expression is a pattern-matching notation that enables you to quickly find and match specific character patterns.</span></span> <span data-ttu-id="59397-236">Il controllo **RegularExpressionValidator** include una proprietà denominata `ValidationExpression` che contiene l'espressione regolare usata per convalidare l'input del prezzo, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="59397-236">The **RegularExpressionValidator** control includes a property named `ValidationExpression` that contains the regular expression used to validate price input, as shown below:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample11.aspx)]

#### <a name="fileupload-control"></a><span data-ttu-id="59397-237">Controllo FileUpload</span><span class="sxs-lookup"><span data-stu-id="59397-237">FileUpload Control</span></span>

<span data-ttu-id="59397-238">Oltre ai controlli di input e di convalida, il controllo **FileUpload** è stato aggiunto alla pagina *AdminPage. aspx* .</span><span class="sxs-lookup"><span data-stu-id="59397-238">In addition to the input and validation controls, you added the **FileUpload** control to the *AdminPage.aspx* page.</span></span> <span data-ttu-id="59397-239">Questo controllo fornisce la possibilità di caricare file.</span><span class="sxs-lookup"><span data-stu-id="59397-239">This control provides the capability to upload files.</span></span> <span data-ttu-id="59397-240">In questo caso, si consente il caricamento solo dei file di immagine.</span><span class="sxs-lookup"><span data-stu-id="59397-240">In this case, you are only allowing image files to be uploaded.</span></span> <span data-ttu-id="59397-241">Nel file code-behind (*AdminPage.aspx.cs*), quando si fa clic sul `AddProductButton`, il codice controlla la proprietà `HasFile` del controllo **FileUpload** .</span><span class="sxs-lookup"><span data-stu-id="59397-241">In the code-behind file (*AdminPage.aspx.cs*), when the `AddProductButton` is clicked, the code checks the `HasFile` property of the **FileUpload** control.</span></span> <span data-ttu-id="59397-242">Se il controllo contiene un file e il tipo di file (basato sull'estensione di file) è consentito, l'immagine viene salvata nella cartella *Immagini* e nella cartella *Immagini/thumbs* dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="59397-242">If the control has a file and if the file type (based on file extension) is allowed, the image is saved to the *Images* folder and the *Images/Thumbs* folder of the application.</span></span>

#### <a name="model-binding"></a><span data-ttu-id="59397-243">Associazione di modelli</span><span class="sxs-lookup"><span data-stu-id="59397-243">Model Binding</span></span>

<span data-ttu-id="59397-244">In precedenza in questa serie di esercitazioni è stata usata l'associazione di modelli per popolare un controllo **ListView** , un controllo **FormsView** , un controllo **GridView** e un controllo **controllo DetailView per** .</span><span class="sxs-lookup"><span data-stu-id="59397-244">Earlier in this tutorial series you used model binding to populate a **ListView** control, a **FormsView** control, a **GridView** control, and a **DetailView** control.</span></span> <span data-ttu-id="59397-245">In questa esercitazione si usa l'associazione di modelli per popolare un controllo **DropDownList** con un elenco di categorie di prodotti.</span><span class="sxs-lookup"><span data-stu-id="59397-245">In this tutorial, you use model binding to populate a **DropDownList** control with a list of product categories.</span></span>

<span data-ttu-id="59397-246">Il markup aggiunto al file *AdminPage. aspx* contiene un controllo **DropDownList** denominato `DropDownAddCategory`:</span><span class="sxs-lookup"><span data-stu-id="59397-246">The markup that you added to the *AdminPage.aspx* file contains a **DropDownList** control called `DropDownAddCategory`:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample12.aspx)]

<span data-ttu-id="59397-247">È possibile utilizzare l'associazione di modelli per popolare questo **DropDownList** impostando l'attributo `ItemType` e l'attributo `SelectMethod`.</span><span class="sxs-lookup"><span data-stu-id="59397-247">You use model binding to populate this **DropDownList** by setting the `ItemType` attribute and the `SelectMethod` attribute.</span></span> <span data-ttu-id="59397-248">L'attributo `ItemType` specifica di usare il tipo di `WingtipToys.Models.Category` quando si compila il controllo.</span><span class="sxs-lookup"><span data-stu-id="59397-248">The `ItemType` attribute specifies that you use the `WingtipToys.Models.Category` type when populating the control.</span></span> <span data-ttu-id="59397-249">Questo tipo è stato definito all'inizio di questa serie di esercitazioni creando la classe `Category` (mostrata di seguito).</span><span class="sxs-lookup"><span data-stu-id="59397-249">You defined this type at the beginning of this tutorial series by creating the `Category` class (shown below).</span></span> <span data-ttu-id="59397-250">La classe `Category` si trova nella cartella *Models* all'interno del file *Category.cs* .</span><span class="sxs-lookup"><span data-stu-id="59397-250">The `Category` class is in the *Models* folder inside the *Category.cs* file.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample13.cs)]

<span data-ttu-id="59397-251">L'attributo `SelectMethod` del controllo **DropDownList** specifica che si usa il metodo `GetCategories` (illustrato di seguito) incluso nel file code-behind (*AdminPage.aspx.cs*).</span><span class="sxs-lookup"><span data-stu-id="59397-251">The `SelectMethod` attribute of the **DropDownList** control specifies that you use the `GetCategories` method (shown below) that is included in the code-behind file (*AdminPage.aspx.cs*).</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample14.cs)]

<span data-ttu-id="59397-252">Questo metodo specifica che un'interfaccia `IQueryable` viene utilizzata per valutare una query in base a un tipo di `Category`.</span><span class="sxs-lookup"><span data-stu-id="59397-252">This method specifies that an `IQueryable` interface is used to evaluate a query against a `Category` type.</span></span> <span data-ttu-id="59397-253">Il valore restituito viene utilizzato per popolare l'oggetto **DropDownList** nel markup della pagina (*AdminPage. aspx*).</span><span class="sxs-lookup"><span data-stu-id="59397-253">The returned value is used to populate the **DropDownList** in the markup of the page (*AdminPage.aspx*).</span></span>

<span data-ttu-id="59397-254">Il testo visualizzato per ogni elemento nell'elenco viene specificato impostando l'attributo `DataTextField`.</span><span class="sxs-lookup"><span data-stu-id="59397-254">The text displayed for each item in the list is specified by setting the `DataTextField` attribute.</span></span> <span data-ttu-id="59397-255">L'attributo `DataTextField` utilizza la `CategoryName` della classe `Category` (illustrata in precedenza) per visualizzare ogni categoria nel controllo **DropDownList** .</span><span class="sxs-lookup"><span data-stu-id="59397-255">The `DataTextField` attribute uses the `CategoryName` of the `Category` class (shown above) to display each category in the **DropDownList** control.</span></span> <span data-ttu-id="59397-256">Il valore effettivo che viene passato quando si seleziona un elemento nel controllo **DropDownList** è basato sull'attributo `DataValueField`.</span><span class="sxs-lookup"><span data-stu-id="59397-256">The actual value that is passed when an item is selected in the **DropDownList** control is based on the `DataValueField` attribute.</span></span> <span data-ttu-id="59397-257">L'attributo `DataValueField` viene impostato sul `CategoryID` come definito nella classe `Category` (illustrata in precedenza).</span><span class="sxs-lookup"><span data-stu-id="59397-257">The `DataValueField` attribute is set to the `CategoryID` as define in the `Category` class (shown above).</span></span>

### <a name="how-the-application-will-work"></a><span data-ttu-id="59397-258">Funzionamento dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="59397-258">How the Application Will Work</span></span>

<span data-ttu-id="59397-259">Quando l'utente che appartiene al ruolo "canEdit" passa alla pagina per la prima volta, il `DropDownAddCategory`controllo **DropDownList** viene popolato come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="59397-259">When the user belonging to the "canEdit" role navigates to the page for the first time, the `DropDownAddCategory`**DropDownList** control is populated as described above.</span></span> <span data-ttu-id="59397-260">Il `DropDownRemoveProduct`controllo **DropDownList** viene inoltre popolato con i prodotti che utilizzano lo stesso approccio.</span><span class="sxs-lookup"><span data-stu-id="59397-260">The `DropDownRemoveProduct`**DropDownList** control is also populated with products using the same approach.</span></span> <span data-ttu-id="59397-261">L'utente che appartiene al ruolo "canEdit" Seleziona il tipo di categoria e aggiunge i dettagli del prodotto, ovvero**nome**, **Descrizione**, **Prezzo**e **file di immagine**.</span><span class="sxs-lookup"><span data-stu-id="59397-261">The user belonging to the "canEdit" role selects the category type and adds product details (**Name**, **Description**, **Price**, and **Image File**).</span></span> <span data-ttu-id="59397-262">Quando l'utente che appartiene al ruolo "canEdit" fa clic sul pulsante **Aggiungi prodotto** , viene attivato il gestore dell'evento `AddProductButton_Click`.</span><span class="sxs-lookup"><span data-stu-id="59397-262">When the user belonging to the "canEdit" role clicks the **Add Product** button, the `AddProductButton_Click` event handler is triggered.</span></span> <span data-ttu-id="59397-263">Il gestore dell'evento `AddProductButton_Click` che si trova nel file code-behind (*AdminPage.aspx.cs*) controlla il file di immagine per assicurarsi che corrisponda ai tipi di file consentiti *(. gif*, *. png*, *. jpeg*o *. jpg*).</span><span class="sxs-lookup"><span data-stu-id="59397-263">The `AddProductButton_Click` event handler located in the code-behind file (*AdminPage.aspx.cs*) checks the image file to make sure it matches the allowed file types *(.gif*, *.png*, *.jpeg*, or *.jpg*).</span></span> <span data-ttu-id="59397-264">Il file di immagine viene quindi salvato in una cartella dell'applicazione di esempio Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="59397-264">Then, the image file is saved into a folder of the Wingtip Toys sample application.</span></span> <span data-ttu-id="59397-265">Il nuovo prodotto verrà quindi aggiunto al database.</span><span class="sxs-lookup"><span data-stu-id="59397-265">Next, the new product is added to the database.</span></span> <span data-ttu-id="59397-266">Per completare l'aggiunta di un nuovo prodotto, viene creata una nuova istanza della classe `AddProducts` e vengono denominati i prodotti.</span><span class="sxs-lookup"><span data-stu-id="59397-266">To accomplish adding a new product, a new instance of the `AddProducts` class is created and named products.</span></span> <span data-ttu-id="59397-267">La classe `AddProducts` dispone di un metodo denominato `AddProduct`e l'oggetto Products chiama questo metodo per aggiungere prodotti al database.</span><span class="sxs-lookup"><span data-stu-id="59397-267">The `AddProducts` class has a method named `AddProduct`, and the products object calls this method to add products to the database.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample15.cs)]

<span data-ttu-id="59397-268">Se il codice aggiunge correttamente il nuovo prodotto al database, la pagina viene ricaricata con il valore della stringa di query `ProductAction=add`.</span><span class="sxs-lookup"><span data-stu-id="59397-268">If the code successfully adds the new product to the database, the page is reloaded with the query string value `ProductAction=add`.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample16.cs)]

<span data-ttu-id="59397-269">Quando la pagina viene ricaricata, la stringa di query viene inclusa nell'URL.</span><span class="sxs-lookup"><span data-stu-id="59397-269">When the page reloads, the query string is included in the URL.</span></span> <span data-ttu-id="59397-270">Ricaricando la pagina, l'utente che appartiene al ruolo "canEdit" può visualizzare immediatamente gli aggiornamenti nei controlli **DropDownList** nella pagina *AdminPage. aspx* .</span><span class="sxs-lookup"><span data-stu-id="59397-270">By reloading the page, the user belonging to the "canEdit" role can immediately see the updates in the **DropDownList** controls on the *AdminPage.aspx* page.</span></span> <span data-ttu-id="59397-271">Inoltre, includendo la stringa di query con l'URL, nella pagina è possibile visualizzare un messaggio di operazione riuscita per l'utente che appartiene al ruolo "canEdit".</span><span class="sxs-lookup"><span data-stu-id="59397-271">Also, by including the query string with the URL, the page can display a success message to the user belonging to the "canEdit" role.</span></span>

<span data-ttu-id="59397-272">Quando la pagina *AdminPage. aspx* viene ricaricata, viene chiamato l'evento `Page_Load`.</span><span class="sxs-lookup"><span data-stu-id="59397-272">When the *AdminPage.aspx* page reloads, the `Page_Load` event is called.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample17.cs)]

<span data-ttu-id="59397-273">Il gestore dell'evento `Page_Load` controlla il valore della stringa di query e determina se visualizzare un messaggio di operazione riuscita.</span><span class="sxs-lookup"><span data-stu-id="59397-273">The `Page_Load` event handler checks the query string value and determines whether to show a success message.</span></span>

## <a name="running-the-application"></a><span data-ttu-id="59397-274">Esecuzione dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="59397-274">Running the Application</span></span>

<span data-ttu-id="59397-275">È possibile eseguire ora l'applicazione per vedere come è possibile aggiungere, eliminare e aggiornare gli elementi nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="59397-275">You can run the application now to see how you can add, delete, and update items in the shopping cart.</span></span> <span data-ttu-id="59397-276">Il totale del carrello acquisti riflette il costo totale di tutti gli elementi nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="59397-276">The shopping cart total will reflect the total cost of all items in the shopping cart.</span></span>

1. <span data-ttu-id="59397-277">In Esplora soluzioni premere **F5** per eseguire l'applicazione di esempio Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="59397-277">In Solution Explorer, press **F5** to run the Wingtip Toys sample application.</span></span>  
   <span data-ttu-id="59397-278">Verrà aperto il browser e verrà visualizzata la pagina *default. aspx* .</span><span class="sxs-lookup"><span data-stu-id="59397-278">The browser opens and shows the *Default.aspx* page.</span></span>
2. <span data-ttu-id="59397-279">Fare clic sul collegamento **Accedi nella** parte superiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="59397-279">Click the **Log in** link at the top of the page.</span></span> 

    ![Appartenenza e amministrazione-collegamento accedi](membership-and-administration/_static/image2.png)

   <span data-ttu-id="59397-281">Verrà visualizzata la pagina *login. aspx* .</span><span class="sxs-lookup"><span data-stu-id="59397-281">The *Login.aspx* page is displayed.</span></span>
3. <span data-ttu-id="59397-282">Usare il nome utente e la password seguenti:</span><span class="sxs-lookup"><span data-stu-id="59397-282">Use the following user name and password:</span></span>  
   <span data-ttu-id="59397-283">Nome utente: canEditUser@wingtiptoys.com</span><span class="sxs-lookup"><span data-stu-id="59397-283">User name: canEditUser@wingtiptoys.com</span></span>  
   <span data-ttu-id="59397-284">Password: Pa$$word1</span><span class="sxs-lookup"><span data-stu-id="59397-284">Password: Pa$$word1</span></span> 

    ![Appartenenza e amministrazione-pagina di accesso](membership-and-administration/_static/image3.png)
4. <span data-ttu-id="59397-286">Fare clic sul pulsante **Accedi nella** parte inferiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="59397-286">Click the **Log in** button near the bottom of the page.</span></span>
5. <span data-ttu-id="59397-287">Nella parte superiore della pagina successiva selezionare il collegamento **amministratore** per passare alla pagina *AdminPage. aspx* .</span><span class="sxs-lookup"><span data-stu-id="59397-287">At the top of the next page, select the **Admin** link to navigate to the *AdminPage.aspx* page.</span></span> 

    ![Appartenenza e amministrazione-collegamento amministratore](membership-and-administration/_static/image4.png)
6. <span data-ttu-id="59397-289">Per testare la convalida dell'input, fare clic sul pulsante **Aggiungi prodotto** senza aggiungere i dettagli del prodotto.</span><span class="sxs-lookup"><span data-stu-id="59397-289">To test the input validation, click the **Add Product** button without adding any product details.</span></span> 

    ![Appartenenza e amministrazione-pagina amministratore](membership-and-administration/_static/image5.png)

   <span data-ttu-id="59397-291">Si noti che vengono visualizzati i messaggi di campo obbligatori.</span><span class="sxs-lookup"><span data-stu-id="59397-291">Notice that the required field messages are displayed.</span></span>
7. <span data-ttu-id="59397-292">Aggiungere i dettagli per un nuovo prodotto, quindi fare clic sul pulsante **Aggiungi prodotto** .</span><span class="sxs-lookup"><span data-stu-id="59397-292">Add the details for a new product, and then click the **Add Product** button.</span></span> 

    ![Appartenenza e amministrazione-Aggiungi prodotto](membership-and-administration/_static/image6.png)
8. <span data-ttu-id="59397-294">Selezionare **prodotti** dal menu di spostamento superiore per visualizzare il nuovo prodotto aggiunto.</span><span class="sxs-lookup"><span data-stu-id="59397-294">Select **Products** from the top navigation menu to view the new product you added.</span></span> 

    ![Appartenenza e amministrazione-Mostra nuovo prodotto](membership-and-administration/_static/image7.png)
9. <span data-ttu-id="59397-296">Fare clic sul collegamento **amministratore** per tornare alla pagina di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="59397-296">Click the **Admin** link to return to the administration page.</span></span>
10. <span data-ttu-id="59397-297">Nella sezione **Rimuovi prodotto** della pagina selezionare il nuovo prodotto aggiunto in **DropDownListBox**.</span><span class="sxs-lookup"><span data-stu-id="59397-297">In the **Remove Product** section of the page, select the new product you added in the **DropDownListBox**.</span></span>
11. <span data-ttu-id="59397-298">Fare clic sul pulsante **Rimuovi prodotto** per rimuovere il nuovo prodotto dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="59397-298">Click the **Remove Product** button to remove the new product from the application.</span></span> 

    ![Appartenenza e amministrazione-Rimuovi prodotto](membership-and-administration/_static/image8.png)
12. <span data-ttu-id="59397-300">Selezionare **prodotti** dal menu di spostamento superiore per confermare che il prodotto è stato rimosso.</span><span class="sxs-lookup"><span data-stu-id="59397-300">Select **Products** from the top navigation menu to confirm that the product has been removed.</span></span>
13. <span data-ttu-id="59397-301">Fare clic su **Disconnetti** per esistere in modalità di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="59397-301">Click **Log off** to exist administration mode.</span></span>   
    <span data-ttu-id="59397-302">Si noti che nel riquadro di spostamento superiore non viene più visualizzata la voce di menu **admin** .</span><span class="sxs-lookup"><span data-stu-id="59397-302">Notice that the top navigation pane no longer shows the **Admin** menu item.</span></span>

## <a name="summary"></a><span data-ttu-id="59397-303">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="59397-303">Summary</span></span>

<span data-ttu-id="59397-304">In questa esercitazione sono stati aggiunti un ruolo personalizzato e un utente appartenente al ruolo personalizzato, l'accesso limitato alla cartella e alla pagina di amministrazione e la navigazione per l'utente appartenente al ruolo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="59397-304">In this tutorial, you added a custom role and a user belonging to the custom role, restricted access to the administration folder and page, and provided navigation for the user belonging to the custom role.</span></span> <span data-ttu-id="59397-305">È stata utilizzata l'associazione di modelli per popolare un controllo **DropDownList** con dati.</span><span class="sxs-lookup"><span data-stu-id="59397-305">You used model binding to populate a **DropDownList** control with data.</span></span> <span data-ttu-id="59397-306">Sono stati implementati il controllo **FileUpload** e i controlli di convalida.</span><span class="sxs-lookup"><span data-stu-id="59397-306">You implemented the **FileUpload** control and validation controls.</span></span> <span data-ttu-id="59397-307">Si è inoltre appreso come aggiungere e rimuovere prodotti da un database.</span><span class="sxs-lookup"><span data-stu-id="59397-307">Also, you have learned how to add and remove products from a database.</span></span> <span data-ttu-id="59397-308">Nell'esercitazione successiva si apprenderà come implementare il routing ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="59397-308">In the next tutorial, you'll learn how to implement ASP.NET routing.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="59397-309">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="59397-309">Additional Resources</span></span>

<span data-ttu-id="59397-310">[Web. config-elemento authorization](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="59397-310">[Web.config - authorization Element](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span></span>  
[<span data-ttu-id="59397-311">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="59397-311">ASP.NET Identity</span></span>](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md)  
[<span data-ttu-id="59397-312">Distribuire un'app Web Form ASP.NET sicura con appartenenza, OAuth e database SQL in un sito Web di Azure</span><span class="sxs-lookup"><span data-stu-id="59397-312">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to an Azure Web Site</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)  
[<span data-ttu-id="59397-313">Versione di valutazione gratuita di Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="59397-313">Microsoft Azure - Free Trial</span></span>](https://azure.microsoft.com/pricing/free-trial/)

> [!div class="step-by-step"]
> <span data-ttu-id="59397-314">[Precedente](checkout-and-payment-with-paypal.md)
> [Successivo](url-routing.md)</span><span class="sxs-lookup"><span data-stu-id="59397-314">[Previous](checkout-and-payment-with-paypal.md)
[Next](url-routing.md)</span></span>
