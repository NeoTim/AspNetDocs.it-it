---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
title: Introduzione con Entity Framework 4,0 Database First e ASP.NET 4 Web Forms-parte 3 | Microsoft Docs
author: tdykstra
description: L'applicazione Web di esempio di Contoso University illustra come creare applicazioni Web Form ASP.NET usando il Entity Framework. L'applicazione di esempio è...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: ccdc3f8c-2568-40a7-8f8b-3c23d2e05388
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
msc.type: authoredcontent
ms.openlocfilehash: 88debb11a9157dce9ff000b1cb459b876dbceaf3
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78643248"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-3"></a><span data-ttu-id="31b54-104">Introduzione con Entity Framework 4,0 Database First e ASP.NET 4 Web Forms-parte 3</span><span class="sxs-lookup"><span data-stu-id="31b54-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 3</span></span>

<span data-ttu-id="31b54-105">di [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="31b54-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="31b54-106">L'applicazione Web di esempio di Contoso University illustra come creare applicazioni Web Form ASP.NET usando il Entity Framework 4,0 e Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="31b54-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="31b54-107">Per informazioni sulla serie di esercitazioni, vedere [la prima esercitazione della serie](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="31b54-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="filtering-ordering-and-grouping-data"></a><span data-ttu-id="31b54-108">Filtro, ordinamento e raggruppamento di dati</span><span class="sxs-lookup"><span data-stu-id="31b54-108">Filtering, Ordering, and Grouping Data</span></span>

<span data-ttu-id="31b54-109">Nell'esercitazione precedente è stato usato il controllo `EntityDataSource` per visualizzare e modificare i dati.</span><span class="sxs-lookup"><span data-stu-id="31b54-109">In the previous tutorial you used the `EntityDataSource` control to display and edit data.</span></span> <span data-ttu-id="31b54-110">In questa esercitazione verranno filtrati, ordinati e raggruppati i dati.</span><span class="sxs-lookup"><span data-stu-id="31b54-110">In this tutorial you'll filter, order, and group data.</span></span> <span data-ttu-id="31b54-111">Quando si esegue questa operazione impostando le proprietà del controllo `EntityDataSource`, la sintassi è diversa dagli altri controlli origine dati.</span><span class="sxs-lookup"><span data-stu-id="31b54-111">When you do this by setting properties of the `EntityDataSource` control, the syntax is different from other data source controls.</span></span> <span data-ttu-id="31b54-112">Come si vedrà, tuttavia, è possibile usare il controllo `QueryExtender` per ridurre al minimo queste differenze.</span><span class="sxs-lookup"><span data-stu-id="31b54-112">As you'll see, however, you can use the `QueryExtender` control to minimize these differences.</span></span>

<span data-ttu-id="31b54-113">Si modificherà la pagina *students. aspx* per filtrare gli studenti, ordinare per nome e cercare il nome.</span><span class="sxs-lookup"><span data-stu-id="31b54-113">You'll change the *Students.aspx* page to filter for students, sort by name, and search on name.</span></span> <span data-ttu-id="31b54-114">Si modificherà anche la pagina *courses. aspx* per visualizzare i corsi per il reparto selezionato e cercare i corsi in base al nome.</span><span class="sxs-lookup"><span data-stu-id="31b54-114">You'll also change the *Courses.aspx* page to display courses for the selected department and search for courses by name.</span></span> <span data-ttu-id="31b54-115">Infine, si aggiungeranno le statistiche degli studenti alla pagina *About. aspx* .</span><span class="sxs-lookup"><span data-stu-id="31b54-115">Finally, you'll add student statistics to the *About.aspx* page.</span></span>

<span data-ttu-id="31b54-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span></span>

<span data-ttu-id="31b54-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span></span>

<span data-ttu-id="31b54-118">[![image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-118">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span></span>

<span data-ttu-id="31b54-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span></span>

## <a name="using-the-entitydatasource-where-property-to-filter-data"></a><span data-ttu-id="31b54-120">Uso della proprietà "Where" di EntityDataSource per filtrare i dati</span><span class="sxs-lookup"><span data-stu-id="31b54-120">Using the EntityDataSource "Where" Property to Filter Data</span></span>

<span data-ttu-id="31b54-121">Aprire la pagina *students. aspx* creata nell'esercitazione precedente.</span><span class="sxs-lookup"><span data-stu-id="31b54-121">Open the *Students.aspx* page that you created in the previous tutorial.</span></span> <span data-ttu-id="31b54-122">Come attualmente configurato, il controllo `GridView` nella pagina Visualizza tutti i nomi del set di entità `People`.</span><span class="sxs-lookup"><span data-stu-id="31b54-122">As currently configured, the `GridView` control in the page displays all the names from the `People` entity set.</span></span> <span data-ttu-id="31b54-123">Tuttavia, si desidera visualizzare solo gli studenti, che è possibile trovare selezionando `Person` entità che hanno date di registrazione non null.</span><span class="sxs-lookup"><span data-stu-id="31b54-123">However, you want to show only students, which you can find by selecting `Person` entities that have non-null enrollment dates.</span></span>

<span data-ttu-id="31b54-124">Passare alla visualizzazione **progettazione** e selezionare il controllo `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="31b54-124">Switch to **Design** view and select the `EntityDataSource` control.</span></span> <span data-ttu-id="31b54-125">Nella finestra **Proprietà** impostare la proprietà `Where` su `it.EnrollmentDate is not null`.</span><span class="sxs-lookup"><span data-stu-id="31b54-125">In the **Properties** window, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>

<span data-ttu-id="31b54-126">[![Image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-126">[![Image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span></span>

<span data-ttu-id="31b54-127">La sintassi utilizzata nella `Where` proprietà del controllo `EntityDataSource` è Entity SQL.</span><span class="sxs-lookup"><span data-stu-id="31b54-127">The syntax you use in the `Where` property of the `EntityDataSource` control is Entity SQL.</span></span> <span data-ttu-id="31b54-128">Entity SQL è simile a Transact-SQL, ma è personalizzato per l'utilizzo con entità anziché oggetti di database.</span><span class="sxs-lookup"><span data-stu-id="31b54-128">Entity SQL is similar to Transact-SQL, but it's customized for use with entities rather than database objects.</span></span> <span data-ttu-id="31b54-129">Nell'espressione `it.EnrollmentDate is not null`la parola `it` rappresenta un riferimento all'entità restituita dalla query.</span><span class="sxs-lookup"><span data-stu-id="31b54-129">In the expression `it.EnrollmentDate is not null`, the word `it` represents a reference to the entity returned by the query.</span></span> <span data-ttu-id="31b54-130">Di conseguenza, `it.EnrollmentDate` fa riferimento alla proprietà `EnrollmentDate` dell'entità `Person` restituita dal controllo `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="31b54-130">Therefore, `it.EnrollmentDate` refers to the `EnrollmentDate` property of the `Person` entity that the `EntityDataSource` control returns.</span></span>

<span data-ttu-id="31b54-131">Eseguire la pagina.</span><span class="sxs-lookup"><span data-stu-id="31b54-131">Run the page.</span></span> <span data-ttu-id="31b54-132">L'elenco Students ora contiene solo students.</span><span class="sxs-lookup"><span data-stu-id="31b54-132">The students list now contains only students.</span></span> <span data-ttu-id="31b54-133">Non viene visualizzata alcuna riga in cui non è presente alcuna data di registrazione.</span><span class="sxs-lookup"><span data-stu-id="31b54-133">(There are no rows displayed where there's no enrollment date.)</span></span>

<span data-ttu-id="31b54-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span></span>

## <a name="using-the-entitydatasource-orderby-property-to-order-data"></a><span data-ttu-id="31b54-135">Uso della proprietà "OrderBy" di EntityDataSource per ordinare i dati</span><span class="sxs-lookup"><span data-stu-id="31b54-135">Using the EntityDataSource "OrderBy" Property to Order Data</span></span>

<span data-ttu-id="31b54-136">Si vuole anche che questo elenco sia nell'ordine dei nomi quando viene visualizzato per la prima volta.</span><span class="sxs-lookup"><span data-stu-id="31b54-136">You also want this list to be in name order when it's first displayed.</span></span> <span data-ttu-id="31b54-137">Con la pagina *students. aspx* ancora aperta nella visualizzazione **progettazione** e con il controllo `EntityDataSource` ancora selezionato, nella finestra **proprietà** impostare la proprietà **OrderBy** su `it.LastName`.</span><span class="sxs-lookup"><span data-stu-id="31b54-137">With the *Students.aspx* page still open in **Design** view, and with the `EntityDataSource` control still selected, in the **Properties** window set the **OrderBy** property to `it.LastName`.</span></span>

<span data-ttu-id="31b54-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span></span>

<span data-ttu-id="31b54-139">Eseguire la pagina.</span><span class="sxs-lookup"><span data-stu-id="31b54-139">Run the page.</span></span> <span data-ttu-id="31b54-140">L'elenco Students è ora in base al cognome.</span><span class="sxs-lookup"><span data-stu-id="31b54-140">The students list is now in order by last name.</span></span>

<span data-ttu-id="31b54-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span></span>

## <a name="using-a-control-parameter-to-set-the-where-property"></a><span data-ttu-id="31b54-142">Utilizzo di un parametro di controllo per impostare la proprietà "Where"</span><span class="sxs-lookup"><span data-stu-id="31b54-142">Using a Control Parameter to Set the "Where" Property</span></span>

<span data-ttu-id="31b54-143">Come per gli altri controlli origine dati, è possibile passare i valori dei parametri alla proprietà `Where`.</span><span class="sxs-lookup"><span data-stu-id="31b54-143">As with other data source controls, you can pass parameter values to the `Where` property.</span></span> <span data-ttu-id="31b54-144">Nella pagina *courses. aspx* creata nella parte 2 dell'esercitazione è possibile usare questo metodo per visualizzare i corsi associati al reparto selezionato da un utente dall'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="31b54-144">On the *Courses.aspx* page that you created in part 2 of the tutorial, you can use this method to display courses that are associated with the department that a user selects from the drop-down list.</span></span>

<span data-ttu-id="31b54-145">Aprire *courses. aspx* e passare alla visualizzazione **progettazione** .</span><span class="sxs-lookup"><span data-stu-id="31b54-145">Open *Courses.aspx* and switch to **Design** view.</span></span> <span data-ttu-id="31b54-146">Aggiungere un secondo controllo `EntityDataSource` alla pagina e denominarlo `CoursesEntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="31b54-146">Add a second `EntityDataSource` control to the page, and name it `CoursesEntityDataSource`.</span></span> <span data-ttu-id="31b54-147">Connetterlo al modello di `SchoolEntities` e selezionare `Courses` come valore **EntitySetName** .</span><span class="sxs-lookup"><span data-stu-id="31b54-147">Connect it to the `SchoolEntities` model, and select `Courses` as the **EntitySetName** value.</span></span>

<span data-ttu-id="31b54-148">Nella finestra **Proprietà** fare clic sui puntini di sospensione nella casella della proprietà **where** .</span><span class="sxs-lookup"><span data-stu-id="31b54-148">In the **Properties** window, click the ellipsis in the **Where** property box.</span></span> <span data-ttu-id="31b54-149">Verificare che il controllo `CoursesEntityDataSource` sia ancora selezionato prima di utilizzare la finestra **Proprietà** .</span><span class="sxs-lookup"><span data-stu-id="31b54-149">(Make sure the `CoursesEntityDataSource` control is still selected before using the **Properties** window.)</span></span>

<span data-ttu-id="31b54-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span></span>

<span data-ttu-id="31b54-151">Verrà visualizzata la finestra di dialogo **Editor espressioni** .</span><span class="sxs-lookup"><span data-stu-id="31b54-151">The **Expression Editor** dialog box is displayed.</span></span> <span data-ttu-id="31b54-152">In questa finestra di dialogo selezionare **genera automaticamente l'espressione Where in base ai parametri forniti**, quindi fare clic su **Aggiungi parametro**.</span><span class="sxs-lookup"><span data-stu-id="31b54-152">In this dialog box, select **Automatically generate the Where expression based on the provided parameters**, and then click **Add Parameter**.</span></span> <span data-ttu-id="31b54-153">Denominare il parametro `DepartmentID`, selezionare **controllo** come valore di **origine parametro** e selezionare **DepartmentsDropDownList** come valore **ControlID** .</span><span class="sxs-lookup"><span data-stu-id="31b54-153">Name the parameter `DepartmentID`, select **Control** as the **Parameter source** value, and select **DepartmentsDropDownList** as the **ControlID** value.</span></span>

<span data-ttu-id="31b54-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span></span>

<span data-ttu-id="31b54-155">Fare clic su **Mostra proprietà avanzate**, quindi nella finestra **Proprietà** della finestra di dialogo **Editor espressioni** modificare la proprietà `Type` in `Int32`.</span><span class="sxs-lookup"><span data-stu-id="31b54-155">Click **Show advanced properties**, and in the **Properties** window of the **Expression Editor** dialog box, change the `Type` property to `Int32`.</span></span>

<span data-ttu-id="31b54-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span></span>

<span data-ttu-id="31b54-157">Al termine, fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="31b54-157">When you're done, click **OK**.</span></span>

<span data-ttu-id="31b54-158">Sotto l'elenco a discesa aggiungere un controllo `GridView` alla pagina e denominarlo `CoursesGridView`.</span><span class="sxs-lookup"><span data-stu-id="31b54-158">Below the drop-down list, add a `GridView` control to the page and name it `CoursesGridView`.</span></span> <span data-ttu-id="31b54-159">Connetterlo al controllo origine dati `CoursesEntityDataSource`, fare clic su **Aggiorna schema**, fare clic su **modifica colonne**e rimuovere la colonna `DepartmentID`.</span><span class="sxs-lookup"><span data-stu-id="31b54-159">Connect it to the `CoursesEntityDataSource` data source control, click **Refresh Schema**, click **Edit Columns**, and remove the `DepartmentID` column.</span></span> <span data-ttu-id="31b54-160">Il markup del controllo `GridView` è simile all'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="31b54-160">The `GridView` control markup resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample1.aspx)]

<span data-ttu-id="31b54-161">Quando l'utente modifica il reparto selezionato nell'elenco a discesa, si desidera modificare automaticamente l'elenco dei corsi associati.</span><span class="sxs-lookup"><span data-stu-id="31b54-161">When the user changes the selected department in the drop-down list, you want the list of associated courses to change automatically.</span></span> <span data-ttu-id="31b54-162">Per eseguire questa operazione, selezionare l'elenco a discesa e nella finestra **Proprietà** impostare la proprietà `AutoPostBack` su `True`.</span><span class="sxs-lookup"><span data-stu-id="31b54-162">To make this happen, select the drop-down list, and in the **Properties** window set the `AutoPostBack` property to `True`.</span></span>

<span data-ttu-id="31b54-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span></span>

<span data-ttu-id="31b54-164">Ora che si è terminato di usare la finestra di progettazione, passare alla visualizzazione **origine** e sostituire le proprietà `ConnectionString` e `DefaultContainer` Name del controllo `CoursesEntityDataSource` con l'attributo `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"`.</span><span class="sxs-lookup"><span data-stu-id="31b54-164">Now that you're finished using the designer, switch to **Source** view and replace the `ConnectionString` and `DefaultContainer` name properties of the `CoursesEntityDataSource` control with the `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="31b54-165">Al termine, il markup per il controllo sarà simile all'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="31b54-165">When you're done, the markup for the control will look like the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample2.aspx)]

<span data-ttu-id="31b54-166">Eseguire la pagina e utilizzare l'elenco a discesa per selezionare diversi reparti.</span><span class="sxs-lookup"><span data-stu-id="31b54-166">Run the page and use the drop-down list to select different departments.</span></span> <span data-ttu-id="31b54-167">Nel controllo `GridView` vengono visualizzati solo i corsi offerti dal reparto selezionato.</span><span class="sxs-lookup"><span data-stu-id="31b54-167">Only courses that are offered by the selected department are displayed in the `GridView` control.</span></span>

<span data-ttu-id="31b54-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span></span>

## <a name="using-the-entitydatasource-groupby-property-to-group-data"></a><span data-ttu-id="31b54-169">Uso della proprietà "GroupBy" di EntityDataSource per raggruppare i dati</span><span class="sxs-lookup"><span data-stu-id="31b54-169">Using the EntityDataSource "GroupBy" Property to Group Data</span></span>

<span data-ttu-id="31b54-170">Supponiamo che Contoso University voglia inserire alcune statistiche sul corpo degli studenti nella pagina about.</span><span class="sxs-lookup"><span data-stu-id="31b54-170">Suppose Contoso University wants to put some student-body statistics on its About page.</span></span> <span data-ttu-id="31b54-171">In particolare, si desidera visualizzare una suddivisione dei numeri degli studenti in base alla data in cui sono stati registrati.</span><span class="sxs-lookup"><span data-stu-id="31b54-171">Specifically, it wants to show a breakdown of numbers of students by the date they enrolled.</span></span>

<span data-ttu-id="31b54-172">Aprire *About. aspx*e nella visualizzazione **origine** sostituire il contenuto esistente del controllo `BodyContent` con "statistiche corpo studente" tra `h2` Tag:</span><span class="sxs-lookup"><span data-stu-id="31b54-172">Open *About.aspx*, and in **Source** view, replace the existing contents of the `BodyContent` control with "Student Body Statistics" between `h2` tags:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample3.aspx)]

<span data-ttu-id="31b54-173">Dopo l'intestazione, aggiungere un controllo `EntityDataSource` e denominarlo `StudentStatisticsEntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="31b54-173">After the heading, add an `EntityDataSource` control and name it `StudentStatisticsEntityDataSource`.</span></span> <span data-ttu-id="31b54-174">Connetterlo a `SchoolEntities`, selezionare il set di entità `People` e lasciare invariata la casella di **selezione** nella procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="31b54-174">Connect it to `SchoolEntities`, select the `People` entity set, and leave the **Select** box in the wizard unchanged.</span></span> <span data-ttu-id="31b54-175">Impostare le proprietà seguenti nella finestra **Proprietà** :</span><span class="sxs-lookup"><span data-stu-id="31b54-175">Set the following properties in the **Properties** window:</span></span>

- <span data-ttu-id="31b54-176">Per filtrare solo per studenti, impostare la proprietà `Where` su `it.EnrollmentDate is not null`.</span><span class="sxs-lookup"><span data-stu-id="31b54-176">To filter for students only, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>
- <span data-ttu-id="31b54-177">Per raggruppare i risultati in base alla data di registrazione, impostare la proprietà `GroupBy` su `it.EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="31b54-177">To group the results by the enrollment date, set the `GroupBy` property to `it.EnrollmentDate`.</span></span>
- <span data-ttu-id="31b54-178">Per selezionare la data di registrazione e il numero di studenti, impostare la proprietà `Select` su `it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`.</span><span class="sxs-lookup"><span data-stu-id="31b54-178">To select the enrollment date and the number of students, set the `Select` property to `it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`.</span></span>
- <span data-ttu-id="31b54-179">Per ordinare i risultati in base alla data di registrazione, impostare la proprietà `OrderBy` su `it.EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="31b54-179">To order the results by the enrollment date, set the `OrderBy` property to `it.EnrollmentDate`.</span></span>

<span data-ttu-id="31b54-180">Nella visualizzazione **origine** sostituire le proprietà `ConnectionString` e `DefaultContainer` nome con una proprietà `ContextTypeName`.</span><span class="sxs-lookup"><span data-stu-id="31b54-180">In **Source** view, replace the `ConnectionString` and `DefaultContainer` name properties with a `ContextTypeName` property.</span></span> <span data-ttu-id="31b54-181">Il markup del controllo `EntityDataSource` ora è simile all'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="31b54-181">The `EntityDataSource` control markup now resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample4.aspx)]

<span data-ttu-id="31b54-182">La sintassi delle proprietà `Select`, `GroupBy`e `Where` è simile a Transact-SQL, ad eccezione della parola chiave `it` che specifica l'entità corrente.</span><span class="sxs-lookup"><span data-stu-id="31b54-182">The syntax of the `Select`, `GroupBy`, and `Where` properties resembles Transact-SQL except for the `it` keyword that specifies the current entity.</span></span>

<span data-ttu-id="31b54-183">Aggiungere il markup seguente per creare un controllo `GridView` per visualizzare i dati.</span><span class="sxs-lookup"><span data-stu-id="31b54-183">Add the following markup to create a `GridView` control to display the data.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample5.aspx)]

<span data-ttu-id="31b54-184">Eseguire la pagina per visualizzare un elenco che mostra il numero di studenti per data di registrazione.</span><span class="sxs-lookup"><span data-stu-id="31b54-184">Run the page to see a list showing the number of students by enrollment date.</span></span>

<span data-ttu-id="31b54-185">[![image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-185">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span></span>

## <a name="using-the-queryextender-control-for-filtering-and-ordering"></a><span data-ttu-id="31b54-186">Utilizzo del controllo QueryExtender per l'applicazione di filtri e l'ordinamento</span><span class="sxs-lookup"><span data-stu-id="31b54-186">Using the QueryExtender Control for Filtering and Ordering</span></span>

<span data-ttu-id="31b54-187">Il controllo `QueryExtender` fornisce un modo per specificare i filtri e l'ordinamento nel markup.</span><span class="sxs-lookup"><span data-stu-id="31b54-187">The `QueryExtender` control provides a way to specify filtering and sorting in markup.</span></span> <span data-ttu-id="31b54-188">La sintassi è indipendente dal sistema di gestione di database (DBMS) utilizzato.</span><span class="sxs-lookup"><span data-stu-id="31b54-188">The syntax is independent of the database management system (DBMS) you're using.</span></span> <span data-ttu-id="31b54-189">È inoltre generalmente indipendente dalla Entity Framework, con l'eccezione che la sintassi utilizzata per le proprietà di navigazione è univoca per l'Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="31b54-189">It's also generally independent of the Entity Framework, with the exception that syntax you use for navigation properties is unique to the Entity Framework.</span></span>

<span data-ttu-id="31b54-190">In questa parte dell'esercitazione si utilizzerà un controllo `QueryExtender` per filtrare e ordinare i dati e uno dei campi Order-by sarà una proprietà di navigazione.</span><span class="sxs-lookup"><span data-stu-id="31b54-190">In this part of the tutorial you'll use a `QueryExtender` control to filter and order data, and one of the order-by fields will be a navigation property.</span></span>

<span data-ttu-id="31b54-191">Se si preferisce usare codice anziché markup per estendere le query generate automaticamente dal controllo `EntityDataSource`, è possibile eseguire questa operazione gestendo l'evento `QueryCreated`.</span><span class="sxs-lookup"><span data-stu-id="31b54-191">(If you prefer to use code instead of markup to extend the queries that are automatically generated by the `EntityDataSource` control, you can do that by handling the `QueryCreated` event.</span></span> <span data-ttu-id="31b54-192">Questo è il modo in cui il controllo `QueryExtender` estende anche `EntityDataSource` query di controllo.</span><span class="sxs-lookup"><span data-stu-id="31b54-192">This is how the `QueryExtender` control extends `EntityDataSource` control queries also.)</span></span>

<span data-ttu-id="31b54-193">Aprire la pagina *courses. aspx* e sotto il markup aggiunto in precedenza, inserire il markup seguente per creare un'intestazione, una casella di testo per immettere le stringhe di ricerca, un pulsante di ricerca e un controllo `EntityDataSource` associato al set di entità `Courses`.</span><span class="sxs-lookup"><span data-stu-id="31b54-193">Open the *Courses.aspx* page, and below the markup you added previously, insert the following markup to create a heading, a text box for entering search strings, a search button, and an `EntityDataSource` control that's bound to the `Courses` entity set.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample6.aspx)]

<span data-ttu-id="31b54-194">Si noti che la proprietà `Include` del controllo `EntityDataSource` è impostata su `Department`.</span><span class="sxs-lookup"><span data-stu-id="31b54-194">Notice that the `EntityDataSource` control's `Include` property is set to `Department`.</span></span> <span data-ttu-id="31b54-195">Nel database la tabella `Course` non contiene il nome del reparto; contiene una colonna chiave esterna `DepartmentID`.</span><span class="sxs-lookup"><span data-stu-id="31b54-195">In the database, the `Course` table does not contain the department name; it contains a `DepartmentID` foreign key column.</span></span> <span data-ttu-id="31b54-196">Se si sta eseguendo una query direttamente sul database, per ottenere il nome del reparto insieme ai dati del corso è necessario aggiungere le tabelle `Course` e `Department`.</span><span class="sxs-lookup"><span data-stu-id="31b54-196">If you were querying the database directly, to get the department name along with course data, you would have to join the `Course` and `Department` tables.</span></span> <span data-ttu-id="31b54-197">Impostando la proprietà `Include` su `Department`, si specifica che il Entity Framework deve eseguire l'operazione di recupero dell'entità `Department` correlata quando ottiene un'entità `Course`.</span><span class="sxs-lookup"><span data-stu-id="31b54-197">By setting the `Include` property to `Department`, you specify that the Entity Framework should do the work of getting the related `Department` entity when it gets a `Course` entity.</span></span> <span data-ttu-id="31b54-198">L'entità `Department` viene quindi archiviata nella proprietà di navigazione `Department` dell'entità `Course`.</span><span class="sxs-lookup"><span data-stu-id="31b54-198">The `Department` entity is then stored in the `Department` navigation property of the `Course` entity.</span></span> <span data-ttu-id="31b54-199">Per impostazione predefinita, la classe `SchoolEntities` generata da Progettazione modelli di dati recupera i dati correlati quando è necessario e il controllo origine dati è stato associato a tale classe, pertanto non è necessario impostare la proprietà `Include`.</span><span class="sxs-lookup"><span data-stu-id="31b54-199">(By default, the `SchoolEntities` class that was generated by the data model designer retrieves related data when it's needed, and you've bound the data source control to that class, so setting the `Include` property is not necessary.</span></span> <span data-ttu-id="31b54-200">Tuttavia, l'impostazione migliora le prestazioni della pagina, perché in caso contrario il Entity Framework effettuerà chiamate separate al database per recuperare i dati per le entità `Course` e per le entità `Department` correlate.</span><span class="sxs-lookup"><span data-stu-id="31b54-200">However, setting it improves performance of the page, because otherwise the Entity Framework would make separate calls to the database to retrieve data for the `Course` entities and for the related `Department` entities.)</span></span>

<span data-ttu-id="31b54-201">Dopo il controllo `EntityDataSource` appena creato, inserire il markup seguente per creare un controllo `QueryExtender` associato a tale controllo `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="31b54-201">After the `EntityDataSource` control you just created, insert the following markup to create a `QueryExtender` control that's bound to that `EntityDataSource` control.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample7.aspx)]

<span data-ttu-id="31b54-202">L'elemento `SearchExpression` specifica che si desidera selezionare i corsi i cui titoli corrispondono al valore immesso nella casella di testo.</span><span class="sxs-lookup"><span data-stu-id="31b54-202">The `SearchExpression` element specifies that you want to select courses whose titles match the value entered in the text box.</span></span> <span data-ttu-id="31b54-203">Viene confrontato solo il numero di caratteri immessi nella casella di testo, perché la proprietà `SearchType` specifica `StartsWith`.</span><span class="sxs-lookup"><span data-stu-id="31b54-203">Only as many characters as are entered in the text box will be compared, because the `SearchType` property specifies `StartsWith`.</span></span>

<span data-ttu-id="31b54-204">L'elemento `OrderByExpression` specifica che il set di risultati verrà ordinato in base al titolo del corso all'interno del nome del reparto.</span><span class="sxs-lookup"><span data-stu-id="31b54-204">The `OrderByExpression` element specifies that the result set will be ordered by course title within department name.</span></span> <span data-ttu-id="31b54-205">Si noti come viene specificato il nome del reparto: `Department.Name`.</span><span class="sxs-lookup"><span data-stu-id="31b54-205">Notice how department name is specified: `Department.Name`.</span></span> <span data-ttu-id="31b54-206">Poiché l'associazione tra l'entità `Course` e l'entità `Department` è uno-a-uno, la proprietà di navigazione `Department` contiene un'entità `Department`.</span><span class="sxs-lookup"><span data-stu-id="31b54-206">Because the association between the `Course` entity and the `Department` entity is one-to-one, the `Department` navigation property contains a `Department` entity.</span></span> <span data-ttu-id="31b54-207">Se si tratta di una relazione uno-a-molti, la proprietà conterrà una raccolta. Per ottenere il nome del reparto, è necessario specificare la proprietà `Name` dell'entità `Department`.</span><span class="sxs-lookup"><span data-stu-id="31b54-207">(If this were a one-to-many relationship, the property would contain a collection.) To get the department name, you must specify the `Name` property of the `Department` entity.</span></span>

<span data-ttu-id="31b54-208">Infine, aggiungere un controllo `GridView` per visualizzare l'elenco dei corsi:</span><span class="sxs-lookup"><span data-stu-id="31b54-208">Finally, add a `GridView` control to display the list of courses:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample8.aspx)]

<span data-ttu-id="31b54-209">La prima colonna è un campo modello che Visualizza il nome del reparto.</span><span class="sxs-lookup"><span data-stu-id="31b54-209">The first column is a template field that displays the department name.</span></span> <span data-ttu-id="31b54-210">L'espressione DataBinding specifica `Department.Name`, proprio come si è visto nel controllo `QueryExtender`.</span><span class="sxs-lookup"><span data-stu-id="31b54-210">The databinding expression specifies `Department.Name`, just as you saw in the `QueryExtender` control.</span></span>

<span data-ttu-id="31b54-211">Eseguire la pagina.</span><span class="sxs-lookup"><span data-stu-id="31b54-211">Run the page.</span></span> <span data-ttu-id="31b54-212">La visualizzazione iniziale Mostra un elenco di tutti i corsi nel reparto order by, quindi in base al titolo del corso.</span><span class="sxs-lookup"><span data-stu-id="31b54-212">The initial display shows a list of all courses in order by department and then by course title.</span></span>

<span data-ttu-id="31b54-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span></span>

<span data-ttu-id="31b54-214">Immettere una "m" e fare clic su **Cerca** per visualizzare tutti i corsi i cui titoli iniziano con "m" (la ricerca non fa distinzione tra maiuscole e minuscole).</span><span class="sxs-lookup"><span data-stu-id="31b54-214">Enter an "m" and click **Search** to see all courses whose titles begin with "m" (the search is not case sensitive).</span></span>

<span data-ttu-id="31b54-215">[![IMAGE12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-215">[![Image12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span></span>

## <a name="using-the-like-operator-to-filter-data"></a><span data-ttu-id="31b54-216">Utilizzo dell'operatore "like" per filtrare i dati</span><span class="sxs-lookup"><span data-stu-id="31b54-216">Using the "Like" Operator to Filter Data</span></span>

<span data-ttu-id="31b54-217">È possibile ottenere un effetto simile ai tipi di ricerca `StartsWith`, `Contains`e `EndsWith` del controllo `QueryExtender` usando un operatore `Like` nella proprietà `EntityDataSource` del controllo `Where`.</span><span class="sxs-lookup"><span data-stu-id="31b54-217">You can achieve an effect similar to the `QueryExtender` control's `StartsWith`, `Contains`, and `EndsWith` search types by using a `Like` operator in the `EntityDataSource` control's `Where` property.</span></span> <span data-ttu-id="31b54-218">In questa parte dell'esercitazione si vedrà come usare l'operatore `Like` per cercare uno studente in base al nome.</span><span class="sxs-lookup"><span data-stu-id="31b54-218">In this part of the tutorial, you'll see how to use the `Like` operator to search for a student by name.</span></span>

<span data-ttu-id="31b54-219">Aprire *students. aspx* nella visualizzazione **origine** .</span><span class="sxs-lookup"><span data-stu-id="31b54-219">Open *Students.aspx* in **Source** view.</span></span> <span data-ttu-id="31b54-220">Dopo il controllo `GridView` aggiungere il markup seguente:</span><span class="sxs-lookup"><span data-stu-id="31b54-220">After the `GridView` control, add the following markup:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample9.aspx)]

<span data-ttu-id="31b54-221">Questo markup è simile a quello illustrato in precedenza, ad eccezione del `Where` valore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="31b54-221">This markup is similar to what you've seen earlier except for the `Where` property value.</span></span> <span data-ttu-id="31b54-222">La seconda parte dell'espressione `Where` definisce una ricerca di sottostringhe (`LIKE %FirstMidName% or LIKE %LastName%`) che cerca il nome e il cognome di qualsiasi elemento immesso nella casella di testo.</span><span class="sxs-lookup"><span data-stu-id="31b54-222">The second part of the `Where` expression defines a substring search (`LIKE %FirstMidName% or LIKE %LastName%`) that searches both the first and last names for whatever is entered in the text box.</span></span>

<span data-ttu-id="31b54-223">Eseguire la pagina.</span><span class="sxs-lookup"><span data-stu-id="31b54-223">Run the page.</span></span> <span data-ttu-id="31b54-224">Inizialmente vengono visualizzati tutti gli studenti, perché il valore predefinito per il parametro `StudentName` è "%".</span><span class="sxs-lookup"><span data-stu-id="31b54-224">Initially you see all of the students because the default value for the `StudentName` parameter is "%".</span></span>

<span data-ttu-id="31b54-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span></span>

<span data-ttu-id="31b54-226">Immettere la lettera "g" nella casella di testo e fare clic su **Cerca**.</span><span class="sxs-lookup"><span data-stu-id="31b54-226">Enter the letter "g" in the text box and click **Search**.</span></span> <span data-ttu-id="31b54-227">Viene visualizzato un elenco di studenti il cui nome è "g" nel primo o nel cognome.</span><span class="sxs-lookup"><span data-stu-id="31b54-227">You see a list of students that have a "g" in either the first or last name.</span></span>

<span data-ttu-id="31b54-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="31b54-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span></span>

<span data-ttu-id="31b54-229">Sono ora visualizzati, aggiornati, filtrati, ordinati e raggruppati dati da singole tabelle.</span><span class="sxs-lookup"><span data-stu-id="31b54-229">You've now displayed, updated, filtered, ordered, and grouped data from individual tables.</span></span> <span data-ttu-id="31b54-230">Nell'esercitazione successiva si inizierà a lavorare con i dati correlati (scenari Master-Details).</span><span class="sxs-lookup"><span data-stu-id="31b54-230">In the next tutorial you'll begin to work with related data (master-detail scenarios).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="31b54-231">[Precedente](the-entity-framework-and-aspnet-getting-started-part-2.md)
> [Successivo](the-entity-framework-and-aspnet-getting-started-part-4.md)</span><span class="sxs-lookup"><span data-stu-id="31b54-231">[Previous](the-entity-framework-and-aspnet-getting-started-part-2.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-4.md)</span></span>
