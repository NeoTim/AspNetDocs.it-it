---
uid: web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
title: URL nelle pagine master (VB) | Microsoft Docs
author: rick-anderson
description: Risolve il modo in cui gli URL nella pagina master possono interrompersi perché il file della pagina master si trova in una directory diversa rispetto alla pagina contenuto. Esamina la riassegnazione...
ms.author: riande
ms.date: 06/10/2008
ms.assetid: 43d1e83c-0092-4dcf-977c-e709c4dce7c3
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 01627988f68bb619969a5fe3cfaae68fe70b5d4f
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78548111"
---
# <a name="urls-in-master-pages-vb"></a><span data-ttu-id="8e5fc-104">URL nelle pagine master (VB)</span><span class="sxs-lookup"><span data-stu-id="8e5fc-104">URLs in Master Pages (VB)</span></span>

<span data-ttu-id="8e5fc-105">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8e5fc-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8e5fc-106">[Scarica codice](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_VB.zip) o [Scarica PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="8e5fc-106">[Download Code](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_VB.zip) or [Download PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_VB.pdf)</span></span>

> <span data-ttu-id="8e5fc-107">Risolve il modo in cui gli URL nella pagina master possono interrompersi perché il file della pagina master si trova in una directory diversa rispetto alla pagina contenuto.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-107">Addresses how URLs in the master page can break due to the master page file being in a different relative directory than the content page.</span></span> <span data-ttu-id="8e5fc-108">Esamina la riassegnazione degli URL tramite ~ nella sintassi dichiarativa e l'uso di ResolveUrl e ResolveClientUrl a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-108">Looks at rebasing URLs via ~ in the declarative syntax and using ResolveUrl and ResolveClientUrl programmatically.</span></span> <span data-ttu-id="8e5fc-109">(Vedere anche</span><span class="sxs-lookup"><span data-stu-id="8e5fc-109">(Also look at</span></span>

## <a name="introduction"></a><span data-ttu-id="8e5fc-110">Introduzione</span><span class="sxs-lookup"><span data-stu-id="8e5fc-110">Introduction</span></span>

<span data-ttu-id="8e5fc-111">In tutti gli esempi che abbiamo visto finora, le pagine master e di contenuto si trovano nella stessa cartella (la cartella radice del sito Web).</span><span class="sxs-lookup"><span data-stu-id="8e5fc-111">In all the examples we've seen thus far, the master and content pages have been located in the same folder (the website's root folder).</span></span> <span data-ttu-id="8e5fc-112">Ma non esiste alcun motivo per cui le pagine master e di contenuto devono trovarsi nella stessa cartella.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-112">But there's no reason why the master and content pages must be in the same folder.</span></span> <span data-ttu-id="8e5fc-113">È certamente possibile creare pagine di contenuto nelle sottocartelle.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-113">You can certainly create content pages in subfolders.</span></span> <span data-ttu-id="8e5fc-114">Analogamente, è possibile creare una cartella `~/MasterPages/` in cui posizionare le pagine master del sito.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-114">Similarly, you might create a `~/MasterPages/` folder where you place your site's master pages.</span></span>

<span data-ttu-id="8e5fc-115">Un potenziale problema con l'inserimento di pagine master e di contenuto in cartelle diverse comporta URL interrotti.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-115">One potential issue with placing master and content pages in different folders involves broken URLs.</span></span> <span data-ttu-id="8e5fc-116">Se la pagina master contiene URL relativi in collegamenti ipertestuali, immagini o altri elementi, il collegamento non sarà valido per le pagine di contenuto che si trovano in una cartella diversa.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-116">If the master page contains relative URLs in hyperlinks, images, or other elements, the link will be invalid for content pages that reside in a different folder.</span></span> <span data-ttu-id="8e5fc-117">In questa esercitazione si esaminano l'origine del problema e le soluzioni alternative.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-117">In this tutorial we examine the source of this problem as well as workarounds.</span></span>

## <a name="the-problem-with-relative-urls"></a><span data-ttu-id="8e5fc-118">Il problema con gli URL relativi</span><span class="sxs-lookup"><span data-stu-id="8e5fc-118">The Problem with Relative URLs</span></span>

<span data-ttu-id="8e5fc-119">Un URL in una pagina Web viene definito *URL relativo* se il percorso della risorsa a cui fa riferimento è relativo alla posizione della pagina Web nella struttura di cartelle del sito Web.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-119">A URL on a web page is said to be a *relative URL* if the location of the resource it points to is relative to the web page's location in the website's folder structure.</span></span> <span data-ttu-id="8e5fc-120">Qualsiasi URL che non inizia con una barra (`/`) o un protocollo (ad esempio `http://`) iniziale è relativo perché viene risolto dal browser in base alla posizione della pagina Web che contiene l'URL.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-120">Any URL that does not start with a leading forward slash (`/`) or a protocol (such as `http://`) is relative because it is resolved by the browser based on the location of the web page that contains the URL.</span></span>

<span data-ttu-id="8e5fc-121">Il sito Web, ad esempio, include una cartella `~/Images/` con un file di immagine singolo `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-121">For example, our website has an `~/Images/` folder with a single image file, `PoweredByASPNET.gif`.</span></span> <span data-ttu-id="8e5fc-122">Il file della pagina master `Site.master` dispone di un elemento `<img>` nell'area `footerContent` con il markup seguente:</span><span class="sxs-lookup"><span data-stu-id="8e5fc-122">The master page file `Site.master` has an `<img>` element in the `footerContent` region with the following markup:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample1.html)]

<span data-ttu-id="8e5fc-123">Il valore dell'attributo `src` nell'elemento `<img>` è un URL relativo perché non inizia con `/` o `http://`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-123">The `src` attribute value in the `<img>` element is a relative URL because it does not start with `/` or `http://`.</span></span> <span data-ttu-id="8e5fc-124">In breve, il valore dell'attributo `src` indica al browser di esaminare la sottocartella `Images` per un file denominato `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-124">In short, the `src` attribute value tells the browser to look in the `Images` subfolder for a file named `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="8e5fc-125">Quando si visita una pagina di contenuto, il markup precedente viene inviato direttamente al browser.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-125">When visiting a content page, the above markup is sent directly to the browser.</span></span> <span data-ttu-id="8e5fc-126">Esaminare `About.aspx` e visualizzare l'origine HTML inviata al browser.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-126">Take a moment to visit `About.aspx` and view the HTML source sent to the browser.</span></span> <span data-ttu-id="8e5fc-127">Si noterà che il markup esatto della pagina master è stato inviato al browser.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-127">You will find that the exact same markup in the master page was sent to the browser.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample2.html)]

<span data-ttu-id="8e5fc-128">Se la pagina contenuto si trova nella cartella radice (così come `About.aspx`) tutto funziona come previsto perché esiste una sottocartella `Images` relativa alla cartella radice.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-128">If the content page is in the root folder (as is `About.aspx`) everything works as expected because there is an `Images` subfolder relative to the root folder.</span></span> <span data-ttu-id="8e5fc-129">Tuttavia, le cose si interrompono se la pagina contenuto si trova in una cartella diversa da quella della pagina master.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-129">However, things break down if the content page is in a different folder than the master page.</span></span> <span data-ttu-id="8e5fc-130">Per illustrare questo problema, creare una sottocartella denominata `Admin`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-130">To illustrate this, create a subfolder named `Admin`.</span></span> <span data-ttu-id="8e5fc-131">Successivamente, aggiungere una pagina contenuto denominata `Default.aspx` alla cartella `Admin`, assicurandosi di associare la nuova pagina alla pagina master `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-131">Next, add a content page named `Default.aspx` to the `Admin` folder, making sure to bind the new page to the `Site.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="8e5fc-132">Nell'esercitazione [*specificare il titolo, i metatag e altre intestazioni HTML nella pagina master*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) è stata creata una classe di pagina base personalizzata denominata `BasePage` che imposta automaticamente il titolo della pagina di contenuto (se non è stata assegnata in modo esplicito).</span><span class="sxs-lookup"><span data-stu-id="8e5fc-132">In the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that automatically set the content page's title (if it was not explicitly assigned).</span></span> <span data-ttu-id="8e5fc-133">Non dimenticare di fare in modo che la classe code-behind della pagina appena creata derivi da `BasePage` per poter usare questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-133">Don't forget to have the newly created page's code-behind class derive from `BasePage` so that it can utilize this functionality.</span></span>

<span data-ttu-id="8e5fc-134">Dopo aver creato questa pagina di contenuto, il Esplora soluzioni dovrebbe essere simile a quello illustrato nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-134">After you have created this content page, your Solution Explorer should look similar to Figure 1.</span></span>

![Al progetto sono state aggiunte una nuova cartella e una pagina ASP.NET](urls-in-master-pages-vb/_static/image1.png)

<span data-ttu-id="8e5fc-136">**Figura 01**: al progetto sono state aggiunte una nuova cartella e una pagina ASP.NET</span><span class="sxs-lookup"><span data-stu-id="8e5fc-136">**Figure 01**: A New Folder and ASP.NET Page Have Been Added to the Project</span></span>

<span data-ttu-id="8e5fc-137">Aggiornare quindi il file di `Web.sitemap` per includere una nuova voce `<siteMapNode>` per questa lezione.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-137">Next, update the `Web.sitemap` file to include a new `<siteMapNode>` entry for this lesson.</span></span> <span data-ttu-id="8e5fc-138">Nel codice XML seguente viene illustrato il markup completo `Web.sitemap`, che ora include l'aggiunta di un terzo elemento `<siteMapNode>`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-138">The following XML shows the complete `Web.sitemap` markup, which now includes the addition of a third `<siteMapNode>` element.</span></span>

[!code-xml[Main](urls-in-master-pages-vb/samples/sample3.xml)]

<span data-ttu-id="8e5fc-139">La pagina `Default.aspx` appena creata deve avere quattro controlli contenuto corrispondenti ai quattro ContentPlaceHolders in `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-139">The newly created `Default.aspx` page should have four Content controls corresponding to the four ContentPlaceHolders in `Site.master`.</span></span> <span data-ttu-id="8e5fc-140">Aggiungere testo al controllo contenuto che fa riferimento al `MainContent` ContentPlaceHolder, quindi visitare la pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-140">Add some text to the Content control referencing the `MainContent` ContentPlaceHolder and then visit the page through a browser.</span></span> <span data-ttu-id="8e5fc-141">Come illustrato nella figura 2, il browser non riesce a trovare il file di immagine del `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-141">As Figure 2 shows, the browser cannot find the `PoweredByASPNET.gif` image file.</span></span> <span data-ttu-id="8e5fc-142">Che cosa succede qui?</span><span class="sxs-lookup"><span data-stu-id="8e5fc-142">What's going on here?</span></span>

<span data-ttu-id="8e5fc-143">Alla pagina contenuto `~/Admin/Default.aspx` viene inviato lo stesso codice HTML per l'area `footerContent` come la pagina `About.aspx`:</span><span class="sxs-lookup"><span data-stu-id="8e5fc-143">The `~/Admin/Default.aspx` content page is sent the same HTML for the `footerContent` region as was the `About.aspx` page:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample4.html)]

<span data-ttu-id="8e5fc-144">Poiché l'attributo `src` dell'elemento `<img>` è un URL relativo, il browser tenta di cercare una cartella `Images` relativa al percorso della cartella della pagina Web.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-144">Because the `<img>` element's `src` attribute is a relative URL, the browser attempts to look for an `Images` folder relative to the web page's folder location.</span></span> <span data-ttu-id="8e5fc-145">In altre parole, il browser sta cercando il file di immagine `Admin/Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-145">In other words, the browser is looking for the image file `Admin/Images/PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="8e5fc-146">[![il file di immagine PoweredByASPNET. gif non è stato trovato](urls-in-master-pages-vb/_static/image3.png)](urls-in-master-pages-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="8e5fc-146">[![The PoweredByASPNET.gif Image File Cannot Be Found](urls-in-master-pages-vb/_static/image3.png)](urls-in-master-pages-vb/_static/image2.png)</span></span>

<span data-ttu-id="8e5fc-147">**Figura 02**: Impossibile trovare il file di immagine del `PoweredByASPNET.gif` ([fare clic per visualizzare l'immagine con dimensioni complete](urls-in-master-pages-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="8e5fc-147">**Figure 02**: The `PoweredByASPNET.gif` Image File Cannot Be Found  ([Click to view full-size image](urls-in-master-pages-vb/_static/image4.png))</span></span>

### <a name="replacing-relative-urls-with-absolute-urls"></a><span data-ttu-id="8e5fc-148">Sostituzione degli URL relativi con URL assoluti</span><span class="sxs-lookup"><span data-stu-id="8e5fc-148">Replacing Relative URLs with Absolute URLs</span></span>

<span data-ttu-id="8e5fc-149">Il contrario di un URL relativo è un *URL assoluto*, ovvero uno che inizia con una barra (`/`) o un protocollo, ad esempio `http://`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-149">The opposite of a relative URL is an *absolute URL*, which is one that starts with a forward slash (`/`) or a protocol such as `http://`.</span></span> <span data-ttu-id="8e5fc-150">Poiché un URL assoluto specifica il percorso di una risorsa da un punto fisso noto, lo stesso URL assoluto è valido in qualsiasi pagina Web, indipendentemente dalla posizione della pagina Web nella struttura di cartelle del sito Web.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-150">Because an absolute URL specifies the location of a resource from a known fixed point, the same absolute URL is valid in any web page, regardless of the web page's location in the website's folder structure.</span></span>

<span data-ttu-id="8e5fc-151">Per risolvere l'immagine interruppe mostrata nella figura 2, è necessario aggiornare l'attributo `src` dell'elemento `<img>` in modo che usi un URL assoluto anziché uno relativo.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-151">To remedy the broken image shown in Figure 2, we need to update the `<img>` element's `src` attribute so that it uses an absolute URL instead of a relative one.</span></span> <span data-ttu-id="8e5fc-152">Per determinare l'URL assoluto corretto, visitare una delle pagine Web del sito Web ed esaminare la barra degli indirizzi.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-152">To determine the correct absolute URL, visit one of the web pages in your website and examine the Address bar.</span></span> <span data-ttu-id="8e5fc-153">Come illustrato nella figura 2 della barra degli indirizzi, il percorso completo dell'applicazione Web viene `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-153">As the Address bar in Figure 2 shows, the fully qualified path to the web application is `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/`.</span></span> <span data-ttu-id="8e5fc-154">Pertanto, è possibile aggiornare l'attributo `src` dell'elemento `<img>` a uno dei due URL assoluti seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e5fc-154">Therefore, we could update the `<img>` element's `src` attribute to either of the following two absolute URLs:</span></span>

- `/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`
- `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`

<span data-ttu-id="8e5fc-155">Aggiornare l'attributo `src` dell'elemento `<img>` a un URL assoluto usando uno dei moduli indicati in precedenza e quindi visitare la pagina `~/Admin/Default.aspx` tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-155">Take a moment to update the `<img>` element's `src` attribute to an absolute URL using one of the forms shown above and then visit the `~/Admin/Default.aspx` page through a browser.</span></span> <span data-ttu-id="8e5fc-156">Questa volta il browser troverà e visualizzerà correttamente il file di immagine `PoweredByASPNET.gif` (vedere la figura 3).</span><span class="sxs-lookup"><span data-stu-id="8e5fc-156">This time the browser will correctly find and display the `PoweredByASPNET.gif` image file (see Figure 3).</span></span>

<span data-ttu-id="8e5fc-157">[![viene ora visualizzata l'immagine PoweredByASPNET. gif](urls-in-master-pages-vb/_static/image6.png)](urls-in-master-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="8e5fc-157">[![The PoweredByASPNET.gif Image is Now Displayed](urls-in-master-pages-vb/_static/image6.png)](urls-in-master-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="8e5fc-158">**Figura 03**: ora viene visualizzata l'immagine `PoweredByASPNET.gif` ([fare clic per visualizzare l'immagine con dimensioni complete](urls-in-master-pages-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="8e5fc-158">**Figure 03**: The `PoweredByASPNET.gif` Image is Now Displayed  ([Click to view full-size image](urls-in-master-pages-vb/_static/image7.png))</span></span>

<span data-ttu-id="8e5fc-159">Sebbene la codifica hardware nell'URL assoluto funzioni, associa strettamente il codice HTML al percorso del server e della cartella del sito Web, che può cambiare.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-159">While hard coding in the absolute URL works, it tightly couples your HTML to the website's server and folder location, which may change.</span></span> <span data-ttu-id="8e5fc-160">L'uso di un URL assoluto del modulo `http://localhost:3908/...` è fragile perché il numero di porta che precede localhost viene selezionato automaticamente ogni volta che viene avviato il server Web di sviluppo ASP.NET predefinito di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-160">Using an absolute URL of the form `http://localhost:3908/...` is brittle because the port number preceding localhost is selected automatically each time Visual Studio's built-in ASP.NET Development Web Server is started.</span></span> <span data-ttu-id="8e5fc-161">Analogamente, la parte `http://localhost` è valida solo quando si esegue il test in locale.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-161">Similarly, the `http://localhost` part is only valid when testing locally.</span></span> <span data-ttu-id="8e5fc-162">Una volta che il codice è stato distribuito in un server di produzione, la base dell'URL verrà modificata in altro modo, ad esempio `http://www.yourserver.com`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-162">Once the code is deployed to a production server, the URL base will change to something else, like `http://www.yourserver.com`.</span></span> <span data-ttu-id="8e5fc-163">L'URL assoluto nel formato `/ASPNET_MasterPages_Tutorial_04_VB/...` soffre anche della stessa fragilità, perché spesso il percorso dell'applicazione è diverso tra i server di sviluppo e di produzione.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-163">The absolute URL in the form `/ASPNET_MasterPages_Tutorial_04_VB/...` also suffers from the same brittleness because oftentimes this application path differs between development and production servers.</span></span>

<span data-ttu-id="8e5fc-164">La novità è che ASP.NET offre un metodo per generare un URL relativo valido in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-164">The good news is that ASP.NET offers a method for generating a valid relative URL at runtime.</span></span>

## <a name="usingandresolveclienturl"></a><span data-ttu-id="8e5fc-165">Utilizzo di`~`e`ResolveClientUrl`</span><span class="sxs-lookup"><span data-stu-id="8e5fc-165">Using`~`and`ResolveClientUrl`</span></span>

<span data-ttu-id="8e5fc-166">Anziché utilizzare un URL assoluto, ASP.NET consente agli sviluppatori di pagine di utilizzare la tilde (`~`) per indicare la radice dell'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-166">Rather than hard code an absolute URL, ASP.NET allows page developers to use the tilde (`~`) to indicate the root of the web application.</span></span> <span data-ttu-id="8e5fc-167">Ad esempio, in precedenza in questa esercitazione ho utilizzato la notazione `~/Admin/Default.aspx` nel testo per fare riferimento alla pagina `Default.aspx` nella cartella `Admin`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-167">For example, earlier in this tutorial I used the notation `~/Admin/Default.aspx` in the text to refer to the `Default.aspx` page in the `Admin` folder.</span></span> <span data-ttu-id="8e5fc-168">Il `~` indica che la cartella `Admin` è una sottocartella della radice dell'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-168">The `~` indicates that the `Admin` folder is a subfolder of the web application's root.</span></span>

<span data-ttu-id="8e5fc-169">Il [metodo`ResolveClientUrl`](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) della classe `Control` accetta un URL e lo modifica in un URL relativo appropriato per la pagina Web in cui risiede il controllo.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-169">The `Control` class's [`ResolveClientUrl` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) takes a URL and modifies it to a relative URL appropriate for the web page on which the control resides.</span></span> <span data-ttu-id="8e5fc-170">Ad esempio, la chiamata di `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` da `About.aspx` restituisce `Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-170">For example, calling `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` from `About.aspx` returns `Images/PoweredByASPNET.gif`.</span></span> <span data-ttu-id="8e5fc-171">La chiamata da `~/Admin/Default.aspx`, tuttavia, restituisce `../Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-171">Calling it from `~/Admin/Default.aspx`, however, returns `../Images/PoweredByASPNET.gif`.</span></span>

> [!NOTE]
> <span data-ttu-id="8e5fc-172">Poiché tutti i controlli server ASP.NET derivano dalla classe `Control`, tutti i controlli server hanno accesso al metodo `ResolveClientUrl`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-172">Because all ASP.NET server controls derive from the `Control` class, all server controls have access to the `ResolveClientUrl` method.</span></span> <span data-ttu-id="8e5fc-173">Anche la classe `Page` deriva dalla classe `Control`, vale a dire che è possibile usare questo metodo direttamente dalle classi code-behind delle pagine ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-173">Even the `Page` class derives from the `Control` class, meaning that you can use this method directly from your ASP.NET pages' code-behind classes.</span></span>

### <a name="usingin-the-declarative-markup"></a><span data-ttu-id="8e5fc-174">Uso di`~`nel markup dichiarativo</span><span class="sxs-lookup"><span data-stu-id="8e5fc-174">Using`~`in the Declarative Markup</span></span>

<span data-ttu-id="8e5fc-175">Diversi controlli Web ASP.NET includono proprietà correlate all'URL: il controllo HyperLink ha una proprietà `NavigateUrl`; il controllo immagine ha una proprietà `ImageUrl`; E così via.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-175">Several ASP.NET Web controls include URL-related properties: the HyperLink control has a `NavigateUrl` property; the Image control has an `ImageUrl` property; and so on.</span></span> <span data-ttu-id="8e5fc-176">Quando ne viene eseguito il rendering, questi controlli passano i relativi valori di proprietà correlati all'URL a `ResolveClientUrl`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-176">When rendered, these controls pass their URL-related property values to `ResolveClientUrl`.</span></span> <span data-ttu-id="8e5fc-177">Di conseguenza, se queste proprietà contengono un `~` per indicare la radice dell'applicazione Web, l'URL verrà modificato in un URL relativo valido.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-177">Consequently, if these properties contain a `~` to indicate the root of the web application, the URL will be modified to a valid relative URL.</span></span>

<span data-ttu-id="8e5fc-178">Tenere presente che solo i controlli server ASP.NET trasformano le `~` nelle proprietà relative all'URL.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-178">Keep in mind that only ASP.NET server controls transform the `~` in their URL-related properties.</span></span> <span data-ttu-id="8e5fc-179">Se un `~` viene visualizzato nel markup HTML statico, ad esempio `<img src="~/Images/PoweredByASPNET.gif" />`, il motore ASP.NET invia il `~` al browser insieme al resto del contenuto HTML.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-179">If a `~` appears in static HTML markup, such as `<img src="~/Images/PoweredByASPNET.gif" />`, the ASP.NET engine sends the `~` to the browser along with the rest of the HTML content.</span></span> <span data-ttu-id="8e5fc-180">Il browser presuppone che il `~` faccia parte dell'URL.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-180">The browser assumes that the `~` is part of the URL.</span></span> <span data-ttu-id="8e5fc-181">Ad esempio, se il browser riceve il markup `<img src="~/Images/PoweredByASPNET.gif" />` presuppone che sia presente una sottocartella denominata `~` con una sottocartella `Images` che contiene il file di immagine `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-181">For example, if the browser receives the markup `<img src="~/Images/PoweredByASPNET.gif" />` it assumes there is a subfolder named `~` with a subfolder `Images` that contains the image file `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="8e5fc-182">Per correggere il markup dell'immagine in `Site.master`, sostituire l'elemento `<img>` esistente con un controllo Web ASP.NET Image.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-182">To fix the image markup in `Site.master`, replace the existing `<img>` element with an ASP.NET Image Web control.</span></span> <span data-ttu-id="8e5fc-183">Impostare la `ID` del controllo Web Image su `PoweredByImage`, la relativa proprietà `ImageUrl` su `~/Images/PoweredByASPNET.gif`e la relativa proprietà `AlternateText` su "Powered by ASP.NET!"</span><span class="sxs-lookup"><span data-stu-id="8e5fc-183">Set the Image Web control's `ID` to `PoweredByImage`, its `ImageUrl` property to `~/Images/PoweredByASPNET.gif`, and its `AlternateText` property to "Powered by ASP.NET!"</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample5.aspx)]

<span data-ttu-id="8e5fc-184">Dopo aver apportato questa modifica alla pagina master, rivedere nuovamente la pagina `~/Admin/Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-184">After making this change to the master page, revisit the `~/Admin/Default.aspx` page again.</span></span> <span data-ttu-id="8e5fc-185">Questa volta il file di immagine `PoweredByASPNET.gif` viene visualizzato nella pagina (vedere la figura 3).</span><span class="sxs-lookup"><span data-stu-id="8e5fc-185">This time the `PoweredByASPNET.gif` image file appears in the page (see Figure 3).</span></span> <span data-ttu-id="8e5fc-186">Quando viene eseguito il rendering del controllo Web Image, viene usato il metodo `ResolveClientUrl` per risolvere il relativo valore della proprietà `ImageUrl`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-186">When the Image Web control is rendered it uses the `ResolveClientUrl` method to resolve its `ImageUrl` property value.</span></span> <span data-ttu-id="8e5fc-187">In `~/Admin/Default.aspx` il `ImageUrl` viene convertito in un URL relativo appropriato, come illustrato nel seguente frammento di codice sorgente HTML:</span><span class="sxs-lookup"><span data-stu-id="8e5fc-187">In `~/Admin/Default.aspx` the `ImageUrl` is converted into an appropriate relative URL, as the following snippet of HTML source shows:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample6.html)]

> [!NOTE]
> <span data-ttu-id="8e5fc-188">Oltre a essere utilizzato nelle proprietà di un controllo Web basato su URL, è possibile utilizzare la `~` anche quando si chiamano i metodi `Response.Redirect` e `Server.MapPath`, tra gli altri.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-188">In addition to being used in URL-based Web control properties, the `~` can also be used when calling the `Response.Redirect` and `Server.MapPath` methods, among others.</span></span> <span data-ttu-id="8e5fc-189">Inoltre, il metodo `ResolveClientUrl` può essere richiamato direttamente da un markup dichiarativo di una pagina master o ASP.NET, se necessario. vedere il post del Blog di [Fritz Onion](https://www.pluralsight.com/blogs/fritz/) [con `ResolveClientUrl` nel markup](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).</span><span class="sxs-lookup"><span data-stu-id="8e5fc-189">Also, the `ResolveClientUrl` method may be invoked directly from an ASP.NET or master page's declarative markup, if needed; see [Fritz Onion](https://www.pluralsight.com/blogs/fritz/)'s blog entry [Using `ResolveClientUrl` in Markup](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).</span></span>

## <a name="fixing-the-master-pages-remaining-relative-urls"></a><span data-ttu-id="8e5fc-190">Correzione degli URL relativi rimanenti della pagina master</span><span class="sxs-lookup"><span data-stu-id="8e5fc-190">Fixing the Master Page's Remaining Relative URLs</span></span>

<span data-ttu-id="8e5fc-191">Oltre all'elemento `<img>` nel `footerContent` appena corretto, la pagina master contiene un URL relativo che richiede attenzione.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-191">In addition to the `<img>` element in the `footerContent` that we just fixed, the master page contains one more relative URL that requires our attention.</span></span> <span data-ttu-id="8e5fc-192">L'area `topContent` include il collegamento "esercitazioni sulle pagine master", che fa riferimento a `Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-192">The `topContent` region includes the link "Master Pages Tutorials," which points to `Default.aspx`.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample7.html)]

<span data-ttu-id="8e5fc-193">Poiché questo URL è relativo, invierà l'utente alla pagina `Default.aspx` nella cartella della pagina di contenuto che sta visitando.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-193">Because this URL is relative, it will send the user to the `Default.aspx` page in the folder of the content page they are visiting.</span></span> <span data-ttu-id="8e5fc-194">Per fare in modo che questo collegamento indichi sempre `Default.aspx` nella cartella radice, è necessario sostituire l'elemento `<a>` con un controllo Web collegamento ipertestuale, in modo da poter usare la notazione `~`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-194">To have this link always point to `Default.aspx` in the root folder we need to replace the `<a>` element with a HyperLink Web control so that we can use the `~` notation.</span></span>

<span data-ttu-id="8e5fc-195">Rimuovere il markup dell'elemento `<a>` e aggiungere al suo posto un controllo collegamento ipertestuale.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-195">Remove the `<a>` element markup and add a HyperLink control in its place.</span></span> <span data-ttu-id="8e5fc-196">Impostare la `ID` del collegamento ipertestuale su `lnkHome`, la relativa proprietà `NavigateUrl` su `~/Default.aspx`e la relativa proprietà `Text` su "esercitazioni su pagine master".</span><span class="sxs-lookup"><span data-stu-id="8e5fc-196">Set the HyperLink's `ID` to `lnkHome`, its `NavigateUrl` property to `~/Default.aspx`, and its `Text` property to "Master Pages Tutorials."</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample8.aspx)]

<span data-ttu-id="8e5fc-197">La procedura è terminata.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-197">That's it!</span></span> <span data-ttu-id="8e5fc-198">A questo punto, tutti gli URL della pagina master sono basati correttamente quando viene eseguito il rendering da una pagina di contenuto indipendentemente dalle cartelle in cui si trovano la pagina master e la pagina contenuto.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-198">At this point all the URLs in our master page are properly based when rendered by a content page regardless of what folders the master page and content page are located in.</span></span>

### <a name="automatic-url-resolution-in-theheadsection"></a><span data-ttu-id="8e5fc-199">Risoluzione automatica degli URL nella sezione`<head>`</span><span class="sxs-lookup"><span data-stu-id="8e5fc-199">Automatic URL Resolution in the`<head>`Section</span></span>

<span data-ttu-id="8e5fc-200">Nell'esercitazione [*creazione di un layout a livello di sito tramite le pagine master*](creating-a-site-wide-layout-using-master-pages-vb.md) è stato aggiunto un `<link>` al file di `Styles.css` nell'area `<head>`:</span><span class="sxs-lookup"><span data-stu-id="8e5fc-200">In the [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md) tutorial we added a `<link>` to the `Styles.css` file in the `<head>` region:</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample9.aspx)]

<span data-ttu-id="8e5fc-201">Mentre l'attributo `href` dell'elemento `<link>` è relativo, viene convertito automaticamente in un percorso appropriato in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-201">While the `<link>` element's `href` attribute is relative, it's automatically converted to an appropriate path at runtime.</span></span> <span data-ttu-id="8e5fc-202">Come illustrato in [*specifica del titolo, dei metatag e di altre intestazioni HTML nell'esercitazione della pagina master*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) , l'area `<head>` è in realtà un controllo lato server, che consente di modificare il contenuto dei controlli interni quando ne viene eseguito il rendering.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-202">As we discussed in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial, the `<head>` region is actually a server-side control, which enables it to modify the contents of its inner controls when it is rendered.</span></span>

<span data-ttu-id="8e5fc-203">Per verificarlo, visitare nuovamente la pagina `~/Admin/Default.aspx` e visualizzare l'origine HTML inviata al browser.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-203">To verify this, revisit the `~/Admin/Default.aspx` page and view the HTML source sent to the browser.</span></span> <span data-ttu-id="8e5fc-204">Come illustrato nel frammento di codice seguente, l'attributo `href` dell'elemento `<link>` è stato modificato automaticamente in un URL relativo appropriato, `../Styles.css`.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-204">As the snippet below illustrates, the `<link>` element's `href` attribute has been automatically modified to an appropriate relative URL, `../Styles.css`.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample10.html)]

## <a name="summary"></a><span data-ttu-id="8e5fc-205">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="8e5fc-205">Summary</span></span>

<span data-ttu-id="8e5fc-206">Spesso le pagine master includono collegamenti, immagini e altre risorse esterne che devono essere specificate tramite un URL.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-206">Master pages very often include links, images, and other external resources that must be specified via a URL.</span></span> <span data-ttu-id="8e5fc-207">Poiché la pagina master e le pagine di contenuto potrebbero non esistere nella stessa cartella, è importante astenersi da usare URL relativi.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-207">Because the master page and content pages might not exist in the same folder, it is important to abstain from using relative URLs.</span></span> <span data-ttu-id="8e5fc-208">Sebbene sia possibile usare URL assoluti hardcoded, l'URL assoluto viene abbinato all'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-208">While it is possible to use hard coded absolute URLs, doing so tightly couples the absolute URL to the web application.</span></span> <span data-ttu-id="8e5fc-209">Se l'URL assoluto viene modificato, come spesso accade quando si trasferisce o si distribuisce un'applicazione Web, è necessario ricordare di tornare indietro e aggiornare gli URL assoluti.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-209">If the absolute URL changes - as it often does when moving or deploying a web application - you'll have to remember to go back and update the absolute URLs.</span></span>

<span data-ttu-id="8e5fc-210">L'approccio ideale consiste nell'usare la tilde (`~`) per indicare la radice dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-210">The ideal approach is to use the tilde (`~`) to indicate the application root.</span></span> <span data-ttu-id="8e5fc-211">I controlli Web ASP.NET che contengono le proprietà correlate all'URL mappano i `~` alla radice dell'applicazione in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-211">ASP.NET Web controls that contain URL-related properties map the `~` to the application root at runtime.</span></span> <span data-ttu-id="8e5fc-212">Internamente, i controlli Web usano il metodo `ResolveClientUrl` della classe `Control` per generare un URL relativo valido.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-212">Internally, the Web controls use the `Control` class's `ResolveClientUrl` method to generate a valid relative URL.</span></span> <span data-ttu-id="8e5fc-213">Questo metodo è pubblico e disponibile da ogni controllo server (inclusa la classe `Page`), quindi può essere usato a livello di programmazione dalle classi code-behind, se necessario.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-213">This method is public and available from every server control (including the `Page` class), so you can use it programmatically from your code-behind classes, if needed.</span></span>

<span data-ttu-id="8e5fc-214">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="8e5fc-214">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="8e5fc-215">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="8e5fc-215">Further Reading</span></span>

<span data-ttu-id="8e5fc-216">Per ulteriori informazioni sugli argomenti trattati in questa esercitazione, fare riferimento alle risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e5fc-216">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="8e5fc-217">Pagine master in ASP.NET</span><span class="sxs-lookup"><span data-stu-id="8e5fc-217">Master Pages in ASP.NET</span></span>](http://www.odetocode.com/Articles/419.aspx)
- [<span data-ttu-id="8e5fc-218">Riassegnazione URL in una pagina master</span><span class="sxs-lookup"><span data-stu-id="8e5fc-218">URL Rebasing in a Master Page</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/masterpages/default.aspx#urls)
- [<span data-ttu-id="8e5fc-219">Uso di `ResolveClientUrl` nel markup</span><span class="sxs-lookup"><span data-stu-id="8e5fc-219">Using `ResolveClientUrl` in Markup</span></span>](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx)

### <a name="about-the-author"></a><span data-ttu-id="8e5fc-220">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="8e5fc-220">About the Author</span></span>

<span data-ttu-id="8e5fc-221">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di più libri ASP/ASP. NET e fondatore di 4GuysFromRolla.com, collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-221">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8e5fc-222">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="8e5fc-222">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8e5fc-223">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 3,5 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8e5fc-223">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8e5fc-224">Scott può essere raggiunto in [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) o tramite il suo blog al [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="8e5fc-224">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="8e5fc-225">Grazie speciale</span><span class="sxs-lookup"><span data-stu-id="8e5fc-225">Special Thanks To</span></span>

<span data-ttu-id="8e5fc-226">Sei interessato a esaminare i miei prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="8e5fc-226">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8e5fc-227">In tal caso, rilasciare una riga in [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="8e5fc-227">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="8e5fc-228">[Precedente](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)
> [Successivo](control-id-naming-in-content-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8e5fc-228">[Previous](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)
[Next](control-id-naming-in-content-pages-vb.md)</span></span>
