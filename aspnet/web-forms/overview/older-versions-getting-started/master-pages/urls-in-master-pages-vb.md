---
uid: web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
title: URL nelle pagine Master (VB) | Microsoft Docs
author: rick-anderson
description: Illustra come gli URL nella pagina master possono interrompersi a causa di un file della pagina master in un'altra directory relativa rispetto alla pagina contenuta. Esamina la riassegnazione...
ms.author: riande
ms.date: 06/10/2008
ms.assetid: 43d1e83c-0092-4dcf-977c-e709c4dce7c3
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 856d0c588535838c73d52ee47648fcb5928cf5b7
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/06/2019
ms.locfileid: "65128613"
---
# <a name="urls-in-master-pages-vb"></a><span data-ttu-id="5737d-104">URL nelle pagine master (VB)</span><span class="sxs-lookup"><span data-stu-id="5737d-104">URLs in Master Pages (VB)</span></span>

<span data-ttu-id="5737d-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5737d-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5737d-106">[Scaricare il codice](http://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_VB.zip) o [Scarica il PDF](http://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="5737d-106">[Download Code](http://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_VB.zip) or [Download PDF](http://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_VB.pdf)</span></span>

> <span data-ttu-id="5737d-107">Illustra come gli URL nella pagina master possono interrompersi a causa di un file della pagina master in un'altra directory relativa rispetto alla pagina contenuta.</span><span class="sxs-lookup"><span data-stu-id="5737d-107">Addresses how URLs in the master page can break due to the master page file being in a different relative directory than the content page.</span></span> <span data-ttu-id="5737d-108">Esamina la riassegnazione degli URL tramite ~ la sintassi dichiarativa e l'uso ResolveUrl e ResolveClientUrl a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="5737d-108">Looks at rebasing URLs via ~ in the declarative syntax and using ResolveUrl and ResolveClientUrl programmatically.</span></span> <span data-ttu-id="5737d-109">(Vedere anche</span><span class="sxs-lookup"><span data-stu-id="5737d-109">(Also look at</span></span>

## <a name="introduction"></a><span data-ttu-id="5737d-110">Introduzione</span><span class="sxs-lookup"><span data-stu-id="5737d-110">Introduction</span></span>

<span data-ttu-id="5737d-111">In tutti gli esempi abbiamo visto finora, che le pagine master e di contenuto hanno si trovino nella stessa cartella (cartella radice del sito Web).</span><span class="sxs-lookup"><span data-stu-id="5737d-111">In all the examples we've seen thus far, the master and content pages have been located in the same folder (the website's root folder).</span></span> <span data-ttu-id="5737d-112">Ma non c'è nessun motivo per cui le pagine master e di contenuto devono essere nella stessa cartella.</span><span class="sxs-lookup"><span data-stu-id="5737d-112">But there's no reason why the master and content pages must be in the same folder.</span></span> <span data-ttu-id="5737d-113">È certamente possibile creare pagine di contenuto nelle sottocartelle.</span><span class="sxs-lookup"><span data-stu-id="5737d-113">You can certainly create content pages in subfolders.</span></span> <span data-ttu-id="5737d-114">Analogamente, è possibile creare un `~/MasterPages/` cartella in cui posizionare le pagine master del sito.</span><span class="sxs-lookup"><span data-stu-id="5737d-114">Similarly, you might create a `~/MasterPages/` folder where you place your site's master pages.</span></span>

<span data-ttu-id="5737d-115">Un possibile problema con l'inserimento di pagine master e di contenuto in cartelle diverse implica URL interrotto.</span><span class="sxs-lookup"><span data-stu-id="5737d-115">One potential issue with placing master and content pages in different folders involves broken URLs.</span></span> <span data-ttu-id="5737d-116">Se la pagina master contiene tutti gli URL dei collegamenti ipertestuali, immagini o altri elementi, il collegamento sarà valido per le pagine di contenuto che si trovano in una cartella diversa.</span><span class="sxs-lookup"><span data-stu-id="5737d-116">If the master page contains relative URLs in hyperlinks, images, or other elements, the link will be invalid for content pages that reside in a different folder.</span></span> <span data-ttu-id="5737d-117">In questa esercitazione verranno esaminati l'origine di questo problema, nonché le soluzioni alternative.</span><span class="sxs-lookup"><span data-stu-id="5737d-117">In this tutorial we examine the source of this problem as well as workarounds.</span></span>

## <a name="the-problem-with-relative-urls"></a><span data-ttu-id="5737d-118">Il problema con gli URL relativi</span><span class="sxs-lookup"><span data-stu-id="5737d-118">The Problem with Relative URLs</span></span>

<span data-ttu-id="5737d-119">Un URL in una pagina web viene definito un' *URL relativo* se il percorso della risorsa cui punta è relativo alla posizione della pagina web nella struttura di cartelle del sito Web.</span><span class="sxs-lookup"><span data-stu-id="5737d-119">A URL on a web page is said to be a *relative URL* if the location of the resource it points to is relative to the web page's location in the website's folder structure.</span></span> <span data-ttu-id="5737d-120">Qualsiasi URL che non inizia con una barra rovesciata iniziale (`/`) o un protocollo (ad esempio `http://`) è relativo perché viene risolto dal browser in base alla posizione della pagina web che contiene l'URL.</span><span class="sxs-lookup"><span data-stu-id="5737d-120">Any URL that does not start with a leading forward slash (`/`) or a protocol (such as `http://`) is relative because it is resolved by the browser based on the location of the web page that contains the URL.</span></span>

<span data-ttu-id="5737d-121">Ad esempio, il nostro sito Web ha un `~/Images/` cartella con un unico file di immagine, `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="5737d-121">For example, our website has an `~/Images/` folder with a single image file, `PoweredByASPNET.gif`.</span></span> <span data-ttu-id="5737d-122">Il file pagina master `Site.master` ha un `<img>` elemento il `footerContent` area con il markup seguente:</span><span class="sxs-lookup"><span data-stu-id="5737d-122">The master page file `Site.master` has an `<img>` element in the `footerContent` region with the following markup:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample1.html)]

<span data-ttu-id="5737d-123">Il `src` nel valore dell'attributo di `<img>` elemento è un URL relativo, dal momento che non iniziano con `/` o `http://`.</span><span class="sxs-lookup"><span data-stu-id="5737d-123">The `src` attribute value in the `<img>` element is a relative URL because it does not start with `/` or `http://`.</span></span> <span data-ttu-id="5737d-124">In breve, il `src` valore dell'attributo indica al browser di esaminare il `Images` sottocartella per un file denominato `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="5737d-124">In short, the `src` attribute value tells the browser to look in the `Images` subfolder for a file named `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="5737d-125">Quando si visita una pagina di contenuto, il markup riportato sopra viene inviato direttamente al browser.</span><span class="sxs-lookup"><span data-stu-id="5737d-125">When visiting a content page, the above markup is sent directly to the browser.</span></span> <span data-ttu-id="5737d-126">Si consiglia di visitare `About.aspx` e visualizzare l'origine HTML inviato al browser.</span><span class="sxs-lookup"><span data-stu-id="5737d-126">Take a moment to visit `About.aspx` and view the HTML source sent to the browser.</span></span> <span data-ttu-id="5737d-127">Si noterà che lo stesso markup esatto nella pagina master è stato inviato al browser.</span><span class="sxs-lookup"><span data-stu-id="5737d-127">You will find that the exact same markup in the master page was sent to the browser.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample2.html)]

<span data-ttu-id="5737d-128">Se la pagina di contenuto si trova nella cartella radice (essendo `About.aspx`) tutto funzioni come previsto poiché non esiste un `Images` sottocartella relativo alla cartella radice.</span><span class="sxs-lookup"><span data-stu-id="5737d-128">If the content page is in the root folder (as is `About.aspx`) everything works as expected because there is an `Images` subfolder relative to the root folder.</span></span> <span data-ttu-id="5737d-129">Tuttavia, le cose suddividere se la pagina di contenuto si trova in una cartella diversa da quella della pagina master.</span><span class="sxs-lookup"><span data-stu-id="5737d-129">However, things break down if the content page is in a different folder than the master page.</span></span> <span data-ttu-id="5737d-130">Per illustrare questo scenario, creare una sottocartella denominata `Admin`.</span><span class="sxs-lookup"><span data-stu-id="5737d-130">To illustrate this, create a subfolder named `Admin`.</span></span> <span data-ttu-id="5737d-131">Successivamente, aggiungere una pagina di contenuto denominata `Default.aspx` per il `Admin` cartella, assicurandosi di associare la nuova pagina per il `Site.master` pagina master.</span><span class="sxs-lookup"><span data-stu-id="5737d-131">Next, add a content page named `Default.aspx` to the `Admin` folder, making sure to bind the new page to the `Site.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="5737d-132">Nel [ *specificazione di titolo, metatag e altre intestazioni HTML nella pagina Master* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) esercitazione è stata creata una classe di pagina base personalizzata denominata `BasePage` che impostato automaticamente il contenuto del titolo pagina (se si non è stato esplicitamente assegnato).</span><span class="sxs-lookup"><span data-stu-id="5737d-132">In the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that automatically set the content page's title (if it was not explicitly assigned).</span></span> <span data-ttu-id="5737d-133">Non dimenticare di derivano dalla classe code-behind della pagina appena creata `BasePage` in modo che possa usare questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="5737d-133">Don't forget to have the newly created page's code-behind class derive from `BasePage` so that it can utilize this functionality.</span></span>

<span data-ttu-id="5737d-134">Dopo aver creato questa pagina di contenuto, Esplora soluzioni sarà simile alla figura 1.</span><span class="sxs-lookup"><span data-stu-id="5737d-134">After you have created this content page, your Solution Explorer should look similar to Figure 1.</span></span>

![Una nuova cartella e una pagina ASP.NET sono stati aggiunti al progetto](urls-in-master-pages-vb/_static/image1.png)

<span data-ttu-id="5737d-136">**Figura 01**: Una nuova cartella e una pagina ASP.NET sono stati aggiunti al progetto</span><span class="sxs-lookup"><span data-stu-id="5737d-136">**Figure 01**: A New Folder and ASP.NET Page Have Been Added to the Project</span></span>

<span data-ttu-id="5737d-137">A questo punto, aggiornare il `Web.sitemap` file per includere un nuovo `<siteMapNode>` voce per questa lezione.</span><span class="sxs-lookup"><span data-stu-id="5737d-137">Next, update the `Web.sitemap` file to include a new `<siteMapNode>` entry for this lesson.</span></span> <span data-ttu-id="5737d-138">Il codice XML seguente viene illustrato l'intero `Web.sitemap` markup, che ora include l'aggiunta di un terzo `<siteMapNode>` elemento.</span><span class="sxs-lookup"><span data-stu-id="5737d-138">The following XML shows the complete `Web.sitemap` markup, which now includes the addition of a third `<siteMapNode>` element.</span></span>

[!code-xml[Main](urls-in-master-pages-vb/samples/sample3.xml)]

<span data-ttu-id="5737d-139">L'oggetto appena creato `Default.aspx` pagina dovrebbe disporre di quattro controlli contenuto corrispondente per i quattro elementi ContentPlaceHolder in `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="5737d-139">The newly created `Default.aspx` page should have four Content controls corresponding to the four ContentPlaceHolders in `Site.master`.</span></span> <span data-ttu-id="5737d-140">Aggiungere il testo per il controllo contenuto che fa riferimento il `MainContent` ContentPlaceHolder e quindi accedere alla pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="5737d-140">Add some text to the Content control referencing the `MainContent` ContentPlaceHolder and then visit the page through a browser.</span></span> <span data-ttu-id="5737d-141">Come illustrato nella figura 2, il browser non è stato trovato il `PoweredByASPNET.gif` file di immagine.</span><span class="sxs-lookup"><span data-stu-id="5737d-141">As Figure 2 shows, the browser cannot find the `PoweredByASPNET.gif` image file.</span></span> <span data-ttu-id="5737d-142">Che cosa succede?</span><span class="sxs-lookup"><span data-stu-id="5737d-142">What's going on here?</span></span>

<span data-ttu-id="5737d-143">Il `~/Admin/Default.aspx` pagina di contenuto viene inviato il codice HTML stesso per il `footerContent` area, come è stato il `About.aspx` pagina:</span><span class="sxs-lookup"><span data-stu-id="5737d-143">The `~/Admin/Default.aspx` content page is sent the same HTML for the `footerContent` region as was the `About.aspx` page:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample4.html)]

<span data-ttu-id="5737d-144">Poiché il `<img>` dell'elemento `src` attributo è un URL relativo, il Visualizzatore prova a cercare un `Images` cartella al percorso di cartella della pagina web.</span><span class="sxs-lookup"><span data-stu-id="5737d-144">Because the `<img>` element's `src` attribute is a relative URL, the browser attempts to look for an `Images` folder relative to the web page's folder location.</span></span> <span data-ttu-id="5737d-145">In altre parole, il browser sta cercando il file di immagine `Admin/Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="5737d-145">In other words, the browser is looking for the image file `Admin/Images/PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="5737d-146">[![Impossibile trovare il File di immagine PoweredByASPNET.gif](urls-in-master-pages-vb/_static/image3.png)](urls-in-master-pages-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="5737d-146">[![The PoweredByASPNET.gif Image File Cannot Be Found](urls-in-master-pages-vb/_static/image3.png)](urls-in-master-pages-vb/_static/image2.png)</span></span>

<span data-ttu-id="5737d-147">**Figura 02**: Il `PoweredByASPNET.gif` immagine del File non trovato ([fare clic per visualizzare l'immagine con dimensioni normali](urls-in-master-pages-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="5737d-147">**Figure 02**: The `PoweredByASPNET.gif` Image File Cannot Be Found  ([Click to view full-size image](urls-in-master-pages-vb/_static/image4.png))</span></span>

### <a name="replacing-relative-urls-with-absolute-urls"></a><span data-ttu-id="5737d-148">Sostituire gli URL relativi con gli URL assoluti</span><span class="sxs-lookup"><span data-stu-id="5737d-148">Replacing Relative URLs with Absolute URLs</span></span>

<span data-ttu-id="5737d-149">È l'opposto di un URL relativo un' *URL assoluto*, ovvero una che inizia con una barra rovesciata (`/`) o un protocollo, ad esempio `http://`.</span><span class="sxs-lookup"><span data-stu-id="5737d-149">The opposite of a relative URL is an *absolute URL*, which is one that starts with a forward slash (`/`) or a protocol such as `http://`.</span></span> <span data-ttu-id="5737d-150">Poiché un URL assoluto specifica il percorso di una risorsa da un punto fisso noto, lo stesso URL assoluto è valido in qualsiasi pagina web, indipendentemente dalla posizione della pagina web nella struttura di cartelle del sito Web.</span><span class="sxs-lookup"><span data-stu-id="5737d-150">Because an absolute URL specifies the location of a resource from a known fixed point, the same absolute URL is valid in any web page, regardless of the web page's location in the website's folder structure.</span></span>

<span data-ttu-id="5737d-151">Per risolvere l'immagine interrotta illustrato nella figura 2, è necessario aggiornare il `<img>` dell'elemento `src` attributo in modo che utilizzi un URL assoluto anziché uno relativo.</span><span class="sxs-lookup"><span data-stu-id="5737d-151">To remedy the broken image shown in Figure 2, we need to update the `<img>` element's `src` attribute so that it uses an absolute URL instead of a relative one.</span></span> <span data-ttu-id="5737d-152">Per determinare l'URL assoluto corretto, visitare una delle pagine web nel sito Web ed esaminare la barra degli indirizzi.</span><span class="sxs-lookup"><span data-stu-id="5737d-152">To determine the correct absolute URL, visit one of the web pages in your website and examine the Address bar.</span></span> <span data-ttu-id="5737d-153">Come illustrato nella barra degli indirizzi nella figura 2, il percorso completo per l'applicazione web è `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/`.</span><span class="sxs-lookup"><span data-stu-id="5737d-153">As the Address bar in Figure 2 shows, the fully qualified path to the web application is `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/`.</span></span> <span data-ttu-id="5737d-154">Pertanto, è possibile aggiornare il `<img>` dell'elemento `src` attribuire a uno dei due URL assoluto seguente:</span><span class="sxs-lookup"><span data-stu-id="5737d-154">Therefore, we could update the `<img>` element's `src` attribute to either of the following two absolute URLs:</span></span>

- `/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`
- `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`

<span data-ttu-id="5737d-155">Si consiglia di aggiornare il `<img>` dell'elemento `src` dell'attributo a un URL assoluto usando uno dei formati illustrati in precedenza e quindi visitare la `~/Admin/Default.aspx` pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="5737d-155">Take a moment to update the `<img>` element's `src` attribute to an absolute URL using one of the forms shown above and then visit the `~/Admin/Default.aspx` page through a browser.</span></span> <span data-ttu-id="5737d-156">Questa volta il browser trovare e visualizzare correttamente il `PoweredByASPNET.gif` file di immagine (vedere la figura 3).</span><span class="sxs-lookup"><span data-stu-id="5737d-156">This time the browser will correctly find and display the `PoweredByASPNET.gif` image file (see Figure 3).</span></span>

<span data-ttu-id="5737d-157">[![L'immagine PoweredByASPNET.gif viene ora visualizzata](urls-in-master-pages-vb/_static/image6.png)](urls-in-master-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="5737d-157">[![The PoweredByASPNET.gif Image is Now Displayed](urls-in-master-pages-vb/_static/image6.png)](urls-in-master-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="5737d-158">**Figura 03**: Il `PoweredByASPNET.gif` immagine è ora visualizzata ([fare clic per visualizzare l'immagine con dimensioni normali](urls-in-master-pages-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="5737d-158">**Figure 03**: The `PoweredByASPNET.gif` Image is Now Displayed  ([Click to view full-size image](urls-in-master-pages-vb/_static/image7.png))</span></span>

<span data-ttu-id="5737d-159">Anche se codificare in URL assoluto funziona, strettamente collegato del codice HTML al server del sito Web e percorso della cartella, ma potrebbe cambiare.</span><span class="sxs-lookup"><span data-stu-id="5737d-159">While hard coding in the absolute URL works, it tightly couples your HTML to the website's server and folder location, which may change.</span></span> <span data-ttu-id="5737d-160">Usando un URL assoluto del form `http://localhost:3908/...` è instabile perché il numero di porta che precede localhost viene selezionato automaticamente ogni volta che viene avviato Visual Studio Development Server Web ASP.NET predefinito.</span><span class="sxs-lookup"><span data-stu-id="5737d-160">Using an absolute URL of the form `http://localhost:3908/...` is brittle because the port number preceding localhost is selected automatically each time Visual Studio's built-in ASP.NET Development Web Server is started.</span></span> <span data-ttu-id="5737d-161">Analogamente, il `http://localhost` parte è valida solo durante il test locale.</span><span class="sxs-lookup"><span data-stu-id="5737d-161">Similarly, the `http://localhost` part is only valid when testing locally.</span></span> <span data-ttu-id="5737d-162">Una volta il codice viene distribuito in un server di produzione, la base URL cambierà per qualcos'altro, ad esempio `http://www.yourserver.com`.</span><span class="sxs-lookup"><span data-stu-id="5737d-162">Once the code is deployed to a production server, the URL base will change to something else, like `http://www.yourserver.com`.</span></span> <span data-ttu-id="5737d-163">L'URL assoluto sotto forma `/ASPNET_MasterPages_Tutorial_04_VB/...` risente inoltre inconvenienti stesso, poiché spesso questo percorso dell'applicazione è diverso tra i server di sviluppo e produzione.</span><span class="sxs-lookup"><span data-stu-id="5737d-163">The absolute URL in the form `/ASPNET_MasterPages_Tutorial_04_VB/...` also suffers from the same brittleness because oftentimes this application path differs between development and production servers.</span></span>

<span data-ttu-id="5737d-164">La buona notizia è che ASP.NET offre un metodo per la generazione di un URL relativo valido in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="5737d-164">The good news is that ASP.NET offers a method for generating a valid relative URL at runtime.</span></span>

## <a name="usingandresolveclienturl"></a><span data-ttu-id="5737d-165">Usando`~`e`ResolveClientUrl`</span><span class="sxs-lookup"><span data-stu-id="5737d-165">Using`~`and`ResolveClientUrl`</span></span>

<span data-ttu-id="5737d-166">Anziché a livello di codice un URL assoluto, ASP.NET consente agli sviluppatori di pagina da utilizzare il carattere tilde (`~`) per indicare la radice dell'applicazione web.</span><span class="sxs-lookup"><span data-stu-id="5737d-166">Rather than hard code an absolute URL, ASP.NET allows page developers to use the tilde (`~`) to indicate the root of the web application.</span></span> <span data-ttu-id="5737d-167">Ad esempio, più indietro in questa esercitazione ho utilizzato la notazione `~/Admin/Default.aspx` nel testo per fare riferimento al `Default.aspx` nella pagina di `Admin` cartella.</span><span class="sxs-lookup"><span data-stu-id="5737d-167">For example, earlier in this tutorial I used the notation `~/Admin/Default.aspx` in the text to refer to the `Default.aspx` page in the `Admin` folder.</span></span> <span data-ttu-id="5737d-168">Il `~` indica che il `Admin` cartella è una sottocartella della directory principale dell'applicazione web.</span><span class="sxs-lookup"><span data-stu-id="5737d-168">The `~` indicates that the `Admin` folder is a subfolder of the web application's root.</span></span>

<span data-ttu-id="5737d-169">Il `Control` della classe [ `ResolveClientUrl` metodo](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) accetta un URL e lo modifica a un URL relativo per la pagina web in cui risiede il controllo appropriato.</span><span class="sxs-lookup"><span data-stu-id="5737d-169">The `Control` class's [`ResolveClientUrl` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) takes a URL and modifies it to a relative URL appropriate for the web page on which the control resides.</span></span> <span data-ttu-id="5737d-170">Ad esempio, chiamando `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` dal `About.aspx` restituisce `Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="5737d-170">For example, calling `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` from `About.aspx` returns `Images/PoweredByASPNET.gif`.</span></span> <span data-ttu-id="5737d-171">Viene chiamata da `~/Admin/Default.aspx`, tuttavia, viene restituito `../Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="5737d-171">Calling it from `~/Admin/Default.aspx`, however, returns `../Images/PoweredByASPNET.gif`.</span></span>

> [!NOTE]
> <span data-ttu-id="5737d-172">Poiché tutti i controlli server ASP.NET derivano dal `Control` (classe), tutti i controlli server hanno accesso al `ResolveClientUrl` (metodo).</span><span class="sxs-lookup"><span data-stu-id="5737d-172">Because all ASP.NET server controls derive from the `Control` class, all server controls have access to the `ResolveClientUrl` method.</span></span> <span data-ttu-id="5737d-173">Anche il `Page` deriva dalla classe di `Control` (classe), vale a dire che è possibile usare questo metodo direttamente da classi di code-behind di ASP.NET alla pagina.</span><span class="sxs-lookup"><span data-stu-id="5737d-173">Even the `Page` class derives from the `Control` class, meaning that you can use this method directly from your ASP.NET pages' code-behind classes.</span></span>

### <a name="usingin-the-declarative-markup"></a><span data-ttu-id="5737d-174">Usando`~`nel Markup dichiarativo</span><span class="sxs-lookup"><span data-stu-id="5737d-174">Using`~`in the Declarative Markup</span></span>

<span data-ttu-id="5737d-175">Diversi controlli Web ASP.NET includono proprietà relative alla URL: il controllo collegamento ipertestuale è un `NavigateUrl` proprietà; l'immagine del controllo ha un `ImageUrl` proprietà; e così via.</span><span class="sxs-lookup"><span data-stu-id="5737d-175">Several ASP.NET Web controls include URL-related properties: the HyperLink control has a `NavigateUrl` property; the Image control has an `ImageUrl` property; and so on.</span></span> <span data-ttu-id="5737d-176">Quando sottoposto a rendering, questi controlli passano dei relativi valori di proprietà relative a URL `ResolveClientUrl`.</span><span class="sxs-lookup"><span data-stu-id="5737d-176">When rendered, these controls pass their URL-related property values to `ResolveClientUrl`.</span></span> <span data-ttu-id="5737d-177">Di conseguenza, se queste proprietà contengono una `~` per indicare la radice dell'applicazione web, l'URL verrà modificato in un URL relativo valido.</span><span class="sxs-lookup"><span data-stu-id="5737d-177">Consequently, if these properties contain a `~` to indicate the root of the web application, the URL will be modified to a valid relative URL.</span></span>

<span data-ttu-id="5737d-178">Tenere presente che solo i controlli server ASP.NET trasformano il `~` delle proprietà dei controlli relativi URL.</span><span class="sxs-lookup"><span data-stu-id="5737d-178">Keep in mind that only ASP.NET server controls transform the `~` in their URL-related properties.</span></span> <span data-ttu-id="5737d-179">Se un `~` viene visualizzata nel markup HTML statico, ad esempio `<img src="~/Images/PoweredByASPNET.gif" />`, il motore ASP.NET invia il `~` insieme al resto del contenuto HTML nel browser.</span><span class="sxs-lookup"><span data-stu-id="5737d-179">If a `~` appears in static HTML markup, such as `<img src="~/Images/PoweredByASPNET.gif" />`, the ASP.NET engine sends the `~` to the browser along with the rest of the HTML content.</span></span> <span data-ttu-id="5737d-180">Il browser si presuppone che il `~` fa parte dell'URL.</span><span class="sxs-lookup"><span data-stu-id="5737d-180">The browser assumes that the `~` is part of the URL.</span></span> <span data-ttu-id="5737d-181">Ad esempio, se il browser riceve il markup `<img src="~/Images/PoweredByASPNET.gif" />` presuppone che è presente una sottocartella denominata `~` con una sottocartella `Images` che contiene il file di immagine `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="5737d-181">For example, if the browser receives the markup `<img src="~/Images/PoweredByASPNET.gif" />` it assumes there is a subfolder named `~` with a subfolder `Images` that contains the image file `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="5737d-182">Per correggere il tag di immagine nel `Site.master`, sostituire il `<img>` elemento con un controllo Web immagine ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5737d-182">To fix the image markup in `Site.master`, replace the existing `<img>` element with an ASP.NET Image Web control.</span></span> <span data-ttu-id="5737d-183">Impostare il controllo Web Image `ID` a `PoweredByImage`, la relativa `ImageUrl` proprietà `~/Images/PoweredByASPNET.gif`e il relativo `AlternateText` proprietà su "Basata su ASP.NET!"</span><span class="sxs-lookup"><span data-stu-id="5737d-183">Set the Image Web control's `ID` to `PoweredByImage`, its `ImageUrl` property to `~/Images/PoweredByASPNET.gif`, and its `AlternateText` property to "Powered by ASP.NET!"</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample5.aspx)]

<span data-ttu-id="5737d-184">Dopo aver apportato questa modifica della pagina master, visitare di nuovo il `~/Admin/Default.aspx` pagina nuovamente.</span><span class="sxs-lookup"><span data-stu-id="5737d-184">After making this change to the master page, revisit the `~/Admin/Default.aspx` page again.</span></span> <span data-ttu-id="5737d-185">Questa volta il `PoweredByASPNET.gif` file di immagine viene visualizzata nella pagina (vedere la figura 3).</span><span class="sxs-lookup"><span data-stu-id="5737d-185">This time the `PoweredByASPNET.gif` image file appears in the page (see Figure 3).</span></span> <span data-ttu-id="5737d-186">Quando il controllo immagine Web viene eseguito il rendering Usa il `ResolveClientUrl` metodo per risolvere i relativi `ImageUrl` valore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="5737d-186">When the Image Web control is rendered it uses the `ResolveClientUrl` method to resolve its `ImageUrl` property value.</span></span> <span data-ttu-id="5737d-187">Nelle `~/Admin/Default.aspx` il `ImageUrl` viene convertito in un URL relativo appropriato, come il seguente frammento di codice HTML sorgente Mostra:</span><span class="sxs-lookup"><span data-stu-id="5737d-187">In `~/Admin/Default.aspx` the `ImageUrl` is converted into an appropriate relative URL, as the following snippet of HTML source shows:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample6.html)]

> [!NOTE]
> <span data-ttu-id="5737d-188">Oltre a essere usata nelle proprietà del controllo Web basato su URL, il `~` può essere utilizzato anche quando si chiama il `Response.Redirect` e `Server.MapPath` metodi, tra gli altri.</span><span class="sxs-lookup"><span data-stu-id="5737d-188">In addition to being used in URL-based Web control properties, the `~` can also be used when calling the `Response.Redirect` and `Server.MapPath` methods, among others.</span></span> <span data-ttu-id="5737d-189">Inoltre, il `ResolveClientUrl` metodo può essere richiamato direttamente da un ASP.NET o markup dichiarativo della pagina master, se necessario, vedere [Fritz Onion](https://www.pluralsight.com/blogs/fritz/)del post di blog [Using `ResolveClientUrl` nel Markup](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).</span><span class="sxs-lookup"><span data-stu-id="5737d-189">Also, the `ResolveClientUrl` method may be invoked directly from an ASP.NET or master page's declarative markup, if needed; see [Fritz Onion](https://www.pluralsight.com/blogs/fritz/)'s blog entry [Using `ResolveClientUrl` in Markup](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).</span></span>

## <a name="fixing-the-master-pages-remaining-relative-urls"></a><span data-ttu-id="5737d-190">Correzione della pagina Master rimanenti gli URL relativi</span><span class="sxs-lookup"><span data-stu-id="5737d-190">Fixing the Master Page's Remaining Relative URLs</span></span>

<span data-ttu-id="5737d-191">Oltre al `<img>` elemento il `footerContent` che è appena stato risolto, la pagina master contiene un URL più relativo che richiede l'attenzione.</span><span class="sxs-lookup"><span data-stu-id="5737d-191">In addition to the `<img>` element in the `footerContent` that we just fixed, the master page contains one more relative URL that requires our attention.</span></span> <span data-ttu-id="5737d-192">Il `topContent` area include il collegamento "Master pagine delle esercitazioni," che fa riferimento al `Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="5737d-192">The `topContent` region includes the link "Master Pages Tutorials," which points to `Default.aspx`.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample7.html)]

<span data-ttu-id="5737d-193">Poiché questo URL è relativo, verrà inviato all'utente di `Default.aspx` pagina nella cartella della pagina contenuto visitato.</span><span class="sxs-lookup"><span data-stu-id="5737d-193">Because this URL is relative, it will send the user to the `Default.aspx` page in the folder of the content page they are visiting.</span></span> <span data-ttu-id="5737d-194">Per visualizzare questo collegamento sempre puntare `Default.aspx` nella cartella radice è necessario sostituire il `<a>` elemento con un collegamento ipertestuale Web controllare in modo che è possibile usare il `~` notation.</span><span class="sxs-lookup"><span data-stu-id="5737d-194">To have this link always point to `Default.aspx` in the root folder we need to replace the `<a>` element with a HyperLink Web control so that we can use the `~` notation.</span></span>

<span data-ttu-id="5737d-195">Rimuovere il `<a>` markup dell'elemento e aggiungere un controllo collegamento ipertestuale al suo posto.</span><span class="sxs-lookup"><span data-stu-id="5737d-195">Remove the `<a>` element markup and add a HyperLink control in its place.</span></span> <span data-ttu-id="5737d-196">Impostare il collegamento ipertestuale `ID` al `lnkHome`, la relativa `NavigateUrl` proprietà `~/Default.aspx`e il relativo `Text` proprietà su "Esercitazioni di pagine Master".</span><span class="sxs-lookup"><span data-stu-id="5737d-196">Set the HyperLink's `ID` to `lnkHome`, its `NavigateUrl` property to `~/Default.aspx`, and its `Text` property to "Master Pages Tutorials."</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample8.aspx)]

<span data-ttu-id="5737d-197">La procedura è terminata.</span><span class="sxs-lookup"><span data-stu-id="5737d-197">That's it!</span></span> <span data-ttu-id="5737d-198">A questo punto tutti gli URL nella nostra pagina master si basano in modo corretto quando viene eseguito il rendering da una pagina di contenuto indipendentemente dal fatto che le cartelle, le pagine master e del contenuto si trovano.</span><span class="sxs-lookup"><span data-stu-id="5737d-198">At this point all the URLs in our master page are properly based when rendered by a content page regardless of what folders the master page and content page are located in.</span></span>

### <a name="automatic-url-resolution-in-theheadsection"></a><span data-ttu-id="5737d-199">Risoluzione degli URL automatica nel`<head>`sezione</span><span class="sxs-lookup"><span data-stu-id="5737d-199">Automatic URL Resolution in the`<head>`Section</span></span>

<span data-ttu-id="5737d-200">Nel [ *creazione di un Layout a livello di sito tramite le pagine Master* ](creating-a-site-wide-layout-using-master-pages-vb.md) esercitazione è stata aggiunta una `<link>` per il `Styles.css` del file nel `<head>` area:</span><span class="sxs-lookup"><span data-stu-id="5737d-200">In the [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md) tutorial we added a `<link>` to the `Styles.css` file in the `<head>` region:</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample9.aspx)]

<span data-ttu-id="5737d-201">Mentre il `<link>` dell'elemento `href` attributo è relativo, viene automaticamente convertito in un percorso appropriato in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="5737d-201">While the `<link>` element's `href` attribute is relative, it's automatically converted to an appropriate path at runtime.</span></span> <span data-ttu-id="5737d-202">Come illustrato nella [ *specificazione di titolo, metatag e altre intestazioni HTML nella pagina Master* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) esercitazione il `<head>` area è in realtà un controllo lato server, che consente di modificare il contenuto dei relativi controlli interni quando ne viene eseguito il rendering.</span><span class="sxs-lookup"><span data-stu-id="5737d-202">As we discussed in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial, the `<head>` region is actually a server-side control, which enables it to modify the contents of its inner controls when it is rendered.</span></span>

<span data-ttu-id="5737d-203">Per effettuare questa verifica, rivedere il `~/Admin/Default.aspx` pagina e visualizzare l'origine HTML inviato al browser.</span><span class="sxs-lookup"><span data-stu-id="5737d-203">To verify this, revisit the `~/Admin/Default.aspx` page and view the HTML source sent to the browser.</span></span> <span data-ttu-id="5737d-204">Come illustrato nel seguente frammento di codice seguente, il `<link>` dell'elemento `href` attributo modificato automaticamente un URL relativo appropriato, `../Styles.css`.</span><span class="sxs-lookup"><span data-stu-id="5737d-204">As the snippet below illustrates, the `<link>` element's `href` attribute has been automatically modified to an appropriate relative URL, `../Styles.css`.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample10.html)]

## <a name="summary"></a><span data-ttu-id="5737d-205">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="5737d-205">Summary</span></span>

<span data-ttu-id="5737d-206">Pagine master molto spesso includono i collegamenti, immagini e altre risorse esterne che devono essere specificati tramite un URL.</span><span class="sxs-lookup"><span data-stu-id="5737d-206">Master pages very often include links, images, and other external resources that must be specified via a URL.</span></span> <span data-ttu-id="5737d-207">Perché la pagina master e le pagine di contenuto potrebbero non esistere nella stessa cartella, è importante astengono usando gli URL relativi.</span><span class="sxs-lookup"><span data-stu-id="5737d-207">Because the master page and content pages might not exist in the same folder, it is important to abstain from using relative URLs.</span></span> <span data-ttu-id="5737d-208">Sebbene sia possibile usare URL assoluti hardcoded, in questo modo strettamente associa l'URL assoluto per l'applicazione web.</span><span class="sxs-lookup"><span data-stu-id="5737d-208">While it is possible to use hard coded absolute URLs, doing so tightly couples the absolute URL to the web application.</span></span> <span data-ttu-id="5737d-209">Se viene modificato l'URL assoluto - quanto accade spesso quando si sposta o si distribuisce un'applicazione web - è necessario ricordarsi di tornare indietro e aggiornare gli URL assoluti.</span><span class="sxs-lookup"><span data-stu-id="5737d-209">If the absolute URL changes - as it often does when moving or deploying a web application - you'll have to remember to go back and update the absolute URLs.</span></span>

<span data-ttu-id="5737d-210">L'approccio ideale consiste nell'usare il carattere tilde (`~`) per indicare la radice dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5737d-210">The ideal approach is to use the tilde (`~`) to indicate the application root.</span></span> <span data-ttu-id="5737d-211">Eseguire il mapping di controlli Web ASP.NET che contengono proprietà relative a URL di `~` alla radice dell'applicazione in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="5737d-211">ASP.NET Web controls that contain URL-related properties map the `~` to the application root at runtime.</span></span> <span data-ttu-id="5737d-212">Internamente, i controlli Web di usano la `Control` della classe `ResolveClientUrl` metodo per generare un URL relativo valido.</span><span class="sxs-lookup"><span data-stu-id="5737d-212">Internally, the Web controls use the `Control` class's `ResolveClientUrl` method to generate a valid relative URL.</span></span> <span data-ttu-id="5737d-213">Questo metodo è pubblica e disponibili da ogni controllo del server (inclusi i `Page` classe), pertanto è possibile usarlo a livello di codice dalle classi code-behind, se necessario.</span><span class="sxs-lookup"><span data-stu-id="5737d-213">This method is public and available from every server control (including the `Page` class), so you can use it programmatically from your code-behind classes, if needed.</span></span>

<span data-ttu-id="5737d-214">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="5737d-214">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="5737d-215">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="5737d-215">Further Reading</span></span>

<span data-ttu-id="5737d-216">Per altre informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="5737d-216">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="5737d-217">Pagine master in ASP.NET</span><span class="sxs-lookup"><span data-stu-id="5737d-217">Master Pages in ASP.NET</span></span>](http://www.odetocode.com/Articles/419.aspx)
- [<span data-ttu-id="5737d-218">La riassegnazione URL in una pagina Master</span><span class="sxs-lookup"><span data-stu-id="5737d-218">URL Rebasing in a Master Page</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/masterpages/default.aspx#urls)
- [<span data-ttu-id="5737d-219">Usando `ResolveClientUrl` nel Markup</span><span class="sxs-lookup"><span data-stu-id="5737d-219">Using `ResolveClientUrl` in Markup</span></span>](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx)

### <a name="about-the-author"></a><span data-ttu-id="5737d-220">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="5737d-220">About the Author</span></span>

<span data-ttu-id="5737d-221">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di più libri e fondatore di 4GuysFromRolla.com, ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="5737d-221">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5737d-222">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="5737d-222">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5737d-223">Il suo ultimo libro si intitola [ *Sams Teach manualmente ASP.NET 3.5 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="5737d-223">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5737d-224">È possibile contattarlo Scott [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) o il suo blog all'indirizzo [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="5737d-224">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="5737d-225">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="5737d-225">Special Thanks To</span></span>

<span data-ttu-id="5737d-226">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="5737d-226">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5737d-227">In questo caso, Inviami una riga in corrispondenza [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="5737d-227">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5737d-228">[Precedente](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)
> [Successivo](control-id-naming-in-content-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5737d-228">[Previous](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)
[Next](control-id-naming-in-content-pages-vb.md)</span></span>
