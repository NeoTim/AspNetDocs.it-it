---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
title: L'interazione con la pagina Master dalla pagina contenuto (VB) | Microsoft Docs
author: rick-anderson
description: Viene illustrato come chiamare i metodi, impostare le proprietà e così via della pagina Master dal codice nella pagina di contenuto.
ms.author: riande
ms.date: 07/11/2008
ms.assetid: 081fe010-ba0f-4e7d-b4ba-774840b601c2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
msc.type: authoredcontent
ms.openlocfilehash: 04642dbcd62fe24d4e0fa379b90cbf4122c57066
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/06/2019
ms.locfileid: "65134072"
---
# <a name="interacting-with-the-master-page-from-the-content-page-vb"></a><span data-ttu-id="0b2ca-103">Interazione con la pagina master dalla pagina di contenuto (VB)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-103">Interacting with the Master Page from the Content Page (VB)</span></span>

<span data-ttu-id="0b2ca-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0b2ca-105">[Scaricare il codice](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) o [Scarica il PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-105">[Download Code](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) or [Download PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span></span>

> <span data-ttu-id="0b2ca-106">Viene illustrato come chiamare i metodi, impostare le proprietà e così via della pagina Master dal codice nella pagina di contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-106">Examines how to call methods, set properties, etc. of the Master Page from code in the Content Page.</span></span>

## <a name="introduction"></a><span data-ttu-id="0b2ca-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="0b2ca-107">Introduction</span></span>

<span data-ttu-id="0b2ca-108">Nel corso delle ultime cinque esercitazioni che è stato illustrato come creare una pagina master, definire le aree del contenuto, associare le pagine ASP.NET a una pagina master e definire il contenuto specifico della pagina.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-108">Over the course of the past five tutorials we have looked at how to create a master page, define content regions, bind ASP.NET pages to a master page, and define page-specific content.</span></span> <span data-ttu-id="0b2ca-109">Quando un visitatore richiede una particolare pagina contenuta, il contenuto e il markup di pagine master sono combinati in fase di runtime risultanti per il rendering di una gerarchia di controllo unificato.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-109">When a visitor requests a particular content page, the content and master pages' markup are fused at runtime, resulting in the rendering of a unified control hierarchy.</span></span> <span data-ttu-id="0b2ca-110">Di conseguenza, abbiamo già visto uno dei modi in cui la pagina master e una delle relative pagine di contenuto possono interagire: la pagina contenuto illustra in dettaglio il markup da transfuse in controlli ContentPlaceHolder della pagina master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-110">Therefore, we have already seen one way in which the master page and one of its content pages can interact: the content page spells out the markup to transfuse into the master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="0b2ca-111">Che cos'è ancora stato da esaminare è come le pagine master e del contenuto possono interagire a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-111">What we have yet to examine is how the master page and content page can interact programmatically.</span></span> <span data-ttu-id="0b2ca-112">Oltre a definire il markup per i controlli ContentPlaceHolder della pagina master, una pagina di contenuto può anche assegnare valori alle proprietà pubbliche della relativa pagina master e richiamarne i metodi pubblici.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-112">In addition to defining the markup for the master page's ContentPlaceHolder controls, a content page can also assign values to its master page's public properties and invoke its public methods.</span></span> <span data-ttu-id="0b2ca-113">Analogamente, una pagina master può interagire con le pagine di contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-113">Similarly, a master page may interact with its content pages.</span></span> <span data-ttu-id="0b2ca-114">Sebbene sia meno frequente l'interazione tra loro i markup dichiarativi interazione a livello di codice tra una pagina master e di contenuto, esistono molti scenari in cui è necessario tale livello di programmazione.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-114">While programmatic interaction between a master and content page is less common than the interaction between their declarative markups, there are many scenarios where such programmatic interaction is needed.</span></span>

<span data-ttu-id="0b2ca-115">In questa esercitazione verranno esaminati come una pagina di contenuto a livello di codice può interagire con la pagina master. Nella prossima esercitazione si esaminerà come pagina master allo stesso modo può interagire con le pagine di contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-115">In this tutorial we examine how a content page can programmatically interact with its master page; in the next tutorial we will look at how the master page can similarly interact with its content pages.</span></span>

## <a name="examples-of-programmatic-interaction-between-a-content-page-and-its-master-page"></a><span data-ttu-id="0b2ca-116">Esempi di interazione a livello di codice tra una pagina di contenuto e la relativa pagina Master</span><span class="sxs-lookup"><span data-stu-id="0b2ca-116">Examples of Programmatic Interaction Between a Content Page and its Master Page</span></span>

<span data-ttu-id="0b2ca-117">Quando una determinata area di una pagina deve essere configurato in base a una pagina per pagina, viene usato un controllo ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-117">When a particular region of a page needs to be configured on a page-by-page basis, we use a ContentPlaceHolder control.</span></span> <span data-ttu-id="0b2ca-118">Ma per quanto riguarda casi in cui la maggior parte delle pagine necessario per generare un determinato output, ma un numero ridotto di pagine necessario personalizzarlo per mostrare qualche altro?</span><span class="sxs-lookup"><span data-stu-id="0b2ca-118">But what about situations where the majority of pages need to emit a certain output, but a small number of pages need to customize it to show something else?</span></span> <span data-ttu-id="0b2ca-119">Uno di questi esempi, che abbiamo esaminati nel [ *più elementi ContentPlaceHolder e contenuto predefinito* ](multiple-contentplaceholders-and-default-content-vb.md) esercitazione comporta la visualizzazione di un'interfaccia di accesso in ogni pagina.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-119">One such example, which we examined in the [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial, involves displaying a login interface on each page.</span></span> <span data-ttu-id="0b2ca-120">Mentre la maggior parte delle pagine devono includere un'interfaccia di accesso, deve essere eliminata per un numero limitato di pagine, ad esempio: la pagina di accesso principali (`Login.aspx`); la pagina Crea Account; e altre pagine accessibili solo agli utenti autenticati.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-120">While most pages should include a login interface, it should be suppressed for a handful of pages, such as: the main login page (`Login.aspx`); the Create Account page; and other pages that are only accessible to authenticated users.</span></span> <span data-ttu-id="0b2ca-121">Il [ *più elementi ContentPlaceHolder e contenuto predefinito* ](multiple-contentplaceholders-and-default-content-vb.md) esercitazione ha illustrato come definire il contenuto predefinito per un controllo ContentPlaceHolder nella pagina master e quindi come eseguirne l'override in tali pagine in cui il il contenuto predefinito non è stato voluto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-121">The [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial showed how to define the default content for a ContentPlaceHolder in the master page and then how to override it in those pages where the default content was not wanted.</span></span>

<span data-ttu-id="0b2ca-122">Un'altra opzione consiste nel creare una proprietà pubblica o un metodo all'interno della pagina master che indica se mostrare o nascondere l'interfaccia di accesso.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-122">Another option is to create a public property or method within the master page that indicates whether to show or hide the login interface.</span></span> <span data-ttu-id="0b2ca-123">Ad esempio, la pagina master può includere una proprietà pubblica denominata `ShowLoginUI` il cui valore è stato usato per impostare il `Visible` proprietà del controllo di accesso nella pagina master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-123">For example, the master page might include a public property named `ShowLoginUI` whose value was used to set the `Visible` property of the Login control in the master page.</span></span> <span data-ttu-id="0b2ca-124">Tali pagine di contenuto in cui deve essere eliminata l'interfaccia utente di accesso quindi è possibile impostare a livello di codice le `ShowLoginUI` proprietà `False`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-124">Those content pages where the login user interface should be suppressed could then programmatically set the `ShowLoginUI` property to `False`.</span></span>

<span data-ttu-id="0b2ca-125">Forse l'esempio più comune di contenuto e l'interazione di pagina master si verifica quando i dati visualizzati nel pagina master deve essere aggiornato dopo un'azione sia trascorso nella pagina di contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-125">Perhaps the most common example of content and master page interaction occurs when data displayed in the master page needs to be refreshed after some action has transpired in the content page.</span></span> <span data-ttu-id="0b2ca-126">Si consideri una pagina master che include un controllo GridView che visualizza i cinque più di recente aggiunti record da una tabella di database specifico e che una delle relative pagine di contenuto include un'interfaccia per l'aggiunta di nuovi record alla tabella stessa.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-126">Consider a master page that includes a GridView that displays the five most recently added records from a particular database table, and that one of its content pages includes an interface for adding new records to that same table.</span></span>

<span data-ttu-id="0b2ca-127">Quando un utente visita la pagina per aggiungere un nuovo record, vede che le cinque aggiunto più di recente record visualizzati nella pagina master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-127">When a user visits the page to add a new record, she sees the five most recently added records displayed in the master page.</span></span> <span data-ttu-id="0b2ca-128">Dopo aver immesso i valori per le colonne del nuovo record, Anna invia il form.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-128">After filling in the values for the new record's columns, she submits the form.</span></span> <span data-ttu-id="0b2ca-129">Presupponendo che il controllo GridView nella pagina master presenti relativo `EnableViewState` proprietà è impostata su True (impostazione predefinita), il relativo contenuto viene ricaricato dallo stato di visualizzazione e, di conseguenza, gli stessi cinque record vengono visualizzati anche se un record più recente è stato appena aggiunto al database.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-129">Assuming that the GridView in the master page has its `EnableViewState` property set to True (the default), its content is reloaded from view state and, consequently, the five same records are displayed even though a newer record was just added to the database.</span></span> <span data-ttu-id="0b2ca-130">Ciò potrebbe confondere l'utente.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-130">This may confuse the user.</span></span>

> [!NOTE]
> <span data-ttu-id="0b2ca-131">Anche se si disabilita lo stato di visualizzazione del controllo GridView in modo che esegue nuovamente l'associazione all'origine dati sottostante a ogni postback, comunque non verrà visualizzata il record aggiunto solo perché i dati sono associati a GridView in precedenza nel ciclo di vita di pagina rispetto a quando viene aggiunto il nuovo record per il datab ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-131">Even if you disable the GridView's view state so that it rebinds to its underlying data source on every postback, it still won't show the just-added record because the data is bound to the GridView earlier in the page lifecycle than when the new record is added to the database.</span></span>

<span data-ttu-id="0b2ca-132">Per risolvere il problema in modo che il record appena aggiunto viene visualizzato nella pagina master del GridView durante il postback, dobbiamo indicare a GridView per riassociare alla relativa origine dati *dopo* è stato aggiunto il nuovo record nel database.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-132">To remedy this so that the just-added record is displayed in the master page's GridView on postback we need to instruct the GridView to rebind to its data source *after* the new record has been added to the database.</span></span> <span data-ttu-id="0b2ca-133">Ciò richiede l'interazione tra le pagine master e il contenuto perché è l'interfaccia per l'aggiunta che del nuovo record (e i relativi gestori di eventi) sono nella pagina di contenuto, ma il controllo GridView che deve essere aggiornato nella pagina master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-133">This requires interaction between the content and master pages because the interface for adding the new record (and its event handlers) are in the content page but the GridView that needs to be refreshed is in the master page.</span></span>

<span data-ttu-id="0b2ca-134">Poiché viene aggiornata la visualizzazione della pagina master da un gestore eventi nella pagina di contenuto è una delle esigenze più comuni per il contenuto e l'interazione di pagina master, verranno esaminati in questo argomento in modo più dettagliato.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-134">Because refreshing the master page's display from an event handler in the content page is one of the most common needs for content and master page interaction, let's explore this topic in more detail.</span></span> <span data-ttu-id="0b2ca-135">Il download per questa esercitazione include un database di Microsoft SQL Server 2005 Express Edition denominato `NORTHWIND.MDF` del sito Web `App_Data` cartella.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-135">The download for this tutorial includes a Microsoft SQL Server 2005 Express Edition database named `NORTHWIND.MDF` in the website's `App_Data` folder.</span></span> <span data-ttu-id="0b2ca-136">Il database Northwind archivia prodotto, dipendente e informazioni sulle vendite per una società fittizia, Northwind Traders.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-136">The Northwind database stores product, employee, and sales information for a fictitious company, Northwind Traders.</span></span>

<span data-ttu-id="0b2ca-137">Passaggio 1 illustra la visualizzazione di cinque più di recente aggiunta prodotti in un controllo GridView nella pagina master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-137">Step 1 walks through displaying the five most recently added products in a GridView in the master page.</span></span> <span data-ttu-id="0b2ca-138">Passaggio 2 crea una pagina di contenuto per l'aggiunta di nuovi prodotti.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-138">Step 2 creates a content page for adding new products.</span></span> <span data-ttu-id="0b2ca-139">Passaggio 3 verrà illustrato come creare metodi e proprietà pubbliche nella pagina master e il passaggio 4 viene illustrato come interagire a livello di codice con queste proprietà e metodi dalla pagina contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-139">Step 3 looks at how to create public properties and methods in the master page, and Step 4 illustrates how to programmatically interface with these properties and methods from the content page.</span></span>

> [!NOTE]
> <span data-ttu-id="0b2ca-140">Questa esercitazione non addentrarsi nell'analisi di utilizzo dei dati in ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-140">This tutorial does not delve into the specifics of working with data in ASP.NET.</span></span> <span data-ttu-id="0b2ca-141">I passaggi per la configurazione della pagina master visualizzare i dati e la pagina contenuta per l'inserimento di dati sono state completate, ancora breezy.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-141">The steps for setting up the master page to display data and the content page for inserting data are complete, yet breezy.</span></span> <span data-ttu-id="0b2ca-142">Per un'analisi più approfondita la visualizzazione e inserimento di dati e tramite i controlli SqlDataSource e GridView, consultare le risorse nella sezione ulteriori letture alla fine di questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-142">For a more in-depth look at displaying and inserting data and using the SqlDataSource and GridView controls, consult the resources in the Further Readings section at the end of this tutorial.</span></span>

## <a name="step-1-displaying-the-five-most-recently-added-products-in-the-master-page"></a><span data-ttu-id="0b2ca-143">Passaggio 1: Visualizzazione di cinque aggiunto più di recente prodotti nella pagina Master</span><span class="sxs-lookup"><span data-stu-id="0b2ca-143">Step 1: Displaying the Five Most Recently Added Products in the Master Page</span></span>

<span data-ttu-id="0b2ca-144">Aprire la pagina master Site. master e aggiungere un'etichetta e un controllo GridView per il `leftContent` `<div>`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-144">Open the Site.master master page and add a Label and a GridView control to the `leftContent` `<div>`.</span></span> <span data-ttu-id="0b2ca-145">Cancellare il contenuto dell'etichetta `Text` proprietà, impostata relativo `EnableViewState` proprietà `False`e la relativa `ID` proprietà `GridMessage`; impostare il controllo GridView `ID` proprietà `RecentProducts`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-145">Clear out the Label's `Text` property, set its `EnableViewState` property to `False`, and its `ID` property to `GridMessage`; set the GridView's `ID` property to `RecentProducts`.</span></span> <span data-ttu-id="0b2ca-146">Dalla finestra di progettazione, quindi espandere la smart tag di GridView e scegliere di associarlo a una nuova origine dati.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-146">Next, from the Designer, expand the GridView's smart tag and choose to bind it to a new data source.</span></span> <span data-ttu-id="0b2ca-147">Verrà avviata la configurazione guidata origine dati.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-147">This launches the Data Source Configuration wizard.</span></span> <span data-ttu-id="0b2ca-148">Perché il database di Northwind nel `App_Data` cartella è un database di Microsoft SQL Server, scegliere di creare un SqlDataSource selezionando (vedere la figura 1), assegnare un nome SqlDataSource `RecentProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-148">Because the Northwind database in the `App_Data` folder is a Microsoft SQL Server database, choose to create a SqlDataSource by selecting (see Figure 1); name the SqlDataSource `RecentProductsDataSource`.</span></span>

<span data-ttu-id="0b2ca-149">[![Associare il controllo GridView a un controllo SqlDataSource denominato RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-149">[![Bind the GridView to a SqlDataSource Control Named RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="0b2ca-150">**Figura 01**: Associare un controllo SqlDataSource denominato GridView `RecentProductsDataSource` ([fare clic per visualizzare l'immagine con dimensioni normali](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0b2ca-150">**Figure 01**: Bind the GridView to a SqlDataSource Control Named `RecentProductsDataSource` ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span></span>

<span data-ttu-id="0b2ca-151">Il passaggio successivo viene chiesto di specificare quali database a cui connettersi.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-151">The next step asks us to specify what database to connect to.</span></span> <span data-ttu-id="0b2ca-152">Scegliere il `NORTHWIND.MDF` file dall'elenco a discesa scegliere nel database e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-152">Choose the `NORTHWIND.MDF` database file from the drop-down list and click Next.</span></span> <span data-ttu-id="0b2ca-153">Poiché questa è la prima volta che abbiamo usato in questo database, offrirà la procedura guidata archiviare la stringa di connessione in `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-153">Because this is the first time we've used this database, the wizard will offer to store the connection string in `Web.config`.</span></span> <span data-ttu-id="0b2ca-154">È di archiviare la stringa di connessione usando il nome `NorthwindConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-154">Have it store the connection string using the name `NorthwindConnectionString`.</span></span>

<span data-ttu-id="0b2ca-155">[![Connettersi al Database Northwind](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-155">[![Connect to the Northwind Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="0b2ca-156">**Figura 02**: Connettersi al Northwind Database ([fare clic per visualizzare l'immagine con dimensioni normali](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0b2ca-156">**Figure 02**: Connect to the Northwind Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span></span>

<span data-ttu-id="0b2ca-157">La procedura guidata Configura origine dati offre due modi per cui è possibile specificare la query usata per recuperare i dati:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-157">The Configure Data Source wizard provides two means by which we can specify the query used to retrieve data:</span></span>

- <span data-ttu-id="0b2ca-158">Specificando un'istruzione SQL personalizzata o una stored procedure, o</span><span class="sxs-lookup"><span data-stu-id="0b2ca-158">By specifying a custom SQL statement or stored procedure, or</span></span>
- <span data-ttu-id="0b2ca-159">Selezione di una tabella o vista e specificando le colonne da restituire</span><span class="sxs-lookup"><span data-stu-id="0b2ca-159">By picking a table or view and then specifying the columns to return</span></span>

<span data-ttu-id="0b2ca-160">Poiché si vuole restituire che solo le cinque aggiunto più di recente prodotti, è necessario specificare un'istruzione SQL personalizzata.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-160">Because we want to return just the five most recently added products, we need to specify a custom SQL statement.</span></span> <span data-ttu-id="0b2ca-161">Usare il comando seguente `SELECT` query:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-161">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample1.sql)]

<span data-ttu-id="0b2ca-162">Il `TOP 5` (parola chiave) restituisce solo i primi cinque record della query.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-162">The `TOP 5` keyword returns only the first five records from the query.</span></span> <span data-ttu-id="0b2ca-163">Il `Products` chiave primaria della tabella, `ProductID`, è un `IDENTITY` colonna, che potremo verificare che ogni nuovo prodotto aggiunto alla tabella avrà un valore superiore a quello della voce precedente.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-163">The `Products` table's primary key, `ProductID`, is an `IDENTITY` column, which assures us that each new product added to the table will have a larger value than the previous entry.</span></span> <span data-ttu-id="0b2ca-164">Pertanto, ordinare i risultati da `ProductID` restituisce i prodotti a partire da più di recente quelle create in ordine decrescente.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-164">Therefore, sorting the results by `ProductID` in descending order returns the products starting with the most recently created ones.</span></span>

<span data-ttu-id="0b2ca-165">[![Restituisce i cinque prodotti aggiunti più di recente](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-165">[![Return the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="0b2ca-166">**Figura 03**: Restituisce i cinque più recentemente aggiunto prodotti ([fare clic per visualizzare l'immagine con dimensioni normali](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="0b2ca-166">**Figure 03**: Return the Five Most Recently Added Products  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span></span>

<span data-ttu-id="0b2ca-167">Dopo aver completato la procedura guidata, Visual Studio genera due i BoundField di GridView visualizzare il `ProductName` e `UnitPrice` campi restituiti dal database.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-167">After completing the wizard, Visual Studio generates two BoundFields for the GridView to display the `ProductName` and `UnitPrice` fields returned from the database.</span></span> <span data-ttu-id="0b2ca-168">A questo punto markup dichiarativo della pagina master deve includere markup simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-168">At this point your master page's declarative markup should include markup similar to the following:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample2.aspx)]

<span data-ttu-id="0b2ca-169">Come si può notare, contiene il markup: il controllo Web Label (`GridMessage`); GridView `RecentProducts`, con due BoundField; e un controllo SqlDataSource che restituisce i cinque più di recente sono stati aggiunti i prodotti.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-169">As you can see, the markup contains: the Label Web control (`GridMessage`); the GridView `RecentProducts`, with two BoundFields; and a SqlDataSource control that returns the five most recently added products.</span></span>

<span data-ttu-id="0b2ca-170">Con questo GridView creato e il relativo controllo SqlDataSource è configurato, visitare il sito Web tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-170">With this GridView created and its SqlDataSource control configured, visit the website through a browser.</span></span> <span data-ttu-id="0b2ca-171">Come illustrato nella figura 4, è possibile vedere una griglia in basso a sinistra che elenca i cinque più di recente aggiunta prodotti.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-171">As Figure 4 shows, you will see a grid in the lower left corner that lists the five most recently added products.</span></span>

<span data-ttu-id="0b2ca-172">[![GridView Visualizza i cinque prodotti aggiunti più di recente](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-172">[![The GridView Displays the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="0b2ca-173">**Figura 04**: GridView Visualizza i cinque più recentemente aggiunto prodotti ([fare clic per visualizzare l'immagine con dimensioni normali](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="0b2ca-173">**Figure 04**: The GridView Displays the Five Most Recently Added Products ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span></span>

> [!NOTE]
> <span data-ttu-id="0b2ca-174">È possibile pulire l'aspetto di GridView.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-174">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="0b2ca-175">Alcuni suggerimenti includono la formattazione visualizzati `UnitPrice` valore come una valuta e l'utilizzo di tipi di carattere e colori di sfondo per migliorare l'aspetto della griglia.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-175">Some suggestions include formatting the displayed `UnitPrice` value as a currency and using background colors and fonts to improve the grid's appearance.</span></span>

## <a name="step-2-creating-a-content-page-to-add-new-products"></a><span data-ttu-id="0b2ca-176">Passaggio 2: Creazione di una pagina contenuta per aggiungere nuovi prodotti</span><span class="sxs-lookup"><span data-stu-id="0b2ca-176">Step 2: Creating a Content Page to Add New Products</span></span>

<span data-ttu-id="0b2ca-177">L'attività successiva consiste nel creare una pagina di contenuto da cui un utente può aggiungere un nuovo prodotto per il `Products` tabella.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-177">Our next task is to create a content page from which a user can add a new product to the `Products` table.</span></span> <span data-ttu-id="0b2ca-178">Aggiungere una nuova pagina contenuta per il `Admin` cartella denominata `AddProduct.aspx`, assicurandosi di associarlo al `Site.master` pagina master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-178">Add a new content page to the `Admin` folder named `AddProduct.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="0b2ca-179">Figura 5 Mostra Esplora soluzioni dopo l'aggiunta di questa pagina per il sito Web.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-179">Figure 5 shows the Solution Explorer after this page has been added to the website.</span></span>

<span data-ttu-id="0b2ca-180">[![Aggiungere una nuova pagina di ASP.NET per la cartella Admin](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-180">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="0b2ca-181">**Figura 05**: Aggiungere una nuova pagina ASP.NET per la `Admin` cartella ([fare clic per visualizzare l'immagine con dimensioni normali](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="0b2ca-181">**Figure 05**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span></span>

<span data-ttu-id="0b2ca-182">Si tenga presente che nel [ *specificazione di titolo, metatag e altre intestazioni HTML nella pagina Master* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) esercitazione è stata creata una classe di pagina base personalizzata denominata `BasePage` che ha generato il titolo della pagina se si tratta di impostare in modo non esplicito.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-182">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that generated the page's title if it was not explicitly set.</span></span> <span data-ttu-id="0b2ca-183">Andare alla `AddProduct.aspx` code-behind della pagina classe e fare in modo che derivano da `BasePage` (anziché da `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="0b2ca-183">Go to the `AddProduct.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="0b2ca-184">Aggiornare infine il `Web.sitemap` file da includere una voce per questa lezione.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-184">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="0b2ca-185">Aggiungere il markup seguente sotto il `<siteMapNode>` per la lezione di problemi di denominazione ID controllo:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-185">Add the following markup beneath the `<siteMapNode>` for the Control ID Naming Issues lesson:</span></span>

[!code-xml[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample3.xml)]

<span data-ttu-id="0b2ca-186">Come illustrato nella figura 6, l'aggiunta di questo `<siteMapNode>` elemento si riflette nell'elenco di lezioni.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-186">As shown in Figure 6, the addition of this `<siteMapNode>` element is reflected in the Lessons list.</span></span>

<span data-ttu-id="0b2ca-187">Tornare al `AddProduct.aspx`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-187">Return to `AddProduct.aspx`.</span></span> <span data-ttu-id="0b2ca-188">Nel controllo del contenuto per il `MainContent` ContentPlaceHolder, aggiungere un controllo DetailsView e denominarlo `NewProduct`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-188">In the Content control for the `MainContent` ContentPlaceHolder, add a DetailsView control and name it `NewProduct`.</span></span> <span data-ttu-id="0b2ca-189">Eseguire l'associazione a un nuovo controllo SqlDataSource denominato DetailsView `NewProductDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-189">Bind the DetailsView to a new SqlDataSource control named `NewProductDataSource`.</span></span> <span data-ttu-id="0b2ca-190">Come con SqlDataSource nel passaggio 1, configurare la procedura guidata in modo che utilizzi il database Northwind e scegliere di specificare un'istruzione SQL personalizzata.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-190">Like with the SqlDataSource in Step 1, configure the wizard so that it uses the Northwind database and choose to specify a custom SQL statement.</span></span> <span data-ttu-id="0b2ca-191">Poiché DetailsView verrà usato per aggiungere elementi al database, è necessario specificare sia un `SELECT` istruzione e una `INSERT` istruzione.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-191">Because the DetailsView will be used to add items to the database, we need to specify both a `SELECT` statement and an `INSERT` statement.</span></span> <span data-ttu-id="0b2ca-192">Usare il comando seguente `SELECT` query:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-192">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample4.sql)]

<span data-ttu-id="0b2ca-193">Quindi, aggiungere quanto segue dalla scheda Inserisci, `INSERT` istruzione:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-193">Then, from the INSERT tab, add the following `INSERT` statement:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample5.sql)]

<span data-ttu-id="0b2ca-194">Dopo aver completato la procedura guidata passa al tag di DetailsView intelligente e selezionare la casella di controllo "Abilita inserimento".</span><span class="sxs-lookup"><span data-stu-id="0b2ca-194">After completing the wizard go to the DetailsView's smart tag and check the "Enable Inserting" checkbox.</span></span> <span data-ttu-id="0b2ca-195">Questo modo viene aggiunta una CommandField DetailsView con relativo `ShowInsertButton` proprietà è impostata su True.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-195">This adds a CommandField to the DetailsView with its `ShowInsertButton` property set to True.</span></span> <span data-ttu-id="0b2ca-196">Poiché questo controllo DetailsView verrà usato esclusivamente per l'inserimento di dati, impostare DetailsView `DefaultMode` proprietà `Insert`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-196">Because this DetailsView will be used solely for inserting data, set the DetailsView's `DefaultMode` property to `Insert`.</span></span>

<span data-ttu-id="0b2ca-197">Questo è tutto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-197">That's all there is to it!</span></span> <span data-ttu-id="0b2ca-198">È possibile testare questa pagina.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-198">Let's test this page.</span></span> <span data-ttu-id="0b2ca-199">Visitare `AddProduct.aspx` tramite un browser, immettere un nome e il prezzo (vedere la figura 6).</span><span class="sxs-lookup"><span data-stu-id="0b2ca-199">Visit `AddProduct.aspx` through a browser, enter a name and price (see Figure 6).</span></span>

<span data-ttu-id="0b2ca-200">[![Aggiungere un nuovo prodotto al Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-200">[![Add a New Product to the Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="0b2ca-201">**Figura 06**: Aggiungere un nuovo prodotto al Database ([fare clic per visualizzare l'immagine con dimensioni normali](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="0b2ca-201">**Figure 06**: Add a New Product to the Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span></span>

<span data-ttu-id="0b2ca-202">Dopo aver digitato il nome e il prezzo per il nuovo prodotto, fare clic sul pulsante di inserimento.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-202">After typing in the name and price for your new product, click the Insert button.</span></span> <span data-ttu-id="0b2ca-203">In questo modo il modulo di postback.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-203">This causes the form to postback.</span></span> <span data-ttu-id="0b2ca-204">Durante il del postback, il controllo SqlDataSource `INSERT` istruzione; i due parametri vengono popolati con i valori immessi dall'utente in due controlli TextBox di DetailsView.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-204">On postback, the SqlDataSource control's `INSERT` statement is executed; its two parameters are populated with the user-entered values in the DetailsView's two TextBox controls.</span></span> <span data-ttu-id="0b2ca-205">Sfortunatamente, non vi è alcun feedback visivo che si è verificata un'operazione di inserimento.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-205">Unfortunately, there is no visual feedback that an insert has occurred.</span></span> <span data-ttu-id="0b2ca-206">Sarebbe utile avere un messaggio visualizzato, che conferma che è stato aggiunto un nuovo record.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-206">It would be nice to have a message displayed, confirming that a new record has been added.</span></span> <span data-ttu-id="0b2ca-207">Lasciare come esercizio per il lettore.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-207">I leave this as an exercise for the reader.</span></span> <span data-ttu-id="0b2ca-208">Inoltre, dopo aver aggiunto un nuovo record dal DetailsView GridView nella pagina master viene ancora visualizzato gli stessi cinque record precedente; non include il record appena aggiunti.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-208">Also, after adding a new record from the DetailsView the GridView in the master page still shows the same five records as before; it does not include the just-added record.</span></span> <span data-ttu-id="0b2ca-209">Verrà esaminato come risolvere il problema nei prossimi passaggi.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-209">We'll examine how to remedy this in the upcoming steps.</span></span>

> [!NOTE]
> <span data-ttu-id="0b2ca-210">Oltre ad aggiungere una forma di feedback visivo che l'inserimento ha avuto esito positivo, è consigliabile aggiornare anche l'interfaccia di inserimento di DetailsView per includere la convalida.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-210">In addition to adding some form of visual feedback that the insert has succeeded, I'd encourage you to also update the DetailsView's inserting interface to include validation.</span></span> <span data-ttu-id="0b2ca-211">Attualmente, non è prevista alcuna convalida.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-211">Currently, there is no validation.</span></span> <span data-ttu-id="0b2ca-212">Se un utente immette un valore valido per il `UnitPrice` campo, ad esempio "troppo costoso," verrà generata un'eccezione durante il postback quando il sistema tenta di convertire tale stringa in un valore decimale.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-212">If a user enters an invalid value for the `UnitPrice` field, such as "Too expensive," an exception will be thrown on postback when the system attempts to convert that string into a decimal.</span></span> <span data-ttu-id="0b2ca-213">Per altre informazioni sulla personalizzazione di inserimento dell'interfaccia, vedere la [ *personalizzazione dell'interfaccia di modifica dei dati* esercitazione](https://asp.net/learn/data-access/tutorial-20-vb.aspx) dal mio [utilizzo di serie di esercitazioni dati](../../data-access/index.md).</span><span class="sxs-lookup"><span data-stu-id="0b2ca-213">For more information on customizing the inserting interface, refer to the [*Customizing the Data Modification Interface* tutorial](https://asp.net/learn/data-access/tutorial-20-vb.aspx) from my [Working with Data tutorial series](../../data-access/index.md).</span></span>

## <a name="step-3-creating-public-properties-and-methods-in-the-master-page"></a><span data-ttu-id="0b2ca-214">Passaggio 3: Creazione di metodi e proprietà pubbliche nella pagina Master</span><span class="sxs-lookup"><span data-stu-id="0b2ca-214">Step 3: Creating Public Properties and Methods in the Master Page</span></span>

<span data-ttu-id="0b2ca-215">Nel passaggio 1 è stato aggiunto un controllo etichetta Web denominato `GridMessage` sopra il controllo GridView nella pagina master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-215">In Step 1 we added a Label Web control named `GridMessage` above the GridView in the master page.</span></span> <span data-ttu-id="0b2ca-216">Questa etichetta consente, facoltativamente, visualizzare un messaggio.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-216">This Label is intended to optionally display a message.</span></span> <span data-ttu-id="0b2ca-217">Ad esempio, dopo aver aggiunto un nuovo record per il `Products` tabella, potrebbe essere necessario visualizzare un messaggio che legge: "*ProductName* è stato aggiunto al database."</span><span class="sxs-lookup"><span data-stu-id="0b2ca-217">For example, after adding a new record to the `Products` table, we might want to show a message that reads: "*ProductName* has been added to the database."</span></span> <span data-ttu-id="0b2ca-218">Piuttosto che come hardcoded il testo per l'etichetta nella pagina master, si potrebbe essere opportuno personalizzabile per la pagina di contenuto del messaggio.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-218">Rather than hard-code the text for this Label in the master page, we might want the message to be customizable by the content page.</span></span>

<span data-ttu-id="0b2ca-219">Poiché il controllo etichetta viene implementato come una variabile membro protetto all'interno della pagina master che non è possibile accedervi direttamente dalle pagine di contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-219">Because the Label control is implemented as a protected member variable within the master page it cannot be accessed directly from content pages.</span></span> <span data-ttu-id="0b2ca-220">Per poter funzionare con l'etichetta all'interno di una pagina master dalla pagina contenuto (o parimenti, qualsiasi controllo Web nella pagina master) è necessario creare una proprietà pubblica nella pagina master che espone il controllo Web o funge da proxy che può essere una delle relative proprietà  si accede.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-220">In order to work with the Label within a master page from the content page (or, for that matter, any Web control in the master page) we need to create a public property in the master page that exposes the Web control or serves as a proxy by which one of its properties can be accessed.</span></span> <span data-ttu-id="0b2ca-221">Aggiungere la sintassi seguente alla classe code-behind della pagina master per esporre l'etichetta `Text` proprietà:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-221">Add the following syntax to the master page's code-behind class to expose the Label's `Text` property:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample6.vb)]

<span data-ttu-id="0b2ca-222">Quando viene aggiunto un nuovo record per il `Products` tabella da una pagina contenuto la `RecentProducts` GridView nella pagina master deve ripetere l'associazione all'origine dati sottostante.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-222">When a new record is added to the `Products` table from a content page the `RecentProducts` GridView in the master page needs to rebind to its underlying data source.</span></span> <span data-ttu-id="0b2ca-223">Per riassociare la chiamata di GridView relativo `DataBind` (metodo).</span><span class="sxs-lookup"><span data-stu-id="0b2ca-223">To rebind the GridView call its `DataBind` method.</span></span> <span data-ttu-id="0b2ca-224">Poiché il controllo GridView nella pagina master non è accessibile a livello di codice alle pagine di contenuto, è necessario creare un metodo pubblico nella pagina master che, quando viene chiamato, nuovamente l'associazione dati a GridView.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-224">Because the GridView in the master page is not programmatically accessible to the content pages, we need to create a public method in the master page that, when called, rebinds the data to the GridView.</span></span> <span data-ttu-id="0b2ca-225">Aggiungere il metodo seguente alla classe code-behind della pagina master:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-225">Add the following method to the master page's code-behind class:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample7.vb)]

<span data-ttu-id="0b2ca-226">Con il `GridMessageText` proprietà e `RefreshRecentProductsGrid` metodo posto, qualsiasi pagina di contenuto possa a livello di codice impostare o leggere il valore della `GridMessage` dell'etichetta `Text` proprietà o la riassociazione dei dati per il `RecentProducts` GridView.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-226">With the `GridMessageText` property and `RefreshRecentProductsGrid` method in place, any content page can programmatically set or read the value of the `GridMessage` Label's `Text` property or rebind the data to the `RecentProducts` GridView.</span></span> <span data-ttu-id="0b2ca-227">Passaggio 4 viene illustrato come accedere a metodi e proprietà pubbliche della pagina master da una pagina di contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-227">Step 4 examines how to access the master page's public properties and methods from a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="0b2ca-228">Non dimenticare di contrassegnare le proprietà e metodi come la pagina master `Public`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-228">Don't forget to mark the master page's properties and methods as `Public`.</span></span> <span data-ttu-id="0b2ca-229">Se si non indicare in modo esplicito queste proprietà e metodi come `Public`, non sarà accessibile dalla pagina contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-229">If you do not explicitly denote these properties and methods as `Public`, they will not be accessible from the content page.</span></span>

## <a name="step-4-calling-the-master-pages-public-members-from-a-content-page"></a><span data-ttu-id="0b2ca-230">Passaggio 4: La chiamata a membri pubblici della pagina Master da una pagina contenuto</span><span class="sxs-lookup"><span data-stu-id="0b2ca-230">Step 4: Calling the Master Page's Public Members from a Content Page</span></span>

<span data-ttu-id="0b2ca-231">Ora che la pagina master contiene metodi e proprietà pubbliche necessari, siamo pronti per richiamare le proprietà e metodi dal `AddProduct.aspx` pagina contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-231">Now that the master page has the necessary public properties and methods, we're ready to invoke these properties and methods from the `AddProduct.aspx` content page.</span></span> <span data-ttu-id="0b2ca-232">In particolare, è necessario impostare la pagina master `GridMessageText` proprietà e chiamare relativo `RefreshRecentProductsGrid` metodo dopo che il nuovo prodotto è stato aggiunto al database.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-232">Specifically, we need to set the master page's `GridMessageText` property and call its `RefreshRecentProductsGrid` method after the new product has been added to the database.</span></span> <span data-ttu-id="0b2ca-233">Tutti i controlli Web dei dati ASP.NET vengono attivati gli eventi immediatamente prima e dopo il completamento di varie attività, che rendono più semplice per gli sviluppatori di pagina eseguire un'azione a livello di codice prima o dopo l'attività.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-233">All the ASP.NET data Web controls fire events immediately before and after completing various tasks, which make it easy for page developers to take some programmatic action either before or after the task.</span></span> <span data-ttu-id="0b2ca-234">Ad esempio, quando l'utente finale fa clic sul pulsante Inserisci DetailsView, sul postback il controllo DetailsView genera relativo `ItemInserting` eventi prima di iniziare l'inserimento del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-234">For example, when the end user clicks the DetailsView's Insert button, on postback the DetailsView raises its `ItemInserting` event before beginning the inserting workflow.</span></span> <span data-ttu-id="0b2ca-235">Vengono quindi inseriti i record nel database.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-235">It then inserts the record into the database.</span></span> <span data-ttu-id="0b2ca-236">In seguito, genera DetailsView relativo `ItemInserted` evento.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-236">Following that, the DetailsView raises its `ItemInserted` event.</span></span> <span data-ttu-id="0b2ca-237">Pertanto, per usare la pagina master dopo che è stato aggiunto il nuovo prodotto, creare un gestore eventi per DetailsView `ItemInserted` evento.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-237">Therefore, in order to work with the master page after the new product has been added, create an event handler for the DetailsView's `ItemInserted` event.</span></span>

<span data-ttu-id="0b2ca-238">Esistono due modi in cui una pagina di contenuto a livello di programmazione può interfacciarsi con relativa pagina master:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-238">There are two ways that a content page can programmatically interface with its master page:</span></span>

- <span data-ttu-id="0b2ca-239">Uso di `Page.Master` proprietà, che restituisce un riferimento alla pagina master non fortemente tipizzato, o</span><span class="sxs-lookup"><span data-stu-id="0b2ca-239">Using the `Page.Master` property, which returns a loosely-typed reference to the master page, or</span></span>
- <span data-ttu-id="0b2ca-240">Specificare il percorso della pagina pagina master tipo o il file tramite un `@MasterType` direttiva; ciò aggiunge automaticamente una proprietà fortemente tipizzate per la pagina dal titolo `Master`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-240">Specify the page's master page type or file path via a `@MasterType` directive; this automatically adds a strongly-typed property to the page named `Master`.</span></span>

<span data-ttu-id="0b2ca-241">Verrà ora esaminato entrambi gli approcci.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-241">Let's examine both approaches.</span></span>

### <a name="using-the-loosely-typedpagemasterproperty"></a><span data-ttu-id="0b2ca-242">Usando il non fortemente tipizzate`Page.Master`proprietà</span><span class="sxs-lookup"><span data-stu-id="0b2ca-242">Using the Loosely-Typed`Page.Master`Property</span></span>

<span data-ttu-id="0b2ca-243">Tutte le pagine web ASP.NET deve derivare dal `Page` (classe), che si trova nella `System.Web.UI` dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-243">All ASP.NET web pages must derive from the `Page` class, which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="0b2ca-244">Il `Page` classe include una [ `Master` proprietà](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) che restituisce un riferimento alla pagina principale della pagina.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-244">The `Page` class includes a [`Master` property](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) that returns a reference to the page's master page.</span></span> <span data-ttu-id="0b2ca-245">Se la pagina non ha una pagina master `Master` restituisce `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-245">If the page does not have a master page `Master` returns `Nothing`.</span></span>

<span data-ttu-id="0b2ca-246">Il `Master` proprietà restituisce un oggetto di tipo [ `MasterPage` ](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (che si trova nella `System.Web.UI` dello spazio dei nomi) che è il tipo di base da cui derivano da tutte le pagine master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-246">The `Master` property returns an object of type [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (also located in the `System.Web.UI` namespace) which is the base type from which all master pages derive from.</span></span> <span data-ttu-id="0b2ca-247">Pertanto, per usare proprietà o metodi pubblici definiti nella pagina master del nostro sito Web è necessario eseguire il cast di `MasterPage` oggetto restituito dal `Master` proprietà nel tipo appropriato.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-247">Therefore, to use public properties or methods defined in our website's master page we must cast the `MasterPage` object returned from the `Master` property to the appropriate type.</span></span> <span data-ttu-id="0b2ca-248">Poiché il file pagina master denominato `Site.master`, la classe code-behind è stata denominata `Site`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-248">Because we named our master page file `Site.master`, the code-behind class was named `Site`.</span></span> <span data-ttu-id="0b2ca-249">Pertanto, il codice seguente esegue il cast di `Page.Master` proprietà a un'istanza del `Site` classe.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-249">Therefore, the following code casts the `Page.Master` property to an instance of the `Site` class.</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample8.vb)]

<span data-ttu-id="0b2ca-250">Ora che abbiamo eseguito il cast di non fortemente tipizzate `Page.Master` proprietà per il tipo di sito è possibile fare riferimento a proprietà e metodi specifici al sito.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-250">Now that we have casted the loosely-typed `Page.Master` property to the Site type we can reference the properties and methods specific to Site.</span></span> <span data-ttu-id="0b2ca-251">Come illustrato nella figura 7, la proprietà pubblica `GridMessageText` viene visualizzato nell'elenco a discesa IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-251">As Figure 7 shows, the public property `GridMessageText` appears in the IntelliSense drop-down.</span></span>

<span data-ttu-id="0b2ca-252">[![In IntelliSense vengono mostrate le proprietà pubbliche e i metodi di pagina Master](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-252">[![IntelliSense Shows our Master Page's Public Properties and Methods](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="0b2ca-253">**Figura 07**: In IntelliSense vengono mostrate le proprietà pubbliche e i metodi di pagina Master ([fare clic per visualizzare l'immagine con dimensioni normali](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="0b2ca-253">**Figure 07**: IntelliSense Shows our Master Page's Public Properties and Methods ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span></span>

> [!NOTE]
> <span data-ttu-id="0b2ca-254">Se il file pagina master denominata `MasterPage.master` nome della classe code-behind della pagina master è `MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-254">If you named your master page file `MasterPage.master` then the master page's code-behind class name is `MasterPage`.</span></span> <span data-ttu-id="0b2ca-255">Questo può causare ambiguo codice quando si esegue il cast dal tipo `System.Web.UI.MasterPage` per il `MasterPage` classe.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-255">This can lead to ambiguous code when casting from the type `System.Web.UI.MasterPage` to your `MasterPage` class.</span></span> <span data-ttu-id="0b2ca-256">In breve, è necessario qualificare completamente il tipo di cui che si esegue il cast a, che può essere un po' complesso quando si usa il modello di progetto di sito Web.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-256">In short, you need to fully qualify the type you are casting to, which can be a little tricky when using the Web Site Project model.</span></span> <span data-ttu-id="0b2ca-257">Mio suggerimento sarà possibile assicurarsi che quando si crea la pagina master si assegna un nome diverso da `MasterPage.master` o, meglio ancora, creare un riferimento fortemente tipizzato per la pagina master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-257">My suggestion would be to either make sure that when you create your master page you name it something other than `MasterPage.master` or, even better, create a strongly-typed reference to the master page.</span></span>

### <a name="creating-a-strongly-typed-reference-with-themastertypedirective"></a><span data-ttu-id="0b2ca-258">Creazione di un riferimento fortemente tipizzato con la`@MasterType`(direttiva)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-258">Creating a Strongly-Typed Reference with the`@MasterType`Directive</span></span>

<span data-ttu-id="0b2ca-259">Se si osserva attentamente, si noterà che classe code-behind della pagina ASP.NET è una classe parziale (nota di `Partial` parola chiave nella definizione della classe).</span><span class="sxs-lookup"><span data-stu-id="0b2ca-259">If you look closely you can see that an ASP.NET page's code-behind class is a partial class (note the `Partial` keyword in the class definition).</span></span> <span data-ttu-id="0b2ca-260">Classi parziali introdotte in c# e Visual Basic con.NET Framework 2.0 e, in breve, consentano ai membri della classe di essere definito in più file.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-260">Partial classes were introduced in C# and Visual Basic with.NET Framework 2.0 and, in a nutshell, allow for a class's members to be defined across multiple files.</span></span> <span data-ttu-id="0b2ca-261">Il file di classe code-behind - `AddProduct.aspx.vb`, ad esempio, contiene il codice, lo sviluppatore della pagina, creiamo.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-261">The code-behind class file - `AddProduct.aspx.vb`, for example - contains the code that we, the page developer, create.</span></span> <span data-ttu-id="0b2ca-262">Oltre a nostro codice, il motore ASP.NET crea automaticamente un file di classi separate con le proprietà e gestori eventi in cui traducono il markup dichiarativo in gerarchia delle classi della pagina.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-262">In addition to our code, the ASP.NET engine automatically creates a separate class file with properties and event handlers in that translate the declarative markup into the page's class hierarchy.</span></span>

<span data-ttu-id="0b2ca-263">La generazione automatica di codice che si verifica ogni volta che viene visitata una pagina ASP.NET la strada per alcune possibilità piuttosto interessanti e utili.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-263">The automatic code generation that occurs whenever an ASP.NET page is visited paves the way for some rather interesting and useful possibilities.</span></span> <span data-ttu-id="0b2ca-264">Nel caso di pagine master, se si indicano al motore ASP.NET quale pagina master sta utilizzando la pagina contenuta viene generato l'oggetto fortemente tipizzato `Master` proprietà per noi.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-264">In the case of master pages, if we tell the ASP.NET engine what master page is being used by our content page it generates a strongly-typed `Master` property for us.</span></span>

<span data-ttu-id="0b2ca-265">Usare la [ `@MasterType` direttiva](https://msdn.microsoft.com/library/ms228274.aspx) per comunicare al motore ASP.NET del tipo di pagina master alla pagina contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-265">Use the [`@MasterType` directive](https://msdn.microsoft.com/library/ms228274.aspx) to inform the ASP.NET engine of the content page's master page type.</span></span> <span data-ttu-id="0b2ca-266">Il `@MasterType` direttiva può accettare il nome di tipo della pagina master o al percorso del file.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-266">The `@MasterType` directive can accept either the type name of the master page or its file path.</span></span> <span data-ttu-id="0b2ca-267">Per specificare che il `AddProduct.aspx` pagina utilizzi `Site.master` come pagina master, aggiungere la seguente direttiva all'inizio del `AddProduct.aspx`:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-267">To specify that the `AddProduct.aspx` page uses `Site.master` as its master page, add the following directive to the top of `AddProduct.aspx`:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample9.aspx)]

<span data-ttu-id="0b2ca-268">Questa direttiva indica al motore di ASP.NET per aggiungere un riferimento fortemente tipizzato per la pagina master tramite una proprietà denominata `Master`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-268">This directive instructs the ASP.NET engine to add a strongly-typed reference to the master page through a property named `Master`.</span></span> <span data-ttu-id="0b2ca-269">Con il `@MasterType` direttiva posto, è possibile chiamare il `Site.master` master della pagina proprietà e metodi pubblici direttamente tramiti il `Master` proprietà senza cast.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-269">With the `@MasterType` directive in place, we can call the `Site.master` master page's public properties and methods directly through the `Master` property without any casts.</span></span>

> [!NOTE]
> <span data-ttu-id="0b2ca-270">Se si omette il `@MasterType` direttiva, la sintassi `Page.Master` e `Master` restituire lo stesso risultato: un oggetto non fortemente tipizzato alla pagina principale della pagina.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-270">If you omit the `@MasterType` directive, the syntax `Page.Master` and `Master` return the same thing: a loosely-typed object to the page's master page.</span></span> <span data-ttu-id="0b2ca-271">Se si include il `@MasterType` direttiva quindi `Master` restituisce un riferimento fortemente tipizzato per la pagina master specificata.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-271">If you include the `@MasterType` directive then `Master` returns a strongly-typed reference to the specified master page.</span></span> <span data-ttu-id="0b2ca-272">`Page.Master`, tuttavia, restituisce comunque un riferimento non fortemente tipizzato.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-272">`Page.Master`, however, still returns a loosely-typed reference.</span></span> <span data-ttu-id="0b2ca-273">Per un'analisi più completa perché questo è il caso e il comportamento della `Master` proprietà viene creata quando il `@MasterType` direttiva è inclusa, vedere [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)del post di blog [ `@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span><span class="sxs-lookup"><span data-stu-id="0b2ca-273">For a more thorough look at why this is the case and how the `Master` property is constructed when the `@MasterType` directive is included, see [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span></span>

### <a name="updating-the-master-page-after-adding-a-new-product"></a><span data-ttu-id="0b2ca-274">L'aggiornamento della pagina Master dopo l'aggiunta di un nuovo prodotto</span><span class="sxs-lookup"><span data-stu-id="0b2ca-274">Updating the Master Page After Adding a New Product</span></span>

<span data-ttu-id="0b2ca-275">Ora che si sa come richiamare le proprietà pubbliche e i metodi di una pagina di contenuto di una pagina master, siamo pronti per aggiornare il `AddProduct.aspx` pagina in modo che la pagina master viene aggiornata dopo l'aggiunta di un nuovo prodotto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-275">Now that we know how to invoke a master page's public properties and methods from a content page, we're ready to update the `AddProduct.aspx` page so that the master page is refreshed after adding a new product.</span></span> <span data-ttu-id="0b2ca-276">All'inizio del passaggio 4 è stato creato un gestore eventi per il controllo DetailsView `ItemInserting` evento, che viene eseguita immediatamente dopo il nuovo prodotto è stato aggiunto al database.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-276">At the beginning of Step 4 we created an event handler for the DetailsView control's `ItemInserting` event, which executes immediately after the new product has been added to the database.</span></span> <span data-ttu-id="0b2ca-277">Aggiungere il codice seguente al gestore eventi:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-277">Add the following code to that event handler:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample10.vb)]

<span data-ttu-id="0b2ca-278">Il codice riportato sopra Usa entrambi i non fortemente tipizzate `Page.Master` proprietà e fortemente tipizzata `Master` proprietà.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-278">The above code uses both the loosely-typed `Page.Master` property and the strongly-typed `Master` property.</span></span> <span data-ttu-id="0b2ca-279">Si noti che il `GridMessageText` è impostata su "*ProductName* aggiunte alla griglia..." I valori del prodotto appena aggiunti sono accessibili tramite il `e.Values` raccolta, come si può notare, l'appena aggiunte dal `ProductName` valore sono accessibili tramite `e.Values("ProductName")`.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-279">Note that the `GridMessageText` property is set to "*ProductName* added to grid..." The just-added product's values are accessible through the `e.Values` collection; as you can see, the just-added `ProductName` value is accessed via `e.Values("ProductName")`.</span></span>

<span data-ttu-id="0b2ca-280">Figura 8 mostra la `AddProduct.aspx` pagina immediatamente dopo un nuovo prodotto - di Scott Soda - è stato aggiunto al database.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-280">Figure 8 shows the `AddProduct.aspx` page immediately after a new product - Scott's Soda - has been added to the database.</span></span> <span data-ttu-id="0b2ca-281">Si noti che il nome del prodotto appena aggiunte è indicato nell'etichetta della pagina master e che il controllo GridView è stato aggiornato per includere il prodotto e il prezzo.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-281">Note that the just-added product name is noted in the master page's Label and that the GridView has been refreshed to include the product and its price.</span></span>

<span data-ttu-id="0b2ca-282">[![Etichetta della pagina Master e GridView mostrano il prodotto appena aggiunta](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-282">[![The Master Page's Label and GridView Show the Just-Added Product](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span></span>

<span data-ttu-id="0b2ca-283">**Figura 08**: Etichetta della pagina Master e GridView mostrano il prodotto Just-Added ([fare clic per visualizzare l'immagine con dimensioni normali](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="0b2ca-283">**Figure 08**: The Master Page's Label and GridView Show the Just-Added Product ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span></span>

## <a name="summary"></a><span data-ttu-id="0b2ca-284">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="0b2ca-284">Summary</span></span>

<span data-ttu-id="0b2ca-285">In teoria, una pagina master e le pagine contenuto sono completamente separate rispetto a altro e non richiedono alcun livello di interazione.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-285">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="0b2ca-286">Mentre le pagine master e le pagine di contenuto devono essere progettate tenendo presente questo obiettivo, esistono una serie di scenari comuni in cui una pagina di contenuto deve interfacciarsi con relativa pagina master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-286">While master pages and content pages should be designed with that goal in mind, there are a number of common scenarios in which a content page must interface with its master page.</span></span> <span data-ttu-id="0b2ca-287">Uno dei motivi più comuni coinvolge l'aggiornamento di una parte specifica della visualizzazione della pagina master basata su un'azione che si sono verificati nella pagina di contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-287">One of the most common reasons centers around updating a particular portion of the master page display based on some action that transpired in the content page.</span></span>

<span data-ttu-id="0b2ca-288">La buona notizia è che è relativamente semplice avere una pagina di contenuto a livello di programmazione interagire con la pagina master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-288">The good news is that it's relatively straightforward to have a content page programmatically interact with its master page.</span></span> <span data-ttu-id="0b2ca-289">Iniziare creando metodi o proprietà pubbliche nella pagina master che incapsulano la funzionalità che deve essere richiamato da una pagina di contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-289">Start by creating public properties or methods in the master page that encapsulate the functionality that needs to be invoked by a content page.</span></span> <span data-ttu-id="0b2ca-290">Quindi, nella pagina di contenuto, accedere nella pagina master le proprietà e metodi attraverso il non fortemente tipizzate `Page.Master` proprietà oppure usare il `@MasterType` direttiva per creare un riferimento fortemente tipizzato per la pagina master.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-290">Then, in the content page, access the master page's properties and methods through the loosely-typed `Page.Master` property or use the `@MasterType` directive to create a strongly-typed reference to the master page.</span></span>

<span data-ttu-id="0b2ca-291">Nella prossima esercitazione verranno esaminati con la pagina master interagire a livello di codice con una delle relative pagine di contenuto.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-291">In the next tutorial we examine how to have the master page programmatically interact with one of its content pages.</span></span>

<span data-ttu-id="0b2ca-292">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="0b2ca-292">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="0b2ca-293">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="0b2ca-293">Further Reading</span></span>

<span data-ttu-id="0b2ca-294">Per altre informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="0b2ca-294">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="0b2ca-295">L'accesso e aggiornamento dei dati in ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0b2ca-295">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="0b2ca-296">Pagine Master ASP.NET: Suggerimenti, trucchi e trabocchetti</span><span class="sxs-lookup"><span data-stu-id="0b2ca-296">ASP.NET Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="0b2ca-297">`@MasterType` in ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="0b2ca-297">`@MasterType` in ASP.NET 2.0</span></span>](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)
- [<span data-ttu-id="0b2ca-298">Il passaggio di informazioni tra il contenuto e le pagine Master</span><span class="sxs-lookup"><span data-stu-id="0b2ca-298">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="0b2ca-299">Utilizzo dei dati nelle esercitazioni ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0b2ca-299">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="0b2ca-300">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="0b2ca-300">About the Author</span></span>

<span data-ttu-id="0b2ca-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di più libri e fondatore di 4GuysFromRolla.com, ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0b2ca-302">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-302">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0b2ca-303">Il suo ultimo libro si intitola [ *Sams Teach manualmente ASP.NET 3.5 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0b2ca-303">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="0b2ca-304">È possibile contattarlo Scott [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) o il suo blog all'indirizzo [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="0b2ca-304">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="0b2ca-305">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="0b2ca-305">Special Thanks To</span></span>

<span data-ttu-id="0b2ca-306">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-306">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0b2ca-307">Il revisore capo di questa esercitazione è stata Zack Jones.</span><span class="sxs-lookup"><span data-stu-id="0b2ca-307">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="0b2ca-308">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="0b2ca-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0b2ca-309">In questo caso, Inviami un messaggio nella [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-309">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0b2ca-310">[Precedente](control-id-naming-in-content-pages-vb.md)
> [Successivo](interacting-with-the-content-page-from-the-master-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="0b2ca-310">[Previous](control-id-naming-in-content-pages-vb.md)
[Next](interacting-with-the-content-page-from-the-master-page-vb.md)</span></span>
