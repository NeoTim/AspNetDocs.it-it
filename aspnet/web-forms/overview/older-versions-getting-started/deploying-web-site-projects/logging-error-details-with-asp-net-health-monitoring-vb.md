---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/logging-error-details-with-asp-net-health-monitoring-vb
title: I dettagli dell'errore di registrazione con monitoraggio ASP.NET (VB) | Microsoft Docs
author: rick-anderson
description: Sistema di monitoraggio dell'integrità di Microsoft fornisce un modo semplice e personalizzabile per registrare eventi web diversi, tra cui le eccezioni non gestite. Questa esercitazione illustra in modo through...
ms.author: riande
ms.date: 06/09/2009
ms.assetid: 09a6c74e-936a-4c04-8547-5bb313a4e4a3
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/logging-error-details-with-asp-net-health-monitoring-vb
msc.type: authoredcontent
ms.openlocfilehash: a9dd4268ef20b58b674f8ec8313132398fc5f19d
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/17/2019
ms.locfileid: "59413126"
---
# <a name="logging-error-details-with-aspnet-health-monitoring-vb"></a><span data-ttu-id="d502e-104">Registrazione dei dettagli degli errori con il monitoraggio dell'integrità di ASP.NET (VB)</span><span class="sxs-lookup"><span data-stu-id="d502e-104">Logging Error Details with ASP.NET Health Monitoring (VB)</span></span>

<span data-ttu-id="d502e-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d502e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d502e-106">[Scaricare il codice](http://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_13_VB.zip) o [Scarica il PDF](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial13_HealthMonitoring_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="d502e-106">[Download Code](http://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_13_VB.zip) or [Download PDF](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial13_HealthMonitoring_vb.pdf)</span></span>

> <span data-ttu-id="d502e-107">Sistema di monitoraggio dell'integrità di Microsoft fornisce un modo semplice e personalizzabile per registrare eventi web diversi, tra cui le eccezioni non gestite.</span><span class="sxs-lookup"><span data-stu-id="d502e-107">Microsoft's health monitoring system provides an easy and customizable way to log various web events, including unhandled exceptions.</span></span> <span data-ttu-id="d502e-108">Questa esercitazione spiega come impostare il sistema di monitoraggio dello stato per registrare le eccezioni non gestite in un database e per notificare agli sviluppatori tramite un messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="d502e-108">This tutorial walks through setting up the health monitoring system to log unhandled exceptions to a database and to notify developers via an email message.</span></span>


## <a name="introduction"></a><span data-ttu-id="d502e-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="d502e-109">Introduction</span></span>

<span data-ttu-id="d502e-110">La registrazione è uno strumento utile per il monitoraggio dell'integrità di un'applicazione distribuita e per la diagnosi di eventuali problemi che potrebbero verificarsi.</span><span class="sxs-lookup"><span data-stu-id="d502e-110">Logging is a useful tool for monitoring the health of a deployed application and for diagnosing any problems that may arise.</span></span> <span data-ttu-id="d502e-111">È particolarmente importante registrare gli errori che si verificano in un'applicazione distribuita in modo che si può essere risolta.</span><span class="sxs-lookup"><span data-stu-id="d502e-111">It is especially important to log errors that occur in a deployed application so that they can be remedied.</span></span> <span data-ttu-id="d502e-112">Il `Error` evento viene generato ogni volta che si verifica un'eccezione non gestita in un'applicazione ASP.NET; la [esercitazione precedente](processing-unhandled-exceptions-vb.md) è stato illustrato come inviare una notifica di uno sviluppatore di un errore e i dettagli di log mediante la creazione di un gestore eventi per il `Error` evento.</span><span class="sxs-lookup"><span data-stu-id="d502e-112">The `Error` event is raised whenever an unhandled exception occurs in an ASP.NET application; the [preceding tutorial](processing-unhandled-exceptions-vb.md) showed how to notify a developer of an error and log its details by creating an event handler for the `Error` event.</span></span> <span data-ttu-id="d502e-113">Tuttavia, la creazione di un `Error` gestore dell'evento per registrare i dettagli dell'errore e inviare una notifica di uno sviluppatore non è necessaria, poiché questa attività può essere eseguita da ASP. Di NET *integrità sistema di monitoraggio*.</span><span class="sxs-lookup"><span data-stu-id="d502e-113">However, creating an `Error` event handler to log the error's details and notify a developer is unnecessary, as this task can be performed by ASP.NET's *health monitoring system*.</span></span>

<span data-ttu-id="d502e-114">Sistema di monitoraggio dell'integrità è stato introdotto in ASP.NET 2.0 ed è progettato per monitorare l'integrità di un'applicazione ASP.NET distribuita per la registrazione eventi che si verificano durante l'applicazione o la durata della richiesta.</span><span class="sxs-lookup"><span data-stu-id="d502e-114">The health monitoring system was introduced in ASP.NET 2.0 and is designed to monitor the health of a deployed ASP.NET application by logging events that occur during the application or request's lifetime.</span></span> <span data-ttu-id="d502e-115">Gli eventi registrati dal sistema di monitoraggio dell'integrità sono dette *gli eventi di monitoraggio dell'integrità* oppure *eventi Web*e includono:</span><span class="sxs-lookup"><span data-stu-id="d502e-115">The events logged by the health monitoring system are referred to as *health monitoring events* or *Web events*, and include:</span></span>

- <span data-ttu-id="d502e-116">Eventi di durata dell'applicazione, ad esempio quando un'applicazione avvia o arresta</span><span class="sxs-lookup"><span data-stu-id="d502e-116">Application lifetime events, such as when an application starts or stops</span></span>
- <span data-ttu-id="d502e-117">Gli eventi di sicurezza, inclusi i tentativi di accesso non riusciti e URL autorizzazione richieste non riuscite</span><span class="sxs-lookup"><span data-stu-id="d502e-117">Security events, including failed login attempts and failed URL authorization requests</span></span>
- <span data-ttu-id="d502e-118">Errori dell'applicazione, tra cui eccezioni non gestite, lo stato di visualizzazione delle eccezioni, le eccezioni della convalida richiesta e gli errori di compilazione, tra gli altri tipi di errori di analisi.</span><span class="sxs-lookup"><span data-stu-id="d502e-118">Application errors, including unhandled exceptions, view state parsing exceptions, request validation exceptions, and compilation errors, among other types of errors.</span></span>

<span data-ttu-id="d502e-119">Quando un evento monitoraggio dell'integrità possono essere registrato in un numero qualsiasi di specificata *registrare origini*.</span><span class="sxs-lookup"><span data-stu-id="d502e-119">When a health monitoring event is raised it can be logged to any number of specified *log sources*.</span></span> <span data-ttu-id="d502e-120">Sistema di monitoraggio dell'integrità viene fornito con le origini di log che registrano eventi Web in un database di Microsoft SQL Server, nel registro eventi di Windows, o tramite un messaggio di posta elettronica, tra gli altri.</span><span class="sxs-lookup"><span data-stu-id="d502e-120">The health monitoring system ships with log sources that log Web events to a Microsoft SQL Server database, to the Windows Event Log, or via an email message, among others.</span></span> <span data-ttu-id="d502e-121">È anche possibile creare le proprie origini di log.</span><span class="sxs-lookup"><span data-stu-id="d502e-121">You can also create your own log sources.</span></span>

<span data-ttu-id="d502e-122">Gli eventi registra l'integrità di sistema di monitoraggio, con le origini di log usate, sono definiti `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="d502e-122">The events the health monitoring system logs, along with the log sources used, are defined in `Web.config`.</span></span> <span data-ttu-id="d502e-123">Con poche righe di markup di configurazione è possibile usare per registrare tutte le eccezioni non gestite in un database e per ricevere una notifica dell'eccezione tramite posta elettronica di monitoraggio dell'integrità.</span><span class="sxs-lookup"><span data-stu-id="d502e-123">With a few lines of configuration markup you can use health monitoring to log all unhandled exceptions to a database and to notify you of the exception via email.</span></span>

## <a name="exploring-the-health-monitoring-systems-configuration"></a><span data-ttu-id="d502e-124">Esplorazione di configurazione del sistema di monitoraggio dell'integrità</span><span class="sxs-lookup"><span data-stu-id="d502e-124">Exploring the Health Monitoring System's Configuration</span></span>

<span data-ttu-id="d502e-125">Comportamento del sistema di monitoraggio dell'integrità è definito per le informazioni di configurazione, che si trovano nella [ `<healthMonitoring>` elemento](https://msdn.microsoft.com/library/2fwh2ss9.aspx) in `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="d502e-125">The health monitoring system's behavior is defined by its configuration information, which is located in the [`<healthMonitoring>` element](https://msdn.microsoft.com/library/2fwh2ss9.aspx) in `Web.config`.</span></span> <span data-ttu-id="d502e-126">Questa sezione di configurazione definisce i seguenti tre importanti tipi di informazioni:</span><span class="sxs-lookup"><span data-stu-id="d502e-126">This configuration section defines, among other things, the following three important pieces of information:</span></span>

1. <span data-ttu-id="d502e-127">Gli eventi di monitoraggio dell'integrità che, quando generati, devono essere registrate,</span><span class="sxs-lookup"><span data-stu-id="d502e-127">The health monitoring events that, when raised, should be logged,</span></span>
2. <span data-ttu-id="d502e-128">Le origini di log, e</span><span class="sxs-lookup"><span data-stu-id="d502e-128">The log sources, and</span></span>
3. <span data-ttu-id="d502e-129">Modalità di mapping ciascun monitoraggio evento definito in (1) dell'integrità per le origini di log definito (2).</span><span class="sxs-lookup"><span data-stu-id="d502e-129">How each health monitoring event defined in (1) is mapped to the log sources defined in (2).</span></span>

<span data-ttu-id="d502e-130">Queste informazioni vengono specificate tramite gli elementi di configurazione di tre membri figlio: [ `<eventMappings>` ](https://msdn.microsoft.com/library/yc5yk01w.aspx), [ `<providers>` ](https://msdn.microsoft.com/library/zaa41kz1.aspx), e [ `<rules>` ](https://msdn.microsoft.com/library/fe5wyxa0.aspx), rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="d502e-130">This information is specified through three children configuration elements: [`<eventMappings>`](https://msdn.microsoft.com/library/yc5yk01w.aspx), [`<providers>`](https://msdn.microsoft.com/library/zaa41kz1.aspx), and [`<rules>`](https://msdn.microsoft.com/library/fe5wyxa0.aspx), respectively.</span></span>

<span data-ttu-id="d502e-131">Le informazioni di configurazione di sistema di monitoraggio dell'integrità predefinita è reperibile nella `Web.config` del file in `%WINDIR%\Microsoft.NET\Framework\version\CONFIG` cartella.</span><span class="sxs-lookup"><span data-stu-id="d502e-131">The default health monitoring system configuration information can be found in the `Web.config` file in `%WINDIR%\Microsoft.NET\Framework\version\CONFIG` folder.</span></span> <span data-ttu-id="d502e-132">Queste informazioni di configurazione predefinito, con alcuni tag rimossi per brevità, sono illustrate di seguito:</span><span class="sxs-lookup"><span data-stu-id="d502e-132">This default configuration information, with some markup removed for brevity, is shown below:</span></span>

[!code-xml[Main](logging-error-details-with-asp-net-health-monitoring-vb/samples/sample1.xml)]

<span data-ttu-id="d502e-133">Lo stato di integrità monitoraggio eventi di interesse sono definiti nel `<eventMappings>` elemento, che assegna un nome Converto in una classe di eventi di monitoraggio dell'integrità.</span><span class="sxs-lookup"><span data-stu-id="d502e-133">The health monitoring events of interest are defined in the `<eventMappings>` element, which gives a human-friendly name to a class of health monitoring events.</span></span> <span data-ttu-id="d502e-134">Nel markup riportato sopra, il `<eventMappings>` elemento assegna il nome Converto "Tutti gli errori" per gli eventi del tipo di monitoraggio dell'integrità `WebBaseErrorEvent` e il nome "operazioni non riuscite" per gli eventi del tipo di monitoraggio dell'integrità `WebFailureAuditEvent`.</span><span class="sxs-lookup"><span data-stu-id="d502e-134">In the markup above, the `<eventMappings>` element assigns the human-friendly name "All Errors" to the health monitoring events of type `WebBaseErrorEvent` and the name "Failure Audits" to health monitoring events of type `WebFailureAuditEvent`.</span></span>

<span data-ttu-id="d502e-135">Il `<providers>` elemento definisce le origini di log, concedere loro un nome Converto e specificando le informazioni di configurazione specifiche dell'origine di log.</span><span class="sxs-lookup"><span data-stu-id="d502e-135">The `<providers>` element defines the log sources, giving them a human-friendly name and specifying any log source-specific configuration information.</span></span> <span data-ttu-id="d502e-136">Il primo `<add>` elemento definisce il provider "EventLogProvider", che registra gli eventi di utilizzo di monitoraggio dell'integrità specificato il `EventLogWebEventProvider` classe.</span><span class="sxs-lookup"><span data-stu-id="d502e-136">The first `<add>` element defines the "EventLogProvider" provider, which logs the specified health monitoring events using the `EventLogWebEventProvider` class.</span></span> <span data-ttu-id="d502e-137">Il `EventLogWebEventProvider` classe registra l'evento nel registro eventi di Windows.</span><span class="sxs-lookup"><span data-stu-id="d502e-137">The `EventLogWebEventProvider` class logs the event to the Windows Event Log.</span></span> <span data-ttu-id="d502e-138">La seconda `<add>` elemento definisce il provider "SqlWebEventProvider", che registra gli eventi di un database di Microsoft SQL Server tramite il `SqlWebEventProvider` classe.</span><span class="sxs-lookup"><span data-stu-id="d502e-138">The second `<add>` element defines the "SqlWebEventProvider" provider, which logs events to a Microsoft SQL Server database via the `SqlWebEventProvider` class.</span></span> <span data-ttu-id="d502e-139">La configurazione "SqlWebEventProvider" Specifica la stringa di connessione del database (`connectionStringName`) tra le altre opzioni di configurazione.</span><span class="sxs-lookup"><span data-stu-id="d502e-139">The "SqlWebEventProvider" configuration specifies the database's connection string (`connectionStringName`) among other configuration options.</span></span>

<span data-ttu-id="d502e-140">Il `<rules>` gli eventi specificati nel mapping dell'elemento il `<eventMappings>` elemento per l'accesso origini la `<providers>` elemento.</span><span class="sxs-lookup"><span data-stu-id="d502e-140">The `<rules>` element maps the events specified in the `<eventMappings>` element to log sources in the `<providers>` element.</span></span> <span data-ttu-id="d502e-141">Per impostazione predefinita, le applicazioni web ASP.NET registrare tutte le eccezioni non gestite e controllare gli errori nel registro eventi di Windows.</span><span class="sxs-lookup"><span data-stu-id="d502e-141">By default, ASP.NET web applications log all unhandled exceptions and audit failures to the Windows Event Log.</span></span>

## <a name="logging-events-to-a-database"></a><span data-ttu-id="d502e-142">Eventi di registrazione per un Database</span><span class="sxs-lookup"><span data-stu-id="d502e-142">Logging Events to a Database</span></span>

<span data-ttu-id="d502e-143">Configurazione predefinita del sistema di monitoraggio dell'integrità possono essere personalizzati in base dell'applicazione web dall'applicazione web mediante l'aggiunta di un `<healthMonitoring>` sezione per l'applicazione `Web.config` file.</span><span class="sxs-lookup"><span data-stu-id="d502e-143">The health monitoring system's default configuration can be customized on a web application-by-web application basis by adding a `<healthMonitoring>` section to the application's `Web.config` file.</span></span> <span data-ttu-id="d502e-144">È possibile includere elementi aggiuntivi il `<eventMappings>`, `<providers>`, e `<rules>` sezioni utilizzando la `<add>` elemento.</span><span class="sxs-lookup"><span data-stu-id="d502e-144">You can include additional elements in the `<eventMappings>`, `<providers>`, and `<rules>` sections by using the `<add>` element.</span></span> <span data-ttu-id="d502e-145">Per rimuovere un'impostazione dalla configurazione predefinita, usare il `<remove>` elemento oppure utilizzare `<clear />` per rimuovere tutti i valori predefiniti da una di queste sezioni.</span><span class="sxs-lookup"><span data-stu-id="d502e-145">To remove a setting from the default configuration use the `<remove>` element, or use `<clear />` to remove all default values from one of these sections.</span></span> <span data-ttu-id="d502e-146">È possibile configurare l'applicazione web le recensioni dei libri per registrare le eccezioni non gestite tutte in un database di Microsoft SQL Server usando il `SqlWebEventProvider` classe.</span><span class="sxs-lookup"><span data-stu-id="d502e-146">Let's configure the Book Reviews web application to log all unhandled exceptions to a Microsoft SQL Server database using the `SqlWebEventProvider` class.</span></span>

<span data-ttu-id="d502e-147">Il `SqlWebEventProvider` classe fa parte del sistema di monitoraggio dell'integrità e registra un evento a un database di SQL Server specificato di monitoraggio dello stato.</span><span class="sxs-lookup"><span data-stu-id="d502e-147">The `SqlWebEventProvider` class is part of the health monitoring system and logs a health monitoring event to a specified SQL Server database.</span></span> <span data-ttu-id="d502e-148">Il `SqlWebEventProvider` classe si aspetta che il database specificato include una stored procedure denominata `aspnet_WebEvent_LogEvent`.</span><span class="sxs-lookup"><span data-stu-id="d502e-148">The `SqlWebEventProvider` class expects that the specified database includes a stored procedure named `aspnet_WebEvent_LogEvent`.</span></span> <span data-ttu-id="d502e-149">Questa stored procedure verrà passata i dettagli dell'evento e viene assegnato il compito con l'archiviazione dei dettagli dell'evento.</span><span class="sxs-lookup"><span data-stu-id="d502e-149">This stored procedure is passed the details of the event and is tasked with storing the event details.</span></span> <span data-ttu-id="d502e-150">La buona notizia è che non è necessaria creare questa stored procedure né la tabella per archiviare i dettagli dell'evento.</span><span class="sxs-lookup"><span data-stu-id="d502e-150">The good news is that you do not need to create this stored procedure nor the table to store the event details.</span></span> <span data-ttu-id="d502e-151">È possibile aggiungere questi oggetti al database tramite il `aspnet_regsql.exe` dello strumento.</span><span class="sxs-lookup"><span data-stu-id="d502e-151">You can add these objects to your database using the `aspnet_regsql.exe` tool.</span></span>

> [!NOTE]
> <span data-ttu-id="d502e-152">Il `aspnet_regsql.exe` strumento è stato esaminato nel [ *configurazione di un sito Web che usa servizi delle applicazioni* esercitazione](configuring-a-website-that-uses-application-services-vb.md) quando è stato aggiunto il supporto per ASP. Servizi delle applicazioni di rete.</span><span class="sxs-lookup"><span data-stu-id="d502e-152">The `aspnet_regsql.exe` tool was discussed back in the [*Configuring a Website That Uses Application Services* tutorial](configuring-a-website-that-uses-application-services-vb.md) when we added support for ASP.NET's application services.</span></span> <span data-ttu-id="d502e-153">Di conseguenza, il database del sito Web le recensioni dei libri già contiene il `aspnet_WebEvent_LogEvent` stored procedure, che archivia le informazioni sull'evento in una tabella denominata `aspnet_WebEvent_Events`.</span><span class="sxs-lookup"><span data-stu-id="d502e-153">Consequently, the Book Reviews website's database already contains the `aspnet_WebEvent_LogEvent` stored procedure, which stores the event information into a table named `aspnet_WebEvent_Events`.</span></span>


<span data-ttu-id="d502e-154">Dopo aver creato la stored procedure necessaria e la tabella aggiunta al database, è ora indicare per registrare tutte le eccezioni non gestite nel database di monitoraggio dell'integrità.</span><span class="sxs-lookup"><span data-stu-id="d502e-154">Once you have the necessary stored procedure and table added to your database, all that remains is to instruct health monitoring to log all unhandled exceptions to the database.</span></span> <span data-ttu-id="d502e-155">Eseguire questa operazione aggiungendo il markup seguente nel sito Web `Web.config` file:</span><span class="sxs-lookup"><span data-stu-id="d502e-155">Accomplish this by adding the following markup to your website's `Web.config` file:</span></span>

[!code-xml[Main](logging-error-details-with-asp-net-health-monitoring-vb/samples/sample2.xml)]

<span data-ttu-id="d502e-156">Markup di configurazione precedente Usa di monitoraggio dell'integrità `<clear />` elementi da cancellare le informazioni di configurazione di monitoraggio dell'integrità predefinite di `<eventMappings>`, `<providers>`, e `<rules>` sezioni.</span><span class="sxs-lookup"><span data-stu-id="d502e-156">The health monitoring configuration markup above uses `<clear />` elements to wipe the pre-defined health monitoring configuration information from the `<eventMappings>`, `<providers>`, and `<rules>` sections.</span></span> <span data-ttu-id="d502e-157">Aggiunge quindi una singola voce per ognuna di queste sezioni.</span><span class="sxs-lookup"><span data-stu-id="d502e-157">It then adds a single entry to each of these sections.</span></span>

- <span data-ttu-id="d502e-158">Il `<eventMappings>` elemento definisce un singolo evento di interesse denominato "Tutti gli errori", che viene generato ogni volta che si verifica un'eccezione non gestita di monitoraggio dello stato.</span><span class="sxs-lookup"><span data-stu-id="d502e-158">The `<eventMappings>` element defines a single health monitoring event of interest named "All Errors", which is raised whenever an unhandled exception occurs.</span></span>
- <span data-ttu-id="d502e-159">Il `<providers>` elemento definisce un'origine singola log denominata "SqlWebEventProvider" che usa il `SqlWebEventProvider` classe.</span><span class="sxs-lookup"><span data-stu-id="d502e-159">The `<providers>` element defines a single log source named "SqlWebEventProvider" that uses the `SqlWebEventProvider` class.</span></span> <span data-ttu-id="d502e-160">Il `connectionStringName` attributo è stato impostato su "ReviewsConnectionString", ovvero il nome del nostro connessione definito nella stringa di `<connectionStrings>` sezione.</span><span class="sxs-lookup"><span data-stu-id="d502e-160">The `connectionStringName` attribute has been set to "ReviewsConnectionString", which is the name of our connection string defined in the `<connectionStrings>` section.</span></span>
- <span data-ttu-id="d502e-161">Infine, il &lt;regole&gt; elemento indica che quando un evento di "Tutti gli errori" accade realmente che si devono essere registrato con provider "SqlWebEventProvider".</span><span class="sxs-lookup"><span data-stu-id="d502e-161">Finally, the &lt;rules&gt; element indicates that when an "All Errors" event transpires that it should be logged using the "SqlWebEventProvider" provider.</span></span>

<span data-ttu-id="d502e-162">Le informazioni di configurazione indica l'integrità di sistema per registrare tutte le eccezioni non gestite nel database le recensioni dei libri di monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="d502e-162">This configuration information instructs the health monitoring system to log all unhandled exceptions to the Book Reviews database.</span></span>

> [!NOTE]
> <span data-ttu-id="d502e-163">Il `WebBaseErrorEvent` evento viene generato solo per gli errori del server; non viene generato per gli errori HTTP, ad esempio una richiesta per una risorsa di ASP.NET che non viene trovata.</span><span class="sxs-lookup"><span data-stu-id="d502e-163">The `WebBaseErrorEvent` event is only raised for server errors; it is not raised for HTTP errors, such as a request for an ASP.NET resource that is not found.</span></span> <span data-ttu-id="d502e-164">Questo comportamento è diverso dal comportamento dei `HttpApplication` della classe `Error` evento, che viene generato per il server e gli errori HTTP.</span><span class="sxs-lookup"><span data-stu-id="d502e-164">This differs from the behavior of the `HttpApplication` class's `Error` event, which is raised for both server and HTTP errors.</span></span>


<span data-ttu-id="d502e-165">Per visualizzare l'integrità di sistema nell'azione di monitoraggio, visitare il sito Web e generare un errore di runtime visitando `Genre.aspx?ID=foo`.</span><span class="sxs-lookup"><span data-stu-id="d502e-165">To see the health monitoring system in action, visit the website and generate a runtime error by visiting `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="d502e-166">È consigliabile vedere la pagina di errore appropriato: eccezione dettagli giallo schermata di morte (quando si visita in locale) o la pagina di errore personalizzata (quando si visita il sito nell'ambiente di produzione).</span><span class="sxs-lookup"><span data-stu-id="d502e-166">You should see the appropriate error page - either the Exception Details Yellow Screen of Death (when visiting locally) or the custom error page (when visiting the site in production).</span></span> <span data-ttu-id="d502e-167">Dietro le quinte, sistema di monitoraggio dell'integrità registrate le informazioni sull'errore nel database.</span><span class="sxs-lookup"><span data-stu-id="d502e-167">Behind the scenes, the health monitoring system logged the error information to the database.</span></span> <span data-ttu-id="d502e-168">Deve essere presente un record di `aspnet_WebEvent_Events` tabella (vedere **figura 1**); questo record contiene informazioni sull'errore di runtime che si è verificato.</span><span class="sxs-lookup"><span data-stu-id="d502e-168">There should be one record in the `aspnet_WebEvent_Events` table (see **Figure 1**); this record contains information about the runtime error that just occurred.</span></span>

[![](logging-error-details-with-asp-net-health-monitoring-vb/_static/image2.png)](logging-error-details-with-asp-net-health-monitoring-vb/_static/image1.png)

<span data-ttu-id="d502e-169">**Figura 1**: I dettagli dell'errore sono stati registrati per il `aspnet_WebEvent_Events` tabella</span><span class="sxs-lookup"><span data-stu-id="d502e-169">**Figure 1**: The Error Details Were Logged to the `aspnet_WebEvent_Events` Table</span></span>  
<span data-ttu-id="d502e-170">([Fare clic per visualizzare l'immagine con dimensioni normali](logging-error-details-with-asp-net-health-monitoring-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d502e-170">([Click to view full-size image](logging-error-details-with-asp-net-health-monitoring-vb/_static/image3.png))</span></span>

### <a name="displaying-the-error-log-in-a-web-page"></a><span data-ttu-id="d502e-171">Visualizzare il Log degli errori In una pagina Web</span><span class="sxs-lookup"><span data-stu-id="d502e-171">Displaying the Error Log In a Web Page</span></span>

<span data-ttu-id="d502e-172">Con la configurazione corrente del sito Web, l'integrità di sistema di monitoraggio registra tutte le eccezioni non gestite nel database.</span><span class="sxs-lookup"><span data-stu-id="d502e-172">With the website's current configuration, the health monitoring system logs all unhandled exceptions to the database.</span></span> <span data-ttu-id="d502e-173">Tuttavia, il monitoraggio dello stato non fornisce alcun meccanismo per visualizzare il log degli errori tramite una pagina web.</span><span class="sxs-lookup"><span data-stu-id="d502e-173">However, health monitoring does not provide any mechanism to view the error log through a web page.</span></span> <span data-ttu-id="d502e-174">Tuttavia, è possibile creare una pagina ASP.NET che consente di visualizzare queste informazioni dal database.</span><span class="sxs-lookup"><span data-stu-id="d502e-174">However, you could build an ASP.NET page that displays this information from the database.</span></span> <span data-ttu-id="d502e-175">(Come si vedrà momentaneamente, è possibile scegliere di memorizzare i dettagli dell'errore inviati all'utente un messaggio di posta elettronica.)</span><span class="sxs-lookup"><span data-stu-id="d502e-175">(As we'll see momentarily, you can opt to have the error details sent to you in an email message.)</span></span>

<span data-ttu-id="d502e-176">Se si crea tale pagina, accertarsi di eseguire questa procedura per consentire solo agli utenti autorizzati a visualizzare i dettagli dell'errore.</span><span class="sxs-lookup"><span data-stu-id="d502e-176">If you create such a page, make sure you take steps to allow only authorized users to view the error details.</span></span> <span data-ttu-id="d502e-177">Se il sito Usa già gli account utente è possibile usare regole di autorizzazione URL per limitare l'accesso alla pagina per determinati utenti o ruoli.</span><span class="sxs-lookup"><span data-stu-id="d502e-177">If your site already employs user accounts then you can use URL authorization rules to restrict access to the page to certain users or roles.</span></span> <span data-ttu-id="d502e-178">Per altre informazioni su come concedere o limitare l'accesso alle pagine web basate sull'utente connesso, fare riferimento a mio [sito Web di sicurezza esercitazioni](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="d502e-178">For more information on how to grant or restrict access to web pages based on the logged in user, refer to my [Website Security Tutorials](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>

> [!NOTE]
> <span data-ttu-id="d502e-179">L'esercitazione successiva illustra un sistema di registrazione e la notifica di errore alternativo denominato ELMAH.</span><span class="sxs-lookup"><span data-stu-id="d502e-179">The subsequent tutorial explores an alternative error logging and notification system named ELMAH.</span></span> <span data-ttu-id="d502e-180">ELMAH include un meccanismo predefinito per visualizzare il log degli errori da entrambi una pagina web e come un feed RSS.</span><span class="sxs-lookup"><span data-stu-id="d502e-180">ELMAH includes a built-in mechanism to view the error log from both a web page and as an RSS feed.</span></span>


## <a name="logging-events-to-email"></a><span data-ttu-id="d502e-181">La registrazione di eventi messaggio di posta elettronica</span><span class="sxs-lookup"><span data-stu-id="d502e-181">Logging Events to Email</span></span>

<span data-ttu-id="d502e-182">L'integrità di sistema di monitoraggio include un provider di origine di log che "Registra" un evento di un messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="d502e-182">The health monitoring system includes a log source provider that "logs" an event to an email message.</span></span> <span data-ttu-id="d502e-183">L'origine di log include le stesse informazioni che vengano eseguito l'accesso al database nel corpo del messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="d502e-183">The log source includes the same information that is logged to the database in the email message body.</span></span> <span data-ttu-id="d502e-184">È possibile usare questa origine di log per notificare a uno sviluppatore quando si verifica un determinato evento di monitoraggio dell'integrità.</span><span class="sxs-lookup"><span data-stu-id="d502e-184">You can use this log source to notify a developer when a certain health monitoring event occurs.</span></span>

<span data-ttu-id="d502e-185">È possibile aggiornare la configurazione del sito Web in modo che si riceva un messaggio di posta elettronica ogni volta che un'eccezione si verifica le recensioni dei libri.</span><span class="sxs-lookup"><span data-stu-id="d502e-185">Let's update the Book Reviews website's configuration so that we receive an email whenever an exception occurs.</span></span> <span data-ttu-id="d502e-186">A tale scopo è necessario eseguire tre attività:</span><span class="sxs-lookup"><span data-stu-id="d502e-186">To accomplish this we need to perform three tasks:</span></span>

1. <span data-ttu-id="d502e-187">Configurare l'applicazione web ASP.NET per l'invio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="d502e-187">Configure the ASP.NET web application to send email.</span></span> <span data-ttu-id="d502e-188">Ciò avviene specificando la modalità di invio messaggi di posta elettronica tramite il `<system.net>` elemento di configurazione.</span><span class="sxs-lookup"><span data-stu-id="d502e-188">This is accomplished by specifying how email messages are sent via the `<system.net>` configuration element.</span></span> <span data-ttu-id="d502e-189">Per altre informazioni sull'invio di posta elettronica dei messaggi in un'applicazione ASP.NET si intende [l'invio di posta elettronica in ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx) e il [domande frequenti su System.NET. Mail](http://systemnetmail.com/).</span><span class="sxs-lookup"><span data-stu-id="d502e-189">For more information on sending email messages in an ASP.NET application refer to [Sending Email in ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx) and the [System.Net.Mail FAQ](http://systemnetmail.com/).</span></span>
2. <span data-ttu-id="d502e-190">Registrare il provider di origine di log tramite posta elettronica nel `<providers>` elemento, e</span><span class="sxs-lookup"><span data-stu-id="d502e-190">Register the email log source provider in the `<providers>` element, and</span></span>
3. <span data-ttu-id="d502e-191">Aggiungere una voce per il `<rules>` elemento che viene eseguito il mapping dell'evento di "Tutti gli errori" per il provider di origine di log aggiunto nel passaggio (2).</span><span class="sxs-lookup"><span data-stu-id="d502e-191">Add an entry to the `<rules>` element that maps the "All Errors" event to the log source provider added in step (2).</span></span>

<span data-ttu-id="d502e-192">Sistema di monitoraggio dell'integrità include due classi di provider dell'origine di log tramite posta elettronica: `SimpleMailWebEventProvider` e `TemplatedMailWebEventProvider`.</span><span class="sxs-lookup"><span data-stu-id="d502e-192">The health monitoring system includes two email log source provider classes: `SimpleMailWebEventProvider` and `TemplatedMailWebEventProvider`.</span></span> <span data-ttu-id="d502e-193">Il [ `SimpleMailWebEventProvider` classe](https://msdn.microsoft.com/library/system.web.management.simplemailwebeventprovider.aspx) invia un messaggio di posta elettronica di testo che include l'evento illustra in dettaglio e offre poche operazioni di personalizzazione del corpo del messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="d502e-193">The [`SimpleMailWebEventProvider` class](https://msdn.microsoft.com/library/system.web.management.simplemailwebeventprovider.aspx) sends a plain-text email message that includes the event details and provides little customization of the email body.</span></span> <span data-ttu-id="d502e-194">Con il [ `TemplatedMailWebEventProvider` classe](https://msdn.microsoft.com/library/system.web.management.templatedmailwebeventprovider.aspx) si specifica una pagina ASP.NET cui markup sottoposto a rendering viene utilizzato come il corpo del messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="d502e-194">With the [`TemplatedMailWebEventProvider` class](https://msdn.microsoft.com/library/system.web.management.templatedmailwebeventprovider.aspx) you specify an ASP.NET page whose rendered markup is used as the body for the email message.</span></span> <span data-ttu-id="d502e-195">Il [ `TemplatedMailWebEventProvider` classe](https://msdn.microsoft.com/library/system.web.management.templatedmailwebeventprovider.aspx) offre maggiore controllo sui contenuti e formato di messaggio di posta elettronica, ma richiede maggiore impegno iniziale perché è necessario creare la pagina ASP.NET che genera il corpo del messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="d502e-195">The [`TemplatedMailWebEventProvider` class](https://msdn.microsoft.com/library/system.web.management.templatedmailwebeventprovider.aspx) gives you much greater control over the contents and format of the email message, but requires a bit more upfront work as you have to create the ASP.NET page that generates the email message's body.</span></span> <span data-ttu-id="d502e-196">Questa esercitazione è incentrata sull'uso di `SimpleMailWebEventProvider` classe.</span><span class="sxs-lookup"><span data-stu-id="d502e-196">This tutorial focuses on using the `SimpleMailWebEventProvider` class.</span></span>

<span data-ttu-id="d502e-197">Aggiornamento del sistema di monitoraggio dell'integrità `<providers>` elemento il `Web.config` file da includere un'origine di log per il `SimpleMailWebEventProvider` classe:</span><span class="sxs-lookup"><span data-stu-id="d502e-197">Update the health monitoring system's `<providers>` element in the `Web.config` file to include a log source for the `SimpleMailWebEventProvider` class:</span></span>

[!code-xml[Main](logging-error-details-with-asp-net-health-monitoring-vb/samples/sample3.xml)]

<span data-ttu-id="d502e-198">Il markup riportato sopra Usa la `SimpleMailWebEventProvider` classe come provider di origine di log e le assegna il nome descrittivo "EmailWebEventProvider".</span><span class="sxs-lookup"><span data-stu-id="d502e-198">The above markup uses the `SimpleMailWebEventProvider` class as the log source provider, and assigns it the friendly name "EmailWebEventProvider".</span></span> <span data-ttu-id="d502e-199">Inoltre, il `<add>` attributo include opzioni di configurazione aggiuntive, ad esempio a e dagli indirizzi del messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="d502e-199">Moreover, the `<add>` attribute includes additional configuration options, such as the To and From addresses of the email message.</span></span>

<span data-ttu-id="d502e-200">Con l'origine di log di posta elettronica definito, resta che per indicare l'integrità di sistema per usare questa origine per "registrare" eccezioni non gestite di monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="d502e-200">With the email log source defined, all that remains is to instruct the health monitoring system to use this source to "log" unhandled exceptions.</span></span> <span data-ttu-id="d502e-201">Questa operazione viene eseguita mediante l'aggiunta di una nuova regola nel `<rules>` sezione:</span><span class="sxs-lookup"><span data-stu-id="d502e-201">This is accomplished by adding a new rule in the `<rules>` section:</span></span>

[!code-xml[Main](logging-error-details-with-asp-net-health-monitoring-vb/samples/sample4.xml)]

<span data-ttu-id="d502e-202">Il `<rules>` sezione include ora due regole.</span><span class="sxs-lookup"><span data-stu-id="d502e-202">The `<rules>` section now includes two rules.</span></span> <span data-ttu-id="d502e-203">Il primo webhook denominato "Tutti gli errori per posta elettronica", invia tutte le eccezioni non gestite per l'origine di log "EmailWebEventProvider".</span><span class="sxs-lookup"><span data-stu-id="d502e-203">The first one, named "All Errors To Email", sends all unhandled exceptions to the "EmailWebEventProvider" log source.</span></span> <span data-ttu-id="d502e-204">Questa regola ha l'effetto di inviare i dettagli sugli errori sul sito Web specificato all'indirizzo.</span><span class="sxs-lookup"><span data-stu-id="d502e-204">This rule has the effect of sending details about errors on the website to the specified To address.</span></span> <span data-ttu-id="d502e-205">La regola di "Tutti gli errori al Database" Registra i dettagli dell'errore per il database del sito.</span><span class="sxs-lookup"><span data-stu-id="d502e-205">The "All Errors To Database" rule logs the error details to the site's database.</span></span> <span data-ttu-id="d502e-206">Di conseguenza, ogni volta che si verifica un'eccezione non gestita nel sito i dettagli sono entrambi connessi al database e inviati all'indirizzo di posta elettronica specificato.</span><span class="sxs-lookup"><span data-stu-id="d502e-206">Consequently, whenever an unhandled exception occurs on the site its details are both logged to the database and sent to specified email address.</span></span>

<span data-ttu-id="d502e-207">**Figura 2** Mostra il messaggio di posta elettronica generato dal `SimpleMailWebEventProvider` classe quando si visita `Genre.aspx?ID=foo`.</span><span class="sxs-lookup"><span data-stu-id="d502e-207">**Figure 2** shows the email generated by the `SimpleMailWebEventProvider` class when visiting `Genre.aspx?ID=foo`.</span></span>

[![](logging-error-details-with-asp-net-health-monitoring-vb/_static/image5.png)](logging-error-details-with-asp-net-health-monitoring-vb/_static/image4.png)

<span data-ttu-id="d502e-208">**Figura 2**: I dettagli dell'errore vengono inviati in un messaggio di posta elettronica</span><span class="sxs-lookup"><span data-stu-id="d502e-208">**Figure 2**: The Error Details are Sent in an Email Message</span></span>  
<span data-ttu-id="d502e-209">([Fare clic per visualizzare l'immagine con dimensioni normali](logging-error-details-with-asp-net-health-monitoring-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d502e-209">([Click to view full-size image](logging-error-details-with-asp-net-health-monitoring-vb/_static/image6.png))</span></span>

## <a name="summary"></a><span data-ttu-id="d502e-210">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="d502e-210">Summary</span></span>

<span data-ttu-id="d502e-211">Il sistema di monitoraggio dell'integrità ASP.NET è progettato per consentire agli amministratori di monitorare l'integrità di un'applicazione web distribuita.</span><span class="sxs-lookup"><span data-stu-id="d502e-211">The ASP.NET health monitoring system is designed to allow administrators to monitor the health of a deployed web application.</span></span> <span data-ttu-id="d502e-212">Espandi determinate azioni, ad esempio quando si arresta l'applicazione, quando un utente accede correttamente al sito, oppure se si verifica un'eccezione non gestita, vengono generati eventi di monitoraggio dell'integrità.</span><span class="sxs-lookup"><span data-stu-id="d502e-212">Health monitoring events are raised when certain actions unfold, such as when the application stops, when a user successfully logs onto the site, or when an unhandled exception occurs.</span></span> <span data-ttu-id="d502e-213">Questi eventi possono essere registrati in un numero qualsiasi di origini di log.</span><span class="sxs-lookup"><span data-stu-id="d502e-213">These events can be logged to any number of log sources.</span></span> <span data-ttu-id="d502e-214">Questa esercitazione ha illustrato come registrare i dettagli delle eccezioni non gestite in un database e tramite un messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="d502e-214">This tutorial showed how to log the details of unhandled exceptions to a database and through an email message.</span></span>

<span data-ttu-id="d502e-215">Questa esercitazione è incentrato sull'uso per registrare le eccezioni non gestite, ma tenere presente che il monitoraggio dell'integrità è quello di misurare l'integrità complessiva di un'applicazione ASP.NET distribuita e include un'ampia gamma di eventi di monitoraggio dell'integrità e del log non origini di monitoraggio dell'integrità sono stati illustrati di seguito.</span><span class="sxs-lookup"><span data-stu-id="d502e-215">This tutorial focused on using health monitoring to log unhandled exceptions, but keep in mind that health monitoring is designed to measure the overall health of a deployed ASP.NET application and includes a wealth of health monitoring events and log sources not explored here.</span></span> <span data-ttu-id="d502e-216">Inoltre, è possibile creare il proprio monitoraggio origini log ed eventi dello stato in caso di necessità si verificano.</span><span class="sxs-lookup"><span data-stu-id="d502e-216">What's more, you can create your own health monitoring events and log sources, should the need arise.</span></span> <span data-ttu-id="d502e-217">Se è interessati a ottenere ulteriori informazioni su monitoraggio dell'integrità, un buon primo passo è leggere con attenzione [Erik Reitan](https://blogs.msdn.com/erikreitan/archive/2006/05/22/603586.aspx)del [domande frequenti sul monitoraggio dell'integrità](https://blogs.msdn.com/erikreitan/archive/2006/05/22/603586.aspx).</span><span class="sxs-lookup"><span data-stu-id="d502e-217">If you are interested in learning more about health monitoring, a good first step is to read through [Erik Reitan](https://blogs.msdn.com/erikreitan/archive/2006/05/22/603586.aspx)'s [health monitoring FAQ](https://blogs.msdn.com/erikreitan/archive/2006/05/22/603586.aspx).</span></span> <span data-ttu-id="d502e-218">In seguito, consultare [How To: Usare il monitoraggio dello stato in ASP.NET 2.0](https://msdn.microsoft.com/library/ms998306.aspx).</span><span class="sxs-lookup"><span data-stu-id="d502e-218">Following that, consult [How To: Use Health Monitoring in ASP.NET 2.0](https://msdn.microsoft.com/library/ms998306.aspx).</span></span>

<span data-ttu-id="d502e-219">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="d502e-219">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="d502e-220">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="d502e-220">Further Reading</span></span>

<span data-ttu-id="d502e-221">Per altre informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="d502e-221">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="d502e-222">Panoramica di monitoraggio dell'integrità di ASP.NET</span><span class="sxs-lookup"><span data-stu-id="d502e-222">ASP.NET Health Monitoring Overview</span></span>](https://msdn.microsoft.com/library/bb398933.aspx)
- [<span data-ttu-id="d502e-223">Configurazione e la personalizzazione del sistema di ASP.NET di monitoraggio dell'integrità</span><span class="sxs-lookup"><span data-stu-id="d502e-223">Configuring and Customizing the Health Monitoring System of ASP.NET</span></span>](http://dotnetslackers.com/articles/aspnet/ConfiguringAndCustomizingTheHealthMonitoringSystemOfASPNET.aspx)
- [<span data-ttu-id="d502e-224">Domande frequenti - monitoraggio dell'integrità in ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="d502e-224">FAQ - Health Monitoring in ASP.NET 2.0</span></span>](https://blogs.msdn.com/erikreitan/archive/2006/05/22/603586.aspx)
- [<span data-ttu-id="d502e-225">Procedura: Invia messaggio di posta elettronica per le notifiche di monitoraggio dell'integrità</span><span class="sxs-lookup"><span data-stu-id="d502e-225">How To: Send E-Mail for Health Monitoring Notifications</span></span>](https://msdn.microsoft.com/library/ms227553.aspx)
- [<span data-ttu-id="d502e-226">Procedura: Usare il monitoraggio dell'integrità in ASP.NET</span><span class="sxs-lookup"><span data-stu-id="d502e-226">How To: Use Health Monitoring in ASP.NET</span></span>](https://msdn.microsoft.com/library/ms998306.aspx)
- [<span data-ttu-id="d502e-227">Monitoraggio dell'integrità in ASP.NET</span><span class="sxs-lookup"><span data-stu-id="d502e-227">Health Monitoring in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/031407-1.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="d502e-228">[Precedente](processing-unhandled-exceptions-vb.md)
> [Successivo](logging-error-details-with-elmah-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d502e-228">[Previous](processing-unhandled-exceptions-vb.md)
[Next](logging-error-details-with-elmah-vb.md)</span></span>
