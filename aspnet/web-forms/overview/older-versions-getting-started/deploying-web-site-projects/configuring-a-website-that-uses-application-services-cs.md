---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-a-website-that-uses-application-services-cs
title: Configurazione di un sito Web che usaC#servizi per le applicazioni () | Microsoft Docs
author: rick-anderson
description: Con la versione 2,0 di ASP.NET è stata introdotta una serie di servizi applicativi, che fanno parte del .NET Framework e vengono usati come una suite di servizi di blocco costitutivi.
ms.author: riande
ms.date: 04/23/2009
ms.assetid: 1e33d1c6-3f9f-4c26-81e2-2a8f8907bb05
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-a-website-that-uses-application-services-cs
msc.type: authoredcontent
ms.openlocfilehash: 72aaca84b8c8d6e558d4c946faa57fa999d48bf8
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78630578"
---
# <a name="configuring-a-website-that-uses-application-services-c"></a><span data-ttu-id="f2ff1-103">Configurazione di un sito Web che usa i servizi per le applicazioni (C#)</span><span class="sxs-lookup"><span data-stu-id="f2ff1-103">Configuring a Website that Uses Application Services (C#)</span></span>

<span data-ttu-id="f2ff1-104">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f2ff1-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f2ff1-105">[Scarica codice](https://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_09_CS.zip) o [Scarica PDF](https://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial09_AppServicesConfig_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="f2ff1-105">[Download Code](https://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_09_CS.zip) or [Download PDF](https://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial09_AppServicesConfig_cs.pdf)</span></span>

> <span data-ttu-id="f2ff1-106">Con la versione 2,0 di ASP.NET è stata introdotta una serie di servizi applicativi, che fanno parte del .NET Framework e vengono usati come una suite di servizi di blocco predefiniti che è possibile usare per aggiungere funzionalità avanzate all'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-106">ASP.NET version 2.0 introduced a series of application services, which are part of the .NET Framework and serve as a suite of building block services that you can use to add rich functionality to your web application.</span></span> <span data-ttu-id="f2ff1-107">Questa esercitazione illustra come configurare un sito Web nell'ambiente di produzione per usare i servizi dell'applicazione e risolve i problemi comuni relativi alla gestione di account utente e ruoli nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-107">This tutorial explores how to configure a website in the production environment to use application services and addresses common issues with managing user accounts and roles on the production environment.</span></span>

## <a name="introduction"></a><span data-ttu-id="f2ff1-108">Introduzione</span><span class="sxs-lookup"><span data-stu-id="f2ff1-108">Introduction</span></span>

<span data-ttu-id="f2ff1-109">Con la versione 2,0 di ASP.NET è stata introdotta una serie di *servizi applicativi*, che fanno parte del .NET Framework e vengono usati come una suite di servizi di blocco predefiniti che è possibile usare per aggiungere funzionalità avanzate all'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-109">ASP.NET version 2.0 introduced a series of *application services*, which are part of the .NET Framework and serve as a suite of building block services that you can use to add rich functionality to your web application.</span></span> <span data-ttu-id="f2ff1-110">I servizi dell'applicazione includono:</span><span class="sxs-lookup"><span data-stu-id="f2ff1-110">The application services include:</span></span>

- <span data-ttu-id="f2ff1-111">**Appartenenza** : un'API per la creazione e la gestione degli account utente.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-111">**Membership** - an API for creating and managing user accounts.</span></span>
- <span data-ttu-id="f2ff1-112">**Roles** : un'API per la categorizzazione degli utenti in gruppi.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-112">**Roles** - an API for categorizing users into groups.</span></span>
- <span data-ttu-id="f2ff1-113">**Profile** : un'API per l'archiviazione di contenuto personalizzato specifico dell'utente.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-113">**Profile** - an API for storing custom, user-specific content.</span></span>
- <span data-ttu-id="f2ff1-114">**Mappa del sito** : un'API per la definizione di una struttura logica del sito sotto forma di gerarchia, che può essere visualizzata tramite controlli di navigazione, ad esempio menu e percorsi di navigazione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-114">**Site Map** - an API for defining a site s logical structure in the form of a hierarchy, which can then be displayed via navigation controls, such as menus and breadcrumbs.</span></span>
- <span data-ttu-id="f2ff1-115">**Personalizzazione** : un'API per la gestione delle preferenze di personalizzazione, usata più spesso con [*WebParts*](https://msdn.microsoft.com/library/e0s9t4ck.aspx).</span><span class="sxs-lookup"><span data-stu-id="f2ff1-115">**Personalization** - an API for maintaining customization preferences, most often used with [*WebParts*](https://msdn.microsoft.com/library/e0s9t4ck.aspx).</span></span>
- <span data-ttu-id="f2ff1-116">**Monitoraggio dello stato** : un'API per il monitoraggio delle prestazioni, della sicurezza, degli errori e di altre metriche di integrità del sistema per un'applicazione Web in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-116">**Health Monitoring** - an API for monitoring performance, security, errors, and other system health metrics for a running web application.</span></span>

<span data-ttu-id="f2ff1-117">Le API dei servizi dell'applicazione non sono associate a un'implementazione specifica.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-117">The application services APIs are not tied to a specific implementation.</span></span> <span data-ttu-id="f2ff1-118">Al contrario, si indica ai servizi dell'applicazione di utilizzare un determinato *provider*e tale provider implementa il servizio utilizzando una tecnologia particolare.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-118">Instead, you instruct the application services to use a particular *provider*, and that provider implements the service using a particular technology.</span></span> <span data-ttu-id="f2ff1-119">I provider usati più di frequente per le applicazioni Web basate su Internet ospitate in una società di hosting Web sono i provider che usano un'implementazione di database SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-119">The most commonly used providers for Internet-based web applications hosted at a web hosting company are those providers that use a SQL Server database implementation.</span></span> <span data-ttu-id="f2ff1-120">Ad esempio, il `SqlMembershipProvider` è un provider per l'API di appartenenza che archivia le informazioni sull'account utente in un database Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-120">For example, the `SqlMembershipProvider` is a provider for the Membership API that stores user account information in a Microsoft SQL Server database.</span></span>

<span data-ttu-id="f2ff1-121">Quando si distribuisce l'applicazione, l'utilizzo dei servizi dell'applicazione e dei provider di SQL Server comporta problemi.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-121">Using the application services and SQL Server providers adds some challenges when deploying the application.</span></span> <span data-ttu-id="f2ff1-122">Per i principianti, gli oggetti di database dei servizi dell'applicazione devono essere creati correttamente nei database di sviluppo e di produzione e inizializzati in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-122">For starters, the application services database objects must be properly created on both the development and production databases and appropriately initialized.</span></span> <span data-ttu-id="f2ff1-123">Sono inoltre importanti le impostazioni di configurazione che devono essere eseguite.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-123">There are also important configuration settings that need to be made.</span></span>

> [!NOTE]
> <span data-ttu-id="f2ff1-124">Le API dei servizi delle applicazioni sono state progettate usando il [*modello di provider*](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), uno schema progettuale che consente di fornire i dettagli dell'implementazione di un'API in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-124">The application services APIs were designed using the [*provider model*](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), a design pattern that allows for an API s implementation details to be provided at runtime.</span></span> <span data-ttu-id="f2ff1-125">Il .NET Framework viene fornito con un numero di provider di servizi dell'applicazione che è possibile usare, ad esempio i `SqlMembershipProvider` e `SqlRoleProvider`, ovvero i provider per le API di appartenenza e ruoli che usano un'implementazione di database SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-125">The .NET Framework ships with a number of application service providers that can be used, such as the `SqlMembershipProvider` and `SqlRoleProvider`, which are providers for the Membership and Roles APIs that use a SQL Server database implementation.</span></span> <span data-ttu-id="f2ff1-126">È anche possibile creare e collegare un provider personalizzato.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-126">You can also create and plug-in a custom provider.</span></span> <span data-ttu-id="f2ff1-127">Infatti, l'applicazione Web di revisione del libro contiene già un provider personalizzato per l'API della mappa del sito (`ReviewSiteMapProvider`), che costruisce la mappa del sito dai dati nelle tabelle `Genres` e `Books` nel database.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-127">In fact, the Book Reviews web application already contains a custom provider for the Site Map API (`ReviewSiteMapProvider`), which constructs the site map from the data in the `Genres` and `Books` tables in the database.</span></span>

<span data-ttu-id="f2ff1-128">Questa esercitazione inizia con un'analisi della modalità di estensione dell'applicazione Web revisioni del libro per l'uso delle API di appartenenza e dei ruoli.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-128">This tutorial starts with a look at how I extended the Book Reviews web application to use the Membership and Roles APIs.</span></span> <span data-ttu-id="f2ff1-129">Viene quindi illustrata la distribuzione di un'applicazione Web che utilizza i servizi delle applicazioni con un'implementazione di database SQL Server e si conclude risolvendo i problemi comuni relativi alla gestione degli account utente e dei ruoli nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-129">It then walks through deploying a web application that uses application services with a SQL Server database implementation, and concludes by addressing common issues with managing user accounts and roles on the production environment.</span></span>

## <a name="updates-to-the-book-reviews-application"></a><span data-ttu-id="f2ff1-130">Aggiornamenti all'applicazione Book revisioni</span><span class="sxs-lookup"><span data-stu-id="f2ff1-130">Updates to the Book Reviews Application</span></span>

<span data-ttu-id="f2ff1-131">Negli ultimi due esercitazioni l'applicazione Web revisioni del libro è stata aggiornata da un sito Web statico a un'applicazione Web dinamica basata sui dati completa con un set di pagine di amministrazione per la gestione di generi e revisioni.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-131">Over the past couple tutorials the Book Reviews web application was updated from a static website to a dynamic, data-driven web application complete with a set of administration pages for managing genres and reviews.</span></span> <span data-ttu-id="f2ff1-132">Tuttavia, questa sezione di amministrazione non è attualmente protetta, ovvero qualsiasi utente che conosce (o indovina) l'URL della pagina di amministrazione può entrare in valzer e creare, modificare o eliminare recensioni nel sito.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-132">However, this administration section is currently not protected - any user who knows (or guesses) the administration page URL can waltz in and create, edit, or delete reviews on our site.</span></span> <span data-ttu-id="f2ff1-133">Un modo comune per proteggere determinate parti di un sito Web consiste nell'implementare gli account utente e quindi utilizzare le regole di autorizzazione URL per limitare l'accesso a determinati utenti o ruoli.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-133">A common way to protect certain portions of a website is to implement user accounts and then use URL authorization rules to restrict access to certain users or roles.</span></span> <span data-ttu-id="f2ff1-134">L'applicazione Web Book revisioni disponibile per il download in questa esercitazione supporta account utente e ruoli.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-134">The Book Reviews web application available for download with this tutorial supports user accounts and roles.</span></span> <span data-ttu-id="f2ff1-135">Dispone di un singolo ruolo definito amministratore e solo gli utenti con questo ruolo possono accedere alle pagine di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-135">It has a single role defined named Admin and only users in this role can access the administration pages.</span></span>

> [!NOTE]
> <span data-ttu-id="f2ff1-136">Ho creato tre account utente in Book revisioni applicazione Web: Scott, Jisun e Alice.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-136">I ve created three user accounts in the Book Reviews web application: Scott, Jisun, and Alice.</span></span> <span data-ttu-id="f2ff1-137">Tutti e tre gli utenti hanno la stessa password: **password.**</span><span class="sxs-lookup"><span data-stu-id="f2ff1-137">All three users have the same password: **password!**</span></span> <span data-ttu-id="f2ff1-138">Scott e Jisun sono nel ruolo di amministratore. Alice non lo è.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-138">Scott and Jisun are in the Admin role, Alice is not.</span></span> <span data-ttu-id="f2ff1-139">Le pagine non di amministrazione del sito sono ancora accessibili agli utenti anonimi.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-139">The site s non-administration pages are still accessible to anonymous users.</span></span> <span data-ttu-id="f2ff1-140">Ovvero, non è necessario eseguire l'accesso per visitare il sito, a meno che non si desideri amministrarlo, nel qual caso è necessario accedere come utente con il ruolo di amministratore.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-140">That is, you do not need to sign in to visit the site, unless you want to administer it, in which case you must sign in as a user in the Admin role.</span></span>

<span data-ttu-id="f2ff1-141">La pagina master dell'applicazione revisione libri è stata aggiornata in modo da includere un'interfaccia utente diversa per utenti autenticati e anonimi.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-141">The Book Reviews application s master page has been updated to include a different user interface for authenticated and anonymous users.</span></span> <span data-ttu-id="f2ff1-142">Se un utente anonimo visita il sito, viene visualizzato un collegamento di accesso nell'angolo superiore destro.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-142">If an anonymous user visits the site she sees a Login link in the upper right corner.</span></span> <span data-ttu-id="f2ff1-143">Un utente autenticato Visualizza il messaggio "Welcome back, *username*!"</span><span class="sxs-lookup"><span data-stu-id="f2ff1-143">An authenticated user sees the message, "Welcome back, *username*!"</span></span> <span data-ttu-id="f2ff1-144">e un collegamento per la disconnessione. C'è anche una pagina di accesso (`~/Login.aspx`), che contiene un controllo Web di accesso che fornisce l'interfaccia utente e la logica per l'autenticazione di un visitatore.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-144">and a link to log out. There s also a login page (`~/Login.aspx`), which contains a Login Web control that provides the user interface and logic for authenticating a visitor.</span></span> <span data-ttu-id="f2ff1-145">Solo gli amministratori possono creare nuovi account.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-145">Only administrators can create new accounts.</span></span> <span data-ttu-id="f2ff1-146">Sono disponibili pagine per la creazione e la gestione degli account utente nella cartella `~/Admin`.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-146">(There are pages for creating and managing user accounts in the `~/Admin` folder.)</span></span>

### <a name="configuring-the-membership-and-roles-apis"></a><span data-ttu-id="f2ff1-147">Configurazione delle API di appartenenza e dei ruoli</span><span class="sxs-lookup"><span data-stu-id="f2ff1-147">Configuring the Membership and Roles APIs</span></span>

<span data-ttu-id="f2ff1-148">L'applicazione Web Book revisioni usa le API di appartenenza e dei ruoli per supportare gli account utente e per raggruppare tali utenti in ruoli (ovvero il ruolo di amministratore).</span><span class="sxs-lookup"><span data-stu-id="f2ff1-148">The Book Reviews web application uses the Membership and Roles APIs to support user accounts and to group those users into roles (namely, the Admin role).</span></span> <span data-ttu-id="f2ff1-149">Vengono utilizzate le classi del provider `SqlMembershipProvider` e `SqlRoleProvider` perché si desidera archiviare le informazioni sull'account e sui ruoli in un database SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-149">The `SqlMembershipProvider` and `SqlRoleProvider` provider classes are used because we want to store account and role information in a SQL Server database.</span></span>

> [!NOTE]
> <span data-ttu-id="f2ff1-150">Questa esercitazione non è destinata a un esame dettagliato della configurazione di un'applicazione Web per supportare le API di appartenenza e dei ruoli.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-150">This tutorial is not intended to be a detailed examination at configuring a web application to support the Membership and Roles APIs.</span></span> <span data-ttu-id="f2ff1-151">Per informazioni dettagliate su queste API e sui passaggi da eseguire per configurare un sito Web per l'uso, vedere le [*esercitazioni sulla sicurezza del sito Web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="f2ff1-151">For a thorough look at these APIs and the steps you need to take to configure a website to use them, please read my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>

<span data-ttu-id="f2ff1-152">Per usare i servizi dell'applicazione con un database di SQL Server, è innanzitutto necessario aggiungere al database gli oggetti di database usati da tali provider per il database in cui si desidera archiviare le informazioni relative all'account utente e al ruolo.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-152">To use the application services with a SQL Server database you must first add the database objects used by these providers to the database where you want the user account and role information stored.</span></span> <span data-ttu-id="f2ff1-153">Questi oggetti di database necessari includono un'ampia gamma di tabelle, viste e stored procedure.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-153">These requisite database objects include a variety of tables, views, and stored procedures.</span></span> <span data-ttu-id="f2ff1-154">Se non specificato diversamente, le classi del provider `SqlMembershipProvider` e `SqlRoleProvider` utilizzano un database SQL Server Express Edition denominato `ASPNETDB` che si trova nella cartella `App_Data` dell'applicazione; Se tale database non esiste, viene creato automaticamente con gli oggetti di database necessari da tali provider in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-154">Unless specified otherwise, the `SqlMembershipProvider` and `SqlRoleProvider` provider classes use a SQL Server Express Edition database named `ASPNETDB` located in the application s `App_Data` folder; if such a database does not exist, it is automatically created with the necessary database objects by these providers at runtime.</span></span>

<span data-ttu-id="f2ff1-155">È possibile, e in genere ideale, creare gli oggetti di database dei servizi dell'applicazione nello stesso database in cui sono archiviati i dati specifici dell'applicazione del sito Web.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-155">It is possible, and usually ideal, to create the application services database objects in the same database where the website s application-specific data is stored.</span></span> <span data-ttu-id="f2ff1-156">Il .NET Framework viene fornito con uno strumento denominato `aspnet_regsql.exe` che consente di installare gli oggetti di database in un database specificato.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-156">The .NET Framework ships with a tool named `aspnet_regsql.exe` that installs the database objects on a specified database.</span></span> <span data-ttu-id="f2ff1-157">Ho utilizzato questo strumento per aggiungere questi oggetti al database `Reviews.mdf` nella cartella `App_Data` (database di sviluppo).</span><span class="sxs-lookup"><span data-stu-id="f2ff1-157">I have gone ahead and used this tool to add these objects to the `Reviews.mdf` database in the `App_Data` folder (the development database).</span></span> <span data-ttu-id="f2ff1-158">Si vedrà come usare questo strumento più avanti in questa esercitazione quando si aggiungono questi oggetti al database di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-158">We'll see how to use this tool later in this tutorial when we add these objects to the production database.</span></span>

<span data-ttu-id="f2ff1-159">Se si aggiungono gli oggetti di database dei servizi dell'applicazione a un database diverso da `ASPNETDB` sarà necessario personalizzare le configurazioni delle classi provider `SqlMembershipProvider` e `SqlRoleProvider` in modo che usino il database appropriato.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-159">If you add the application services database objects to a database other than `ASPNETDB` you will need to customize the `SqlMembershipProvider` and `SqlRoleProvider` provider classes configurations so that they use the appropriate database.</span></span> <span data-ttu-id="f2ff1-160">Per personalizzare il provider di appartenenze, aggiungere un [ *&lt;elemento&gt; appartenenza*](https://msdn.microsoft.com/library/1b9hw62f.aspx) all'interno della sezione `<system.web>` in `Web.config`; utilizzare l' [*elemento&lt;roleManager&gt;* ](https://msdn.microsoft.com/library/ms164660.aspx) per configurare il provider di ruoli.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-160">To customize the Membership provider add a [*&lt;membership&gt; element*](https://msdn.microsoft.com/library/1b9hw62f.aspx) within the `<system.web>` section in `Web.config`; use the [*&lt;roleManager&gt; element*](https://msdn.microsoft.com/library/ms164660.aspx) to configure the Roles provider.</span></span> <span data-ttu-id="f2ff1-161">Il frammento di codice seguente è tratto dal libro revisioni dell'applicazione `Web.config` e Mostra le impostazioni di configurazione per le API appartenenza e ruoli.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-161">The following snippet is taken from the Book Reviews application s `Web.config` and shows the configure settings for the Membership and Roles APIs.</span></span> <span data-ttu-id="f2ff1-162">Si noti che entrambi registrano un nuovo provider-`ReviewMembership` e `ReviewRole` che usano rispettivamente i provider `SqlMembershipProvider` e `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-162">Note that both register a new provider - `ReviewMembership` and `ReviewRole` - that use the `SqlMembershipProvider` and `SqlRoleProvider` providers, respectively.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample1.xml)]

<span data-ttu-id="f2ff1-163">Per supportare l'autenticazione basata su form è stato inoltre configurato l'elemento `<authentication>` di `Web.config` file.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-163">The `Web.config` file s `<authentication>` element has also been configured to support forms-based authentication.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample2.xml)]

### <a name="limiting-access-to-the-administration-pages"></a><span data-ttu-id="f2ff1-164">Limitazione dell'accesso alle pagine di amministrazione</span><span class="sxs-lookup"><span data-stu-id="f2ff1-164">Limiting Access to the Administration Pages</span></span>

<span data-ttu-id="f2ff1-165">ASP.NET consente di concedere o negare l'accesso a un file o a una cartella specifica in base all'utente o al ruolo tramite la relativa funzionalità di *autorizzazione URL* .</span><span class="sxs-lookup"><span data-stu-id="f2ff1-165">ASP.NET makes it easy to grant or deny access to a particular file or folder by user or by role via its *URL authorization* feature.</span></span> <span data-ttu-id="f2ff1-166">(Si è brevemente discusso l'autorizzazione dell'URL nelle *differenze principali tra IIS e l'esercitazione server di sviluppo ASP.NET* e viene illustrato come IIS e il server di sviluppo ASP.NET applicano le regole di autorizzazione URL in modo diverso per il contenuto statico e dinamico.) Poiché si vuole impedire l'accesso alla cartella `~/Admin` ad eccezione degli utenti nel ruolo di amministratore, è necessario aggiungere regole di autorizzazione URL a questa cartella.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-166">(We briefly discussed URL authorization in the *Core Differences Between IIS and the ASP.NET Development Server* tutorial and showed how IIS and the ASP.NET Development Server apply URL authorization rules differently for static versus dynamic content.) Because we want to prohibit access to the `~/Admin` folder except for those users in the Admin role, we need to add URL authorization rules to this folder.</span></span> <span data-ttu-id="f2ff1-167">In particolare, le regole di autorizzazione dell'URL devono consentire agli utenti con il ruolo di amministratore di negare l'accesso a tutti gli altri utenti.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-167">Specifically, the URL authorization rules need to allow users in the Admin role and deny all other users.</span></span> <span data-ttu-id="f2ff1-168">Questa operazione viene eseguita aggiungendo un file di `Web.config` alla cartella `~/Admin` con il contenuto seguente:</span><span class="sxs-lookup"><span data-stu-id="f2ff1-168">This is accomplished by adding a `Web.config` file to the `~/Admin` folder with the following contents:</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample3.xml)]

<span data-ttu-id="f2ff1-169">Per altre informazioni sulla funzionalità di autorizzazione URL di ASP.NET e su come usarla per definire le regole di autorizzazione per gli utenti e per i ruoli, assicurarsi di leggere le esercitazioni sull'autorizzazione [*basata sull'utente*](../../older-versions-security/membership/user-based-authorization-cs.md) e [*sulle autorizzazioni basate sui*](../../older-versions-security/roles/role-based-authorization-cs.md) ruoli dalle [*esercitazioni sulla sicurezza del sito Web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="f2ff1-169">For more information on ASP.NET s URL authorization feature and how to use it to spell out authorization rules for users and for roles, be sure to read the [*User-Based Authorization*](../../older-versions-security/membership/user-based-authorization-cs.md) and [*Role-Based Authorization*](../../older-versions-security/roles/role-based-authorization-cs.md) tutorials from my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>

## <a name="deploying-a-web-application-that-uses-application-services"></a><span data-ttu-id="f2ff1-170">Distribuzione di un'applicazione Web che utilizza Servizi per le applicazioni</span><span class="sxs-lookup"><span data-stu-id="f2ff1-170">Deploying a Web Application That Uses Application Services</span></span>

<span data-ttu-id="f2ff1-171">Quando si distribuisce un sito Web che usa i servizi delle applicazioni e un provider che archivia le informazioni dei servizi dell'applicazione in un database, è fondamentale che gli oggetti di database necessari per i servizi dell'applicazione vengano creati nel database di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-171">When deploying a website that uses application services and a provider that stores the application services information in a database, it is imperative that the database objects needed by the application services be created on the production database.</span></span> <span data-ttu-id="f2ff1-172">Inizialmente il database di produzione non contiene questi oggetti, pertanto quando l'applicazione viene distribuita per la prima volta (o quando viene distribuita per la prima volta dopo l'aggiunta dei servizi dell'applicazione), è necessario eseguire passaggi aggiuntivi per ottenere questi oggetti di database necessari nel database di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-172">Initially the production database does not contain these objects, so when the application is first deployed (or when it is deployed for the first time after application services have been added), you must take extra steps to get these requisite database objects on the production database.</span></span>

<span data-ttu-id="f2ff1-173">È possibile che si verifichi un'altra sfida quando si distribuisce un sito Web che usa i servizi delle applicazioni se si intende replicare gli account utente creati nell'ambiente di sviluppo nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-173">Another challenge can arise when deploying a website that uses application services if you intend to replicate the user accounts created in the development environment to the production environment.</span></span> <span data-ttu-id="f2ff1-174">A seconda della configurazione di appartenenza e ruoli, è possibile che anche se si copiano correttamente gli account utente creati nell'ambiente di sviluppo nel database di produzione, questi utenti non possono accedere all'applicazione Web in produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-174">Depending on the Membership and Roles configuration, it is possible that even if you successfully copy the user accounts that were created in the development environment to the production database, these users cannot sign into the web application in production.</span></span> <span data-ttu-id="f2ff1-175">Si esaminerà la causa del problema e verrà illustrato come impedire che si verifichi.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-175">We'll look at the cause of this issue and discuss how to prevent it from happening.</span></span>

<span data-ttu-id="f2ff1-176">ASP.NET viene fornito con un simpatico [*strumento di amministrazione di siti Web (WSAT)* ](https://msdn.microsoft.com/library/yy40ytx0.aspx) che può essere avviato da Visual Studio e consente di gestire l'account utente, i ruoli e le regole di autorizzazione tramite un'interfaccia basata sul Web.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-176">ASP.NET ships with a nice [*Web Site Administration Tool (WSAT)*](https://msdn.microsoft.com/library/yy40ytx0.aspx) that can be launched from Visual Studio and allows the user account, roles, and authorization rules to be managed through a web-based interface.</span></span> <span data-ttu-id="f2ff1-177">Sfortunatamente, il WSAT funziona solo per i siti Web locali, ovvero non può essere usato per gestire in remoto gli account utente, i ruoli e le regole di autorizzazione per l'applicazione Web nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-177">Unfortunately, the WSAT only works for local websites, meaning that it cannot be used to remotely manage user accounts, roles, and authorization rules for the web application in the production environment.</span></span> <span data-ttu-id="f2ff1-178">Si esamineranno diversi modi per implementare il comportamento di tipo WSAT dal sito Web di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-178">We'll look at different ways to implement WSAT-like behavior from your production website.</span></span>

### <a name="adding-the-database-objects-using-aspnet_regsqlexe"></a><span data-ttu-id="f2ff1-179">Aggiunta di oggetti di database tramite ASPNET\_RegSql. exe</span><span class="sxs-lookup"><span data-stu-id="f2ff1-179">Adding the Database Objects Using aspnet\_regsql.exe</span></span>

<span data-ttu-id="f2ff1-180">Nell'esercitazione sulla *distribuzione di un database* è stato illustrato come copiare le tabelle e i dati dal database di sviluppo al database di produzione. queste tecniche possono certamente essere utilizzate per copiare gli oggetti di database dei servizi dell'applicazione nel database di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-180">The *Deploying a Database* tutorial showed how to copy the tables and data from the development database to the production database, and these techniques can certainly be used to copy the application services database objects to the production database.</span></span> <span data-ttu-id="f2ff1-181">Un'altra opzione è lo strumento `aspnet_regsql.exe`, che aggiunge o rimuove gli oggetti di database dei servizi dell'applicazione da un database.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-181">Another option is the `aspnet_regsql.exe` tool, which adds or removes the application services database objects from a database.</span></span>

> [!NOTE]
> <span data-ttu-id="f2ff1-182">Lo strumento `aspnet_regsql.exe` crea gli oggetti di database in un database specificato.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-182">The `aspnet_regsql.exe` tool creates the database objects on a specified database.</span></span> <span data-ttu-id="f2ff1-183">Non esegue la migrazione dei dati in tali oggetti di database dal database di sviluppo al database di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-183">It does not migrate data in those database objects from the development database to the production database.</span></span> <span data-ttu-id="f2ff1-184">Se si intende copiare l'account utente e le informazioni sui ruoli nel database di sviluppo nel database di produzione, usare le tecniche descritte nell'esercitazione *distribuzione di un database* .</span><span class="sxs-lookup"><span data-stu-id="f2ff1-184">If you mean to copy the user account and role information in the development database to the production database use the techniques covered in the *Deploying a Database* tutorial.</span></span>

<span data-ttu-id="f2ff1-185">Si osservi come aggiungere gli oggetti di database al database di produzione usando lo strumento `aspnet_regsql.exe`.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-185">Let s look at how to add the database objects to the production database using the `aspnet_regsql.exe` tool.</span></span> <span data-ttu-id="f2ff1-186">Per iniziare, aprire Esplora risorse e passare alla directory .NET Framework versione 2,0 nel computer in uso,% WINDIR% \ Microsoft. NET\Framework\v2.0.50727.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-186">Start by opening Windows Explorer and navigating to the .NET Framework version 2.0 directory on your computer, %WINDIR%\ Microsoft.NET\Framework\v2.0.50727.</span></span> <span data-ttu-id="f2ff1-187">È necessario trovare lo strumento `aspnet_regsql.exe`.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-187">There you should find the `aspnet_regsql.exe` tool.</span></span> <span data-ttu-id="f2ff1-188">Questo strumento può essere usato dalla riga di comando, ma include anche un'interfaccia utente grafica. fare doppio clic sul file `aspnet_regsql.exe` per avviare il componente grafico.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-188">This tool can be used from the command-line, but it also includes a graphical user interface; double-click the `aspnet_regsql.exe` file to launch its graphical component.</span></span>

<span data-ttu-id="f2ff1-189">Lo strumento inizia visualizzando una schermata iniziale che ne spiega lo scopo.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-189">The tool starts by displaying a splash screen explaining its purpose.</span></span> <span data-ttu-id="f2ff1-190">Fare clic su Avanti per passare alla schermata "selezionare un'opzione di installazione", illustrata nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-190">Click Next to advance to the "Select a Setup Option" screen, which is shown in Figure 1.</span></span> <span data-ttu-id="f2ff1-191">Da qui è possibile scegliere di aggiungere gli oggetti di database dei servizi dell'applicazione o di rimuoverli da un database.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-191">From here you can choose to add the application services database objects or remove them from a database.</span></span> <span data-ttu-id="f2ff1-192">Poiché si desidera aggiungere questi oggetti al database di produzione, selezionare l'opzione "configura SQL Server per servizi applicazioni" e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-192">Because we want to add these objects to the production database, select the "Configure SQL Server for application services" option and click Next.</span></span>

<span data-ttu-id="f2ff1-193">[![scegliere di configurare SQL Server per Servizi per le applicazioni](configuring-a-website-that-uses-application-services-cs/_static/image2.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="f2ff1-193">[![Choose to Configure SQL Server for Application Services](configuring-a-website-that-uses-application-services-cs/_static/image2.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image1.jpg)</span></span>

<span data-ttu-id="f2ff1-194">**Figura 1**: scegliere di configurare SQL Server per servizi per le applicazioni ([fare clic per visualizzare l'immagine con dimensioni complete](configuring-a-website-that-uses-application-services-cs/_static/image3.jpg))</span><span class="sxs-lookup"><span data-stu-id="f2ff1-194">**Figure 1**: Choose to Configure SQL Server for Application Services ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image3.jpg))</span></span>

<span data-ttu-id="f2ff1-195">Nella schermata "selezionare il server e il database" vengono richieste informazioni per la connessione al database.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-195">In "Select the Server and Database" screen prompts for information to connect to the database.</span></span> <span data-ttu-id="f2ff1-196">Immettere il server di database, le credenziali di sicurezza e il nome del database fornito dall'azienda di hosting Web e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-196">Enter the database server, the security credentials, and the database name supplied to you by your web hosting company and click Next.</span></span>

> [!NOTE]
> <span data-ttu-id="f2ff1-197">Dopo aver immesso il server di database e le credenziali, è possibile che venga ricevuto un errore durante l'espansione dell'elenco a discesa database.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-197">After entering your database server and credentials you may get an error when expanding the database drop-down list.</span></span> <span data-ttu-id="f2ff1-198">Lo strumento `aspnet_regsql.exe` esegue una query sulla tabella di sistema `sysdatabases` per recuperare un elenco di database nel server, ma alcune società di hosting Web bloccano i server di database in modo che queste informazioni non siano disponibili pubblicamente.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-198">The `aspnet_regsql.exe` tool queries the `sysdatabases` system table to retrieve a list of databases on the server, but some web hosting companies lock down their database servers so that this information is not publicly available.</span></span> <span data-ttu-id="f2ff1-199">Se viene ricevuto questo errore, è possibile digitare il nome del database direttamente nell'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-199">If you get this error you can type the database name directly into the drop-down list.</span></span>

<span data-ttu-id="f2ff1-200">[![fornire lo strumento con le informazioni di connessione del database](configuring-a-website-that-uses-application-services-cs/_static/image5.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image4.jpg)</span><span class="sxs-lookup"><span data-stu-id="f2ff1-200">[![Supply the Tool With Your Database s Connection Information](configuring-a-website-that-uses-application-services-cs/_static/image5.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image4.jpg)</span></span>

<span data-ttu-id="f2ff1-201">**Figura 2**: fornire lo strumento con le informazioni di connessione al database ([fare clic per visualizzare l'immagine con dimensioni complete](configuring-a-website-that-uses-application-services-cs/_static/image6.jpg))</span><span class="sxs-lookup"><span data-stu-id="f2ff1-201">**Figure 2**: Supply the Tool With Your Database s Connection Information ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image6.jpg))</span></span>

<span data-ttu-id="f2ff1-202">Nella schermata successiva vengono riepilogate le azioni che stanno per essere eseguite, ovvero gli oggetti di database dei servizi dell'applicazione verranno aggiunti al database specificato.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-202">The subsequent screen summarizes the actions that are about to take place, namely that the application services database objects are going to be added to the specified database.</span></span> <span data-ttu-id="f2ff1-203">Per completare l'azione, fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-203">Click Next to complete this action.</span></span> <span data-ttu-id="f2ff1-204">Dopo alcuni istanti, viene visualizzata la schermata finale, notando che gli oggetti di database sono stati aggiunti (vedere la figura 3).</span><span class="sxs-lookup"><span data-stu-id="f2ff1-204">After a few moments, the final screen is displayed, noting that the database objects have been added (see Figure 3).</span></span>

<span data-ttu-id="f2ff1-205">[![esito positivo. Gli oggetti di database Servizi per le applicazioni sono stati aggiunti al database di produzione](configuring-a-website-that-uses-application-services-cs/_static/image8.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image7.jpg)</span><span class="sxs-lookup"><span data-stu-id="f2ff1-205">[![Success! The Application Services Database Objects Were Added to the Production Database](configuring-a-website-that-uses-application-services-cs/_static/image8.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image7.jpg)</span></span>

<span data-ttu-id="f2ff1-206">**Figura 3**: operazione riuscita.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-206">**Figure 3**: Success!</span></span> <span data-ttu-id="f2ff1-207">Gli oggetti di database Servizi per le applicazioni sono stati aggiunti al database di produzione ([fare clic per visualizzare l'immagine con dimensioni complete](configuring-a-website-that-uses-application-services-cs/_static/image9.jpg))</span><span class="sxs-lookup"><span data-stu-id="f2ff1-207">The Application Services Database Objects Were Added to the Production Database ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image9.jpg))</span></span>

<span data-ttu-id="f2ff1-208">Per verificare che gli oggetti di database dei servizi dell'applicazione siano stati aggiunti correttamente al database di produzione, aprire SQL Server Management Studio e connettersi al database di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-208">To verify that the application services database objects were successfully added to the production database, open SQL Server Management Studio and connect to your production database.</span></span> <span data-ttu-id="f2ff1-209">Come illustrato nella figura 4, verranno visualizzate le tabelle del database dei servizi dell'applicazione nel database, `aspnet_Applications`, `aspnet_Membership`, `aspnet_Users`e così via.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-209">As Figure 4 shows, you should now see the application services database tables in your database, `aspnet_Applications`, `aspnet_Membership`, `aspnet_Users`, and so forth.</span></span>

<span data-ttu-id="f2ff1-210">[![verificare che gli oggetti di database siano stati aggiunti al database di produzione](configuring-a-website-that-uses-application-services-cs/_static/image11.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image10.jpg)</span><span class="sxs-lookup"><span data-stu-id="f2ff1-210">[![Confirm That the Database Objects Were Added to the Production Database](configuring-a-website-that-uses-application-services-cs/_static/image11.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image10.jpg)</span></span>

<span data-ttu-id="f2ff1-211">**Figura 4**: verificare che gli oggetti di database siano stati aggiunti al database di produzione ([fare clic per visualizzare l'immagine con dimensioni complete](configuring-a-website-that-uses-application-services-cs/_static/image12.jpg))</span><span class="sxs-lookup"><span data-stu-id="f2ff1-211">**Figure 4**: Confirm That the Database Objects Were Added to the Production Database ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image12.jpg))</span></span>

<span data-ttu-id="f2ff1-212">È necessario usare lo strumento `aspnet_regsql.exe` solo quando si distribuisce l'applicazione Web per la prima volta o per la prima volta dopo aver iniziato a usare i servizi dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-212">You will only need to use the `aspnet_regsql.exe` tool when deploying your web application for the first time or for the first time after you have started using the application services.</span></span> <span data-ttu-id="f2ff1-213">Quando questi oggetti di database si trovano nel database di produzione, non è necessario aggiungerli di nuovo o modificarli.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-213">Once these database objects are on the production database they won't need to be re-added or modified.</span></span>

### <a name="copying-user-accounts-from-development-to-production"></a><span data-ttu-id="f2ff1-214">Copia degli account utente dallo sviluppo alla produzione</span><span class="sxs-lookup"><span data-stu-id="f2ff1-214">Copying User Accounts from Development to Production</span></span>

<span data-ttu-id="f2ff1-215">Quando si utilizzano le classi del provider `SqlMembershipProvider` e `SqlRoleProvider` per archiviare le informazioni dei servizi dell'applicazione in un database SQL Server, le informazioni sull'account utente e sul ruolo vengono archiviate in un'ampia gamma di tabelle di database, tra cui `aspnet_Users`, `aspnet_Membership`, `aspnet_Roles`e `aspnet_UsersInRoles`.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-215">When using the `SqlMembershipProvider` and `SqlRoleProvider` provider classes to store the application services information in a SQL Server database, the user account and role information is stored in a variety of database tables, including `aspnet_Users`, `aspnet_Membership`, `aspnet_Roles`, and `aspnet_UsersInRoles`, among others.</span></span> <span data-ttu-id="f2ff1-216">Se durante lo sviluppo si creano account utente nell'ambiente di sviluppo, è possibile replicare tali account utente in produzione copiando i record corrispondenti dalle tabelle di database applicabili.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-216">If during development you create user accounts in the development environment you can replicate those user accounts in production by copying the corresponding records from the applicable database tables.</span></span> <span data-ttu-id="f2ff1-217">Se è stata utilizzata la pubblicazione guidata database per distribuire gli oggetti di database dei servizi applicazioni, è possibile che sia stata anche scelta la copia dei record, in modo che gli account utente creati in fase di sviluppo siano anche in produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-217">If you used the Database Publishing Wizard to deploy the application services database objects you may have also elected to copy the records, which would result in the user accounts created in development to also be on production.</span></span> <span data-ttu-id="f2ff1-218">Tuttavia, a seconda delle impostazioni di configurazione, è possibile che gli utenti i cui account sono stati creati in fase di sviluppo e copiati in produzione non siano in grado di accedere dal sito Web di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-218">But, depending on your configuration settings, you may find that those users whose accounts were created in development and copied to production are unable to login from the production website.</span></span> <span data-ttu-id="f2ff1-219">Quali sono i vantaggi?</span><span class="sxs-lookup"><span data-stu-id="f2ff1-219">What gives?</span></span>

<span data-ttu-id="f2ff1-220">Le classi del provider `SqlMembershipProvider` e `SqlRoleProvider` sono state progettate in modo da consentire a un singolo database di fungere da archivio utente per più applicazioni, in cui ogni applicazione può, in teoria, avere utenti con nomi utente e ruoli sovrapposti con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-220">The `SqlMembershipProvider` and `SqlRoleProvider` provider classes were designed such that a single database could serve as a user store for multiple applications, where each application could, in theory, have users with overlapping usernames and roles with the same name.</span></span> <span data-ttu-id="f2ff1-221">Per consentire questa flessibilità, il database gestisce un elenco di applicazioni nella tabella `aspnet_Applications` e ogni utente è associato a una di queste applicazioni.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-221">To allow for this flexibility, the database maintains a list of applications in the `aspnet_Applications` table, and each user is associated with one of these applications.</span></span> <span data-ttu-id="f2ff1-222">In particolare, la tabella `aspnet_Users` dispone di una colonna `ApplicationId` che associa ogni utente a un record nella tabella `aspnet_Applications`.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-222">Specifically, the `aspnet_Users` table has an `ApplicationId` column that ties each user to a record in the `aspnet_Applications` table.</span></span>

<span data-ttu-id="f2ff1-223">Oltre alla colonna `ApplicationId`, la tabella `aspnet_Applications` include anche una colonna `ApplicationName`, che fornisce un nome più descrittivo per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-223">In addition to the `ApplicationId` column, the `aspnet_Applications` table also includes an `ApplicationName` column, which provides a more human-friendly name for the application.</span></span> <span data-ttu-id="f2ff1-224">Quando un sito Web tenta di usare un account utente, ad esempio la convalida delle credenziali di un utente dalla pagina di accesso, deve indicare alla classe `SqlMembershipProvider` quale applicazione usare.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-224">When a website attempts to work with a user account, such as validating a user s credentials from the login page, it must tell the `SqlMembershipProvider` class what application to work with.</span></span> <span data-ttu-id="f2ff1-225">Questa operazione viene in genere eseguita specificando il nome dell'applicazione e questo valore deriva dalla configurazione del provider in `Web.config`, in particolare tramite l'attributo `applicationName`.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-225">It usually does this by supplying the application name, and the this value comes from the provider s configuration in `Web.config` - specifically via the `applicationName` attribute.</span></span>

<span data-ttu-id="f2ff1-226">Ma cosa accade se l'attributo `applicationName` non è specificato in `Web.config`?</span><span class="sxs-lookup"><span data-stu-id="f2ff1-226">But what happens if the `applicationName` attribute is not specified in `Web.config`?</span></span> <span data-ttu-id="f2ff1-227">In tal caso, il sistema di appartenenze usa il percorso radice dell'applicazione come valore `applicationName`.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-227">In such a case the Membership system uses the application root path as the `applicationName` value.</span></span> <span data-ttu-id="f2ff1-228">Se l'attributo `applicationName` non viene impostato in modo esplicito in `Web.config`, è possibile che l'ambiente di sviluppo e l'ambiente di produzione usino una radice dell'applicazione diversa e pertanto verranno associati a nomi di applicazioni diversi nei servizi dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-228">If the `applicationName` attribute is not explicitly set in `Web.config`, then, there is the possibility that the development environment and production environment use a different application root and therefore will be associated with different application names in the application services.</span></span> <span data-ttu-id="f2ff1-229">Se si verifica una mancata corrispondenza, gli utenti creati nell'ambiente di sviluppo avranno un valore `ApplicationId` che non corrisponde al valore `ApplicationId` per l'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-229">If such a mismatch occurs then those users created in the development environment will have an `ApplicationId` value that does not match with the `ApplicationId` value for the production environment.</span></span> <span data-ttu-id="f2ff1-230">Il risultato finale è che tali utenti non saranno in grado di eseguire l'accesso.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-230">The net result is that those users won't be able to login.</span></span>

> [!NOTE]
> <span data-ttu-id="f2ff1-231">Se ci si trova in questa situazione: con gli account utente copiati nell'ambiente di produzione con un valore di `ApplicationId` non corrispondente, è possibile scrivere una query per aggiornare questi valori di `ApplicationId` non corretti al `ApplicationId` usato nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-231">If you find yourself in this situation - with user accounts copied to production with a mismatched `ApplicationId` value - you could write a query to update these incorrect `ApplicationId` values to the `ApplicationId` used on production.</span></span> <span data-ttu-id="f2ff1-232">Al termine dell'aggiornamento, gli utenti i cui account sono stati creati nell'ambiente di sviluppo saranno ora in grado di accedere all'applicazione Web nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-232">Once updated, the users whose accounts were created on the development environment would now be able to sign into the web application on production.</span></span>

<span data-ttu-id="f2ff1-233">L'aspetto positivo è che è possibile eseguire un semplice passaggio per assicurarsi che i due ambienti usino lo stesso `ApplicationId`, impostando in modo esplicito l'attributo `applicationName` in `Web.config` per tutti i provider di servizi dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-233">The good news is that there is a simple step you can take to ensure that the two environments use the same `ApplicationId` - explicitly set the `applicationName` attribute in `Web.config` for all of your application services providers.</span></span> <span data-ttu-id="f2ff1-234">Si imposta in modo esplicito l'attributo `applicationName` su "BookReviews" negli elementi `<membership>` e `<roleManager>` come il frammento di `Web.config` visualizzato.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-234">I explicitly set the `applicationName` attribute to "BookReviews" in the `<membership>` and `<roleManager>` elements as this snippet from `Web.config` shows.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample4.xml)]

<span data-ttu-id="f2ff1-235">Per altre informazioni sull'impostazione dell'attributo `applicationName` e sulla relativa logica, vedere il post di Blog di [*Scott Guthrie*](https://weblogs.asp.net/scottgu/) , [*impostare sempre la proprietà ApplicationName quando si configura l'appartenenza a ASP.NET e altri provider*](https://weblogs.asp.net/scottgu/443634).</span><span class="sxs-lookup"><span data-stu-id="f2ff1-235">For more discussion on setting the `applicationName` attribute and the rationale behind it, refer to [*Scott Guthrie*](https://weblogs.asp.net/scottgu/) s blog post, [*Always set the applicationName property when configuring ASP.NET Membership and other Providers*](https://weblogs.asp.net/scottgu/443634).</span></span>

### <a name="managing-user-accounts-in-the-production-environment"></a><span data-ttu-id="f2ff1-236">Gestione degli account utente nell'ambiente di produzione</span><span class="sxs-lookup"><span data-stu-id="f2ff1-236">Managing User Accounts in the Production Environment</span></span>

<span data-ttu-id="f2ff1-237">Lo strumento Amministrazione sito Web di ASP.NET (WSAT) semplifica la creazione e la gestione degli account utente, la definizione e l'applicazione dei ruoli e l'ortografia delle regole di autorizzazione basate sugli utenti e sui ruoli.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-237">The ASP.NET Web Site Administration Tool (WSAT) makes it easy to create and manage user accounts, define and apply roles, and spell out user- and role-based authorization rules.</span></span> <span data-ttu-id="f2ff1-238">Per avviare il WSAT da Visual Studio, passare al Esplora soluzioni e fare clic sull'icona di configurazione di ASP.NET o passare ai menu del sito Web o del progetto e selezionare la voce di menu configurazione ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-238">You can launch the WSAT from Visual Studio by going to the Solution Explorer and clicking the ASP.NET Configuration icon or by going to the Website or Project menus and selecting the ASP.NET Configuration menu item.</span></span> <span data-ttu-id="f2ff1-239">Sfortunatamente, il WSAT può funzionare solo con i siti Web locali.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-239">Unfortunately, the WSAT can only work with local websites.</span></span> <span data-ttu-id="f2ff1-240">Non è quindi possibile usare WSAT dalla workstation per gestire il sito Web nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-240">Therefore, you cannot use the WSAT from your workstation to manage the website in the production environment.</span></span>

<span data-ttu-id="f2ff1-241">La novità è che tutte le funzionalità esposte da WSAT sono disponibili a livello di codice tramite le API di appartenenza e dei ruoli. Inoltre, molte delle schermate di WSAT usano i controlli standard correlati all'accesso ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-241">The good news is that all of the functionality exposed provided by the WSAT is available programmatically through the Membership and Roles APIs; furthermore, many of the WSAT screens use the standard ASP.NET Login-related controls.</span></span> <span data-ttu-id="f2ff1-242">In breve, è possibile aggiungere pagine ASP.NET al sito Web che offrono le funzionalità di gestione necessarie.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-242">In short, you can add ASP.NET pages to your website that offer the necessary management capabilities.</span></span>

<span data-ttu-id="f2ff1-243">Tenere presente che un'esercitazione precedente ha aggiornato l'applicazione Web Book revisioni per includere una cartella `~/Admin` e che questa cartella è stata configurata in modo da consentire solo agli utenti con il ruolo di amministratore.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-243">Recall that an earlier tutorial updated the Book Reviews web application to include an `~/Admin` folder, and this folder has been configured to only allow users in the Admin role.</span></span> <span data-ttu-id="f2ff1-244">È stata aggiunta una pagina alla cartella denominata `CreateAccount.aspx` da cui un amministratore può creare un nuovo account utente.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-244">I added a page to that folder named `CreateAccount.aspx` from which an administrator can create a new user account.</span></span> <span data-ttu-id="f2ff1-245">Questa pagina usa il controllo CreateUserWizard per visualizzare l'interfaccia utente e la logica di back-end per la creazione di un nuovo account utente.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-245">This page uses the CreateUserWizard control to display the user interface and backend logic for creating a new user account.</span></span> <span data-ttu-id="f2ff1-246">Inoltre, ho personalizzato il controllo per includere una casella di controllo che chiede se il nuovo utente debba essere aggiunto al ruolo di amministratore (vedere la figura 5).</span><span class="sxs-lookup"><span data-stu-id="f2ff1-246">What s more, I customized the control to include a CheckBox that prompts whether the new user should also be added to the Admin role (see Figure 5).</span></span> <span data-ttu-id="f2ff1-247">Con un po' di lavoro è possibile creare un set personalizzato di pagine che implementa le attività relative alla gestione di utenti e ruoli che verrebbero altrimenti fornite da WSAT.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-247">With a little bit of work you can build a custom set of pages that implements the user and role management-related tasks that would otherwise be provided by the WSAT.</span></span>

> [!NOTE]
> <span data-ttu-id="f2ff1-248">Per altre informazioni sull'uso delle API di appartenenza e dei ruoli insieme ai controlli Web ASP.NET correlati all'accesso, vedere le [*esercitazioni sulla sicurezza del sito Web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="f2ff1-248">For more information on using the Membership and Roles APIs along with the Login-related ASP.NET Web controls, be sure to read my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span> <span data-ttu-id="f2ff1-249">Per ulteriori informazioni sulla personalizzazione del controllo CreateUserWizard, vedere la pagina relativa alla [*creazione di account utente*](../../older-versions-security/membership/creating-user-accounts-cs.md) e all'archiviazione di ulteriori esercitazioni [*sulle informazioni utente*](../../older-versions-security/membership/storing-additional-user-information-cs.md) oppure vedere l'articolo di [*Erich Peterson*](http://www.erichpeterson.com/) , [*personalizzazione del controllo CreateUserWizard*](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="f2ff1-249">For more on customizing the CreateUserWizard control refer to the [*Creating User Accounts*](../../older-versions-security/membership/creating-user-accounts-cs.md) and [*Storing Additional User Information*](../../older-versions-security/membership/storing-additional-user-information-cs.md) tutorials, or check out [*Erich Peterson*](http://www.erichpeterson.com/) s article, [*Customizing the CreateUserWizard Control*](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx).</span></span>

<span data-ttu-id="f2ff1-250">[![gli amministratori possono creare nuovi account utente](configuring-a-website-that-uses-application-services-cs/_static/image14.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image13.jpg)</span><span class="sxs-lookup"><span data-stu-id="f2ff1-250">[![Administrators Can Create New User Accounts](configuring-a-website-that-uses-application-services-cs/_static/image14.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image13.jpg)</span></span>

<span data-ttu-id="f2ff1-251">**Figura 5**: gli amministratori possono creare nuovi account utente ([fare clic per visualizzare l'immagine con dimensioni complete](configuring-a-website-that-uses-application-services-cs/_static/image15.jpg))</span><span class="sxs-lookup"><span data-stu-id="f2ff1-251">**Figure 5**: Administrators Can Create New User Accounts ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image15.jpg))</span></span>

<span data-ttu-id="f2ff1-252">Se sono necessarie le funzionalità complete di WSAT, vedere la [*pagina relativa allo strumento di amministrazione del sito Web*](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx), in cui l'autore Dan Clem illustra il processo di creazione di uno strumento personalizzato di tipo WSAT.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-252">If you need the full functionality of the WSAT check out [*Rolling Your Own Web Site Administration Tool*](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx), in which author Dan Clem walks through the process of building a custom WSAT-like tool.</span></span> <span data-ttu-id="f2ff1-253">Dan condivide il codice sorgente dell'applicazione (in C#) e fornisce istruzioni dettagliate per aggiungerlo al sito Web ospitato.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-253">Dan shares his application s source code (in C#) and provides step-by-step instructions for adding it to your hosted website.</span></span>

## <a name="summary"></a><span data-ttu-id="f2ff1-254">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="f2ff1-254">Summary</span></span>

<span data-ttu-id="f2ff1-255">Quando si distribuisce un'applicazione Web che utilizza l'implementazione del database dei servizi dell'applicazione, è necessario innanzitutto verificare che il database di produzione disponga degli oggetti di database necessari.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-255">When deploying a web application that uses the application services database implementation you must first ensure that the production database has the requisite database objects.</span></span> <span data-ttu-id="f2ff1-256">Questi oggetti possono essere aggiunti usando le tecniche descritte nell'esercitazione *distribuzione di un database* . in alternativa, è possibile usare lo strumento `aspnet_regsql.exe`, come illustrato in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-256">These objects can be added using the techniques discussed in the *Deploying a Database* tutorial; alternatively, you can use the `aspnet_regsql.exe` tool, as we saw in this tutorial.</span></span> <span data-ttu-id="f2ff1-257">Altri problemi sono stati affrontati al centro attorno alla sincronizzazione del nome dell'applicazione usato negli ambienti di sviluppo e produzione (importante se si desidera che gli utenti e i ruoli creati nell'ambiente di sviluppo siano validi per la produzione) e le tecniche per gestione degli utenti e dei ruoli nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="f2ff1-257">Other challenges we touched on center around synchronizing the application name used in the development and production environments (which is important if you want users and roles created in the development environment to be valid on production) and techniques for managing the users and roles in the production environment.</span></span>

<span data-ttu-id="f2ff1-258">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="f2ff1-258">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="f2ff1-259">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="f2ff1-259">Further Reading</span></span>

<span data-ttu-id="f2ff1-260">Per ulteriori informazioni sugli argomenti trattati in questa esercitazione, fare riferimento alle risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="f2ff1-260">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f2ff1-261">*Strumento di registrazione SQL Server ASP.NET (aspnet_regsql. exe)* </span><span class="sxs-lookup"><span data-stu-id="f2ff1-261">*ASP.NET SQL Server Registration Tool (aspnet_regsql.exe)*</span></span>](https://msdn.microsoft.com/library/ms229862.aspx)
- [<span data-ttu-id="f2ff1-262">*Creazione del database di Servizi per le applicazioni per SQL Server*</span><span class="sxs-lookup"><span data-stu-id="f2ff1-262">*Creating the Application Services Database for SQL Server*</span></span>](https://msdn.microsoft.com/library/x28wfk74.aspx)
- [<span data-ttu-id="f2ff1-263">*Creazione dello schema di appartenenza in SQL Server*</span><span class="sxs-lookup"><span data-stu-id="f2ff1-263">*Creating the Membership Schema in SQL Server*</span></span>](../../older-versions-security/membership/creating-the-membership-schema-in-sql-server-cs.md)
- [<span data-ttu-id="f2ff1-264">*Esaminare l'appartenenza, i ruoli e il profilo di ASP.NET*</span><span class="sxs-lookup"><span data-stu-id="f2ff1-264">*Examining ASP.NET s Membership, Roles, and Profile*</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="f2ff1-265">*Implementazione dello strumento di amministrazione del sito Web*</span><span class="sxs-lookup"><span data-stu-id="f2ff1-265">*Rolling Your Own Web Site Administration Tool*</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="f2ff1-266">*Esercitazioni sulla sicurezza del sito Web*</span><span class="sxs-lookup"><span data-stu-id="f2ff1-266">*Website Security Tutorials*</span></span>](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md)
- [<span data-ttu-id="f2ff1-267">*Panoramica dello strumento Amministrazione sito Web*</span><span class="sxs-lookup"><span data-stu-id="f2ff1-267">*Web Site Administration Tool Overview*</span></span>](https://msdn.microsoft.com/library/yy40ytx0.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="f2ff1-268">[Precedente](configuring-the-production-web-application-to-use-the-production-database-cs.md)
> [Successivo](strategies-for-database-development-and-deployment-cs.md)</span><span class="sxs-lookup"><span data-stu-id="f2ff1-268">[Previous](configuring-the-production-web-application-to-use-the-production-database-cs.md)
[Next](strategies-for-database-development-and-deployment-cs.md)</span></span>
