---
uid: web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
title: Creazione di un'interfaccia utente di ordinamento personalizzata (VB) | Microsoft Docs
author: rick-anderson
description: Quando si visualizza un lungo elenco di dati ordinati, può essere molto utile raggruppare i dati correlati introducendo le righe del separatore. In questa esercitazione verrà illustrato come cre...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: f3897a74-cc6a-4032-8f68-465f155e296a
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 66127630560141cd795beb15f525a7fba85f3993
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78619924"
---
# <a name="creating-a-customized-sorting-user-interface-vb"></a><span data-ttu-id="e8c5a-104">Creazione di un'interfaccia utente per l'ordinamento personalizzato (VB)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-104">Creating a Customized Sorting User Interface (VB)</span></span>

<span data-ttu-id="e8c5a-105">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e8c5a-106">[Scaricare l'app di esempio](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) o [scaricare il file PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) or [Download PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span></span>

> <span data-ttu-id="e8c5a-107">Quando si visualizza un lungo elenco di dati ordinati, può essere molto utile raggruppare i dati correlati introducendo le righe del separatore.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-107">When displaying a long list of sorted data, it can be very helpful to group related data by introducing separator rows.</span></span> <span data-ttu-id="e8c5a-108">In questa esercitazione verrà illustrato come creare un'interfaccia utente di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-108">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="e8c5a-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="e8c5a-109">Introduction</span></span>

<span data-ttu-id="e8c5a-110">Quando si visualizza un lungo elenco di dati ordinati in cui sono presenti solo pochi valori diversi nella colonna ordinata, un utente finale potrebbe rivelarsi difficile individuare dove, esattamente, si verificano i limiti di differenza.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-110">When displaying a long list of sorted data where there are only a handful of different values in the sorted column, an end user might find it hard to discern where, exactly, the difference boundaries occur.</span></span> <span data-ttu-id="e8c5a-111">Nel database, ad esempio, sono presenti 81 prodotti, ma solo nove scelte di categoria diverse (otto categorie univoche più l'opzione `NULL`).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-111">For example, there are 81 products in the database, but only nine different category choices (eight unique categories plus the `NULL` option).</span></span> <span data-ttu-id="e8c5a-112">Si consideri il caso di un utente interessato a esaminare i prodotti che rientrano nella categoria Seafood.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-112">Consider the case of a user who is interested in examining the products that fall under the Seafood category.</span></span> <span data-ttu-id="e8c5a-113">Da una pagina che elenca *tutti* i prodotti in un unico GridView, l'utente potrebbe decidere la scelta migliore per ordinare i risultati in base alla categoria, che raggruppa tutti i prodotti ittici insieme.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-113">From a page that lists *all* of the products in a single GridView, the user might decide her best bet is to sort the results by category, which will group together all of the Seafood products together.</span></span> <span data-ttu-id="e8c5a-114">Dopo l'ordinamento in base alla categoria, l'utente deve quindi cercare nell'elenco la posizione di inizio e fine dei prodotti raggruppati per il pesce.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-114">After sorting by category, the user then needs to hunt through the list, looking for where the Seafood-grouped products start and end.</span></span> <span data-ttu-id="e8c5a-115">Poiché i risultati vengono ordinati in ordine alfabetico in base al nome di categoria, la ricerca dei prodotti a frutti di pesce non è difficile, ma richiede comunque l'analisi accurata dell'elenco di elementi nella griglia.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-115">Since the results are ordered alphabetically by the category name finding the Seafood products is not difficult, but it still requires closely scanning the list of items in the grid.</span></span>

<span data-ttu-id="e8c5a-116">Per evidenziare i limiti tra gruppi ordinati, molti siti Web utilizzano un'interfaccia utente che aggiunge un separatore tra tali gruppi.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-116">To help highlight the boundaries between sorted groups, many websites employ a user interface that adds a separator between such groups.</span></span> <span data-ttu-id="e8c5a-117">I separatori come quelli mostrati nella figura 1 consentono a un utente di trovare più rapidamente un particolare gruppo e di identificarne i limiti, oltre a verificare quali gruppi distinti sono presenti nei dati.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-117">Separators like the ones shown in Figure 1 enables a user to more quickly find a particular group and identify its boundaries, as well as ascertain what distinct groups exist in the data.</span></span>

<span data-ttu-id="e8c5a-118">[![ogni gruppo di categorie è chiaramente identificato](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-118">[![Each Category Group is Clearly Identified](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="e8c5a-119">**Figura 1**: ogni gruppo di categorie è chiaramente identificato ([fare clic per visualizzare l'immagine con dimensioni complete](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="e8c5a-119">**Figure 1**: Each Category Group is Clearly Identified ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span></span>

<span data-ttu-id="e8c5a-120">In questa esercitazione verrà illustrato come creare un'interfaccia utente di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-120">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="step-1-creating-a-standard-sortable-gridview"></a><span data-ttu-id="e8c5a-121">Passaggio 1: creazione di un GridView standard e ordinabile</span><span class="sxs-lookup"><span data-stu-id="e8c5a-121">Step 1: Creating a Standard, Sortable GridView</span></span>

<span data-ttu-id="e8c5a-122">Prima di esaminare come aumentare il controllo GridView per fornire l'interfaccia di ordinamento avanzata, è necessario creare prima un GridView standard e ordinabile che elenca i prodotti.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-122">Before we explore how to augment the GridView to provide the enhanced sorting interface, let s first create a standard, sortable GridView that lists the products.</span></span> <span data-ttu-id="e8c5a-123">Per iniziare, aprire la pagina `CustomSortingUI.aspx` nella cartella `PagingAndSorting`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-123">Start by opening the `CustomSortingUI.aspx` page in the `PagingAndSorting` folder.</span></span> <span data-ttu-id="e8c5a-124">Aggiungere un controllo GridView alla pagina, impostare la relativa proprietà `ID` su `ProductList`e associarla a un nuovo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-124">Add a GridView to the page, set its `ID` property to `ProductList`, and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="e8c5a-125">Configurare ObjectDataSource per utilizzare il metodo di `GetProducts()` della classe `ProductsBLL` per selezionare i record.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records.</span></span>

<span data-ttu-id="e8c5a-126">Configurare quindi GridView in modo che contenga solo i BoundField `ProductName`, `CategoryName`, `SupplierName`e `UnitPrice` e l'oggetto CheckBoxField sospeso.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-126">Next, configure the GridView such that it only contains the `ProductName`, `CategoryName`, `SupplierName`, and `UnitPrice` BoundFields and the Discontinued CheckBoxField.</span></span> <span data-ttu-id="e8c5a-127">Infine, configurare GridView per supportare l'ordinamento selezionando la casella di controllo Abilita ordinamento nello smart tag di GridView o impostando la relativa proprietà `AllowSorting` su `true`).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-127">Finally, configure the GridView to support sorting by checking the Enable Sorting checkbox in the GridView s smart tag (or by setting its `AllowSorting` property to `true`).</span></span> <span data-ttu-id="e8c5a-128">Dopo aver apportato queste aggiunte alla pagina `CustomSortingUI.aspx`, il markup dichiarativo avrà un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="e8c5a-128">After making these additions to the `CustomSortingUI.aspx` page, the declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-a-customized-sorting-user-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="e8c5a-129">È possibile esaminare lo stato di avanzamento fino a questo punto in un browser.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-129">Take a moment to view our progress thus far in a browser.</span></span> <span data-ttu-id="e8c5a-130">Nella figura 2 viene illustrato il GridView ordinabile quando i dati vengono ordinati in ordine alfabetico in base alla categoria.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-130">Figure 2 shows the sortable GridView when its data is sorted by category in alphabetical order.</span></span>

<span data-ttu-id="e8c5a-131">[![i dati di GridView ordinabili sono ordinati in base alla categoria](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-131">[![The Sortable GridView s Data is Ordered by Category](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="e8c5a-132">**Figura 2**: i dati di GridView ordinabili sono ordinati in base alla categoria ([fare clic per visualizzare l'immagine con dimensioni complete](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e8c5a-132">**Figure 2**: The Sortable GridView s Data is Ordered by Category ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span></span>

## <a name="step-2-exploring-techniques-for-adding-the-separator-rows"></a><span data-ttu-id="e8c5a-133">Passaggio 2: esplorazione delle tecniche per l'aggiunta delle righe dei separatori</span><span class="sxs-lookup"><span data-stu-id="e8c5a-133">Step 2: Exploring Techniques for Adding the Separator Rows</span></span>

<span data-ttu-id="e8c5a-134">Con l'oggetto GridView generico e ordinabile completo, rimane solo la possibilità di aggiungere le righe del separatore in GridView prima di ogni gruppo ordinato univoco.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-134">With the generic, sortable GridView complete, all that remains is to be able to add the separator rows in the GridView before each unique sorted group.</span></span> <span data-ttu-id="e8c5a-135">In che modo è possibile inserire tali righe in GridView?</span><span class="sxs-lookup"><span data-stu-id="e8c5a-135">But how can such rows be injected into the GridView?</span></span> <span data-ttu-id="e8c5a-136">Essenzialmente, è necessario eseguire l'iterazione delle righe di GridView, determinare dove si verificano le differenze tra i valori nella colonna ordinata, quindi aggiungere la riga del separatore appropriata.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-136">Essentially, we need to iterate through the GridView s rows, determine where the differences occur between the values in the sorted column, and then add the appropriate separator row.</span></span> <span data-ttu-id="e8c5a-137">Quando si pensa a questo problema, sembra naturale che la soluzione si trovi in un punto del gestore dell'evento GridView s `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-137">When thinking about this problem, it seems natural that the solution lies somewhere in the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="e8c5a-138">Come illustrato nell'esercitazione [sulla formattazione personalizzata basata sui dati](../custom-formatting/custom-formatting-based-upon-data-vb.md) , questo gestore eventi viene comunemente usato quando si applica la formattazione a livello di riga in base ai dati della riga.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-138">As we discussed in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial, this event handler is commonly used when applying row-level formatting based on the row s data.</span></span> <span data-ttu-id="e8c5a-139">Tuttavia, il gestore dell'evento `RowDataBound` non è la soluzione in questo caso, in quanto le righe non possono essere aggiunte a GridView a livello di codice da questo gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-139">However, the `RowDataBound` event handler is not the solution here, as rows cannot be added to the GridView programmatically from this event handler.</span></span> <span data-ttu-id="e8c5a-140">La raccolta di `Rows` GridView s, di fatto, è di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-140">The GridView s `Rows` collection, in fact, is read-only.</span></span>

<span data-ttu-id="e8c5a-141">Per aggiungere altre righe al GridView sono disponibili tre opzioni:</span><span class="sxs-lookup"><span data-stu-id="e8c5a-141">To add additional rows to the GridView we have three choices:</span></span>

- <span data-ttu-id="e8c5a-142">Aggiungere queste righe del separatore di metadati ai dati effettivi associati al controllo GridView</span><span class="sxs-lookup"><span data-stu-id="e8c5a-142">Add these metadata separator rows to the actual data that is bound to the GridView</span></span>
- <span data-ttu-id="e8c5a-143">Dopo che GridView è stato associato ai dati, aggiungere altre istanze di `TableRow` alla raccolta di controlli GridView s</span><span class="sxs-lookup"><span data-stu-id="e8c5a-143">After the GridView has been bound to the data, add additional `TableRow` instances to the GridView s control collection</span></span>
- <span data-ttu-id="e8c5a-144">Creare un controllo server personalizzato che estende il controllo GridView ed esegue l'override dei metodi responsabili della creazione della struttura di GridView.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-144">Create a custom server control that extends the GridView control and overrides those methods responsible for constructing the GridView s structure</span></span>

<span data-ttu-id="e8c5a-145">La creazione di un controllo server personalizzato è l'approccio migliore se questa funzionalità era necessaria in molte pagine Web o in più siti Web.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-145">Creating a custom server control would be the best approach if this functionality was needed on many web pages or across several websites.</span></span> <span data-ttu-id="e8c5a-146">Tuttavia, comporterebbe un po' di codice e un'esplorazione approfondita delle attività interne di GridView.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-146">However, it would entail quite a bit of code and a thorough exploration into the depths of the GridView s internal workings.</span></span> <span data-ttu-id="e8c5a-147">Pertanto, questa opzione non verrà considerata in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-147">Therefore, we'll not consider that option for this tutorial.</span></span>

<span data-ttu-id="e8c5a-148">Le altre due opzioni che aggiungono le righe dei separatori ai dati effettivi associati al GridView e la modifica della raccolta di controlli di GridView dopo la relativa associazione, attaccano il problema in modo diverso e meritano una discussione.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-148">The other two options adding separator rows to the actual data being bound to the GridView and manipulating the GridView s control collection after its been bound - attack the problem differently and merit a discussion.</span></span>

## <a name="adding-rows-to-the-data-bound-to-the-gridview"></a><span data-ttu-id="e8c5a-149">Aggiunta di righe ai dati associati a GridView</span><span class="sxs-lookup"><span data-stu-id="e8c5a-149">Adding Rows to the Data Bound to the GridView</span></span>

<span data-ttu-id="e8c5a-150">Quando GridView è associato a un'origine dati, viene creata una `GridViewRow` per ogni record restituito dall'origine dati.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-150">When the GridView is bound to a data source, it creates a `GridViewRow` for each record returned by the data source.</span></span> <span data-ttu-id="e8c5a-151">Pertanto, è possibile inserire le righe del separatore necessarie aggiungendo record separatori all'origine dati prima di associarlo a GridView.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-151">Therefore, we can inject the needed separator rows by adding separator records to the data source before binding it to the GridView.</span></span> <span data-ttu-id="e8c5a-152">Nella figura 3 viene illustrato questo concetto.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-152">Figure 3 illustrates this concept.</span></span>

![Una tecnica prevede l'aggiunta di righe di separatore all'origine dati](creating-a-customized-sorting-user-interface-vb/_static/image7.png)

<span data-ttu-id="e8c5a-154">**Figura 3**: una tecnica prevede l'aggiunta di righe di separatore all'origine dati</span><span class="sxs-lookup"><span data-stu-id="e8c5a-154">**Figure 3**: One Technique Involves Adding Separator Rows to the Data Source</span></span>

<span data-ttu-id="e8c5a-155">Utilizzo il termine record separatore tra virgolette perché non esiste alcun record separatore speciale; è piuttosto necessario contrassegnare che un particolare record nell'origine dati funge da separatore anziché da una normale riga di dati.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-155">I use the term separator records in quotes because there is no special separator record; rather, we must somehow flag that a particular record in the data source serves as a separator rather than a normal data row.</span></span> <span data-ttu-id="e8c5a-156">Per gli esempi, viene rilegata un'istanza di `ProductsDataTable` al GridView, che è costituita da `ProductRows`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-156">For our examples, we re binding a `ProductsDataTable` instance to the GridView, which is composed of `ProductRows`.</span></span> <span data-ttu-id="e8c5a-157">È possibile contrassegnare un record come una riga di separazione impostando la relativa proprietà `CategoryID` su `-1` (poiché tale valore non può esistere normalmente).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-157">We might flag a record as a separator row by setting its `CategoryID` property to `-1` (since such a value couldn't exist normally).</span></span>

<span data-ttu-id="e8c5a-158">Per usare questa tecnica, è necessario eseguire i passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e8c5a-158">To utilize this technique we d need to perform the following steps:</span></span>

1. <span data-ttu-id="e8c5a-159">Recuperare a livello di codice i dati da associare a GridView (un'istanza di `ProductsDataTable`)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-159">Programmatically retrieve the data to bind to the GridView (a `ProductsDataTable` instance)</span></span>
2. <span data-ttu-id="e8c5a-160">Ordinare i dati in base alle proprietà `SortExpression` e `SortDirection` di GridView</span><span class="sxs-lookup"><span data-stu-id="e8c5a-160">Sort the data based on the GridView s `SortExpression` and `SortDirection` properties</span></span>
3. <span data-ttu-id="e8c5a-161">Scorrere il `ProductsRows` nel `ProductsDataTable`, cercando il punto in cui si trovano le differenze nella colonna ordinata.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-161">Iterate through the `ProductsRows` in the `ProductsDataTable`, looking for where the differences in the sorted column lie</span></span>
4. <span data-ttu-id="e8c5a-162">Al limite di ogni gruppo, inserire un record separatore `ProductsRow` istanza nella DataTable, una `CategoryID` impostata su `-1` (o qualsiasi designazione che sia stata decisa per contrassegnare un record come record separatore)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-162">At each group boundary, inject a separator record `ProductsRow` instance into the DataTable, one that has it s `CategoryID` set to `-1` (or whatever designation was decided upon to mark a record as a separator record )</span></span>
5. <span data-ttu-id="e8c5a-163">Dopo aver inserito le righe del separatore, associare i dati a livello di codice a GridView</span><span class="sxs-lookup"><span data-stu-id="e8c5a-163">After injecting the separator rows, programmatically bind the data to the GridView</span></span>

<span data-ttu-id="e8c5a-164">Oltre a questi cinque passaggi, è necessario specificare anche un gestore eventi per l'evento GridView s `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-164">In addition to these five steps, we d also need to provide an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="e8c5a-165">In questo caso, si controlla ogni `DataRow` e si determina se si tratta di una riga di separatore, una con `CategoryID` impostazione `-1`ta.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-165">Here, we d check each `DataRow` and determine if it was a separator row, one whose `CategoryID` setting was `-1`.</span></span> <span data-ttu-id="e8c5a-166">In tal caso, è probabile che si desideri modificare la formattazione o il testo visualizzato nelle celle.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-166">If so, we d probably want to adjust its formatting or the text displayed in the cell(s).</span></span>

<span data-ttu-id="e8c5a-167">L'uso di questa tecnica per inserire i limiti del gruppo di ordinamento richiede un po' più di lavoro rispetto a quanto descritto in precedenza, in quanto è necessario fornire anche un gestore eventi per l'evento `Sorting` GridView e tenere traccia dei valori `SortExpression` e `SortDirection`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-167">Using this technique for injecting the sorting group boundaries requires a bit more work than outlined above, as you need to also provide an event handler for the GridView s `Sorting` event and keep track of the `SortExpression` and `SortDirection` values.</span></span>

## <a name="manipulating-the-gridview-s-control-collection-after-it-s-been-databound"></a><span data-ttu-id="e8c5a-168">Modifica della raccolta di controlli di GridView dopo che è stato associato a un DataBinding</span><span class="sxs-lookup"><span data-stu-id="e8c5a-168">Manipulating the GridView s Control Collection After It s Been Databound</span></span>

<span data-ttu-id="e8c5a-169">Anziché eseguire la messaggistica dei dati prima di associarli a GridView, è possibile aggiungere le righe del separatore *dopo che* i dati sono stati associati a GridView.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-169">Rather than messaging the data before binding it to the GridView, we can add the separator rows *after* the data has been bound to the GridView.</span></span> <span data-ttu-id="e8c5a-170">Il processo di data binding crea la gerarchia dei controlli GridView, che in realtà è semplicemente un'istanza di `Table` composta da una raccolta di righe, ciascuna delle quali è costituita da una raccolta di celle.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-170">The process of data binding builds up the GridView s control hierarchy, which in reality is simply a `Table` instance composed of a collection of rows, each of which is composed of a collection of cells.</span></span> <span data-ttu-id="e8c5a-171">In particolare, la raccolta di controlli GridView s contiene un oggetto `Table` alla radice, un `GridViewRow` (derivato dalla classe `TableRow`) per ogni record del `DataSource` associato a GridView e un oggetto `TableCell` in ogni istanza di `GridViewRow` per ogni campo dati nella `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-171">Specifically, the GridView s control collection contains a `Table` object at its root, a `GridViewRow` (which is derived from the `TableRow` class) for each record in the `DataSource` bound to the GridView, and a `TableCell` object in each `GridViewRow` instance for each data field in the `DataSource`.</span></span>

<span data-ttu-id="e8c5a-172">Per aggiungere righe separatore tra ogni gruppo di ordinamento, è possibile modificare direttamente questa gerarchia di controlli dopo che è stata creata.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-172">To add separator rows between each sorting group, we can directly manipulate this control hierarchy once it has been created.</span></span> <span data-ttu-id="e8c5a-173">È possibile essere certi che la gerarchia dei controlli di GridView sia stata creata per l'ultima volta nel momento in cui viene eseguito il rendering della pagina.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-173">We can be confident that the GridView s control hierarchy has been created for the last time by the time the page is being rendered.</span></span> <span data-ttu-id="e8c5a-174">Pertanto, questo approccio esegue l'override del metodo di `Render` della classe `Page`, a quel punto la gerarchia dei controlli finali di GridView viene aggiornata per includere le righe del separatore necessarie.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-174">Therefore, this approach overrides the `Page` class s `Render` method, at which point the GridView s final control hierarchy is updated to include the needed separator rows.</span></span> <span data-ttu-id="e8c5a-175">Nella figura 4 viene illustrato questo processo.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-175">Figure 4 illustrates this process.</span></span>

<span data-ttu-id="e8c5a-176">[![una tecnica alternativa manipola la gerarchia dei controlli di GridView](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-176">[![An Alternate Technique Manipulates the GridView s Control Hierarchy](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span></span>

<span data-ttu-id="e8c5a-177">**Figura 4**: una tecnica alternativa modifica la gerarchia dei controlli di GridView ([fare clic per visualizzare l'immagine con dimensioni complete](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="e8c5a-177">**Figure 4**: An Alternate Technique Manipulates the GridView s Control Hierarchy ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span></span>

<span data-ttu-id="e8c5a-178">Per questa esercitazione verrà usato questo secondo approccio per personalizzare l'esperienza utente di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-178">For this tutorial, we'll use this latter approach to customize the sorting user experience.</span></span>

> [!NOTE]
> <span data-ttu-id="e8c5a-179">Il codice i m presentato in questa esercitazione si basa sull'esempio fornito nel post del Blog di [Keiski](http://aspadvice.com/blogs/joteke/default.aspx) , che [gioca un po' con il raggruppamento di ordinamento di GridView](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-179">The code I m presenting in this tutorial is based on the example provided in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog entry, [Playing a Bit with GridView Sort Grouping](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span></span>

## <a name="step-3-adding-the-separator-rows-to-the-gridview-s-control-hierarchy"></a><span data-ttu-id="e8c5a-180">Passaggio 3: aggiunta delle righe dei separatori alla gerarchia dei controlli GridView s</span><span class="sxs-lookup"><span data-stu-id="e8c5a-180">Step 3: Adding the Separator Rows to the GridView s Control Hierarchy</span></span>

<span data-ttu-id="e8c5a-181">Poiché si desidera solo aggiungere le righe del separatore alla gerarchia dei controlli di GridView dopo che la gerarchia dei controlli è stata creata e creata per l'ultima volta nella visita della pagina, è necessario eseguire questa aggiunta alla fine del ciclo di vita della pagina, ma prima dell'effettivo GridView c il rendering della gerarchia ontrollo è stato eseguito in HTML.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-181">Since we only want to add the separator rows to the GridView s control hierarchy after its control hierarchy has been created and created for the last time on that page visit, we want to perform this addition at the end of the page lifecycle, but before the actual GridView control hierarchy has been rendered into HTML.</span></span> <span data-ttu-id="e8c5a-182">Il punto più recente in cui è possibile eseguire questa operazione è l'evento `Page` Class s `Render`, che è possibile sostituire nella classe code-behind usando la firma del metodo seguente:</span><span class="sxs-lookup"><span data-stu-id="e8c5a-182">The latest possible point at which we can accomplish this is the `Page` class s `Render` event, which we can override in our code-behind class using the following method signature:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample2.vb)]

<span data-ttu-id="e8c5a-183">Quando viene richiamato il metodo `Render` originale della classe `Page` `base.Render(writer)` viene eseguito il rendering di ogni controllo della pagina, generando il markup in base alla gerarchia dei controlli.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-183">When the `Page` class s original `Render` method is invoked `base.Render(writer)` each of the controls in the page will be rendered, generating the markup based on their control hierarchy.</span></span> <span data-ttu-id="e8c5a-184">È pertanto fondamentale che entrambi chiamino `base.Render(writer)`, in modo che venga eseguito il rendering della pagina e che si modifichi la gerarchia dei controlli di GridView prima di chiamare `base.Render(writer)`, in modo che le righe del separatore siano state aggiunte alla gerarchia dei controlli di GridView prima che ne venga eseguito il rendering.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-184">Therefore it is imperative that we both call `base.Render(writer)`, so that the page is rendered, and that we manipulate the GridView s control hierarchy prior to calling `base.Render(writer)`, so that the separator rows have been added to the GridView s control hierarchy before it s been rendered.</span></span>

<span data-ttu-id="e8c5a-185">Per inserire le intestazioni del gruppo di ordinamento, è necessario innanzitutto verificare che l'utente abbia richiesto l'ordinamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-185">To inject the sort group headers we first need to ensure that the user has requested that the data be sorted.</span></span> <span data-ttu-id="e8c5a-186">Per impostazione predefinita, il contenuto di GridView non è ordinato e pertanto non è necessario immettere intestazioni di ordinamento del gruppo.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-186">By default, the GridView s contents are not sorted, and therefore we don t need to enter any group sorting headers.</span></span>

> [!NOTE]
> <span data-ttu-id="e8c5a-187">Se si desidera che GridView venga ordinato in base a una determinata colonna quando la pagina viene caricata per la prima volta, chiamare il Metodo GridView s `Sort` nella prima pagina visita (ma non nei postback successivi).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-187">If you want the GridView to be sorted by a particular column when the page is first loaded, call the GridView s `Sort` method on the first page visit (but not on subsequent postbacks).</span></span> <span data-ttu-id="e8c5a-188">A tale scopo, aggiungere la chiamata nel gestore eventi `Page_Load` all'interno di un `if (!Page.IsPostBack)` condizionale.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-188">To accomplish this, add this call in the `Page_Load` event handler within an `if (!Page.IsPostBack)` conditional.</span></span> <span data-ttu-id="e8c5a-189">Per ulteriori informazioni sul metodo `Sort`, vedere le informazioni sull'esercitazione [paging e ordinamento dei dati del report](paging-and-sorting-report-data-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="e8c5a-189">Refer back to the [Paging and Sorting Report Data](paging-and-sorting-report-data-vb.md) tutorial information for more on the `Sort` method.</span></span>

<span data-ttu-id="e8c5a-190">Supponendo che i dati siano stati ordinati, l'attività successiva consiste nel determinare la colonna in base alla quale sono stati ordinati i dati e quindi analizzare le righe che cercano le differenze nei valori della colonna.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-190">Assuming that the data has been sorted, our next task is to determine what column the data was sorted by and then to scan the rows looking for differences in that column s values.</span></span> <span data-ttu-id="e8c5a-191">Il codice seguente garantisce che i dati siano stati ordinati e trovi la colonna in base alla quale sono stati ordinati i dati:</span><span class="sxs-lookup"><span data-stu-id="e8c5a-191">The following code ensures that the data has been sorted and finds the column by which the data has been sorted:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample3.vb)]

<span data-ttu-id="e8c5a-192">Se GridView è ancora stato ordinato, la proprietà `SortExpression` di GridView non sarà impostata.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-192">If the GridView has yet to be sorted, the GridView s `SortExpression` property will not have been set.</span></span> <span data-ttu-id="e8c5a-193">Pertanto, si desidera aggiungere solo le righe del separatore se questa proprietà ha un valore.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-193">Therefore, we only want to add the separator rows if this property has some value.</span></span> <span data-ttu-id="e8c5a-194">In tal caso, è necessario determinare l'indice della colonna in base alla quale sono stati ordinati i dati.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-194">If it does, we next need to determine the index of the column by which the data was sorted.</span></span> <span data-ttu-id="e8c5a-195">Questa operazione viene eseguita scorrendo il ciclo della raccolta `Columns` di GridView, cercando la colonna la cui proprietà `SortExpression` è uguale alla proprietà `SortExpression` di GridView.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-195">This is accomplished by looping through the GridView s `Columns` collection, searching for the column whose `SortExpression` property equals the GridView s `SortExpression` property.</span></span> <span data-ttu-id="e8c5a-196">Oltre all'indice della colonna, si acquisisce anche la proprietà `HeaderText`, che viene usata quando si visualizzano le righe del separatore.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-196">In addition to the column s index, we also grab the `HeaderText` property, which is used when displaying the separator rows.</span></span>

<span data-ttu-id="e8c5a-197">Con l'indice della colonna in base al quale vengono ordinati i dati, il passaggio finale consiste nell'enumerare le righe di GridView.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-197">With the index of the column by which the data is sorted, the final step is to enumerate the rows of the GridView.</span></span> <span data-ttu-id="e8c5a-198">Per ogni riga è necessario determinare se il valore della colonna ordinata è diverso dal valore della colonna ordinata della riga precedente.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-198">For each row we need to determine whether the sorted column s value differs from the previous row s sorted column s value.</span></span> <span data-ttu-id="e8c5a-199">In tal caso, è necessario inserire una nuova istanza di `GridViewRow` nella gerarchia dei controlli.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-199">If so, we need to inject a new `GridViewRow` instance into the control hierarchy.</span></span> <span data-ttu-id="e8c5a-200">Questa operazione viene eseguita con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="e8c5a-200">This is accomplished with the following code:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample4.vb)]

<span data-ttu-id="e8c5a-201">Questo codice inizia a livello di codice facendo riferimento all'oggetto `Table` trovato alla radice della gerarchia dei controlli di GridView e creando una variabile di stringa denominata `lastValue`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-201">This code starts by programmatically referencing the `Table` object found at the root of the GridView s control hierarchy and creating a string variable named `lastValue`.</span></span> <span data-ttu-id="e8c5a-202">`lastValue` viene utilizzato per confrontare il valore della colonna ordinata della riga corrente con il valore della riga precedente.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-202">`lastValue` is used to compare the current row s sorted column value with the previous row s value.</span></span> <span data-ttu-id="e8c5a-203">Successivamente, l'insieme di `Rows` GridView s viene enumerato e per ogni riga il valore della colonna ordinata viene archiviato nella variabile `currentValue`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-203">Next, the GridView s `Rows` collection is enumerated and for each row the value of the sorted column is stored in the `currentValue` variable.</span></span>

> [!NOTE]
> <span data-ttu-id="e8c5a-204">Per determinare il valore della colonna ordinata della riga specifica, utilizzo la proprietà `Text` della cella.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-204">To determine the value of the particular row s sorted column I use the cell s `Text` property.</span></span> <span data-ttu-id="e8c5a-205">Questa soluzione funziona bene per i BoundField, ma non per TemplateFields, CheckBoxFields e così via.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-205">This works well for BoundFields, but will not work as desired for TemplateFields, CheckBoxFields, and so on.</span></span> <span data-ttu-id="e8c5a-206">A breve verrà illustrato come tenere conto dei campi GridView alternativi.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-206">We'll look at how to account for alternate GridView fields shortly.</span></span>

<span data-ttu-id="e8c5a-207">Vengono quindi confrontate le variabili `currentValue` e `lastValue`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-207">The `currentValue` and `lastValue` variables are then compared.</span></span> <span data-ttu-id="e8c5a-208">Se sono diversi, è necessario aggiungere una nuova riga di separazione alla gerarchia dei controlli.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-208">If they differ we need to add a new separator row to the control hierarchy.</span></span> <span data-ttu-id="e8c5a-209">Questa operazione viene eseguita determinando l'indice della `GridViewRow` nella raccolta `Rows` dell'oggetto `Table`, creando nuove istanze `GridViewRow` e `TableCell` e quindi aggiungendo le `TableCell` e `GridViewRow` alla gerarchia dei controlli.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-209">This is accomplished by determining the index of the `GridViewRow` in the `Table` object s `Rows` collection, creating new `GridViewRow` and `TableCell` instances, and then adding the `TableCell` and `GridViewRow` to the control hierarchy.</span></span>

<span data-ttu-id="e8c5a-210">Si noti che il separatore della riga s `TableCell` è formattato in modo che si estenda sull'intera larghezza del GridView, viene formattato usando la classe CSS `SortHeaderRowStyle` e ha la relativa proprietà `Text` in modo che mostri sia il nome del gruppo di ordinamento (ad esempio Category) che il valore del gruppo (ad esempio bevande).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-210">Note that the separator row s lone `TableCell` is formatted such that it spans the entire width of the GridView, is formatted using the `SortHeaderRowStyle` CSS class, and has its `Text` property such that it shows both the sort group name (such as Category ) and the group s value (such as Beverages ).</span></span> <span data-ttu-id="e8c5a-211">Infine, `lastValue` viene aggiornato al valore di `currentValue`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-211">Finally, `lastValue` is updated to the value of `currentValue`.</span></span>

<span data-ttu-id="e8c5a-212">La classe CSS utilizzata per formattare la riga di intestazione del gruppo di ordinamento `SortHeaderRowStyle` deve essere specificata nel file di `Styles.css`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-212">The CSS class used to format the sorting group header row `SortHeaderRowStyle` needs to be specified in the `Styles.css` file.</span></span> <span data-ttu-id="e8c5a-213">È possibile usare le impostazioni di stile che si rivolgono all'utente; Ho utilizzato gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e8c5a-213">Feel free to use whatever style settings appeal to you; I used the following:</span></span>

[!code-css[Main](creating-a-customized-sorting-user-interface-vb/samples/sample5.css)]

<span data-ttu-id="e8c5a-214">Con il codice corrente, l'interfaccia di ordinamento aggiunge le intestazioni del gruppo di ordinamento durante l'ordinamento in base a qualsiasi BoundField (vedere la figura 5, che mostra una schermata durante l'ordinamento in base al fornitore).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-214">With the current code, the sorting interface adds sort group headers when sorting by any BoundField (see Figure 5, which shows a screenshot when sorting by supplier).</span></span> <span data-ttu-id="e8c5a-215">Tuttavia, quando si esegue l'ordinamento in base a qualsiasi altro tipo di campo, ad esempio CheckBoxField o TemplateField, le intestazioni del gruppo di ordinamento non sono disponibili (vedere la figura 6).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-215">However, when sorting by any other field type (such as a CheckBoxField or TemplateField), the sort group headers are nowhere to be found (see Figure 6).</span></span>

<span data-ttu-id="e8c5a-216">[![l'interfaccia di ordinamento include le intestazioni dei gruppi di ordinamento durante l'ordinamento in base a BoundField](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-216">[![The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span></span>

<span data-ttu-id="e8c5a-217">**Figura 5**: l'interfaccia di ordinamento include le intestazioni dei gruppi di ordinamento durante l'ordinamento in base a BoundField ([fare clic per visualizzare l'immagine con dimensioni complete](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="e8c5a-217">**Figure 5**: The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span></span>

<span data-ttu-id="e8c5a-218">[![le intestazioni del gruppo di ordinamento mancanti durante l'ordinamento di un oggetto CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-218">[![The Sort Group Headers are Missing When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span></span>

<span data-ttu-id="e8c5a-219">**Figura 6**: intestazioni del gruppo di ordinamento mancanti durante l'ordinamento di un oggetto CheckBoxField ([fare clic per visualizzare l'immagine con dimensioni complete](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="e8c5a-219">**Figure 6**: The Sort Group Headers are Missing When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span></span>

<span data-ttu-id="e8c5a-220">Il motivo per cui le intestazioni del gruppo di ordinamento risultano mancanti durante l'ordinamento in base a un oggetto CheckBoxField è dato dal fatto che il codice utilizza attualmente solo la proprietà `Text` `TableCell` s per determinare il valore della colonna ordinata per ogni riga.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-220">The reason the sort group headers are missing when sorting by a CheckBoxField is because the code currently uses just the `TableCell` s `Text` property to determine the value of the sorted column for each row.</span></span> <span data-ttu-id="e8c5a-221">Per CheckBoxFields, la proprietà `Text` `TableCell` s è una stringa vuota. il valore è invece disponibile tramite un controllo Web CheckBox che risiede all'interno della raccolta di `Controls` `TableCell` s.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-221">For CheckBoxFields, the `TableCell` s `Text` property is an empty string; instead, the value is available through a CheckBox Web control that resides within the `TableCell` s `Controls` collection.</span></span>

<span data-ttu-id="e8c5a-222">Per gestire tipi di campo diversi da BoundField, è necessario aumentare il codice a cui è assegnata la variabile `currentValue` per verificare l'esistenza di una casella di controllo nella raccolta di `Controls` di `TableCell`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-222">To handle field types other than BoundFields, we need to augment the code where the `currentValue` variable is assigned to check for the existence of a CheckBox in the `TableCell` s `Controls` collection.</span></span> <span data-ttu-id="e8c5a-223">Anziché utilizzare `currentValue = gvr.Cells(sortColumnIndex).Text`, sostituire il codice con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="e8c5a-223">Instead of using `currentValue = gvr.Cells(sortColumnIndex).Text`, replace this code with the following:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample6.vb)]

<span data-ttu-id="e8c5a-224">Questo codice esamina la colonna ordinata `TableCell` per la riga corrente per determinare se sono presenti controlli nella raccolta di `Controls`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-224">This code examines the sorted column `TableCell` for the current row to determine if there are any controls in the `Controls` collection.</span></span> <span data-ttu-id="e8c5a-225">Se è presente e il primo controllo è una casella di controllo, la variabile `currentValue` è impostata su Yes o no, a seconda della proprietà `Checked` della casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-225">If there are, and the first control is a CheckBox, the `currentValue` variable is set to Yes or No, depending on the CheckBox s `Checked` property.</span></span> <span data-ttu-id="e8c5a-226">In caso contrario, il valore viene ricavato dalla proprietà `Text` di `TableCell`.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-226">Otherwise, the value is taken from the `TableCell` s `Text` property.</span></span> <span data-ttu-id="e8c5a-227">Questa logica può essere replicata per gestire l'ordinamento per qualsiasi TemplateFields che può esistere in GridView.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-227">This logic can be replicated to handle sorting for any TemplateFields that may exist in the GridView.</span></span>

<span data-ttu-id="e8c5a-228">Con l'aggiunta del codice precedente, le intestazioni del gruppo di ordinamento sono ora presenti durante l'ordinamento in base a CheckBoxField Discontinued (vedere la figura 7).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-228">With the above code addition, the sort group headers are now present when sorting by the Discontinued CheckBoxField (see Figure 7).</span></span>

<span data-ttu-id="e8c5a-229">[![le intestazioni del gruppo di ordinamento sono ora presenti durante l'ordinamento di un oggetto CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-229">[![The Sort Group Headers are Now Present When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span></span>

<span data-ttu-id="e8c5a-230">**Figura 7**: le intestazioni del gruppo di ordinamento sono ora presenti durante l'ordinamento di un oggetto CheckBoxField ([fare clic per visualizzare l'immagine con dimensioni complete](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="e8c5a-230">**Figure 7**: The Sort Group Headers are Now Present When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span></span>

> [!NOTE]
> <span data-ttu-id="e8c5a-231">Se si dispone di prodotti con `NULL` valori di database per i campi `CategoryID`, `SupplierID`o `UnitPrice`, tali valori verranno visualizzati come stringhe vuote in GridView per impostazione predefinita, vale a dire che il testo della riga separatore per quei prodotti con `NULL` valori verrà letto come Category: (ovvero, non esiste alcun nome dopo category: like con category: beverages).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-231">If you have products with `NULL` database values for the `CategoryID`, `SupplierID`, or `UnitPrice` fields, those values will appear as empty strings in the GridView by default, meaning the separator row s text for those products with `NULL` values will read like Category: (that is, there s no name after Category: like with Category: Beverages ).</span></span> <span data-ttu-id="e8c5a-232">Se si vuole che venga visualizzato un valore, è possibile impostare la proprietà BoundFields [`NullDisplayText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) sul testo da visualizzare oppure è possibile aggiungere un'istruzione condizionale nel metodo Render quando si assegnano i `currentValue` alla proprietà `Text` della riga del separatore.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-232">If you want a value displayed here you can either set the BoundFields [`NullDisplayText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) to the text you want displayed or you can add a conditional statement in the Render method when assigning the `currentValue` to the separator row s `Text` property.</span></span>

## <a name="summary"></a><span data-ttu-id="e8c5a-233">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="e8c5a-233">Summary</span></span>

<span data-ttu-id="e8c5a-234">GridView non include molte opzioni predefinite per la personalizzazione dell'interfaccia di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-234">The GridView does not include many built-in options for customizing the sorting interface.</span></span> <span data-ttu-id="e8c5a-235">Tuttavia, con un po' di codice di basso livello, è possibile modificare la gerarchia dei controlli di GridView per creare un'interfaccia più personalizzata.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-235">However, with a bit of low-level code, it s possible to tweak the GridView s control hierarchy to create a more customized interface.</span></span> <span data-ttu-id="e8c5a-236">In questa esercitazione è stato illustrato come aggiungere una riga di separatore del gruppo di ordinamento per un GridView ordinabile, che identifica più facilmente i limiti dei gruppi e dei gruppi distinti.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-236">In this tutorial we saw how to add a sort group separator row for a sortable GridView, which more easily identifies the distinct groups and those groups boundaries.</span></span> <span data-ttu-id="e8c5a-237">Per altri esempi di interfacce di ordinamento personalizzate, vedere il post di Blog relativo a [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [alcuni suggerimenti per l'ordinamento di ASP.NET 2,0 GridView](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) .</span><span class="sxs-lookup"><span data-stu-id="e8c5a-237">For additional examples of customized sorting interfaces, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A Few ASP.NET 2.0 GridView Sorting Tips and Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog entry.</span></span>

<span data-ttu-id="e8c5a-238">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="e8c5a-238">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="e8c5a-239">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="e8c5a-239">About the Author</span></span>

<span data-ttu-id="e8c5a-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e8c5a-241">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="e8c5a-241">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e8c5a-242">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-242">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e8c5a-243">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e8c5a-243">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="e8c5a-244">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="e8c5a-244">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="e8c5a-245">Precedente</span><span class="sxs-lookup"><span data-stu-id="e8c5a-245">Previous</span></span>](sorting-custom-paged-data-vb.md)
