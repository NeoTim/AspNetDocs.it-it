---
uid: web-forms/overview/data-access/masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb
title: Master/dettaglio con Master GridView selezionabile e un controllo DetailView per i dettagli (VB) | Microsoft Docs
author: rick-anderson
description: Questa esercitazione sarà necessario un controllo GridView cui righe includono il nome e il prezzo di ogni prodotto insieme a un pulsante di selezione. Facendo clic sul pulsante Seleziona per un particu...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 1d1a7c93-971d-4690-9c5e-dac0e5014a09
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb
msc.type: authoredcontent
ms.openlocfilehash: 0bf724741ffbc01aa7611d8b075d89827bf83777
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/01/2019
ms.locfileid: "57041928"
---
<a name="masterdetail-using-a-selectable-master-gridview-with-a-details-detailview-vb"></a><span data-ttu-id="4c327-104">Report master o di dettaglio con un controllo GridView master selezionabile e un controllo DetailView per i dettagli (VB)</span><span class="sxs-lookup"><span data-stu-id="4c327-104">Master/Detail Using a Selectable Master GridView with a Details DetailView (VB)</span></span>
====================
<span data-ttu-id="4c327-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4c327-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4c327-106">[Scaricare l'App di esempio](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_10_VB.exe) o [Scarica il PDF](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/datatutorial10vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="4c327-106">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_10_VB.exe) or [Download PDF](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/datatutorial10vb1.pdf)</span></span>

> <span data-ttu-id="4c327-107">Questa esercitazione sarà necessario un controllo GridView cui righe includono il nome e il prezzo di ogni prodotto insieme a un pulsante di selezione.</span><span class="sxs-lookup"><span data-stu-id="4c327-107">This tutorial will have a GridView whose rows include the name and price of each product along with a Select button.</span></span> <span data-ttu-id="4c327-108">Facendo clic sul pulsante Seleziona per un determinato prodotto comporterà i dettagli completi da visualizzare nel controllo DetailsView nella stessa pagina.</span><span class="sxs-lookup"><span data-stu-id="4c327-108">Clicking the Select button for a particular product will cause its full details to be displayed in a DetailsView control on the same page.</span></span>


## <a name="introduction"></a><span data-ttu-id="4c327-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="4c327-109">Introduction</span></span>

<span data-ttu-id="4c327-110">Nel [esercitazione precedente](master-detail-filtering-across-two-pages-vb.md) è stato illustrato come creare un report master-Details mediante due pagine web: una pagina web "master", da cui è visualizzato l'elenco di fornitori e una pagina web "Dettagli" elencati questi prodotti forniti dall'oggetto selezionato fornitore.</span><span class="sxs-lookup"><span data-stu-id="4c327-110">In the [previous tutorial](master-detail-filtering-across-two-pages-vb.md) we saw how to create a master/detail report using two web pages: a "master" web page, from which we displayed the list of suppliers; and a "details" web page that listed those products provided by the selected supplier.</span></span> <span data-ttu-id="4c327-111">È preferibile ridurre questo formato di report di due pagine in un'unica pagina.</span><span class="sxs-lookup"><span data-stu-id="4c327-111">This two page report format can be condensed into one page.</span></span> <span data-ttu-id="4c327-112">Questa esercitazione sarà necessario un controllo GridView cui righe includono il nome e il prezzo di ogni prodotto insieme a un pulsante di selezione.</span><span class="sxs-lookup"><span data-stu-id="4c327-112">This tutorial will have a GridView whose rows include the name and price of each product along with a Select button.</span></span> <span data-ttu-id="4c327-113">Facendo clic sul pulsante Seleziona per un determinato prodotto comporterà i dettagli completi da visualizzare nel controllo DetailsView nella stessa pagina.</span><span class="sxs-lookup"><span data-stu-id="4c327-113">Clicking the Select button for a particular product will cause its full details to be displayed in a DetailsView control on the same page.</span></span>


<span data-ttu-id="4c327-114">[![Fare clic sul pulsante Seleziona Visualizza i dettagli del prodotto](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image2.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-114">[![Clicking the Select Button Displays the Product's Details](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image2.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image1.png)</span></span>

<span data-ttu-id="4c327-115">**Figura 1**: Fare clic sul pulsante Seleziona Visualizza i dettagli del prodotto ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-115">**Figure 1**: Clicking the Select Button Displays the Product's Details ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image3.png))</span></span>


## <a name="step-1-creating-a-selectable-gridview"></a><span data-ttu-id="4c327-116">Passaggio 1: Creazione di un controllo GridView selezionabile</span><span class="sxs-lookup"><span data-stu-id="4c327-116">Step 1: Creating a Selectable GridView</span></span>

<span data-ttu-id="4c327-117">Tenere presente che nei due pagine master/dettagli del report che ogni record master incluso un collegamento ipertestuale che, quando si fa clic, inviati l'utente alla pagina dei dettagli del passaggio della riga selezionata `SupplierID` valore nella stringa di query.</span><span class="sxs-lookup"><span data-stu-id="4c327-117">Recall that in the two-page master/detail report that each master record included a hyperlink that, when clicked, sent the user to the details page passing the clicked row's `SupplierID` value in the querystring.</span></span> <span data-ttu-id="4c327-118">Tale collegamento è stato aggiunto a ogni riga GridView mediante un HyperLinkField.</span><span class="sxs-lookup"><span data-stu-id="4c327-118">Such a hyperlink was added to each GridView row using a HyperLinkField.</span></span> <span data-ttu-id="4c327-119">Affinché il rapporto master/dettagli pagina singola, è necessario per ogni controllo GridView di riga che, quando si fa clic, viene visualizzato un pulsante i dettagli.</span><span class="sxs-lookup"><span data-stu-id="4c327-119">For the single page master/details report, we will need a Button for each GridView row that, when clicked, shows the details.</span></span> <span data-ttu-id="4c327-120">Il controllo GridView può essere configurato per includere un pulsante Seleziona per ogni riga che determina un postback e tale riga viene contrassegnata come di GridView [SelectedRow](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedrow.aspx).</span><span class="sxs-lookup"><span data-stu-id="4c327-120">The GridView control can be configured to include a Select button for each row that causes a postback and marks that row as the GridView's [SelectedRow](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedrow.aspx).</span></span>

<span data-ttu-id="4c327-121">Iniziare aggiungendo un controllo GridView per il `DetailsBySelecting.aspx` nella pagina la `Filtering` cartella, l'impostazione relativa `ID` proprietà `ProductsGrid`.</span><span class="sxs-lookup"><span data-stu-id="4c327-121">Start by adding a GridView control to the `DetailsBySelecting.aspx` page in the `Filtering` folder, setting its `ID` property to `ProductsGrid`.</span></span> <span data-ttu-id="4c327-122">Successivamente, aggiungere un nuovo oggetto ObjectDataSource denominato `AllProductsDataSource` che richiama la `ProductsBLL` della classe `GetProducts()` (metodo).</span><span class="sxs-lookup"><span data-stu-id="4c327-122">Next, add a new ObjectDataSource named `AllProductsDataSource` that invokes the `ProductsBLL` class's `GetProducts()` method.</span></span>


<span data-ttu-id="4c327-123">[![Creare un oggetto ObjectDataSource denominato AllProductsDataSource](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image5.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-123">[![Create an ObjectDataSource Named AllProductsDataSource](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image5.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image4.png)</span></span>

<span data-ttu-id="4c327-124">**Figura 2**: Creare una Named ObjectDataSource `AllProductsDataSource` ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-124">**Figure 2**: Create an ObjectDataSource Named `AllProductsDataSource` ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image6.png))</span></span>


<span data-ttu-id="4c327-125">[![Usare la classe ProductsBLL](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image8.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-125">[![Use the ProductsBLL Class](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image8.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image7.png)</span></span>

<span data-ttu-id="4c327-126">**Figura 3**: Usare la `ProductsBLL` classe ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-126">**Figure 3**: Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image9.png))</span></span>


<span data-ttu-id="4c327-127">[![Configurare ObjectDataSource per richiamare il metodo GetProducts()](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image11.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-127">[![Configure the ObjectDataSource to Invoke the GetProducts() Method](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image11.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image10.png)</span></span>

<span data-ttu-id="4c327-128">**Figura 4**: Configurare ObjectDataSource per richiamare il `GetProducts()` metodo ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-128">**Figure 4**: Configure the ObjectDataSource to Invoke the `GetProducts()` Method ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image12.png))</span></span>


<span data-ttu-id="4c327-129">Modificare i campi di GridView rimuovendo tutto tranne le `ProductName` e `UnitPrice` BoundField.</span><span class="sxs-lookup"><span data-stu-id="4c327-129">Edit the GridView's fields removing all but the `ProductName` and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="4c327-130">Inoltre, è possibile personalizzare questi BoundField in base alle esigenze, ad esempio la formattazione il `UnitPrice` BoundField come valuta e modificando il `HeaderText` le proprietà dei BoundField.</span><span class="sxs-lookup"><span data-stu-id="4c327-130">Also, feel free to customize these BoundFields as needed, such as formatting the `UnitPrice` BoundField as a currency and changing the `HeaderText` properties of the BoundFields.</span></span> <span data-ttu-id="4c327-131">Questi passaggi possono essere eseguiti in formato grafico facendo clic sul collegamento Modifica colonne dallo smart tag del controllo GridView, o configurare manualmente la sintassi dichiarativa.</span><span class="sxs-lookup"><span data-stu-id="4c327-131">These steps can be accomplished graphically, by clicking the Edit Columns link from the GridView's smart tag, or by manually configuring the declarative syntax.</span></span>


<span data-ttu-id="4c327-132">[![Rimuovi tutto tranne il ProductName e un BoundField UnitPrice](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image14.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-132">[![Remove All But the ProductName and UnitPrice BoundFields](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image14.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image13.png)</span></span>

<span data-ttu-id="4c327-133">**Figura 5**: Rimuovere tutti, ma il `ProductName` e `UnitPrice` BoundField ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-133">**Figure 5**: Remove All But the `ProductName` and `UnitPrice` BoundFields ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image15.png))</span></span>


<span data-ttu-id="4c327-134">Il markup finale per il controllo GridView è:</span><span class="sxs-lookup"><span data-stu-id="4c327-134">The final markup for the GridView is:</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample1.aspx)]

<span data-ttu-id="4c327-135">Successivamente, è necessario contrassegnare il controllo GridView come selezionabile, che consentirà di aggiungere un pulsante Seleziona per ciascuna riga.</span><span class="sxs-lookup"><span data-stu-id="4c327-135">Next, we need to mark the GridView as selectable, which will add a Select button to each row.</span></span> <span data-ttu-id="4c327-136">A tale scopo, è sufficiente selezionare la casella di controllo di selezione attiva nello smart tag del controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="4c327-136">To accomplish this, simply check the Enable Selection checkbox in the GridView's smart tag.</span></span>


<span data-ttu-id="4c327-137">[![Rendere selezionabile righe del controllo GridView](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image17.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-137">[![Make the GridView's Rows Selectable](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image17.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image16.png)</span></span>

<span data-ttu-id="4c327-138">**Figura 6**: Rendere selezionabile di righe del controllo GridView ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-138">**Figure 6**: Make the GridView's Rows Selectable ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image18.png))</span></span>


<span data-ttu-id="4c327-139">Selezionando l'opzione di abilitazione della selezione viene aggiunto un CommandField per il `ProductsGrid` GridView con relativo `ShowSelectButton` proprietà è impostata su True.</span><span class="sxs-lookup"><span data-stu-id="4c327-139">Checking the Enabling Selection option adds a CommandField to the `ProductsGrid` GridView with its `ShowSelectButton` property set to True.</span></span> <span data-ttu-id="4c327-140">Ciò comporta un pulsante Seleziona per ciascuna riga di GridView, come illustrato nella figura 6.</span><span class="sxs-lookup"><span data-stu-id="4c327-140">This results in a Select button for each row of the GridView, as Figure 6 illustrates.</span></span> <span data-ttu-id="4c327-141">Per impostazione predefinita, vengono visualizzati i pulsanti di selezione come LinkButton, ma è possibile usare i pulsanti o ImageButtons invece tramite la CommandField `ButtonType` proprietà.</span><span class="sxs-lookup"><span data-stu-id="4c327-141">By default, the Select buttons are rendered as LinkButtons, but you can use Buttons or ImageButtons instead through the CommandField's `ButtonType` property.</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample2.aspx)]

<span data-ttu-id="4c327-142">Quando si fa clic sul pulsante di selezione di una riga GridView un postback previsioni e del controllo GridView `SelectedRow` proprietà viene aggiornata.</span><span class="sxs-lookup"><span data-stu-id="4c327-142">When a GridView row's Select button is clicked a postback ensues and the GridView's `SelectedRow` property is updated.</span></span> <span data-ttu-id="4c327-143">Oltre al `SelectedRow` fornisce il controllo GridView di proprietà, il [SelectedIndex](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedindex%28VS.80%29.aspx), [SelectedValue](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedvalue%28VS.80%29.aspx), e [SelectedDataKey](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selecteddatakey%28VS.80%29.aspx) proprietà.</span><span class="sxs-lookup"><span data-stu-id="4c327-143">In addition to the `SelectedRow` property, the GridView provides the [SelectedIndex](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedindex%28VS.80%29.aspx), [SelectedValue](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedvalue%28VS.80%29.aspx), and [SelectedDataKey](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selecteddatakey%28VS.80%29.aspx) properties.</span></span> <span data-ttu-id="4c327-144">Il `SelectedIndex` proprietà restituisce l'indice della riga selezionata, mentre la `SelectedValue` e `SelectedDataKey` restituiscono valori in base al GridView [DataKeyNames proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames%28VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="4c327-144">The `SelectedIndex` property returns the index of the selected row, whereas the `SelectedValue` and `SelectedDataKey` properties return values based upon the GridView's [DataKeyNames property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames%28VS.80%29.aspx).</span></span>

<span data-ttu-id="4c327-145">Il `DataKeyNames` proprietà viene utilizzata per associare uno o più campi dati valori o con ogni riga e viene comunemente usato per le informazioni di identificazione univoca dei dati sottostanti con ogni riga GridView degli attributi.</span><span class="sxs-lookup"><span data-stu-id="4c327-145">The `DataKeyNames` property is used to associate one or more data field values with each row and is commonly used to attribute uniquely identifying information from the underlying data with each GridView row.</span></span> <span data-ttu-id="4c327-146">Il `SelectedValue` proprietà restituisce il valore del primo `DataKeyNames` campo di dati per la riga selezionata mentre il `SelectedDataKey` proprietà restituisce la riga selezionata `DataKey` oggetto che contiene tutti i valori per i campi di chiave specificati dati per tale riga.</span><span class="sxs-lookup"><span data-stu-id="4c327-146">The `SelectedValue` property returns the value of the first `DataKeyNames` data field for the selected row where as the `SelectedDataKey` property returns the selected row's `DataKey` object, which contains all of the values for the specified data key fields for that row.</span></span>

<span data-ttu-id="4c327-147">Il `DataKeyNames` proprietà viene impostata automaticamente per i campi di dati che identifica in modo univoco quando si associa un'origine dati a un GridView, DetailsView e FormView tramite la finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="4c327-147">The `DataKeyNames` property is automatically set to the uniquely-identifying data field(s) when you bind a data source to a GridView, DetailsView, or FormView through the Designer.</span></span> <span data-ttu-id="4c327-148">Anche se questa proprietà è stata impostata per noi automaticamente nelle esercitazioni precedenti, gli esempi avrebbe avuto esito positivo senza il `DataKeyNames` proprietà specificata.</span><span class="sxs-lookup"><span data-stu-id="4c327-148">While this property has been set for us automatically in the preceding tutorials, the examples would have worked without the `DataKeyNames` property specified.</span></span> <span data-ttu-id="4c327-149">Tuttavia, per il controllo GridView selezionabili in questa esercitazione, nonché per in cui si verrà esaminando inserimento, aggiornamento ed eliminazione, nelle esercitazioni successive il `DataKeyNames` deve essere impostata correttamente.</span><span class="sxs-lookup"><span data-stu-id="4c327-149">However, for the selectable GridView in this tutorial, as well as for future tutorials in which we'll be examining inserting, updating, and deleting, the `DataKeyNames` property must be set properly.</span></span> <span data-ttu-id="4c327-150">Si consiglia di verificare che i GridView `DataKeyNames` è impostata su `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="4c327-150">Take a moment to ensure that your GridView's `DataKeyNames` property is set to `ProductID`.</span></span>

<span data-ttu-id="4c327-151">È possibile visualizzare lo stato di avanzamento fino a quel momento tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="4c327-151">Let's view our progress thus far through a browser.</span></span> <span data-ttu-id="4c327-152">Si noti che il controllo GridView sono elencati il nome e il prezzo per tutti i prodotti con un controllo LinkButton selezionare.</span><span class="sxs-lookup"><span data-stu-id="4c327-152">Note that the GridView lists the name and price for all of the products along with a Select LinkButton.</span></span> <span data-ttu-id="4c327-153">Fare clic sul pulsante Select determina un postback.</span><span class="sxs-lookup"><span data-stu-id="4c327-153">Clicking the Select button causes a postback.</span></span> <span data-ttu-id="4c327-154">Nel passaggio 2 vedremo come disporre un controllo DetailsView possa rispondere il postback visualizzando i dettagli per il prodotto selezionato.</span><span class="sxs-lookup"><span data-stu-id="4c327-154">In Step 2 we'll see how to have a DetailsView respond to this postback by displaying the details for the selected product.</span></span>


<span data-ttu-id="4c327-155">[![Ogni riga del prodotto contiene un controllo LinkButton selezionare](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image20.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-155">[![Each Product Row Contains a Select LinkButton](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image20.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image19.png)</span></span>

<span data-ttu-id="4c327-156">**Figura 7**: Ogni riga del prodotto contiene un controllo LinkButton selezionare ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-156">**Figure 7**: Each Product Row Contains a Select LinkButton ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image21.png))</span></span>


## <a name="highlighting-the-selected-row"></a><span data-ttu-id="4c327-157">L'evidenziazione della riga selezionata</span><span class="sxs-lookup"><span data-stu-id="4c327-157">Highlighting the Selected Row</span></span>

<span data-ttu-id="4c327-158">Il `ProductsGrid` include anche un `SelectedRowStyle` proprietà che può essere usata per determinare lo stile di visualizzazione per la riga selezionata.</span><span class="sxs-lookup"><span data-stu-id="4c327-158">The `ProductsGrid` GridView has a `SelectedRowStyle` property that can be used to dictate the visual style for the selected row.</span></span> <span data-ttu-id="4c327-159">Utilizzata in modo corretto, ciò può migliorare l'esperienza dell'utente mostrando più chiaramente quale riga di GridView attualmente selezionata.</span><span class="sxs-lookup"><span data-stu-id="4c327-159">Used properly, this can improve the user's experience by more clearly showing which row of the GridView is currently selected.</span></span> <span data-ttu-id="4c327-160">Per questa esercitazione, è possibile avere la riga selezionata evidenziata con uno sfondo giallo.</span><span class="sxs-lookup"><span data-stu-id="4c327-160">For this tutorial, let's have the selected row be highlighted with a yellow background.</span></span>

<span data-ttu-id="4c327-161">Come con le esercitazioni precedenti, si impegna a mantenere le impostazioni relative alla estetici definite come classi CSS.</span><span class="sxs-lookup"><span data-stu-id="4c327-161">As with our earlier tutorials, let's strive to keep the aesthetic-related settings defined as CSS classes.</span></span> <span data-ttu-id="4c327-162">Pertanto, creare una nuova classe CSS `Styles.css` denominato `SelectedRowStyle`.</span><span class="sxs-lookup"><span data-stu-id="4c327-162">Therefore, create a new CSS class in `Styles.css` named `SelectedRowStyle`.</span></span>


[!code-css[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample3.css)]

<span data-ttu-id="4c327-163">Da questa classe CSS da applicare il `SelectedRowStyle` proprietà di *tutti* GridView nella nostra serie di esercitazioni, modificare il `GridView.skin` interfaccia personalizzata nel `DataWebControls` tema per includere il `SelectedRowStyle` impostazioni come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="4c327-163">To apply this CSS class to the `SelectedRowStyle` property of *all* GridViews in our tutorial series, edit the `GridView.skin` Skin in the `DataWebControls` Theme to include the `SelectedRowStyle` settings as shown below:</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample4.aspx)]

<span data-ttu-id="4c327-164">Grazie a questa aggiunta, la riga selezionata di GridView a questo punto verrà evidenziata da un colore di sfondo giallo.</span><span class="sxs-lookup"><span data-stu-id="4c327-164">With this addition, the selected GridView row is now highlighted with a yellow background color.</span></span>


<span data-ttu-id="4c327-165">[![Personalizzare l'aspetto della riga selezionata tramite proprietà SelectedRowStyle di GridView](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image23.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-165">[![Customize the Selected Row's Appearance Using the GridView's SelectedRowStyle Property](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image23.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image22.png)</span></span>

<span data-ttu-id="4c327-166">**Figura 8**: Personalizzare usando l'aspetto della riga selezionata di GridView `SelectedRowStyle` proprietà ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-166">**Figure 8**: Customize the Selected Row's Appearance Using the GridView's `SelectedRowStyle` Property ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image24.png))</span></span>


## <a name="step-2-displaying-the-selected-products-details-in-a-detailsview"></a><span data-ttu-id="4c327-167">Passaggio 2: Visualizzazione dei dettagli del prodotto selezionato in un controllo DetailsView</span><span class="sxs-lookup"><span data-stu-id="4c327-167">Step 2: Displaying the Selected Product's Details in a DetailsView</span></span>

<span data-ttu-id="4c327-168">Con la `ProductsGrid` completare GridView, tutto ciò che resta consiste nell'aggiungere un controllo DetailsView che visualizza le informazioni del prodotto specifico selezionato.</span><span class="sxs-lookup"><span data-stu-id="4c327-168">With the `ProductsGrid` GridView complete, all that remains is to add a DetailsView that displays information about the particular product selected.</span></span> <span data-ttu-id="4c327-169">Aggiungere un controllo DetailsView sopra il controllo GridView e creare un nuovo oggetto ObjectDataSource denominato `ProductDetailsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="4c327-169">Add a DetailsView control above the GridView and create a new ObjectDataSource named `ProductDetailsDataSource`.</span></span> <span data-ttu-id="4c327-170">Poiché si desidera che questa DetailsView per visualizzare determinate informazioni relative al prodotto selezionato, configurare il `ProductDetailsDataSource` usare il `ProductsBLL` della classe `GetProductByProductID(productID)` (metodo).</span><span class="sxs-lookup"><span data-stu-id="4c327-170">Since we want this DetailsView to display particular information about the selected product, configure the `ProductDetailsDataSource` to use the `ProductsBLL` class's `GetProductByProductID(productID)` method.</span></span>


<span data-ttu-id="4c327-171">[![Richiamare metodo della classe GetProductByProductID(productID) ProductsBLL](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image26.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-171">[![Invoke the ProductsBLL Class's GetProductByProductID(productID) Method](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image26.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image25.png)</span></span>

<span data-ttu-id="4c327-172">**Figura 9**: Richiama il `ProductsBLL` della classe `GetProductByProductID(productID)` metodo ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-172">**Figure 9**: Invoke the `ProductsBLL` Class's `GetProductByProductID(productID)` Method ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image27.png))</span></span>


<span data-ttu-id="4c327-173">Disporre le *`productID`* valore del parametro ottenuto dalla proprietà del controllo GridView `SelectedValue` proprietà.</span><span class="sxs-lookup"><span data-stu-id="4c327-173">Have the *`productID`* parameter's value obtained from the GridView control's `SelectedValue` property.</span></span> <span data-ttu-id="4c327-174">Come accennato in precedenza, il controllo GridView `SelectedValue` proprietà restituisce il primo valore chiave dati per la riga selezionata.</span><span class="sxs-lookup"><span data-stu-id="4c327-174">As we discussed earlier, the GridView's `SelectedValue` property returns the first data key value for the selected row.</span></span> <span data-ttu-id="4c327-175">Pertanto, è fondamentale che il controllo GridView `DataKeyNames` è impostata su `ProductID`, in modo che la riga selezionata `ProductID` valore viene restituito da `SelectedValue`.</span><span class="sxs-lookup"><span data-stu-id="4c327-175">Therefore, it's imperative that the GridView's `DataKeyNames` property is set to `ProductID`, so that the selected row's `ProductID` value is returned by `SelectedValue`.</span></span>


<span data-ttu-id="4c327-176">[![Impostare il parametro productID alla proprietà SelectedValue di GridView](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image29.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-176">[![Set the productID Parameter to the GridView's SelectedValue Property](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image29.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image28.png)</span></span>

<span data-ttu-id="4c327-177">**Figura 10**: Impostare il *`productID`* parametro per il controllo GridView `SelectedValue` proprietà ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-177">**Figure 10**: Set the *`productID`* Parameter to the GridView's `SelectedValue` Property ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image30.png))</span></span>


<span data-ttu-id="4c327-178">Una volta il `productDetailsDataSource` ObjectDataSource è stato configurato correttamente e associato a DetailsView, questa esercitazione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="4c327-178">Once the `productDetailsDataSource` ObjectDataSource has been configured correctly and bound to the DetailsView, this tutorial is complete!</span></span> <span data-ttu-id="4c327-179">Quando la pagina viene prima visitata è selezionata alcuna riga, pertanto il GridView `SelectedValue` restituisce proprietà `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="4c327-179">When the page is first visited no row is selected, so the GridView's `SelectedValue` property returns `Nothing`.</span></span> <span data-ttu-id="4c327-180">Poiché non sono presenti prodotti con un `NULL` `ProductID` valore, viene restituito alcun record per il `GetProductByProductID(productID)` metodo, vale a dire che non viene visualizzato il controllo DetailsView (vedere la figura 11).</span><span class="sxs-lookup"><span data-stu-id="4c327-180">Since there are no products with a `NULL` `ProductID` value, no records are returned by the `GetProductByProductID(productID)` method, meaning that the DetailsView isn't displayed (see Figure 11).</span></span> <span data-ttu-id="4c327-181">Facendo clic sul pulsante di selezione di una riga GridView, un postback previsioni e DetailsView viene aggiornato.</span><span class="sxs-lookup"><span data-stu-id="4c327-181">Upon clicking a GridView row's Select button, a postback ensues and the DetailsView is refreshed.</span></span> <span data-ttu-id="4c327-182">Si time del controllo GridView `SelectedValue` proprietà restituisce il `ProductID` della riga selezionata, il `GetProductByProductID(productID)` metodo restituisce un `ProductsDataTable` con informazioni su quel particolare prodotto e DetailsView Mostra questi dettagli (vedere la figura 12).</span><span class="sxs-lookup"><span data-stu-id="4c327-182">This time the GridView's `SelectedValue` property returns the `ProductID` of the selected row, the `GetProductByProductID(productID)` method returns a `ProductsDataTable` with information about that particular product, and the DetailsView shows these details (see Figure 12).</span></span>


<span data-ttu-id="4c327-183">[![Quando viene visualizzata prima visita, solo il controllo GridView](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image32.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-183">[![When First Visited, Only the GridView is Displayed](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image32.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image31.png)</span></span>

<span data-ttu-id="4c327-184">**Figura 11**: Alla prima visita, viene visualizzato solo il controllo GridView ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-184">**Figure 11**: When First Visited, Only the GridView is Displayed ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image33.png))</span></span>


<span data-ttu-id="4c327-185">[![Dopo aver selezionato una riga, vengono visualizzati i dettagli del prodotto](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image35.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="4c327-185">[![Upon Selecting a Row, the Product's Details are Displayed](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image35.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image34.png)</span></span>

<span data-ttu-id="4c327-186">**Figura 12**: Dopo aver selezionato una riga, vengono visualizzati i dettagli del prodotto ([fare clic per visualizzare l'immagine con dimensioni normali](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="4c327-186">**Figure 12**: Upon Selecting a Row, the Product's Details are Displayed ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image36.png))</span></span>


## <a name="summary"></a><span data-ttu-id="4c327-187">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="4c327-187">Summary</span></span>

<span data-ttu-id="4c327-188">In questo e le tre esercitazioni precedenti abbiamo visto una serie di tecniche per la visualizzazione dei report master o di dettaglio.</span><span class="sxs-lookup"><span data-stu-id="4c327-188">In this and the preceding three tutorials we've seen a number of techniques for displaying master/detail reports.</span></span> <span data-ttu-id="4c327-189">In questa esercitazione che sono stati esaminati con GridView selezionabile per ospitare i record master e un DetailsView per visualizzare i dettagli del record master selezionato nella stessa pagina.</span><span class="sxs-lookup"><span data-stu-id="4c327-189">In this tutorial we examined using a selectable GridView to house the master records and a DetailsView to display details about the selected master record on the same page.</span></span> <span data-ttu-id="4c327-190">Nelle esercitazioni precedenti è stato descritto come visualizzare i report master-details mediante controlli DropDownList e sulla visualizzazione di record master in una pagina web e i record di dettaglio in un altro.</span><span class="sxs-lookup"><span data-stu-id="4c327-190">In the earlier tutorials we looked at how to display master/details reports using DropDownLists and displaying master records on one web page and detail records on another.</span></span>

<span data-ttu-id="4c327-191">Questa esercitazione è terminata l'esame del report master o di dettaglio.</span><span class="sxs-lookup"><span data-stu-id="4c327-191">This tutorial concludes our examination of master/detail reports.</span></span> <span data-ttu-id="4c327-192">Inizia con l'esercitazione successiva inizieremo l'esplorazione della formattazione personalizzata con il controllo GridView, DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="4c327-192">Starting with the next tutorial we'll begin our exploration of customized formatting with the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="4c327-193">Si vedrà come personalizzare l'aspetto di questi controlli in base ai dati associati ad essi, come riepilogare i dati in un piè di pagina del controllo GridView e come usare i modelli per ottenere un maggiore grado di controllare il layout.</span><span class="sxs-lookup"><span data-stu-id="4c327-193">We'll see how to customize the appearance of these controls based on the data bound to them, how to summarize data in the GridView's footer, and how to use templates to obtain a greater degree of control over the layout.</span></span>

<span data-ttu-id="4c327-194">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="4c327-194">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="4c327-195">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="4c327-195">About the Author</span></span>

<span data-ttu-id="4c327-196">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="4c327-196">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4c327-197">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="4c327-197">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4c327-198">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="4c327-198">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="4c327-199">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4c327-199">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="4c327-200">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="4c327-200">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="4c327-201">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="4c327-201">Special Thanks To</span></span>

<span data-ttu-id="4c327-202">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="4c327-202">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="4c327-203">Hilton Giesenow, revisore per questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="4c327-203">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="4c327-204">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="4c327-204">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="4c327-205">In questo caso, Inviami una riga in corrispondenza [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4c327-205">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="4c327-206">Precedente</span><span class="sxs-lookup"><span data-stu-id="4c327-206">Previous</span></span>](master-detail-filtering-across-two-pages-vb.md)
