---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
title: Filtro master/dettagli con due DropDownList (VB) | Microsoft Docs
author: rick-anderson
description: Questa esercitazione espande la relazione Master/Detail per aggiungere un terzo livello, usando due controlli DropDownList per selezionare le recor padre e padre desiderate...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 11ae4f64-01ba-4823-95f4-a2fe1f84f7d7
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
msc.type: authoredcontent
ms.openlocfilehash: 166d6a7664a326361dc2a3f115eddb988cd39d20
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78528497"
---
# <a name="masterdetail-filtering-with-two-dropdownlists-vb"></a><span data-ttu-id="6a1df-103">Applicazione di filtri al report master o di dettaglio usando due controlli DropDownList (VB)</span><span class="sxs-lookup"><span data-stu-id="6a1df-103">Master/Detail Filtering With Two DropDownLists (VB)</span></span>

<span data-ttu-id="6a1df-104">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6a1df-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6a1df-105">[Scaricare l'app di esempio](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe) o [scaricare il file PDF](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="6a1df-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe) or [Download PDF](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span></span>

> <span data-ttu-id="6a1df-106">Questa esercitazione espande la relazione Master/Detail per aggiungere un terzo livello, usando due controlli DropDownList per selezionare i record padre e nonni desiderati.</span><span class="sxs-lookup"><span data-stu-id="6a1df-106">This tutorial expands the master/detail relationship to add a third layer, using two DropDownList controls to select the desired parent and grandparent records.</span></span>

## <a name="introduction"></a><span data-ttu-id="6a1df-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="6a1df-107">Introduction</span></span>

<span data-ttu-id="6a1df-108">Nell' [esercitazione precedente](master-detail-filtering-with-a-dropdownlist-vb.md) è stato illustrato come visualizzare un semplice report master/dettagli utilizzando un singolo oggetto DropDownList popolato con le categorie e un controllo GridView che mostra i prodotti che appartengono alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="6a1df-108">In the [previous tutorial](master-detail-filtering-with-a-dropdownlist-vb.md) we examined how to display a simple master/details report using a single DropDownList populated with the categories and a GridView showing those products that belong to the selected category.</span></span> <span data-ttu-id="6a1df-109">Questo modello di report funziona correttamente quando si visualizzano i record che hanno una relazione uno-a-molti e possono essere facilmente estesi per funzionare per gli scenari che includono più relazioni uno-a-molti.</span><span class="sxs-lookup"><span data-stu-id="6a1df-109">This report pattern works well when displaying records that have a one-to-many relationship and can easily be extended to work for scenarios that include multiple one-to-many relationships.</span></span> <span data-ttu-id="6a1df-110">Ad esempio, un sistema di immissione degli ordini avrebbe tabelle che corrispondono a clienti, ordini e voci dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="6a1df-110">For example, an order entry system would have tables that correspond to customers, orders, and order line items.</span></span> <span data-ttu-id="6a1df-111">Un determinato cliente può disporre di più ordini con ogni ordine costituito da più elementi.</span><span class="sxs-lookup"><span data-stu-id="6a1df-111">A given customer may have multiple orders with each order consisting of multiple items.</span></span> <span data-ttu-id="6a1df-112">Tali dati possono essere presentati all'utente con due DropDownList e un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="6a1df-112">Such data can be presented to the user with two DropDownLists and a GridView.</span></span> <span data-ttu-id="6a1df-113">Il primo DropDownList avrà una voce di elenco per ogni cliente nel database il cui contenuto è quello del secondo, ovvero gli ordini effettuati dal cliente selezionato.</span><span class="sxs-lookup"><span data-stu-id="6a1df-113">The first DropDownList would have a list item for each customer in the database with the second one's contents being the orders placed by the selected customer.</span></span> <span data-ttu-id="6a1df-114">Un controllo GridView elenca le voci dell'ordine selezionato.</span><span class="sxs-lookup"><span data-stu-id="6a1df-114">A GridView would list the line items from the selected order.</span></span>

<span data-ttu-id="6a1df-115">Sebbene il database Northwind includa le informazioni canoniche relative a clienti/ordini/ordini nelle tabelle `Customers`, `Orders`e `Order Details`, queste tabelle non vengono acquisite nell'architettura.</span><span class="sxs-lookup"><span data-stu-id="6a1df-115">While the Northwind database include the canonical customer/order/order details information in its `Customers`, `Orders`, and `Order Details` tables, these tables aren't captured in our architecture.</span></span> <span data-ttu-id="6a1df-116">Tuttavia, è comunque possibile illustrare l'utilizzo di due DropDownList dipendenti.</span><span class="sxs-lookup"><span data-stu-id="6a1df-116">Nonetheless, we can still illustrate using two dependent DropDownLists.</span></span> <span data-ttu-id="6a1df-117">Il primo DropDownList elenca le categorie e la seconda i prodotti appartenenti alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="6a1df-117">The first DropDownList will list the categories and the second the products belonging to the selected category.</span></span> <span data-ttu-id="6a1df-118">In un DetailsView vengono elencati i dettagli del prodotto selezionato.</span><span class="sxs-lookup"><span data-stu-id="6a1df-118">A DetailsView will then list the details of the selected product.</span></span>

## <a name="step-1-creating-and-populating-the-categories-dropdownlist"></a><span data-ttu-id="6a1df-119">Passaggio 1: creazione e popolamento del DropDownList categorie</span><span class="sxs-lookup"><span data-stu-id="6a1df-119">Step 1: Creating and Populating the Categories DropDownList</span></span>

<span data-ttu-id="6a1df-120">Il primo obiettivo consiste nell'aggiungere il DropDownList che elenca le categorie.</span><span class="sxs-lookup"><span data-stu-id="6a1df-120">Our first goal is to add the DropDownList that lists the categories.</span></span> <span data-ttu-id="6a1df-121">Questi passaggi sono stati esaminati in dettaglio nell'esercitazione precedente, ma sono riepilogati qui per completezza.</span><span class="sxs-lookup"><span data-stu-id="6a1df-121">These steps were examined in detail in the preceding tutorial, but are summarized here for completeness.</span></span>

<span data-ttu-id="6a1df-122">Aprire la pagina `MasterDetailsDetails.aspx` nella cartella `Filtering`, aggiungere un oggetto DropDownList alla pagina, impostare la relativa proprietà `ID` su `Categories`e quindi fare clic sul collegamento Configura origine dati nello smart tag.</span><span class="sxs-lookup"><span data-stu-id="6a1df-122">Open the `MasterDetailsDetails.aspx` page in the `Filtering` folder, add a DropDownList to the page, set its `ID` property to `Categories`, and then click the Configure Data Source link in its smart tag.</span></span> <span data-ttu-id="6a1df-123">Dalla configurazione guidata origine dati scegliere di aggiungere una nuova origine dati.</span><span class="sxs-lookup"><span data-stu-id="6a1df-123">From the Data Source Configuration Wizard choose to add a new data source.</span></span>

<span data-ttu-id="6a1df-124">[![aggiungere una nuova origine dati per il DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-124">[![Add a New Data Source for the DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span></span>

<span data-ttu-id="6a1df-125">**Figura 1**: aggiungere una nuova origine dati per il DropDownList ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-125">**Figure 1**: Add a New Data Source for the DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png))</span></span>

<span data-ttu-id="6a1df-126">La nuova origine dati deve essere naturalmente un ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6a1df-126">The new data source should, naturally, be an ObjectDataSource.</span></span> <span data-ttu-id="6a1df-127">Assegnare al nuovo ObjectDataSource il nome `CategoriesDataSource` e fare in modo che richiami il metodo `GetCategories()` dell'oggetto `CategoriesBLL`.</span><span class="sxs-lookup"><span data-stu-id="6a1df-127">Name this new ObjectDataSource `CategoriesDataSource` and have it invoke the `CategoriesBLL` object's `GetCategories()` method.</span></span>

<span data-ttu-id="6a1df-128">[![scegliere di utilizzare la classe CategoriesBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span></span>

<span data-ttu-id="6a1df-129">**Figura 2**: scegliere di usare la classe `CategoriesBLL` ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-129">**Figure 2**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span></span>

<span data-ttu-id="6a1df-130">[![configurare ObjectDataSource per l'utilizzo del metodo GetCategories ()](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span></span>

<span data-ttu-id="6a1df-131">**Figura 3**: configurare ObjectDataSource per l'uso del metodo `GetCategories()` ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-131">**Figure 3**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span></span>

<span data-ttu-id="6a1df-132">Dopo aver configurato ObjectDataSource, è ancora necessario specificare il campo dell'origine dati da visualizzare nel `Categories` DropDownList e quale deve essere configurato come valore per l'elemento dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="6a1df-132">After configuring the ObjectDataSource we still need to specify which data source field should be displayed in the `Categories` DropDownList and which one should be configured as the value for the list item.</span></span> <span data-ttu-id="6a1df-133">Impostare il campo `CategoryName` come visualizzato e `CategoryID` come valore per ogni elemento dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="6a1df-133">Set the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>

<span data-ttu-id="6a1df-134">[![fare in modo che DropDownList visualizzi il campo CategoryName e usare CategoryID come valore](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span></span>

<span data-ttu-id="6a1df-135">**Figura 4**: fare in modo che l'oggetto DropDownList visualizzi il campo `CategoryName` e usare `CategoryID` come valore ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-135">**Figure 4**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span></span>

<span data-ttu-id="6a1df-136">A questo punto è presente un controllo DropDownList (`Categories`) popolato con i record della tabella `Categories`.</span><span class="sxs-lookup"><span data-stu-id="6a1df-136">At this point we have a DropDownList control (`Categories`) that's populated with the records from the `Categories` table.</span></span> <span data-ttu-id="6a1df-137">Quando l'utente sceglie una nuova categoria dal DropDownList, è necessario che si verifichi un postback per aggiornare il prodotto DropDownList che verrà creato nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="6a1df-137">When the user chooses a new category from the DropDownList we'll want a postback to occur in order to refresh the product DropDownList that we're going to create in Step 2.</span></span> <span data-ttu-id="6a1df-138">Quindi, selezionare l'opzione Abilita AutoPostBack dallo smart tag del `categories` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="6a1df-138">Therefore, check the Enable AutoPostBack option from the `categories` DropDownList's smart tag.</span></span>

<span data-ttu-id="6a1df-139">[![abilitare il PostBack automatico per le categorie (DropDownList)](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-139">[![Enable AutoPostBack for the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span></span>

<span data-ttu-id="6a1df-140">**Figura 5**: abilitare il postback automatico per il `Categories` DropDownList ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-140">**Figure 5**: Enable AutoPostBack for the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span></span>

## <a name="step-2-displaying-the-selected-categorys-products-in-a-second-dropdownlist"></a><span data-ttu-id="6a1df-141">Passaggio 2: visualizzazione dei prodotti della categoria selezionata in un secondo DropDownList</span><span class="sxs-lookup"><span data-stu-id="6a1df-141">Step 2: Displaying the Selected Category's Products in a Second DropDownList</span></span>

<span data-ttu-id="6a1df-142">Con la `Categories` DropDownList completata, il passaggio successivo consiste nel visualizzare un oggetto DropDownList dei prodotti appartenenti alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="6a1df-142">With the `Categories` DropDownList completed, our next step is to display a DropDownList of products belonging to the selected category.</span></span> <span data-ttu-id="6a1df-143">A tale scopo, aggiungere un altro DropDownList alla pagina denominata `ProductsByCategory`.</span><span class="sxs-lookup"><span data-stu-id="6a1df-143">To accomplish this, add another DropDownList to the page named `ProductsByCategory`.</span></span> <span data-ttu-id="6a1df-144">Come per il `Categories` DropDownList, creare un nuovo ObjectDataSource per il `ProductsByCategory` DropDownList denominato `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="6a1df-144">As with the `Categories` DropDownList, create a new ObjectDataSource for the `ProductsByCategory` DropDownList named `ProductsByCategoryDataSource`.</span></span>

<span data-ttu-id="6a1df-145">[![aggiungere una nuova origine dati per l'oggetto DropDownList ProductsByCategory](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-145">[![Add a New Data Source for the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span></span>

<span data-ttu-id="6a1df-146">**Figura 6**: aggiungere una nuova origine dati per il `ProductsByCategory` DropDownList ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-146">**Figure 6**: Add a New Data Source for the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png))</span></span>

<span data-ttu-id="6a1df-147">[![creare un nuovo ObjectDataSource denominato ProductsByCategoryDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-147">[![Create a New ObjectDataSource Named ProductsByCategoryDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span></span>

<span data-ttu-id="6a1df-148">**Figura 7**: creare un nuovo ObjectDataSource denominato `ProductsByCategoryDataSource` ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-148">**Figure 7**: Create a New ObjectDataSource Named `ProductsByCategoryDataSource` ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png))</span></span>

<span data-ttu-id="6a1df-149">Poiché il `ProductsByCategory` DropDownList deve visualizzare solo i prodotti appartenenti alla categoria selezionata, fare in modo che ObjectDataSource richiami il metodo `GetProductsByCategoryID(categoryID)` dall'oggetto `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="6a1df-149">Since the `ProductsByCategory` DropDownList needs to display just those products belonging to the selected category, have the ObjectDataSource invoke the `GetProductsByCategoryID(categoryID)` method from the `ProductsBLL` object.</span></span>

<span data-ttu-id="6a1df-150">[![scegliere di utilizzare la classe ProductsBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-150">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span></span>

<span data-ttu-id="6a1df-151">**Figura 8**: scegliere di usare la classe `ProductsBLL` ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-151">**Figure 8**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span></span>

<span data-ttu-id="6a1df-152">[![configurare ObjectDataSource per l'utilizzo del metodo GetProductsByCategoryID (categoryID)](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-152">[![Configure the ObjectDataSource to Use the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span></span>

<span data-ttu-id="6a1df-153">**Figura 9**: configurare ObjectDataSource per l'uso del metodo `GetProductsByCategoryID(categoryID)` ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-153">**Figure 9**: Configure the ObjectDataSource to Use the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span></span>

<span data-ttu-id="6a1df-154">Nel passaggio finale della procedura guidata è necessario specificare il valore del parametro *`categoryID`* .</span><span class="sxs-lookup"><span data-stu-id="6a1df-154">In the final step of the wizard we need to specify the value of the *`categoryID`* parameter.</span></span> <span data-ttu-id="6a1df-155">Assegnare questo parametro all'elemento selezionato dal `Categories` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="6a1df-155">Assign this parameter to the selected item from the `Categories` DropDownList.</span></span>

<span data-ttu-id="6a1df-156">[![effettuare il pull del valore del parametro categoryID dall'oggetto DropDownList categorie](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-156">[![Pull the categoryID Parameter Value from the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span></span>

<span data-ttu-id="6a1df-157">**Figura 10**: eseguire il pull del valore del parametro *`categoryID`* dal `Categories` DropDownList ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-157">**Figure 10**: Pull the *`categoryID`* Parameter Value from the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span></span>

<span data-ttu-id="6a1df-158">Con ObjectDataSource configurato, rimane solo specificare i campi dell'origine dati da utilizzare per la visualizzazione e il valore degli elementi dell'oggetto DropDownList.</span><span class="sxs-lookup"><span data-stu-id="6a1df-158">With the ObjectDataSource configured, all that remains is to specify what data source fields are used for the display and value of the DropDownList's items.</span></span> <span data-ttu-id="6a1df-159">Visualizzare il campo `ProductName` e utilizzare il campo `ProductID` come valore.</span><span class="sxs-lookup"><span data-stu-id="6a1df-159">Display the `ProductName` field and use the `ProductID` field as the value.</span></span>

<span data-ttu-id="6a1df-160">[![specificare i campi dell'origine dati utilizzati per le proprietà Text e value degli ListItem di DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-160">[![Specify the Data Source Fields Used for the DropDownList's ListItems' Text and Value Properties](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span></span>

<span data-ttu-id="6a1df-161">**Figura 11**: specificare i campi dell'origine dati usati per le proprietà `Text` e `Value` di DropDownList `ListItem` s ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-161">**Figure 11**: Specify the Data Source Fields Used for the DropDownList's `ListItem` s' `Text` and `Value` Properties ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span></span>

<span data-ttu-id="6a1df-162">Con ObjectDataSource e `ProductsByCategory` DropDownList configurati nella pagina verranno visualizzati due DropDownList: la prima elenca tutte le categorie, mentre la seconda elenca i prodotti appartenenti alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="6a1df-162">With the ObjectDataSource and `ProductsByCategory` DropDownList configured our page will display two DropDownLists: the first will list all of the categories while the second will list those products belonging to the selected category.</span></span> <span data-ttu-id="6a1df-163">Quando l'utente seleziona una nuova categoria dal primo DropDownList, sarà seguito da un postback e il secondo DropDownList verrà riassociato, mostrando i prodotti che appartengono alla categoria appena selezionata.</span><span class="sxs-lookup"><span data-stu-id="6a1df-163">When the user selects a new category from the first DropDownList, a postback will ensue and the second DropDownList will be rebound, showing those products that belong to the newly selected category.</span></span> <span data-ttu-id="6a1df-164">Le figure 12 e 13 mostrano `MasterDetailsDetails.aspx` in azione quando vengono visualizzate tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="6a1df-164">Figures 12 and 13 show `MasterDetailsDetails.aspx` in action when viewed through a browser.</span></span>

<span data-ttu-id="6a1df-165">[![quando si visita la pagina per la prima volta, viene selezionata la categoria bevande](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-165">[![When First Visiting the Page, the Beverages Category is Selected](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span></span>

<span data-ttu-id="6a1df-166">**Figura 12**: la prima volta che si visita la pagina, la categoria bevande è selezionata ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-166">**Figure 12**: When First Visiting the Page, the Beverages Category is Selected ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png))</span></span>

<span data-ttu-id="6a1df-167">[![la scelta di una categoria diversa Visualizza i prodotti della nuova categoria](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-167">[![Choosing a Different Category Displays the New Category's Products](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span></span>

<span data-ttu-id="6a1df-168">**Figura 13**: la scelta di una categoria diversa Visualizza i prodotti della nuova categoria ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-168">**Figure 13**: Choosing a Different Category Displays the New Category's Products ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png))</span></span>

<span data-ttu-id="6a1df-169">Attualmente il `productsByCategory` DropDownList *, se modificato, non provoca un* postback.</span><span class="sxs-lookup"><span data-stu-id="6a1df-169">Currently the `productsByCategory` DropDownList, when changed, does *not* cause a postback.</span></span> <span data-ttu-id="6a1df-170">Tuttavia, si desidera che venga eseguito un postback una volta aggiunto un DetailsView per visualizzare i dettagli del prodotto selezionato (passaggio 3).</span><span class="sxs-lookup"><span data-stu-id="6a1df-170">However, we will want a postback to occur once we add a DetailsView to display the selected product's details (Step 3).</span></span> <span data-ttu-id="6a1df-171">Quindi, selezionare la casella di controllo Abilita AutoPostBack dallo smart tag del `productsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="6a1df-171">Therefore, check the Enable AutoPostBack checkbox from the `productsByCategory` DropDownList's smart tag.</span></span>

<span data-ttu-id="6a1df-172">[![abilitare la funzionalità AutoPostBack per l'oggetto DropDownList productsByCategory](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-172">[![Enable the AutoPostBack Feature for the productsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span></span>

<span data-ttu-id="6a1df-173">**Figura 14**: abilitare la funzionalità di postback automatico per il `productsByCategory` DropDownList ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-173">**Figure 14**: Enable the AutoPostBack Feature for the `productsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span></span>

## <a name="step-3-using-a-detailsview-to-display-details-for-the-selected-product"></a><span data-ttu-id="6a1df-174">Passaggio 3: uso di un oggetto DetailsView per visualizzare i dettagli del prodotto selezionato</span><span class="sxs-lookup"><span data-stu-id="6a1df-174">Step 3: Using a DetailsView to Display Details for the Selected Product</span></span>

<span data-ttu-id="6a1df-175">Il passaggio finale consiste nel visualizzare i dettagli relativi al prodotto selezionato in un oggetto DetailsView.</span><span class="sxs-lookup"><span data-stu-id="6a1df-175">The final step is to display the details for the selected product in a DetailsView.</span></span> <span data-ttu-id="6a1df-176">A tale scopo, aggiungere un oggetto DetailsView alla pagina, impostare la relativa proprietà `ID` su `ProductDetails`e creare un nuovo oggetto ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6a1df-176">To accomplish this, add a DetailsView to the page, set its `ID` property to `ProductDetails`, and create a new ObjectDataSource for it.</span></span> <span data-ttu-id="6a1df-177">Configurare questo ObjectDataSource per eseguire il pull dei dati dal metodo `GetProductByProductID(productID)` della classe `ProductsBLL` usando il valore selezionato del `ProductsByCategory` DropDownList per il valore del parametro *`productID`* .</span><span class="sxs-lookup"><span data-stu-id="6a1df-177">Configure this ObjectDataSource to pull its data from the `ProductsBLL` class's `GetProductByProductID(productID)` method using the selected value of the `ProductsByCategory` DropDownList for the value of the *`productID`* parameter.</span></span>

<span data-ttu-id="6a1df-178">[![scegliere di utilizzare la classe ProductsBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-178">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span></span>

<span data-ttu-id="6a1df-179">**Figura 15**: scegliere di usare la classe `ProductsBLL` ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-179">**Figure 15**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span></span>

<span data-ttu-id="6a1df-180">[![configurare ObjectDataSource per l'utilizzo del metodo GetProductByProductID (productID)](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-180">[![Configure the ObjectDataSource to Use the GetProductByProductID(productID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span></span>

<span data-ttu-id="6a1df-181">**Figura 16**: configurare ObjectDataSource per l'uso del metodo `GetProductByProductID(productID)` ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-181">**Figure 16**: Configure the ObjectDataSource to Use the `GetProductByProductID(productID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span></span>

<span data-ttu-id="6a1df-182">[![effettuare il pull del valore del parametro productID dall'oggetto DropDownList ProductsByCategory](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-182">[![Pull the productID Parameter Value from the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span></span>

<span data-ttu-id="6a1df-183">**Figura 17**: effettuare il pull del valore del parametro *`productID`* dal `ProductsByCategory` DropDownList ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-183">**Figure 17**: Pull the *`productID`* Parameter Value from the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png))</span></span>

<span data-ttu-id="6a1df-184">È possibile scegliere di visualizzare i campi disponibili nell'`ProductDetails` DetailsView.</span><span class="sxs-lookup"><span data-stu-id="6a1df-184">You can choose to display any of the available fields in the `ProductDetails` DetailsView.</span></span> <span data-ttu-id="6a1df-185">Si è scelto di rimuovere i campi `ProductID`, `SupplierID`e `CategoryID` e di riordinare e formattare i campi rimanenti.</span><span class="sxs-lookup"><span data-stu-id="6a1df-185">I've opted to remove the `ProductID`, `SupplierID`, and `CategoryID` fields and reordered and formatted the remaining fields.</span></span> <span data-ttu-id="6a1df-186">Sono state inoltre cancellate le proprietà `Height` e `Width` di DetailsView, consentendo a DetailsView di espandersi in base alla larghezza necessaria per visualizzare i dati in modo ottimale anziché limitarli a una dimensione specificata.</span><span class="sxs-lookup"><span data-stu-id="6a1df-186">In addition, I cleared out the DetailsView's `Height` and `Width` properties, allowing the DetailsView to expand to the width needed to best display its data rather than having it constrained to a specified size.</span></span> <span data-ttu-id="6a1df-187">Il markup completo viene visualizzato di seguito:</span><span class="sxs-lookup"><span data-stu-id="6a1df-187">The full markup appears below:</span></span>

[!code-aspx[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample1.aspx)]

<span data-ttu-id="6a1df-188">Provare la pagina `MasterDetailsDetails.aspx` in un browser.</span><span class="sxs-lookup"><span data-stu-id="6a1df-188">Take a moment to try out the `MasterDetailsDetails.aspx` page in a browser.</span></span> <span data-ttu-id="6a1df-189">A prima vista può sembrare che tutto funzioni come desiderato, ma c'è un problema sottile.</span><span class="sxs-lookup"><span data-stu-id="6a1df-189">At first glance it may appear that everything is working as desired, but there's a subtle problem.</span></span> <span data-ttu-id="6a1df-190">Quando si sceglie una nuova categoria, il `ProductsByCategory` DropDownList viene aggiornato in modo da includere i prodotti per la categoria selezionata, ma il `ProductDetails` DetailsView continua a visualizzare le informazioni sul prodotto precedenti.</span><span class="sxs-lookup"><span data-stu-id="6a1df-190">When you choose a new category the `ProductsByCategory` DropDownList is updated to include those products for the selected category, but the `ProductDetails` DetailsView continued to show the previous product information.</span></span> <span data-ttu-id="6a1df-191">Il DetailsView viene aggiornato quando si sceglie un prodotto diverso per la categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="6a1df-191">The DetailsView is updated when choosing a different product for the selected category.</span></span> <span data-ttu-id="6a1df-192">Inoltre, se si esegue un test sufficientemente approfondito, si noterà che se si scelgono continuamente nuove categorie, ad esempio scegliendo bevande dal `Categories` DropDownList, quindi condimenti, quindi confezioni, ogni altra selezione di categoria causa l'aggiornamento del `ProductDetails` DetailsView.</span><span class="sxs-lookup"><span data-stu-id="6a1df-192">Furthermore, if you test thoroughly enough, you'll find that if you continually choose new categories (such as choosing Beverages from the `Categories` DropDownList, then Condiments, then Confections) every other category selection causes the `ProductDetails` DetailsView to be refreshed.</span></span>

<span data-ttu-id="6a1df-193">Per contribuire a concretizzare la questo problema, esaminiamo un esempio specifico.</span><span class="sxs-lookup"><span data-stu-id="6a1df-193">To help concretize this problem, let's look at a specific example.</span></span> <span data-ttu-id="6a1df-194">Quando si visita la pagina per la prima volta, viene selezionata la categoria bevande e i prodotti correlati vengono caricati nel `ProductsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="6a1df-194">When you first visit the page the Beverages category is selected and the related products are loaded in the `ProductsByCategory` DropDownList.</span></span> <span data-ttu-id="6a1df-195">Chai è il prodotto selezionato e i relativi dettagli vengono visualizzati nel `ProductDetails` DetailsView, come illustrato nella figura 18.</span><span class="sxs-lookup"><span data-stu-id="6a1df-195">Chai is the selected product and its details are displayed in the `ProductDetails` DetailsView, as shown in Figure 18.</span></span>

<span data-ttu-id="6a1df-196">[![i dettagli del prodotto selezionato vengono visualizzati in un oggetto DetailsView](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-196">[![The Selected Product's Details are Displayed in a DetailsView](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span></span>

<span data-ttu-id="6a1df-197">**Figura 18**: i dettagli del prodotto selezionato vengono visualizzati in un DetailsView ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-197">**Figure 18**: The Selected Product's Details are Displayed in a DetailsView ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png))</span></span>

<span data-ttu-id="6a1df-198">Se si modifica la selezione della categoria da bevande a condimenti, viene eseguito un postback e il `ProductsByCategory` DropDownList viene aggiornato di conseguenza, ma il DetailsView visualizza comunque i dettagli per Chai.</span><span class="sxs-lookup"><span data-stu-id="6a1df-198">If you change the category selection from Beverages to Condiments, a postback occurs and the `ProductsByCategory` DropDownList is updated accordingly, but the DetailsView still displays details for Chai.</span></span>

<span data-ttu-id="6a1df-199">[![vengono comunque visualizzati i dettagli del prodotto selezionato in precedenza](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-199">[![The Previously Selected Product's Details are Still Displayed](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span></span>

<span data-ttu-id="6a1df-200">**Figura 19**: i dettagli del prodotto selezionato in precedenza sono ancora visualizzati ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-200">**Figure 19**: The Previously Selected Product's Details are Still Displayed ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png))</span></span>

<span data-ttu-id="6a1df-201">Se si seleziona un nuovo prodotto dall'elenco, il DetailsView viene aggiornato come previsto.</span><span class="sxs-lookup"><span data-stu-id="6a1df-201">Picking a new product from the list refreshes the DetailsView as expected.</span></span> <span data-ttu-id="6a1df-202">Se si seleziona una nuova categoria dopo aver modificato il prodotto, il servizio DetailsView non verrà aggiornato.</span><span class="sxs-lookup"><span data-stu-id="6a1df-202">If you pick a new category after changing the product, the DetailsView again won't refresh.</span></span> <span data-ttu-id="6a1df-203">Tuttavia, se invece di scegliere un nuovo prodotto è stata selezionata una nuova categoria, l'oggetto DetailsView verrà aggiornato.</span><span class="sxs-lookup"><span data-stu-id="6a1df-203">However, if instead of choosing a new product you selected a new category, the DetailsView would refresh.</span></span> <span data-ttu-id="6a1df-204">Che cosa succede in questo mondo?</span><span class="sxs-lookup"><span data-stu-id="6a1df-204">What in the world is going on here?</span></span>

<span data-ttu-id="6a1df-205">Il problema è un problema di temporizzazione nel ciclo di vita della pagina.</span><span class="sxs-lookup"><span data-stu-id="6a1df-205">The problem is a timing issue in the page's lifecycle.</span></span> <span data-ttu-id="6a1df-206">Ogni volta che viene richiesta una pagina, viene eseguito un certo numero di passaggi come rendering.</span><span class="sxs-lookup"><span data-stu-id="6a1df-206">Whenever a page is requested it proceeds through a number of steps as its rendering.</span></span> <span data-ttu-id="6a1df-207">In uno di questi passaggi i controlli ObjectDataSource verificano se uno dei valori `SelectParameters` è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="6a1df-207">In one of these steps the ObjectDataSource controls check to see if any of their `SelectParameters` values have changed.</span></span> <span data-ttu-id="6a1df-208">In tal caso, il controllo Web dei dati associato a ObjectDataSource sa che è necessario aggiornare la visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="6a1df-208">If so, the data Web control bound to the ObjectDataSource knows that it needs to refresh its display.</span></span> <span data-ttu-id="6a1df-209">Ad esempio, quando si seleziona una nuova categoria, il `ProductsByCategoryDataSource` ObjectDataSource rileva che i valori dei parametri sono stati modificati e il `ProductsByCategory` DropDownList viene riassociato, ottenendo i prodotti per la categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="6a1df-209">For example, when a new category is selected, the `ProductsByCategoryDataSource` ObjectDataSource detects that its parameter values have changed and the `ProductsByCategory` DropDownList rebinds itself, getting the products for the selected category.</span></span>

<span data-ttu-id="6a1df-210">Il problema che si verifica in questa situazione è che il punto del ciclo di vita della pagina controllato da ObjectDataSource per i parametri modificati si verifica *prima* della riassociazione dei controlli Web dei dati associati.</span><span class="sxs-lookup"><span data-stu-id="6a1df-210">The problem that arises in this situation is that the point in the page lifecycle that the ObjectDataSources check for changed parameters occurs *before* the rebinding of the associated data Web controls.</span></span> <span data-ttu-id="6a1df-211">Pertanto, quando si seleziona una nuova categoria, il `ProductsByCategoryDataSource` ObjectDataSource rileva una modifica nel valore del relativo parametro.</span><span class="sxs-lookup"><span data-stu-id="6a1df-211">Therefore, when selecting a new category the `ProductsByCategoryDataSource` ObjectDataSource detects a change in its parameter's value.</span></span> <span data-ttu-id="6a1df-212">Il ObjectDataSource utilizzato dal `ProductDetails` DetailsView, tuttavia, non annotare tali modifiche perché il `ProductsByCategory` DropDownList deve ancora essere riassociato.</span><span class="sxs-lookup"><span data-stu-id="6a1df-212">The ObjectDataSource used by the `ProductDetails` DetailsView, however, doesn't note any such changes because the `ProductsByCategory` DropDownList has yet to be rebound.</span></span> <span data-ttu-id="6a1df-213">Più avanti nel ciclo di vita, il `ProductsByCategory` DropDownList viene riassociato al relativo ObjectDataSource, afferrando i prodotti per la categoria appena selezionata.</span><span class="sxs-lookup"><span data-stu-id="6a1df-213">Later in the lifecycle the `ProductsByCategory` DropDownList rebinds to its ObjectDataSource, grabbing the products for the newly selected category.</span></span> <span data-ttu-id="6a1df-214">Mentre il valore del `ProductsByCategory` DropDownList è stato modificato, ObjectDataSource ha già eseguito il controllo `ProductDetails` del valore del parametro. Pertanto, DetailsView Visualizza i risultati precedenti.</span><span class="sxs-lookup"><span data-stu-id="6a1df-214">While the `ProductsByCategory` DropDownList's value has changed, the `ProductDetails` DetailsView's ObjectDataSource has already done its parameter value check; therefore, the DetailsView displays its previous results.</span></span> <span data-ttu-id="6a1df-215">Questa interazione è illustrata nella figura 20.</span><span class="sxs-lookup"><span data-stu-id="6a1df-215">This interaction is depicted in Figure 20.</span></span>

<span data-ttu-id="6a1df-216">[![il valore di DropDownList ProductsByCategory cambia dopo che ObjectDataSource di ProductDetails controlla la presenza di modifiche](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-216">[![The ProductsByCategory DropDownList Value Changes After the ProductDetails DetailsView's ObjectDataSource Checks for Changes](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span></span>

<span data-ttu-id="6a1df-217">**Figura 20**: il valore della `ProductsByCategory` DropDownList cambia dopo che l'oggetto ObjectDataSource di `ProductDetails` controlla le modifiche ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-217">**Figure 20**: The `ProductsByCategory` DropDownList Value Changes After the `ProductDetails` DetailsView's ObjectDataSource Checks for Changes ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png))</span></span>

<span data-ttu-id="6a1df-218">Per risolvere questo problema, è necessario riassociare in modo esplicito il `ProductDetails` DetailsView dopo che è stato associato il `ProductsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="6a1df-218">To remedy this we need to explicitly rebind the `ProductDetails` DetailsView after the `ProductsByCategory` DropDownList has been bound.</span></span> <span data-ttu-id="6a1df-219">A tale scopo, è possibile chiamare il metodo `DataBind()` di `ProductDetails` DetailsView quando viene generato l'evento `DataBound` dell'oggetto DropDownList `ProductsByCategory`.</span><span class="sxs-lookup"><span data-stu-id="6a1df-219">We can accomplish this by calling the `ProductDetails` DetailsView's `DataBind()` method when the `ProductsByCategory` DropDownList's `DataBound` event fires.</span></span> <span data-ttu-id="6a1df-220">Aggiungere il seguente codice del gestore eventi alla classe code-behind della pagina `MasterDetailsDetails.aspx` (per una discussione su come aggiungere un gestore eventi, vedere l'articolo relativo all'[impostazione a livello di programmazione dei valori dei parametri di ObjectDataSource](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)):</span><span class="sxs-lookup"><span data-stu-id="6a1df-220">Add the following event handler code to the `MasterDetailsDetails.aspx` page's code-behind class (refer to the "[Programmatically Setting the ObjectDataSource's Parameter Values](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)" for a discussion on how to add an event handler):</span></span>

[!code-vb[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample2.vb)]

<span data-ttu-id="6a1df-221">Una volta aggiunta la chiamata esplicita al metodo `DataBind()` di `ProductDetails` DetailsView, l'esercitazione funziona come previsto.</span><span class="sxs-lookup"><span data-stu-id="6a1df-221">After this explicit call to the `ProductDetails` DetailsView's `DataBind()` method has been added, the tutorial works as expected.</span></span> <span data-ttu-id="6a1df-222">La figura 21 evidenzia il modo in cui questa modifica ha risolto il problema precedente.</span><span class="sxs-lookup"><span data-stu-id="6a1df-222">Figure 21 highlights how this changed remedied our earlier problem.</span></span>

<span data-ttu-id="6a1df-223">[![l'oggetto DetailsView ProductDetails viene aggiornato in modo esplicito quando viene generato l'evento di associazione a un oggetto di ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="6a1df-223">[![The ProductDetails DetailsView is Explicitly Refreshed When the ProductsByCategory DropDownList's DataBound Event Fires](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span></span>

<span data-ttu-id="6a1df-224">**Figura 21**: il `ProductDetails` DetailsView viene aggiornato in modo esplicito quando viene generato l'evento di `DataBound` di `ProductsByCategory` DropDownList ([fare clic per visualizzare l'immagine con dimensioni complete](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="6a1df-224">**Figure 21**: The `ProductDetails` DetailsView is Explicitly Refreshed When the `ProductsByCategory` DropDownList's `DataBound` Event Fires ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png))</span></span>

## <a name="summary"></a><span data-ttu-id="6a1df-225">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="6a1df-225">Summary</span></span>

<span data-ttu-id="6a1df-226">Il controllo DropDownList funge da elemento dell'interfaccia utente ideale per i report master/dettagli in cui è presente una relazione uno-a-molti tra i record master e dettagli.</span><span class="sxs-lookup"><span data-stu-id="6a1df-226">The DropDownList serves as an ideal user interface element for master/detail reports where there is a one-to-many relationship between the master and detail records.</span></span> <span data-ttu-id="6a1df-227">Nell'esercitazione precedente è stato illustrato come utilizzare un singolo DropDownList per filtrare i prodotti visualizzati dalla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="6a1df-227">In the preceding tutorial we saw how to use a single DropDownList to filter the products displayed by the selected category.</span></span> <span data-ttu-id="6a1df-228">In questa esercitazione è stato sostituito il GridView dei prodotti con un DropDownList ed è stato usato un oggetto DetailsView per visualizzare i dettagli del prodotto selezionato.</span><span class="sxs-lookup"><span data-stu-id="6a1df-228">In this tutorial we replaced the GridView of products with a DropDownList, and used a DetailsView to display the details of the selected product.</span></span> <span data-ttu-id="6a1df-229">I concetti illustrati in questa esercitazione possono essere facilmente estesi ai modelli di dati che coinvolgono più relazioni uno-a-molti, ad esempio clienti, ordini e elementi dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="6a1df-229">The concepts discussed in this tutorial can easily be extended to data models involving multiple one-to-many relationships, such as customers, orders, and order items.</span></span> <span data-ttu-id="6a1df-230">In generale, è sempre possibile aggiungere un oggetto DropDownList per ciascuna entità "One" nelle relazioni uno-a-molti.</span><span class="sxs-lookup"><span data-stu-id="6a1df-230">In general, you can always add a DropDownList for each of the "one" entities in the one-to-many relationships.</span></span>

<span data-ttu-id="6a1df-231">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="6a1df-231">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="6a1df-232">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="6a1df-232">About the Author</span></span>

<span data-ttu-id="6a1df-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="6a1df-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6a1df-234">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="6a1df-234">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6a1df-235">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="6a1df-235">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="6a1df-236">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6a1df-236">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="6a1df-237">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="6a1df-237">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="6a1df-238">Grazie speciale</span><span class="sxs-lookup"><span data-stu-id="6a1df-238">Special Thanks To</span></span>

<span data-ttu-id="6a1df-239">Questa serie di esercitazioni è stata esaminata da molti revisori utili.</span><span class="sxs-lookup"><span data-stu-id="6a1df-239">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6a1df-240">Il revisore principale di questa esercitazione è stato Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="6a1df-240">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="6a1df-241">Sei interessato a esaminare i miei prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="6a1df-241">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6a1df-242">In tal caso, rilasciare una riga in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6a1df-242">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6a1df-243">[Precedente](master-detail-filtering-with-a-dropdownlist-vb.md)
> [Successivo](master-detail-filtering-across-two-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6a1df-243">[Previous](master-detail-filtering-with-a-dropdownlist-vb.md)
[Next](master-detail-filtering-across-two-pages-vb.md)</span></span>
