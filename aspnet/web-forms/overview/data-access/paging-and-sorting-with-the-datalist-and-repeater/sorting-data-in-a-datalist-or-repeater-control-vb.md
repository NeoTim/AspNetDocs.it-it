---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-vb
title: Ordinamento dei dati in un controllo DataList o Repeater (VB) | Microsoft Docs
author: rick-anderson
description: In questa esercitazione verrà esaminato come includere l'ordinamento di supporto con DataList e Repeater, nonché come costruire un controllo DataList o Repeater i cui dati possono...
ms.author: riande
ms.date: 11/13/2006
ms.assetid: 97c13898-0741-45f9-b3fa-7540ab1679e6
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 58d4c14e2b888f933457fe421235499943354182
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/25/2019
ms.locfileid: "58422923"
---
<a name="sorting-data-in-a-datalist-or-repeater-control-vb"></a><span data-ttu-id="19244-103">Ordinamento dei dati in un controllo DataList o Repeater (VB)</span><span class="sxs-lookup"><span data-stu-id="19244-103">Sorting Data in a DataList or Repeater Control (VB)</span></span>
====================
<span data-ttu-id="19244-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="19244-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="19244-105">[Scaricare l'App di esempio](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_VB.exe) o [Scarica il PDF](sorting-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial45vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="19244-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_VB.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial45vb1.pdf)</span></span>

> <span data-ttu-id="19244-106">In questa esercitazione verrà esaminato come includere l'ordinamento di supporto con DataList e Repeater, nonché come costruire un controllo DataList o Repeater i cui dati possono essere di paging e ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>


## <a name="introduction"></a><span data-ttu-id="19244-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="19244-107">Introduction</span></span>

<span data-ttu-id="19244-108">Nel [esercitazione precedente](paging-report-data-in-a-datalist-or-repeater-control-vb.md) abbiamo esaminato il modo aggiungere il supporto di paging per un controllo DataList.</span><span class="sxs-lookup"><span data-stu-id="19244-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-vb.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="19244-109">È stato creato un nuovo metodo nella `ProductsBLL` classe (`GetProductsAsPagedDataSource`) che ha restituito un `PagedDataSource` oggetto.</span><span class="sxs-lookup"><span data-stu-id="19244-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="19244-110">Quando è associato a un controllo DataList o Repeater, DataList o Repeater verranno visualizzati solo la pagina richiesta dei dati.</span><span class="sxs-lookup"><span data-stu-id="19244-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="19244-111">Questa tecnica è simile a quello utilizzato internamente dai controlli GridView, DetailsView e FormView per fornire le funzionalità di paging predefinito incorporato.</span><span class="sxs-lookup"><span data-stu-id="19244-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="19244-112">Oltre a offrirti supporto per lo spostamento, GridView include anche supporto per l'ordinamento predefiniti.</span><span class="sxs-lookup"><span data-stu-id="19244-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="19244-113">Nessuna delle due DataList e Repeater fornisce funzionalità di ordinamento predefinita; Tuttavia, funzionalità di ordinamento possono essere aggiunti con un po' di codice.</span><span class="sxs-lookup"><span data-stu-id="19244-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="19244-114">In questa esercitazione verrà esaminato come includere l'ordinamento di supporto con DataList e Repeater, nonché come costruire un controllo DataList o Repeater i cui dati possono essere di paging e ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="19244-115">Una revisione dell'ordinamento</span><span class="sxs-lookup"><span data-stu-id="19244-115">A Review of Sorting</span></span>

<span data-ttu-id="19244-116">Come abbiamo visto nel [Paging e ordinamento dei dati del Report](../paging-and-sorting/paging-and-sorting-report-data-vb.md) esercitazione, il controllo GridView è predefiniti supporto per l'ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-vb.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="19244-117">Ogni campo di GridView può avere associato un `SortExpression`, che indica il campo dati in base alle quali ordinare i dati.</span><span class="sxs-lookup"><span data-stu-id="19244-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="19244-118">Quando i dispositivi di GridView `AllowSorting` è impostata su `true`, ogni campo GridView con un `SortExpression` valore di proprietà contiene l'intestazione specificata sottoposto a rendering come un controllo LinkButton.</span><span class="sxs-lookup"><span data-stu-id="19244-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="19244-119">Quando un utente fa clic su una particolare intestazione s campo di GridView, si verifica un postback e i dati vengono ordinati in base al campo selezionato s `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="19244-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="19244-120">Il controllo GridView è un `SortExpression` proprietà, che archivia il `SortExpression` del campo GridView vengono ordinati i dati.</span><span class="sxs-lookup"><span data-stu-id="19244-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="19244-121">Inoltre, un `SortDirection` proprietà indica se i dati sono da ordinare in ordine crescente o decrescente (se un utente fa clic su un particolare collegamento di intestazione campo s GridView due volte in successione, l'ordinamento è attivato o disattivato).</span><span class="sxs-lookup"><span data-stu-id="19244-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="19244-122">Quando il controllo GridView è associato al relativo controllo origine dati, passa relativi `SortExpression` e `SortDirection` proprietà ai dati di controllo del codice sorgente.</span><span class="sxs-lookup"><span data-stu-id="19244-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="19244-123">Il controllo origine dati recupera i dati e quindi la Ordina in base a fornito `SortExpression` e `SortDirection` proprietà.</span><span class="sxs-lookup"><span data-stu-id="19244-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="19244-124">Dopo l'ordinamento dei dati, il controllo origine dati restituisce a GridView.</span><span class="sxs-lookup"><span data-stu-id="19244-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="19244-125">Per replicare questa funzionalità con i controlli DataList o Repeater, è necessario:</span><span class="sxs-lookup"><span data-stu-id="19244-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="19244-126">Creare un'interfaccia di ordinamento</span><span class="sxs-lookup"><span data-stu-id="19244-126">Create a sorting interface</span></span>
- <span data-ttu-id="19244-127">Tenere presente il campo di dati per ordinare in base e se eseguire l'ordinamento in ordine crescente o decrescente</span><span class="sxs-lookup"><span data-stu-id="19244-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="19244-128">Indicare a ObjectDataSource per ordinare i dati da un campo dati specifico</span><span class="sxs-lookup"><span data-stu-id="19244-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="19244-129">Che verranno affrontati queste tre attività nei passaggi 3 e 4.</span><span class="sxs-lookup"><span data-stu-id="19244-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="19244-130">In seguito, verrà esaminato come includere sia il paging e ordinamento di supporto in un controllo DataList o Repeater.</span><span class="sxs-lookup"><span data-stu-id="19244-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="19244-131">Passaggio 2: Visualizzare i prodotti in un controllo Repeater</span><span class="sxs-lookup"><span data-stu-id="19244-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="19244-132">Prima ci preoccupiamo implementa le funzionalità correlate all'ordinamento, consentire s inizia creando un elenco di prodotti in un controllo Repeater.</span><span class="sxs-lookup"><span data-stu-id="19244-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="19244-133">Iniziare aprendo il `Sorting.aspx` nella pagina di `PagingSortingDataListRepeater` cartella.</span><span class="sxs-lookup"><span data-stu-id="19244-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="19244-134">Aggiungere un controllo Repeater per la pagina web, l'impostazione relativa `ID` proprietà `SortableProducts`.</span><span class="sxs-lookup"><span data-stu-id="19244-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="19244-135">Nello smart tag Repeater s, creare un nuovo oggetto ObjectDataSource denominato `ProductsDataSource` e configurarlo per recuperare i dati di `ProductsBLL` classe s `GetProducts()` (metodo).</span><span class="sxs-lookup"><span data-stu-id="19244-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="19244-136">Selezionare il che opzione (nessuno) dagli elenchi a discesa nelle schede INSERT, UPDATE e DELETE.</span><span class="sxs-lookup"><span data-stu-id="19244-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>


<span data-ttu-id="19244-137">[![Creare un ObjectDataSource e configurarlo per usare il metodo GetProductsAsPagedDataSource()](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="19244-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)</span></span>

<span data-ttu-id="19244-138">**Figura 1**: Creare un ObjectDataSource e configurarlo per usare la `GetProductsAsPagedDataSource()` metodo ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="19244-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image3.png))</span></span>


<span data-ttu-id="19244-139">[![Impostare l'elenco a discesa sono elencati nell'aggiornamento, inserimento ed eliminare schede su (nessuno)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="19244-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image4.png)</span></span>

<span data-ttu-id="19244-140">**Figura 2**: Impostare l'elenco a discesa sono elencati nell'aggiornamento, inserimento ed eliminare schede su (nessuno) ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="19244-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image6.png))</span></span>


<span data-ttu-id="19244-141">A differenza con il DataList, Visual Studio non crea automaticamente un `ItemTemplate` per il controllo Repeater dopo l'associazione a un'origine dati.</span><span class="sxs-lookup"><span data-stu-id="19244-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="19244-142">Inoltre, è necessario aggiungere questo `ItemTemplate` in modo dichiarativo, come lo smart tag di controllo del codice s Repeater manca l'opzione di modifica modelli disponibile in DataList s.</span><span class="sxs-lookup"><span data-stu-id="19244-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="19244-143">S ti permettono di usare lo stesso `ItemTemplate` dall'esercitazione precedente, visualizzare il nome del prodotto s, fornitore e categoria.</span><span class="sxs-lookup"><span data-stu-id="19244-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="19244-144">Dopo aver aggiunto il `ItemTemplate`, Repeater e ObjectDataSource s markup dichiarativo dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="19244-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample1.aspx)]

<span data-ttu-id="19244-145">Figura 3 Mostra questa pagina quando viene visualizzato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="19244-145">Figure 3 shows this page when viewed through a browser.</span></span>


<span data-ttu-id="19244-146">[![Viene visualizzato ogni s nome, fornitore e la categoria di prodotto](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="19244-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span></span>

<span data-ttu-id="19244-147">**Figura 3**: Ogni nome di prodotto, fornitore e categoria viene visualizzata ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="19244-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span></span>


## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="19244-148">Passaggio 3: Che indica a ObjectDataSource per ordinare i dati</span><span class="sxs-lookup"><span data-stu-id="19244-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="19244-149">Per ordinare i dati visualizzati nel Repeater, dobbiamo informare ObjectDataSource dell'espressione di ordinamento mediante il quale i dati devono essere ordinati.</span><span class="sxs-lookup"><span data-stu-id="19244-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="19244-150">Prima di ObjectDataSource recupera i relativi dati, viene generato prima di tutto relativi [ `Selecting` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), che offre un'opportunità specificare un'espressione di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="19244-151">Il `Selecting` gestore dell'evento viene passato un oggetto di tipo [ `ObjectDataSourceSelectingEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), che include una proprietà denominata [ `Arguments` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) typu [ `DataSourceSelectArguments` ](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span><span class="sxs-lookup"><span data-stu-id="19244-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="19244-152">Il `DataSourceSelectArguments` classe è progettata per passare le richieste correlate ai dati da un consumer di dati per il controllo origine dati e include una [ `SortExpression` proprietà](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span><span class="sxs-lookup"><span data-stu-id="19244-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="19244-153">Per passare informazioni sull'ordinamento dalla pagina ASP.NET a ObjectDataSource, creare un gestore eventi per il `Selecting` evento e usare il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="19244-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample2.vb)]

<span data-ttu-id="19244-154">Il *sortExpression* valore deve essere assegnato il nome del campo dati per ordinare i dati in base (ad esempio ProductName).</span><span class="sxs-lookup"><span data-stu-id="19244-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="19244-155">È presente nessuna proprietà correlate alla direzione di ordinamento, pertanto, se si desidera ordinare i dati in ordine decrescente, aggiungere la stringa DESC per il *sortExpression* valore (ad esempio ProductName DESC).</span><span class="sxs-lookup"><span data-stu-id="19244-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="19244-156">Procediamo e proviamolo alcuni valori diversi impostati come hardcoded per *sortExpression* e testare i risultati in un browser.</span><span class="sxs-lookup"><span data-stu-id="19244-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="19244-157">Come illustrato nella figura 4, quando si usa ProductName DESC come le *sortExpression*, i prodotti vengono ordinati in base al nome in ordine alfabetico inverso.</span><span class="sxs-lookup"><span data-stu-id="19244-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>


<span data-ttu-id="19244-158">[![I prodotti vengono ordinati in base al nome in ordine alfabetico inverso](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="19244-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span></span>

<span data-ttu-id="19244-159">**Figura 4**: I prodotti vengono ordinati in base al nome in ordine alfabetico inverso ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="19244-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span></span>


## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="19244-160">Passaggio 4: Creazione dell'interfaccia di ordinamento e la memorizzazione di espressione di ordinamento e la direzione</span><span class="sxs-lookup"><span data-stu-id="19244-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="19244-161">Attivare l'ordinamento di supporto in GridView converte ogni testo dell'intestazione campo ordinabile s in un controllo LinkButton che, quando si fa clic, Ordina i dati di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="19244-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="19244-162">Questo tipo è un'interfaccia di ordinamento senso per il controllo GridView, in cui i dati ben disposti in colonne.</span><span class="sxs-lookup"><span data-stu-id="19244-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="19244-163">Per i controlli DataList e Repeater, tuttavia, è necessaria un'altra interfaccia di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="19244-164">Un'interfaccia comune di ordinamento per un elenco di dati (anziché una griglia dei dati), è un elenco di riepilogo a discesa che contiene i campi con cui i dati possono essere ordinati.</span><span class="sxs-lookup"><span data-stu-id="19244-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="19244-165">Lasciare s che implementano tale interfaccia per questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="19244-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="19244-166">Aggiungere un controllo DropDownList Web precedente la `SortableProducts` Repeater e set relativo `ID` proprietà `SortBy`.</span><span class="sxs-lookup"><span data-stu-id="19244-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="19244-167">Nella finestra Proprietà fare clic sui puntini di sospensione di `Items` proprietà per visualizzare Editor raccolta di ListItem.</span><span class="sxs-lookup"><span data-stu-id="19244-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="19244-168">Aggiungere `ListItem` s per ordinare i dati per il `ProductName`, `CategoryName`, e `SupplierName` campi.</span><span class="sxs-lookup"><span data-stu-id="19244-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="19244-169">Aggiungere anche un `ListItem` per ordinare i prodotti in base al nome in ordine alfabetico inverso.</span><span class="sxs-lookup"><span data-stu-id="19244-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="19244-170">Il `ListItem` `Text` proprietà possono essere impostate su qualsiasi valore (ad esempio nome), ma il `Value` devono essere impostate per il nome del campo dati (ad esempio ProductName).</span><span class="sxs-lookup"><span data-stu-id="19244-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="19244-171">Per ordinare i risultati in ordine decrescente, aggiungere la stringa DESC per il nome del campo dati, ad esempio ProductName DESC.</span><span class="sxs-lookup"><span data-stu-id="19244-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>


![Aggiungere un elemento ListItem per ognuno dei campi dati ordinabili](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image13.png)

<span data-ttu-id="19244-173">**Figura 5**: Aggiungere un `ListItem` per ognuno dei campi dati ordinabili</span><span class="sxs-lookup"><span data-stu-id="19244-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>


<span data-ttu-id="19244-174">Infine, aggiungere un controllo Web sul pulsante a destra del DropDownList.</span><span class="sxs-lookup"><span data-stu-id="19244-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="19244-175">Impostare relativi `ID` al `RefreshRepeater` e il relativo `Text` proprietà per l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="19244-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="19244-176">Dopo aver creato il `ListItem` s e aggiungere il pulsante di aggiornamento, la sintassi dichiarativa s DropDownList e pulsante dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="19244-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample3.aspx)]

<span data-ttu-id="19244-177">Con ordinamento DropDownList completo, è quindi necessario aggiornare la s ObjectDataSource `Selecting` gestore dell'evento in modo che utilizzi selezionata `SortBy``ListItem` s `Value` proprietà anziché un'espressione di ordinamento a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="19244-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample4.vb)]

<span data-ttu-id="19244-178">A questo punto, durante la prima visita la pagina dei prodotti verranno inizialmente essere ordinati in base il `ProductName` campo di dati, come s il `SortBy` `ListItem` selezionata per impostazione predefinita (vedere la figura 6).</span><span class="sxs-lookup"><span data-stu-id="19244-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="19244-179">Selezionando una diversa opzione come categoria di ordinamento e fa clic su Aggiorna viene provocato un postback e riordinamento dei dati per il nome di categoria, come illustrato nella figura 7.</span><span class="sxs-lookup"><span data-stu-id="19244-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>


<span data-ttu-id="19244-180">[![I prodotti sono inizialmente ordinati in base al nome](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="19244-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)</span></span>

<span data-ttu-id="19244-181">**Figura 6**: I prodotti sono inizialmente ordinati in base al nome ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="19244-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image16.png))</span></span>


<span data-ttu-id="19244-182">[![I prodotti sono ora ordinati per categoria](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="19244-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)</span></span>

<span data-ttu-id="19244-183">**Figura 7**: I prodotti sono ora ordinati per categoria ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="19244-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="19244-184">Facendo clic sul pulsante di aggiornamento, i dati essere automaticamente nuovamente ordinato perché lo stato di visualizzazione Repeater s è stato disabilitato, determinando il Repeater riassociare all'origine dati in ogni postback.</span><span class="sxs-lookup"><span data-stu-id="19244-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="19244-185">Se è stato lasciato il Repeater s lo stato di visualizzazione abilitato, la modifica dell'ordinamento elenco a discesa elenco non ha alcun effetto sulla sequenza di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won't have any affect on the sort order.</span></span> <span data-ttu-id="19244-186">Per risolvere questo problema, creare un gestore eventi per s pulsante Refresh `Click` evento e riassociazione di Repeater all'origine dati (chiamando il Repeater s `DataBind()` (metodo)).</span><span class="sxs-lookup"><span data-stu-id="19244-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>


## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="19244-187">Ricordare l'espressione di ordinamento e la direzione</span><span class="sxs-lookup"><span data-stu-id="19244-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="19244-188">Durante la creazione di un controllo DataList o Repeater ordinabile in una pagina in cui non ordina correlati possono verificarsi durante i postback, il codice imperativo per s che l'espressione di ordinamento e la direzione mantenuta durante i postback.</span><span class="sxs-lookup"><span data-stu-id="19244-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="19244-189">Si supponga, ad esempio, che viene aggiornato il Repeater in questa esercitazione per includere un pulsante di eliminazione con ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="19244-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="19244-190">Quando l'utente fa clic sul pulsante Elimina d eseguiamo il codice per eliminare il prodotto selezionato e quindi associare di nuovo i dati al controllo Repeater.</span><span class="sxs-lookup"><span data-stu-id="19244-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="19244-191">Se i dettagli di ordinamento non sono persistenti durante il postback, i dati visualizzati sullo schermo verranno ripristinato l'ordine originale.</span><span class="sxs-lookup"><span data-stu-id="19244-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="19244-192">Per questa esercitazione, DropDownList in modo implicito Salva l'ordinamento espressione e alla direzione in stato di visualizzazione per noi.</span><span class="sxs-lookup"><span data-stu-id="19244-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="19244-193">Se si stesse usando un'interfaccia di ordinamento diversa uno con, i controlli LinkButton ad esempio, che ha fornito le varie opzioni di ordinamento d occorre prestare attenzione a ricordare l'ordinamento durante i postback.</span><span class="sxs-lookup"><span data-stu-id="19244-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="19244-194">Ad esempio archiviando i parametri di ordinamento nello stato di visualizzazione pagina s, includendo il parametro di ordinamento nella stringa di query, o tramite un'altra tecnica di persistenza dello stato.</span><span class="sxs-lookup"><span data-stu-id="19244-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="19244-195">Future esempi in questa esercitazione Scopri come rendere permanente l'ordinamento dettagli nello stato di visualizzazione pagina s.</span><span class="sxs-lookup"><span data-stu-id="19244-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="19244-196">Passaggio 5: Aggiunta di supporto per l'ordinamento a un controllo DataList che usa il Paging predefinito</span><span class="sxs-lookup"><span data-stu-id="19244-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="19244-197">Nel [esercitazione precedente](paging-report-data-in-a-datalist-or-repeater-control-vb.md) abbiamo esaminato come implementare il paging predefinito con un controllo DataList.</span><span class="sxs-lookup"><span data-stu-id="19244-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-vb.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="19244-198">Let s estendere questo esempio precedente in modo da includere la possibilità di ordinare i dati di paging.</span><span class="sxs-lookup"><span data-stu-id="19244-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="19244-199">Iniziare aprendo il `SortingWithDefaultPaging.aspx` e `Paging.aspx` pagine di `PagingSortingDataListRepeater` cartella.</span><span class="sxs-lookup"><span data-stu-id="19244-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="19244-200">Dal `Paging.aspx` pagina fare clic sul pulsante di origine per visualizzare il markup dichiarativo pagina s.</span><span class="sxs-lookup"><span data-stu-id="19244-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="19244-201">Copiare il testo selezionato (vedere la figura 8) e incollarlo nel markup dichiarativo di `SortingWithDefaultPaging.aspx` tra il `<asp:Content>` tag.</span><span class="sxs-lookup"><span data-stu-id="19244-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>


<span data-ttu-id="19244-202">[![Replicare il Markup dichiarativo nel &lt;asp: Content&gt; tag di paging. aspx per SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="19244-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)</span></span>

<span data-ttu-id="19244-203">**Figura 8**: Replicare il Markup dichiarativo nel `<asp:Content>` tag dal `Paging.aspx` a `SortingWithDefaultPaging.aspx` ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="19244-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image22.png))</span></span>


<span data-ttu-id="19244-204">Dopo aver copiato il codice dichiarativo, copiare i metodi e proprietà nel `Paging.aspx` pagina classe code-behind s per la classe code-behind per `SortingWithDefaultPaging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="19244-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="19244-205">Successivamente, si consiglia di visualizzare il `SortingWithDefaultPaging.aspx` pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="19244-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="19244-206">Deve presentare la stessa funzionalità e aspetto come `Paging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="19244-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="19244-207">Miglioramento ProductsBLL per includere un valore predefinito di Paging e ordinamento (metodo)</span><span class="sxs-lookup"><span data-stu-id="19244-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="19244-208">Nell'esercitazione precedente è stato creato un `GetProductsAsPagedDataSource(pageIndex, pageSize)` metodo nella `ProductsBLL` classe che ha restituito un `PagedDataSource` oggetto.</span><span class="sxs-lookup"><span data-stu-id="19244-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="19244-209">Ciò `PagedDataSource` oggetto è stato popolato con *tutte le* dei prodotti (tramite i dispositivi di livello BLL `GetProducts()` metodo), ma quando è associato a DataList solo i record corrispondente all'oggetto specificato *pageIndex* e *pageSize* sono stati visualizzati i parametri di input.</span><span class="sxs-lookup"><span data-stu-id="19244-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="19244-210">In precedenza in questa esercitazione è stato aggiunto il supporto dell'ordinamento, specificando l'espressione di ordinamento da ObjectDataSource s `Selecting` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="19244-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="19244-211">Questo funziona bene quando ObjectDataSource viene restituito un oggetto che è possibile ordinare, ad esempio la `ProductsDataTable` restituito dal `GetProducts()` (metodo).</span><span class="sxs-lookup"><span data-stu-id="19244-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="19244-212">Tuttavia, il `PagedDataSource` oggetto restituito dal `GetProductsAsPagedDataSource` (metodo) non supporta l'ordinamento della relativa origine dati interna.</span><span class="sxs-lookup"><span data-stu-id="19244-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="19244-213">In alternativa, è necessario ordinare i risultati restituiti dal `GetProducts()` metodo *prima di* inseriamo nel `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="19244-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="19244-214">A questo scopo, creare un nuovo metodo nella `ProductsBLL` classe `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span><span class="sxs-lookup"><span data-stu-id="19244-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="19244-215">Per ordinare le `ProductsDataTable` restituito dal `GetProducts()` metodo, specificare il `Sort` proprietà del relativo valore predefinito `DataTableView`:</span><span class="sxs-lookup"><span data-stu-id="19244-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample5.vb)]

<span data-ttu-id="19244-216">Il `GetProductsSortedAsPagedDataSource` metodo differisce solo leggermente dal `GetProductsAsPagedDataSource` metodo creato nell'esercitazione precedente.</span><span class="sxs-lookup"><span data-stu-id="19244-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="19244-217">In particolare, `GetProductsSortedAsPagedDataSource` accetta un parametro di input aggiuntivo `sortExpression` e assegna questo valore per il `Sort` proprietà del `ProductDataTable` s `DefaultView`.</span><span class="sxs-lookup"><span data-stu-id="19244-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="19244-218">Poche righe di codice in un secondo momento, il `PagedDataSource` oggetto s DataSource viene assegnato il `ProductDataTable` s `DefaultView`.</span><span class="sxs-lookup"><span data-stu-id="19244-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="19244-219">La chiamata al metodo GetProductsSortedAsPagedDataSource e specificando il valore del parametro di Input SortExpression</span><span class="sxs-lookup"><span data-stu-id="19244-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="19244-220">Con la `GetProductsSortedAsPagedDataSource` metodo completo, il passaggio successivo consiste nel fornire il valore per questo parametro.</span><span class="sxs-lookup"><span data-stu-id="19244-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="19244-221">Oggetto ObjectDataSource `SortingWithDefaultPaging.aspx` è attualmente configurato per chiamare il `GetProductsAsPagedDataSource` metodo e passa due parametri di input tramite i relativi due `QueryStringParameters`, specificata nel `SelectParameters` raccolta.</span><span class="sxs-lookup"><span data-stu-id="19244-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="19244-222">Questi due `QueryStringParameters` indicano che l'origine per il `GetProductsAsPagedDataSource` metodo s *pageIndex* e *pageSize* parametri provengono dai campi querystring `pageIndex` e `pageSize`.</span><span class="sxs-lookup"><span data-stu-id="19244-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="19244-223">Aggiornare gli oggetti ObjectDataSource `SelectMethod` proprietà, in modo che si richiama il nuovo `GetProductsSortedAsPagedDataSource` (metodo).</span><span class="sxs-lookup"><span data-stu-id="19244-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="19244-224">Quindi, aggiungere una nuova `QueryStringParameter` in modo che il *sortExpression* parametro di input è accessibile del campo querystring `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="19244-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="19244-225">Impostare il `QueryStringParameter` s `DefaultValue` a ProductName.</span><span class="sxs-lookup"><span data-stu-id="19244-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="19244-226">Dopo tali modifiche, il markup dichiarativo di ObjectDataSource s dovrebbe essere simile:</span><span class="sxs-lookup"><span data-stu-id="19244-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample6.aspx)]

<span data-ttu-id="19244-227">A questo punto, il `SortingWithDefaultPaging.aspx` pagina verrà ordinare alfabeticamente i relativi risultati dal nome del prodotto (vedere la figura 9).</span><span class="sxs-lookup"><span data-stu-id="19244-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="19244-228">Questo avviene perché, per impostazione predefinita, viene passato un valore di ProductName come le `GetProductsSortedAsPagedDataSource` metodo s *sortExpression* parametro.</span><span class="sxs-lookup"><span data-stu-id="19244-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>


<span data-ttu-id="19244-229">[![Per impostazione predefinita, i risultati sono ordinati per ProductName](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="19244-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)</span></span>

<span data-ttu-id="19244-230">**Figura 9**: Per impostazione predefinita, i risultati vengono ordinati `ProductName` ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="19244-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image25.png))</span></span>


<span data-ttu-id="19244-231">Se si aggiunge manualmente un `sortExpression` campo stringa di query, ad esempio `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` verranno ordinati i risultati dall'oggetto specificato `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="19244-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="19244-232">Tuttavia, ciò `sortExpression` parametro non è incluso nella stringa di query quando si spostano in un'altra pagina di dati.</span><span class="sxs-lookup"><span data-stu-id="19244-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="19244-233">In effetti, facendo clic nella pagina successiva o ultimo pulsanti accetta Microsoft al `Paging.aspx`!</span><span class="sxs-lookup"><span data-stu-id="19244-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="19244-234">Inoltre, ci s attualmente alcun ordinamento non interfaccia.</span><span class="sxs-lookup"><span data-stu-id="19244-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="19244-235">L'unico modo che un utente può modificare l'ordinamento dei dati di paging è manipolando direttamente il parametro querystring.</span><span class="sxs-lookup"><span data-stu-id="19244-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="19244-236">Creazione dell'interfaccia di ordinamento</span><span class="sxs-lookup"><span data-stu-id="19244-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="19244-237">È necessario innanzitutto aggiornare il `RedirectUser` metodo per inviare all'utente `SortingWithDefaultPaging.aspx` (invece di `Paging.aspx`) e includere il `sortExpression` valore nella stringa di query.</span><span class="sxs-lookup"><span data-stu-id="19244-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="19244-238">Va inoltre aggiunto una sola lettura, a livello di pagina denominato `SortExpression` proprietà.</span><span class="sxs-lookup"><span data-stu-id="19244-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="19244-239">Questa proprietà, simile al `PageIndex` e `PageSize` proprietà creata nell'esercitazione precedente, restituisce il valore della `sortExpression` campo querystring se presente e il valore predefinito (ProductName) in caso contrario.</span><span class="sxs-lookup"><span data-stu-id="19244-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="19244-240">Attualmente il `RedirectUser` metodo accetta solo un singolo parametro di input l'indice della pagina da visualizzare.</span><span class="sxs-lookup"><span data-stu-id="19244-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="19244-241">Tuttavia, potrebbero esserci casi è necessario reindirizzare l'utente a una determinata pagina di dati usando un'espressione di ordinamento diverso da quali s specificato nella stringa di query.</span><span class="sxs-lookup"><span data-stu-id="19244-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="19244-242">In un momento in cui verrà creato l'interfaccia di ordinamento per questa pagina, che include una serie di controlli Web di pulsante per l'ordinamento dei dati da una colonna specificata.</span><span class="sxs-lookup"><span data-stu-id="19244-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="19244-243">Quando viene selezionato uno di questi pulsanti, si desidera reindirizzare l'utente passando il valore di espressione di ordinamento appropriato.</span><span class="sxs-lookup"><span data-stu-id="19244-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="19244-244">Per fornire questa funzionalità, creare due versioni del `RedirectUser` (metodo).</span><span class="sxs-lookup"><span data-stu-id="19244-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="19244-245">Il primo deve accettare solo l'indice della pagina da visualizzare, mentre il secondo accetta l'espressione di indice e di ordinamento di pagina.</span><span class="sxs-lookup"><span data-stu-id="19244-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample7.vb)]

<span data-ttu-id="19244-246">Nel primo esempio in questa esercitazione, abbiamo creato un'interfaccia di ordinamento usando un controllo DropDownList.</span><span class="sxs-lookup"><span data-stu-id="19244-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="19244-247">Per questo esempio, s ti permettono di usare tre controlli pulsante Web posizionati di sopra di DataList uno per l'ordinamento in base `ProductName`, uno per `CategoryName`e uno per `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="19244-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="19244-248">Aggiungere i tre controlli pulsante Web, l'impostazione loro `ID` e `Text` proprietà in modo appropriato:</span><span class="sxs-lookup"><span data-stu-id="19244-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample8.aspx)]

<span data-ttu-id="19244-249">Creare quindi un `Click` gestore eventi per ognuno.</span><span class="sxs-lookup"><span data-stu-id="19244-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="19244-250">I gestori di eventi devono chiamare il `RedirectUser` (metodo), restituzione all'utente per la prima pagina utilizzando l'espressione di ordinamento appropriato.</span><span class="sxs-lookup"><span data-stu-id="19244-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample9.vb)]

<span data-ttu-id="19244-251">Durante la prima visita la pagina, i dati sono ordinati per il nome del prodotto in ordine alfabetico (vedere la figura 9).</span><span class="sxs-lookup"><span data-stu-id="19244-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="19244-252">Fare clic sul pulsante Avanti per passare alla seconda pagina di dati, quindi scegliere l'ordinamento dal pulsante di categoria.</span><span class="sxs-lookup"><span data-stu-id="19244-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="19244-253">Questo ci riporta alla prima pagina di dati, ordinati in base al nome di categoria (vedere la figura 10).</span><span class="sxs-lookup"><span data-stu-id="19244-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="19244-254">Analogamente, scegliendo l'ordinamento dal pulsante di fornitore Ordina i dati dal fornitore a partire dalla prima pagina di dati.</span><span class="sxs-lookup"><span data-stu-id="19244-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="19244-255">La scelta di ordinamento viene memorizzata come viene eseguito il paging attraverso i dati.</span><span class="sxs-lookup"><span data-stu-id="19244-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="19244-256">Figura 11 mostra la pagina dopo l'ordinamento in base alla categoria e quindi procedendo alla pagina tredicesima dei dati.</span><span class="sxs-lookup"><span data-stu-id="19244-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>


<span data-ttu-id="19244-257">[![I prodotti sono ordinati per categoria](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="19244-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)</span></span>

<span data-ttu-id="19244-258">**Figura 10**: I prodotti sono ordinati per categoria ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="19244-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image28.png))</span></span>


<span data-ttu-id="19244-259">[![L'espressione di ordinamento sono memorizzate quando il Paging attraverso il dati](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="19244-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image29.png)</span></span>

<span data-ttu-id="19244-260">**Figura 11**: L'espressione di ordinamento sono memorizzate quando il Paging attraverso il dati ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="19244-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image31.png))</span></span>


## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="19244-261">Passaggio 6: Paging personalizzato i record in un controllo Repeater</span><span class="sxs-lookup"><span data-stu-id="19244-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="19244-262">Nell'esempio di DataList esaminato nel passaggio 5 pagine tramite i relativi dati tramite la tecnica di paging predefinito inefficiente.</span><span class="sxs-lookup"><span data-stu-id="19244-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="19244-263">Quando il paging attraverso sufficientemente grandi quantità di dati, è fondamentale che essere utilizzato il paging personalizzato.</span><span class="sxs-lookup"><span data-stu-id="19244-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="19244-264">Nel [in modo efficiente il Paging attraverso quantità di dati di grandi dimensioni](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) e [ordinamento personalizzato dei dati di paging](../paging-and-sorting/sorting-custom-paged-data-vb.md) esercitazioni, sono state esaminate le differenze tra predefinito e il paging personalizzato e i metodi creati nel livello BLL per utilizzo personalizzato di paging e ordinamento dei dati di paging personalizzati.</span><span class="sxs-lookup"><span data-stu-id="19244-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-vb.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="19244-265">In particolare, in queste due esercitazioni precedenti abbiamo aggiunto i tre metodi seguenti per il `ProductsBLL` classe:</span><span class="sxs-lookup"><span data-stu-id="19244-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="19244-266">`GetProductsPaged(startRowIndex, maximumRows)` Restituisce un sottoinsieme particolare di record partire *startRowIndex* e non supera *maximumRows*.</span><span class="sxs-lookup"><span data-stu-id="19244-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="19244-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` Restituisce un sottoinsieme particolare di record ordinati in base ai valori *sortExpression* parametro di input.</span><span class="sxs-lookup"><span data-stu-id="19244-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="19244-268">`TotalNumberOfProducts()` fornisce il numero totale di record nel `Products` tabella di database.</span><span class="sxs-lookup"><span data-stu-id="19244-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="19244-269">Questi metodi sono utilizzabile per pagina e ordinare i dati usando un controllo DataList o Repeater in modo efficiente.</span><span class="sxs-lookup"><span data-stu-id="19244-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="19244-270">Per illustrare questo concetto, consentire s iniziare creando un controllo Repeater con supporto di paging personalizzato; verrà quindi aggiunto funzionalità di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="19244-271">Aprire il `SortingWithCustomPaging.aspx` nella pagina la `PagingSortingDataListRepeater` cartella e aggiungere un controllo Repeater alla pagina di impostazione relativo `ID` proprietà `Products`.</span><span class="sxs-lookup"><span data-stu-id="19244-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="19244-272">Nello smart tag Repeater s, creare un nuovo oggetto ObjectDataSource denominato `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="19244-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="19244-273">Per selezionare i dati da configurare il `ProductsBLL` classe s `GetProductsPaged` (metodo).</span><span class="sxs-lookup"><span data-stu-id="19244-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>


<span data-ttu-id="19244-274">[![Configurare ObjectDataSource per usare il metodo GetProductsPaged ProductsBLL classe s](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="19244-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image32.png)</span></span>

<span data-ttu-id="19244-275">**Figura 12**: Configurare ObjectDataSource per usare la `ProductsBLL` classe s `GetProductsPaged` metodo ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="19244-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image34.png))</span></span>


<span data-ttu-id="19244-276">Impostare gli elenchi a discesa nell'aggiornamento, inserimento, eliminare le schede su (nessuno) e quindi fare clic sul pulsante Avanti.</span><span class="sxs-lookup"><span data-stu-id="19244-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="19244-277">La procedura guidata Configura origine dati viene ora richiesto per le origini del `GetProductsPaged` metodo s *startRowIndex* e *maximumRows* parametri di input.</span><span class="sxs-lookup"><span data-stu-id="19244-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="19244-278">In realtà, questi parametri di input vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="19244-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="19244-279">Al contrario, il *startRowIndex* e *maximumRows* valori verranno passati nel `Arguments` proprietà in s ObjectDataSource `Selecting` gestore eventi, come modo in cui è stato specificato il *sortExpression* in questa demo prima esercitazione s.</span><span class="sxs-lookup"><span data-stu-id="19244-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="19244-280">Pertanto, lasciare l'origine del parametro elenchi a discesa nella procedura guidata impostato su None.</span><span class="sxs-lookup"><span data-stu-id="19244-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>


<span data-ttu-id="19244-281">[![Lasciare il Set di origini di parametri su Nessuno](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="19244-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image35.png)</span></span>

<span data-ttu-id="19244-282">**Figura 13**: Lasciare le origini di parametro impostato su None ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="19244-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image37.png))</span></span>


> [!NOTE]
> <span data-ttu-id="19244-283">Effettuare *non* impostare la s ObjectDataSource `EnablePaging` proprietà `true`.</span><span class="sxs-lookup"><span data-stu-id="19244-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="19244-284">In questo modo ObjectDataSource includere automaticamente il proprio *startRowIndex* e *maximumRows* parametri per il `SelectMethod` elenco parametri esistenti s.</span><span class="sxs-lookup"><span data-stu-id="19244-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="19244-285">Il `EnablePaging` proprietà è utile quando l'associazione personalizzata di paging dei dati a un controllo GridView, DetailsView e FormView perché questi controlli prevedono determinati comportamenti da ObjectDataSource che s è disponibile solo quando `EnablePaging` è di proprietà `true`.</span><span class="sxs-lookup"><span data-stu-id="19244-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="19244-286">Poiché è necessario aggiungere manualmente il supporto di paging per DataList e Repeater, lasciare impostata questa proprietà su `false` (impostazione predefinita), come verrà fanno parte della funzionalità necessarie direttamente all'interno di nostra pagina ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="19244-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>


<span data-ttu-id="19244-287">Infine, definire il Repeater s `ItemTemplate` in modo che vengano visualizzati il nome del prodotto s, categoria e fornitore.</span><span class="sxs-lookup"><span data-stu-id="19244-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="19244-288">Dopo tali modifiche, la sintassi dichiarativa s Repeater e ObjectDataSource dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="19244-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample10.aspx)]

<span data-ttu-id="19244-289">Si consiglia di visitare la pagina tramite un browser e notare che viene restituito alcun record.</span><span class="sxs-lookup"><span data-stu-id="19244-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="19244-290">Infatti è ve ancora per specificare il *startRowIndex* e *maximumRows* i valori dei parametri; pertanto, vengono passati i valori 0 per entrambi.</span><span class="sxs-lookup"><span data-stu-id="19244-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="19244-291">Per specificare questi valori, creare un gestore eventi per gli oggetti ObjectDataSource `Selecting` eventi e impostare questi parametri di valori a livello di codice ai valori impostati come hardcoded pari a 0 e 5, rispettivamente:</span><span class="sxs-lookup"><span data-stu-id="19244-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample11.vb)]

<span data-ttu-id="19244-292">Con questa modifica, la pagina, quando viene visualizzato tramite un browser, Mostra i primi cinque prodotti.</span><span class="sxs-lookup"><span data-stu-id="19244-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>


<span data-ttu-id="19244-293">[![Vengono visualizzati i primi cinque record](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="19244-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image38.png)</span></span>

<span data-ttu-id="19244-294">**Figura 14**: Vengono visualizzati i primi cinque record ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="19244-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image40.png))</span></span>


> [!NOTE]
> <span data-ttu-id="19244-295">I prodotti elencati nella figura 14 si verificano in base a nome del prodotto perché il `GetProductsPaged` stored procedure che esegue la query di paging personalizzata efficiente Ordina i risultati in base `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="19244-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>


<span data-ttu-id="19244-296">Per consentire all'utente di scorrere le pagine, è necessario tenere traccia dell'indice di riga iniziale e il numero massimo di righe e ricordare questi valori durante i postback.</span><span class="sxs-lookup"><span data-stu-id="19244-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="19244-297">Nell'esempio di paging predefinito è stato usato campi querystring in modo permanente di tali valori. per questa demo, consentire s mantenere queste informazioni nello stato di visualizzazione pagina s.</span><span class="sxs-lookup"><span data-stu-id="19244-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="19244-298">Creare le due proprietà seguenti:</span><span class="sxs-lookup"><span data-stu-id="19244-298">Create the following two properties:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample12.vb)]

<span data-ttu-id="19244-299">Successivamente, aggiornare il codice nel gestore dell'evento quando si seleziona in modo che utilizzi il `StartRowIndex` e `MaximumRows` proprietà anziché i valori hardcoded pari a 0 e 5:</span><span class="sxs-lookup"><span data-stu-id="19244-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample13.vb)]

<span data-ttu-id="19244-300">A questo punto la pagina Mostra ancora solo i primi cinque record.</span><span class="sxs-lookup"><span data-stu-id="19244-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="19244-301">Tuttavia, con queste proprietà sul posto, sono pronti per creare l'interfaccia di paging.</span><span class="sxs-lookup"><span data-stu-id="19244-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="19244-302">Aggiunta dell'interfaccia di Paging</span><span class="sxs-lookup"><span data-stu-id="19244-302">Adding the Paging Interface</span></span>

<span data-ttu-id="19244-303">"Let" uso il primo stesso, precedente, successivo, paging ultima interfaccia utilizzata per l'esempio di paging predefinito, tra cui Web etichetta controllo che visualizza la pagina di dati viene visualizzato e il numero totale di pagine esistano.</span><span class="sxs-lookup"><span data-stu-id="19244-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="19244-304">Aggiungere i quattro controlli pulsante Web ed etichetta sotto il controllo Repeater.</span><span class="sxs-lookup"><span data-stu-id="19244-304">Add the four Button Web controls and Label below the Repeater.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample14.aspx)]

<span data-ttu-id="19244-305">A questo punto, creare `Click` gestori eventi per i quattro pulsanti.</span><span class="sxs-lookup"><span data-stu-id="19244-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="19244-306">Quando viene scelto uno di questi pulsanti, è necessario aggiornare il `StartRowIndex` riassociare i dati al controllo Repeater.</span><span class="sxs-lookup"><span data-stu-id="19244-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="19244-307">Il codice per i pulsanti prima, indietro e Avanti è abbastanza semplice, ma per l'ultimo pulsante come si determina l'indice di riga iniziale per l'ultima pagina di dati?</span><span class="sxs-lookup"><span data-stu-id="19244-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="19244-308">Per calcolare l'indice, nonché la possibilità di determinare che se i pulsanti Avanti e ultima devono essere abilitati è necessario conoscere il numero di record in totale è il paging attraverso.</span><span class="sxs-lookup"><span data-stu-id="19244-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="19244-309">È possibile determinare questo chiamando il `ProductsBLL` classe s `TotalNumberOfProducts()` (metodo).</span><span class="sxs-lookup"><span data-stu-id="19244-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="19244-310">S ti permettono di creare una proprietà di sola lettura, a livello di pagina denominata `TotalRowCount` che restituisce i risultati del `TotalNumberOfProducts()` metodo:</span><span class="sxs-lookup"><span data-stu-id="19244-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample15.vb)]

<span data-ttu-id="19244-311">Con questa proprietà è ora possibile determinare l'ultimo indice di riga di inizio pagina s.</span><span class="sxs-lookup"><span data-stu-id="19244-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="19244-312">In particolare, è s il risultato dell'intero del `TotalRowCount` meno 1 diviso `MaximumRows`moltiplicato per `MaximumRows`.</span><span class="sxs-lookup"><span data-stu-id="19244-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="19244-313">È possibile scrivere il `Click` gestori eventi per i quattro pulsanti di interfaccia di paging:</span><span class="sxs-lookup"><span data-stu-id="19244-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample16.vb)]

<span data-ttu-id="19244-314">Infine, è necessario disabilitare i pulsanti del primo e precedente nell'interfaccia di paging, quando si visualizzano la prima pagina di dati e i pulsanti Avanti e ultimi quando si visualizza l'ultima pagina.</span><span class="sxs-lookup"><span data-stu-id="19244-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="19244-315">A tale scopo, aggiungere il codice seguente al s ObjectDataSource `Selecting` gestore dell'evento:</span><span class="sxs-lookup"><span data-stu-id="19244-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample17.vb)]

<span data-ttu-id="19244-316">Dopo aver aggiunto queste `Click` gestori eventi e il codice per abilitare o disabilitare gli elementi di interfaccia di paging in base all'indice di riga iniziale corrente, la pagina di test in un browser.</span><span class="sxs-lookup"><span data-stu-id="19244-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="19244-317">Come illustrato nella figura 15, durante la prima visita la pagina prima e i pulsanti Indietro verranno sono disabilitati.</span><span class="sxs-lookup"><span data-stu-id="19244-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="19244-318">Selezione di Avanti Mostra la seconda pagina di dati, mentre facendo clic su ultima verrà visualizzata la pagina finale (vedere figure 16 e 17).</span><span class="sxs-lookup"><span data-stu-id="19244-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="19244-319">Quando si visualizza l'ultima pagina di dati sono disabilitati i pulsanti Avanti sia l'ultimo.</span><span class="sxs-lookup"><span data-stu-id="19244-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>


<span data-ttu-id="19244-320">[![I pulsanti Indietro e ultimo sono disabilitati durante la visualizzazione di pagina prima dei prodotti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="19244-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image41.png)</span></span>

<span data-ttu-id="19244-321">**Figura 15**: I pulsanti Indietro e ultimo sono disabilitati durante la visualizzazione di pagina prima di prodotti ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="19244-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image43.png))</span></span>


<span data-ttu-id="19244-322">[![La seconda pagina di prodotti sono applicato all'intero](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="19244-322">[![The Second Page of Products are Dispalyed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image44.png)</span></span>

<span data-ttu-id="19244-323">**Figura 16**: La seconda pagina di prodotti sono applicato all'intero ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="19244-323">**Figure 16**: The Second Page of Products are Dispalyed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image46.png))</span></span>


<span data-ttu-id="19244-324">[![Facendo clic su ultima consente di visualizzare la pagina finale dei dati](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="19244-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image47.png)</span></span>

<span data-ttu-id="19244-325">**Figura 17**: Fare clic su ultima visualizzare la pagina di dati finale ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="19244-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image49.png))</span></span>


## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="19244-326">Passaggio 7: Tra cui supporto con l'oggetto personalizzato di ordinamento di paging Repeater</span><span class="sxs-lookup"><span data-stu-id="19244-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="19244-327">Ora che è stato implementato il paging personalizzato, sono pronti per includere l'ordinamento supportati.</span><span class="sxs-lookup"><span data-stu-id="19244-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="19244-328">Il `ProductsBLL` classe s `GetProductsPagedAndSorted` metodo ha lo stesso *startRowIndex* e *maximumRows* come parametri di input `GetProductsPaged`, ma consente un'ulteriore  *sortExpression* parametro di input.</span><span class="sxs-lookup"><span data-stu-id="19244-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="19244-329">Usare il `GetProductsPagedAndSorted` metodo `SortingWithCustomPaging.aspx`, è necessario eseguire la procedura seguente:</span><span class="sxs-lookup"><span data-stu-id="19244-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="19244-330">Modificare gli oggetti ObjectDataSource `SelectMethod` proprietà dal `GetProductsPaged` a `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="19244-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="19244-331">Aggiungere un *sortExpression* `Parameter` oggetto ObjectDataSource s `SelectParameters` raccolta.</span><span class="sxs-lookup"><span data-stu-id="19244-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="19244-332">Creare una privata, a livello di pagina `SortExpression` proprietà che rende persistente il valore di postback tramite lo stato di visualizzazione pagina s.</span><span class="sxs-lookup"><span data-stu-id="19244-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="19244-333">Aggiornare gli oggetti ObjectDataSource `Selecting` gestore dell'evento per assegnare gli oggetti ObjectDataSource *sortExpression* parametro il valore del livello di pagina `SortExpression` proprietà.</span><span class="sxs-lookup"><span data-stu-id="19244-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="19244-334">Creare l'interfaccia di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-334">Create the sorting interface.</span></span>

<span data-ttu-id="19244-335">Per iniziare, aggiornare gli oggetti ObjectDataSource `SelectMethod` proprietà e l'aggiunta di un *sortExpression* `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="19244-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="19244-336">Assicurarsi che il *sortExpression* `Parameter` s `Type` viene impostata su `String`.</span><span class="sxs-lookup"><span data-stu-id="19244-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="19244-337">Dopo aver completato le prime due attività, il markup dichiarativo di ObjectDataSource s dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="19244-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample18.aspx)]

<span data-ttu-id="19244-338">Successivamente, è necessario un livello di pagina `SortExpression` proprietà il cui valore viene serializzato in stato di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="19244-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="19244-339">Se non è stato impostato alcun valore di espressione di ordinamento, usare ProductName come valore predefinito:</span><span class="sxs-lookup"><span data-stu-id="19244-339">If no sort expression value has been set, use ProductName as the default:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample19.vb)]

<span data-ttu-id="19244-340">Prima di ObjectDataSource richiama il `GetProductsPagedAndSorted` metodo è necessario impostare la *sortExpression* `Parameter` al valore della `SortExpression` proprietà.</span><span class="sxs-lookup"><span data-stu-id="19244-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="19244-341">Nel `Selecting` gestore dell'evento, aggiungere la riga di codice seguente:</span><span class="sxs-lookup"><span data-stu-id="19244-341">In the `Selecting` event handler, add the following line of code:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample20.vb)]

<span data-ttu-id="19244-342">Tutto resta che implementano l'interfaccia di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="19244-343">Come è stato fatto nell'ultimo esempio, consentire s hanno l'ordinamento interfaccia implementata usando tre controlli pulsante Web che consentono all'utente di ordinare i risultati dal nome del prodotto, categoria o fornitore.</span><span class="sxs-lookup"><span data-stu-id="19244-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample21.aspx)]

<span data-ttu-id="19244-344">Creare `Click` gestori eventi per questi tre controlli pulsante.</span><span class="sxs-lookup"><span data-stu-id="19244-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="19244-345">Nell'evento gestore, reimpostare il `StartRowIndex` su 0, viene impostata la `SortExpression` sul valore appropriato, e i dati al controllo Repeater riassociazione:</span><span class="sxs-lookup"><span data-stu-id="19244-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample22.vb)]

<span data-ttu-id="19244-346">Che s ne è a esso.</span><span class="sxs-lookup"><span data-stu-id="19244-346">That s all there is to it!</span></span> <span data-ttu-id="19244-347">Mentre si sono verificati alcuni passaggi per ottenere il paging personalizzato e l'ordinamento implementato, i passaggi sono molto simili a quelli necessari per il paging predefinito.</span><span class="sxs-lookup"><span data-stu-id="19244-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="19244-348">Figura 18 Mostra i prodotti quando si visualizza l'ultima pagina di dati quando ordinato in base alla categoria.</span><span class="sxs-lookup"><span data-stu-id="19244-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>


<span data-ttu-id="19244-349">[![Viene visualizzata l'ultima pagina di dati, ordinato in base alla categoria,](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="19244-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image50.png)</span></span>

<span data-ttu-id="19244-350">**Figura 18**: L'ultima pagina di dati, ordinato in base alla categoria, viene visualizzata ([fare clic per visualizzare l'immagine con dimensioni normali](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="19244-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image52.png))</span></span>


> [!NOTE]
> <span data-ttu-id="19244-351">Negli esempi precedenti, durante l'ordinamento dal fornitore che suppliername è stato usato come espressione di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="19244-352">Tuttavia, per l'implementazione di paging personalizzata, è necessario usare CompanyName.</span><span class="sxs-lookup"><span data-stu-id="19244-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="19244-353">Infatti, la stored procedure responsabile dell'implementazione di paging personalizzato `GetProductsPagedAndSorted` passa l'espressione di ordinamento nel `ROW_NUMBER()` (parola chiave), il `ROW_NUMBER()` (parola chiave) richiede il nome di colonna effettivi anziché un alias.</span><span class="sxs-lookup"><span data-stu-id="19244-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="19244-354">Pertanto, è necessario usare `CompanyName` (il nome della colonna nella `Suppliers` tabella) piuttosto che l'alias usato nel `SELECT` query (`SupplierName`) per l'espressione di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>


## <a name="summary"></a><span data-ttu-id="19244-355">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="19244-355">Summary</span></span>

<span data-ttu-id="19244-356">Né il DataList o Repeater offrono il supporto dell'ordinamento predefinito, ma con un po' di codice e un'interfaccia di ordinamento personalizzata, è possibile aggiungere tale funzionalità.</span><span class="sxs-lookup"><span data-stu-id="19244-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="19244-357">Quando si implementa l'ordinamento, ma non di paging, l'espressione di ordinamento può essere specificata tramite il `DataSourceSelectArguments` oggetto passato in oggetti ObjectDataSource `Select` (metodo).</span><span class="sxs-lookup"><span data-stu-id="19244-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="19244-358">Ciò `DataSourceSelectArguments` oggetto s' `SortExpression` proprietà può essere assegnata in s ObjectDataSource `Selecting` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="19244-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="19244-359">Per aggiungere funzionalità di ordinamento per un controllo DataList o Repeater che fornisce già il supporto di paging, l'approccio più semplice consiste nel personalizzare il livello di logica di Business in modo da includere un metodo che accetta un'espressione di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="19244-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="19244-360">Queste informazioni possono quindi essere passate nel tramite un parametro in s ObjectDataSource `SelectParameters`.</span><span class="sxs-lookup"><span data-stu-id="19244-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="19244-361">Questa esercitazione si completa l'esame del paging e ordinamento con DataList e Repeater.</span><span class="sxs-lookup"><span data-stu-id="19244-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="19244-362">L'esercitazione successiva e finale verrà esaminate come aggiungere controlli pulsante Web per i modelli di s DataList e Repeater per offrire alcune funzionalità personalizzata, avviata dall'utente su una base per ogni elemento.</span><span class="sxs-lookup"><span data-stu-id="19244-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="19244-363">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="19244-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="19244-364">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="19244-364">About the Author</span></span>

<span data-ttu-id="19244-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="19244-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="19244-366">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="19244-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="19244-367">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="19244-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="19244-368">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="19244-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="19244-369">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="19244-369">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="19244-370">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="19244-370">Special Thanks To</span></span>

<span data-ttu-id="19244-371">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="19244-371">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="19244-372">Il revisore capo di questa esercitazione è stata David Suru.</span><span class="sxs-lookup"><span data-stu-id="19244-372">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="19244-373">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="19244-373">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="19244-374">In questo caso, Inviami una riga in corrispondenza [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="19244-374">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="19244-375">Precedente</span><span class="sxs-lookup"><span data-stu-id="19244-375">Previous</span></span>](paging-report-data-in-a-datalist-or-repeater-control-vb.md)
