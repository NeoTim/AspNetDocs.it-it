---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
title: Creazione di un livello di accesso ai dati (c#) | Microsoft Docs
author: rick-anderson
description: In questa esercitazione verrà avviare sin dall'inizio e creare Data Access Layer (DAL), usando i dataset tipizzati, accedere alle informazioni in un database.
ms.author: riande
ms.date: 04/05/2010
ms.assetid: cfe2a6a0-1e56-4dc8-9537-c8ec76ba96a4
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
msc.type: authoredcontent
ms.openlocfilehash: 4a6942df142ef40b92a8461afbc5f61fdfbde4ba
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/01/2019
ms.locfileid: "57037848"
---
<a name="creating-a-data-access-layer-c"></a><span data-ttu-id="bbce2-103">Creazione di un livello di accesso ai dati (C#)</span><span class="sxs-lookup"><span data-stu-id="bbce2-103">Creating a Data Access Layer (C#)</span></span>
====================
<span data-ttu-id="bbce2-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="bbce2-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="bbce2-105">Scaricare PDF</span><span class="sxs-lookup"><span data-stu-id="bbce2-105">Download PDF</span></span>](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)

> <span data-ttu-id="bbce2-106">In questa esercitazione verrà avviare sin dall'inizio e creare Data Access Layer (DAL), usando i dataset tipizzati, accedere alle informazioni in un database.</span><span class="sxs-lookup"><span data-stu-id="bbce2-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>


## <a name="introduction"></a><span data-ttu-id="bbce2-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="bbce2-107">Introduction</span></span>

<span data-ttu-id="bbce2-108">Gli sviluppatori web nostre vite ruotano intorno utilizzo dei dati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="bbce2-109">Creiamo database per archiviare i dati, il codice per recuperare e apportarvi modifiche e le pagine web per raccogliere e riepilogarla.</span><span class="sxs-lookup"><span data-stu-id="bbce2-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="bbce2-110">Questa è la prima esercitazione di una serie di lunga durata che verranno illustrate le tecniche di implementazione di questi modelli comuni di ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="bbce2-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="bbce2-111">Si inizierà con la creazione di un [architettura software](http://en.wikipedia.org/wiki/Software_architecture) composte di una Data Access Layer (DAL) utilizzo dei dataset tipizzati, un livello di logica di Business (BLL) che verranno applicate le regole di business personalizzata e un livello di presentazione composto da ASP.NET le pagine che condividere un layout di pagina comuni.</span><span class="sxs-lookup"><span data-stu-id="bbce2-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="bbce2-112">Una volta poste presupposti questo back-end, verrà spostato nella creazione di report, che illustra come visualizzare, riepilogare, raccogliere e convalidare i dati da un'applicazione web.</span><span class="sxs-lookup"><span data-stu-id="bbce2-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="bbce2-113">Queste esercitazioni sono pensate per essere concise e vengono fornite istruzioni dettagliate con numerose catture di schermata che illustra il processo in modo visivo.</span><span class="sxs-lookup"><span data-stu-id="bbce2-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="bbce2-114">Ogni esercitazione è disponibile nelle versioni di Visual Basic e c# e comprende un download del codice completo utilizzato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="bbce2-115">(Questa prima esercitazione di è abbastanza lunga, ma il resto vengono presentati in base a blocchi molto più semplice).</span><span class="sxs-lookup"><span data-stu-id="bbce2-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="bbce2-116">Per queste esercitazioni si userà una versione di Microsoft SQL Server 2005 Express Edition del database Northwind inserito nel **App\_dati** directory.</span><span class="sxs-lookup"><span data-stu-id="bbce2-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the **App\_Data** directory.</span></span> <span data-ttu-id="bbce2-117">Oltre al file di database, il **App\_dati** cartella contiene anche gli script SQL per la creazione del database, nel caso in cui si vuole usare una versione di database diverso.</span><span class="sxs-lookup"><span data-stu-id="bbce2-117">In addition to the database file, the **App\_Data** folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="bbce2-118">Questi script possono anche essere [scaricati direttamente da Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), se si preferisce.</span><span class="sxs-lookup"><span data-stu-id="bbce2-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="bbce2-119">Se si usa una versione diversa di SQL Server del database Northwind, è necessario aggiornare il **stringa NORTHWNDConnectionString** l'impostazione dell'applicazione **Web. config** file.</span><span class="sxs-lookup"><span data-stu-id="bbce2-119">If you use a different SQL Server version of the Northwind database, you will need to update the **NORTHWNDConnectionString** setting in the application's **Web.config** file.</span></span> <span data-ttu-id="bbce2-120">L'applicazione web è stato creato usando Visual Studio 2005 Professional Edition come un file di progetto di sito Web basato su sistema.</span><span class="sxs-lookup"><span data-stu-id="bbce2-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="bbce2-121">Tuttavia, tutte le esercitazioni funzioneranno altrettanto bene con la versione gratuita di Visual Studio 2005, [in Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span><span class="sxs-lookup"><span data-stu-id="bbce2-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>  
  
<span data-ttu-id="bbce2-122">In questa esercitazione verrà avviare sin dall'inizio e creare la Data Access Layer (DAL), seguita dalla creazione il livello per la logica di Business (BLL) nella seconda esercitazione e l'utilizzo nel layout di pagina e la navigazione nel terzo.</span><span class="sxs-lookup"><span data-stu-id="bbce2-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the Business Logic Layer (BLL) in the second tutorial, and working on page layout and navigation in the third.</span></span> <span data-ttu-id="bbce2-123">Le esercitazioni dopo il terzo verrà si basano le basi di cui le prime tre.</span><span class="sxs-lookup"><span data-stu-id="bbce2-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="bbce2-124">Abbiamo molti trattati in questa prima esercitazione, quindi avvia Visual Studio prima di iniziare.</span><span class="sxs-lookup"><span data-stu-id="bbce2-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="bbce2-125">Passaggio 1: Creazione di un progetto Web e la connessione al Database</span><span class="sxs-lookup"><span data-stu-id="bbce2-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="bbce2-126">Prima di poter creare la Data Access Layer (DAL), è innanzitutto necessario creare un sito web e configurare il database.</span><span class="sxs-lookup"><span data-stu-id="bbce2-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="bbce2-127">Iniziare creando un nuovo file in base al sistema sito web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="bbce2-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="bbce2-128">A tale scopo, passare al menu File e scegliere Nuovo sito Web, la finestra di dialogo Nuovo sito Web.</span><span class="sxs-lookup"><span data-stu-id="bbce2-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="bbce2-129">Scegliere il modello di sito Web ASP.NET, impostare l'elenco di riepilogo a discesa percorso al File System, scegliere una cartella in cui inserire il sito web e impostare il linguaggio c#.</span><span class="sxs-lookup"><span data-stu-id="bbce2-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to C#.</span></span>


<span data-ttu-id="bbce2-130">[![Creare un nuovo sito di Web File basate sul sistema](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span></span>

<span data-ttu-id="bbce2-131">**Figura 1**: Creare un sito Web New File System-Based ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image3.png))</span></span>


<span data-ttu-id="bbce2-132">Verrà creato un nuovo sito web con un **default. aspx** pagina ASP.NET e un **App\_dati** cartella.</span><span class="sxs-lookup"><span data-stu-id="bbce2-132">This will create a new web site with a **Default.aspx** ASP.NET page and an **App\_Data** folder.</span></span>

<span data-ttu-id="bbce2-133">Con il sito web creato, il passaggio successivo consiste nell'aggiungere un riferimento al database in Esplora Server di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bbce2-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="bbce2-134">Tramite l'aggiunta di un database in Esplora Server è possibile aggiungere tabelle, stored procedure, viste e così via tutto da Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bbce2-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="bbce2-135">È anche possibile visualizzare i dati della tabella o creare query personalizzate manualmente o graficamente tramite il generatore delle Query.</span><span class="sxs-lookup"><span data-stu-id="bbce2-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="bbce2-136">Inoltre, quando si compila il set di dati tipizzato per DAL è necessario a punto di Visual Studio per il database da cui deve essere costruito i set di dati tipizzato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="bbce2-137">Anche se è possibile fornire queste informazioni di connessione a quel punto nel tempo, Visual Studio popola automaticamente un elenco di riepilogo a discesa dei database di cui è già registrato in Esplora Server.</span><span class="sxs-lookup"><span data-stu-id="bbce2-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="bbce2-138">La procedura per aggiungere il database Northwind in Esplora Server dipende dal fatto che si desidera utilizzare il database di SQL Server 2005 Express Edition nel **App\_dati** cartella o se si dispone di Microsoft SQL Server 2000 o 2005 impostazione di server di database che si desidera utilizzare in alternativa.</span><span class="sxs-lookup"><span data-stu-id="bbce2-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the **App\_Data** folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-theappdatafolder"></a><span data-ttu-id="bbce2-139">Uso di un Database in theApp\_DataFolder</span><span class="sxs-lookup"><span data-stu-id="bbce2-139">Using a Database in theApp\_DataFolder</span></span>

<span data-ttu-id="bbce2-140">Se non è SQL Server 2000 o 2005 database server per connettersi a, o semplicemente si desidera evitare di dover aggiungere il database a un server di database, è possibile usare la versione di SQL Server 2005 Express Edition del database Northwind cui si trova il preesistente scaricato e's **App\_Data** cartella (**NORTHWND. File MDF**).</span><span class="sxs-lookup"><span data-stu-id="bbce2-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's **App\_Data** folder (**NORTHWND.MDF**).</span></span>

<span data-ttu-id="bbce2-141">Un database inseriti nel **App\_dati** cartella viene aggiunto automaticamente a Esplora Server.</span><span class="sxs-lookup"><span data-stu-id="bbce2-141">A database placed in the **App\_Data** folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="bbce2-142">Presupponendo che siano installati nel computer SQL Server 2005 Express Edition dovrebbe essere un nodo denominato NORTHWND. File MDF in Esplora Server, che è possibile espandere ed esplorare le tabelle, viste, stored procedure e così via (vedere la figura 2).</span><span class="sxs-lookup"><span data-stu-id="bbce2-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="bbce2-143">Il **App\_Data** cartella può contenere anche Microsoft Access **mdb** file, che, analogamente alle relative controparti di SQL Server, vengono aggiunti automaticamente a Esplora Server.</span><span class="sxs-lookup"><span data-stu-id="bbce2-143">The **App\_Data** folder can also hold Microsoft Access **.mdb** files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="bbce2-144">Se non si desidera usare una delle opzioni di SQL Server, è sempre possibile [scaricare una versione di Microsoft Access del file di database Northwind](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) trascinamento della selezione nel **App\_dati** directory.</span><span class="sxs-lookup"><span data-stu-id="bbce2-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the **App\_Data** directory.</span></span> <span data-ttu-id="bbce2-145">Tenere presente, tuttavia, che non sono i database di Access come ricco di funzionalità di SQL Server e non sono progettati per essere usata negli scenari di sito web.</span><span class="sxs-lookup"><span data-stu-id="bbce2-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="bbce2-146">Inoltre, un paio delle esercitazioni 35 + userà alcune funzionalità a livello di database che non sono supportate per l'accesso.</span><span class="sxs-lookup"><span data-stu-id="bbce2-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="bbce2-147">La connessione al Database in un Server di Database Microsoft SQL Server 2000 o 2005</span><span class="sxs-lookup"><span data-stu-id="bbce2-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="bbce2-148">In alternativa, è possibile connettersi a un database di Northwind installato in un server di database.</span><span class="sxs-lookup"><span data-stu-id="bbce2-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="bbce2-149">Se il server di database non ha già installato il database Northwind, è innanzitutto necessario aggiungerlo al server di database eseguendo lo script di installazione incluso nel download dell'esercitazione o da [scaricando la versione di SQL Server 2000 di Northwind lo script di installazione e](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) direttamente dal sito web Microsoft.</span><span class="sxs-lookup"><span data-stu-id="bbce2-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="bbce2-150">Dopo aver installato il database, passare a Esplora Server in Visual Studio, fare clic sul nodo Connessioni dati e quindi scegliere Aggiungi connessione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="bbce2-151">Se non è visibile Esplora Server aprire la visualizzazione / Esplora Server o hit Ctrl + Alt + S.</span><span class="sxs-lookup"><span data-stu-id="bbce2-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="bbce2-152">Verrà visualizzata la finestra di dialogo Aggiungi connessione, in cui è possibile specificare il server a cui connettersi, le informazioni di autenticazione e il nome del database.</span><span class="sxs-lookup"><span data-stu-id="bbce2-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="bbce2-153">Dopo avere configurato le informazioni di connessione del database e fatto clic sul pulsante OK, il database verrà aggiunto come nodo sotto il nodo Connessioni dati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="bbce2-154">È possibile espandere il nodo del database per esplorare le tabelle, viste, stored procedure e così via.</span><span class="sxs-lookup"><span data-stu-id="bbce2-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>


![Aggiungere una connessione al database Northwind del Server di Database](creating-a-data-access-layer-cs/_static/image4.png)

<span data-ttu-id="bbce2-156">**Figura 2**: Aggiungere una connessione al database Northwind del Server di Database</span><span class="sxs-lookup"><span data-stu-id="bbce2-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>


## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="bbce2-157">Passaggio 2: Creazione di livello di accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="bbce2-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="bbce2-158">Quando si lavora con una delle opzioni dei dati consiste nell'incorporare la logica specifica i dati direttamente nel livello di presentazione (in un'applicazione web, la compongono il livello di presentazione nella pagine ASP.NET).</span><span class="sxs-lookup"><span data-stu-id="bbce2-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="bbce2-159">L'operazione potrebbe richiedere il modulo di scrittura di codice ADO.NET in parte di codice della pagina ASP.NET o mediante il controllo SqlDataSource dalla parte di markup.</span><span class="sxs-lookup"><span data-stu-id="bbce2-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="bbce2-160">In entrambi i casi, questo approccio è strettamente collegato la logica di accesso ai dati con il livello di presentazione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="bbce2-161">L'approccio consigliato, tuttavia, consiste nel separare la logica di accesso ai dati dal livello di presentazione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="bbce2-162">A questo livello separato viene definito il livello di accesso ai dati, per brevità e viene in genere implementato come un progetto libreria di classi separato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="bbce2-163">I vantaggi di questa architettura a più livelli sono ben documentati (vedere la sezione "Ulteriori letture" alla fine di questa esercitazione per informazioni su questi vantaggi) è l'approccio verrà usato in questa serie.</span><span class="sxs-lookup"><span data-stu-id="bbce2-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="bbce2-164">Tutto il codice specifico per l'origine dati sottostante, ad esempio la creazione di una connessione al database, emissione **selezionate**, **Inserisci**, **UPDATE**, e  **Elimina** comandi e così via devono trovarsi nel DAL.</span><span class="sxs-lookup"><span data-stu-id="bbce2-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing **SELECT**, **INSERT**, **UPDATE**, and **DELETE** commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="bbce2-165">Il livello di presentazione non deve contenere tutti i riferimenti a tale codice di accesso ai dati, ma debba invece effettuare chiamate al per le richieste di tutti i dati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="bbce2-166">Livelli di accesso ai dati in genere contengono i metodi per l'accesso ai dati del database sottostante.</span><span class="sxs-lookup"><span data-stu-id="bbce2-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="bbce2-167">Il database Northwind, ad esempio, ha **prodotti** e **categorie** tabelle che registrano i prodotti in vendita e le categorie a cui appartengono.</span><span class="sxs-lookup"><span data-stu-id="bbce2-167">The Northwind database, for example, has **Products** and **Categories** tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="bbce2-168">Nel nostro DAL abbiamo metodi, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="bbce2-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="bbce2-169">**GetCategories(),** che restituirà informazioni su tutte le categorie</span><span class="sxs-lookup"><span data-stu-id="bbce2-169">**GetCategories(),** which will return information about all of the categories</span></span>
- <span data-ttu-id="bbce2-170">**GetProducts()**, che restituirà informazioni su tutti i prodotti</span><span class="sxs-lookup"><span data-stu-id="bbce2-170">**GetProducts()**, which will return information about all of the products</span></span>
- <span data-ttu-id="bbce2-171">**GetProductsByCategoryID (*categoryID*)**, che restituirà tutti i prodotti che appartengono a una categoria specificata</span><span class="sxs-lookup"><span data-stu-id="bbce2-171">**GetProductsByCategoryID(*categoryID*)**, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="bbce2-172">**GetProductByProductID (*productID*)**, che restituirà informazioni su un prodotto specifico</span><span class="sxs-lookup"><span data-stu-id="bbce2-172">**GetProductByProductID(*productID*)**, which will return information about a particular product</span></span>

<span data-ttu-id="bbce2-173">Questi metodi, quando richiamata, verranno connettersi al database, eseguire la query appropriata e restituire i risultati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="bbce2-174">Come è possibile tornare questi risultati è importante.</span><span class="sxs-lookup"><span data-stu-id="bbce2-174">How we return these results is important.</span></span> <span data-ttu-id="bbce2-175">Questi metodi può semplicemente restituire un set di dati o un DataReader popolata dalla query sul database, ma in teoria questi risultati devono essere restituiti utilizzando *oggetti fortemente tipizzati*.</span><span class="sxs-lookup"><span data-stu-id="bbce2-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="bbce2-176">Un oggetto fortemente tipizzato è uno cui schema è definito rigidamente in fase di compilazione, mentre l'opposto, un oggetto debolmente tipizzato, è uno schema di cui non è noto fino al runtime.</span><span class="sxs-lookup"><span data-stu-id="bbce2-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="bbce2-177">Ad esempio, il DataReader e DataSet (per impostazione predefinita) sono oggetti non fortemente tipizzato, perché i relativi schemi sono definito per le colonne restituite dalla query database utilizzata per popolarli.</span><span class="sxs-lookup"><span data-stu-id="bbce2-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="bbce2-178">Per accedere a una determinata colonna di una DataTable non fortemente tipizzato, è necessario usare una sintassi come: <strong><em>DataTable</em>.Rows[<em>index</em>]["<em>columnName</em>"]</strong>.</span><span class="sxs-lookup"><span data-stu-id="bbce2-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: <strong><em>DataTable</em>.Rows[<em>index</em>]["<em>columnName</em>"]</strong>.</span></span> <span data-ttu-id="bbce2-179">Il DataTable implicato comunemente dalla tipizzazione in questo esempio è esposto dal fatto che è necessario accedere al nome di colonna utilizzando una stringa o un indice ordinale.</span><span class="sxs-lookup"><span data-stu-id="bbce2-179">The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index.</span></span> <span data-ttu-id="bbce2-180">Un oggetto DataTable fortemente tipizzato, d'altra parte, avrà ciascuna delle relative colonne implementate come proprietà, generando codice simile a: <strong><em>DataTable</em>.Rows[<em>index</em>].*columnName</strong>*.</span><span class="sxs-lookup"><span data-stu-id="bbce2-180">A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: <strong><em>DataTable</em>.Rows[<em>index</em>].*columnName</strong>*.</span></span>

<span data-ttu-id="bbce2-181">Per restituire oggetti fortemente tipizzati, gli sviluppatori possono creare i propri oggetti business personalizzati o usano i dataset tipizzati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-181">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="bbce2-182">Un oggetto business viene implementato dallo sviluppatore come rappresenta una classe le cui proprietà riflettono in genere le colonne della tabella di database sottostante l'oggetto business.</span><span class="sxs-lookup"><span data-stu-id="bbce2-182">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="bbce2-183">Un set di dati tipizzato è una classe generata automaticamente da Visual Studio basate su uno schema di database e i cui membri sono fortemente tipizzate in base a questo schema.</span><span class="sxs-lookup"><span data-stu-id="bbce2-183">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="bbce2-184">Il set di dati tipizzato stesso è costituito da classi che estendono le classi ADO.NET DataSet, DataTable e DataRow.</span><span class="sxs-lookup"><span data-stu-id="bbce2-184">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="bbce2-185">Oltre a DataTable fortemente tipizzato, dataset tipizzati ora includono anche gli oggetti TableAdapter, che sono classi con metodi per la compilazione di oggetti DataTable del set di dati e la propagazione delle modifiche all'interno di oggetti DataTable nel database.</span><span class="sxs-lookup"><span data-stu-id="bbce2-185">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="bbce2-186">Per altre informazioni sui vantaggi e svantaggi dell'utilizzo di dataset tipizzati e oggetti business personalizzati, consultare [la progettazione di componenti livello dati e il passaggio attraverso i livelli dati](https://msdn.microsoft.com/library/ms978496.aspx).</span><span class="sxs-lookup"><span data-stu-id="bbce2-186">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/library/ms978496.aspx).</span></span>


<span data-ttu-id="bbce2-187">Si userà i set di dati fortemente tipizzato per l'architettura di queste esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="bbce2-187">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="bbce2-188">Figura 3 viene illustrato il flusso di lavoro tra i diversi livelli di un'applicazione che usa i set di dati tipizzato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-188">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>


<span data-ttu-id="bbce2-189">[![Tutti i codice di accesso ai dati è necessario DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-189">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span></span>

<span data-ttu-id="bbce2-190">**Figura 3**: È necessario codice di accesso di tutti i dati DAL ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-190">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image7.png))</span></span>


## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="bbce2-191">Creazione di un DataSet tipizzato e un adattatore di tabella</span><span class="sxs-lookup"><span data-stu-id="bbce2-191">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="bbce2-192">Per iniziare a creare DAL nostro, si inizia aggiungendo un set di dati tipizzato al nostro progetto.</span><span class="sxs-lookup"><span data-stu-id="bbce2-192">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="bbce2-193">A tale scopo, fare doppio clic sul nodo del progetto in Esplora soluzioni e scegliere Aggiungi un nuovo elemento.</span><span class="sxs-lookup"><span data-stu-id="bbce2-193">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="bbce2-194">Selezionare l'opzione set di dati dall'elenco dei modelli e denominarla **Northwind.xsd**.</span><span class="sxs-lookup"><span data-stu-id="bbce2-194">Select the DataSet option from the list of templates and name it **Northwind.xsd**.</span></span>


<span data-ttu-id="bbce2-195">[![Scegliere di aggiungere un nuovo set di dati al progetto](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-195">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span></span>

<span data-ttu-id="bbce2-196">**Figura 4**: Scegliere di aggiungere un nuovo set di dati a un progetto ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-196">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image10.png))</span></span>


<span data-ttu-id="bbce2-197">Dopo aver fatto clic Add, quando viene richiesto di aggiungere il set di dati per il **App\_codice** cartella, scegliere Sì.</span><span class="sxs-lookup"><span data-stu-id="bbce2-197">After clicking Add, when prompted to add the DataSet to the **App\_Code** folder, choose Yes.</span></span> <span data-ttu-id="bbce2-198">Verrà quindi visualizzata la finestra di progettazione per il set di dati tipizzati e la configurazione guidata TableAdapter verrà avviato, che consente di aggiungere il primo TableAdapter al set di dati tipizzato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-198">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="bbce2-199">Viene usato un set di dati tipizzato come una raccolta fortemente tipizzata di dati. si è costituito da istanze DataTable fortemente tipizzato, ognuno dei quali a sua volta è costituito da istanze di DataRow fortemente tipizzato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-199">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="bbce2-200">Si creerà un oggetto DataTable fortemente tipizzato per ognuna delle tabelle di database sottostanti che è necessario utilizzare in questa serie di esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="bbce2-200">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="bbce2-201">Iniziamo con la creazione di un oggetto DataTable per il **prodotti** tabella.</span><span class="sxs-lookup"><span data-stu-id="bbce2-201">Let's start with creating a DataTable for the **Products** table.</span></span>

<span data-ttu-id="bbce2-202">Tenere presente che DataTable fortemente tipizzate non includono le informazioni sull'accesso ai dati dalla tabella di database sottostante.</span><span class="sxs-lookup"><span data-stu-id="bbce2-202">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="bbce2-203">Per poter recuperare i dati per popolare l'oggetto DataTable, viene usata una classe TableAdapter, che funziona come il livello di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-203">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="bbce2-204">Per i **prodotti** DataTable, TableAdapter conterrà i metodi **GetProducts()**, **GetProductByCategoryID (*categoryID*)** e così via che è possibile richiamare dal livello di presentazione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-204">For our **Products** DataTable, the TableAdapter will contain the methods **GetProducts()**, **GetProductByCategoryID(*categoryID*)**, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="bbce2-205">Ruolo del DataTable è come gli oggetti fortemente tipizzati utilizzati per passare dati tra i livelli.</span><span class="sxs-lookup"><span data-stu-id="bbce2-205">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="bbce2-206">La configurazione guidata TableAdapter inizia con cui viene richiesto di selezionare il database da usare.</span><span class="sxs-lookup"><span data-stu-id="bbce2-206">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="bbce2-207">L'elenco a discesa Mostra i database in Esplora Server.</span><span class="sxs-lookup"><span data-stu-id="bbce2-207">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="bbce2-208">Se non è stato aggiunto il database Northwind in Esplora Server, è possibile fare clic sul pulsante nuova connessione al momento di farlo.</span><span class="sxs-lookup"><span data-stu-id="bbce2-208">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>


<span data-ttu-id="bbce2-209">[![Scegliere il Database Northwind nell'elenco a discesa](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-209">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span></span>

<span data-ttu-id="bbce2-210">**Figura 5**: Scegliere il Northwind Database nell'elenco a discesa ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-210">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image13.png))</span></span>


<span data-ttu-id="bbce2-211">Dopo aver selezionato il database e fare clic su Avanti, viene chiesto se si desidera salvare la stringa di connessione nel **Web. config** file.</span><span class="sxs-lookup"><span data-stu-id="bbce2-211">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the **Web.config** file.</span></span> <span data-ttu-id="bbce2-212">Salvando la stringa di connessione si eviteranno averlo rigido codificati nelle classi TableAdapter, che semplifica le cose, se le informazioni sulla stringa di connessione viene modificata in futuro.</span><span class="sxs-lookup"><span data-stu-id="bbce2-212">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="bbce2-213">Se si decide di salvare la stringa di connessione nel file di configurazione si trova il **&lt;connectionStrings&gt;** sezione, che può essere [facoltativamente crittografato](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) migliorato sicurezza o modificati in un secondo momento tramite la nuova pagina delle proprietà ASP.NET 2.0 nello strumento di amministrazione GUI IIS, che è più idonea per gli amministratori.</span><span class="sxs-lookup"><span data-stu-id="bbce2-213">If you opt to save the connection string in the configuration file it's placed in the **&lt;connectionStrings&gt;** section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>


<span data-ttu-id="bbce2-214">[![Salvare la stringa di connessione in Web. config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-214">[![Save the Connection String to Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span></span>

<span data-ttu-id="bbce2-215">**Figura 6**: Salva la stringa di connessione **Web. config** ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-215">**Figure 6**: Save the Connection String to **Web.config** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image16.png))</span></span>


<span data-ttu-id="bbce2-216">Successivamente, è necessario definire lo schema per la prima DataTable fortemente tipizzato e fornire il primo metodo per i TableAdapter da utilizzare per popolare il set di dati fortemente tipizzati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-216">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="bbce2-217">Questi due passaggi vengono eseguiti contemporaneamente mediante la creazione di una query che restituisce le colonne della tabella che si desidera siano indicati nei nostri DataTable.</span><span class="sxs-lookup"><span data-stu-id="bbce2-217">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="bbce2-218">Al termine della procedura guidata viene fornito un nome di metodo per questa query.</span><span class="sxs-lookup"><span data-stu-id="bbce2-218">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="bbce2-219">Una volta che è stato eseguito, questo metodo può essere richiamato dal nostro livello presentazione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-219">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="bbce2-220">Il metodo Esegui la query definita e popolare un DataTable fortemente tipizzato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-220">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="bbce2-221">Per iniziare a definire la query SQL che viene prima di tutto necessario indicato come si desidera eseguire la query TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="bbce2-221">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="bbce2-222">È possibile utilizzare un'istruzione SQL ad hoc, creare una nuova stored procedure o usare una stored procedure esistente.</span><span class="sxs-lookup"><span data-stu-id="bbce2-222">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="bbce2-223">Per queste esercitazioni useremo istruzioni SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="bbce2-223">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="bbce2-224">Fare riferimento a [Brian Noyes](http://briannoyes.net/)dell'articolo, [creare un livello di accesso ai dati con set di dati di progettazione di Visual Studio 2005](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) per un esempio di utilizzo delle stored procedure.</span><span class="sxs-lookup"><span data-stu-id="bbce2-224">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>


<span data-ttu-id="bbce2-225">[![Eseguire query sui dati usando un'istruzione SQL Ad Hoc](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-225">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span></span>

<span data-ttu-id="bbce2-226">**Figura 7**: Eseguire query sui dati usando un'istruzione SQL Ad Hoc ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-226">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image19.png))</span></span>


<span data-ttu-id="bbce2-227">A questo punto è possibile digitare la query SQL manualmente.</span><span class="sxs-lookup"><span data-stu-id="bbce2-227">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="bbce2-228">Quando si crea il primo metodo in TableAdapter in genere consigliabile fare in modo che la query restituisca le colonne che devono essere espressi in DataTable corrispondente.</span><span class="sxs-lookup"><span data-stu-id="bbce2-228">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="bbce2-229">Permette di eseguire questa mediante la creazione di una query che restituisce tutte le colonne e tutte le righe dal **prodotti** tabella:</span><span class="sxs-lookup"><span data-stu-id="bbce2-229">We can accomplish this by creating a query that returns all columns and all rows from the **Products** table:</span></span>


<span data-ttu-id="bbce2-230">[![Immettere la Query SQL nella casella di testo](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-230">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span></span>

<span data-ttu-id="bbce2-231">**Figura 8**: Immettere la Query SQL in the Textbox ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-231">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image22.png))</span></span>


<span data-ttu-id="bbce2-232">In alternativa, usare il generatore delle Query e creare graficamente la query, come illustrato nella figura 9.</span><span class="sxs-lookup"><span data-stu-id="bbce2-232">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>


<span data-ttu-id="bbce2-233">[![Creare la Query in formato grafico tramite l'Editor di Query](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-233">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span></span>

<span data-ttu-id="bbce2-234">**Figura 9**: Creare la Query in formato grafico tramite l'Editor di Query ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-234">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image25.png))</span></span>


<span data-ttu-id="bbce2-235">Dopo aver creato la query, ma prima di procedere nella schermata successiva, fare clic sul pulsante Opzioni avanzate.</span><span class="sxs-lookup"><span data-stu-id="bbce2-235">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="bbce2-236">Nei progetti di sito Web "istruzioni genera Insert, Update e Delete" sono l'unica opzione selezionata per impostazione predefinita; avanzata Se si esegue questa procedura guidata da un progetto Windows o una libreria di classi verrà selezionato anche l'opzione "Usa concorrenza ottimistica".</span><span class="sxs-lookup"><span data-stu-id="bbce2-236">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="bbce2-237">Lasciare deselezionata l'opzione "Usa concorrenza ottimistica" per il momento.</span><span class="sxs-lookup"><span data-stu-id="bbce2-237">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="bbce2-238">Esamineremo la concorrenza ottimistica in esercitazioni future.</span><span class="sxs-lookup"><span data-stu-id="bbce2-238">We'll examine optimistic concurrency in future tutorials.</span></span>


<span data-ttu-id="bbce2-239">[![Selezionare solo le genera istruzioni Insert, Update e Delete istruzioni opzione](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-239">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span></span>

<span data-ttu-id="bbce2-240">**Figura 10**: Selezionare solo le genera istruzioni Insert, Update e Delete istruzioni opzione ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-240">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image28.png))</span></span>


<span data-ttu-id="bbce2-241">Dopo aver verificato le opzioni avanzate, fare clic su Avanti per passare alla schermata finale.</span><span class="sxs-lookup"><span data-stu-id="bbce2-241">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="bbce2-242">Qui ci viene richiesto di selezionare i metodi da aggiungere all'oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="bbce2-242">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="bbce2-243">Sono disponibili due modelli per il popolamento dei dati:</span><span class="sxs-lookup"><span data-stu-id="bbce2-243">There are two patterns for populating data:</span></span>

- <span data-ttu-id="bbce2-244">**Riempi un DataTable** con questo approccio viene creato un metodo che accetta un oggetto DataTable come parametro e lo popola in base ai risultati della query.</span><span class="sxs-lookup"><span data-stu-id="bbce2-244">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="bbce2-245">La classe DataAdapter di ADO.NET, ad esempio, implementa questo modello con relativi **Fill** (metodo).</span><span class="sxs-lookup"><span data-stu-id="bbce2-245">The ADO.NET DataAdapter class, for example, implements this pattern with its **Fill()** method.</span></span>
- <span data-ttu-id="bbce2-246">**Restituisci un DataTable** con questo approccio il metodo crea e inserisce l'oggetto DataTable per l'utente e lo restituisce come valore restituiscono di metodi.</span><span class="sxs-lookup"><span data-stu-id="bbce2-246">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="bbce2-247">È possibile avere TableAdapter implementare uno o entrambi questi modelli.</span><span class="sxs-lookup"><span data-stu-id="bbce2-247">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="bbce2-248">È inoltre possibile rinominare i metodi forniti di seguito.</span><span class="sxs-lookup"><span data-stu-id="bbce2-248">You can also rename the methods provided here.</span></span> <span data-ttu-id="bbce2-249">È possibile lasciare entrambe le caselle di controllo è selezionate, anche se si userà solo il modello di quest'ultimo in queste esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="bbce2-249">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="bbce2-250">Inoltre, è possibile rinominare il piuttosto generici **GetData** metodo **GetProducts**.</span><span class="sxs-lookup"><span data-stu-id="bbce2-250">Also, let's rename the rather generic **GetData** method to **GetProducts**.</span></span>

<span data-ttu-id="bbce2-251">Se selezionata, la casella di controllo finale, "GenerateDBDirectMethods", viene creato **Insert ()**, **Update ()**, e **Delete ()** metodi per l'oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="bbce2-251">If checked, the final checkbox, "GenerateDBDirectMethods," creates **Insert()**, **Update()**, and **Delete()** methods for the TableAdapter.</span></span> <span data-ttu-id="bbce2-252">Se si lascia deselezionata questa opzione, tutti gli aggiornamenti dovrà essere eseguita tramite sole dell'oggetto TableAdapter **Update ()** metodo che accetta del DataSet tipizzato, un oggetto DataTable, DataRow singola o una matrice di DataRow.</span><span class="sxs-lookup"><span data-stu-id="bbce2-252">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole **Update()** method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="bbce2-253">(Se è stata deselezionata la "genera Insert, Update e Delete istruzioni" opzione questa casella di controllo le proprietà avanzate nella figura 9 impostazione non avrà alcun effetto.) È possibile lasciare questa casella di controllo selezionata.</span><span class="sxs-lookup"><span data-stu-id="bbce2-253">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>


<span data-ttu-id="bbce2-254">[![Modificare il nome del metodo da GetData a GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-254">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span></span>

<span data-ttu-id="bbce2-255">**Figura 11**: Modificare il nome del metodo da **GetData** al **GetProducts** ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-255">**Figure 11**: Change the Method Name from **GetData** to **GetProducts** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image31.png))</span></span>


<span data-ttu-id="bbce2-256">Completare la procedura guidata, fare clic su Fine.</span><span class="sxs-lookup"><span data-stu-id="bbce2-256">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="bbce2-257">Dopo la chiusura della procedura guidata si viene restituiti alla finestra di progettazione set di dati che mostra l'oggetto DataTable che appena creato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-257">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="bbce2-258">È possibile visualizzare l'elenco di colonne di **prodotti** DataTable (**ProductID**, **ProductName**e così via), nonché i metodi del  **ProductsTableAdapter** (**Fill** e **GetProducts()**).</span><span class="sxs-lookup"><span data-stu-id="bbce2-258">You can see the list of columns in the **Products** DataTable (**ProductID**, **ProductName**, and so on), as well as the methods of the **ProductsTableAdapter** (**Fill()** and **GetProducts()**).</span></span>


<span data-ttu-id="bbce2-259">[![Il DataTable dei prodotti e ProductsTableAdapter sono stati aggiunti al set di dati tipizzati](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-259">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span></span>

<span data-ttu-id="bbce2-260">**Figura 12**: Il **prodotti** DataTable e **ProductsTableAdapter** sono stati aggiunti al set di dati tipizzato ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-260">**Figure 12**: The **Products** DataTable and **ProductsTableAdapter** have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image34.png))</span></span>


<span data-ttu-id="bbce2-261">A questo punto è disponibile un set di dati tipizzato con DataTable singola (**Northwind.Products**) e una classe fortemente tipizzata DataAdapter (**NorthwindTableAdapters.ProductsTableAdapter**) con un  **GetProducts()** (metodo).</span><span class="sxs-lookup"><span data-stu-id="bbce2-261">At this point we have a Typed DataSet with a single DataTable (**Northwind.Products**) and a strongly-typed DataAdapter class (**NorthwindTableAdapters.ProductsTableAdapter**) with a **GetProducts()** method.</span></span> <span data-ttu-id="bbce2-262">Questi oggetti sono utilizzabile per accedere a un elenco di tutti i prodotti dal codice, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="bbce2-262">These objects can be used to access a list of all products from code like:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample1.html)]

<span data-ttu-id="bbce2-263">Questo codice non richiede di scrivere un bit di codice specifici di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-263">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="bbce2-264">Non è stato necessario creare un'istanza di tutte le classi ADO.NET, è necessario non fare riferimento a tutte le stringhe di connessione, le query SQL, o stored procedure.</span><span class="sxs-lookup"><span data-stu-id="bbce2-264">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="bbce2-265">Al contrario, oggetto TableAdapter fornisce il codice di accesso ai dati di basso livello per noi.</span><span class="sxs-lookup"><span data-stu-id="bbce2-265">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="bbce2-266">Ogni oggetto usato in questo esempio viene inoltre fortemente tipizzati, che consente di Visual Studio per fornire IntelliSense e controllo dei tipi in fase di compilazione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-266">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="bbce2-267">E meglio di tutte le DataTable restituite dal TableAdapter può essere associato a dati ASP.NET controlli Web, ad esempio GridView, DetailsView, DropDownList, CheckBoxList e molti altri.</span><span class="sxs-lookup"><span data-stu-id="bbce2-267">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="bbce2-268">L'esempio seguente illustra l'associazione di DataTable restituito dal **GetProducts()** metodo in un controllo GridView in appena della scarsità tre righe di codice all'interno di **pagina\_carico** gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="bbce2-268">The following example illustrates binding the DataTable returned by the **GetProducts()** method to a GridView in just a scant three lines of code within the **Page\_Load** event handler.</span></span>

<span data-ttu-id="bbce2-269">AllProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="bbce2-269">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample2.aspx)]

<span data-ttu-id="bbce2-270">AllProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="bbce2-270">AllProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample3.cs)]


<span data-ttu-id="bbce2-271">[![Viene visualizzato l'elenco di prodotti in un oggetto GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-271">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span></span>

<span data-ttu-id="bbce2-272">**Figura 13**: Viene visualizzato l'elenco di prodotti in un controllo GridView ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-272">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image37.png))</span></span>


<span data-ttu-id="bbce2-273">Anche se in questo esempio viene richiesto che scriviamo tre righe di codice nella nostra pagina ASP.NET **pagina\_carico** gestore dell'evento, in futuro verrà esaminato come utilizzare ObjectDataSource per recuperare i dati, in modo dichiarativo le esercitazioni di DAL.</span><span class="sxs-lookup"><span data-stu-id="bbce2-273">While this example required that we write three lines of code in our ASP.NET page's **Page\_Load** event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="bbce2-274">Con ObjectDataSource è non sarà necessario scrivere alcun codice e verrà visualizzato anche il supporto di impaginazione e ordinamento.</span><span class="sxs-lookup"><span data-stu-id="bbce2-274">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="bbce2-275">Passaggio 3: Aggiunta di metodi a livello di accesso ai dati con parametri</span><span class="sxs-lookup"><span data-stu-id="bbce2-275">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="bbce2-276">A questo punto nostri **ProductsTableAdapter** classe quanto include un metodo, ovvero **GetProducts()**, che restituisce tutti i prodotti nel database.</span><span class="sxs-lookup"><span data-stu-id="bbce2-276">At this point our **ProductsTableAdapter** class has but one method, **GetProducts()**, which returns all of the products in the database.</span></span> <span data-ttu-id="bbce2-277">Mentre la possibilità di lavorare con tutti i prodotti è indubbiamente utile, vi sono casi quando si desidera recuperare informazioni su un prodotto specifico o tutti i prodotti che appartengono a una determinata categoria.</span><span class="sxs-lookup"><span data-stu-id="bbce2-277">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="bbce2-278">Per aggiungere tale funzionalità il livello di accesso ai dati è possibile aggiungere i metodi con parametri all'oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="bbce2-278">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="bbce2-279">È possibile aggiungere il **GetProductsByCategoryID (*categoryID*)** (metodo).</span><span class="sxs-lookup"><span data-stu-id="bbce2-279">Let's add the **GetProductsByCategoryID(*categoryID*)** method.</span></span> <span data-ttu-id="bbce2-280">Per aggiungere un nuovo metodo di DAL, torna alla finestra di progettazione set di dati, fare doppio clic nella **ProductsTableAdapter** sezione e scegliere Aggiungi Query.</span><span class="sxs-lookup"><span data-stu-id="bbce2-280">To add a new method to the DAL, return to the DataSet Designer, right-click in the **ProductsTableAdapter** section, and choose Add Query.</span></span>


![Pulsante destro del mouse sull'oggetto TableAdapter e scegliere Aggiungi Query](creating-a-data-access-layer-cs/_static/image38.png)

<span data-ttu-id="bbce2-282">**Figura 14**: Pulsante destro del mouse sull'oggetto TableAdapter e scegliere Aggiungi Query</span><span class="sxs-lookup"><span data-stu-id="bbce2-282">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>


<span data-ttu-id="bbce2-283">È prima di tutto verrà richiesto se si vuole accedere al database tramite un'istruzione SQL ad hoc o una stored procedure nuova o esistente.</span><span class="sxs-lookup"><span data-stu-id="bbce2-283">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="bbce2-284">È possibile scegliere di usare nuovamente un'istruzione SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="bbce2-284">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="bbce2-285">Successivamente, ci viene richiesto il tipo di query SQL che desideriamo utilizzare.</span><span class="sxs-lookup"><span data-stu-id="bbce2-285">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="bbce2-286">Poiché si vuole restituire tutti i prodotti che appartengono a una categoria specificata, è opportuno scrivere un **seleziona** istruzione che restituisce righe.</span><span class="sxs-lookup"><span data-stu-id="bbce2-286">Since we want to return all products that belong to a specified category, we want to write a **SELECT** statement which returns rows.</span></span>


<span data-ttu-id="bbce2-287">[![Scegliere di creare un'istruzione SELECT che restituisce righe](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-287">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span></span>

<span data-ttu-id="bbce2-288">**Figura 15**: Scegliere di creare un **selezionate** istruzione che restituisce righe ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-288">**Figure 15**: Choose to Create a **SELECT** Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image41.png))</span></span>


<span data-ttu-id="bbce2-289">Il passaggio successivo consiste nel definire la query SQL usata per accedere ai dati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-289">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="bbce2-290">Poiché si vogliono restituire solo i prodotti che appartengono a una determinata categoria, usare lo stesso <strong>selezionate</strong> istruzione dal <strong>GetProducts()</strong>, ma aggiungere il codice seguente <strong>dove</strong> clausola: <strong>WHERE CategoryID = @CategoryID</strong>.</span><span class="sxs-lookup"><span data-stu-id="bbce2-290">Since we want to return only those products that belong to a particular category, I use the same <strong>SELECT</strong> statement from <strong>GetProducts()</strong>, but add the following <strong>WHERE</strong> clause: <strong>WHERE CategoryID = @CategoryID</strong>.</span></span> <span data-ttu-id="bbce2-291">Il <strong>@CategoryID</strong> per la configurazione guidata TableAdapter parametro indica che il metodo stiamo creando richiede un parametro di input del tipo corrispondente (vale a dire, un numero intero che ammette valori null).</span><span class="sxs-lookup"><span data-stu-id="bbce2-291">The <strong>@CategoryID</strong> parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>


<span data-ttu-id="bbce2-292">[![Immettere una Query per restituire solo i prodotti in una categoria specifica](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-292">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span></span>

<span data-ttu-id="bbce2-293">**Figura 16**: Immettere una Query per restituire solo i prodotti in una categoria specificata ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-293">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image44.png))</span></span>


<span data-ttu-id="bbce2-294">Nel passaggio finale è possibile scegliere che i modelli da utilizzare, nonché di personalizzare i nomi dei metodi generati di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-294">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="bbce2-295">Per il motivo di riempimento, è possibile modificare il nome in <strong>FillByCategoryID</strong> e per il valore restituito un oggetto DataTable restituito modello (il <strong>ottenere*X</strong>*  metodi), è possibile usare  <strong>GetProductsByCategoryID</strong>.</span><span class="sxs-lookup"><span data-stu-id="bbce2-295">For the Fill pattern, let's change the name to <strong>FillByCategoryID</strong> and for the return a DataTable return pattern (the <strong>Get*X</strong>* methods), let's use <strong>GetProductsByCategoryID</strong>.</span></span>


<span data-ttu-id="bbce2-296">[![Scegliere i nomi per i metodi TableAdapter](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-296">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span></span>

<span data-ttu-id="bbce2-297">**Figura 17**: Scegliere i nomi per i metodi TableAdapter ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-297">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image47.png))</span></span>


<span data-ttu-id="bbce2-298">Dopo aver completato la procedura guidata, la finestra di progettazione set di dati include i nuovi metodi TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="bbce2-298">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>


![I prodotti ora può eseguire una query per categoria](creating-a-data-access-layer-cs/_static/image48.png)

<span data-ttu-id="bbce2-300">**Figura 18**: I prodotti ora può eseguire una query per categoria</span><span class="sxs-lookup"><span data-stu-id="bbce2-300">**Figure 18**: The Products Can Now be Queried by Category</span></span>


<span data-ttu-id="bbce2-301">Si consiglia di aggiungere un **GetProductByProductID (*productID*)** metodo usando la stessa tecnica.</span><span class="sxs-lookup"><span data-stu-id="bbce2-301">Take a moment to add a **GetProductByProductID(*productID*)** method using the same technique.</span></span>

<span data-ttu-id="bbce2-302">Queste query con parametri possono essere testate direttamente dalla finestra di progettazione set di dati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-302">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="bbce2-303">Fare clic sul metodo nell'oggetto TableAdapter e scegliere i dati di anteprima.</span><span class="sxs-lookup"><span data-stu-id="bbce2-303">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="bbce2-304">Successivamente, immettere i valori da usare per i parametri e fare clic su Anteprima.</span><span class="sxs-lookup"><span data-stu-id="bbce2-304">Next, enter the values to use for the parameters and click Preview.</span></span>


<span data-ttu-id="bbce2-305">[![Vengono visualizzati tali prodotti appartenenti alla categoria di bevande](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-305">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span></span>

<span data-ttu-id="bbce2-306">**Figura 19**: Vengono visualizzati tali prodotti appartenenti alla categoria Beverages ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-306">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image51.png))</span></span>


<span data-ttu-id="bbce2-307">Con il **GetProductsByCategoryID (*categoryID*)** nostro DAL metodo, possiamo creare una pagina ASP.NET che consente di visualizzare solo i prodotti in una categoria specificata.</span><span class="sxs-lookup"><span data-stu-id="bbce2-307">With the **GetProductsByCategoryID(*categoryID*)** method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="bbce2-308">L'esempio seguente illustra tutti i prodotti della categoria Beverages, che hanno una **CategoryID** pari a 1.</span><span class="sxs-lookup"><span data-stu-id="bbce2-308">The following example shows all products that are in the Beverages category, which have a **CategoryID** of 1.</span></span>

<span data-ttu-id="bbce2-309">Beverages.asp</span><span class="sxs-lookup"><span data-stu-id="bbce2-309">Beverages.asp</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample4.aspx)]

<span data-ttu-id="bbce2-310">Beverages.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="bbce2-310">Beverages.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample5.cs)]


<span data-ttu-id="bbce2-311">[![Vengono visualizzati i prodotti della categoria Beverages](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-311">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span></span>

<span data-ttu-id="bbce2-312">**Figura 20**: Vengono visualizzati i prodotti della categoria Beverages ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-312">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image54.png))</span></span>


## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="bbce2-313">Passaggio 4: Inserimento, aggiornamento ed eliminazione dei dati</span><span class="sxs-lookup"><span data-stu-id="bbce2-313">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="bbce2-314">Sono disponibili due modelli comunemente usati per l'inserimento, aggiornamento ed eliminazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-314">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="bbce2-315">Il primo modello, che chiameremo il modello diretta database, comporta la creazione di metodi che, quando richiamata, problema un' **inserire**, **UPDATE**, o **Elimina** comando per il database che opera su un singolo record di database.</span><span class="sxs-lookup"><span data-stu-id="bbce2-315">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an **INSERT**, **UPDATE**, or **DELETE** command to the database that operates on a single database record.</span></span> <span data-ttu-id="bbce2-316">Tali metodi vengono in genere passati in una serie di valori scalari (numeri interi, stringhe, valori booleani, DateTimes e così via) che corrispondono ai valori da inserire, aggiornare o eliminare.</span><span class="sxs-lookup"><span data-stu-id="bbce2-316">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="bbce2-317">Ad esempio, con questo modello per il **prodotti** tabella il metodo delete richiederebbe un parametro intero, che indica il **ProductID** del record da eliminare, mentre il metodo insert impiegherebbe un stringa per il **ProductName**, un decimale per il **UnitPrice**, un numero intero per il **UnitsOnStock**e così via.</span><span class="sxs-lookup"><span data-stu-id="bbce2-317">For example, with this pattern for the **Products** table the delete method would take in an integer parameter, indicating the **ProductID** of the record to delete, while the insert method would take in a string for the **ProductName**, a decimal for the **UnitPrice**, an integer for the **UnitsOnStock**, and so on.</span></span>


<span data-ttu-id="bbce2-318">[![Ogni inserimento, aggiornamento e richiesta di eliminazione viene inviato al Database immediatamente](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-318">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span></span>

<span data-ttu-id="bbce2-319">**Figura 21**: Ogni inserimento, aggiornamento e richiesta di eliminazione viene inviato al Database immediatamente ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-319">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image57.png))</span></span>


<span data-ttu-id="bbce2-320">L'altro modello, si farà riferimento come batch aggiornare modello, si aggiorna un intero set di dati, DataTable o raccolta di DataRow in una chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="bbce2-320">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="bbce2-321">Con questo modello gli sviluppatori eliminano, inserimenti e modifica il DataRow in DataTable e quindi passa tali DataRow o DataTable in un metodo di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="bbce2-321">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="bbce2-322">Quindi questo metodo enumera il DataRow passato, determina se è state modificate, aggiunti o eliminate (tramite il DataRow [RowState proprietà](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) valore) e invia la richiesta di database appropriato per ogni record.</span><span class="sxs-lookup"><span data-stu-id="bbce2-322">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>


<span data-ttu-id="bbce2-323">[![Tutte le modifiche vengono sincronizzate con il Database quando viene richiamato il metodo di aggiornamento](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-323">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span></span>

<span data-ttu-id="bbce2-324">**Figura 22**: Tutte le modifiche vengono sincronizzate con il Database quando viene richiamato il metodo di aggiornamento ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-324">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image60.png))</span></span>


<span data-ttu-id="bbce2-325">TableAdapter Usa il modello di aggiornamento batch per impostazione predefinita, ma supporta anche il modello di direct DB.</span><span class="sxs-lookup"><span data-stu-id="bbce2-325">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="bbce2-326">Dal momento che è selezionato l'opzione "genera Insert, Update e Delete di istruzioni" da the Advanced Properties quando si crea l'oggetto TableAdapter, il **ProductsTableAdapter** contiene un' **Update ()** , metodo che implementa il pattern di aggiornamento batch.</span><span class="sxs-lookup"><span data-stu-id="bbce2-326">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the **ProductsTableAdapter** contains an **Update()** method, which implements the batch update pattern.</span></span> <span data-ttu-id="bbce2-327">In particolare, l'oggetto TableAdapter contiene un' **Update ()** metodo che può essere passato del DataSet tipizzato, fortemente tipizzato DataTable o DataRow uno o più.</span><span class="sxs-lookup"><span data-stu-id="bbce2-327">Specifically, the TableAdapter contains an **Update()** method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="bbce2-328">Se si lascia la casella di controllo "GenerateDBDirectMethods" selezionata quando prima creazione dell'oggetto TableAdapter il modello di direct DB verrà anche implementata mediante **Insert ()**, **Update ()**, e **Delete)**  metodi.</span><span class="sxs-lookup"><span data-stu-id="bbce2-328">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via **Insert()**, **Update()**, and **Delete()** methods.</span></span>

<span data-ttu-id="bbce2-329">Entrambi modelli di modifica dei dati usano dell'oggetto TableAdapter **InsertCommand**, **UpdateCommand**, e **DeleteCommand** proprietà rilasciare loro **INSERT** , **UPDATE**, e **eliminare** comandi al database.</span><span class="sxs-lookup"><span data-stu-id="bbce2-329">Both data modification patterns use the TableAdapter's **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties to issue their **INSERT**, **UPDATE**, and **DELETE** commands to the database.</span></span> <span data-ttu-id="bbce2-330">È possibile esaminare e modificare il **InsertCommand**, **UpdateCommand**, e **DeleteCommand** proprietà facendo clic su TableAdapter in Progettazione DataSet e quindi passando Nella finestra Proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbce2-330">You can inspect and modify the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="bbce2-331">(Assicurarsi di aver selezionato l'oggetto TableAdapter e che il **ProductsTableAdapter** oggetto corrisponde a quello selezionato nell'elenco a discesa nella finestra Proprietà.)</span><span class="sxs-lookup"><span data-stu-id="bbce2-331">(Make sure you have selected the TableAdapter, and that the **ProductsTableAdapter** object is the one selected in the drop-down list in the Properties window.)</span></span>


<span data-ttu-id="bbce2-332">[![Il TableAdapter ha UpdateCommand, InsertCommand e DeleteCommand proprietà](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-332">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span></span>

<span data-ttu-id="bbce2-333">**Figura 23**: Dispone dell'oggetto TableAdapter **InsertCommand**, **UpdateCommand**, e **DeleteCommand** proprietà ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-333">**Figure 23**: The TableAdapter has **InsertCommand**, **UpdateCommand**, and **DeleteCommand** Properties ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image63.png))</span></span>


<span data-ttu-id="bbce2-334">Per esaminare o modificare una di queste proprietà di comando di database, fare clic sui **CommandText** sottoproprietà, che attiverà il generatore delle Query.</span><span class="sxs-lookup"><span data-stu-id="bbce2-334">To examine or modify any of these database command properties, click on the **CommandText** subproperty, which will bring up the Query Builder.</span></span>


<span data-ttu-id="bbce2-335">[![Configurare l'INSERT, UPDATE e istruzioni DELETE nel generatore di Query](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-335">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span></span>

<span data-ttu-id="bbce2-336">**Figura 24**: Configurare il **inserire**, **UPDATE**, e **Elimina** istruzioni nel generatore di Query ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-336">**Figure 24**: Configure the **INSERT**, **UPDATE**, and **DELETE** Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image66.png))</span></span>


<span data-ttu-id="bbce2-337">Esempio di codice seguente viene illustrato come utilizzare il modello di aggiornamento batch a raddoppiare il prezzo di tutti i prodotti che non sono obsolete e che hanno 25 unità a magazzino o meno:</span><span class="sxs-lookup"><span data-stu-id="bbce2-337">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample6.cs)]

<span data-ttu-id="bbce2-338">Il codice seguente viene illustrato come usare il modello di direct DB a livello di codice eliminare un determinato prodotto, quindi aggiornare uno e quindi aggiungerne uno nuovo:</span><span class="sxs-lookup"><span data-stu-id="bbce2-338">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample7.cs)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="bbce2-339">Creazione personalizzata inserimento, aggiornamento ed eliminazione di metodi</span><span class="sxs-lookup"><span data-stu-id="bbce2-339">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="bbce2-340">Il **Insert ()**, **Update ()**, e **Delete ()** metodi creati tramite il metodo diretto di database possono essere poco pratico, in particolare per tabelle con molte colonne.</span><span class="sxs-lookup"><span data-stu-id="bbce2-340">The **Insert()**, **Update()**, and **Delete()** methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="bbce2-341">Esaminando l'esempio di codice precedente, senza della Guida di IntelliSense non è particolarmente chiaro cosa **prodotti** esegue il mapping di colonna della tabella per ogni parametro di input per il **Update ()** e **Insert)**  metodi.</span><span class="sxs-lookup"><span data-stu-id="bbce2-341">Looking at the previous code example, without IntelliSense's help it's not particularly clear what **Products** table column maps to each input parameter to the **Update()** and **Insert()** methods.</span></span> <span data-ttu-id="bbce2-342">Può accadere quando si vuole solo aggiornare una singola colonna o a due, oppure da un oggetto personalizzato **Insert ()** metodo che verrà, ad esempio, restituire il valore del record appena inserito **identità** (incremento automatico) campo.</span><span class="sxs-lookup"><span data-stu-id="bbce2-342">There may be times when we only want to update a single column or two, or want a customized **Insert()** method that will, perhaps, return the value of the newly inserted record's **IDENTITY** (auto-increment) field.</span></span>

<span data-ttu-id="bbce2-343">Per creare un metodo personalizzato di questo tipo, tornare alla finestra di progettazione set di dati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-343">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="bbce2-344">Fare doppio clic sull'oggetto TableAdapter e scegliere Aggiungi Query, che restituisce per la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="bbce2-344">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="bbce2-345">Nella seconda schermata è possibile indicare il tipo di query da creare.</span><span class="sxs-lookup"><span data-stu-id="bbce2-345">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="bbce2-346">Creiamo un metodo che aggiunge un nuovo prodotto e quindi restituisce il valore del record appena aggiunto **ProductID**.</span><span class="sxs-lookup"><span data-stu-id="bbce2-346">Let's create a method that adds a new product and then returns the value of the newly added record's **ProductID**.</span></span> <span data-ttu-id="bbce2-347">Pertanto, scegliere di creare un **Inserisci** query.</span><span class="sxs-lookup"><span data-stu-id="bbce2-347">Therefore, opt to create an **INSERT** query.</span></span>


<span data-ttu-id="bbce2-348">[![Creare un metodo per aggiungere una nuova riga alla tabella Products](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-348">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span></span>

<span data-ttu-id="bbce2-349">**Figura 25**: Creare un metodo per aggiungere una nuova riga per il **prodotti** tabella ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-349">**Figure 25**: Create a Method to Add a New Row to the **Products** Table ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image69.png))</span></span>


<span data-ttu-id="bbce2-350">Nella schermata successiva il **InsertCommand**del **CommandText** viene visualizzata.</span><span class="sxs-lookup"><span data-stu-id="bbce2-350">On the next screen the **InsertCommand**'s **CommandText** appears.</span></span> <span data-ttu-id="bbce2-351">Aumentare la query aggiungendo **seleziona ambito\_IDENTITY()** alla fine della query, che restituirà l'ultimo valore identity inserito in un **identità** colonna nello stesso ambito.</span><span class="sxs-lookup"><span data-stu-id="bbce2-351">Augment this query by adding **SELECT SCOPE\_IDENTITY()** at the end of the query, which will return the last identity value inserted into an **IDENTITY** column in the same scope.</span></span> <span data-ttu-id="bbce2-352">(Vedere la [documentazione tecnica](https://msdn.microsoft.com/library/ms190315.aspx) per altre informazioni sui **ambito\_IDENTITY()** e il motivo per cui probabile che si desideri [utilizzare ambito\_IDENTITY() anziché @ @IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Assicurarsi di terminare la **inserire** istruzione con un punto e virgola prima di aggiungere il **selezionare** istruzione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-352">(See the [technical documentation](https://msdn.microsoft.com/library/ms190315.aspx) for more information about **SCOPE\_IDENTITY()** and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the **INSERT** statement with a semi-colon before adding the **SELECT** statement.</span></span>


<span data-ttu-id="bbce2-353">[![Aumentare la Query per restituire il valore di SCOPE_IDENTITY)](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-353">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span></span>

<span data-ttu-id="bbce2-354">**Figura 26**: Aumentare la Query per restituire il **ambito\_IDENTITY()** valore ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-354">**Figure 26**: Augment the Query to Return the **SCOPE\_IDENTITY()** Value ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image72.png))</span></span>


<span data-ttu-id="bbce2-355">Infine, denominare il nuovo metodo **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="bbce2-355">Finally, name the new method **InsertProduct**.</span></span>


<span data-ttu-id="bbce2-356">[![Impostare il nuovo nome di metodo su InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-356">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span></span>

<span data-ttu-id="bbce2-357">**Figura 27**: Impostare il nuovo nome del metodo **InsertProduct** ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-357">**Figure 27**: Set the New Method Name to **InsertProduct** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image75.png))</span></span>


<span data-ttu-id="bbce2-358">Quando si torna alla finestra di progettazione set di dati si noterà che il **ProductsTableAdapter** contiene un nuovo metodo **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="bbce2-358">When you return to the DataSet Designer you'll see that the **ProductsTableAdapter** contains a new method, **InsertProduct**.</span></span> <span data-ttu-id="bbce2-359">Se questo nuovo metodo non ha un parametro per ogni colonna il **prodotti** tabella, è probabile che si è dimenticato di terminare la **Inserisci** istruzione con un punto e virgola.</span><span class="sxs-lookup"><span data-stu-id="bbce2-359">If this new method doesn't have a parameter for each column in the **Products** table, chances are you forgot to terminate the **INSERT** statement with a semi-colon.</span></span> <span data-ttu-id="bbce2-360">Configurare il **InsertProduct** (metodo) e assicurarsi di disporre di un punto e virgola che delimita il **Inserisci** e **selezionare** istruzioni.</span><span class="sxs-lookup"><span data-stu-id="bbce2-360">Configure the **InsertProduct** method and ensure you have a semi-colon delimiting the **INSERT** and **SELECT** statements.</span></span>

<span data-ttu-id="bbce2-361">Per impostazione predefinita, inserire i metodi di query non problema metodi, vale a dire che restituiscono il numero di righe interessate.</span><span class="sxs-lookup"><span data-stu-id="bbce2-361">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="bbce2-362">Tuttavia, è necessario il **InsertProduct** per restituire il valore restituito dalla query, non il numero di righe interessate.</span><span class="sxs-lookup"><span data-stu-id="bbce2-362">However, we want the **InsertProduct** method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="bbce2-363">A tale scopo, modificare il **InsertProduct** del metodo **ExecuteMode** proprietà **scalari**.</span><span class="sxs-lookup"><span data-stu-id="bbce2-363">To accomplish this, adjust the **InsertProduct** method's **ExecuteMode** property to **Scalar**.</span></span>


<span data-ttu-id="bbce2-364">[![Modificare la proprietà ExecuteMode per scalare](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-364">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span></span>

<span data-ttu-id="bbce2-365">**Figura 28**: Modifica il **ExecuteMode** proprietà **scalari** ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-365">**Figure 28**: Change the **ExecuteMode** Property to **Scalar** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image78.png))</span></span>


<span data-ttu-id="bbce2-366">Il codice seguente illustra questa nuova **InsertProduct** metodo in azione:</span><span class="sxs-lookup"><span data-stu-id="bbce2-366">The following code shows this new **InsertProduct** method in action:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample8.cs)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="bbce2-367">Passaggio 5: Completare il livello di accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="bbce2-367">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="bbce2-368">Si noti che il **ProductsTableAdapters** classe restituisce il **CategoryID** e **SupplierID** i valori dal **prodotti** tabella, ma non include il **CategoryName** colonna dalle **categorie** tabella o la **CompanyName** colonna dal **Suppliers**di tabella, anche se probabilmente sono le colonne da visualizzare quando vengono visualizzate informazioni sul prodotto.</span><span class="sxs-lookup"><span data-stu-id="bbce2-368">Note that the **ProductsTableAdapters** class returns the **CategoryID** and **SupplierID** values from the **Products** table, but doesn't include the **CategoryName** column from the **Categories** table or the **CompanyName** column from the **Suppliers** table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="bbce2-369">È possibile potenziare metodo iniziale dell'oggetto TableAdapter, **GetProducts()**, per includere sia il **CategoryName** e **CompanyName** valori delle colonne, che aggiorneranno il DataTable fortemente tipizzato per includere anche queste nuove colonne.</span><span class="sxs-lookup"><span data-stu-id="bbce2-369">We can augment the TableAdapter's initial method, **GetProducts()**, to include both the **CategoryName** and **CompanyName** column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="bbce2-370">Questo può rappresentare un problema, tuttavia, come metodi dell'oggetto TableAdapter per l'inserimento, aggiornamento, e l'eliminazione dei dati si basano su questo metodo iniziale.</span><span class="sxs-lookup"><span data-stu-id="bbce2-370">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="bbce2-371">Per fortuna, i metodi generati automaticamente per inserimento, aggiornamento ed eliminazione non sono interessati da sottoquery nel **seleziona** clausola.</span><span class="sxs-lookup"><span data-stu-id="bbce2-371">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the **SELECT** clause.</span></span> <span data-ttu-id="bbce2-372">Occupandosi di aggiungere la query al **categorie** e **Suppliers** come sottoquery, anziché **JOIN** s, si eviterà di dover rielaborare i metodi per la modifica dei dati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-372">By taking care to add our queries to **Categories** and **Suppliers** as subqueries, rather than **JOIN** s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="bbce2-373">Fare clic sui **GetProducts()** metodo nella **ProductsTableAdapter** e scegliere Configura.</span><span class="sxs-lookup"><span data-stu-id="bbce2-373">Right-click on the **GetProducts()** method in the **ProductsTableAdapter** and choose Configure.</span></span> <span data-ttu-id="bbce2-374">Quindi, modificare il **seleziona** clausola in modo che risulti come:</span><span class="sxs-lookup"><span data-stu-id="bbce2-374">Then, adjust the **SELECT** clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-cs/samples/sample9.sql)]


<span data-ttu-id="bbce2-375">[![Aggiornare l'istruzione SELECT per il metodo GetProducts()](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-375">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span></span>

<span data-ttu-id="bbce2-376">**Figura 29**: Aggiornamento di **selezionare** istruzione per il **GetProducts()** (metodo) ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-376">**Figure 29**: Update the **SELECT** Statement for the **GetProducts()** Method ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image81.png))</span></span>


<span data-ttu-id="bbce2-377">Dopo aver aggiornato il **GetProducts()** metodo da usare questa nuova query DataTable includerà due nuove colonne: **CategoryName** e **SupplierName**.</span><span class="sxs-lookup"><span data-stu-id="bbce2-377">After updating the **GetProducts()** method to use this new query the DataTable will include two new columns: **CategoryName** and **SupplierName**.</span></span>


![Nel DataTable dei prodotti dispone di due nuove colonne](creating-a-data-access-layer-cs/_static/image82.png)

<span data-ttu-id="bbce2-379">**Figura 30**: Il **prodotti** DataTable ha due nuove colonne</span><span class="sxs-lookup"><span data-stu-id="bbce2-379">**Figure 30**: The **Products** DataTable has Two New Columns</span></span>


<span data-ttu-id="bbce2-380">Si consiglia di aggiornare il **selezionate** clausola nel **GetProductsByCategoryID (*categoryID*)** anche metodo.</span><span class="sxs-lookup"><span data-stu-id="bbce2-380">Take a moment to update the **SELECT** clause in the **GetProductsByCategoryID(*categoryID*)** method as well.</span></span>

<span data-ttu-id="bbce2-381">Se si aggiorna il **GetProducts()** **seleziona** usando **JOIN** sintassi la finestra di progettazione set di dati non sarà in grado di generare automaticamente i metodi per l'inserimento, aggiornamento ed eliminazione dati del database usando il modello di direct DB.</span><span class="sxs-lookup"><span data-stu-id="bbce2-381">If you update the **GetProducts()** **SELECT** using **JOIN** syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="bbce2-382">Al contrario, sarà necessario crearle manualmente molto come abbiamo fatto con il **InsertProduct** metodo precedentemente in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-382">Instead, you'll have to manually create them much like we did with the **InsertProduct** method earlier in this tutorial.</span></span> <span data-ttu-id="bbce2-383">Inoltre, manualmente è possibile fornire il **InsertCommand**, **UpdateCommand**, e **DeleteCommand** valori della proprietà se si desidera utilizzare il modello di aggiornamento batch.</span><span class="sxs-lookup"><span data-stu-id="bbce2-383">Furthermore, you'll manually have to provide the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="bbce2-384">Aggiunge gli oggetti TableAdapter rimanenti</span><span class="sxs-lookup"><span data-stu-id="bbce2-384">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="bbce2-385">Fino ad ora, abbiamo esaminato solo uso di un singolo TableAdapter per una singola tabella di database.</span><span class="sxs-lookup"><span data-stu-id="bbce2-385">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="bbce2-386">Tuttavia, il database di Northwind contiene più tabelle correlate che è necessario lavorare con nella nostra applicazione web.</span><span class="sxs-lookup"><span data-stu-id="bbce2-386">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="bbce2-387">Un set di dati tipizzato può contenere più di DataTable correlati.</span><span class="sxs-lookup"><span data-stu-id="bbce2-387">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="bbce2-388">Per completare il di conseguenza, è necessario aggiungere DataTable per le altre tabelle che verrà usato in queste esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="bbce2-388">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="bbce2-389">Per aggiungere un nuovo TableAdapter a un DataSet tipizzato, aprire la finestra di progettazione set di dati, fare doppio clic nella finestra di progettazione e scegliere Aggiungi / TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="bbce2-389">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="bbce2-390">Ciò crea un nuovo DataTable e TableAdapter e consentono di eseguire la procedura guidata che si sono esaminate in precedenza in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-390">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="bbce2-391">Richiedere alcuni minuti per creare i seguenti oggetti TableAdapter e i metodi utilizzando le query seguenti.</span><span class="sxs-lookup"><span data-stu-id="bbce2-391">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="bbce2-392">Si noti che le query nella **ProductsTableAdapter** includono le sottoquery per recuperare i nomi di categoria e il fornitore di ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="bbce2-392">Note that the queries in the **ProductsTableAdapter** include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="bbce2-393">Inoltre, se sono state eseguite, è già stato aggiunto il **ProductsTableAdapter** della classe **GetProducts()** e **GetProductsByCategoryID (*categoryID\* )*\* metodi.</span><span class="sxs-lookup"><span data-stu-id="bbce2-393">Additionally, if you've been following along, you've already added the **ProductsTableAdapter** class's **GetProducts()** and **GetProductsByCategoryID(*categoryID*)** methods.</span></span>

- <span data-ttu-id="bbce2-394">**ProductsTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="bbce2-394">**ProductsTableAdapter**</span></span>

  - <span data-ttu-id="bbce2-395">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-395">**GetProducts**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample10.sql)]
  - <span data-ttu-id="bbce2-396">**GetProductsByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-396">**GetProductsByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample11.sql)]
  - <span data-ttu-id="bbce2-397">**GetProductsBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-397">**GetProductsBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample12.sql)]
  - <span data-ttu-id="bbce2-398">**GetProductByProductID**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-398">**GetProductByProductID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample13.sql)]
- <span data-ttu-id="bbce2-399">**CategoriesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="bbce2-399">**CategoriesTableAdapter**</span></span>

  - <span data-ttu-id="bbce2-400">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-400">**GetCategories**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample14.sql)]
  - <span data-ttu-id="bbce2-401">**GetCategoryByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-401">**GetCategoryByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample15.sql)]
- <span data-ttu-id="bbce2-402">**SuppliersTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="bbce2-402">**SuppliersTableAdapter**</span></span>

  - <span data-ttu-id="bbce2-403">**GetSuppliers**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-403">**GetSuppliers**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample16.sql)]
  - <span data-ttu-id="bbce2-404">**GetSuppliersByCountry**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-404">**GetSuppliersByCountry**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample17.sql)]
  - <span data-ttu-id="bbce2-405">**GetSupplierBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-405">**GetSupplierBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample18.sql)]
- <span data-ttu-id="bbce2-406">**EmployeesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="bbce2-406">**EmployeesTableAdapter**</span></span>

  - <span data-ttu-id="bbce2-407">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-407">**GetEmployees**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample19.sql)]
  - <span data-ttu-id="bbce2-408">**GetEmployeesByManager**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-408">**GetEmployeesByManager**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample20.sql)]
  - <span data-ttu-id="bbce2-409">**GetEmployeeByEmployeeID**:</span><span class="sxs-lookup"><span data-stu-id="bbce2-409">**GetEmployeeByEmployeeID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample21.sql)]


<span data-ttu-id="bbce2-410">[![La finestra di progettazione set di dati dopo che sono stati aggiunti i quattro oggetti TableAdapter](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-410">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span></span>

<span data-ttu-id="bbce2-411">**Figura 31**: Il set di dati di progettazione dopo il quattro oggetti TableAdapter sono state aggiunte ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-411">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image85.png))</span></span>


## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="bbce2-412">Aggiungere codice personalizzato al DAL</span><span class="sxs-lookup"><span data-stu-id="bbce2-412">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="bbce2-413">Il TableAdapter e DataTable aggiunto al set di dati tipizzati sono espressi come un file di XML Schema Definition (**Northwind.xsd**).</span><span class="sxs-lookup"><span data-stu-id="bbce2-413">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (**Northwind.xsd**).</span></span> <span data-ttu-id="bbce2-414">È possibile visualizzare queste informazioni sullo schema facendo clic sui **Northwind.xsd** file in Esplora soluzioni e scegliere Visualizza codice.</span><span class="sxs-lookup"><span data-stu-id="bbce2-414">You can view this schema information by right-clicking on the **Northwind.xsd** file in the Solution Explorer and choosing View Code.</span></span>


<span data-ttu-id="bbce2-415">[![Il File XML Schema Definition (XSD) per l'Employees DataSet tipizzato](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-415">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span></span>

<span data-ttu-id="bbce2-416">**Figura 32**: Il File di XML Schema Definition (XSD) per il set di dati tipizzato Employees ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-416">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image88.png))</span></span>


<span data-ttu-id="bbce2-417">Queste informazioni sullo schema viene tradotta in codice c# o Visual Basic in fase di progettazione durante la compilazione o in fase di esecuzione (se necessario), a questo punto è possibile eseguire attraverso di esso con il debugger.</span><span class="sxs-lookup"><span data-stu-id="bbce2-417">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="bbce2-418">Per visualizzare questo codice generato automaticamente Vai a Visualizzazione classi e il drill down per le classi TableAdapter o set di dati tipizzato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-418">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="bbce2-419">Se non è disponibile la classe sullo schermo, andare al menu View e selezionarlo da qui o premere Ctrl + Maiusc + C.</span><span class="sxs-lookup"><span data-stu-id="bbce2-419">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="bbce2-420">Dalla visualizzazione classi è possibile visualizzare le proprietà, metodi ed eventi delle classi TableAdapter e DataSet tipizzato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-420">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="bbce2-421">Per visualizzare il codice per un metodo specifico, fare doppio clic sul nome del metodo in visualizzazione classi o fare clic su di esso e scegliere Vai a definizione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-421">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>


![Esaminare il codice generato automaticamente, selezionare Vai alla definizione da Visualizzazione classi](creating-a-data-access-layer-cs/_static/image89.png)

<span data-ttu-id="bbce2-423">**Figura 33**: Esaminare il codice generato automaticamente, selezionare Vai alla definizione da Visualizzazione classi</span><span class="sxs-lookup"><span data-stu-id="bbce2-423">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>


<span data-ttu-id="bbce2-424">Codice generato automaticamente può essere una di risparmiare molto tempo, il codice è spesso molto generico e deve essere personalizzato per soddisfare le esigenze di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-424">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="bbce2-425">Il rischio di estensione di codice generato automaticamente, tuttavia, è che lo strumento che ha generato il codice potrebbe decidere che è il momento di "Rigenera" e sovrascrivere le personalizzazioni.</span><span class="sxs-lookup"><span data-stu-id="bbce2-425">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="bbce2-426">Con il concetto di classe parziale nuovo .NET 2.0, è facile suddividere una classe su più file.</span><span class="sxs-lookup"><span data-stu-id="bbce2-426">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="bbce2-427">Ciò ci consente di aggiungere i propri metodi, proprietà ed eventi per le classi generate automaticamente senza doversi preoccupare di sovrascrivere i personalizzazioni Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bbce2-427">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="bbce2-428">Per illustrare come personalizzare DAL, aggiungiamo un **GetProducts()** metodo per il **SuppliersRow** classe.</span><span class="sxs-lookup"><span data-stu-id="bbce2-428">To demonstrate how to customize the DAL, let's add a **GetProducts()** method to the **SuppliersRow** class.</span></span> <span data-ttu-id="bbce2-429">Il **SuppliersRow** classe rappresenta un singolo record nelle **Suppliers** tabella; ogni provider can supplier zero a molti prodotti, in modo **GetProducts()** restituirà quelli prodotti di fornitore specificato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-429">The **SuppliersRow** class represents a single record in the **Suppliers** table; each supplier can provider zero to many products, so **GetProducts()** will return those products of the specified supplier.</span></span> <span data-ttu-id="bbce2-430">Per eseguire questo crea un nuovo file di classe nel **App\_codice** cartella denominata **SuppliersRow.cs** e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="bbce2-430">To accomplish this create a new class file in the **App\_Code** folder named **SuppliersRow.cs** and add the following code:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample22.cs)]

<span data-ttu-id="bbce2-431">Questa classe parziale indica al compilatore che, quando la compilazione la **Northwind.SuppliersRow** classe per includere il **GetProducts()** metodo definita.</span><span class="sxs-lookup"><span data-stu-id="bbce2-431">This partial class instructs the compiler that when building the **Northwind.SuppliersRow** class to include the **GetProducts()** method we just defined.</span></span> <span data-ttu-id="bbce2-432">Se si compila il progetto e quindi tornare alla visualizzazione classi si noterà **GetProducts()** ora elencato come un metodo dei **Northwind.SuppliersRow**.</span><span class="sxs-lookup"><span data-stu-id="bbce2-432">If you build your project and then return to the Class View you'll see **GetProducts()** now listed as a method of **Northwind.SuppliersRow**.</span></span>


![Il metodo GetProducts() fa ora parte della classe Northwind.SuppliersRow](creating-a-data-access-layer-cs/_static/image90.png)

<span data-ttu-id="bbce2-434">**Figura 34**: Il **GetProducts()** metodo fa ora parte delle **Northwind.SuppliersRow** classe</span><span class="sxs-lookup"><span data-stu-id="bbce2-434">**Figure 34**: The **GetProducts()** Method is Now Part of the **Northwind.SuppliersRow** Class</span></span>


<span data-ttu-id="bbce2-435">Il **GetProducts()** metodo ora può essere utilizzato per enumerare il set di prodotti per un particolare fornitore, come illustrato nel codice seguente:</span><span class="sxs-lookup"><span data-stu-id="bbce2-435">The **GetProducts()** method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample23.html)]

<span data-ttu-id="bbce2-436">Questo tipo di dati può essere visualizzato anche in una qualsiasi di ASP. Controlli Web dei dati di NET.</span><span class="sxs-lookup"><span data-stu-id="bbce2-436">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="bbce2-437">La pagina seguente usa un controllo GridView con due campi:</span><span class="sxs-lookup"><span data-stu-id="bbce2-437">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="bbce2-438">Un BoundField che visualizza il nome di ogni fornitore, e</span><span class="sxs-lookup"><span data-stu-id="bbce2-438">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="bbce2-439">Un TemplateField contenente un controllo BulletedList associato ai risultati restituiti per il **GetProducts()** metodo per ogni fornitore.</span><span class="sxs-lookup"><span data-stu-id="bbce2-439">A TemplateField that contains a BulletedList control that is bound to the results returned by the **GetProducts()** method for each supplier.</span></span>

<span data-ttu-id="bbce2-440">Verrà esaminato come visualizzare tali relazioni master / dettaglio in esercitazioni future.</span><span class="sxs-lookup"><span data-stu-id="bbce2-440">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="bbce2-441">Per ora, in questo esempio è progettato per illustrare l'utilizzo del metodo personalizzato aggiunto al **Northwind.SuppliersRow** classe.</span><span class="sxs-lookup"><span data-stu-id="bbce2-441">For now, this example is designed to illustrate using the custom method added to the **Northwind.SuppliersRow** class.</span></span>

<span data-ttu-id="bbce2-442">SuppliersAndProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="bbce2-442">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample24.aspx)]

<span data-ttu-id="bbce2-443">SuppliersAndProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="bbce2-443">SuppliersAndProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample25.cs)]


<span data-ttu-id="bbce2-444">[![Nome della società del fornitore è elencato nella colonna sinistra relativi prodotti in destra](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="bbce2-444">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span></span>

<span data-ttu-id="bbce2-445">**Figura 35**: Nome della società del fornitore è elencato nella colonna sinistra relativi prodotti in destra ([fare clic per visualizzare l'immagine con dimensioni normali](creating-a-data-access-layer-cs/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="bbce2-445">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image93.png))</span></span>


## <a name="summary"></a><span data-ttu-id="bbce2-446">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="bbce2-446">Summary</span></span>

<span data-ttu-id="bbce2-447">Quando compila un'applicazione web di creazione deve essere uno dei primi passaggi, che si verificano prima di iniziare a creare il livello di presentazione.</span><span class="sxs-lookup"><span data-stu-id="bbce2-447">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="bbce2-448">Con Visual Studio, creazione di DAL basato su dataset tipizzati è un'attività che può essere eseguita in 10-15 minuti senza dover scrivere una riga di codice.</span><span class="sxs-lookup"><span data-stu-id="bbce2-448">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="bbce2-449">Le esercitazioni in futuro verranno si basano su DAL.</span><span class="sxs-lookup"><span data-stu-id="bbce2-449">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="bbce2-450">Nel [prossima esercitazione](creating-a-business-logic-layer-cs.md) verrà definito un numero di regole di business e informazioni su come implementarli in un livello di logica di Business separato.</span><span class="sxs-lookup"><span data-stu-id="bbce2-450">In the [next tutorial](creating-a-business-logic-layer-cs.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="bbce2-451">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="bbce2-451">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="bbce2-452">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="bbce2-452">Further Reading</span></span>

<span data-ttu-id="bbce2-453">Per altre informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="bbce2-453">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="bbce2-454">Creazione di DAL usando TableAdapter fortemente tipizzati e DataTable in Visual Studio 2005 e ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="bbce2-454">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="bbce2-455">Progettazione di componenti livello dati e passare dati tramite i livelli</span><span class="sxs-lookup"><span data-stu-id="bbce2-455">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/library/ms978496.aspx)
- [<span data-ttu-id="bbce2-456">Creare un livello di accesso ai dati con set di dati di progettazione di Visual Studio 2005</span><span class="sxs-lookup"><span data-stu-id="bbce2-456">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="bbce2-457">La crittografia delle informazioni di configurazione in ASP.NET 2.0 Applications</span><span class="sxs-lookup"><span data-stu-id="bbce2-457">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="bbce2-458">Panoramica degli oggetti TableAdapter</span><span class="sxs-lookup"><span data-stu-id="bbce2-458">TableAdapter Overview</span></span>](https://msdn.microsoft.com/library/bz9tthwx.aspx)
- [<span data-ttu-id="bbce2-459">Utilizzo di un DataSet tipizzato</span><span class="sxs-lookup"><span data-stu-id="bbce2-459">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/library/esbykkzb.aspx)
- [<span data-ttu-id="bbce2-460">Usando l'accesso ai dati fortemente tipizzati in Visual Studio 2005 e ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="bbce2-460">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="bbce2-461">Come estendere i metodi TableAdapter</span><span class="sxs-lookup"><span data-stu-id="bbce2-461">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="bbce2-462">Il recupero di dati scalare da una Stored Procedure</span><span class="sxs-lookup"><span data-stu-id="bbce2-462">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="bbce2-463">Formazione in video su argomenti contenuti in questa esercitazione</span><span class="sxs-lookup"><span data-stu-id="bbce2-463">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="bbce2-464">Livelli di accesso ai dati nelle applicazioni ASP.NET</span><span class="sxs-lookup"><span data-stu-id="bbce2-464">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="bbce2-465">Come associare manualmente un set di dati a un controllo Datagrid</span><span class="sxs-lookup"><span data-stu-id="bbce2-465">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="bbce2-466">Come lavorare con i set di dati e i filtri di un'applicazione ASP</span><span class="sxs-lookup"><span data-stu-id="bbce2-466">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="bbce2-467">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="bbce2-467">About the Author</span></span>

<span data-ttu-id="bbce2-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="bbce2-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="bbce2-469">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="bbce2-469">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="bbce2-470">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="bbce2-470">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="bbce2-471">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="bbce2-471">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="bbce2-472">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="bbce2-472">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="bbce2-473">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="bbce2-473">Special Thanks To</span></span>

<span data-ttu-id="bbce2-474">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="bbce2-474">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="bbce2-475">I revisori per questa esercitazione sono state Carlos Santos, Abel Gomez, Liz Shulok, Dennis Patterson, Hilton Giesenow e Ron Green.</span><span class="sxs-lookup"><span data-stu-id="bbce2-475">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="bbce2-476">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="bbce2-476">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="bbce2-477">In questo caso, Inviami una riga in corrispondenza [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="bbce2-477">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="bbce2-478">avanti</span><span class="sxs-lookup"><span data-stu-id="bbce2-478">Next</span></span>](creating-a-business-logic-layer-cs.md)
