---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
title: A livello di codice impostando i valori dei parametri di ObjectDataSource (c#) | Microsoft Docs
author: rick-anderson
description: In questa esercitazione verrà esaminato l'aggiunta di un metodo al nostro DAL e BLL che accetta un parametro di input e restituisce i dati. Questo parametro viene impostato nell'esempio...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 1c4588bb-255d-4088-b319-5208da756f4d
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
msc.type: authoredcontent
ms.openlocfilehash: 78de288977f55ffe73c5b34329cd5b5c5c84334f
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/01/2019
ms.locfileid: "57034198"
---
<a name="programmatically-setting-the-objectdatasources-parameter-values-c"></a><span data-ttu-id="2e99c-104">Impostazione a livello di programmazione dei valori dei parametri di ObjectDataSource (C#)</span><span class="sxs-lookup"><span data-stu-id="2e99c-104">Programmatically Setting the ObjectDataSource's Parameter Values (C#)</span></span>
====================
<span data-ttu-id="2e99c-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2e99c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2e99c-106">[Scaricare l'App di esempio](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) o [Scarica il PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2e99c-106">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span></span>

> <span data-ttu-id="2e99c-107">In questa esercitazione verrà esaminato l'aggiunta di un metodo al nostro DAL e BLL che accetta un parametro di input e restituisce i dati.</span><span class="sxs-lookup"><span data-stu-id="2e99c-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="2e99c-108">Questo parametro viene impostato a livello di codice nell'esempio.</span><span class="sxs-lookup"><span data-stu-id="2e99c-108">The example will set this parameter programmatically.</span></span>


## <a name="introduction"></a><span data-ttu-id="2e99c-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="2e99c-109">Introduction</span></span>

<span data-ttu-id="2e99c-110">Come abbiamo visto nel [esercitazione precedente](declarative-parameters-cs.md), una serie di opzioni è disponibile per il passaggio in modo dichiarativo i valori dei parametri ai metodi di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="2e99c-110">As we saw in the [previous tutorial](declarative-parameters-cs.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="2e99c-111">Se il valore del parametro è hardcoded, proviene da un controllo Web nella pagina o in qualsiasi altra origine che è leggibile da un'origine dati `Parameter` dell'oggetto, ad esempio, di valore può essere associato al parametro di input senza scrivere una riga di codice.</span><span class="sxs-lookup"><span data-stu-id="2e99c-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="2e99c-112">Potrebbero esserci casi, tuttavia, quando il valore del parametro viene fornito da un'origine non è già stato presi in considerazione da uno dei file di dati incorporato `Parameter` oggetti.</span><span class="sxs-lookup"><span data-stu-id="2e99c-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="2e99c-113">Se gli account utente è supportato il nostro sito potrebbe essere necessario impostare il parametro di base attualmente connesso nell'ID del utente. visitatore dell'</span><span class="sxs-lookup"><span data-stu-id="2e99c-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="2e99c-114">Oppure potrebbe essere necessario personalizzare il valore del parametro prima dell'invio insieme al metodo dell'oggetto sottostante di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="2e99c-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="2e99c-115">Ogni volta che ObjectDataSource `Select` metodo viene richiamato ObjectDataSource genera prima relativi [evento Selecting](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="2e99c-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="2e99c-116">Quindi viene richiamato il metodo dell'oggetto sottostante di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="2e99c-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="2e99c-117">Dopo aver completato l'operazione di ObjectDataSource [selezionati eventi](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) generato (figura 1 illustra questa sequenza di eventi).</span><span class="sxs-lookup"><span data-stu-id="2e99c-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="2e99c-118">I valori del parametro passati nel metodo dell'oggetto sottostante di ObjectDataSource possono essere impostati o personalizzati in un gestore eventi per il `Selecting` evento.</span><span class="sxs-lookup"><span data-stu-id="2e99c-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>


<span data-ttu-id="2e99c-119">[![Viene richiamato selezionati e il metodo selezionando gli eventi attivati prima e dopo il suo dell'oggetto sottostante di ObjectDataSource](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2e99c-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span></span>

<span data-ttu-id="2e99c-120">**Figura 1**: ObjectDataSource `Selected` e `Selecting` metodo eventi attivati prima e dopo il suo sottostante dell'oggetto viene richiamato ([fare clic per visualizzare l'immagine con dimensioni normali](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2e99c-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span></span>


<span data-ttu-id="2e99c-121">In questa esercitazione verrà esaminato l'aggiunta di un metodo al nostro DAL e BLL che accetta un parametro di input `Month`, di tipo `int` e restituisce un `EmployeesDataTable` oggetto popolato con i dipendenti che hanno la ricorrenza annuale dell'assunzione nell'oggetto specificato `Month`.</span><span class="sxs-lookup"><span data-stu-id="2e99c-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `int` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="2e99c-122">Questo esempio verrà impostato questo parametro a livello di programmazione basato sul mese corrente, che mostra un elenco di "Employee ricorrenze questo mese".</span><span class="sxs-lookup"><span data-stu-id="2e99c-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="2e99c-123">Iniziamo!</span><span class="sxs-lookup"><span data-stu-id="2e99c-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="2e99c-124">Passaggio 1: Aggiunta di un metodo per`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="2e99c-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="2e99c-125">Per questo primo esempio è necessario aggiungere un mezzo per recuperare i dipendenti il cui `HireDate` si è verificato in un mese specificato.</span><span class="sxs-lookup"><span data-stu-id="2e99c-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="2e99c-126">Per fornire questa funzionalità in base alla nostra architettura è necessario innanzitutto creare un metodo in `EmployeesTableAdapter` che esegue il mapping all'istruzione SQL appropriata.</span><span class="sxs-lookup"><span data-stu-id="2e99c-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="2e99c-127">A tale scopo, iniziare aprendo il set di dati tipizzato Northwind.</span><span class="sxs-lookup"><span data-stu-id="2e99c-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="2e99c-128">Fare clic su di `EmployeesTableAdapter` assegnare un'etichetta e scegliere Aggiungi Query.</span><span class="sxs-lookup"><span data-stu-id="2e99c-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>


<span data-ttu-id="2e99c-129">[![Aggiungere una nuova Query per il EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2e99c-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span></span>

<span data-ttu-id="2e99c-130">**Figura 2**: Aggiungere una nuova Query per il `EmployeesTableAdapter` ([fare clic per visualizzare l'immagine con dimensioni normali](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2e99c-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span></span>


<span data-ttu-id="2e99c-131">Scegliere di aggiungere un'istruzione SQL che restituisce righe.</span><span class="sxs-lookup"><span data-stu-id="2e99c-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="2e99c-132">Quando si raggiunge lo specificare una `SELECT` istruzione schermata il valore predefinito `SELECT` istruzione per il `EmployeesTableAdapter` saranno già caricato.</span><span class="sxs-lookup"><span data-stu-id="2e99c-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="2e99c-133">Aggiungere semplicemente nel `WHERE` clausola: `WHERE DATEPART(m, HireDate) = @Month`.</span><span class="sxs-lookup"><span data-stu-id="2e99c-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="2e99c-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) è una funzione T-SQL che restituisce una data specifica parte di un `datetime` tipo; in questo caso usiamo `DATEPART` per tornare il mese del `HireDate` colonna.</span><span class="sxs-lookup"><span data-stu-id="2e99c-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>


<span data-ttu-id="2e99c-135">[![Restituito solo le righe in cui HireDate Sloupec JE minore o uguale al @HiredBeforeDate parametro](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2e99c-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span></span>

<span data-ttu-id="2e99c-136">**Figura 3**: Restituire solo le righe in cui il `HireDate` colonna è minore o uguale al `@HiredBeforeDate` parametro ([fare clic per visualizzare l'immagine con dimensioni normali](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="2e99c-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span></span>


<span data-ttu-id="2e99c-137">Infine, modificare il `FillBy` e `GetDataBy` i nomi dei metodi per `FillByHiredDateMonth` e `GetEmployeesByHiredDateMonth`, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="2e99c-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>


<span data-ttu-id="2e99c-138">[![Scegliere i nomi dei metodi più Appropriate rispetto alle FillBy e GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="2e99c-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span></span>

<span data-ttu-id="2e99c-139">**Figura 4**: Scegliere più appropriato metodo nomi rispetto `FillBy` e `GetDataBy` ([fare clic per visualizzare l'immagine con dimensioni normali](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="2e99c-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span></span>


<span data-ttu-id="2e99c-140">Fare clic su Fine per completare la procedura guidata e tornare all'area di progettazione del set di dati.</span><span class="sxs-lookup"><span data-stu-id="2e99c-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="2e99c-141">Il `EmployeesTableAdapter` dovrebbe ora includere un nuovo set di metodi per l'accesso di dipendenti assunti in un mese specificato.</span><span class="sxs-lookup"><span data-stu-id="2e99c-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>


<span data-ttu-id="2e99c-142">[![I nuovi metodi vengono visualizzati nell'area di progettazione del set di dati](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2e99c-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span></span>

<span data-ttu-id="2e99c-143">**Figura 5**: I nuovi metodi presenti nell'area di progettazione del set di dati ([fare clic per visualizzare l'immagine con dimensioni normali](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="2e99c-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span></span>


## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="2e99c-144">Passaggio 2: Aggiunta di`GetEmployeesByHiredDateMonth(month)`metodo a livello della logica di Business</span><span class="sxs-lookup"><span data-stu-id="2e99c-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="2e99c-145">Poiché l'Usa di architettura dell'applicazione separato dei livelli per la logica di business e dati di accesso per la logica, è necessario aggiungere un metodo per il livello BLL che le chiamate al per recuperare i dipendenti assunti prima della data specificata.</span><span class="sxs-lookup"><span data-stu-id="2e99c-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="2e99c-146">Aprire il `EmployeesBLL.cs` file e aggiungere il metodo seguente:</span><span class="sxs-lookup"><span data-stu-id="2e99c-146">Open the `EmployeesBLL.cs` file and add the following method:</span></span>


[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample1.cs)]

<span data-ttu-id="2e99c-147">Come con altri metodi in questa classe `GetEmployeesByHiredDateMonth(month)` chiama semplicemente verso il basso DAL e restituisce i risultati.</span><span class="sxs-lookup"><span data-stu-id="2e99c-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="2e99c-148">Passaggio 3: Visualizzazione dei dipendenti la cui anniversario assunzione è questo mese</span><span class="sxs-lookup"><span data-stu-id="2e99c-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="2e99c-149">Il passaggio finale per questo esempio consiste nella visualizzazione quei dipendenti la cui anniversario assunzione è questo mese.</span><span class="sxs-lookup"><span data-stu-id="2e99c-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="2e99c-150">Iniziare aggiungendo un controllo GridView per il `ProgrammaticParams.aspx` nella pagina di `BasicReporting` cartella e aggiungere un nuovo oggetto ObjectDataSource come origine dati.</span><span class="sxs-lookup"><span data-stu-id="2e99c-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="2e99c-151">Configurare ObjectDataSource per usare la `EmployeesBLL` classe con il `SelectMethod` impostato su `GetEmployeesByHiredDateMonth(month)`.</span><span class="sxs-lookup"><span data-stu-id="2e99c-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>


<span data-ttu-id="2e99c-152">[![Usare la classe EmployeesBLL](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="2e99c-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span></span>

<span data-ttu-id="2e99c-153">**Figura 6**: Usare la `EmployeesBLL` classe ([fare clic per visualizzare l'immagine con dimensioni normali](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="2e99c-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span></span>


<span data-ttu-id="2e99c-154">[![Selezionare da GetEmployeesByHiredDateMonth(month) (metodo)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="2e99c-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span></span>

<span data-ttu-id="2e99c-155">**Figura 7**: Select From la `GetEmployeesByHiredDateMonth(month)` metodo ([fare clic per visualizzare l'immagine con dimensioni normali](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="2e99c-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span></span>


<span data-ttu-id="2e99c-156">Schermata finale viene chiesto di specificare per fornire la `month` origine del valore del parametro.</span><span class="sxs-lookup"><span data-stu-id="2e99c-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="2e99c-157">Poiché questo valore verrà impostata a livello di codice, lasciare il parametro source impostati sul valore predefinito None opzione e fare clic su Fine.</span><span class="sxs-lookup"><span data-stu-id="2e99c-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>


<span data-ttu-id="2e99c-158">[![Lasciare il parametro Source impostato su Nessuno](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="2e99c-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span></span>

<span data-ttu-id="2e99c-159">**Figura 8**: Lasciare l'origine di parametro impostato su None ([fare clic per visualizzare l'immagine con dimensioni normali](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="2e99c-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span></span>


<span data-ttu-id="2e99c-160">Verrà creato un `Parameter` oggetto nella finestra di ObjectDataSource `SelectParameters` raccolta che non ha un valore specificato.</span><span class="sxs-lookup"><span data-stu-id="2e99c-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>


[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample2.aspx)]

<span data-ttu-id="2e99c-161">Per impostare questo valore a livello di codice, è necessario creare un gestore eventi per ObjectDataSource `Selecting` evento.</span><span class="sxs-lookup"><span data-stu-id="2e99c-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="2e99c-162">A tale scopo, passare alla visualizzazione progettazione e fare doppio clic su ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="2e99c-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="2e99c-163">In alternativa, selezionare ObjectDataSource, passare alla finestra delle proprietà e scegliere l'icona a forma di fulmine.</span><span class="sxs-lookup"><span data-stu-id="2e99c-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="2e99c-164">Successivamente, fare doppio clic nella casella di testo accanto al `Selecting` evento o digitare il nome da usare il gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="2e99c-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span>


![Fare clic sull'icona a forma di fulmine nella finestra proprietà per visualizzare l'elenco degli eventi di un controllo Web](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image25.png)

<span data-ttu-id="2e99c-166">**Figura 9**: Fare clic sull'icona a forma di fulmine nella finestra proprietà per visualizzare l'elenco degli eventi di un controllo Web</span><span class="sxs-lookup"><span data-stu-id="2e99c-166">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>


<span data-ttu-id="2e99c-167">Entrambi gli approcci aggiungere un nuovo gestore eventi per ObjectDataSource `Selecting` classe code-behind della pagina dell'evento.</span><span class="sxs-lookup"><span data-stu-id="2e99c-167">Both approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="2e99c-168">In questo gestore eventi è possibile leggere e scrivere i valori di parametro utilizzando `e.InputParameters[parameterName]`, dove *`parameterName`* è il valore della `Name` attributo il `<asp:Parameter>` tag (il `InputParameters` insieme può anche essere indicizzata ordinale, come in `e.InputParameters[index]`).</span><span class="sxs-lookup"><span data-stu-id="2e99c-168">In this event handler we can read and write to the parameter values using `e.InputParameters[parameterName]`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters[index]`).</span></span> <span data-ttu-id="2e99c-169">Per impostare il `month` parametro per il mese corrente, aggiungere il codice seguente il `Selecting` gestore dell'evento:</span><span class="sxs-lookup"><span data-stu-id="2e99c-169">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>


[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample3.cs)]

<span data-ttu-id="2e99c-170">Quando si visita questa pagina tramite un browser è possibile osservare che un solo dipendente è stato assunto questo mese (marzo) Laura Callahan, chi ha lavorato nell'azienda dal 1994.</span><span class="sxs-lookup"><span data-stu-id="2e99c-170">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>


<span data-ttu-id="2e99c-171">[![I dipendenti il cui ricorrenze questo mese vengono visualizzati](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="2e99c-171">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span></span>

<span data-ttu-id="2e99c-172">**Figura 10**: I dipendenti la cui ricorrenze questo mese vengono visualizzati ([fare clic per visualizzare l'immagine con dimensioni normali](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="2e99c-172">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span></span>


## <a name="summary"></a><span data-ttu-id="2e99c-173">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="2e99c-173">Summary</span></span>

<span data-ttu-id="2e99c-174">Mentre i parametri di ObjectDataSource in genere possibile impostare i valori in modo dichiarativo, senza richiedere una riga di codice, è facile impostare i valori dei parametri a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="2e99c-174">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="2e99c-175">Tutto dobbiamo fare è creare un gestore eventi per ObjectDataSource `Selecting` evento, che viene attivato prima che venga richiamato il metodo dell'oggetto sottostante e impostare manualmente i valori per uno o più parametri tramite la `InputParameters` raccolta.</span><span class="sxs-lookup"><span data-stu-id="2e99c-175">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="2e99c-176">Questa esercitazione si conclude la sezione Basic Reporting.</span><span class="sxs-lookup"><span data-stu-id="2e99c-176">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="2e99c-177">Il [prossima esercitazione](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) la sezione di operazioni di filtro e gli scenari di Master-Details, in cui abbiamo verranno analizzate le tecniche per consentire il visitatore per filtrare i dati e il drill-down da un report master in un report dettagli viene avviato.</span><span class="sxs-lookup"><span data-stu-id="2e99c-177">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="2e99c-178">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="2e99c-178">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2e99c-179">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="2e99c-179">About the Author</span></span>

<span data-ttu-id="2e99c-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="2e99c-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2e99c-181">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="2e99c-181">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2e99c-182">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2e99c-182">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2e99c-183">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2e99c-183">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2e99c-184">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2e99c-184">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2e99c-185">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="2e99c-185">Special Thanks To</span></span>

<span data-ttu-id="2e99c-186">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="2e99c-186">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2e99c-187">Hilton Giesenow, revisore per questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="2e99c-187">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="2e99c-188">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="2e99c-188">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2e99c-189">In questo caso, Inviami una riga in corrispondenza [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2e99c-189">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2e99c-190">[Precedente](declarative-parameters-cs.md)
> [Successivo](displaying-data-with-the-objectdatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2e99c-190">[Previous](declarative-parameters-cs.md)
[Next](displaying-data-with-the-objectdatasource-vb.md)</span></span>
