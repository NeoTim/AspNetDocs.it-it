---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: Parametri dichiarativi (VB) | Microsoft Docs
author: rick-anderson
description: In questa esercitazione verrà illustrato come utilizzare un set di parametri su un valore hardcoded per selezionare i dati da visualizzare in un controllo DetailsView.
ms.author: riande
ms.date: 03/31/2010
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: cdc42752fc78d18366af037a81fe4ebe5a1646ef
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78597139"
---
# <a name="declarative-parameters-vb"></a><span data-ttu-id="e4ed3-103">Parametri dichiarativi (VB)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-103">Declarative Parameters (VB)</span></span>

<span data-ttu-id="e4ed3-104">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e4ed3-105">[Scaricare l'app di esempio](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) o [scaricare il file PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="e4ed3-106">In questa esercitazione verrà illustrato come utilizzare un set di parametri su un valore hardcoded per selezionare i dati da visualizzare in un controllo DetailsView.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>

## <a name="introduction"></a><span data-ttu-id="e4ed3-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="e4ed3-107">Introduction</span></span>

<span data-ttu-id="e4ed3-108">Nell' [ultima esercitazione](displaying-data-with-the-objectdatasource-vb.md) è stata esaminata la visualizzazione dei dati con i controlli GridView, DetailsView e FormView associati a un controllo ObjectDataSource che ha richiamato il metodo `GetProducts()` dalla classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="e4ed3-109">Il metodo `GetProducts()` restituisce un oggetto DataTable fortemente tipizzato popolato con tutti i record della tabella `Products` del database Northwind.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="e4ed3-110">La classe `ProductsBLL` contiene metodi aggiuntivi per restituire solo i subset dei prodotti-`GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`e `GetProductsBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="e4ed3-111">Questi tre metodi prevedono un parametro di input che indichi come filtrare le informazioni sul prodotto restituite.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="e4ed3-112">È possibile utilizzare ObjectDataSource per richiamare metodi che prevedono parametri di input, ma a tale scopo è necessario specificare la posizione da cui provengono i valori per questi parametri.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="e4ed3-113">I valori dei parametri possono essere hardcoded oppure possono provenire da diverse origini dinamiche, tra cui: valori QueryString, variabili di sessione, il valore della proprietà di un controllo Web nella pagina o altri.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="e4ed3-114">Per questa esercitazione verrà illustrato come usare un set di parametri in un valore hardcoded.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="e4ed3-115">In particolare, si esaminerà l'aggiunta di un DetailsView alla pagina che visualizza le informazioni su un prodotto specifico, ovvero la combinazione di gumbo di chef Anton, che ha un `ProductID` di 5.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="e4ed3-116">Si vedrà quindi come impostare il valore del parametro in base a un controllo Web.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="e4ed3-117">In particolare, si userà una casella di testo per consentire all'utente di digitare un paese, dopo il quale è possibile fare clic su un pulsante per visualizzare l'elenco dei fornitori che risiedono in quel paese.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="e4ed3-118">Uso di un valore di parametro hardcoded</span><span class="sxs-lookup"><span data-stu-id="e4ed3-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="e4ed3-119">Per il primo esempio, iniziare aggiungendo un controllo DetailsView alla pagina `DeclarativeParams.aspx` nella cartella `BasicReporting`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="e4ed3-120">Dallo smart tag di DetailsView selezionare &lt;nuova origine dati&gt; dall'elenco a discesa e scegliere di aggiungere ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>

<span data-ttu-id="e4ed3-121">[![aggiungere ObjectDataSource alla pagina](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="e4ed3-122">**Figura 1**: aggiungere ObjectDataSource alla pagina ([fare clic per visualizzare l'immagine con dimensioni complete](declarative-parameters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="e4ed3-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>

<span data-ttu-id="e4ed3-123">Verrà avviata automaticamente la scelta guidata origine dati del controllo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="e4ed3-124">Selezionare la classe `ProductsBLL` dalla prima schermata della procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>

<span data-ttu-id="e4ed3-125">[![selezionare la classe ProductsBLL](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="e4ed3-126">**Figura 2**: selezionare la classe `ProductsBLL` ([fare clic per visualizzare l'immagine con dimensioni complete](declarative-parameters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e4ed3-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>

<span data-ttu-id="e4ed3-127">Poiché si desidera visualizzare informazioni su un prodotto specifico, è necessario utilizzare il metodo `GetProductByProductID(productID)`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>

<span data-ttu-id="e4ed3-128">[![scegliere il metodo GetProductByProductID (productID)](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="e4ed3-129">**Figura 3**: scegliere il metodo `GetProductByProductID(productID)` ([fare clic per visualizzare l'immagine con dimensioni complete](declarative-parameters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="e4ed3-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>

<span data-ttu-id="e4ed3-130">Poiché il metodo selezionato include un parametro, è disponibile un'altra schermata per la procedura guidata, in cui viene chiesto di definire il valore da usare per il parametro.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="e4ed3-131">L'elenco a sinistra Mostra tutti i parametri per il metodo selezionato.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="e4ed3-132">Per `GetProductByProductID(productID)` è presente una sola `productID`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="e4ed3-133">A destra è possibile specificare il valore per il parametro selezionato.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="e4ed3-134">Nell'elenco a discesa parametro source enumera le varie origini possibili per il valore del parametro.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="e4ed3-135">Poiché si desidera specificare un valore hardcoded di 5 per il parametro `productID`, lasciare l'origine del parametro come None e immettere 5 nella casella di testo DefaultValue.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>

<span data-ttu-id="e4ed3-136">[![un valore di parametro hardcoded pari a 5 verrà usato per il parametro productID](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="e4ed3-137">**Figura 4**: verrà usato un valore di parametro hardcoded di 5 per il parametro `productID` ([fare clic per visualizzare l'immagine con dimensioni complete](declarative-parameters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e4ed3-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>

<span data-ttu-id="e4ed3-138">Al termine della configurazione guidata origine dati, il markup dichiarativo del controllo ObjectDataSource include un oggetto `Parameter` nella raccolta `SelectParameters` per ognuno dei parametri di input previsti dal metodo definito nella proprietà `SelectMethod`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="e4ed3-139">Poiché il metodo usato in questo esempio prevede un solo parametro di input, `parameterID`, è presente una sola voce.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="e4ed3-140">La raccolta di `SelectParameters` può contenere qualsiasi classe derivata dalla classe `Parameter` nello spazio dei nomi `System.Web.UI.WebControls`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="e4ed3-141">Per i valori di parametro hardcoded viene utilizzata la classe di base `Parameter`, ma per le altre opzioni di origine parametro viene utilizzata una classe `Parameter` derivata. Se necessario, è anche possibile creare [tipi di parametro personalizzati](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11).</span><span class="sxs-lookup"><span data-stu-id="e4ed3-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="e4ed3-142">Se si sta seguendo il proprio computer, il markup dichiarativo visualizzato a questo punto può includere valori per le proprietà `InsertMethod`, `UpdateMethod`e `DeleteMethod`, nonché `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="e4ed3-143">La procedura guidata Scegli origine dati di ObjectDataSource specifica automaticamente i metodi della `ProductBLL` da usare per l'inserimento, l'aggiornamento e l'eliminazione, quindi, a meno che non vengano cancellati in modo esplicito, verranno inclusi nel markup precedente.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>

<span data-ttu-id="e4ed3-144">Quando si visita questa pagina, il controllo Web dei dati richiama il metodo di `Select` di ObjectDataSource, che chiamerà il metodo `GetProductByProductID(productID)` della classe `ProductsBLL` usando il valore hardcoded di 5 per il parametro di input `productID`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="e4ed3-145">Il metodo restituirà un oggetto `ProductDataTable` fortemente tipizzato che contiene una singola riga con informazioni sulla combinazione di gumbo di chef Anton (il prodotto con `ProductID` 5).</span><span class="sxs-lookup"><span data-stu-id="e4ed3-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>

<span data-ttu-id="e4ed3-146">[vengono visualizzate ![informazioni sulla combinazione di gumbo di chef Anton](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="e4ed3-147">**Figura 5**: sono visualizzate informazioni sulla combinazione di gumbo di chef Anton ([fare clic per visualizzare l'immagine con dimensioni complete](declarative-parameters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="e4ed3-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>

## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="e4ed3-148">Impostazione del valore del parametro sul valore della proprietà di un controllo Web</span><span class="sxs-lookup"><span data-stu-id="e4ed3-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="e4ed3-149">I valori dei parametri di ObjectDataSource possono essere impostati anche in base al valore di un controllo Web nella pagina.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="e4ed3-150">Per illustrare questa operazione, si disporrà di un controllo GridView in cui sono elencati tutti i fornitori che si trovano in un paese specificato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="e4ed3-151">A tale scopo, aggiungere una casella di testo alla pagina in cui l'utente può immettere un nome di paese.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="e4ed3-152">Impostare la proprietà `ID` del controllo TextBox su `CountryName`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="e4ed3-153">Aggiungere anche un controllo Web Button.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-153">Also add a Button Web control.</span></span>

<span data-ttu-id="e4ed3-154">[![aggiungere una casella di testo alla pagina con ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="e4ed3-155">**Figura 6**: aggiungere una casella di testo alla pagina con `ID` `CountryName` ([fare clic per visualizzare l'immagine con dimensioni complete](declarative-parameters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e4ed3-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>

<span data-ttu-id="e4ed3-156">Successivamente, aggiungere un controllo GridView alla pagina e, dallo smart tag, scegliere di aggiungere un nuovo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="e4ed3-157">Poiché si desidera visualizzare le informazioni sui fornitori, selezionare la classe `SuppliersBLL` dalla prima schermata della procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="e4ed3-158">Dalla seconda schermata, selezionare il metodo `GetSuppliersByCountry(country)`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>

<span data-ttu-id="e4ed3-159">[![scegliere il metodo GetSuppliersByCountry (Country)](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="e4ed3-160">**Figura 7**: scegliere il metodo `GetSuppliersByCountry(country)` ([fare clic per visualizzare l'immagine con dimensioni complete](declarative-parameters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="e4ed3-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>

<span data-ttu-id="e4ed3-161">Poiché il metodo `GetSuppliersByCountry(country)` dispone di un parametro di input, la procedura guidata include di nuovo una schermata finale per la scelta del valore del parametro.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="e4ed3-162">Questa volta, impostare l'origine del parametro su Control.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="e4ed3-163">Verrà popolato l'elenco a discesa ControlID con i nomi dei controlli nella pagina; Selezionare il controllo `CountryName` dall'elenco.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="e4ed3-164">Quando la pagina viene visitata per la prima volta, il `CountryName` casella di testo sarà vuota, pertanto non viene restituito alcun risultato e non viene visualizzato nulla.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="e4ed3-165">Se per impostazione predefinita si desidera visualizzare alcuni risultati, impostare la casella di testo DefaultValue di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>

<span data-ttu-id="e4ed3-166">[![impostare il valore del parametro sul valore del controllo CountryName](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="e4ed3-167">**Figura 8**: impostare il valore del parametro sul valore del controllo `CountryName` ([fare clic per visualizzare l'immagine con dimensioni complete](declarative-parameters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="e4ed3-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>

<span data-ttu-id="e4ed3-168">Il markup dichiarativo di ObjectDataSource è leggermente diverso dal primo esempio, usando un [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) anziché l'oggetto `Parameter` standard.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="e4ed3-169">Un `ControlParameter` dispone di proprietà aggiuntive per specificare la `ID` del controllo Web e il valore della proprietà da utilizzare per il parametro (`PropertyName`).</span><span class="sxs-lookup"><span data-stu-id="e4ed3-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="e4ed3-170">La configurazione guidata origine dati è stata sufficientemente intelligente da determinare che, per una casella di testo, è probabile che si desideri utilizzare la proprietà `Text` per il valore del parametro.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="e4ed3-171">Se tuttavia si vuole usare un valore di proprietà diverso dal controllo Web, è possibile modificare il valore di `PropertyName` qui o facendo clic sul collegamento "Mostra proprietà avanzate" nella procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="e4ed3-172">Quando si visita la pagina per la prima volta, il `CountryName` casella di testo è vuota.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="e4ed3-173">Il metodo `Select` di ObjectDataSource viene ancora richiamato da GridView, ma nel metodo `GetSuppliersByCountry(country)` viene passato un valore di `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="e4ed3-174">Il TableAdapter converte il `Nothing` in un valore di `NULL` del database (`DBNull.Value`), ma la query utilizzata dal metodo `GetSuppliersByCountry(country)` viene scritta in modo che non restituisca alcun valore quando viene specificato un valore `NULL` per il parametro `@CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="e4ed3-175">In breve, non viene restituito alcun fornitore.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="e4ed3-176">Quando il visitatore entra in un paese, tuttavia, fa clic sul pulsante Mostra fornitori per generare un postback, viene eseguita una query sul metodo `Select` di ObjectDataSource, passando il valore `Text` del controllo TextBox come parametro `country`.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>

<span data-ttu-id="e4ed3-177">[![vengono visualizzati i fornitori del Canada](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="e4ed3-178">**Figura 9**: vengono visualizzati i fornitori del Canada ([fare clic per visualizzare l'immagine con dimensioni complete](declarative-parameters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="e4ed3-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>

## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="e4ed3-179">Visualizzazione di tutti i fornitori per impostazione predefinita</span><span class="sxs-lookup"><span data-stu-id="e4ed3-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="e4ed3-180">Anziché visualizzare nessuno dei fornitori alla prima visualizzazione della pagina, potrebbe essere necessario mostrare *tutti* i fornitori inizialmente, consentendo all'utente di ridurre l'elenco immettendo un nome di paese nella casella di testo.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="e4ed3-181">Quando la casella di testo è vuota, il metodo di `GetSuppliersByCountry(country)` della classe `SuppliersBLL` viene passato in `Nothing` per il parametro di input *`country`* .</span><span class="sxs-lookup"><span data-stu-id="e4ed3-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="e4ed3-182">Questo valore `Nothing` viene quindi passato al metodo di `GetSupplierByCountry(country)` DAL, dove viene convertito in un valore di `NULL` di database per il parametro `@Country` nella query seguente:</span><span class="sxs-lookup"><span data-stu-id="e4ed3-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="e4ed3-183">L'espressione `Country = NULL` restituisce sempre false, anche per i record la cui colonna `Country` ha un valore `NULL`; Pertanto, non viene restituito alcun record.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="e4ed3-184">Per restituire *tutti* i fornitori quando la casella di testo Country è vuota, è possibile aumentare il metodo `GetSuppliersByCountry(country)` nell'oggetto BLL per richiamare il metodo `GetSuppliers()` quando il relativo parametro country è `Nothing` e chiamare il metodo di `GetSuppliersByCountry(country)` dal, in caso contrario.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="e4ed3-185">Questa operazione avrà come risultato la restituzione di tutti i fornitori quando non viene specificato alcun paese e il subset appropriato di fornitori quando il parametro Country è incluso.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="e4ed3-186">Modificare il metodo `GetSuppliersByCountry(country)` nella classe `SuppliersBLL` nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="e4ed3-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="e4ed3-187">Con questa modifica la pagina `DeclarativeParams.aspx` Mostra tutti i fornitori al momento della prima visita (o ogni volta che la casella di testo `CountryName` è vuota).</span><span class="sxs-lookup"><span data-stu-id="e4ed3-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>

<span data-ttu-id="e4ed3-188">[![tutti i fornitori sono ora visualizzati per impostazione predefinita](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="e4ed3-189">**Figura 10**: tutti i fornitori sono ora visualizzati per impostazione predefinita ([fare clic per visualizzare l'immagine con dimensioni complete](declarative-parameters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="e4ed3-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>

## <a name="summary"></a><span data-ttu-id="e4ed3-190">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="e4ed3-190">Summary</span></span>

<span data-ttu-id="e4ed3-191">Per usare i metodi con parametri di input, è necessario specificare i valori per i parametri nella raccolta `SelectParameters` di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="e4ed3-192">Tipi diversi di parametri consentono di ottenere il valore del parametro da origini diverse.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="e4ed3-193">Il tipo di parametro predefinito usa un valore hardcoded, ma è possibile ottenere i valori di parametro da QueryString, le variabili di sessione, i cookie e persino i valori immessi dall'utente dai controlli Web nella pagina.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="e4ed3-194">Gli esempi esaminati in questa esercitazione illustrano come usare i valori dei parametri dichiarativi.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="e4ed3-195">Tuttavia, in alcuni casi è necessario usare un'origine dei parametri non disponibile, ad esempio la data e l'ora correnti oppure, se il sito usa l'appartenenza, l'ID utente del visitatore.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="e4ed3-196">Per questi scenari è possibile impostare i valori dei parametri a livello di codice prima di ObjectDataSource richiamando il metodo dell'oggetto sottostante.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="e4ed3-197">Nell' [esercitazione successiva](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)verrà illustrato come eseguire questa operazione.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="e4ed3-198">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="e4ed3-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="e4ed3-199">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="e4ed3-199">About the Author</span></span>

<span data-ttu-id="e4ed3-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e4ed3-201">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e4ed3-202">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e4ed3-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e4ed3-203">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="e4ed3-204">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="e4ed3-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="e4ed3-205">Grazie speciale</span><span class="sxs-lookup"><span data-stu-id="e4ed3-205">Special Thanks To</span></span>

<span data-ttu-id="e4ed3-206">Questa serie di esercitazioni è stata esaminata da molti revisori utili.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e4ed3-207">Il revisore principale di questa esercitazione è stato Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="e4ed3-207">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="e4ed3-208">Sei interessato a esaminare i miei prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="e4ed3-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e4ed3-209">In tal caso, rilasciare una riga in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e4ed3-210">[Precedente](displaying-data-with-the-objectdatasource-vb.md)
> [Successivo](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="e4ed3-210">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>
