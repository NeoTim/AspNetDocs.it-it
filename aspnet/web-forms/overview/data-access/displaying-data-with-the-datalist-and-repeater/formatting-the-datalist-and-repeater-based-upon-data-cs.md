---
uid: web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs
title: Formattazione di DataList e Repeater in base ai datiC#() | Microsoft Docs
author: rick-anderson
description: In questa esercitazione verranno illustrati esempi di come formattare l'aspetto dei controlli DataList e Repeater usando le funzioni di formattazione con...
ms.author: riande
ms.date: 09/13/2006
ms.assetid: 83e3d759-82b8-41e6-8d62-f0f4b3edec41
msc.legacyurl: /web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs
msc.type: authoredcontent
ms.openlocfilehash: 68de3450ed97fc7bd0efb27e089d9db8e3e85fb0
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78611636"
---
# <a name="formatting-the-datalist-and-repeater-based-upon-data-c"></a><span data-ttu-id="3bd31-103">Formattazione di DataList e Repeater in base ai dati (C#)</span><span class="sxs-lookup"><span data-stu-id="3bd31-103">Formatting the DataList and Repeater Based Upon Data (C#)</span></span>

<span data-ttu-id="3bd31-104">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3bd31-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3bd31-105">[Scaricare l'app di esempio](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_CS.exe) o [scaricare il file PDF](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/datatutorial30cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="3bd31-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_CS.exe) or [Download PDF](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/datatutorial30cs1.pdf)</span></span>

> <span data-ttu-id="3bd31-106">In questa esercitazione verranno illustrati alcuni esempi di come si formatta l'aspetto dei controlli DataList e Repeater, usando le funzioni di formattazione all'interno dei modelli o gestendo l'evento associato ai DataBinding.</span><span class="sxs-lookup"><span data-stu-id="3bd31-106">In this tutorial we'll step through examples of how we format the appearance of the DataList and Repeater controls, either by using formatting functions within templates or by handling the DataBound event.</span></span>

## <a name="introduction"></a><span data-ttu-id="3bd31-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="3bd31-107">Introduction</span></span>

<span data-ttu-id="3bd31-108">Come illustrato nell'esercitazione precedente, DataList offre una serie di proprietà correlate allo stile che incidono sull'aspetto.</span><span class="sxs-lookup"><span data-stu-id="3bd31-108">As we saw in the preceding tutorial, the DataList offers a number of style-related properties that affect its appearance.</span></span> <span data-ttu-id="3bd31-109">In particolare, si è visto come assegnare classi CSS predefinite alle proprietà `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`e `SelectedItemStyle` di DataList.</span><span class="sxs-lookup"><span data-stu-id="3bd31-109">In particular, we saw how to assign default CSS classes to the DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, and `SelectedItemStyle` properties.</span></span> <span data-ttu-id="3bd31-110">Oltre a queste quattro proprietà, DataList include un numero di altre proprietà correlate allo stile, ad esempio `Font`, `ForeColor`, `BackColor`e `BorderWidth`, per citarne alcune.</span><span class="sxs-lookup"><span data-stu-id="3bd31-110">In addition to these four properties, the DataList includes a number of other style-related properties, such as `Font`, `ForeColor`, `BackColor`, and `BorderWidth`, to name a few.</span></span> <span data-ttu-id="3bd31-111">Il controllo Repeater non contiene proprietà correlate allo stile.</span><span class="sxs-lookup"><span data-stu-id="3bd31-111">The Repeater control does not contain any style-related properties.</span></span> <span data-ttu-id="3bd31-112">Le impostazioni di stile devono essere apportate direttamente all'interno del markup nei modelli del ripetitore.</span><span class="sxs-lookup"><span data-stu-id="3bd31-112">Any such style settings must be made directly within the markup in the Repeater s templates.</span></span>

<span data-ttu-id="3bd31-113">Spesso, tuttavia, le modalità di formattazione dei dati variano in base ai dati stessi.</span><span class="sxs-lookup"><span data-stu-id="3bd31-113">Often, though, how data should be formatted depends on the data itself.</span></span> <span data-ttu-id="3bd31-114">Ad esempio, quando si elencano i prodotti, potrebbe essere necessario visualizzare le informazioni sul prodotto in un colore grigio chiaro se non è più disponibile o se si desidera evidenziare il valore `UnitsInStock` se è zero.</span><span class="sxs-lookup"><span data-stu-id="3bd31-114">For example, when listing products we might want to display the product information in a light gray font color if it is discontinued, or we may want to highlight the `UnitsInStock` value if it is zero.</span></span> <span data-ttu-id="3bd31-115">Come illustrato nelle esercitazioni precedenti, GridView, DetailsView e FormView offrono due modi distinti per formattare l'aspetto in base ai dati:</span><span class="sxs-lookup"><span data-stu-id="3bd31-115">As we saw in previous tutorials, the GridView, DetailsView, and FormView offer two distinct ways to format their appearance based on their data:</span></span>

- <span data-ttu-id="3bd31-116">**L'evento `DataBound`** creare un gestore eventi per l'evento `DataBound` appropriato, che viene attivato dopo che i dati sono stati associati a ogni elemento (per GridView era l'evento `RowDataBound`; per DataList e Repeater è l'evento `ItemDataBound`).</span><span class="sxs-lookup"><span data-stu-id="3bd31-116">**The `DataBound` event** create an event handler for the appropriate `DataBound` event, which fires after the data has been bound to each item (for the GridView it was the `RowDataBound` event; for the DataList and Repeater it is the `ItemDataBound` event).</span></span> <span data-ttu-id="3bd31-117">In tale gestore eventi, i dati appena associati possono essere esaminati e formattare le decisioni prese.</span><span class="sxs-lookup"><span data-stu-id="3bd31-117">In that event handler, the data just bound can be examined and formatting decisions made.</span></span> <span data-ttu-id="3bd31-118">Questa tecnica è stata esaminata nella [formattazione personalizzata basata sull'](../custom-formatting/custom-formatting-based-upon-data-cs.md) esercitazione sui dati.</span><span class="sxs-lookup"><span data-stu-id="3bd31-118">We examined this technique in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-cs.md) tutorial.</span></span>
- <span data-ttu-id="3bd31-119">**Formattazione di funzioni nei modelli** quando si usa TemplateFields nei controlli DetailsView o GridView oppure un modello nel controllo FormView, è possibile aggiungere una funzione di formattazione alla classe code-behind della pagina ASP.NET, al livello della logica di business o a qualsiasi altra libreria di classi accessibile dall'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="3bd31-119">**Formatting Functions in Templates** when using TemplateFields in the DetailsView or GridView controls, or a template in the FormView control, we can add a formatting function to the ASP.NET page s code-behind class, the Business Logic Layer, or any other class library that is accessible from the web application.</span></span> <span data-ttu-id="3bd31-120">Questa funzione di formattazione può accettare un numero arbitrario di parametri di input, ma deve restituire il codice HTML di cui eseguire il rendering nel modello.</span><span class="sxs-lookup"><span data-stu-id="3bd31-120">This formatting function can accept an arbitrary number of input parameters, but must return the HTML to render in the template.</span></span> <span data-ttu-id="3bd31-121">Le funzioni di formattazione sono state esaminate per la prima volta nell'esercitazione sull' [uso di TemplateFields nel controllo GridView](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="3bd31-121">Formatting functions were first examined in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) tutorial.</span></span>

<span data-ttu-id="3bd31-122">Entrambe queste tecniche di formattazione sono disponibili con i controlli DataList e Repeater.</span><span class="sxs-lookup"><span data-stu-id="3bd31-122">Both of these formatting techniques are available with the DataList and Repeater controls.</span></span> <span data-ttu-id="3bd31-123">In questa esercitazione verranno illustrati esempi che usano entrambe le tecniche per entrambi i controlli.</span><span class="sxs-lookup"><span data-stu-id="3bd31-123">In this tutorial we'll step through examples using both techniques for both controls.</span></span>

## <a name="using-theitemdataboundevent-handler"></a><span data-ttu-id="3bd31-124">Uso del gestore dell'evento`ItemDataBound`</span><span class="sxs-lookup"><span data-stu-id="3bd31-124">Using the`ItemDataBound`Event Handler</span></span>

<span data-ttu-id="3bd31-125">Quando i dati vengono associati a un oggetto DataList, da un controllo origine dati o mediante l'assegnazione di dati a livello di codice al `DataSource` proprietà del controllo e alla chiamata del relativo metodo `DataBind()`, l'evento DataList s `DataBinding` generato, l'origine dati enumerata e ogni record di dati viene associato a DataList.</span><span class="sxs-lookup"><span data-stu-id="3bd31-125">When data is bound to a DataList, either from a data source control or through programmatically assigning data to the control s `DataSource` property and calling its `DataBind()` method, the DataList s `DataBinding` event fires, the data source enumerated, and each data record is bound to the DataList.</span></span> <span data-ttu-id="3bd31-126">Per ogni record nell'origine dati, DataList crea un oggetto [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) che viene quindi associato al record corrente.</span><span class="sxs-lookup"><span data-stu-id="3bd31-126">For each record in the data source, the DataList creates a [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) object that is then bound to the current record.</span></span> <span data-ttu-id="3bd31-127">Durante questo processo, DataList genera due eventi:</span><span class="sxs-lookup"><span data-stu-id="3bd31-127">During this process, the DataList raises two events:</span></span>

- <span data-ttu-id="3bd31-128">**`ItemCreated`** viene attivato dopo la creazione della `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="3bd31-128">**`ItemCreated`** fires after the `DataListItem` has been created</span></span>
- <span data-ttu-id="3bd31-129">**`ItemDataBound`** viene attivato dopo che il record corrente è stato associato al `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="3bd31-129">**`ItemDataBound`** fires after the current record has been bound to the `DataListItem`</span></span>

<span data-ttu-id="3bd31-130">La procedura seguente illustra il processo di data binding per il controllo DataList.</span><span class="sxs-lookup"><span data-stu-id="3bd31-130">The following steps outline the data binding process for the DataList control.</span></span>

1. <span data-ttu-id="3bd31-131">Viene generato l' [evento](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) DataList s`DataBinding`</span><span class="sxs-lookup"><span data-stu-id="3bd31-131">The DataList s [`DataBinding` event](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) fires</span></span>
2. <span data-ttu-id="3bd31-132">I dati sono associati a DataList</span><span class="sxs-lookup"><span data-stu-id="3bd31-132">The data is bound to the DataList</span></span>  
  
   <span data-ttu-id="3bd31-133">Per ogni record nell'origine dati</span><span class="sxs-lookup"><span data-stu-id="3bd31-133">For each record in the data source</span></span> 

    1. <span data-ttu-id="3bd31-134">Creare un oggetto `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="3bd31-134">Create a `DataListItem` object</span></span>
    2. <span data-ttu-id="3bd31-135">Generare l' [evento`ItemCreated`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span><span class="sxs-lookup"><span data-stu-id="3bd31-135">Fire the [`ItemCreated` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span></span>
    3. <span data-ttu-id="3bd31-136">Associare il record al `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="3bd31-136">Bind the record to the `DataListItem`</span></span>
    4. <span data-ttu-id="3bd31-137">Generare l' [evento`ItemDataBound`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span><span class="sxs-lookup"><span data-stu-id="3bd31-137">Fire the [`ItemDataBound` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span></span>
    5. <span data-ttu-id="3bd31-138">Aggiungere la `DataListItem` alla raccolta `Items`</span><span class="sxs-lookup"><span data-stu-id="3bd31-138">Add the `DataListItem` to the `Items` collection</span></span>

<span data-ttu-id="3bd31-139">Quando si associano i dati al controllo Repeater, il processo passa attraverso la stessa sequenza di passaggi.</span><span class="sxs-lookup"><span data-stu-id="3bd31-139">When binding data to the Repeater control, it progresses through the exact same sequence of steps.</span></span> <span data-ttu-id="3bd31-140">L'unica differenza consiste nel fatto che anziché `DataListItem` istanze create, il ripetitore utilizza [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span><span class="sxs-lookup"><span data-stu-id="3bd31-140">The only difference is that instead of `DataListItem` instances being created, the Repeater uses [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span></span>

> [!NOTE]
> <span data-ttu-id="3bd31-141">Il lettore astuto potrebbe avere notato una lieve anomalia tra la sequenza di passaggi che traspare quando DataList e Repeater sono associati ai dati rispetto al momento in cui GridView è associato ai dati.</span><span class="sxs-lookup"><span data-stu-id="3bd31-141">The astute reader may have noticed a slight anomaly between the sequence of steps that transpire when the DataList and Repeater are bound to data versus when the GridView is bound to data.</span></span> <span data-ttu-id="3bd31-142">Nella parte finale della data binding processo, GridView genera l'evento `DataBound`; Tuttavia, il controllo DataList o Repeater non ha un evento di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="3bd31-142">At the tail end of the data binding process, the GridView raises the `DataBound` event; however, neither the DataList nor Repeater control have such an event.</span></span> <span data-ttu-id="3bd31-143">Ciò è dovuto al fatto che i controlli DataList e Repeater sono stati creati nell'intervallo di tempo ASP.NET 1. x, prima che il modello di gestore eventi pre-e post-level fosse diventato comune.</span><span class="sxs-lookup"><span data-stu-id="3bd31-143">This is because the DataList and Repeater controls were created back in the ASP.NET 1.x timeframe, before the pre- and post-level event handler pattern had become common.</span></span>

<span data-ttu-id="3bd31-144">Analogamente a GridView, un'opzione per la formattazione basata sui dati consiste nel creare un gestore eventi per l'evento `ItemDataBound`.</span><span class="sxs-lookup"><span data-stu-id="3bd31-144">Like with the GridView, one option for formatting based on the data is to create an event handler for the `ItemDataBound` event.</span></span> <span data-ttu-id="3bd31-145">Questo gestore eventi controlla i dati appena associati al `DataListItem` o `RepeaterItem` e influisce sulla formattazione del controllo in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="3bd31-145">This event handler would inspect the data that had just been bound to the `DataListItem` or `RepeaterItem` and affect the formatting of the control as needed.</span></span>

<span data-ttu-id="3bd31-146">Per il controllo DataList, le modifiche di formattazione per l'intero elemento possono essere implementate usando le proprietà correlate allo stile `DataListItem` s, che includono `Font`standard, `ForeColor`, `BackColor`, `CssClass`e così via.</span><span class="sxs-lookup"><span data-stu-id="3bd31-146">For the DataList control, formatting changes for the entire item can be implemented using the `DataListItem` s style-related properties, which include the standard `Font`, `ForeColor`, `BackColor`, `CssClass`, and so on.</span></span> <span data-ttu-id="3bd31-147">Per influenzare la formattazione di particolari controlli Web all'interno del modello di DataList, è necessario accedere a livello di codice e modificare lo stile dei controlli Web.</span><span class="sxs-lookup"><span data-stu-id="3bd31-147">To affect the formatting of particular Web controls within the DataList s template, we need to programmatically access and modify the style of those Web controls.</span></span> <span data-ttu-id="3bd31-148">È stato illustrato come eseguire questa operazione nella *formattazione personalizzata basata sull'* esercitazione sui dati.</span><span class="sxs-lookup"><span data-stu-id="3bd31-148">We saw how to accomplish this back in the *Custom Formatting Based Upon Data* tutorial.</span></span> <span data-ttu-id="3bd31-149">Analogamente al controllo Repeater, la classe `RepeaterItem` non dispone di proprietà correlate allo stile. Pertanto, tutte le modifiche correlate allo stile apportate a un `RepeaterItem` nel gestore dell'evento `ItemDataBound` devono essere eseguite a livello di codice e per l'aggiornamento dei controlli Web all'interno del modello.</span><span class="sxs-lookup"><span data-stu-id="3bd31-149">Like the Repeater control, the `RepeaterItem` class has no style-related properties; therefore, all style-related changes made to a `RepeaterItem` in the `ItemDataBound` event handler must be done by programmatically accessing and updating Web controls within the template.</span></span>

<span data-ttu-id="3bd31-150">Poiché la tecnica di formattazione `ItemDataBound` per DataList e Repeater sono praticamente identiche, l'esempio si focalizzerà sull'uso di DataList.</span><span class="sxs-lookup"><span data-stu-id="3bd31-150">Since the `ItemDataBound` formatting technique for the DataList and Repeater are virtually identical, our example will focus on using the DataList.</span></span>

## <a name="step-1-displaying-product-information-in-the-datalist"></a><span data-ttu-id="3bd31-151">Passaggio 1: visualizzazione delle informazioni sul prodotto in DataList</span><span class="sxs-lookup"><span data-stu-id="3bd31-151">Step 1: Displaying Product Information in the DataList</span></span>

<span data-ttu-id="3bd31-152">Prima di preoccuparsi della formattazione, creare prima di tutto una pagina che utilizza un DataList per visualizzare le informazioni sul prodotto.</span><span class="sxs-lookup"><span data-stu-id="3bd31-152">Before we worry about the formatting, let s first create a page that uses a DataList to display product information.</span></span> <span data-ttu-id="3bd31-153">Nell' [esercitazione precedente](displaying-data-with-the-datalist-and-repeater-controls-cs.md) è stato creato un DataList i cui `ItemTemplate` visualizzavano ogni nome di prodotto, categoria, fornitore, quantità per unità e prezzo.</span><span class="sxs-lookup"><span data-stu-id="3bd31-153">In the [previous tutorial](displaying-data-with-the-datalist-and-repeater-controls-cs.md) we created a DataList whose `ItemTemplate` displayed each product s name, category, supplier, quantity per unit, and price.</span></span> <span data-ttu-id="3bd31-154">Questa funzionalità verrà ripetuta in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="3bd31-154">Let s repeat this functionality here in this tutorial.</span></span> <span data-ttu-id="3bd31-155">A tale scopo, è possibile ricreare il DataList e il relativo ObjectDataSource da zero oppure è possibile copiare i controlli dalla pagina creata nell'esercitazione precedente (`Basics.aspx`) e incollarli nella pagina per questa esercitazione (`Formatting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="3bd31-155">To accomplish this, you can either recreate the DataList and its ObjectDataSource from scratch, or you can copy over those controls from the page created in the previous tutorial (`Basics.aspx`) and paste them into the page for this tutorial (`Formatting.aspx`).</span></span>

<span data-ttu-id="3bd31-156">Una volta replicate le funzionalità DataList e ObjectDataSource da `Basics.aspx` in `Formatting.aspx`, è necessario modificare la proprietà `ID` di DataList da `DataList1` a una `ItemDataBoundFormattingExample`più descrittiva.</span><span class="sxs-lookup"><span data-stu-id="3bd31-156">Once you have replicated the DataList and ObjectDataSource functionality from `Basics.aspx` into `Formatting.aspx`, take a moment to change the DataList s `ID` property from `DataList1` to a more descriptive `ItemDataBoundFormattingExample`.</span></span> <span data-ttu-id="3bd31-157">Successivamente, visualizzare il DataList in un browser.</span><span class="sxs-lookup"><span data-stu-id="3bd31-157">Next, view the DataList in a browser.</span></span> <span data-ttu-id="3bd31-158">Come illustrato nella figura 1, l'unica differenza di formattazione tra ogni prodotto è che il colore di sfondo viene alternato.</span><span class="sxs-lookup"><span data-stu-id="3bd31-158">As Figure 1 shows, the only formatting difference between each product is that the background color alternates.</span></span>

<span data-ttu-id="3bd31-159">[![i prodotti sono elencati nel controllo DataList](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3bd31-159">[![The Products are Listed in the DataList Control](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image1.png)</span></span>

<span data-ttu-id="3bd31-160">**Figura 1**: i prodotti sono elencati nel controllo DataList ([fare clic per visualizzare l'immagine con dimensioni complete](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="3bd31-160">**Figure 1**: The Products are Listed in the DataList Control ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image3.png))</span></span>

<span data-ttu-id="3bd31-161">Per questa esercitazione, è possibile formattare il DataList in modo che tutti i prodotti con un prezzo inferiore a $20,00 abbiano il nome e il prezzo unitario evidenziato come giallo.</span><span class="sxs-lookup"><span data-stu-id="3bd31-161">For this tutorial, let s format the DataList such that any products with a price less than $20.00 will have both its name and unit price highlighted yellow.</span></span>

## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-itemdatabound-event-handler"></a><span data-ttu-id="3bd31-162">Passaggio 2: determinazione del valore dei dati nel gestore eventi ItemDataBound a livello di codice</span><span class="sxs-lookup"><span data-stu-id="3bd31-162">Step 2: Programmatically Determining the Value of the Data in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="3bd31-163">Poiché solo i prodotti con un prezzo inferiore a $20,00 avranno applicato la formattazione personalizzata, è necessario essere in grado di determinare il prezzo di ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="3bd31-163">Since only those products with a price under $20.00 will have the custom formatting applied, we must be able to determine each product s price.</span></span> <span data-ttu-id="3bd31-164">Quando si associano dati a un DataList, DataList enumera i record nell'origine dati e, per ogni record, crea un'istanza di `DataListItem`, associando il record dell'origine dati al `DataListItem`.</span><span class="sxs-lookup"><span data-stu-id="3bd31-164">When binding data to a DataList, the DataList enumerates the records in its data source and, for each record, creates a `DataListItem` instance, binding the data source record to the `DataListItem`.</span></span> <span data-ttu-id="3bd31-165">Dopo che i dati dei record specifici sono stati associati all'oggetto `DataListItem` corrente, viene generato l'evento `ItemDataBound` di DataList.</span><span class="sxs-lookup"><span data-stu-id="3bd31-165">After the particular record s data has been bound to the current `DataListItem` object, the DataList s `ItemDataBound` event is fired.</span></span> <span data-ttu-id="3bd31-166">È possibile creare un gestore eventi per questo evento per controllare i valori dei dati per la `DataListItem` corrente e, in base a tali valori, apportare le modifiche di formattazione necessarie.</span><span class="sxs-lookup"><span data-stu-id="3bd31-166">We can create an event handler for this event to inspect the data values for the current `DataListItem` and, based upon those values, make any formatting changes necessary.</span></span>

<span data-ttu-id="3bd31-167">Creare un evento `ItemDataBound` per DataList e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="3bd31-167">Create an `ItemDataBound` event for the DataList and add the following code:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample1.cs)]

<span data-ttu-id="3bd31-168">Sebbene il concetto e la semantica dietro il gestore dell'evento DataList s `ItemDataBound` siano identici a quelli utilizzati dal gestore dell'evento GridView s `RowDataBound` nella *formattazione personalizzata basata sull'* esercitazione sui dati, la sintassi è leggermente diversa.</span><span class="sxs-lookup"><span data-stu-id="3bd31-168">While the concept and semantics behind the DataList s `ItemDataBound` event handler are the same as those used by the GridView s `RowDataBound` event handler in the *Custom Formatting Based Upon Data* tutorial, the syntax differs slightly.</span></span> <span data-ttu-id="3bd31-169">Quando viene generato l'evento `ItemDataBound`, il `DataListItem` appena associato ai dati viene passato al gestore eventi corrispondente tramite `e.Item` (anziché `e.Row`, come nel gestore dell'evento GridView s `RowDataBound`).</span><span class="sxs-lookup"><span data-stu-id="3bd31-169">When the `ItemDataBound` event fires, the `DataListItem` just bound to data is passed into corresponding event handler via `e.Item` (instead of `e.Row`, as with the GridView s `RowDataBound` event handler).</span></span> <span data-ttu-id="3bd31-170">Il gestore dell'evento DataList s `ItemDataBound` viene attivato per *ogni* riga aggiunta a DataList, incluse le righe di intestazione, le righe del piè di pagina e le righe di separazione.</span><span class="sxs-lookup"><span data-stu-id="3bd31-170">The DataList s `ItemDataBound` event handler fires for *each* row added to the DataList, including header rows, footer rows, and separator rows.</span></span> <span data-ttu-id="3bd31-171">Tuttavia, le informazioni sul prodotto sono limitate solo alle righe di dati.</span><span class="sxs-lookup"><span data-stu-id="3bd31-171">However, the product information is only bound to the data rows.</span></span> <span data-ttu-id="3bd31-172">Pertanto, quando si utilizza l'evento `ItemDataBound` per controllare i dati associati a DataList, è necessario prima di tutto verificare che venga utilizzato un elemento di dati.</span><span class="sxs-lookup"><span data-stu-id="3bd31-172">Therefore, when using the `ItemDataBound` event to inspect the data bound to the DataList, we need to first ensure that we re working with a data item.</span></span> <span data-ttu-id="3bd31-173">Questa operazione può essere eseguita selezionando la proprietà `DataListItem` s [`ItemType`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), che può avere uno degli [otto valori seguenti](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span><span class="sxs-lookup"><span data-stu-id="3bd31-173">This can be accomplished by checking the `DataListItem` s [`ItemType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), which can have one of [the following eight values](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span></span>

- `AlternatingItem`
- `EditItem`
- `Footer`
- `Header`
- `Item`
- `Pager`
- `SelectedItem`
- `Separator`

<span data-ttu-id="3bd31-174">Sia `Item` che `AlternatingItem``DataListItem` s comprimano gli elementi di dati di DataList.</span><span class="sxs-lookup"><span data-stu-id="3bd31-174">Both `Item` and `AlternatingItem``DataListItem` s makeup the DataList s data items.</span></span> <span data-ttu-id="3bd31-175">Supponendo di riutilizzare un `Item` o `AlternatingItem`, si accede all'istanza di `ProductsRow` effettiva associata al `DataListItem`corrente.</span><span class="sxs-lookup"><span data-stu-id="3bd31-175">Assuming we re working with an `Item` or `AlternatingItem`, we access the actual `ProductsRow` instance that was bound to the current `DataListItem`.</span></span> <span data-ttu-id="3bd31-176">La [proprietà`DataItem`](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) `DataListItem` s contiene un riferimento all'oggetto `DataRowView`, la cui proprietà `Row` fornisce un riferimento all'oggetto `ProductsRow` effettivo.</span><span class="sxs-lookup"><span data-stu-id="3bd31-176">The `DataListItem` s [`DataItem` property](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) contains a reference to the `DataRowView` object, whose `Row` property provides a reference to the actual `ProductsRow` object.</span></span>

<span data-ttu-id="3bd31-177">Successivamente, si controlla la proprietà `UnitPrice` dell'istanza di `ProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="3bd31-177">Next, we check the `ProductsRow` instance s `UnitPrice` property.</span></span> <span data-ttu-id="3bd31-178">Poiché il campo `UnitPrice` della tabella Products consente `NULL` valori, prima di tentare di accedere alla proprietà `UnitPrice`, è necessario verificare prima di tutto se è presente un valore `NULL` usando il metodo `IsUnitPriceNull()`.</span><span class="sxs-lookup"><span data-stu-id="3bd31-178">Since the Products table s `UnitPrice` field allows `NULL` values, before attempting to access the `UnitPrice` property we should first check to see if it has a `NULL` value using the `IsUnitPriceNull()` method.</span></span> <span data-ttu-id="3bd31-179">Se il valore `UnitPrice` non è `NULL`, si verificherà se è minore di $20,00.</span><span class="sxs-lookup"><span data-stu-id="3bd31-179">If the `UnitPrice` value is not `NULL`, we then check to see if it s less than $20.00.</span></span> <span data-ttu-id="3bd31-180">Se è effettivamente inferiore a $20,00, è necessario applicare la formattazione personalizzata.</span><span class="sxs-lookup"><span data-stu-id="3bd31-180">If it is indeed under $20.00, we then need to apply the custom formatting.</span></span>

## <a name="step-3-highlighting-the-product-s-name-and-price"></a><span data-ttu-id="3bd31-181">Passaggio 3: evidenziazione del nome e del prezzo del prodotto</span><span class="sxs-lookup"><span data-stu-id="3bd31-181">Step 3: Highlighting the Product s Name and Price</span></span>

<span data-ttu-id="3bd31-182">Quando si sa che il prezzo di un prodotto è inferiore a $20,00, rimane solo per evidenziare il nome e il prezzo.</span><span class="sxs-lookup"><span data-stu-id="3bd31-182">Once we know that a product s price is less than $20.00, all that remains is to highlight its name and price.</span></span> <span data-ttu-id="3bd31-183">A tale scopo, è innanzitutto necessario fare riferimento a livello di codice ai controlli Label nell'`ItemTemplate` che visualizzano il nome e il prezzo del prodotto.</span><span class="sxs-lookup"><span data-stu-id="3bd31-183">To accomplish this, we must first programmatically reference the Label controls in the `ItemTemplate` that display the product s name and price.</span></span> <span data-ttu-id="3bd31-184">Successivamente, è necessario che vengano visualizzati uno sfondo giallo.</span><span class="sxs-lookup"><span data-stu-id="3bd31-184">Next, we need to have them display a yellow background.</span></span> <span data-ttu-id="3bd31-185">Queste informazioni di formattazione possono essere applicate modificando direttamente le etichette `BackColor` proprietà (`LabelID.BackColor = Color.Yellow`); Idealmente, tuttavia, tutte le questioni correlate alla visualizzazione devono essere espresse tramite fogli di stile a cascata.</span><span class="sxs-lookup"><span data-stu-id="3bd31-185">This formatting information can be applied by directly modifying the Labels `BackColor` properties (`LabelID.BackColor = Color.Yellow`); ideally, though, all display-related matters should be expressed through cascading stylesheets.</span></span> <span data-ttu-id="3bd31-186">Infatti, è già disponibile un foglio di stile che fornisce la formattazione desiderata definita in `Styles.css` - `AffordablePriceEmphasis`, che è stata creata e discussa nell'esercitazione *sulla formattazione personalizzata basata sui dati* .</span><span class="sxs-lookup"><span data-stu-id="3bd31-186">In fact, we already have a stylesheet that provides the desired formatting defined in `Styles.css` - `AffordablePriceEmphasis`, which was created and discussed in the *Custom Formatting Based Upon Data* tutorial.</span></span>

<span data-ttu-id="3bd31-187">Per applicare la formattazione, è sufficiente impostare i due controlli Web etichetta `CssClass` proprietà su `AffordablePriceEmphasis`, come illustrato nel codice seguente:</span><span class="sxs-lookup"><span data-stu-id="3bd31-187">To apply the formatting, simply set the two Label Web controls `CssClass` properties to `AffordablePriceEmphasis`, as shown in the following code:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample2.cs)]

<span data-ttu-id="3bd31-188">Con il gestore dell'evento `ItemDataBound` completato, rivedere la pagina `Formatting.aspx` in un browser.</span><span class="sxs-lookup"><span data-stu-id="3bd31-188">With the `ItemDataBound` event handler completed, revisit the `Formatting.aspx` page in a browser.</span></span> <span data-ttu-id="3bd31-189">Come illustrato nella figura 2, i prodotti con un prezzo inferiore a $20,00 presentano il nome e il prezzo evidenziati.</span><span class="sxs-lookup"><span data-stu-id="3bd31-189">As Figure 2 illustrates, those products with a price under $20.00 have both their name and price highlighted.</span></span>

<span data-ttu-id="3bd31-190">[vengono evidenziati ![i prodotti minori di $20,00](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3bd31-190">[![Those Products Less than $20.00 are Highlighted](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image4.png)</span></span>

<span data-ttu-id="3bd31-191">**Figura 2**: i prodotti minori di $20,00 sono evidenziati ([fare clic per visualizzare l'immagine con dimensioni complete](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="3bd31-191">**Figure 2**: Those Products Less than $20.00 are Highlighted ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="3bd31-192">Poiché viene eseguito il rendering di DataList come `<table>`HTML, le relative istanze `DataListItem` hanno proprietà correlate allo stile che possono essere impostate per applicare uno stile specifico all'intero elemento.</span><span class="sxs-lookup"><span data-stu-id="3bd31-192">Since the DataList is rendered as an HTML `<table>`, its `DataListItem` instances have style-related properties that can be set to apply a specific style to the entire item.</span></span> <span data-ttu-id="3bd31-193">Se ad esempio si desidera evidenziare l' *intero* elemento in giallo quando il prezzo è inferiore a $20,00, è possibile che sia stato sostituito il codice che fa riferimento alle etichette e impostare le relative proprietà `CssClass` con la seguente riga di codice: `e.Item.CssClass = "AffordablePriceEmphasis"` (vedere la figura 3).</span><span class="sxs-lookup"><span data-stu-id="3bd31-193">For example, if we wanted to highlight the *entire* item yellow when its price was less than $20.00, we could have replaced the code that referenced the Labels and set their `CssClass` properties with the following line of code: `e.Item.CssClass = "AffordablePriceEmphasis"` (see Figure 3).</span></span>

<span data-ttu-id="3bd31-194">Le `RepeaterItem` che compongono il controllo Repeater, tuttavia, non offrono tali proprietà a livello di stile.</span><span class="sxs-lookup"><span data-stu-id="3bd31-194">The `RepeaterItem` s that make up the Repeater control, however, don t offer such style-level properties.</span></span> <span data-ttu-id="3bd31-195">Pertanto, applicando la formattazione personalizzata al Repeater è necessario che l'applicazione delle proprietà di stile ai controlli Web all'interno dei modelli del Repeater sia analoga a quanto illustrato nella figura 2.</span><span class="sxs-lookup"><span data-stu-id="3bd31-195">Therefore, applying custom formatting to the Repeater requires the application of style properties to the Web controls within the Repeater s templates, just like we did in Figure 2.</span></span>

<span data-ttu-id="3bd31-196">[![l'intero elemento del prodotto è evidenziato per i prodotti in $20,00](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="3bd31-196">[![The Entire Product Item is Highlighted for Products Under $20.00](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image7.png)</span></span>

<span data-ttu-id="3bd31-197">**Figura 3**: l'intero elemento del prodotto è evidenziato per i prodotti in $20,00 ([fare clic per visualizzare l'immagine con dimensioni complete](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="3bd31-197">**Figure 3**: The Entire Product Item is Highlighted for Products Under $20.00 ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image9.png))</span></span>

## <a name="using-formatting-functions-from-within-the-template"></a><span data-ttu-id="3bd31-198">Uso delle funzioni di formattazione dall'interno del modello</span><span class="sxs-lookup"><span data-stu-id="3bd31-198">Using Formatting Functions from Within the Template</span></span>

<span data-ttu-id="3bd31-199">Nell'esercitazione sull'uso *di TemplateFields nel controllo GridView* è stato illustrato come usare una funzione di formattazione all'interno di un TemplateField GridView per applicare la formattazione personalizzata in base ai dati associati alle righe di GridView.</span><span class="sxs-lookup"><span data-stu-id="3bd31-199">In the *Using TemplateFields in the GridView Control* tutorial we saw how to use a formatting function within a GridView TemplateField to apply custom formatting based upon the data bound to the GridView s rows.</span></span> <span data-ttu-id="3bd31-200">Una funzione di formattazione è un metodo che può essere richiamato da un modello e restituisce il codice HTML da emettere al suo posto.</span><span class="sxs-lookup"><span data-stu-id="3bd31-200">A formatting function is a method that can be invoked from a template and returns the HTML to be emitted in its place.</span></span> <span data-ttu-id="3bd31-201">Le funzioni di formattazione possono risiedere nella classe code-behind della pagina ASP.NET oppure possono essere centralizzate in file di classe nella cartella `App_Code` o in un progetto di libreria di classi separato.</span><span class="sxs-lookup"><span data-stu-id="3bd31-201">Formatting functions can reside in the ASP.NET page s code-behind class or can be centralized into class files in the `App_Code` folder or in a separate Class Library project.</span></span> <span data-ttu-id="3bd31-202">Lo scarto della funzione di formattazione fuori dalla classe code-behind della pagina ASP.NET è ideale se si prevede di usare la stessa funzione di formattazione in più pagine ASP.NET o in altre applicazioni Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="3bd31-202">Moving the formatting function out of the ASP.NET page s code-behind class is ideal if you plan on using the same formatting function in multiple ASP.NET pages or in other ASP.NET web applications.</span></span>

<span data-ttu-id="3bd31-203">Per illustrare le funzioni di formattazione, fare in modo che le informazioni sul prodotto includano il testo [sospeso] accanto al nome del prodotto, se non è più disponibile.</span><span class="sxs-lookup"><span data-stu-id="3bd31-203">To demonstrate formatting functions, let s have the product information include the text [DISCONTINUED] next to the product s name if it s discontinued.</span></span> <span data-ttu-id="3bd31-204">Inoltre, il prezzo viene evidenziato in giallo se è minore di $20,00 (come è stato fatto nell'esempio `ItemDataBound` gestore eventi); Se il prezzo è $20,00 o superiore, non visualizzare il prezzo effettivo, ma il testo, chiamare per ottenere una quota di prezzo.</span><span class="sxs-lookup"><span data-stu-id="3bd31-204">Also, let s have the price highlighted yellow if it s less than $20.00 (as we did in the `ItemDataBound` event handler example); if the price is $20.00 or higher, let s not display the actual price, but instead the text, Please call for a price quote.</span></span> <span data-ttu-id="3bd31-205">Nella figura 4 viene illustrata una schermata dell'elenco dei prodotti con queste regole di formattazione applicate.</span><span class="sxs-lookup"><span data-stu-id="3bd31-205">Figure 4 shows a screen shot of the products listing with these formatting rules applied.</span></span>

<span data-ttu-id="3bd31-206">[![per prodotti costosi, il prezzo viene sostituito con il testo. per un preventivo, chiamare il prezzo](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="3bd31-206">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image10.png)</span></span>

<span data-ttu-id="3bd31-207">**Figura 4**: per i prodotti costosi, il prezzo viene sostituito con il testo. chiamare per un'offerta di prezzo ([fare clic per visualizzare l'immagine con dimensioni complete](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="3bd31-207">**Figure 4**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image12.png))</span></span>

## <a name="step-1-create-the-formatting-functions"></a><span data-ttu-id="3bd31-208">Passaggio 1: creare le funzioni di formattazione</span><span class="sxs-lookup"><span data-stu-id="3bd31-208">Step 1: Create the Formatting Functions</span></span>

<span data-ttu-id="3bd31-209">Per questo esempio sono necessarie due funzioni di formattazione, una che Visualizza il nome del prodotto insieme al testo [non più disponibile], se necessario, e un'altra che visualizza un prezzo evidenziato se è minore di $20,00 o il testo, chiamare per un preventivo.</span><span class="sxs-lookup"><span data-stu-id="3bd31-209">For this example we need two formatting functions, one that displays the product name along with the text [DISCONTINUED], if needed, and another that displays either a highlighted price if it s less than $20.00, or the text, Please call for a price quote otherwise.</span></span> <span data-ttu-id="3bd31-210">Consente di creare queste funzioni nella classe code-behind della pagina ASP.NET e denominarle `DisplayProductNameAndDiscontinuedStatus` e `DisplayPrice`.</span><span class="sxs-lookup"><span data-stu-id="3bd31-210">Let s create these functions in the ASP.NET page s code-behind class and name them `DisplayProductNameAndDiscontinuedStatus` and `DisplayPrice`.</span></span> <span data-ttu-id="3bd31-211">Entrambi i metodi devono restituire il codice HTML per eseguire il rendering come stringa ed entrambi devono essere contrassegnati `Protected` (o `Public`) per poter essere richiamati dalla parte della sintassi dichiarativa della pagina ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="3bd31-211">Both methods need to return the HTML to render as a string and both need to be marked `Protected` (or `Public`) in order to be invoked from the ASP.NET page s declarative syntax portion.</span></span> <span data-ttu-id="3bd31-212">Il codice per questi due metodi segue:</span><span class="sxs-lookup"><span data-stu-id="3bd31-212">The code for these two methods follows:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample3.cs)]

<span data-ttu-id="3bd31-213">Si noti che il metodo `DisplayProductNameAndDiscontinuedStatus` accetta i valori dei campi `productName` e `discontinued` dati come valori scalari, mentre il metodo `DisplayPrice` accetta un'istanza `ProductsRow` (anziché un valore scalare `unitPrice`).</span><span class="sxs-lookup"><span data-stu-id="3bd31-213">Note that the `DisplayProductNameAndDiscontinuedStatus` method accepts the values of the `productName` and `discontinued` data fields as scalar values, whereas the `DisplayPrice` method accepts a `ProductsRow` instance (rather than a `unitPrice` scalar value).</span></span> <span data-ttu-id="3bd31-214">Entrambi gli approcci funzioneranno; Tuttavia, se la funzione di formattazione funziona con valori scalari che possono contenere valori di `NULL` di database, ad esempio `UnitPrice`, né `ProductName` né `Discontinued` consentono `NULL` valori, è necessario prestare particolare attenzione alla gestione di questi input scalari.</span><span class="sxs-lookup"><span data-stu-id="3bd31-214">Either approach will work; however, if the formatting function is working with scalar values that can contain database `NULL` values (such as `UnitPrice`; neither `ProductName` nor `Discontinued` allow `NULL` values), special care must be taken in handling these scalar inputs.</span></span>

<span data-ttu-id="3bd31-215">In particolare, il parametro di input deve essere di tipo `Object` poiché il valore in ingresso potrebbe essere un'istanza di `DBNull` anziché il tipo di dati previsto.</span><span class="sxs-lookup"><span data-stu-id="3bd31-215">In particular, the input parameter must be of type `Object` since the incoming value might be a `DBNull` instance instead of the expected data type.</span></span> <span data-ttu-id="3bd31-216">Inoltre, è necessario effettuare un controllo per determinare se il valore in ingresso è un valore di `NULL` di database.</span><span class="sxs-lookup"><span data-stu-id="3bd31-216">Additionally, a check must be made to determine whether or not the incoming value is a database `NULL` value.</span></span> <span data-ttu-id="3bd31-217">Ovvero, se si desidera che il metodo `DisplayPrice` accetti il prezzo come valore scalare, è necessario utilizzare il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="3bd31-217">That is, if we wanted the `DisplayPrice` method to accept the price as a scalar value, we d have to use the following code:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample4.cs)]

<span data-ttu-id="3bd31-218">Si noti che il `unitPrice` parametro di input è di tipo `Object` e che l'istruzione condizionale è stata modificata per verificare se `unitPrice` è `DBNull` o meno.</span><span class="sxs-lookup"><span data-stu-id="3bd31-218">Note that the `unitPrice` input parameter is of type `Object` and that the conditional statement has been modified to ascertain if `unitPrice` is `DBNull` or not.</span></span> <span data-ttu-id="3bd31-219">Inoltre, poiché il parametro di input `unitPrice` viene passato come `Object`, è necessario eseguirne il cast a un valore decimale.</span><span class="sxs-lookup"><span data-stu-id="3bd31-219">Furthermore, since the `unitPrice` input parameter is passed in as an `Object`, it must be cast to a decimal value.</span></span>

## <a name="step-2-calling-the-formatting-function-from-the-datalist-s-itemtemplate"></a><span data-ttu-id="3bd31-220">Passaggio 2: chiamata della funzione di formattazione da DataList s ItemTemplate</span><span class="sxs-lookup"><span data-stu-id="3bd31-220">Step 2: Calling the Formatting Function from the DataList s ItemTemplate</span></span>

<span data-ttu-id="3bd31-221">Con le funzioni di formattazione aggiunte alla classe code-behind della pagina ASP.NET, tutto ciò che rimane consiste nel richiamare queste funzioni di formattazione dal `ItemTemplate`di DataList.</span><span class="sxs-lookup"><span data-stu-id="3bd31-221">With the formatting functions added to our ASP.NET page s code-behind class, all that remains is to invoke these formatting functions from the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="3bd31-222">Per chiamare una funzione di formattazione da un modello, inserire la chiamata di funzione nella sintassi DataBinding:</span><span class="sxs-lookup"><span data-stu-id="3bd31-222">To call a formatting function from a template, place the function call within the databinding syntax:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample5.aspx)]

<span data-ttu-id="3bd31-223">In DataList s `ItemTemplate` il controllo Web etichetta `ProductNameLabel` Visualizza attualmente il nome del prodotto assegnando la relativa proprietà `Text` il risultato della `<%# Eval("ProductName") %>`.</span><span class="sxs-lookup"><span data-stu-id="3bd31-223">In the DataList s `ItemTemplate` the `ProductNameLabel` Label Web control currently displays the product s name by assigning its `Text` property the result of `<%# Eval("ProductName") %>`.</span></span> <span data-ttu-id="3bd31-224">Per fare in modo che visualizzi il nome più il testo [non più disponibile], se necessario, aggiornare la sintassi dichiarativa in modo da assegnare invece alla proprietà `Text` il valore del metodo `DisplayProductNameAndDiscontinuedStatus`.</span><span class="sxs-lookup"><span data-stu-id="3bd31-224">In order to have it display the name plus the text [DISCONTINUED], if needed, update the declarative syntax so that it instead assigns the `Text` property the value of the `DisplayProductNameAndDiscontinuedStatus` method.</span></span> <span data-ttu-id="3bd31-225">Quando si esegue questa operazione, è necessario passare il nome del prodotto e i valori non più utilizzati usando la sintassi del `Eval("columnName")`.</span><span class="sxs-lookup"><span data-stu-id="3bd31-225">When doing so, we must pass in the product s name and discontinued values using the `Eval("columnName")` syntax.</span></span> <span data-ttu-id="3bd31-226">`Eval` restituisce un valore di tipo `Object`, ma il metodo `DisplayProductNameAndDiscontinuedStatus` prevede parametri di input di tipo `String` e `Boolean`; Pertanto, è necessario eseguire il cast dei valori restituiti dal metodo `Eval` ai tipi di parametri di input previsti, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="3bd31-226">`Eval` returns a value of type `Object`, but the `DisplayProductNameAndDiscontinuedStatus` method expects input parameters of type `String` and `Boolean`; therefore, we must cast the values returned by the `Eval` method to the expected input parameter types, like so:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample6.aspx)]

<span data-ttu-id="3bd31-227">Per visualizzare il prezzo, è sufficiente impostare la proprietà `UnitPriceLabel` label s `Text` sul valore restituito dal metodo `DisplayPrice`, esattamente come è stato fatto per visualizzare il nome del prodotto e il testo [Discontinued].</span><span class="sxs-lookup"><span data-stu-id="3bd31-227">To display the price, we can simply set the `UnitPriceLabel` Label s `Text` property to the value returned by the `DisplayPrice` method, just like we did for displaying the product s name and [DISCONTINUED] text.</span></span> <span data-ttu-id="3bd31-228">Tuttavia, anziché passare l'`UnitPrice` come parametro di input scalare, viene invece passato l'intera istanza di `ProductsRow`:</span><span class="sxs-lookup"><span data-stu-id="3bd31-228">However, instead of passing in the `UnitPrice` as a scalar input parameter, we instead pass in the entire `ProductsRow` instance:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample7.aspx)]

<span data-ttu-id="3bd31-229">Con le chiamate alle funzioni di formattazione, dedicare un po' di tempo a visualizzare lo stato di avanzamento in un browser.</span><span class="sxs-lookup"><span data-stu-id="3bd31-229">With the calls to the formatting functions in place, take a moment to view our progress in a browser.</span></span> <span data-ttu-id="3bd31-230">La schermata dovrebbe avere un aspetto simile a quello riportato nella figura 5, con i prodotti obsoleti che includono il testo [obsoleto] e i prodotti che costano più di $20,00 se il prezzo viene sostituito con il testo, chiamare per un prezzo.</span><span class="sxs-lookup"><span data-stu-id="3bd31-230">Your screen should look similar to Figure 5, with the discontinued products including the text [DISCONTINUED] and those products costing more than $20.00 having their price replaced with the text Please call for a price quote .</span></span>

<span data-ttu-id="3bd31-231">[![per prodotti costosi, il prezzo viene sostituito con il testo. per un preventivo, chiamare il prezzo](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="3bd31-231">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image13.png)</span></span>

<span data-ttu-id="3bd31-232">**Figura 5**: per i prodotti costosi, il prezzo viene sostituito con il testo. chiamare per un'offerta di prezzo ([fare clic per visualizzare l'immagine con dimensioni complete](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="3bd31-232">**Figure 5**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image15.png))</span></span>

## <a name="summary"></a><span data-ttu-id="3bd31-233">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="3bd31-233">Summary</span></span>

<span data-ttu-id="3bd31-234">La formattazione del contenuto di un controllo DataList o Repeater basato sui dati può essere eseguita usando due tecniche.</span><span class="sxs-lookup"><span data-stu-id="3bd31-234">Formatting the contents of a DataList or Repeater control based upon the data can be accomplished using two techniques.</span></span> <span data-ttu-id="3bd31-235">La prima tecnica consiste nel creare un gestore eventi per l'evento `ItemDataBound`, che viene attivato quando ogni record nell'origine dati è associato a un nuovo `DataListItem` o `RepeaterItem`.</span><span class="sxs-lookup"><span data-stu-id="3bd31-235">The first technique is to create an event handler for the `ItemDataBound` event, which fires as each record in the data source is bound to a new `DataListItem` or `RepeaterItem`.</span></span> <span data-ttu-id="3bd31-236">Nel gestore dell'evento `ItemDataBound`, è possibile esaminare i dati dell'elemento corrente, quindi applicare la formattazione al contenuto del modello o, per `DataListItem` s, all'intero elemento.</span><span class="sxs-lookup"><span data-stu-id="3bd31-236">In the `ItemDataBound` event handler, the current item s data can be examined and then formatting can be applied to the contents of the template or, for `DataListItem` s, to the entire item itself.</span></span>

<span data-ttu-id="3bd31-237">In alternativa, la formattazione personalizzata può essere realizzata tramite le funzioni di formattazione.</span><span class="sxs-lookup"><span data-stu-id="3bd31-237">Alternatively, custom formatting can be realized through formatting functions.</span></span> <span data-ttu-id="3bd31-238">Una funzione di formattazione è un metodo che può essere richiamato dai modelli DataList o Repeater che restituisce il codice HTML da emettere al suo posto.</span><span class="sxs-lookup"><span data-stu-id="3bd31-238">A formatting function is a method that can be invoked from the DataList or Repeater s templates that returns the HTML to emit in its place.</span></span> <span data-ttu-id="3bd31-239">Spesso il codice HTML restituito da una funzione di formattazione è determinato dai valori associati all'elemento corrente.</span><span class="sxs-lookup"><span data-stu-id="3bd31-239">Often, the HTML returned by a formatting function is determined by the values being bound to the current item.</span></span> <span data-ttu-id="3bd31-240">Questi valori possono essere passati nella funzione di formattazione, come valori scalari o passando l'intero oggetto associato all'elemento, ad esempio l'istanza di `ProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="3bd31-240">These values can be passed into the formatting function, either as scalar values or by passing in the entire object being bound to the item (such as the `ProductsRow` instance).</span></span>

<span data-ttu-id="3bd31-241">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="3bd31-241">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="3bd31-242">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="3bd31-242">About the Author</span></span>

<span data-ttu-id="3bd31-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="3bd31-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3bd31-244">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="3bd31-244">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3bd31-245">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="3bd31-245">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="3bd31-246">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3bd31-246">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="3bd31-247">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="3bd31-247">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="3bd31-248">Grazie speciale</span><span class="sxs-lookup"><span data-stu-id="3bd31-248">Special Thanks To</span></span>

<span data-ttu-id="3bd31-249">Questa serie di esercitazioni è stata esaminata da molti revisori utili.</span><span class="sxs-lookup"><span data-stu-id="3bd31-249">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3bd31-250">I revisori del lead per questa esercitazione erano Yaakov Ellis, Randy Schmidt e Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="3bd31-250">Lead reviewers for this tutorial were Yaakov Ellis, Randy Schmidt, and Liz Shulok.</span></span> <span data-ttu-id="3bd31-251">Sei interessato a esaminare i miei prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="3bd31-251">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3bd31-252">In tal caso, rilasciare una riga in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3bd31-252">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="3bd31-253">[Precedente](displaying-data-with-the-datalist-and-repeater-controls-cs.md)
> [Successivo](showing-multiple-records-per-row-with-the-datalist-control-cs.md)</span><span class="sxs-lookup"><span data-stu-id="3bd31-253">[Previous](displaying-data-with-the-datalist-and-repeater-controls-cs.md)
[Next](showing-multiple-records-per-row-with-the-datalist-control-cs.md)</span></span>
