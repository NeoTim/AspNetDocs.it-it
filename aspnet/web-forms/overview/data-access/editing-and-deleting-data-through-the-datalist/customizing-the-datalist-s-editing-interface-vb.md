---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
title: Personalizzazione dell'interfaccia di modifica di DataList (VB) | Microsoft Docs
author: rick-anderson
description: In questa esercitazione verrà creata un'interfaccia di modifica più completa per DataList, che include DropDownList e una casella di controllo.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: 718628e2-224c-455f-b33a-a41efd48d5a0
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: adee419764cff2f39ee16962080c24b52553aa14
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/28/2019
ms.locfileid: "74637443"
---
# <a name="customizing-the-datalists-editing-interface-vb"></a><span data-ttu-id="95e04-103">Personalizzazione dell'interfaccia di modifica di DataList (VB)</span><span class="sxs-lookup"><span data-stu-id="95e04-103">Customizing the DataList's Editing Interface (VB)</span></span>

<span data-ttu-id="95e04-104">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="95e04-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="95e04-105">[Scaricare l'app di esempio](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) o [scaricare il file PDF](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="95e04-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) or [Download PDF](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span></span>

> <span data-ttu-id="95e04-106">In questa esercitazione verrà creata un'interfaccia di modifica più completa per DataList, che include DropDownList e una casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="95e04-106">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span>

## <a name="introduction"></a><span data-ttu-id="95e04-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="95e04-107">Introduction</span></span>

<span data-ttu-id="95e04-108">Il markup e i controlli Web di DataList `EditItemTemplate` definiscono l'interfaccia modificabile.</span><span class="sxs-lookup"><span data-stu-id="95e04-108">The markup and Web controls in the DataList s `EditItemTemplate` define its editable interface.</span></span> <span data-ttu-id="95e04-109">In tutti gli esempi di DataList modificabili esaminati fino a questo punto, l'interfaccia modificabile è stata composta da controlli Web TextBox.</span><span class="sxs-lookup"><span data-stu-id="95e04-109">In all of the editable DataList examples we ve examined thus far, the editable interface has been composed of TextBox Web controls.</span></span> <span data-ttu-id="95e04-110">Nell' [esercitazione precedente](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) è stata migliorata l'esperienza utente per la fase di modifica aggiungendo i controlli di convalida.</span><span class="sxs-lookup"><span data-stu-id="95e04-110">In the [preceding tutorial](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) we improved the edit-time user experience by adding validation controls.</span></span>

<span data-ttu-id="95e04-111">Il `EditItemTemplate` può essere ulteriormente espanso per includere controlli Web diversi dalla casella di testo, ad esempio DropDownList, RadioButtonList, calendari e così via.</span><span class="sxs-lookup"><span data-stu-id="95e04-111">The `EditItemTemplate` can be further expanded to include Web controls other than the TextBox, such as DropDownLists, RadioButtonLists, Calendars, and so on.</span></span> <span data-ttu-id="95e04-112">Come per le caselle di testo, quando si Personalizza l'interfaccia di modifica per includere altri controlli Web, attenersi alla procedura seguente:</span><span class="sxs-lookup"><span data-stu-id="95e04-112">As with TextBoxes, when customizing the editing interface to include other Web controls, employ the following steps:</span></span>

1. <span data-ttu-id="95e04-113">Aggiungere il controllo Web al `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="95e04-113">Add the Web control to the `EditItemTemplate`.</span></span>
2. <span data-ttu-id="95e04-114">Utilizzare la sintassi DataBinding per assegnare il valore del campo dati corrispondente alla proprietà appropriata.</span><span class="sxs-lookup"><span data-stu-id="95e04-114">Use databinding syntax to assign the corresponding data field value to the appropriate property.</span></span>
3. <span data-ttu-id="95e04-115">Nel gestore dell'evento `UpdateCommand`, accedere a livello di codice al valore del controllo Web e passarlo al metodo BLL appropriato.</span><span class="sxs-lookup"><span data-stu-id="95e04-115">In the `UpdateCommand` event handler, programmatically access the Web control value and pass it into the appropriate BLL method.</span></span>

<span data-ttu-id="95e04-116">In questa esercitazione verrà creata un'interfaccia di modifica più completa per DataList, che include DropDownList e una casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="95e04-116">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span> <span data-ttu-id="95e04-117">In particolare, verrà creato un DataList che elenca le informazioni sul prodotto e consente di aggiornare il nome del prodotto, il fornitore, la categoria e lo stato sospeso (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="95e04-117">In particular, we'll create a DataList that lists product information and permits the product s name, supplier, category, and discontinued status to be updated (see Figure 1).</span></span>

<span data-ttu-id="95e04-118">[![l'interfaccia di modifica include una casella di testo, due DropDownList e una casella di controllo](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="95e04-118">[![The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="95e04-119">**Figura 1**: l'interfaccia di modifica include una casella di testo, due DropDownList e una casella[di controllo (fare clic per visualizzare l'immagine con dimensioni complete](customizing-the-datalist-s-editing-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="95e04-119">**Figure 1**: The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>

## <a name="step-1-displaying-product-information"></a><span data-ttu-id="95e04-120">Passaggio 1: visualizzazione delle informazioni sul prodotto</span><span class="sxs-lookup"><span data-stu-id="95e04-120">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="95e04-121">Prima di poter creare l'interfaccia modificabile di DataList, prima di tutto è necessario compilare l'interfaccia di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="95e04-121">Before we can create the DataList s editable interface, we first need to build the read-only interface.</span></span> <span data-ttu-id="95e04-122">Per iniziare, aprire la pagina `CustomizedUI.aspx` dalla cartella `EditDeleteDataList` e, dalla finestra di progettazione, aggiungere un oggetto DataList alla pagina, impostando la relativa proprietà `ID` su `Products`.</span><span class="sxs-lookup"><span data-stu-id="95e04-122">Start by opening the `CustomizedUI.aspx` page from the `EditDeleteDataList` folder and, from the Designer, add a DataList to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="95e04-123">Dallo smart tag di DataList, creare un nuovo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="95e04-123">From the DataList s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="95e04-124">Assegnare al nuovo ObjectDataSource il nome `ProductsDataSource` e configurarlo per il recupero dei dati dal metodo `GetProducts` della classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="95e04-124">Name this new ObjectDataSource `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="95e04-125">Come per le esercitazioni di DataList modificabili precedenti, verranno aggiornate le informazioni modificate del prodotto passando direttamente al livello della logica di business.</span><span class="sxs-lookup"><span data-stu-id="95e04-125">As with the previous editable DataList tutorials, we'll update the edited product s information by going directly to the Business Logic Layer.</span></span> <span data-ttu-id="95e04-126">Di conseguenza, impostare gli elenchi a discesa nelle schede Aggiorna, Inserisci ed Elimina su (nessuno).</span><span class="sxs-lookup"><span data-stu-id="95e04-126">Accordingly, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span>

<span data-ttu-id="95e04-127">[![impostare gli elenchi a discesa delle schede di aggiornamento, inserimento ed eliminazione su (nessuno)](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="95e04-127">[![Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None)](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="95e04-128">**Figura 2**: impostare gli elenchi a discesa delle schede di aggiornamento, inserimento ed eliminazione su (nessuno) ([fare clic per visualizzare l'immagine con dimensioni complete](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="95e04-128">**Figure 2**: Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>

<span data-ttu-id="95e04-129">Dopo aver configurato ObjectDataSource, Visual Studio creerà un `ItemTemplate` predefinito per DataList che elenca il nome e il valore per ogni campo dati restituito.</span><span class="sxs-lookup"><span data-stu-id="95e04-129">After configuring the ObjectDataSource, Visual Studio will create a default `ItemTemplate` for the DataList that lists the name and value for each of the data fields returned.</span></span> <span data-ttu-id="95e04-130">Modificare il `ItemTemplate` in modo che il modello elenchi il nome del prodotto in un elemento `<h4>` con il nome della categoria, il nome del fornitore, il prezzo e lo stato interrotto.</span><span class="sxs-lookup"><span data-stu-id="95e04-130">Modify the `ItemTemplate` so that the template lists the product name in an `<h4>` element along with the category name, supplier name, price, and discontinued status.</span></span> <span data-ttu-id="95e04-131">Aggiungere inoltre un pulsante modifica, assicurandosi che la relativa proprietà `CommandName` sia impostata su modifica.</span><span class="sxs-lookup"><span data-stu-id="95e04-131">Moreover, add an Edit button, making sure that its `CommandName` property is set to Edit.</span></span> <span data-ttu-id="95e04-132">Il markup dichiarativo per My `ItemTemplate` segue:</span><span class="sxs-lookup"><span data-stu-id="95e04-132">The declarative markup for my `ItemTemplate` follows:</span></span>

[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="95e04-133">Il markup precedente presenta le informazioni sul prodotto usando un'intestazione di&gt; &lt;H4 per il nome del prodotto e un `<table>` di quattro colonne per i campi rimanenti.</span><span class="sxs-lookup"><span data-stu-id="95e04-133">The above markup lays out the product information using an &lt;h4&gt; heading for the product s name and a four-column `<table>` for the remaining fields.</span></span> <span data-ttu-id="95e04-134">Le classi CSS `ProductPropertyLabel` e `ProductPropertyValue`, definite in `Styles.css`, sono state illustrate nelle esercitazioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="95e04-134">The `ProductPropertyLabel` and `ProductPropertyValue` CSS classes, defined in `Styles.css`, have been discussed in previous tutorials.</span></span> <span data-ttu-id="95e04-135">La figura 3 Mostra lo stato di avanzamento quando viene visualizzato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="95e04-135">Figure 3 shows our progress when viewed through a browser.</span></span>

<span data-ttu-id="95e04-136">[![viene visualizzato il nome, il fornitore, la categoria, lo stato non più disponibile e il prezzo di ogni prodotto](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="95e04-136">[![The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="95e04-137">**Figura 3**: vengono visualizzati il nome, il fornitore, la categoria, lo stato non più disponibile e il prezzo di ogni prodotto ([fare clic per visualizzare l'immagine con dimensioni complete](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="95e04-137">**Figure 3**: The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>

## <a name="step-2-adding-the-web-controls-to-the-editing-interface"></a><span data-ttu-id="95e04-138">Passaggio 2: aggiunta dei controlli Web all'interfaccia di modifica</span><span class="sxs-lookup"><span data-stu-id="95e04-138">Step 2: Adding the Web Controls to the Editing Interface</span></span>

<span data-ttu-id="95e04-139">Il primo passaggio della creazione dell'interfaccia di modifica di DataList personalizzata consiste nell'aggiungere i controlli Web necessari all'`EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="95e04-139">The first step in building the customized DataList editing interface is to add the needed Web controls to the `EditItemTemplate`.</span></span> <span data-ttu-id="95e04-140">In particolare, è necessario un controllo DropDownList per la categoria, un altro per il fornitore e una casella di controllo per lo stato non più disponibile.</span><span class="sxs-lookup"><span data-stu-id="95e04-140">In particular, we need a DropDownList for the category, another for the supplier, and a CheckBox for the discontinued state.</span></span> <span data-ttu-id="95e04-141">Poiché il prezzo del prodotto non è modificabile in questo esempio, è possibile continuare a visualizzarlo usando un controllo Web Label.</span><span class="sxs-lookup"><span data-stu-id="95e04-141">Since the product s price is not editable in this example, we can continue displaying it using a Label Web control.</span></span>

<span data-ttu-id="95e04-142">Per personalizzare l'interfaccia di modifica, fare clic sul collegamento modifica modelli dallo smart tag di DataList e scegliere l'opzione `EditItemTemplate` dall'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="95e04-142">To customize the editing interface, click on the Edit Templates link from the DataList s smart tag and choose the `EditItemTemplate` option from the drop-down list.</span></span> <span data-ttu-id="95e04-143">Aggiungere un oggetto DropDownList al `EditItemTemplate` e impostare la relativa `ID` su `Categories`.</span><span class="sxs-lookup"><span data-stu-id="95e04-143">Add a DropDownList to the `EditItemTemplate` and set its `ID` to `Categories`.</span></span>

<span data-ttu-id="95e04-144">[![aggiungere un oggetto DropDownList per le categorie](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="95e04-144">[![Add a DropDownList for the Categories](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="95e04-145">**Figura 4**: aggiungere un oggetto DropDownList per le categorie ([fare clic per visualizzare l'immagine con dimensioni complete](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="95e04-145">**Figure 4**: Add a DropDownList for the Categories ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>

<span data-ttu-id="95e04-146">Quindi, dallo smart tag di DropDownList, selezionare l'opzione Scegli origine dati e creare un nuovo ObjectDataSource denominato `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="95e04-146">Next, from the DropDownList s smart tag, select the Choose Data Source option and create a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="95e04-147">Configurare ObjectDataSource per l'uso del metodo di `GetCategories()` della classe `CategoriesBLL` (vedere la figura 5).</span><span class="sxs-lookup"><span data-stu-id="95e04-147">Configure this ObjectDataSource to use the `CategoriesBLL` class s `GetCategories()` method (see Figure 5).</span></span> <span data-ttu-id="95e04-148">Successivamente, la configurazione guidata origine dati di DropDownList richiede i campi dati da usare per ogni `ListItem` s `Text` e `Value` proprietà.</span><span class="sxs-lookup"><span data-stu-id="95e04-148">Next, the DropDownList s Data Source Configuration Wizard prompts for the data fields to use for each `ListItem` s `Text` and `Value` properties.</span></span> <span data-ttu-id="95e04-149">Fare in modo che DropDownList visualizzi il campo dati `CategoryName` e usare il `CategoryID` come valore, come illustrato nella figura 6.</span><span class="sxs-lookup"><span data-stu-id="95e04-149">Have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value, as shown in Figure 6.</span></span>

<span data-ttu-id="95e04-150">[![creare un nuovo ObjectDataSource denominato CategoriesDataSource](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="95e04-150">[![Create a New ObjectDataSource Named CategoriesDataSource](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="95e04-151">**Figura 5**: creare un nuovo ObjectDataSource denominato `CategoriesDataSource` ([fare clic per visualizzare l'immagine con dimensioni complete](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="95e04-151">**Figure 5**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>

<span data-ttu-id="95e04-152">[![configurare i campi di visualizzazione e valori di DropDownList s](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="95e04-152">[![Configure the DropDownList s Display and Value Fields](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="95e04-153">**Figura 6**: configurare i campi di visualizzazione e valori di DropDownList ([fare clic per visualizzare l'immagine con dimensioni complete](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="95e04-153">**Figure 6**: Configure the DropDownList s Display and Value Fields ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>

<span data-ttu-id="95e04-154">Ripetere questa serie di passaggi per creare un DropDownList per i fornitori.</span><span class="sxs-lookup"><span data-stu-id="95e04-154">Repeat this series of steps to create a DropDownList for the suppliers.</span></span> <span data-ttu-id="95e04-155">Impostare l'`ID` per questo oggetto DropDownList `Suppliers` e Denominarne il `SuppliersDataSource`ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="95e04-155">Set the `ID` for this DropDownList to `Suppliers` and name its ObjectDataSource `SuppliersDataSource`.</span></span>

<span data-ttu-id="95e04-156">Dopo aver aggiunto i due DropDownList, aggiungere una casella di controllo per lo stato non più disponibile e una casella di testo per il nome del prodotto.</span><span class="sxs-lookup"><span data-stu-id="95e04-156">After adding the two DropDownLists, add a CheckBox for the discontinued state and a TextBox for the product s name.</span></span> <span data-ttu-id="95e04-157">Impostare il `ID` s per la casella di controllo e la casella di testo rispettivamente su `Discontinued` e `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="95e04-157">Set the `ID` s for the CheckBox and TextBox to `Discontinued` and `ProductName`, respectively.</span></span> <span data-ttu-id="95e04-158">Aggiungere un RequiredFieldValidator per assicurarsi che l'utente fornisca un valore per il nome del prodotto.</span><span class="sxs-lookup"><span data-stu-id="95e04-158">Add a RequiredFieldValidator to ensure that the user provides a value for the product s name.</span></span>

<span data-ttu-id="95e04-159">Infine, aggiungere i pulsanti Aggiorna e Annulla.</span><span class="sxs-lookup"><span data-stu-id="95e04-159">Lastly, add the Update and Cancel buttons.</span></span> <span data-ttu-id="95e04-160">Tenere presente che per questi due pulsanti è necessario che le proprietà `CommandName` siano impostate rispettivamente su Update e Cancel.</span><span class="sxs-lookup"><span data-stu-id="95e04-160">Remember that for these two buttons it is imperative that their `CommandName` properties are set to Update and Cancel, respectively.</span></span>

<span data-ttu-id="95e04-161">Tuttavia, è possibile disporre l'interfaccia di modifica.</span><span class="sxs-lookup"><span data-stu-id="95e04-161">Feel free to lay out the editing interface however you like.</span></span> <span data-ttu-id="95e04-162">Si è scelto di utilizzare lo stesso layout di `<table>` a quattro colonne dall'interfaccia di sola lettura, come illustrato nella seguente sintassi dichiarativa e screenshot:</span><span class="sxs-lookup"><span data-stu-id="95e04-162">I ve opted to use the same four-column `<table>` layout from the read-only interface, as the following declarative syntax and screen shot illustrates:</span></span>

[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample2.aspx)]

<span data-ttu-id="95e04-163">[![l'interfaccia di modifica è disposta come l'interfaccia di sola lettura](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="95e04-163">[![The Editing Interface is Laid Out like the Read-Only Interface](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span></span>

<span data-ttu-id="95e04-164">**Figura 7**: l'interfaccia di modifica è disposta come l'interfaccia di sola lettura ([fare clic per visualizzare l'immagine con dimensioni complete](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="95e04-164">**Figure 7**: The Editing Interface is Laid Out like the Read-Only Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span></span>

## <a name="step-3-creating-the-editcommand-and-cancelcommand-event-handlers"></a><span data-ttu-id="95e04-165">Passaggio 3: creazione dei gestori di eventi EditCommand e CancelCommand</span><span class="sxs-lookup"><span data-stu-id="95e04-165">Step 3: Creating the EditCommand and CancelCommand Event Handlers</span></span>

<span data-ttu-id="95e04-166">Attualmente non è presente alcuna sintassi di associazione dati nel `EditItemTemplate` (ad eccezione del `UnitPriceLabel`, che è stato copiato su Verbatim dal `ItemTemplate`).</span><span class="sxs-lookup"><span data-stu-id="95e04-166">Currently, there is no databinding syntax in the `EditItemTemplate` (except for the `UnitPriceLabel`, which was copied over verbatim from the `ItemTemplate`).</span></span> <span data-ttu-id="95e04-167">Si aggiungerà momentaneamente la sintassi di associazione dati, ma prima di tutto verranno creati i gestori eventi per gli eventi `EditCommand` e `CancelCommand` di DataList.</span><span class="sxs-lookup"><span data-stu-id="95e04-167">We'll add the databinding syntax momentarily, but first let s create the event handlers for the DataList s `EditCommand` and `CancelCommand` events.</span></span> <span data-ttu-id="95e04-168">Tenere presente che la responsabilità del gestore dell'evento `EditCommand` consiste nel eseguire il rendering dell'interfaccia di modifica per l'elemento DataList di cui è stato fatto clic sul pulsante di modifica, mentre il processo di `CancelCommand` s restituisce il DataList allo stato di pre-modifica.</span><span class="sxs-lookup"><span data-stu-id="95e04-168">Recall that the responsibility of the `EditCommand` event handler is to render the editing interface for the DataList item whose Edit button was clicked, whereas the `CancelCommand` s job is to return the DataList to its pre-editing state.</span></span>

<span data-ttu-id="95e04-169">Creare questi due gestori eventi e fare in modo che usino il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="95e04-169">Create these two event handlers and have them use the following code:</span></span>

[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample3.vb)]

<span data-ttu-id="95e04-170">Con questi due gestori eventi sul posto, facendo clic sul pulsante modifica viene visualizzata l'interfaccia di modifica e facendo clic sul pulsante Annulla viene restituito l'elemento modificato alla modalità di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="95e04-170">With these two event handlers in place, clicking the Edit button displays the editing interface and clicking the Cancel button returns the edited item to its read-only mode.</span></span> <span data-ttu-id="95e04-171">Nella figura 8 viene illustrato il DataList dopo che è stato fatto clic sul pulsante modifica per chef Anton s Gumbo Mix.</span><span class="sxs-lookup"><span data-stu-id="95e04-171">Figure 8 shows the DataList after the Edit button has been clicked for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="95e04-172">Poiché è ancora necessario aggiungere una sintassi di associazione dati all'interfaccia di modifica, la casella di testo `ProductName` è vuota, la casella di controllo `Discontinued` deselezionata e i primi elementi selezionati dai `Categories` e `Suppliers` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="95e04-172">Since we ve yet to add any databinding syntax to the editing interface, the `ProductName` TextBox is blank, the `Discontinued` CheckBox unchecked, and the first items selected from the `Categories` and `Suppliers` DropDownLists.</span></span>

<span data-ttu-id="95e04-173">[![facendo clic sul pulsante modifica viene visualizzata l'interfaccia di modifica](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="95e04-173">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span></span>

<span data-ttu-id="95e04-174">**Figura 8**: facendo clic sul pulsante modifica viene visualizzata l'interfaccia[di modifica (fare clic per visualizzare l'immagine con dimensioni complete](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="95e04-174">**Figure 8**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span></span>

## <a name="step-4-adding-the-databinding-syntax-to-the-editing-interface"></a><span data-ttu-id="95e04-175">Passaggio 4: aggiunta della sintassi DataBinding all'interfaccia di modifica</span><span class="sxs-lookup"><span data-stu-id="95e04-175">Step 4: Adding the DataBinding Syntax to the Editing Interface</span></span>

<span data-ttu-id="95e04-176">Per fare in modo che nell'interfaccia di modifica vengano visualizzati i valori dei prodotti correnti, è necessario utilizzare la sintassi DataBinding per assegnare i valori dei campi dati ai valori del controllo Web appropriati.</span><span class="sxs-lookup"><span data-stu-id="95e04-176">To have the editing interface display the current product s values, we need to use databinding syntax to assign the data field values to the appropriate Web control values.</span></span> <span data-ttu-id="95e04-177">La sintassi di associazione dati può essere applicata tramite la finestra di progettazione passando alla schermata Modifica modelli e selezionando il collegamento Modifica DataBindings dagli smart tag dei controlli Web.</span><span class="sxs-lookup"><span data-stu-id="95e04-177">The databinding syntax can be applied through the Designer by going to the Edit Templates screen and selecting the Edit DataBindings link from the Web controls smart tags.</span></span> <span data-ttu-id="95e04-178">In alternativa, è possibile aggiungere la sintassi DataBinding direttamente al markup dichiarativo.</span><span class="sxs-lookup"><span data-stu-id="95e04-178">Alternatively, the databinding syntax can be added directly to the declarative markup.</span></span>

<span data-ttu-id="95e04-179">Assegnare il valore `ProductName` campo dati alla proprietà `ProductName` casella di testo `Text`, i valori del campo dati `CategoryID` e `SupplierID` alle proprietà `Categories` e `Suppliers` DropDownList `SelectedValue` e il valore del campo `Discontinued` dati alla proprietà `Discontinued` della casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="95e04-179">Assign the `ProductName` data field value to the `ProductName` TextBox s `Text` property, the `CategoryID` and `SupplierID` data field values to the `Categories` and `Suppliers` DropDownLists `SelectedValue` properties, and the `Discontinued` data field value to the `Discontinued` CheckBox s `Checked` property.</span></span> <span data-ttu-id="95e04-180">Dopo aver apportato queste modifiche, tramite la finestra di progettazione o direttamente tramite il markup dichiarativo, rivedere la pagina tramite un browser e fare clic sul pulsante modifica per chef Anton s Gumbo Mix.</span><span class="sxs-lookup"><span data-stu-id="95e04-180">After making these changes, either through the Designer or directly through the declarative markup, revisit the page through a browser and click the Edit button for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="95e04-181">Come illustrato nella figura 9, la sintassi di associazione dati ha aggiunto i valori correnti nelle caselle di testo, DropDownList e casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="95e04-181">As Figure 9 shows, the databinding syntax has added the current values into the TextBox, DropDownLists, and CheckBox.</span></span>

<span data-ttu-id="95e04-182">[![facendo clic sul pulsante modifica viene visualizzata l'interfaccia di modifica](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="95e04-182">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span></span>

<span data-ttu-id="95e04-183">**Figura 9**: facendo clic sul pulsante modifica viene visualizzata l'interfaccia[di modifica (fare clic per visualizzare l'immagine con dimensioni complete](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="95e04-183">**Figure 9**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span></span>

## <a name="step-5-saving-the-user-s-changes-in-the-updatecommand-event-handler"></a><span data-ttu-id="95e04-184">Passaggio 5: salvataggio delle modifiche apportate dall'utente nel gestore eventi UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="95e04-184">Step 5: Saving the User s Changes in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="95e04-185">Quando l'utente modifica un prodotto e fa clic sul pulsante Aggiorna, viene eseguito un postback e viene generato l'evento DataList s `UpdateCommand`.</span><span class="sxs-lookup"><span data-stu-id="95e04-185">When the user edits a product and clicks the Update button, a postback occurs and the DataList s `UpdateCommand` event fires.</span></span> <span data-ttu-id="95e04-186">Nel gestore eventi, è necessario leggere i valori dai controlli Web nell'`EditItemTemplate` e l'interfaccia con il servizio BLL per aggiornare il prodotto nel database.</span><span class="sxs-lookup"><span data-stu-id="95e04-186">In the event handler, we need to read the values from the Web controls in the `EditItemTemplate` and interface with the BLL to update the product in the database.</span></span> <span data-ttu-id="95e04-187">Come illustrato nelle esercitazioni precedenti, l'`ProductID` del prodotto aggiornato è accessibile tramite la raccolta di `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="95e04-187">As we ve seen in previous tutorials, the `ProductID` of the updated product is accessible through the `DataKeys` collection.</span></span> <span data-ttu-id="95e04-188">Per accedere ai campi immessi dall'utente, fare riferimento a livello di codice ai controlli Web utilizzando `FindControl("controlID")`, come illustrato nel codice seguente:</span><span class="sxs-lookup"><span data-stu-id="95e04-188">The user-entered fields are accessed by programmatically referencing the Web controls using `FindControl("controlID")`, as the following code shows:</span></span>

[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample4.vb)]

<span data-ttu-id="95e04-189">Il codice inizia consultando la proprietà `Page.IsValid` per assicurarsi che tutti i controlli di convalida della pagina siano validi.</span><span class="sxs-lookup"><span data-stu-id="95e04-189">The code starts out by consulting the `Page.IsValid` property to ensure that all the validation controls on the page are valid.</span></span> <span data-ttu-id="95e04-190">Se `Page.IsValid` è `True`, il valore del `ProductID` di prodotto modificato viene letto dalla raccolta di `DataKeys` e i controlli Web per l'immissione di dati nel `EditItemTemplate` sono a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="95e04-190">If `Page.IsValid` is `True`, the edited product s `ProductID` value is read from the `DataKeys` collection and the data entry Web controls in the `EditItemTemplate` are programmatically referenced.</span></span> <span data-ttu-id="95e04-191">Successivamente, i valori di questi controlli Web vengono letti nelle variabili che vengono quindi passate nell'overload `UpdateProduct` appropriato.</span><span class="sxs-lookup"><span data-stu-id="95e04-191">Next, the values from these Web controls are read into variables that are then passed into the appropriate `UpdateProduct` overload.</span></span> <span data-ttu-id="95e04-192">Dopo l'aggiornamento dei dati, DataList viene restituito allo stato di pre-modifica.</span><span class="sxs-lookup"><span data-stu-id="95e04-192">After updating the data, the DataList is returned to its pre-editing state.</span></span>

> [!NOTE]
> <span data-ttu-id="95e04-193">È stata omessa la logica di gestione delle eccezioni aggiunta nell'esercitazione relativa alla [gestione delle eccezioni BLL e dal a livello](handling-bll-and-dal-level-exceptions-vb.md) di codice per evitare che il codice e questo esempio siano concentrati.</span><span class="sxs-lookup"><span data-stu-id="95e04-193">I ve omitted the exception handling logic added in the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial in order to keep the code and this example focused.</span></span> <span data-ttu-id="95e04-194">Al termine dell'esercitazione, aggiungere questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="95e04-194">As an exercise, add this functionality after completing this tutorial.</span></span>

## <a name="step-6-handling-null-categoryid-and-supplierid-values"></a><span data-ttu-id="95e04-195">Passaggio 6: gestione dei valori SupplierID e CategoryID NULL</span><span class="sxs-lookup"><span data-stu-id="95e04-195">Step 6: Handling NULL CategoryID and SupplierID Values</span></span>

<span data-ttu-id="95e04-196">Il database Northwind consente valori `NULL` per le colonne `Products` `CategoryID` e `SupplierID` della tabella.</span><span class="sxs-lookup"><span data-stu-id="95e04-196">The Northwind database allows for `NULL` values for the `Products` table s `CategoryID` and `SupplierID` columns.</span></span> <span data-ttu-id="95e04-197">Tuttavia, l'interfaccia di modifica non supporta attualmente `NULL` valori.</span><span class="sxs-lookup"><span data-stu-id="95e04-197">However, our editing interface doesn t currently accommodate `NULL` values.</span></span> <span data-ttu-id="95e04-198">Se si tenta di modificare un prodotto con un valore `NULL` per le colonne `CategoryID` o `SupplierID`, si otterrà un `ArgumentOutOfRangeException` con un messaggio di errore simile a: *' categorie ' contiene un elemento SelectedValue che non è valido perché non esiste nell'elenco di elementi.*</span><span class="sxs-lookup"><span data-stu-id="95e04-198">If we attempt to edit a product that has a `NULL` value for either its `CategoryID` or `SupplierID` columns, we'll get an `ArgumentOutOfRangeException` with an error message similar to: *'Categories' has a SelectedValue which is invalid because it does not exist in the list of items.*</span></span> <span data-ttu-id="95e04-199">Inoltre, attualmente non è possibile modificare una categoria di prodotti o un valore fornitore da un valore non`NULL` a uno `NULL`.</span><span class="sxs-lookup"><span data-stu-id="95e04-199">Also, there s currently no way to change a product s category or supplier value from a non-`NULL` value to a `NULL` one.</span></span>

<span data-ttu-id="95e04-200">Per supportare `NULL` valori per i controlli DropDownList Category e Supplier, è necessario aggiungere un `ListItem`aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="95e04-200">To support `NULL` values for the category and supplier DropDownLists, we need to add an additional `ListItem`.</span></span> <span data-ttu-id="95e04-201">Ho scelto di utilizzare (nessuno) come valore `Text` per questo `ListItem`, ma è possibile modificarlo in un altro modo, ad esempio una stringa vuota, se si desidera.</span><span class="sxs-lookup"><span data-stu-id="95e04-201">I ve chosen to use (None) as the `Text` value for this `ListItem`, but you can change it to something else (such as an empty string) if you d like.</span></span> <span data-ttu-id="95e04-202">Infine, ricordarsi di impostare gli DropDownList `AppendDataBoundItems` su `True`; Se si dimentica di eseguire questa operazione, le categorie e i fornitori associati al DropDownList sovrascriveranno il `ListItem`aggiunto in modo statico.</span><span class="sxs-lookup"><span data-stu-id="95e04-202">Finally, remember to set the DropDownLists `AppendDataBoundItems` to `True`; if you forget to do so, the categories and suppliers bound to the DropDownList will overwrite the statically-added `ListItem`.</span></span>

<span data-ttu-id="95e04-203">Dopo aver apportato queste modifiche, il markup di DropDownList nel `EditItemTemplate` di DataList dovrebbe avere un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="95e04-203">After making these changes, the DropDownLists markup in the DataList s `EditItemTemplate` should look similar to the following:</span></span>

[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample5.aspx)]

> [!NOTE]
> <span data-ttu-id="95e04-204">È possibile aggiungere un `ListItem` statico a un oggetto DropDownList tramite la finestra di progettazione o direttamente tramite la sintassi dichiarativa.</span><span class="sxs-lookup"><span data-stu-id="95e04-204">Static `ListItem` s can be added to a DropDownList through the Designer or directly through the declarative syntax.</span></span> <span data-ttu-id="95e04-205">Quando si aggiunge un elemento DropDownList per rappresentare un valore di `NULL` del database, assicurarsi di aggiungere la `ListItem` tramite la sintassi dichiarativa.</span><span class="sxs-lookup"><span data-stu-id="95e04-205">When adding a DropDownList item to represent a database `NULL` value, be sure to add the `ListItem` through the declarative syntax.</span></span> <span data-ttu-id="95e04-206">Se si usa l'editor della raccolta `ListItem` nella finestra di progettazione, la sintassi dichiarativa generata ometterà completamente l'impostazione `Value` quando viene assegnata una stringa vuota, creando markup dichiarativo come: `<asp:ListItem>(None)</asp:ListItem>`.</span><span class="sxs-lookup"><span data-stu-id="95e04-206">If you use the `ListItem` Collection Editor in the Designer, the generated declarative syntax will omit the `Value` setting altogether when assigned a blank string, creating declarative markup like: `<asp:ListItem>(None)</asp:ListItem>`.</span></span> <span data-ttu-id="95e04-207">Sebbene possa sembrare innocuo, il `Value` mancante fa in modo che il DropDownList usi il valore della proprietà `Text` al suo posto.</span><span class="sxs-lookup"><span data-stu-id="95e04-207">While this may look harmless, the missing `Value` causes the DropDownList to use the `Text` property value in its place.</span></span> <span data-ttu-id="95e04-208">Ciò significa che se si seleziona questa `NULL` `ListItem`, il valore (nessuno) verrà tentato di essere assegnato al campo dati prodotto (`CategoryID` o `SupplierID`, in questa esercitazione), che genererà un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="95e04-208">That means that if this `NULL` `ListItem` is selected, the value (None) will be attempted to be assigned to the product data field (`CategoryID` or `SupplierID`, in this tutorial), which will result in an exception.</span></span> <span data-ttu-id="95e04-209">Impostando in modo esplicito `Value=""`, al campo dati prodotto verrà assegnato un valore `NULL` quando viene selezionata la `ListItem` `NULL`.</span><span class="sxs-lookup"><span data-stu-id="95e04-209">By explicitly setting `Value=""`, a `NULL` value will be assigned to the product data field when the `NULL` `ListItem` is selected.</span></span>

<span data-ttu-id="95e04-210">Per visualizzare lo stato di avanzamento, è possibile usare un browser.</span><span class="sxs-lookup"><span data-stu-id="95e04-210">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="95e04-211">Quando si modifica un prodotto, si noti che i `Categories` e i `Suppliers` DropDownList hanno entrambe un'opzione (nessuno) all'inizio del DropDownList.</span><span class="sxs-lookup"><span data-stu-id="95e04-211">When editing a product, note that the `Categories` and `Suppliers` DropDownLists both have a (None) option at the start of the DropDownList.</span></span>

<span data-ttu-id="95e04-212">[![le categorie e i fornitori di DropDownList includono un'opzione (nessuno)](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="95e04-212">[![The Categories and Suppliers DropDownLists include a (None) Option](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span></span>

<span data-ttu-id="95e04-213">**Figura 10**: i controlli DropDownList `Categories` e `Suppliers` includono un'opzione (nessuno) ([fare clic per visualizzare l'immagine con dimensioni complete](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="95e04-213">**Figure 10**: The `Categories` and `Suppliers` DropDownLists include a (None) Option ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span></span>

<span data-ttu-id="95e04-214">Per salvare l'opzione (nessuno) come valore di `NULL` del database, è necessario tornare al gestore dell'evento `UpdateCommand`.</span><span class="sxs-lookup"><span data-stu-id="95e04-214">To save the (None) option as a database `NULL` value, we need to return to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="95e04-215">Modificare le variabili `categoryIDValue` e `supplierIDValue` in modo che siano valori interi nullable e assegnare loro un valore diverso da `Nothing` solo se il `SelectedValue` DropDownList non è una stringa vuota:</span><span class="sxs-lookup"><span data-stu-id="95e04-215">Change the `categoryIDValue` and `supplierIDValue` variables to be nullable integers and assign them a value other than `Nothing` only if the DropDownList s `SelectedValue` is not an empty string:</span></span>

[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample6.vb)]

<span data-ttu-id="95e04-216">Con questa modifica, il valore `Nothing` verrà passato nel metodo `UpdateProduct` BLL se l'utente ha selezionato l'opzione (nessuno) da uno degli elenchi a discesa, che corrisponde a un valore di `NULL` database.</span><span class="sxs-lookup"><span data-stu-id="95e04-216">With this change, a value of `Nothing` will be passed into the `UpdateProduct` BLL method if the user selected the (None) option from either of the drop-down lists, which corresponds to a `NULL` database value.</span></span>

## <a name="summary"></a><span data-ttu-id="95e04-217">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="95e04-217">Summary</span></span>

<span data-ttu-id="95e04-218">In questa esercitazione è stato illustrato come creare un'interfaccia di modifica DataList più complessa che include tre controlli Web di input diversi, una casella di testo, due DropDownList e una casella di controllo insieme ai controlli di convalida.</span><span class="sxs-lookup"><span data-stu-id="95e04-218">In this tutorial we saw how to create a more complex DataList editing interface that included three different input Web controls a TextBox, two DropDownLists, and a CheckBox along with validation controls.</span></span> <span data-ttu-id="95e04-219">Quando si compila l'interfaccia di modifica, i passaggi sono gli stessi indipendentemente dai controlli Web usati: iniziare aggiungendo i controlli Web al `EditItemTemplate`di DataList. utilizzare la sintassi DataBinding per assegnare i valori dei campi dati corrispondenti con le proprietà del controllo Web appropriate. nel gestore dell'evento `UpdateCommand`, ad accedere a livello di codice ai controlli Web e alle relative proprietà appropriate, passando i relativi valori all'oggetto BLL.</span><span class="sxs-lookup"><span data-stu-id="95e04-219">When building the editing interface, the steps are the same regardless of the Web controls being used: start by adding the Web controls to the DataList s `EditItemTemplate`; use databinding syntax to assign the corresponding data field values with the appropriate Web control properties; and, in the `UpdateCommand` event handler, programmatically access the Web controls and their appropriate properties, passing their values into the BLL.</span></span>

<span data-ttu-id="95e04-220">Quando si crea un'interfaccia di modifica, indipendentemente dal fatto che sia costituita solo da caselle di testo o da una raccolta di controlli Web diversi, assicurarsi di gestire correttamente i valori di `NULL` del database.</span><span class="sxs-lookup"><span data-stu-id="95e04-220">When creating an editing interface, whether it s composed of just TextBoxes or a collection of different Web controls, be sure to correctly handle database `NULL` values.</span></span> <span data-ttu-id="95e04-221">Quando si conta `NULL` s, è fondamentale che non si visualizzi correttamente un valore di `NULL` esistente nell'interfaccia di modifica, ma anche che si offra un mezzo per contrassegnare un valore come `NULL`.</span><span class="sxs-lookup"><span data-stu-id="95e04-221">When accounting for `NULL` s, it is imperative that you not only correctly display an existing `NULL` value in the editing interface, but also that you offer a means for marking a value as `NULL`.</span></span> <span data-ttu-id="95e04-222">Per i controlli DropDownList nei DataList, che in genere significano l'aggiunta di un `ListItem` statico la cui proprietà `Value` è impostata in modo esplicito su una stringa vuota (`Value=""`) e sull'aggiunta di un frammento di codice al gestore eventi `UpdateCommand` per determinare se il `NULL``ListItem` è stato selezionato.</span><span class="sxs-lookup"><span data-stu-id="95e04-222">For DropDownLists in DataLists, that typically means adding a static `ListItem` whose `Value` property is explicitly set to an empty string (`Value=""`), and adding a bit of code to the `UpdateCommand` event handler to determine whether or not the `NULL``ListItem` was selected.</span></span>

<span data-ttu-id="95e04-223">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="95e04-223">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="95e04-224">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="95e04-224">About the Author</span></span>

<span data-ttu-id="95e04-225">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="95e04-225">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="95e04-226">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="95e04-226">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="95e04-227">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="95e04-227">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="95e04-228">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="95e04-228">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="95e04-229">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="95e04-229">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="95e04-230">Grazie speciale</span><span class="sxs-lookup"><span data-stu-id="95e04-230">Special Thanks To</span></span>

<span data-ttu-id="95e04-231">Questa serie di esercitazioni è stata esaminata da molti revisori utili.</span><span class="sxs-lookup"><span data-stu-id="95e04-231">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="95e04-232">I revisori del lead per questa esercitazione erano Dennis Patterson, David Suru e Randy Schmidt.</span><span class="sxs-lookup"><span data-stu-id="95e04-232">Lead reviewers for this tutorial were Dennis Patterson, David Suru, and Randy Schmidt.</span></span> <span data-ttu-id="95e04-233">Sei interessato a esaminare i miei prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="95e04-233">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="95e04-234">In tal caso, rilasciare una riga in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="95e04-234">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="95e04-235">Precedente</span><span class="sxs-lookup"><span data-stu-id="95e04-235">Previous</span></span>](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)
