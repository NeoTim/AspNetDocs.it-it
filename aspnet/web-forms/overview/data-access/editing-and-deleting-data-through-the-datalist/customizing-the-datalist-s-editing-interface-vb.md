---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
title: Personalizzazione di DataList di modifica dell'interfaccia (Visual Basic) | Microsoft Docs
author: rick-anderson
description: In questa esercitazione si creerà un'interfaccia di modifica più completa per il controllo DataList, che include controlli DropDownList e una casella di controllo.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: 718628e2-224c-455f-b33a-a41efd48d5a0
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 1c99ce1528b1a28a4ec470a05d62abef6d4bb888
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/17/2019
ms.locfileid: "59391858"
---
# <a name="customizing-the-datalists-editing-interface-vb"></a><span data-ttu-id="8ab16-103">Personalizzazione dell'interfaccia di modifica di DataList (VB)</span><span class="sxs-lookup"><span data-stu-id="8ab16-103">Customizing the DataList's Editing Interface (VB)</span></span>

<span data-ttu-id="8ab16-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8ab16-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8ab16-105">[Scaricare l'App di esempio](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) o [Scarica il PDF](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8ab16-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) or [Download PDF](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span></span>

> <span data-ttu-id="8ab16-106">In questa esercitazione si creerà un'interfaccia di modifica più completa per il controllo DataList, che include controlli DropDownList e una casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="8ab16-106">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span>


## <a name="introduction"></a><span data-ttu-id="8ab16-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="8ab16-107">Introduction</span></span>

<span data-ttu-id="8ab16-108">Il markup e i controlli Web in DataList s `EditItemTemplate` definirne l'interfaccia modificabile.</span><span class="sxs-lookup"><span data-stu-id="8ab16-108">The markup and Web controls in the DataList s `EditItemTemplate` define its editable interface.</span></span> <span data-ttu-id="8ab16-109">In tutti gli esempi DataList modificabili è ve fino ad ora esaminato il modificabile interfaccia è stato composto di controlli Web nella casella di testo.</span><span class="sxs-lookup"><span data-stu-id="8ab16-109">In all of the editable DataList examples we ve examined thus far, the editable interface has been composed of TextBox Web controls.</span></span> <span data-ttu-id="8ab16-110">Nel [esercitazione precedente](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) è stata migliorata l'esperienza utente in fase di modifica mediante l'aggiunta di controlli di convalida.</span><span class="sxs-lookup"><span data-stu-id="8ab16-110">In the [preceding tutorial](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) we improved the edit-time user experience by adding validation controls.</span></span>

<span data-ttu-id="8ab16-111">Il `EditItemTemplate` possono essere ulteriormente ampliato per includere i controlli Web diversi da casella di testo, ad esempio controlli DropDownList, RadioButtonList, calendari e così via.</span><span class="sxs-lookup"><span data-stu-id="8ab16-111">The `EditItemTemplate` can be further expanded to include Web controls other than the TextBox, such as DropDownLists, RadioButtonLists, Calendars, and so on.</span></span> <span data-ttu-id="8ab16-112">Come con caselle di testo, quando si personalizza l'interfaccia di modifica per includere altri controlli Web, utilizzare la procedura seguente:</span><span class="sxs-lookup"><span data-stu-id="8ab16-112">As with TextBoxes, when customizing the editing interface to include other Web controls, employ the following steps:</span></span>

1. <span data-ttu-id="8ab16-113">Aggiungere il controllo Web per il `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="8ab16-113">Add the Web control to the `EditItemTemplate`.</span></span>
2. <span data-ttu-id="8ab16-114">Usare la sintassi di associazione dati per assegnare il valore del campo data corrispondente alla proprietà appropriata.</span><span class="sxs-lookup"><span data-stu-id="8ab16-114">Use databinding syntax to assign the corresponding data field value to the appropriate property.</span></span>
3. <span data-ttu-id="8ab16-115">Nel `UpdateCommand` gestore dell'evento, l'accesso a livello di programmazione Web valore controllato e passarlo al metodo BLL appropriato.</span><span class="sxs-lookup"><span data-stu-id="8ab16-115">In the `UpdateCommand` event handler, programmatically access the Web control value and pass it into the appropriate BLL method.</span></span>

<span data-ttu-id="8ab16-116">In questa esercitazione si creerà un'interfaccia di modifica più completa per il controllo DataList, che include controlli DropDownList e una casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="8ab16-116">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span> <span data-ttu-id="8ab16-117">In particolare, verrà creato un controllo DataList che elenca le informazioni sul prodotto e consente la s nome prodotto, fornitore, categoria e lo stato non più supportato da aggiornare (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="8ab16-117">In particular, we'll create a DataList that lists product information and permits the product s name, supplier, category, and discontinued status to be updated (see Figure 1).</span></span>


<span data-ttu-id="8ab16-118">[![L'interfaccia di modifica include un controllo TextBox, due controlli DropDownList e una casella di controllo](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8ab16-118">[![The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="8ab16-119">**Figura 1**: L'interfaccia di modifica include un controllo TextBox, due controlli DropDownList e una casella di controllo ([fare clic per visualizzare l'immagine con dimensioni normali](customizing-the-datalist-s-editing-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="8ab16-119">**Figure 1**: The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>


## <a name="step-1-displaying-product-information"></a><span data-ttu-id="8ab16-120">Passaggio 1: Visualizzazione di informazioni sul prodotto</span><span class="sxs-lookup"><span data-stu-id="8ab16-120">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="8ab16-121">Prima di poter creare l'interfaccia modificabile s DataList, è innanzitutto necessario compilare l'interfaccia di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="8ab16-121">Before we can create the DataList s editable interface, we first need to build the read-only interface.</span></span> <span data-ttu-id="8ab16-122">Iniziare aprendo il `CustomizedUI.aspx` pagina dal `EditDeleteDataList` cartella e, dalla finestra di progettazione, aggiungere un controllo DataList alla pagina, l'impostazione relativa `ID` proprietà `Products`.</span><span class="sxs-lookup"><span data-stu-id="8ab16-122">Start by opening the `CustomizedUI.aspx` page from the `EditDeleteDataList` folder and, from the Designer, add a DataList to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="8ab16-123">DataList s nello smart tag, creare un nuovo oggetto ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="8ab16-123">From the DataList s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="8ab16-124">Denominare il nuovo oggetto ObjectDataSource `ProductsDataSource` e configurarlo per recuperare i dati di `ProductsBLL` classe s `GetProducts` (metodo).</span><span class="sxs-lookup"><span data-stu-id="8ab16-124">Name this new ObjectDataSource `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="8ab16-125">Come con le esercitazioni di DataList modificabile precedente, verrà aggiornato le informazioni di prodotto modificato s accedendo direttamente al livello della logica di Business.</span><span class="sxs-lookup"><span data-stu-id="8ab16-125">As with the previous editable DataList tutorials, we'll update the edited product s information by going directly to the Business Logic Layer.</span></span> <span data-ttu-id="8ab16-126">Di conseguenza, impostare gli elenchi a discesa nell'aggiornamento, inserimento ed eliminare schede su (nessuno).</span><span class="sxs-lookup"><span data-stu-id="8ab16-126">Accordingly, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span>


<span data-ttu-id="8ab16-127">[![Impostare gli elenchi di riepilogo a discesa schede DELETE, INSERT e UPDATE su (nessuno)](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="8ab16-127">[![Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None)](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="8ab16-128">**Figura 2**: Impostare l'UPDATE, INSERT e DELETE schede elenco a discesa Elenca su (nessuno) ([fare clic per visualizzare l'immagine con dimensioni normali](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="8ab16-128">**Figure 2**: Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>


<span data-ttu-id="8ab16-129">Dopo la configurazione di ObjectDataSource, Visual Studio creerà predefinito `ItemTemplate` per il controllo DataList che elenca il nome e il valore per ognuno dei campi di dati restituito.</span><span class="sxs-lookup"><span data-stu-id="8ab16-129">After configuring the ObjectDataSource, Visual Studio will create a default `ItemTemplate` for the DataList that lists the name and value for each of the data fields returned.</span></span> <span data-ttu-id="8ab16-130">Modificare il `ItemTemplate` in modo che il modello viene elencato il nome di prodotto in un `<h4>` elemento con il nome della categoria, nome del fornitore, prezzo e lo stato non più utilizzato.</span><span class="sxs-lookup"><span data-stu-id="8ab16-130">Modify the `ItemTemplate` so that the template lists the product name in an `<h4>` element along with the category name, supplier name, price, and discontinued status.</span></span> <span data-ttu-id="8ab16-131">Inoltre, aggiungere un pulsante di modifica, assicurandosi che relativo `CommandName` è impostata su Modifica.</span><span class="sxs-lookup"><span data-stu-id="8ab16-131">Moreover, add an Edit button, making sure that its `CommandName` property is set to Edit.</span></span> <span data-ttu-id="8ab16-132">Il markup dichiarativo per la mia `ItemTemplate` segue:</span><span class="sxs-lookup"><span data-stu-id="8ab16-132">The declarative markup for my `ItemTemplate` follows:</span></span>


[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="8ab16-133">Il markup riportato sopra viene disposto l'informazioni di prodotto usando un &lt;h4&gt; intestazione per il nome del prodotto s e una colonna di quattro `<table>` per i campi rimanenti.</span><span class="sxs-lookup"><span data-stu-id="8ab16-133">The above markup lays out the product information using an &lt;h4&gt; heading for the product s name and a four-column `<table>` for the remaining fields.</span></span> <span data-ttu-id="8ab16-134">Il `ProductPropertyLabel` e `ProductPropertyValue` classi CSS, definite in `Styles.css`, sono stati trattati nelle esercitazioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="8ab16-134">The `ProductPropertyLabel` and `ProductPropertyValue` CSS classes, defined in `Styles.css`, have been discussed in previous tutorials.</span></span> <span data-ttu-id="8ab16-135">Figura 3 mostra lo stato di avanzamento quando viene visualizzato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="8ab16-135">Figure 3 shows our progress when viewed through a browser.</span></span>


<span data-ttu-id="8ab16-136">[![Viene visualizzato il nome, fornitore, categoria, lo stato non più utilizzate e prezzo di ogni prodotto](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="8ab16-136">[![The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="8ab16-137">**Figura 3**: Viene visualizzato il nome, fornitore, categoria, lo stato non più utilizzate e prezzo di ogni prodotto ([fare clic per visualizzare l'immagine con dimensioni normali](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="8ab16-137">**Figure 3**: The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>


## <a name="step-2-adding-the-web-controls-to-the-editing-interface"></a><span data-ttu-id="8ab16-138">Passaggio 2: Aggiunta dei controlli Web per l'interfaccia di modifica</span><span class="sxs-lookup"><span data-stu-id="8ab16-138">Step 2: Adding the Web Controls to the Editing Interface</span></span>

<span data-ttu-id="8ab16-139">Il primo passaggio nella creazione di DataList personalizzato interfaccia per la modifica consiste nell'aggiungere i controlli Web necessari per il `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="8ab16-139">The first step in building the customized DataList editing interface is to add the needed Web controls to the `EditItemTemplate`.</span></span> <span data-ttu-id="8ab16-140">In particolare, è necessario un controllo DropDownList per la categoria, un altro per il fornitore e una casella di controllo per lo stato non più utilizzato.</span><span class="sxs-lookup"><span data-stu-id="8ab16-140">In particular, we need a DropDownList for the category, another for the supplier, and a CheckBox for the discontinued state.</span></span> <span data-ttu-id="8ab16-141">Poiché il prezzo del prodotto s non può essere modificato in questo esempio, è possibile continuare la visualizzazione usando un controllo etichetta Web.</span><span class="sxs-lookup"><span data-stu-id="8ab16-141">Since the product s price is not editable in this example, we can continue displaying it using a Label Web control.</span></span>

<span data-ttu-id="8ab16-142">Per personalizzare l'interfaccia di modifica, fare clic sul collegamento di modifica modelli dello smart tag DataList s e scegliere il `EditItemTemplate` opzione nell'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="8ab16-142">To customize the editing interface, click on the Edit Templates link from the DataList s smart tag and choose the `EditItemTemplate` option from the drop-down list.</span></span> <span data-ttu-id="8ab16-143">Aggiungere un controllo DropDownList per il `EditItemTemplate` e impostare relativi `ID` a `Categories`.</span><span class="sxs-lookup"><span data-stu-id="8ab16-143">Add a DropDownList to the `EditItemTemplate` and set its `ID` to `Categories`.</span></span>


<span data-ttu-id="8ab16-144">[![Aggiungere un controllo DropDownList per le categorie](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="8ab16-144">[![Add a DropDownList for the Categories](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="8ab16-145">**Figura 4**: Aggiungere un controllo DropDownList per le categorie ([fare clic per visualizzare l'immagine con dimensioni normali](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="8ab16-145">**Figure 4**: Add a DropDownList for the Categories ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>


<span data-ttu-id="8ab16-146">Successivamente, DropDownList s nello smart tag, selezionare l'opzione Scegli origine dati e creare un nuovo oggetto ObjectDataSource denominato `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8ab16-146">Next, from the DropDownList s smart tag, select the Choose Data Source option and create a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="8ab16-147">Configurare ObjectDataSource per usare la `CategoriesBLL` classe s `GetCategories()` (metodo) (vedere la figura 5).</span><span class="sxs-lookup"><span data-stu-id="8ab16-147">Configure this ObjectDataSource to use the `CategoriesBLL` class s `GetCategories()` method (see Figure 5).</span></span> <span data-ttu-id="8ab16-148">Successivamente, la s DropDownList chiede di configurazione guidata origine dati per i campi di dati da usare per ognuno `ListItem` s `Text` e `Value` proprietà.</span><span class="sxs-lookup"><span data-stu-id="8ab16-148">Next, the DropDownList s Data Source Configuration Wizard prompts for the data fields to use for each `ListItem` s `Text` and `Value` properties.</span></span> <span data-ttu-id="8ab16-149">La visualizzazione DropDownList il `CategoryName` campo dati e usare il `CategoryID` come valore, come illustrato nella figura 6.</span><span class="sxs-lookup"><span data-stu-id="8ab16-149">Have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value, as shown in Figure 6.</span></span>


<span data-ttu-id="8ab16-150">[![Creare un nuovo oggetto ObjectDataSource denominato CategoriesDataSource](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="8ab16-150">[![Create a New ObjectDataSource Named CategoriesDataSource](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="8ab16-151">**Figura 5**: Creare un nuovo oggetto ObjectDataSource denominato `CategoriesDataSource` ([fare clic per visualizzare l'immagine con dimensioni normali](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="8ab16-151">**Figure 5**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>


<span data-ttu-id="8ab16-152">[![Configurare la visualizzazione di s DropDownList e il valore di campi](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="8ab16-152">[![Configure the DropDownList s Display and Value Fields](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="8ab16-153">**Figura 6**: Configurare il controllo DropDownList s visualizzato e i campi dei valori ([fare clic per visualizzare l'immagine con dimensioni normali](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="8ab16-153">**Figure 6**: Configure the DropDownList s Display and Value Fields ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>


<span data-ttu-id="8ab16-154">Ripetere questa serie di passaggi per creare un controllo DropDownList per i fornitori.</span><span class="sxs-lookup"><span data-stu-id="8ab16-154">Repeat this series of steps to create a DropDownList for the suppliers.</span></span> <span data-ttu-id="8ab16-155">Impostare il `ID` per questo controllo DropDownList per `Suppliers` e assegnare un nome relativo ObjectDataSource `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8ab16-155">Set the `ID` for this DropDownList to `Suppliers` and name its ObjectDataSource `SuppliersDataSource`.</span></span>

<span data-ttu-id="8ab16-156">Dopo aver aggiunto i due controlli DropDownList, aggiungere una casella di controllo per lo stato non più utilizzato e una casella di testo per il nome del prodotto s.</span><span class="sxs-lookup"><span data-stu-id="8ab16-156">After adding the two DropDownLists, add a CheckBox for the discontinued state and a TextBox for the product s name.</span></span> <span data-ttu-id="8ab16-157">Impostare il `ID` per la casella di controllo e casella di testo `Discontinued` e `ProductName`, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="8ab16-157">Set the `ID` s for the CheckBox and TextBox to `Discontinued` and `ProductName`, respectively.</span></span> <span data-ttu-id="8ab16-158">Aggiungere un RequiredFieldValidator per assicurarsi che l'utente fornisce un valore per il nome del prodotto s.</span><span class="sxs-lookup"><span data-stu-id="8ab16-158">Add a RequiredFieldValidator to ensure that the user provides a value for the product s name.</span></span>

<span data-ttu-id="8ab16-159">Infine, aggiungere i pulsanti Annulla e Update.</span><span class="sxs-lookup"><span data-stu-id="8ab16-159">Lastly, add the Update and Cancel buttons.</span></span> <span data-ttu-id="8ab16-160">Tenere presente che per questi due pulsanti è fondamentale che loro `CommandName` proprietà vengono impostate per aggiornare e annullare, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="8ab16-160">Remember that for these two buttons it is imperative that their `CommandName` properties are set to Update and Cancel, respectively.</span></span>

<span data-ttu-id="8ab16-161">È possibile definire il layout di interfaccia di modifica, tuttavia si desidera.</span><span class="sxs-lookup"><span data-stu-id="8ab16-161">Feel free to lay out the editing interface however you like.</span></span> <span data-ttu-id="8ab16-162">Ho scelto di usare lo stesso quattro colonne ve `<table>` layout dall'interfaccia di sola lettura, come la seguente sintassi dichiarativa e screenshot illustra:</span><span class="sxs-lookup"><span data-stu-id="8ab16-162">I ve opted to use the same four-column `<table>` layout from the read-only interface, as the following declarative syntax and screen shot illustrates:</span></span>


[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample2.aspx)]


<span data-ttu-id="8ab16-163">[![L'interfaccia di modifica non è più Laid valido, ad esempio l'interfaccia di sola lettura](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="8ab16-163">[![The Editing Interface is Laid Out like the Read-Only Interface](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span></span>

<span data-ttu-id="8ab16-164">**Figura 7**: L'interfaccia di modifica non è più Laid valido, ad esempio l'interfaccia di sola lettura ([fare clic per visualizzare l'immagine con dimensioni normali](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="8ab16-164">**Figure 7**: The Editing Interface is Laid Out like the Read-Only Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span></span>


## <a name="step-3-creating-the-editcommand-and-cancelcommand-event-handlers"></a><span data-ttu-id="8ab16-165">Passaggio 3: Creazione del EditCommand e gestori eventi CancelCommand</span><span class="sxs-lookup"><span data-stu-id="8ab16-165">Step 3: Creating the EditCommand and CancelCommand Event Handlers</span></span>

<span data-ttu-id="8ab16-166">Attualmente non è disponibile alcuna sintassi di associazione dati nel `EditItemTemplate` (tranne che per il `UnitPriceLabel`, che è stato copiato su verbatim dal `ItemTemplate`).</span><span class="sxs-lookup"><span data-stu-id="8ab16-166">Currently, there is no databinding syntax in the `EditItemTemplate` (except for the `UnitPriceLabel`, which was copied over verbatim from the `ItemTemplate`).</span></span> <span data-ttu-id="8ab16-167">Aggiungiamo, quindi la sintassi di associazione dati momentaneamente, ma ti permettono di primo s creare i gestori eventi per s DataList `EditCommand` e `CancelCommand` eventi.</span><span class="sxs-lookup"><span data-stu-id="8ab16-167">We'll add the databinding syntax momentarily, but first let s create the event handlers for the DataList s `EditCommand` and `CancelCommand` events.</span></span> <span data-ttu-id="8ab16-168">Si tenga presente che la responsabilità del `EditCommand` gestore dell'evento è rendere l'interfaccia di modifica per l'elemento DataList è stato fatto clic sul pulsante la cui modifica, mentre il `CancelCommand` processo s consiste nel ripristinare lo stato pre-modifica di DataList.</span><span class="sxs-lookup"><span data-stu-id="8ab16-168">Recall that the responsibility of the `EditCommand` event handler is to render the editing interface for the DataList item whose Edit button was clicked, whereas the `CancelCommand` s job is to return the DataList to its pre-editing state.</span></span>

<span data-ttu-id="8ab16-169">Creare questi due gestori di eventi e richiedere loro di utilizzare il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="8ab16-169">Create these two event handlers and have them use the following code:</span></span>


[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample3.vb)]

<span data-ttu-id="8ab16-170">Con questi due gestori di eventi sul posto, facendo clic sul pulsante Modifica consente di visualizzare l'interfaccia di modifica e facendo clic sul pulsante di annullamento restituisce l'elemento modificato per la modalità di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="8ab16-170">With these two event handlers in place, clicking the Edit button displays the editing interface and clicking the Cancel button returns the edited item to its read-only mode.</span></span> <span data-ttu-id="8ab16-171">Figura 8 Mostra DataList dopo che il pulsante Modifica è stato fatto clic per s Chef Anton's Gumbo Mix.</span><span class="sxs-lookup"><span data-stu-id="8ab16-171">Figure 8 shows the DataList after the Edit button has been clicked for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="8ab16-172">Poiché abbiamo ve ancora per aggiungere una sintassi di associazione dati all'interfaccia di modifica, il `ProductName` nella casella di testo è vuota, il `Discontinued` selezionati dalla casella di controllo è deselezionata e i primi elementi il `Categories` e `Suppliers` controlli DropDownList.</span><span class="sxs-lookup"><span data-stu-id="8ab16-172">Since we ve yet to add any databinding syntax to the editing interface, the `ProductName` TextBox is blank, the `Discontinued` CheckBox unchecked, and the first items selected from the `Categories` and `Suppliers` DropDownLists.</span></span>


<span data-ttu-id="8ab16-173">[![Facendo clic su verrà visualizzato il pulsante Modifica l'interfaccia di modifica](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="8ab16-173">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span></span>

<span data-ttu-id="8ab16-174">**Figura 8**: Facendo clic sul pulsante Modifica consente di visualizzare l'interfaccia di modifica ([fare clic per visualizzare l'immagine con dimensioni normali](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="8ab16-174">**Figure 8**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span></span>


## <a name="step-4-adding-the-databinding-syntax-to-the-editing-interface"></a><span data-ttu-id="8ab16-175">Passaggio 4: Aggiunta della sintassi di associazione dati all'interfaccia di modifica</span><span class="sxs-lookup"><span data-stu-id="8ab16-175">Step 4: Adding the DataBinding Syntax to the Editing Interface</span></span>

<span data-ttu-id="8ab16-176">Per visualizzare i valori correnti di s prodotto l'interfaccia di modifica, è necessario usare la sintassi di associazione dati per assegnare i valori dei campi dati per i valori del controllo Web appropriati.</span><span class="sxs-lookup"><span data-stu-id="8ab16-176">To have the editing interface display the current product s values, we need to use databinding syntax to assign the data field values to the appropriate Web control values.</span></span> <span data-ttu-id="8ab16-177">La sintassi di associazione dati possono essere applicata tramite la finestra di progettazione, passare alla schermata di modifica modelli e selezionando il collegamento di Modifica DataBindings dal Web controlla gli smart tag.</span><span class="sxs-lookup"><span data-stu-id="8ab16-177">The databinding syntax can be applied through the Designer by going to the Edit Templates screen and selecting the Edit DataBindings link from the Web controls smart tags.</span></span> <span data-ttu-id="8ab16-178">In alternativa, è possibile aggiungere la sintassi di associazione dati direttamente al markup dichiarativo.</span><span class="sxs-lookup"><span data-stu-id="8ab16-178">Alternatively, the databinding syntax can be added directly to the declarative markup.</span></span>

<span data-ttu-id="8ab16-179">Assegnare il `ProductName` valore del campo dati il `ProductName` s nella casella di testo `Text` proprietà, il `CategoryID` e `SupplierID` datové pole i valori per i `Categories` e `Suppliers` controlli DropDownList `SelectedValue` proprietà e il `Discontinued` valore del campo dati il `Discontinued` casella di controllo s `Checked` proprietà.</span><span class="sxs-lookup"><span data-stu-id="8ab16-179">Assign the `ProductName` data field value to the `ProductName` TextBox s `Text` property, the `CategoryID` and `SupplierID` data field values to the `Categories` and `Suppliers` DropDownLists `SelectedValue` properties, and the `Discontinued` data field value to the `Discontinued` CheckBox s `Checked` property.</span></span> <span data-ttu-id="8ab16-180">Dopo aver apportato queste modifiche, tramite la finestra di progettazione o direttamente tramite markup dichiarativo, visitare di nuovo la pagina tramite un browser e fare clic sul pulsante Modifica per s Chef Anton's Gumbo Mix.</span><span class="sxs-lookup"><span data-stu-id="8ab16-180">After making these changes, either through the Designer or directly through the declarative markup, revisit the page through a browser and click the Edit button for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="8ab16-181">Come illustrato nella figura 9, la sintassi di data binding ha aggiunto i valori correnti di casella di testo e controlli DropDownList e casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="8ab16-181">As Figure 9 shows, the databinding syntax has added the current values into the TextBox, DropDownLists, and CheckBox.</span></span>


<span data-ttu-id="8ab16-182">[![Facendo clic su verrà visualizzato il pulsante Modifica l'interfaccia di modifica](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="8ab16-182">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span></span>

<span data-ttu-id="8ab16-183">**Figura 9**: Facendo clic sul pulsante Modifica consente di visualizzare l'interfaccia di modifica ([fare clic per visualizzare l'immagine con dimensioni normali](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="8ab16-183">**Figure 9**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span></span>


## <a name="step-5-saving-the-user-s-changes-in-the-updatecommand-event-handler"></a><span data-ttu-id="8ab16-184">Passaggio 5: Salvataggio delle modifiche s utente nel gestore dell'evento UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="8ab16-184">Step 5: Saving the User s Changes in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="8ab16-185">Quando l'utente modifica un prodotto e fa clic sul pulsante di aggiornamento, si verifica un postback e DataList s `UpdateCommand` viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="8ab16-185">When the user edits a product and clicks the Update button, a postback occurs and the DataList s `UpdateCommand` event fires.</span></span> <span data-ttu-id="8ab16-186">Nell'evento gestore, è necessario leggere i valori dai controlli Web nel `EditItemTemplate` e l'interfaccia con il livello BLL per aggiornare il prodotto nel database.</span><span class="sxs-lookup"><span data-stu-id="8ab16-186">In the event handler, we need to read the values from the Web controls in the `EditItemTemplate` and interface with the BLL to update the product in the database.</span></span> <span data-ttu-id="8ab16-187">Come abbiamo ve illustrata nelle esercitazioni precedenti, il `ProductID` del prodotto aggiornato è accessibile tramite il `DataKeys` raccolta.</span><span class="sxs-lookup"><span data-stu-id="8ab16-187">As we ve seen in previous tutorials, the `ProductID` of the updated product is accessible through the `DataKeys` collection.</span></span> <span data-ttu-id="8ab16-188">I campi immesso dall'utente sono accessibili facendo riferimento a livello di codice i controlli Web usando `FindControl("controlID")`, come illustrato nel codice seguente:</span><span class="sxs-lookup"><span data-stu-id="8ab16-188">The user-entered fields are accessed by programmatically referencing the Web controls using `FindControl("controlID")`, as the following code shows:</span></span>


[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample4.vb)]

<span data-ttu-id="8ab16-189">Il codice inizia consultando il `Page.IsValid` proprietà per assicurarsi che tutti i controlli di convalida nella pagina siano validi.</span><span class="sxs-lookup"><span data-stu-id="8ab16-189">The code starts out by consulting the `Page.IsValid` property to ensure that all the validation controls on the page are valid.</span></span> <span data-ttu-id="8ab16-190">Se `Page.IsValid` viene `True`, il prodotto modificato s `ProductID` valore viene letto dal `DataKeys` raccolta e l'inserimento dei dati in cui i controlli Web il `EditItemTemplate` fanno riferimento a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="8ab16-190">If `Page.IsValid` is `True`, the edited product s `ProductID` value is read from the `DataKeys` collection and the data entry Web controls in the `EditItemTemplate` are programmatically referenced.</span></span> <span data-ttu-id="8ab16-191">Successivamente, vengono letti i valori di questi controlli Web in variabili che vengono quindi passate in appropriato `UpdateProduct` rapporto di overload.</span><span class="sxs-lookup"><span data-stu-id="8ab16-191">Next, the values from these Web controls are read into variables that are then passed into the appropriate `UpdateProduct` overload.</span></span> <span data-ttu-id="8ab16-192">Dopo l'aggiornamento dei dati, DataList viene restituito lo stato di pre-editing.</span><span class="sxs-lookup"><span data-stu-id="8ab16-192">After updating the data, the DataList is returned to its pre-editing state.</span></span>

> [!NOTE]
> <span data-ttu-id="8ab16-193">Ho ve omesso aggiunta una logica di gestione delle eccezioni di [BLL - la gestione e le eccezioni a livello DAL](handling-bll-and-dal-level-exceptions-vb.md) esercitazione per mantenere il codice e in questo esempio con stato attivo.</span><span class="sxs-lookup"><span data-stu-id="8ab16-193">I ve omitted the exception handling logic added in the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial in order to keep the code and this example focused.</span></span> <span data-ttu-id="8ab16-194">Come esercizio, aggiungere questa funzionalità dopo aver completato questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="8ab16-194">As an exercise, add this functionality after completing this tutorial.</span></span>


## <a name="step-6-handling-null-categoryid-and-supplierid-values"></a><span data-ttu-id="8ab16-195">Passaggio 6: Gestire CategoryID NULL e valori di ID fornitore</span><span class="sxs-lookup"><span data-stu-id="8ab16-195">Step 6: Handling NULL CategoryID and SupplierID Values</span></span>

<span data-ttu-id="8ab16-196">Consente di Northwind `NULL` i valori per il `Products` tabella s `CategoryID` e `SupplierID` colonne.</span><span class="sxs-lookup"><span data-stu-id="8ab16-196">The Northwind database allows for `NULL` values for the `Products` table s `CategoryID` and `SupplierID` columns.</span></span> <span data-ttu-id="8ab16-197">Tuttavia, la modifica t l interfaccia adattare attualmente `NULL` valori.</span><span class="sxs-lookup"><span data-stu-id="8ab16-197">However, our editing interface doesn t currently accommodate `NULL` values.</span></span> <span data-ttu-id="8ab16-198">Se si tenta di modificare un prodotto che ha un `NULL` valore per uno relativo `CategoryID` o `SupplierID` le colonne, si otterrà un `ArgumentOutOfRangeException` con un messaggio di errore simile a: *'Categorie' ha un SelectedValue che non è valido perché non esiste nell'elenco di elementi.*</span><span class="sxs-lookup"><span data-stu-id="8ab16-198">If we attempt to edit a product that has a `NULL` value for either its `CategoryID` or `SupplierID` columns, we'll get an `ArgumentOutOfRangeException` with an error message similar to: *'Categories' has a SelectedValue which is invalid because it does not exist in the list of items.*</span></span> <span data-ttu-id="8ab16-199">Inoltre, 3!s ci attualmente alcuna possibilità di modificare una categoria di prodotto s o un fornitore non valore da un non -`NULL` valore per un `NULL` uno.</span><span class="sxs-lookup"><span data-stu-id="8ab16-199">Also, there s currently no way to change a product s category or supplier value from a non-`NULL` value to a `NULL` one.</span></span>

<span data-ttu-id="8ab16-200">Per supportare `NULL` i valori per la categoria e il fornitore controlli DropDownList, dobbiamo aggiungere un ulteriore `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="8ab16-200">To support `NULL` values for the category and supplier DropDownLists, we need to add an additional `ListItem`.</span></span> <span data-ttu-id="8ab16-201">Ho ve scelta di usare (nessuno) come il `Text` un valore per questo `ListItem`, ma è possibile modificarlo per qualcos'altro (ad esempio, una stringa vuota) se è il d soddisfacente.</span><span class="sxs-lookup"><span data-stu-id="8ab16-201">I ve chosen to use (None) as the `Text` value for this `ListItem`, but you can change it to something else (such as an empty string) if you d like.</span></span> <span data-ttu-id="8ab16-202">Infine, ricordarsi di impostare i controlli DropDownList `AppendDataBoundItems` al `True`; se si dimentica di eseguire questa operazione, le categorie e fornitori associati a DropDownList sovrascrive l'oggetto aggiunto in modo statico `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="8ab16-202">Finally, remember to set the DropDownLists `AppendDataBoundItems` to `True`; if you forget to do so, the categories and suppliers bound to the DropDownList will overwrite the statically-added `ListItem`.</span></span>

<span data-ttu-id="8ab16-203">Dopo aver apportato queste modifiche, il markup controlli DropDownList in DataList s `EditItemTemplate` dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="8ab16-203">After making these changes, the DropDownLists markup in the DataList s `EditItemTemplate` should look similar to the following:</span></span>


[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample5.aspx)]

> [!NOTE]
> <span data-ttu-id="8ab16-204">Statico `ListItem` s può essere aggiunto a un controllo DropDownList tramite la finestra di progettazione o direttamente tramite la sintassi dichiarativa.</span><span class="sxs-lookup"><span data-stu-id="8ab16-204">Static `ListItem` s can be added to a DropDownList through the Designer or directly through the declarative syntax.</span></span> <span data-ttu-id="8ab16-205">Quando si aggiunge un elemento DropDownList per rappresentare un database `NULL` valore, assicurarsi di aggiungere il `ListItem` tramite la sintassi dichiarativa.</span><span class="sxs-lookup"><span data-stu-id="8ab16-205">When adding a DropDownList item to represent a database `NULL` value, be sure to add the `ListItem` through the declarative syntax.</span></span> <span data-ttu-id="8ab16-206">Se si usa la `ListItem` Editor della raccolta nella finestra di progettazione, la sintassi dichiarativa generata ometterà il `Value` impostazione completamente quando assegnato a una stringa vuota, la creazione di markup dichiarativo simile a quello: `<asp:ListItem>(None)</asp:ListItem>`.</span><span class="sxs-lookup"><span data-stu-id="8ab16-206">If you use the `ListItem` Collection Editor in the Designer, the generated declarative syntax will omit the `Value` setting altogether when assigned a blank string, creating declarative markup like: `<asp:ListItem>(None)</asp:ListItem>`.</span></span> <span data-ttu-id="8ab16-207">Anche se ciò potrebbe avere un aspetto innocuo, parametro mancante `Value` fa sì che il controllo DropDownList usare il `Text` valore della proprietà al suo posto.</span><span class="sxs-lookup"><span data-stu-id="8ab16-207">While this may look harmless, the missing `Value` causes the DropDownList to use the `Text` property value in its place.</span></span> <span data-ttu-id="8ab16-208">Ciò significa che se si `NULL` `ListItem` è selezionata, il valore (nessuno) verrà tentato da assegnare al campo dati del prodotto (`CategoryID` o `SupplierID`, in questa esercitazione), che genererà un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="8ab16-208">That means that if this `NULL` `ListItem` is selected, the value (None) will be attempted to be assigned to the product data field (`CategoryID` or `SupplierID`, in this tutorial), which will result in an exception.</span></span> <span data-ttu-id="8ab16-209">Impostando in modo esplicito `Value=""`, una `NULL` valore verrà assegnato il prodotto del campo dati quando il `NULL` `ListItem` sia selezionata.</span><span class="sxs-lookup"><span data-stu-id="8ab16-209">By explicitly setting `Value=""`, a `NULL` value will be assigned to the product data field when the `NULL` `ListItem` is selected.</span></span>


<span data-ttu-id="8ab16-210">Si consiglia di visualizzare lo stato di avanzamento tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="8ab16-210">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="8ab16-211">Quando si modifica un prodotto, si noti che il `Categories` e `Suppliers` dispone di due controlli DropDownList (nessuno) opzione all'inizio di DropDownList.</span><span class="sxs-lookup"><span data-stu-id="8ab16-211">When editing a product, note that the `Categories` and `Suppliers` DropDownLists both have a (None) option at the start of the DropDownList.</span></span>


<span data-ttu-id="8ab16-212">[![Le categorie e controlli DropDownList fornitori includono (nessuna) opzione](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="8ab16-212">[![The Categories and Suppliers DropDownLists include a (None) Option](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span></span>

<span data-ttu-id="8ab16-213">**Figura 10**: Il `Categories` e `Suppliers` controlli DropDownList includono (nessuna) opzione ([fare clic per visualizzare l'immagine con dimensioni normali](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="8ab16-213">**Figure 10**: The `Categories` and `Suppliers` DropDownLists include a (None) Option ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span></span>


<span data-ttu-id="8ab16-214">Salvare opzione (nessuno) come un database `NULL` valore, è necessario restituire il `UpdateCommand` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="8ab16-214">To save the (None) option as a database `NULL` value, we need to return to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="8ab16-215">Modifica il `categoryIDValue` e `supplierIDValue` variabili integer nullable e assegnarle un valore diverso da `Nothing` solo se s DropDownList `SelectedValue` non è una stringa vuota:</span><span class="sxs-lookup"><span data-stu-id="8ab16-215">Change the `categoryIDValue` and `supplierIDValue` variables to be nullable integers and assign them a value other than `Nothing` only if the DropDownList s `SelectedValue` is not an empty string:</span></span>


[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample6.vb)]

<span data-ttu-id="8ab16-216">Con questa modifica, un valore pari `Nothing` verranno passati i `UpdateProduct` metodo BLL se l'utente selezionato (nessuno) opzione da uno degli elenchi di riepilogo a discesa, che corrisponde a un `NULL` valore del database.</span><span class="sxs-lookup"><span data-stu-id="8ab16-216">With this change, a value of `Nothing` will be passed into the `UpdateProduct` BLL method if the user selected the (None) option from either of the drop-down lists, which corresponds to a `NULL` database value.</span></span>

## <a name="summary"></a><span data-ttu-id="8ab16-217">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="8ab16-217">Summary</span></span>

<span data-ttu-id="8ab16-218">In questa esercitazione è stato illustrato come creare un'interfaccia di modifica DataList più complessa che include tre diversi controlli di Web inpui una casella di testo, due controlli DropDownList e una casella di controllo con i controlli di convalida.</span><span class="sxs-lookup"><span data-stu-id="8ab16-218">In this tutorial we saw how to create a more complex DataList editing interface that included three different input Web controls a TextBox, two DropDownLists, and a CheckBox along with validation controls.</span></span> <span data-ttu-id="8ab16-219">Quando si compila l'interfaccia di modifica, i passaggi sono gli stessi indipendentemente dal fatto di controlli Web in uso: iniziare aggiungendo i controlli Web per il controllo DataList s `EditItemTemplate`; usare la sintassi di associazione dati per assegnare i valori dei campi dati corrispondenti con il Web in modo appropriato controllo proprietà. e, nella `UpdateCommand` gestore eventi, accedere a livello di codice i controlli Web e le relative proprietà appropriato, passando i relativi valori nel livello BLL.</span><span class="sxs-lookup"><span data-stu-id="8ab16-219">When building the editing interface, the steps are the same regardless of the Web controls being used: start by adding the Web controls to the DataList s `EditItemTemplate`; use databinding syntax to assign the corresponding data field values with the appropriate Web control properties; and, in the `UpdateCommand` event handler, programmatically access the Web controls and their appropriate properties, passing their values into the BLL.</span></span>

<span data-ttu-id="8ab16-220">Quando si crea un'interfaccia di modifica, se si s è composto da solo nelle caselle di testo o una raccolta di controlli Web diversi, assicurarsi di gestire correttamente i database `NULL` valori.</span><span class="sxs-lookup"><span data-stu-id="8ab16-220">When creating an editing interface, whether it s composed of just TextBoxes or a collection of different Web controls, be sure to correctly handle database `NULL` values.</span></span> <span data-ttu-id="8ab16-221">Quando tenendo conto dei `NULL` s, è fondamentale non solo correttamente visualizzare esistente `NULL` valore l'interfaccia di modifica, ma anche che si offrono un modo per contrassegnare un valore come `NULL`.</span><span class="sxs-lookup"><span data-stu-id="8ab16-221">When accounting for `NULL` s, it is imperative that you not only correctly display an existing `NULL` value in the editing interface, but also that you offer a means for marking a value as `NULL`.</span></span> <span data-ttu-id="8ab16-222">Per controlli DropDownList in DataList, che in genere significa aggiungere un valore statico `ListItem` la cui `Value` proprietà è impostata esplicitamente su una stringa vuota (`Value=""`) e l'aggiunta di un frammento di codice per il `UpdateCommand` gestore dell'evento per determinare o meno il `NULL``ListItem` è stato selezionato.</span><span class="sxs-lookup"><span data-stu-id="8ab16-222">For DropDownLists in DataLists, that typically means adding a static `ListItem` whose `Value` property is explicitly set to an empty string (`Value=""`), and adding a bit of code to the `UpdateCommand` event handler to determine whether or not the `NULL``ListItem` was selected.</span></span>

<span data-ttu-id="8ab16-223">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="8ab16-223">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="8ab16-224">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="8ab16-224">About the Author</span></span>

<span data-ttu-id="8ab16-225">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="8ab16-225">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8ab16-226">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="8ab16-226">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8ab16-227">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8ab16-227">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8ab16-228">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8ab16-228">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="8ab16-229">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="8ab16-229">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="8ab16-230">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="8ab16-230">Special Thanks To</span></span>

<span data-ttu-id="8ab16-231">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="8ab16-231">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="8ab16-232">I revisori per questa esercitazione sono state Dennis Patterson e David Suru Randy Schmidt.</span><span class="sxs-lookup"><span data-stu-id="8ab16-232">Lead reviewers for this tutorial were Dennis Patterson, David Suru, and Randy Schmidt.</span></span> <span data-ttu-id="8ab16-233">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="8ab16-233">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8ab16-234">In questo caso, Inviami una riga in corrispondenza [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8ab16-234">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="8ab16-235">Precedente</span><span class="sxs-lookup"><span data-stu-id="8ab16-235">Previous</span></span>](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)
