---
uid: web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-vb
title: Visualizzazione di dati binari nei controlli Web dei dati (VB) | Microsoft Docs
author: rick-anderson
description: In questa esercitazione vengono esaminate le opzioni per presentare i dati binari in una pagina Web, inclusa la visualizzazione di un file di immagine e il provisioning di un collegamento "download" f...
ms.author: riande
ms.date: 03/27/2007
ms.assetid: 9201656a-e1c2-4020-824b-18fb632d2925
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-vb
msc.type: authoredcontent
ms.openlocfilehash: 27c901af092aa990f557750dc5d2c42ba2644c02
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78604104"
---
# <a name="displaying-binary-data-in-the-data-web-controls-vb"></a><span data-ttu-id="6a0f5-103">Visualizzazione di dati binari nei controlli Web dei dati (VB)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-103">Displaying Binary Data in the Data Web Controls (VB)</span></span>

<span data-ttu-id="6a0f5-104">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6a0f5-105">[Scaricare l'app di esempio](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_VB.exe) o [scaricare il file PDF](displaying-binary-data-in-the-data-web-controls-vb/_static/datatutorial55vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_VB.exe) or [Download PDF](displaying-binary-data-in-the-data-web-controls-vb/_static/datatutorial55vb1.pdf)</span></span>

> <span data-ttu-id="6a0f5-106">In questa esercitazione vengono esaminate le opzioni per presentare i dati binari in una pagina Web, inclusa la visualizzazione di un file di immagine e il provisioning di un collegamento "download" per un file PDF.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-106">In this tutorial we look at the options to present binary data on a Web page, including the display of an image file and the provision of a 'Download' link for a PDF file.</span></span>

## <a name="introduction"></a><span data-ttu-id="6a0f5-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="6a0f5-107">Introduction</span></span>

<span data-ttu-id="6a0f5-108">Nell'esercitazione precedente sono state illustrate le due tecniche per associare i dati binari a un modello di dati sottostante dell'applicazione e si è usato il controllo FileUpload per caricare file da un browser all'file system del server Web.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-108">In the preceding tutorial we explored the two techniques for associating binary data with an application s underlying data model and used the FileUpload control to upload files from a browser to the web server s file system.</span></span> <span data-ttu-id="6a0f5-109">È ancora possibile vedere come associare i dati binari caricati al modello di dati.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-109">We ve yet to see how to associate the uploaded binary data with the data model.</span></span> <span data-ttu-id="6a0f5-110">Ovvero, dopo il caricamento e il salvataggio di un file nella file system, un percorso del file deve essere archiviato nel record di database appropriato.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-110">That is, after a file has been uploaded and saved to the file system, a path to the file must be stored in the appropriate database record.</span></span> <span data-ttu-id="6a0f5-111">Se i dati vengono archiviati direttamente nel database, i dati binari caricati non devono essere salvati nel file system, ma devono essere inseriti nel database.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-111">If the data is being stored directly in the database, then the uploaded binary data need not be saved to the file system, but must be injected into the database.</span></span>

<span data-ttu-id="6a0f5-112">Prima di esaminare l'associazione dei dati al modello di dati, tuttavia, è necessario prima esaminare come fornire i dati binari all'utente finale.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-112">Before we look at associating the data with the data model, though, let s first look at how to provide the binary data to the end user.</span></span> <span data-ttu-id="6a0f5-113">La presentazione di dati di testo è abbastanza semplice, ma in che modo devono essere presentati i dati binari?</span><span class="sxs-lookup"><span data-stu-id="6a0f5-113">Presenting text data is simple enough, but how should binary data be presented?</span></span> <span data-ttu-id="6a0f5-114">Dipende, ovviamente, dal tipo di dati binari.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-114">It depends, of course, on the type of binary data.</span></span> <span data-ttu-id="6a0f5-115">Per le immagini, è probabile che si desideri visualizzare l'immagine; per i file PDF, i documenti di Microsoft Word, i file ZIP e altri tipi di dati binari, è probabilmente più appropriato fornire un collegamento per il download.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-115">For images, we likely want to display the image; for PDFs, Microsoft Word documents, ZIP files, and other types of binary data, providing a Download link is probably more appropriate.</span></span>

<span data-ttu-id="6a0f5-116">In questa esercitazione verrà illustrato come presentare i dati binari insieme ai dati di testo associati usando i controlli Web di dati come GridView e DetailsView.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-116">In this tutorial we will look at how to present the binary data alongside its associated text data using data Web controls like the GridView and DetailsView.</span></span> <span data-ttu-id="6a0f5-117">Nell'esercitazione successiva verrà rivolto l'associazione di un file caricato al database.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-117">In the next tutorial we'll turn our attention to associating an uploaded file with the database.</span></span>

## <a name="step-1-providingbrochurepathvalues"></a><span data-ttu-id="6a0f5-118">Passaggio 1: fornire valori`BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="6a0f5-118">Step 1: Providing`BrochurePath`Values</span></span>

<span data-ttu-id="6a0f5-119">Nella colonna `Picture` della tabella `Categories` sono già contenuti dati binari per le varie immagini di categoria.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-119">The `Picture` column in the `Categories` table already contains binary data for the various category images.</span></span> <span data-ttu-id="6a0f5-120">In particolare, la colonna `Picture` per ogni record contiene il contenuto binario di un'immagine bitmap a 16 colori granulare, di bassa qualità.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-120">Specifically, the `Picture` column for each record holds the binary contents of a grainy, low-quality, 16-color bitmap image.</span></span> <span data-ttu-id="6a0f5-121">Ogni immagine di categoria è 172 pixel di larghezza e 120 pixel di altezza e utilizza circa 11 KB.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-121">Each category image is 172 pixels wide and 120 pixels tall and consumes roughly 11 KB.</span></span> <span data-ttu-id="6a0f5-122">Per ulteriori informazioni, il contenuto binario nella colonna `Picture` include un'intestazione [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) a 78 byte che deve essere rimossa prima di visualizzare l'immagine.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-122">What s more, the binary content in the `Picture` column includes a 78-byte [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) header that must be stripped before displaying the image.</span></span> <span data-ttu-id="6a0f5-123">Queste informazioni di intestazione sono presenti perché il database Northwind presenta le sue radici in Microsoft Access.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-123">This header information is present because the Northwind database has its roots in Microsoft Access.</span></span> <span data-ttu-id="6a0f5-124">In Access, i dati binari vengono archiviati utilizzando il tipo di dati Object OLE, che viene aggiunto a questa intestazione.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-124">In Access, binary data is stored using the OLE Object data type, which tacks on this header.</span></span> <span data-ttu-id="6a0f5-125">Per il momento, verrà illustrato come rimuovere le intestazioni da queste immagini di bassa qualità per visualizzare l'immagine.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-125">For now, we'll see how to strip the headers from these low-quality images in order to display the picture.</span></span> <span data-ttu-id="6a0f5-126">In un'esercitazione futura verrà compilata un'interfaccia per l'aggiornamento di una colonna `Picture` di categoria e le immagini bitmap che usano le intestazioni OLE con immagini JPG equivalenti senza intestazioni OLE non necessarie.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-126">In a future tutorial we'll build an interface for updating a category s `Picture` column and replace these bitmap images that use OLE headers with equivalent JPG images without the unnecessary OLE headers.</span></span>

<span data-ttu-id="6a0f5-127">Nell'esercitazione precedente è stato illustrato come usare il controllo FileUpload.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-127">In the preceding tutorial we saw how to use the FileUpload control.</span></span> <span data-ttu-id="6a0f5-128">Pertanto, è possibile procedere e aggiungere i file della brochure al file system del server Web.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-128">Therefore, you can go ahead and add brochure files to the web server s file system.</span></span> <span data-ttu-id="6a0f5-129">Questa operazione, tuttavia, non aggiorna la colonna `BrochurePath` nella tabella `Categories`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-129">Doing so, however, does not update the `BrochurePath` column in the `Categories` table.</span></span> <span data-ttu-id="6a0f5-130">Nell'esercitazione successiva verrà illustrato come eseguire questa operazione, ma per ora è necessario specificare manualmente i valori per questa colonna.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-130">In the next tutorial we'll see how to accomplish this, but for now we need to manually provide values for this column.</span></span>

<span data-ttu-id="6a0f5-131">In questo download di questa esercitazione sono disponibili sette file di brochure PDF nella cartella `~/Brochures`, uno per ogni categoria eccetto Seafood.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-131">In this tutorial s download you'll find seven PDF brochure files in the `~/Brochures` folder, one for each of the categories except Seafood.</span></span> <span data-ttu-id="6a0f5-132">Ho omesso intenzionalmente di aggiungere una brochure a frutti di pesce per illustrare come gestire gli scenari in cui non tutti i record contengono dati binari associati.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-132">I purposefully omitted adding a Seafood brochure to illustrate how to handle scenarios where not all records have associated binary data.</span></span> <span data-ttu-id="6a0f5-133">Per aggiornare la tabella `Categories` con questi valori, fare clic con il pulsante destro del mouse sul nodo `Categories` da Esplora server e scegliere Mostra dati tabella.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-133">To update the `Categories` table with these values, right-click on the `Categories` node from Server Explorer and choose Show Table Data.</span></span> <span data-ttu-id="6a0f5-134">Quindi, immettere i percorsi virtuali dei file della brochure per ogni categoria con una brochure, come illustrato nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-134">Then, enter the virtual paths to the brochure files for each category that has a brochure, as Figure 1 shows.</span></span> <span data-ttu-id="6a0f5-135">Poiché non è disponibile alcuna brochure per la categoria Seafood, lasciare il relativo valore `BrochurePath` colonna come `NULL`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-135">Since there is no brochure for the Seafood category, leave its `BrochurePath` column s value as `NULL`.</span></span>

<span data-ttu-id="6a0f5-136">[![immettere manualmente i valori per la colonna BrochurePath della tabella Categories](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-136">[![Manually Enter the Values for the Categories Table s BrochurePath Column](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.png)</span></span>

<span data-ttu-id="6a0f5-137">**Figura 1**: immettere manualmente i valori per la colonna `BrochurePath` della tabella `Categories` ([fare clic per visualizzare l'immagine con dimensioni complete](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="6a0f5-137">**Figure 1**: Manually Enter the Values for the `Categories` Table s `BrochurePath` Column ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.png))</span></span>

## <a name="step-2-providing-a-download-link-for-the-brochures-in-a-gridview"></a><span data-ttu-id="6a0f5-138">Passaggio 2: fornire un collegamento di download per le brochure in un controllo GridView</span><span class="sxs-lookup"><span data-stu-id="6a0f5-138">Step 2: Providing a Download Link for the Brochures in a GridView</span></span>

<span data-ttu-id="6a0f5-139">Con i valori `BrochurePath` specificati per la tabella `Categories`, è possibile creare un controllo GridView che elenca ogni categoria insieme a un collegamento per scaricare la brochure di categoria.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-139">With the `BrochurePath` values provided for the `Categories` table, we re ready to create a GridView that lists each category along with a link to download the category s brochure.</span></span> <span data-ttu-id="6a0f5-140">Nel passaggio 4 si estenderà questo GridView per visualizzare anche l'immagine della categoria.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-140">In Step 4 we'll extend this GridView to also display the category s image.</span></span>

<span data-ttu-id="6a0f5-141">Per iniziare, trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione della pagina `DisplayOrDownloadData.aspx` nella cartella `BinaryData`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-141">Start by dragging a GridView from the Toolbox onto the Designer of the `DisplayOrDownloadData.aspx` page in the `BinaryData` folder.</span></span> <span data-ttu-id="6a0f5-142">Impostare il `ID` di GridView su `Categories` e tramite lo smart tag di GridView, scegliere di associarlo a una nuova origine dati.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-142">Set the GridView s `ID` to `Categories` and through the GridView s smart tag, choose to bind it to a new data source.</span></span> <span data-ttu-id="6a0f5-143">In particolare, è necessario associarlo a un ObjectDataSource denominato `CategoriesDataSource` che recupera i dati utilizzando il metodo `CategoriesBLL` `GetCategories()` oggetto s.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-143">Specifically, bind it to an ObjectDataSource named `CategoriesDataSource` that retrieves data using the `CategoriesBLL` object s `GetCategories()` method.</span></span>

<span data-ttu-id="6a0f5-144">[![creare un nuovo ObjectDataSource denominato CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-144">[![Create a New ObjectDataSource Named CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.png)</span></span>

<span data-ttu-id="6a0f5-145">**Figura 2**: creare un nuovo ObjectDataSource denominato `CategoriesDataSource` ([fare clic per visualizzare l'immagine con dimensioni complete](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="6a0f5-145">**Figure 2**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.png))</span></span>

<span data-ttu-id="6a0f5-146">[![configurare ObjectDataSource per l'utilizzo della classe CategoriesBLL](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-146">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.png)</span></span>

<span data-ttu-id="6a0f5-147">**Figura 3**: configurare ObjectDataSource per l'uso della classe `CategoriesBLL` ([fare clic per visualizzare l'immagine con dimensioni complete](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="6a0f5-147">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.png))</span></span>

<span data-ttu-id="6a0f5-148">[![recuperare l'elenco di categorie utilizzando il metodo GetCategories ()](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-148">[![Retrieve the List of Categories Using the GetCategories() Method](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.png)</span></span>

<span data-ttu-id="6a0f5-149">**Figura 4**: recuperare l'elenco di categorie usando il metodo `GetCategories()` ([fare clic per visualizzare l'immagine con dimensioni complete](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="6a0f5-149">**Figure 4**: Retrieve the List of Categories Using the `GetCategories()` Method ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.png))</span></span>

<span data-ttu-id="6a0f5-150">Dopo aver completato la configurazione guidata origine dati, Visual Studio aggiungerà automaticamente un BoundField al `Categories` GridView per il `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`e `BrochurePath` `DataColumn` s.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-150">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField to the `Categories` GridView for the `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, and `BrochurePath` `DataColumn` s.</span></span> <span data-ttu-id="6a0f5-151">Procedere e rimuovere il `NumberOfProducts` BoundField poiché la query del metodo `GetCategories()` non recupera queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-151">Go ahead and remove the `NumberOfProducts` BoundField since the `GetCategories()` method s query does not retrieve this information.</span></span> <span data-ttu-id="6a0f5-152">Rimuovere anche il BoundField `CategoryID` e rinominare i `CategoryName` e `BrochurePath` i BoundField `HeaderText` proprietà rispettivamente in Category e brochure.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-152">Also remove the `CategoryID` BoundField and rename the `CategoryName` and `BrochurePath` BoundFields `HeaderText` properties to Category and Brochure, respectively.</span></span> <span data-ttu-id="6a0f5-153">Dopo aver apportato queste modifiche, il markup dichiarativo GridView e ObjectDataSource dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="6a0f5-153">After making these changes, your GridView and ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample1.aspx)]

<span data-ttu-id="6a0f5-154">Visualizzare questa pagina tramite un browser (vedere la figura 5).</span><span class="sxs-lookup"><span data-stu-id="6a0f5-154">View this page through a browser (see Figure 5).</span></span> <span data-ttu-id="6a0f5-155">Ognuna delle otto categorie è elencata.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-155">Each of the eight categories is listed.</span></span> <span data-ttu-id="6a0f5-156">Le sette categorie con valori `BrochurePath` hanno il valore `BrochurePath` visualizzato nel rispettivo BoundField.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-156">The seven categories with `BrochurePath` values have the `BrochurePath` value displayed in the respective BoundField.</span></span> <span data-ttu-id="6a0f5-157">Seafood, che dispone di un valore `NULL` per la relativa `BrochurePath`, Visualizza una cella vuota.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-157">Seafood, which has a `NULL` value for its `BrochurePath`, displays an empty cell.</span></span>

<span data-ttu-id="6a0f5-158">[![viene elencato il nome, la descrizione e il valore BrochurePath di ogni categoria.](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-158">[![Each Category s Name, Description, and BrochurePath Value is Listed](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.png)</span></span>

<span data-ttu-id="6a0f5-159">**Figura 5**: sono elencati il nome, la descrizione e il valore `BrochurePath` di ogni categoria ([fare clic per visualizzare l'immagine con dimensioni complete](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="6a0f5-159">**Figure 5**: Each Category s Name, Description, and `BrochurePath` Value is Listed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.png))</span></span>

<span data-ttu-id="6a0f5-160">Anziché visualizzare il testo della colonna `BrochurePath`, è necessario creare un collegamento alla brochure.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-160">Rather than displaying the text of the `BrochurePath` column, we want to create a link to the brochure.</span></span> <span data-ttu-id="6a0f5-161">A tale scopo, rimuovere il `BrochurePath` BoundField e sostituirlo con un HyperLinkField.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-161">To accomplish this, remove the `BrochurePath` BoundField and replace it with a HyperLinkField.</span></span> <span data-ttu-id="6a0f5-162">Impostare la proprietà New HyperLinkField s `HeaderText` su brochure, la relativa proprietà `Text` per visualizzare la brochure e la relativa proprietà `DataNavigateUrlFields` su `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-162">Set the new HyperLinkField s `HeaderText` property to Brochure, its `Text` property to View Brochure, and its `DataNavigateUrlFields` property to `BrochurePath`.</span></span>

![Aggiungere un HyperLinkField per BrochurePath](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.gif)

<span data-ttu-id="6a0f5-164">**Figura 6**: aggiungere un HyperLinkField per `BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="6a0f5-164">**Figure 6**: Add a HyperLinkField for `BrochurePath`</span></span>

<span data-ttu-id="6a0f5-165">Verrà aggiunta una colonna di collegamenti a GridView, come illustrato nella figura 7.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-165">This will add a column of links to the GridView, as Figure 7 shows.</span></span> <span data-ttu-id="6a0f5-166">Se si fa clic su un collegamento Visualizza brochure, il file PDF verrà visualizzato direttamente nel browser o verrà richiesto all'utente di scaricare il file, a seconda che sia installato un lettore PDF e le impostazioni del browser.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-166">Clicking a View Brochure link will either display the PDF directly in the browser or prompt the user to download the file, depending on whether a PDF reader is installed and the browser s settings.</span></span>

<span data-ttu-id="6a0f5-167">[![è possibile visualizzare la brochure di una categoria facendo clic sul collegamento Visualizza brochure](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-167">[![A Category s Brochure Can Be Viewed by Clicking the View Brochure Link](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.png)</span></span>

<span data-ttu-id="6a0f5-168">**Figura 7**: è possibile visualizzare la brochure di una categoria facendo clic sul collegamento Visualizza brochure ([fare clic per visualizzare l'immagine con dimensioni complete](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="6a0f5-168">**Figure 7**: A Category s Brochure Can Be Viewed by Clicking the View Brochure Link ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.png))</span></span>

<span data-ttu-id="6a0f5-169">[![viene visualizzata la brochure della categoria PDF](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-169">[![The Category s Brochure PDF is Displayed](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.png)</span></span>

<span data-ttu-id="6a0f5-170">**Figura 8**: la brochure della categoria s PDF viene visualizzata ([fare clic per visualizzare l'immagine con dimensioni complete](displaying-binary-data-in-the-data-web-controls-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="6a0f5-170">**Figure 8**: The Category s Brochure PDF is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image14.png))</span></span>

## <a name="hiding-the-view-brochure-text-for-categories-without-a-brochure"></a><span data-ttu-id="6a0f5-171">Nascondere il testo della brochure di visualizzazione per le categorie senza una brochure</span><span class="sxs-lookup"><span data-stu-id="6a0f5-171">Hiding the View Brochure Text for Categories Without a Brochure</span></span>

<span data-ttu-id="6a0f5-172">Come illustrato nella figura 7, il `BrochurePath` HyperLinkField Visualizza il valore della proprietà `Text` (View brochure) per tutti i record, indipendentemente dal fatto che esista un valore non`NULL` per `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-172">As Figure 7 shows, the `BrochurePath` HyperLinkField displays its `Text` property value ( View Brochure ) for all records, regardless of whether there s a non-`NULL` value for `BrochurePath`.</span></span> <span data-ttu-id="6a0f5-173">Naturalmente, se `BrochurePath` è `NULL`, il collegamento viene visualizzato solo come testo, come nel caso della categoria Seafood (vedere di nuovo la figura 7).</span><span class="sxs-lookup"><span data-stu-id="6a0f5-173">Of course, if `BrochurePath` is `NULL`, then the link is displayed as text only, as is the case with the Seafood category (refer back to Figure 7).</span></span> <span data-ttu-id="6a0f5-174">Anziché visualizzare la brochure di visualizzazione di testo, potrebbe essere utile fare in modo che le categorie senza un valore `BrochurePath` visualizzino un testo alternativo, ad esempio nessuna brochure disponibile.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-174">Rather than displaying the text View Brochure, it might be nice to have those categories without a `BrochurePath` value display some alternate text, like No Brochure Available.</span></span>

<span data-ttu-id="6a0f5-175">Per fornire questo comportamento, è necessario usare un TemplateField il cui contenuto viene generato tramite una chiamata a un metodo di pagina che genera l'output appropriato in base al valore `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-175">In order to provide this behavior, we need to use a TemplateField whose content is generated via a call to a page method that emits the appropriate output based on the `BrochurePath` value.</span></span> <span data-ttu-id="6a0f5-176">Per prima cosa è stata esaminata questa tecnica di formattazione nell'esercitazione [using TemplateFields nell'esercitazione sul controllo GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="6a0f5-176">We first explored this formatting technique back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span></span>

<span data-ttu-id="6a0f5-177">Trasformare il HyperLinkField in un TemplateField selezionando il `BrochurePath` HyperLinkField e quindi facendo clic sul collegamento Converti questo campo in un TemplateField nella finestra di dialogo Modifica colonne.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-177">Turn the HyperLinkField into a TemplateField by selecting the `BrochurePath` HyperLinkField and then clicking on the Convert this field into a TemplateField link in the Edit Columns dialog box.</span></span>

![Convertire HyperLinkField in TemplateField](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.gif)

<span data-ttu-id="6a0f5-179">**Figura 9**: convertire il HyperLinkField in un TemplateField</span><span class="sxs-lookup"><span data-stu-id="6a0f5-179">**Figure 9**: Convert the HyperLinkField into a TemplateField</span></span>

<span data-ttu-id="6a0f5-180">Verrà creato un TemplateField con un `ItemTemplate` contenente un controllo Web collegamento ipertestuale la cui proprietà `NavigateUrl` è associata al valore di `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-180">This will create a TemplateField with an `ItemTemplate` that contains a HyperLink Web control whose `NavigateUrl` property is bound to the `BrochurePath` value.</span></span> <span data-ttu-id="6a0f5-181">Sostituire questo markup con una chiamata al metodo `GenerateBrochureLink`, passando il valore di `BrochurePath`:</span><span class="sxs-lookup"><span data-stu-id="6a0f5-181">Replace this markup with a call to the method `GenerateBrochureLink`, passing in the value of `BrochurePath`:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample2.aspx)]

<span data-ttu-id="6a0f5-182">Successivamente, creare un metodo di `Protected` nella classe code-behind della pagina ASP.NET denominata `GenerateBrochureLink` che restituisce un `String` e accetta un `Object` come parametro di input.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-182">Next, create a `Protected` method in the ASP.NET page s code-behind class named `GenerateBrochureLink` that returns a `String` and accepts an `Object` as an input parameter.</span></span>

[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample3.vb)]

<span data-ttu-id="6a0f5-183">Questo metodo determina se il valore `Object` passato è un database `NULL` e, in caso affermativo, restituisce un messaggio che indica che la categoria non dispone di una brochure.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-183">This method determines if the passed-in `Object` value is a database `NULL` and, if so, returns a message indicating that the category lacks a brochure.</span></span> <span data-ttu-id="6a0f5-184">In caso contrario, se è presente un valore `BrochurePath`, viene visualizzato in un collegamento ipertestuale.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-184">Otherwise, if there is a `BrochurePath` value, it s displayed in a hyperlink.</span></span> <span data-ttu-id="6a0f5-185">Si noti che se il valore `BrochurePath` è presente, viene passato nel [metodo`ResolveUrl(url)`](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="6a0f5-185">Note that if the `BrochurePath` value is present it s passed into the [`ResolveUrl(url)` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span></span> <span data-ttu-id="6a0f5-186">Questo metodo risolve l' *URL*passato, sostituendo il carattere `~` con il percorso virtuale appropriato.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-186">This method resolves the passed-in *url*, replacing the `~` character with the appropriate virtual path.</span></span> <span data-ttu-id="6a0f5-187">Se, ad esempio, l'applicazione è radicata in `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` restituirà `/Tutorial55/Brochures/Meat.pdf`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-187">For example, if the application is rooted at `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` will return `/Tutorial55/Brochures/Meat.pdf`.</span></span>

<span data-ttu-id="6a0f5-188">La figura 10 Mostra la pagina dopo l'applicazione delle modifiche.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-188">Figure 10 shows the page after these changes have been applied.</span></span> <span data-ttu-id="6a0f5-189">Si noti che il campo `BrochurePath` della categoria Seafood ora Visualizza il testo non è disponibile alcuna brochure.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-189">Note that the Seafood category s `BrochurePath` field now displays the text No Brochure Available .</span></span>

<span data-ttu-id="6a0f5-190">[![viene visualizzato il testo nessuna brochure disponibile per le categorie senza una brochure](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-190">[![The Text No Brochure Available is Displayed for Those Categories Without a Brochure](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image15.png)</span></span>

<span data-ttu-id="6a0f5-191">**Figura 10**: il testo nessuna brochure disponibile viene visualizzato per le categorie senza una brochure ([fare clic per visualizzare l'immagine con dimensioni complete](displaying-binary-data-in-the-data-web-controls-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="6a0f5-191">**Figure 10**: The Text No Brochure Available is Displayed for Those Categories Without a Brochure ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image16.png))</span></span>

## <a name="step-3-adding-a-web-page-to-display-a-category-s-picture"></a><span data-ttu-id="6a0f5-192">Passaggio 3: aggiunta di una pagina Web per visualizzare un'immagine di categoria</span><span class="sxs-lookup"><span data-stu-id="6a0f5-192">Step 3: Adding a Web Page to Display a Category s Picture</span></span>

<span data-ttu-id="6a0f5-193">Quando un utente visita una pagina ASP.NET, riceve il codice HTML della pagina ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-193">When a user visits an ASP.NET page, they receive the ASP.NET page s HTML.</span></span> <span data-ttu-id="6a0f5-194">Il codice HTML ricevuto è semplicemente testo e non contiene dati binari.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-194">The received HTML is just text and does not contain any binary data.</span></span> <span data-ttu-id="6a0f5-195">Eventuali dati binari aggiuntivi, ad esempio immagini, file audio, Macromedia Flash applicazioni, video incorporati di Windows Media Player e così via, sono disponibili come risorse separate sul server Web.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-195">Any additional binary data, such as images, sound files, Macromedia Flash applications, embedded Windows Media Player videos, and so forth, exist as separate resources on the web server.</span></span> <span data-ttu-id="6a0f5-196">Il codice HTML contiene riferimenti a questi file, ma non include il contenuto effettivo dei file.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-196">The HTML contains references to these files, but does not include the actual contents of the files.</span></span>

<span data-ttu-id="6a0f5-197">Ad esempio, in HTML l'elemento `<img>` viene usato per fare riferimento a un'immagine, con l'attributo `src` che punta al file di immagine come segue:</span><span class="sxs-lookup"><span data-stu-id="6a0f5-197">For example, in HTML the `<img>` element is used to reference a picture, with the `src` attribute pointing to the image file like so:</span></span>

[!code-html[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample4.html)]

<span data-ttu-id="6a0f5-198">Quando un browser riceve questo codice HTML, effettua un'altra richiesta al server Web per recuperare il contenuto binario del file di immagine, che viene quindi visualizzato nel browser.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-198">When a browser receives this HTML, it makes another request to the web server to retrieve the binary contents of the image file, which it then displays in the browser.</span></span> <span data-ttu-id="6a0f5-199">Lo stesso concetto è applicabile a qualsiasi dato binario.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-199">The same concept applies to any binary data.</span></span> <span data-ttu-id="6a0f5-200">Nel passaggio 2 la brochure non è stata inviata al browser come parte del markup HTML della pagina.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-200">In Step 2, the brochure was not sent down to the browser as part of the page s HTML markup.</span></span> <span data-ttu-id="6a0f5-201">Piuttosto, i collegamenti ipertestuali forniti da HTML che, quando si fa clic, hanno causato la richiesta diretta del documento PDF da parte del browser.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-201">Rather, the rendered HTML provided hyperlinks that, when clicked, caused the browser to request the PDF document directly.</span></span>

<span data-ttu-id="6a0f5-202">Per visualizzare o consentire agli utenti di scaricare dati binari che si trovano all'interno del database, è necessario creare una pagina Web separata che restituisca i dati.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-202">To display or allow users to download binary data that resides within the database, we need to create a separate web page that returns the data.</span></span> <span data-ttu-id="6a0f5-203">Per l'applicazione, c'è un solo campo dati binario archiviato direttamente nel database dell'immagine della categoria.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-203">For our application, there s only one binary data field stored directly in the database the category s picture.</span></span> <span data-ttu-id="6a0f5-204">Pertanto, è necessaria una pagina che, quando chiamata, restituisca i dati dell'immagine per una determinata categoria.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-204">Therefore, we need a page that, when called, returns the image data for a particular category.</span></span>

<span data-ttu-id="6a0f5-205">Aggiungere una nuova pagina ASP.NET alla cartella `BinaryData` denominata `DisplayCategoryPicture.aspx`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-205">Add a new ASP.NET page to the `BinaryData` folder named `DisplayCategoryPicture.aspx`.</span></span> <span data-ttu-id="6a0f5-206">Quando si esegue questa operazione, lasciare deselezionata la casella di controllo Seleziona pagina master.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-206">When doing so, leave the Select master page checkbox unchecked.</span></span> <span data-ttu-id="6a0f5-207">Questa pagina prevede un valore `CategoryID` in QueryString e restituisce i dati binari della colonna `Picture` della categoria.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-207">This page expects a `CategoryID` value in the querystring and returns the binary data of that category s `Picture` column.</span></span> <span data-ttu-id="6a0f5-208">Poiché in questa pagina vengono restituiti dati binari e nient'altro, non è necessario alcun markup nella sezione HTML.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-208">Since this page returns binary data and nothing else, it does not need any markup in the HTML section.</span></span> <span data-ttu-id="6a0f5-209">Quindi, fare clic sulla scheda origine nell'angolo in basso a sinistra e rimuovere tutto il markup della pagina, ad eccezione della direttiva `<%@ Page %>`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-209">Therefore, click on the Source tab in the lower left corner and remove all of the page s markup except for the `<%@ Page %>` directive.</span></span> <span data-ttu-id="6a0f5-210">Ovvero il markup dichiarativo `DisplayCategoryPicture.aspx` s deve essere costituito da una sola riga:</span><span class="sxs-lookup"><span data-stu-id="6a0f5-210">That is, `DisplayCategoryPicture.aspx` s declarative markup should consist of a single line:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample5.aspx)]

<span data-ttu-id="6a0f5-211">Se viene visualizzato l'attributo `MasterPageFile` nella direttiva `<%@ Page %>`, rimuoverlo.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-211">If you see the `MasterPageFile` attribute in the `<%@ Page %>` directive, remove it.</span></span>

<span data-ttu-id="6a0f5-212">Nella classe code-behind della pagina aggiungere il codice seguente al gestore dell'evento `Page_Load`:</span><span class="sxs-lookup"><span data-stu-id="6a0f5-212">In the page s code-behind class, add the following code to the `Page_Load` event handler:</span></span>

[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample6.vb)]

<span data-ttu-id="6a0f5-213">Questo codice inizia leggendo il `CategoryID` valore querystring in una variabile denominata `categoryID`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-213">This code starts by reading in the `CategoryID` querystring value into a variable named `categoryID`.</span></span> <span data-ttu-id="6a0f5-214">Successivamente, i dati dell'immagine vengono recuperati tramite una chiamata al metodo `GetCategoryWithBinaryDataByCategoryID(categoryID)` della classe `CategoriesBLL`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-214">Next, the picture data is retrieved via a call to the `CategoriesBLL` class s `GetCategoryWithBinaryDataByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="6a0f5-215">Questi dati vengono restituiti al client tramite il metodo `Response.BinaryWrite(data)`, ma prima che venga chiamato, è necessario rimuovere l'intestazione OLE del valore della colonna `Picture`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-215">This data is returned to the client by using the `Response.BinaryWrite(data)` method, but before this is called, the `Picture` column value s OLE header must be removed.</span></span> <span data-ttu-id="6a0f5-216">Questa operazione viene eseguita creando una matrice di `Byte` denominata `strippedImageData` che conterrà esattamente 78 caratteri inferiori rispetto a quelli presenti nella colonna `Picture`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-216">This is accomplished by creating a `Byte` array named `strippedImageData` that will hold precisely 78 characters less than what is in the `Picture` column.</span></span> <span data-ttu-id="6a0f5-217">Il [metodo`Array.Copy`](https://msdn.microsoft.com/library/z50k9bft.aspx) viene usato per copiare i dati da `category.Picture` a partire dalla posizione 78 al `strippedImageData`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-217">The [`Array.Copy` method](https://msdn.microsoft.com/library/z50k9bft.aspx) is used to copy the data from `category.Picture` starting at position 78 over to `strippedImageData`.</span></span>

<span data-ttu-id="6a0f5-218">La proprietà `Response.ContentType` specifica il [tipo MIME](http://en.wikipedia.org/wiki/MIME) del contenuto restituito, in modo che il browser sappia come eseguirne il rendering.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-218">The `Response.ContentType` property specifies the [MIME type](http://en.wikipedia.org/wiki/MIME) of the content being returned so that the browser knows how to render it.</span></span> <span data-ttu-id="6a0f5-219">Poiché la colonna `Picture` `Categories` Table è un'immagine bitmap, qui viene usato il tipo MIME bitmap (Image/BMP).</span><span class="sxs-lookup"><span data-stu-id="6a0f5-219">Since the `Categories` table s `Picture` column is a bitmap image, the bitmap MIME type is used here (image/bmp).</span></span> <span data-ttu-id="6a0f5-220">Se si omette il tipo MIME, la maggior parte dei browser visualizzerà l'immagine correttamente perché può dedurre il tipo in base al contenuto dei dati binari del file di immagine.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-220">If you omit the MIME type, most browsers will still display the image correctly because they can infer the type based on the contents of the image file s binary data.</span></span> <span data-ttu-id="6a0f5-221">Tuttavia, è prudente includere il tipo MIME quando possibile.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-221">However, it s prudent to include the MIME type when possible.</span></span> <span data-ttu-id="6a0f5-222">Per un elenco completo dei [tipi di supporti MIME](http://www.iana.org/assignments/media-types/), vedere il [sito Web Internet Assigned Numbers Authority](http://www.iana.org/) .</span><span class="sxs-lookup"><span data-stu-id="6a0f5-222">See the [Internet Assigned Numbers Authority s website](http://www.iana.org/) for a complete listing of [MIME media types](http://www.iana.org/assignments/media-types/).</span></span>

<span data-ttu-id="6a0f5-223">Quando questa pagina è stata creata, è possibile visualizzare un'immagine specifica della categoria visitando `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-223">With this page created, a particular category s picture can be viewed by visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="6a0f5-224">Nella figura 11 è illustrata l'immagine della categoria bevande, che può essere visualizzata da `DisplayCategoryPicture.aspx?CategoryID=1`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-224">Figure 11 shows the Beverages category s picture, which can be viewed from `DisplayCategoryPicture.aspx?CategoryID=1`.</span></span>

<span data-ttu-id="6a0f5-225">[![viene visualizzata l'immagine della categoria bevande](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-225">[![The Beverages Category s Picture is Displayed](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image17.png)</span></span>

<span data-ttu-id="6a0f5-226">**Figura 11**: viene visualizzata l'immagine della categoria bevande ([fare clic per visualizzare l'immagine con dimensioni complete](displaying-binary-data-in-the-data-web-controls-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="6a0f5-226">**Figure 11**: The Beverages Category s Picture is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image18.png))</span></span>

<span data-ttu-id="6a0f5-227">Se, durante la visita di `DisplayCategoryPicture.aspx?CategoryID=categoryID`, viene generata un'eccezione che indica che non è possibile eseguire il cast dell'oggetto di tipo ' System. DBNull ' al tipo ' System. Byte []'. Esistono due elementi che potrebbero causare questa situazione.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-227">If, when visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`, you get an exception that reads Unable to cast object of type 'System.DBNull' to type 'System.Byte[]', there are two things that may be causing this.</span></span> <span data-ttu-id="6a0f5-228">Per prima cosa, la colonna `Picture` della tabella `Categories` consente `NULL` valori.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-228">First, the `Categories` table s `Picture` column does allow `NULL` values.</span></span> <span data-ttu-id="6a0f5-229">La pagina `DisplayCategoryPicture.aspx`, tuttavia, presuppone che sia presente un valore non`NULL`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-229">The `DisplayCategoryPicture.aspx` page, however, assumes there is a non-`NULL` value present.</span></span> <span data-ttu-id="6a0f5-230">Non è possibile accedere direttamente alla proprietà `Picture` della `CategoriesDataTable` se è presente un valore di `NULL`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-230">The `Picture` property of the `CategoriesDataTable` cannot be directly accessed if it has a `NULL` value.</span></span> <span data-ttu-id="6a0f5-231">Se si desidera consentire `NULL` valori per la colonna `Picture`, è necessario includere la condizione seguente:</span><span class="sxs-lookup"><span data-stu-id="6a0f5-231">If you do want to allow `NULL` values for the `Picture` column, you d want to include the following condition:</span></span>

[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample7.vb)]

<span data-ttu-id="6a0f5-232">Il codice precedente presuppone che esista un file di immagine denominato `NoPictureAvailable.gif` nella cartella `Images` che si desidera visualizzare per tali categorie senza un'immagine.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-232">The above code assumes that there s some image file named `NoPictureAvailable.gif` in the `Images` folder that you want to display for those categories without a picture.</span></span>

<span data-ttu-id="6a0f5-233">Questa eccezione può essere causata anche se l'istruzione `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` Method s `SELECT` è stata ripristinata nell'elenco di colonne della query principale, che può verificarsi se si usano istruzioni SQL ad hoc ed è necessario eseguire di nuovo la procedura guidata per la query principale di TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-233">This exception could also be caused if the `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement has reverted back to the main query s column list, which can happen if you are using ad-hoc SQL statements and you ve re-run the wizard for the TableAdapter s main query.</span></span> <span data-ttu-id="6a0f5-234">Verificare che l'istruzione `GetCategoryWithBinaryDataByCategoryID` Method s `SELECT` includa ancora la colonna `Picture`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-234">Check to ensure that `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement still includes the `Picture` column.</span></span>

> [!NOTE]
> <span data-ttu-id="6a0f5-235">Ogni volta che viene visitata la `DisplayCategoryPicture.aspx`, viene eseguito l'accesso al database e vengono restituiti i dati dell'immagine della categoria specificata.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-235">Every time the `DisplayCategoryPicture.aspx` is visited, the database is accessed and the specified category s picture data is returned.</span></span> <span data-ttu-id="6a0f5-236">Se l'immagine della categoria non è stata modificata dopo l'ultima visualizzazione da parte dell'utente, si tratta di un'operazione inutile.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-236">If the category s picture hasn't changed since the user has last viewed it, though, this is wasted effort.</span></span> <span data-ttu-id="6a0f5-237">Fortunatamente, HTTP consente l' *ottenere condizionale*.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-237">Fortunately, HTTP allows for *conditional GETs*.</span></span> <span data-ttu-id="6a0f5-238">Con un'operazione GET condizionale, il client che effettua la richiesta HTTP invia una [`If-Modified-Since` intestazione HTTP](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) che fornisce la data e l'ora dell'ultima volta in cui il client ha recuperato questa risorsa dal server Web.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-238">With a conditional GET, the client making the HTTP request sends along an [`If-Modified-Since` HTTP header](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) that provides the date and time the client last retrieved this resource from the web server.</span></span> <span data-ttu-id="6a0f5-239">Se il contenuto non è stato modificato dopo la data specificata, il server Web può rispondere con un [codice di stato non modificato (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) e rinunciare a restituire il contenuto della risorsa richiesta.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-239">If the content has not changed since this specified date, the web server may respond with a [Not Modified status code (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) and forgo sending back the requested resource s content.</span></span> <span data-ttu-id="6a0f5-240">In breve, questa tecnica evita al server Web di dover restituire il contenuto di una risorsa se non è stato modificato dall'ultimo accesso del client.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-240">In short, this technique relieves the web server from having to send back content for a resource if it has not been modified since the client last accessed it.</span></span>

<span data-ttu-id="6a0f5-241">Per implementare questo comportamento, tuttavia, richiede l'aggiunta di una colonna `PictureLastModified` alla tabella `Categories` per acquisire la data dell'ultimo aggiornamento della colonna `Picture`, nonché il codice per verificare l'intestazione `If-Modified-Since`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-241">To implement this behavior, however, requires that you add a `PictureLastModified` column to the `Categories` table to capture when the `Picture` column was last updated as well as code to check for the `If-Modified-Since` header.</span></span> <span data-ttu-id="6a0f5-242">Per ulteriori informazioni sull'intestazione `If-Modified-Since` e sul flusso di lavoro GET condizionale, vedere [HTTP GET condizionale per gli hacker RSS](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) e [un'analisi più approfondita dell'esecuzione di richieste HTTP in una pagina ASP.NET](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="6a0f5-242">For more information on the `If-Modified-Since` header and the conditional GET workflow, see [HTTP Conditional GET for RSS Hackers](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) and [A Deeper Look at Performing HTTP Requests in an ASP.NET Page](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span></span>

## <a name="step-4-displaying-the-category-pictures-in-a-gridview"></a><span data-ttu-id="6a0f5-243">Passaggio 4: visualizzazione delle immagini delle categorie in un controllo GridView</span><span class="sxs-lookup"><span data-stu-id="6a0f5-243">Step 4: Displaying the Category Pictures in a GridView</span></span>

<span data-ttu-id="6a0f5-244">Ora che è disponibile una pagina Web per visualizzare un'immagine di categoria specifica, è possibile visualizzarla usando il [controllo Web Image](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) o un elemento `<img>` HTML che punta a `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-244">Now that we have a web page to display a particular category s picture, we can display it using the [Image Web control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) or an HTML `<img>` element pointing to `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="6a0f5-245">Le immagini il cui URL è determinato dai dati del database possono essere visualizzate in GridView o DetailsView usando ImageField.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-245">Images whose URL is determined by database data can be displayed in the GridView or DetailsView using the ImageField.</span></span> <span data-ttu-id="6a0f5-246">Il ImageField contiene `DataImageUrlField` e `DataImageUrlFormatString` proprietà che funzionano come HyperLinkField s `DataNavigateUrlFields` e `DataNavigateUrlFormatString` proprietà.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-246">The ImageField contains `DataImageUrlField` and `DataImageUrlFormatString` properties that work like the HyperLinkField s `DataNavigateUrlFields` and `DataNavigateUrlFormatString` properties.</span></span>

<span data-ttu-id="6a0f5-247">Consente di aumentare la `Categories` GridView in `DisplayOrDownloadData.aspx` aggiungendo un ImageField per visualizzare l'immagine di ogni categoria.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-247">Let s augment the `Categories` GridView in `DisplayOrDownloadData.aspx` by adding an ImageField to show each category s picture.</span></span> <span data-ttu-id="6a0f5-248">È sufficiente aggiungere il ImageField e impostare le proprietà `DataImageUrlField` e `DataImageUrlFormatString` rispettivamente su `CategoryID` e `DisplayCategoryPicture.aspx?CategoryID={0}`.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-248">Simply add the ImageField and set its `DataImageUrlField` and `DataImageUrlFormatString` properties to `CategoryID` and `DisplayCategoryPicture.aspx?CategoryID={0}`, respectively.</span></span> <span data-ttu-id="6a0f5-249">Verrà creata una colonna GridView che esegue il rendering di un elemento `<img>` il cui attributo `src` fa riferimento `DisplayCategoryPicture.aspx?CategoryID={0}`, dove {0} viene sostituito con il valore `CategoryID` della riga GridView.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-249">This will create a GridView column that renders an `<img>` element whose `src` attribute references `DisplayCategoryPicture.aspx?CategoryID={0}`, where {0} is replaced with the GridView row s `CategoryID` value.</span></span>

![Aggiungere un ImageField a GridView](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.gif)

<span data-ttu-id="6a0f5-251">**Figura 12**: aggiungere un ImageField a GridView</span><span class="sxs-lookup"><span data-stu-id="6a0f5-251">**Figure 12**: Add an ImageField to the GridView</span></span>

<span data-ttu-id="6a0f5-252">Dopo aver aggiunto il ImageField, la sintassi dichiarativa di GridView sarà simile a soothe:</span><span class="sxs-lookup"><span data-stu-id="6a0f5-252">After adding the ImageField, your GridView s declarative syntax should look like soothe following:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample8.aspx)]

<span data-ttu-id="6a0f5-253">Per visualizzare questa pagina, è possibile usare un browser.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-253">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="6a0f5-254">Si noti che ogni record include ora un'immagine per la categoria.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-254">Note how each record now includes a picture for the category.</span></span>

<span data-ttu-id="6a0f5-255">[![l'immagine della categoria viene visualizzata per ogni riga](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-255">[![The Category s Picture is Displayed for Each Row](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image19.png)</span></span>

<span data-ttu-id="6a0f5-256">**Figura 13**: l'immagine della categoria viene visualizzata per ogni riga ([fare clic per visualizzare l'immagine con dimensioni complete](displaying-binary-data-in-the-data-web-controls-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="6a0f5-256">**Figure 13**: The Category s Picture is Displayed for Each Row ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image20.png))</span></span>

## <a name="summary"></a><span data-ttu-id="6a0f5-257">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="6a0f5-257">Summary</span></span>

<span data-ttu-id="6a0f5-258">In questa esercitazione è stato esaminato come presentare i dati binari.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-258">In this tutorial we examined how to present binary data.</span></span> <span data-ttu-id="6a0f5-259">Il modo in cui vengono presentati i dati dipende dal tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-259">How the data is presented depends on the type of data.</span></span> <span data-ttu-id="6a0f5-260">Per i file della brochure PDF è stato offerto un collegamento alla brochure di visualizzazione che, quando selezionato, ha portato l'utente direttamente al file PDF.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-260">For the PDF brochure files, we offered the user a View Brochure link that, when clicked, took the user directly to the PDF file.</span></span> <span data-ttu-id="6a0f5-261">Per l'immagine della categoria, è stata creata prima di tutto una pagina per recuperare e restituire i dati binari dal database e quindi utilizzare tale pagina per visualizzare l'immagine di ogni categoria in GridView.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-261">For the category s picture, we first created a page to retrieve and return the binary data from the database and then used that page to display each category s picture in a GridView.</span></span>

<span data-ttu-id="6a0f5-262">Ora che si è appreso come visualizzare i dati binari, è possibile esaminare come eseguire operazioni di inserimento, aggiornamento ed eliminazione sul database con i dati binari.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-262">Now that we ve looked at how to display binary data, we re ready to examine how to perform insert, updates, and deletes against the database with the binary data.</span></span> <span data-ttu-id="6a0f5-263">Nell'esercitazione successiva si esaminerà come associare un file caricato al record del database corrispondente.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-263">In the next tutorial we'll look at how to associate an uploaded file with its corresponding database record.</span></span> <span data-ttu-id="6a0f5-264">In seguito, nell'esercitazione verrà illustrato come aggiornare i dati binari esistenti e come eliminare i dati binari quando viene rimosso il record associato.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-264">In the tutorial after that, we'll see how to update existing binary data as well as how to delete the binary data when its associated record is removed.</span></span>

<span data-ttu-id="6a0f5-265">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="6a0f5-265">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="6a0f5-266">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="6a0f5-266">About the Author</span></span>

<span data-ttu-id="6a0f5-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6a0f5-268">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-268">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6a0f5-269">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="6a0f5-269">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="6a0f5-270">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-270">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="6a0f5-271">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="6a0f5-271">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="6a0f5-272">Grazie speciale</span><span class="sxs-lookup"><span data-stu-id="6a0f5-272">Special Thanks To</span></span>

<span data-ttu-id="6a0f5-273">Questa serie di esercitazioni è stata esaminata da molti revisori utili.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-273">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6a0f5-274">I revisori del lead per questa esercitazione erano Teresa Murphy e Dave Gardner.</span><span class="sxs-lookup"><span data-stu-id="6a0f5-274">Lead reviewers for this tutorial were Teresa Murphy and Dave Gardner.</span></span> <span data-ttu-id="6a0f5-275">Sei interessato a esaminare i miei prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="6a0f5-275">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6a0f5-276">In tal caso, rilasciare una riga in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-276">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6a0f5-277">[Precedente](uploading-files-vb.md)
> [Successivo](including-a-file-upload-option-when-adding-a-new-record-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6a0f5-277">[Previous](uploading-files-vb.md)
[Next](including-a-file-upload-option-when-adding-a-new-record-vb.md)</span></span>
