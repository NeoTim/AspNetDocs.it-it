---
uid: web-forms/overview/data-access/custom-button-actions-with-the-datalist-and-repeater/custom-buttons-in-the-datalist-and-repeater-vb
title: Pulsanti personalizzati con DataList e Repeater (VB) | Microsoft Docs
author: rick-anderson
description: In questa esercitazione verrà creata un'interfaccia che utilizza un controllo Repeater per visualizzare l'elenco di categorie nel sistema, con ogni categoria che fornisce un pulsante per visualizzare il associ...
ms.author: riande
ms.date: 11/13/2006
ms.assetid: 1afdb14d-6e49-4e1f-aead-2934730d472e
msc.legacyurl: /web-forms/overview/data-access/custom-button-actions-with-the-datalist-and-repeater/custom-buttons-in-the-datalist-and-repeater-vb
msc.type: authoredcontent
ms.openlocfilehash: f16ab831faf213a467624559f09dafc92826bfe5
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/06/2019
ms.locfileid: "65130711"
---
# <a name="custom-buttons-in-the-datalist-and-repeater-vb"></a><span data-ttu-id="01b9f-103">Pulsanti personalizzati con DataList e Repeater (VB)</span><span class="sxs-lookup"><span data-stu-id="01b9f-103">Custom Buttons in the DataList and Repeater (VB)</span></span>

<span data-ttu-id="01b9f-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="01b9f-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="01b9f-105">[Scaricare l'App di esempio](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_46_VB.exe) o [Scarica il PDF](custom-buttons-in-the-datalist-and-repeater-vb/_static/datatutorial46vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="01b9f-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_46_VB.exe) or [Download PDF](custom-buttons-in-the-datalist-and-repeater-vb/_static/datatutorial46vb1.pdf)</span></span>

> <span data-ttu-id="01b9f-106">In questa esercitazione creeremo un'interfaccia che utilizza un controllo Repeater per visualizzare l'elenco di categorie nel sistema, con ogni categoria che fornisce un pulsante per visualizzare i prodotti connessi con un controllo BulletedList.</span><span class="sxs-lookup"><span data-stu-id="01b9f-106">In this tutorial we'll build an interface that uses a Repeater to list the categories in the system, with each category providing a button to show its associated products using a BulletedList control.</span></span>

## <a name="introduction"></a><span data-ttu-id="01b9f-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="01b9f-107">Introduction</span></span>

<span data-ttu-id="01b9f-108">Durante le esercitazioni precedenti diciassette DataList e Repeater, abbiamo creato sia esempi di sola lettura e modifica e l'eliminazione di esempi.</span><span class="sxs-lookup"><span data-stu-id="01b9f-108">Throughout the past seventeen DataList and Repeater tutorials, we ve created both read-only examples and editing and deleting examples.</span></span> <span data-ttu-id="01b9f-109">Per facilitare la modifica ed eliminazione di funzionalità all'interno di un controllo DataList, i pulsanti sono aggiunte a s DataList `ItemTemplate` che, quando si fa clic, ha provocato un postback e ha generato un evento di DataList corrispondente al pulsante s `CommandName` proprietà.</span><span class="sxs-lookup"><span data-stu-id="01b9f-109">To facilitate editing and deleting capabilities within a DataList, we added buttons to the DataList s `ItemTemplate` that, when clicked, caused a postback and raised a DataList event corresponding to the button s `CommandName` property.</span></span> <span data-ttu-id="01b9f-110">Ad esempio, aggiungendo un pulsante per il `ItemTemplate` con un `CommandName` causa del valore di proprietà di modifica di DataList s `EditCommand` alla quale attivare postback; uno con il `CommandName` Delete genera il `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="01b9f-110">For example, adding a button to the `ItemTemplate` with a `CommandName` property value of Edit causes the DataList s `EditCommand` to fire on postback; one with the `CommandName` Delete raises the `DeleteCommand`.</span></span>

<span data-ttu-id="01b9f-111">Per modificare ed eliminare i pulsanti, anche i controlli DataList e Repeater possono includere anche i pulsanti, i controlli LinkButton o ImageButtons che, quando si fa clic, eseguire una logica personalizzata lato server.</span><span class="sxs-lookup"><span data-stu-id="01b9f-111">In addition to Edit and Delete buttons, the DataList and Repeater controls can also include Buttons, LinkButtons, or ImageButtons that, when clicked, perform some custom server-side logic.</span></span> <span data-ttu-id="01b9f-112">In questa esercitazione creeremo un'interfaccia che utilizza un controllo Repeater per visualizzare l'elenco di categorie nel sistema.</span><span class="sxs-lookup"><span data-stu-id="01b9f-112">In this tutorial we'll build an interface that uses a Repeater to list the categories in the system.</span></span> <span data-ttu-id="01b9f-113">Per ogni categoria, il controllo Repeater includerà un pulsante per visualizzare la categoria di prodotti associati alla usando un controllo BulletedList (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="01b9f-113">For each category, the Repeater will include a button to show the category s associated products using a BulletedList control (see Figure 1).</span></span>

<span data-ttu-id="01b9f-114">[![Facendo clic su Mostra i prodotti collegamento Visualizza i prodotti s categoria in un elenco puntato](custom-buttons-in-the-datalist-and-repeater-vb/_static/image2.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="01b9f-114">[![Clicking the Show Products Link Displays the Category s Products in a Bulleted List](custom-buttons-in-the-datalist-and-repeater-vb/_static/image2.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image1.png)</span></span>

<span data-ttu-id="01b9f-115">**Figura 1**: Facendo clic su Visualizza collegamento Mostra prodotti la categoria s prodotti in un elenco puntato ([fare clic per visualizzare l'immagine con dimensioni normali](custom-buttons-in-the-datalist-and-repeater-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="01b9f-115">**Figure 1**: Clicking the Show Products Link Displays the Category s Products in a Bulleted List ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-vb/_static/image3.png))</span></span>

## <a name="step-1-adding-the-custom-button-tutorial-web-pages"></a><span data-ttu-id="01b9f-116">Passaggio 1: Aggiunta di pagine Web di esercitazione pulsante personalizzato</span><span class="sxs-lookup"><span data-stu-id="01b9f-116">Step 1: Adding the Custom Button Tutorial Web Pages</span></span>

<span data-ttu-id="01b9f-117">Prima di esaminare come aggiungere un pulsante personalizzato, consentire s prima di tutto si consiglia di creare le pagine ASP.NET nel progetto di sito Web che è necessario per questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="01b9f-117">Before we look at how to add a custom button, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial.</span></span> <span data-ttu-id="01b9f-118">Iniziare aggiungendo una nuova cartella denominata `CustomButtonsDataListRepeater`.</span><span class="sxs-lookup"><span data-stu-id="01b9f-118">Start by adding a new folder named `CustomButtonsDataListRepeater`.</span></span> <span data-ttu-id="01b9f-119">Successivamente, aggiungere le seguenti due pagine ASP.NET per quella cartella, assicurandosi di associare ogni pagina con il `Site.master` pagina master:</span><span class="sxs-lookup"><span data-stu-id="01b9f-119">Next, add the following two ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `CustomButtons.aspx`

![Aggiungere le pagine ASP.NET per le esercitazioni relative ai pulsanti personalizzate](custom-buttons-in-the-datalist-and-repeater-vb/_static/image4.png)

<span data-ttu-id="01b9f-121">**Figura 2**: Aggiungere le pagine ASP.NET per le esercitazioni relative ai pulsanti personalizzate</span><span class="sxs-lookup"><span data-stu-id="01b9f-121">**Figure 2**: Add the ASP.NET Pages for the Custom Buttons-Related Tutorials</span></span>

<span data-ttu-id="01b9f-122">In altre cartelle, analogo a `Default.aspx` nella `CustomButtonsDataListRepeater` cartella elencherà le esercitazioni nella relativa sezione.</span><span class="sxs-lookup"><span data-stu-id="01b9f-122">Like in the other folders, `Default.aspx` in the `CustomButtonsDataListRepeater` folder will list the tutorials in its section.</span></span> <span data-ttu-id="01b9f-123">Si tenga presente che il `SectionLevelTutorialListing.ascx` controllo utente fornisce questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="01b9f-123">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="01b9f-124">Aggiungere questo controllo utente alla `Default.aspx` trascinandolo da Esplora soluzioni nella pagina di visualizzazione della struttura s.</span><span class="sxs-lookup"><span data-stu-id="01b9f-124">Add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="01b9f-125">[![Aggiungere il controllo utente sectionleveltutoriallisting. ascx a default. aspx](custom-buttons-in-the-datalist-and-repeater-vb/_static/image6.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="01b9f-125">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](custom-buttons-in-the-datalist-and-repeater-vb/_static/image6.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image5.png)</span></span>

<span data-ttu-id="01b9f-126">**Figura 3**: Aggiungere il `SectionLevelTutorialListing.ascx` controllo utente da `Default.aspx` ([fare clic per visualizzare l'immagine con dimensioni normali](custom-buttons-in-the-datalist-and-repeater-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="01b9f-126">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-vb/_static/image7.png))</span></span>

<span data-ttu-id="01b9f-127">Infine, aggiungere le pagine come voci per il `Web.sitemap` file.</span><span class="sxs-lookup"><span data-stu-id="01b9f-127">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="01b9f-128">In particolare, aggiungere il markup seguente dopo il Paging e ordinamento con DataList e Repeater `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="01b9f-128">Specifically, add the following markup after the Paging and Sorting with the DataList and Repeater `<siteMapNode>`:</span></span>

[!code-xml[Main](custom-buttons-in-the-datalist-and-repeater-vb/samples/sample1.xml)]

<span data-ttu-id="01b9f-129">Dopo aver aggiornato `Web.sitemap`, si consiglia di visualizzare il sito Web di esercitazioni tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="01b9f-129">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="01b9f-130">Il menu a sinistra ora include elementi per la modifica, inserimento ed eliminazione di esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="01b9f-130">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![Mappa del sito include ora la voce per l'esercitazione di pulsanti personalizzati](custom-buttons-in-the-datalist-and-repeater-vb/_static/image8.png)

<span data-ttu-id="01b9f-132">**Figura 4**: Mappa del sito include ora la voce per l'esercitazione di pulsanti personalizzati</span><span class="sxs-lookup"><span data-stu-id="01b9f-132">**Figure 4**: The Site Map Now Includes the Entry for the Custom Buttons Tutorial</span></span>

## <a name="step-2-adding-the-list-of-categories"></a><span data-ttu-id="01b9f-133">Passaggio 2: Aggiunta dell'elenco delle categorie</span><span class="sxs-lookup"><span data-stu-id="01b9f-133">Step 2: Adding the List of Categories</span></span>

<span data-ttu-id="01b9f-134">Per questa esercitazione è necessario creare un controllo Repeater che elenca tutte le categorie e LinkButton prodotti mostra che, quando si fa clic, consente di visualizzare i prodotti di categoria associata s in un elenco puntato.</span><span class="sxs-lookup"><span data-stu-id="01b9f-134">For this tutorial we need to create a Repeater that lists all categories along with a Show Products LinkButton that, when clicked, displays the associated category s products in a bulleted list.</span></span> <span data-ttu-id="01b9f-135">Consentire s prima di tutto creare un semplice controllo Repeater che elenca le categorie nel sistema.</span><span class="sxs-lookup"><span data-stu-id="01b9f-135">Let s first create a simple Repeater that lists the categories in the system.</span></span> <span data-ttu-id="01b9f-136">Iniziare aprendo il `CustomButtons.aspx` nella pagina di `CustomButtonsDataListRepeater` cartella.</span><span class="sxs-lookup"><span data-stu-id="01b9f-136">Start by opening the `CustomButtons.aspx` page in the `CustomButtonsDataListRepeater` folder.</span></span> <span data-ttu-id="01b9f-137">Trascinare un controllo Repeater dalla casella degli strumenti nella finestra di progettazione e set relativo `ID` proprietà `Categories`.</span><span class="sxs-lookup"><span data-stu-id="01b9f-137">Drag a Repeater from the Toolbox onto the Designer and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="01b9f-138">Successivamente, creare un nuovo controllo origine dati nello smart tag s Repeater.</span><span class="sxs-lookup"><span data-stu-id="01b9f-138">Next, create a new data source control from the Repeater s smart tag.</span></span> <span data-ttu-id="01b9f-139">In particolare, creare un nuovo controllo ObjectDataSource denominato `CategoriesDataSource` che consente di selezionare i dati dal `CategoriesBLL` classe s `GetCategories()` (metodo).</span><span class="sxs-lookup"><span data-stu-id="01b9f-139">Specifically, create a new ObjectDataSource control named `CategoriesDataSource` that selects its data from the `CategoriesBLL` class s `GetCategories()` method.</span></span>

<span data-ttu-id="01b9f-140">[![Configurare ObjectDataSource per usare il metodo di classe CategoriesBLL s GetCategories()](custom-buttons-in-the-datalist-and-repeater-vb/_static/image10.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="01b9f-140">[![Configure the ObjectDataSource to Use the CategoriesBLL Class s GetCategories() Method](custom-buttons-in-the-datalist-and-repeater-vb/_static/image10.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image9.png)</span></span>

<span data-ttu-id="01b9f-141">**Figura 5**: Configurare ObjectDataSource per usare la `CategoriesBLL` classe s `GetCategories()` metodo ([fare clic per visualizzare l'immagine con dimensioni normali](custom-buttons-in-the-datalist-and-repeater-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="01b9f-141">**Figure 5**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class s `GetCategories()` Method ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-vb/_static/image11.png))</span></span>

<span data-ttu-id="01b9f-142">A differenza del controllo DataList, per cui Visual Studio crea un valore predefinito `ItemTemplate` basato sull'origine dati, i modelli di Repeater s devono essere definiti manualmente.</span><span class="sxs-lookup"><span data-stu-id="01b9f-142">Unlike the DataList control, for which Visual Studio creates a default `ItemTemplate` based on the data source, the Repeater s templates must be manually defined.</span></span> <span data-ttu-id="01b9f-143">Inoltre, i modelli di Repeater s devono essere creati e modificati in modo dichiarativo (vale a dire, 3!s ci alcuna modifica modelli non opzione nello smart tag Repeater s).</span><span class="sxs-lookup"><span data-stu-id="01b9f-143">Furthermore, the Repeater s templates must be created and edited declaratively (that is, there s no Edit Templates option in the Repeater s smart tag).</span></span>

<span data-ttu-id="01b9f-144">Fare clic sulla scheda origine nell'angolo inferiore sinistro e aggiungere un `ItemTemplate` che visualizza il nome della categoria s in un `<h3>` elemento e la rispettiva descrizione in un paragrafo di tag, includere una `SeparatorTemplate` che consente di visualizzare un righello orizzontale (`<hr />`) tra ogni categoria.</span><span class="sxs-lookup"><span data-stu-id="01b9f-144">Click on the Source tab in the bottom left corner and add an `ItemTemplate` that displays the category s name in an `<h3>` element and its description in a paragraph tag; include a `SeparatorTemplate` that displays a horizontal rule (`<hr />`) between each category.</span></span> <span data-ttu-id="01b9f-145">Aggiungere anche un elemento LinkButton con il relativo `Text` proprietà è impostata su Mostra i prodotti.</span><span class="sxs-lookup"><span data-stu-id="01b9f-145">Also add a LinkButton with its `Text` property set to Show Products.</span></span> <span data-ttu-id="01b9f-146">Dopo aver completato questi passaggi, il markup dichiarativo s pagina dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="01b9f-146">After completing these steps, your page s declarative markup should look like the following:</span></span>

[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-vb/samples/sample2.aspx)]

<span data-ttu-id="01b9f-147">Figura 6 mostra la pagina quando viene visualizzato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="01b9f-147">Figure 6 shows the page when viewed through a browser.</span></span> <span data-ttu-id="01b9f-148">Viene elencato ogni nome di categoria e una descrizione.</span><span class="sxs-lookup"><span data-stu-id="01b9f-148">Each category name and description is listed.</span></span> <span data-ttu-id="01b9f-149">Pulsante Mostra prodotti, quando si fa clic, causa un postback, ma non esegue ancora alcuna operazione.</span><span class="sxs-lookup"><span data-stu-id="01b9f-149">The Show Products button, when clicked, causes a postback but does not yet perform any action.</span></span>

<span data-ttu-id="01b9f-150">[![Ogni nome di categoria e la descrizione viene visualizzato, insieme a mostrare LinkButton prodotti](custom-buttons-in-the-datalist-and-repeater-vb/_static/image13.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="01b9f-150">[![Each Category s Name and Description is Displayed, Along with a Show Products LinkButton](custom-buttons-in-the-datalist-and-repeater-vb/_static/image13.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image12.png)</span></span>

<span data-ttu-id="01b9f-151">**Figura 6**: Ogni nome di categoria e la descrizione viene visualizzato, insieme a mostrare LinkButton prodotti ([fare clic per visualizzare l'immagine con dimensioni normali](custom-buttons-in-the-datalist-and-repeater-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="01b9f-151">**Figure 6**: Each Category s Name and Description is Displayed, Along with a Show Products LinkButton ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-vb/_static/image14.png))</span></span>

## <a name="step-3-executing-server-side-logic-when-the-show-products-linkbutton-is-clicked"></a><span data-ttu-id="01b9f-152">Passaggio 3: Esecuzione lato Server per la logica quando il Mostra prodotti LinkButton si fa clic su</span><span class="sxs-lookup"><span data-stu-id="01b9f-152">Step 3: Executing Server-Side Logic When the Show Products LinkButton is Clicked</span></span>

<span data-ttu-id="01b9f-153">Ogni volta che viene scelto un pulsante, LinkButton o ImageButton all'interno di un modello in un controllo DataList o Repeater, si verifica un postback e il controllo DataList o Repeater s `ItemCommand` viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="01b9f-153">Anytime a Button, LinkButton, or ImageButton within a template in a DataList or Repeater is clicked, a postback occurs and the DataList or Repeater s `ItemCommand` event fires.</span></span> <span data-ttu-id="01b9f-154">Oltre al `ItemCommand` evento, DataList controllo può anche generare un altro evento più specifico se il pulsante s `CommandName` è impostata su una delle stringhe riservate (Elimina, modifica, Cancel, Update o Select), ma il `ItemCommand` evento è *sempre* generato.</span><span class="sxs-lookup"><span data-stu-id="01b9f-154">In addition to the `ItemCommand` event, the DataList control may also raise another, more specific event if the button s `CommandName` property is set to one of the reserved strings ( Delete, Edit, Cancel, Update, or Select ), but the `ItemCommand` event is *always* fired.</span></span>

<span data-ttu-id="01b9f-155">Quando viene selezionato un pulsante all'interno di un controllo DataList o Repeater, spesso è necessario passare il pulsante scelto (nel caso che potrebbero esserci più pulsanti all'interno del controllo, ad esempio sia una modifica e sul pulsante Elimina) e magari alcune informazioni aggiuntive (ad esempio il valore di chiave primaria dell'elemento è stato fatto clic sul cui pulsante).</span><span class="sxs-lookup"><span data-stu-id="01b9f-155">When a button is clicked within a DataList or Repeater, oftentimes we need to pass along which button was clicked (in the case that there may be multiple buttons within the control, such as both an Edit and Delete button) and perhaps some additional information (such as the primary key value of the item whose button was clicked).</span></span> <span data-ttu-id="01b9f-156">Il pulsante LinkButton e ImageButton fornisce due proprietà i cui valori vengono passati al `ItemCommand` gestore dell'evento:</span><span class="sxs-lookup"><span data-stu-id="01b9f-156">The Button, LinkButton, and ImageButton provide two properties whose values are passed to the `ItemCommand` event handler:</span></span>

- <span data-ttu-id="01b9f-157">`CommandName` una stringa in genere utilizzata per identificare ogni pulsante del modello</span><span class="sxs-lookup"><span data-stu-id="01b9f-157">`CommandName` a string typically used to identify each button in the template</span></span>
- <span data-ttu-id="01b9f-158">`CommandArgument` in genere utilizzata per contenere il valore di un campo di dati, ad esempio il valore della chiave primaria</span><span class="sxs-lookup"><span data-stu-id="01b9f-158">`CommandArgument` commonly used to hold the value of some data field, such as the primary key value</span></span>

<span data-ttu-id="01b9f-159">Per questo esempio, impostare la s LinkButton `CommandName` proprietà ShowProducts e associare il valore di chiave primaria corrente di record s `CategoryID` per il `CommandArgument` proprietà usando la sintassi di associazione dati `CategoryArgument='<%# Eval("CategoryID") %>'`.</span><span class="sxs-lookup"><span data-stu-id="01b9f-159">For this example, set the LinkButton s `CommandName` property to ShowProducts and bind the current record s primary key value `CategoryID` to the `CommandArgument` property using the databinding syntax `CategoryArgument='<%# Eval("CategoryID") %>'`.</span></span> <span data-ttu-id="01b9f-160">Dopo aver specificato queste due proprietà, la sintassi dichiarativa s LinkButton dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="01b9f-160">After specifying these two properties, the LinkButton s declarative syntax should look like the following:</span></span>

[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-vb/samples/sample3.aspx)]

<span data-ttu-id="01b9f-161">Quando fa clic sul pulsante, si verifica un postback e il controllo DataList o Repeater s `ItemCommand` viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="01b9f-161">When the button is clicked, a postback occurs and the DataList or Repeater s `ItemCommand` event fires.</span></span> <span data-ttu-id="01b9f-162">Il gestore dell'evento viene passato sul pulsante s `CommandName` e `CommandArgument` valori.</span><span class="sxs-lookup"><span data-stu-id="01b9f-162">The event handler is passed the button s `CommandName` and `CommandArgument` values.</span></span>

<span data-ttu-id="01b9f-163">Creare un gestore eventi per il controllo Repeater s `ItemCommand` eventi e notare il secondo parametro passato nel gestore dell'evento (denominato `e`).</span><span class="sxs-lookup"><span data-stu-id="01b9f-163">Create an event handler for the Repeater s `ItemCommand` event and note the second parameter passed into the event handler (named `e`).</span></span> <span data-ttu-id="01b9f-164">Il secondo parametro è di tipo [ `RepeaterCommandEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeatercommandeventargs.aspx) e presenta le seguenti quattro proprietà:</span><span class="sxs-lookup"><span data-stu-id="01b9f-164">This second parameter is of type [`RepeaterCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeatercommandeventargs.aspx) and has the following four properties:</span></span>

- <span data-ttu-id="01b9f-165">`CommandArgument` il valore del pulsante selezionato s `CommandArgument` proprietà</span><span class="sxs-lookup"><span data-stu-id="01b9f-165">`CommandArgument` the value of the clicked button s `CommandArgument` property</span></span>
- <span data-ttu-id="01b9f-166">`CommandName` il valore del pulsante s `CommandName` proprietà</span><span class="sxs-lookup"><span data-stu-id="01b9f-166">`CommandName` the value of the button s `CommandName` property</span></span>
- <span data-ttu-id="01b9f-167">`CommandSource` un riferimento al controllo che è stato fatto clic sul pulsante</span><span class="sxs-lookup"><span data-stu-id="01b9f-167">`CommandSource` a reference to the button control that was clicked</span></span>
- <span data-ttu-id="01b9f-168">`Item` un riferimento per la [ `RepeaterItem` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem.aspx) che contiene il pulsante su cui è stato fatto clic; è rappresentata da ogni record associato al controllo Repeater un `RepeaterItem`</span><span class="sxs-lookup"><span data-stu-id="01b9f-168">`Item` a reference to the [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem.aspx) that contains the button that was clicked; each record bound to the Repeater is manifested as a `RepeaterItem`</span></span>

<span data-ttu-id="01b9f-169">Poiché la categoria selezionata s `CategoryID` viene passato tramite il `CommandArgument` proprietà, è possibile ottenere il set di prodotti associati alla categoria selezionata nel `ItemCommand` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="01b9f-169">Since the selected category s `CategoryID` is passed in via the `CommandArgument` property, we can get the set of products associated with the selected category in the `ItemCommand` event handler.</span></span> <span data-ttu-id="01b9f-170">Questi prodotti possono quindi essere associati a un controllo BulletedList nel `ItemTemplate` (quale abbiamo ve ancora da aggiungere).</span><span class="sxs-lookup"><span data-stu-id="01b9f-170">These products can then be bound to a BulletedList control in the `ItemTemplate` (which we ve yet to add).</span></span> <span data-ttu-id="01b9f-171">Tutto ciò che rimane, quindi, consiste nell'aggiungere BulletedList, farvi riferimento nel `ItemCommand` gestore eventi e associare ad esso il set di prodotti per la categoria selezionata, che verranno affrontati nel passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="01b9f-171">All that remains, then, is to add the BulletedList, reference it in the `ItemCommand` event handler, and bind to it the set of products for the selected category, which we'll tackle in Step 4.</span></span>

> [!NOTE]
> <span data-ttu-id="01b9f-172">S DataList `ItemCommand` gestore dell'evento viene passato un oggetto di tipo [ `DataListCommandEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistcommandeventargs.aspx), che offre le stesse quattro proprietà il `RepeaterCommandEventArgs` classe.</span><span class="sxs-lookup"><span data-stu-id="01b9f-172">The DataList s `ItemCommand` event handler is passed an object of type [`DataListCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistcommandeventargs.aspx), which offers the same four properties as the `RepeaterCommandEventArgs` class.</span></span>

## <a name="step-4-displaying-the-selected-category-s-products-in-a-bulleted-list"></a><span data-ttu-id="01b9f-173">Passaggio 4: Visualizzare i prodotti s categoria selezionata in un elenco puntato</span><span class="sxs-lookup"><span data-stu-id="01b9f-173">Step 4: Displaying the Selected Category s Products in a Bulleted List</span></span>

<span data-ttu-id="01b9f-174">I prodotti della categoria selezionata s possono essere visualizzati all'interno di Repeater s `ItemTemplate` usando qualsiasi numero di controlli.</span><span class="sxs-lookup"><span data-stu-id="01b9f-174">The selected category s products can be displayed within the Repeater s `ItemTemplate` using any number of controls.</span></span> <span data-ttu-id="01b9f-175">È stato possibile aggiungere che un altro annidati Repeater, DataList, un controllo DropDownList, un controllo GridView e così via.</span><span class="sxs-lookup"><span data-stu-id="01b9f-175">We could add another nested Repeater, a DataList, a DropDownList, a GridView, and so on.</span></span> <span data-ttu-id="01b9f-176">Poiché si vogliono visualizzare i prodotti come un elenco puntato, tuttavia, si userà il controllo BulletedList.</span><span class="sxs-lookup"><span data-stu-id="01b9f-176">Since we want to display the products as a bulleted list, though, we'll use the BulletedList control.</span></span> <span data-ttu-id="01b9f-177">Restituzione per il `CustomButtons.aspx` pagina markup dichiarativo s, aggiungere un controllo BulletedList il `ItemTemplate` dopo il LinkButton Mostra i prodotti.</span><span class="sxs-lookup"><span data-stu-id="01b9f-177">Returning to the `CustomButtons.aspx` page s declarative markup, add a BulletedList control to the `ItemTemplate` after the Show Products LinkButton.</span></span> <span data-ttu-id="01b9f-178">Impostare la s BulletedLists `ID` a `ProductsInCategory`.</span><span class="sxs-lookup"><span data-stu-id="01b9f-178">Set the BulletedLists s `ID` to `ProductsInCategory`.</span></span> <span data-ttu-id="01b9f-179">BulletedList Visualizza il valore del campo dati specificato tramite il `DataTextField` proprietà; poiché questo controllo contiene informazioni sui prodotti a esso associati, impostare il `DataTextField` proprietà `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="01b9f-179">The BulletedList displays the value of the data field specified via the `DataTextField` property; since this control will have product information bound to it, set the `DataTextField` property to `ProductName`.</span></span>

[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-vb/samples/sample4.aspx)]

<span data-ttu-id="01b9f-180">Nel `ItemCommand` gestore dell'evento, fare riferimento a questo controllo tramite `e.Item.FindControl("ProductsInCategory")` e associarlo al set di prodotti associati alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="01b9f-180">In the `ItemCommand` event handler, reference this control using `e.Item.FindControl("ProductsInCategory")` and bind it to the set of products associated with the selected category.</span></span>

[!code-vb[Main](custom-buttons-in-the-datalist-and-repeater-vb/samples/sample5.vb)]

<span data-ttu-id="01b9f-181">Prima di eseguire qualsiasi azione nella `ItemCommand` gestore eventi, è s prudente prima di tutto controllare il valore della matrice in ingresso `CommandName`.</span><span class="sxs-lookup"><span data-stu-id="01b9f-181">Before performing any action in the `ItemCommand` event handler, it s prudent to first check the value of the incoming `CommandName`.</span></span> <span data-ttu-id="01b9f-182">Poiché il `ItemCommand` gestore dell'evento viene attivata quando si *qualsiasi* si fa clic sul pulsante, se sono presenti i pulsanti più in uso il modello di `CommandName` valore distinguere l'azione da intraprendere.</span><span class="sxs-lookup"><span data-stu-id="01b9f-182">Since the `ItemCommand` event handler fires when *any* button is clicked, if there are multiple buttons in the template use the `CommandName` value to discern what action to take.</span></span> <span data-ttu-id="01b9f-183">Verifica la `CommandName` Ecco perde di valore, poiché sono presenti solo un singolo pulsante, ma è un'operazione consigliabile al form.</span><span class="sxs-lookup"><span data-stu-id="01b9f-183">Checking the `CommandName` here is moot, since we only have a single button, but it is a good habit to form.</span></span> <span data-ttu-id="01b9f-184">Successivamente, il `CategoryID` della categoria selezionata viene recuperato dal `CommandArgument` proprietà.</span><span class="sxs-lookup"><span data-stu-id="01b9f-184">Next, the `CategoryID` of the selected category is retrieved from the `CommandArgument` property.</span></span> <span data-ttu-id="01b9f-185">Il controllo BulletedList nel modello viene quindi fatto riferimento e associato ai risultati del `ProductsBLL` classe s `GetProductsByCategoryID(categoryID)` (metodo).</span><span class="sxs-lookup"><span data-stu-id="01b9f-185">The BulletedList control in the template is then referenced and bound to the results of the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="01b9f-186">Nelle esercitazioni precedenti che utilizzati i pulsanti all'interno di un controllo DataList, come [una panoramica di modifica e l'eliminazione dei dati in DataList](../editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md), è stato determinato il valore di chiave primaria di un elemento specificato tramite la `DataKeys` raccolta.</span><span class="sxs-lookup"><span data-stu-id="01b9f-186">In previous tutorials that used the buttons within a DataList, such as [An Overview of Editing and Deleting Data in the DataList](../editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md), we determined the primary key value of a given item via the `DataKeys` collection.</span></span> <span data-ttu-id="01b9f-187">Sebbene questo approccio funziona bene con DataList, Repeater non ha un `DataKeys` proprietà.</span><span class="sxs-lookup"><span data-stu-id="01b9f-187">While this approach works well with the DataList, the Repeater does not have a `DataKeys` property.</span></span> <span data-ttu-id="01b9f-188">In alternativa, è necessario usare un approccio alternativo per specificare il valore di chiave primaria, ad esempio tramite il pulsante s `CommandArgument` proprietà o assegnando il valore della chiave primaria a un controllo etichetta Web nascosto all'interno del modello e lettura del valore corrispondente nella `ItemCommand`gestore di evento utilizzando `e.Item.FindControl("LabelID")`.</span><span class="sxs-lookup"><span data-stu-id="01b9f-188">Instead, we must use an alternative approach for supplying the primary key value, such as through the button s `CommandArgument` property or by assigning the primary key value to a hidden Label Web control within the template and reading its value back in the `ItemCommand` event handler using `e.Item.FindControl("LabelID")`.</span></span>

<span data-ttu-id="01b9f-189">Dopo aver completato la `ItemCommand` gestore eventi, si consiglia di testare questa pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="01b9f-189">After completing the `ItemCommand` event handler, take a moment to test out this page in a browser.</span></span> <span data-ttu-id="01b9f-190">Come illustrato nella figura 7, facendo clic su Mostra prodotti collegamento determina un postback e visualizza i prodotti per la categoria selezionata in un BulletedList.</span><span class="sxs-lookup"><span data-stu-id="01b9f-190">As Figure 7 shows, clicking the Show Products link causes a postback and displays the products for the selected category in a BulletedList.</span></span> <span data-ttu-id="01b9f-191">Si noti inoltre che le informazioni sui prodotti rimanga, anche se altre categorie di collegamenti di visualizzare i prodotti vengono selezionati.</span><span class="sxs-lookup"><span data-stu-id="01b9f-191">Furthermore, note that this product information remains, even if other categories Show Products links are clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="01b9f-192">Se si desidera modificare il comportamento di questo report, in modo che i prodotti solo una categoria s sono elencati in un momento, è sufficiente impostare il controllo BulletedList 1!s `EnableViewState` proprietà `False`.</span><span class="sxs-lookup"><span data-stu-id="01b9f-192">If you want to modify the behavior of this report, such that the only one category s products are listed at a time, simply set the BulletedList control s `EnableViewState` property to `False`.</span></span>

<span data-ttu-id="01b9f-193">[![Un BulletedList viene usato per visualizzare i prodotti della categoria selezionata](custom-buttons-in-the-datalist-and-repeater-vb/_static/image16.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="01b9f-193">[![A BulletedList is used to Display the Products of the Selected Category](custom-buttons-in-the-datalist-and-repeater-vb/_static/image16.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image15.png)</span></span>

<span data-ttu-id="01b9f-194">**Figura 7**: Un BulletedList viene usato per visualizzare i prodotti della categoria selezionata ([fare clic per visualizzare l'immagine con dimensioni normali](custom-buttons-in-the-datalist-and-repeater-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="01b9f-194">**Figure 7**: A BulletedList is used to Display the Products of the Selected Category ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-vb/_static/image17.png))</span></span>

## <a name="summary"></a><span data-ttu-id="01b9f-195">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="01b9f-195">Summary</span></span>

<span data-ttu-id="01b9f-196">I controlli DataList e Repeater possono includere qualsiasi numero di pulsanti, i controlli LinkButton o ImageButtons all'interno dei modelli.</span><span class="sxs-lookup"><span data-stu-id="01b9f-196">The DataList and Repeater controls can include any number of Buttons, LinkButtons, or ImageButtons within their templates.</span></span> <span data-ttu-id="01b9f-197">Questi pulsanti, quando si fa clic, possono causare un postback e generare il `ItemCommand` evento.</span><span class="sxs-lookup"><span data-stu-id="01b9f-197">Such buttons, when clicked, cause a postback and raise the `ItemCommand` event.</span></span> <span data-ttu-id="01b9f-198">Per associare un pulsante di selezione azione personalizzata sul lato server, creare un gestore eventi per il `ItemCommand` evento.</span><span class="sxs-lookup"><span data-stu-id="01b9f-198">To associate custom server-side action with a button being clicked, create an event handler for the `ItemCommand` event.</span></span> <span data-ttu-id="01b9f-199">In questo gestore eventi, controllare innanzi tutto in ingresso `CommandName` valore per determinare quale pulsante è stato fatto clic.</span><span class="sxs-lookup"><span data-stu-id="01b9f-199">In this event handler first check the incoming `CommandName` value to determine which button was clicked.</span></span> <span data-ttu-id="01b9f-200">Informazioni aggiuntive, facoltativamente, possono essere fornite tramite il pulsante s `CommandArgument` proprietà.</span><span class="sxs-lookup"><span data-stu-id="01b9f-200">Additional information can optionally be supplied through the button s `CommandArgument` property.</span></span>

<span data-ttu-id="01b9f-201">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="01b9f-201">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="01b9f-202">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="01b9f-202">About the Author</span></span>

<span data-ttu-id="01b9f-203">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="01b9f-203">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="01b9f-204">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="01b9f-204">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="01b9f-205">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="01b9f-205">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="01b9f-206">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="01b9f-206">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="01b9f-207">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="01b9f-207">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="01b9f-208">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="01b9f-208">Special Thanks To</span></span>

<span data-ttu-id="01b9f-209">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="01b9f-209">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="01b9f-210">Il revisore capo di questa esercitazione è stata Dennis Patterson.</span><span class="sxs-lookup"><span data-stu-id="01b9f-210">Lead reviewer for this tutorial was Dennis Patterson.</span></span> <span data-ttu-id="01b9f-211">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="01b9f-211">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="01b9f-212">In questo caso, Inviami una riga in corrispondenza [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="01b9f-212">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="01b9f-213">Precedente</span><span class="sxs-lookup"><span data-stu-id="01b9f-213">Previous</span></span>](custom-buttons-in-the-datalist-and-repeater-cs.md)
