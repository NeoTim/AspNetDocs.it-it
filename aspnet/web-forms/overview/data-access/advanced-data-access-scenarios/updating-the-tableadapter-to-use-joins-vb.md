---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
title: Aggiornamento del TableAdapter per l'utilizzo di JOIN (VB) | Microsoft Docs
author: rick-anderson
description: Quando si utilizza un database, è comune richiedere dati distribuiti tra più tabelle. Per recuperare i dati da due tabelle diverse, è possibile usare...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: e624a3e0-061b-4efc-8b0e-5877f9ff6714
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
msc.type: authoredcontent
ms.openlocfilehash: 5c94baa99b126cdd24d69afc3d02bfe8b069419b
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/28/2019
ms.locfileid: "74604173"
---
# <a name="updating-the-tableadapter-to-use-joins-vb"></a><span data-ttu-id="fe81c-104">Aggiornamento del TableAdapter per l'uso dei join (VB)</span><span class="sxs-lookup"><span data-stu-id="fe81c-104">Updating the TableAdapter to Use JOINs (VB)</span></span>

<span data-ttu-id="fe81c-105">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="fe81c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="fe81c-106">[Scarica codice](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) o [Scarica PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="fe81c-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span></span>

> <span data-ttu-id="fe81c-107">Quando si utilizza un database, è comune richiedere dati distribuiti tra più tabelle.</span><span class="sxs-lookup"><span data-stu-id="fe81c-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="fe81c-108">Per recuperare dati da due tabelle diverse, è possibile utilizzare una sottoquery correlata o un'operazione di JOIN.</span><span class="sxs-lookup"><span data-stu-id="fe81c-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="fe81c-109">In questa esercitazione vengono confrontate le sottoquery correlate e la sintassi di JOIN prima di esaminare come creare un TableAdapter che includa un JOIN nella relativa query principale.</span><span class="sxs-lookup"><span data-stu-id="fe81c-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>

## <a name="introduction"></a><span data-ttu-id="fe81c-110">Introduzione</span><span class="sxs-lookup"><span data-stu-id="fe81c-110">Introduction</span></span>

<span data-ttu-id="fe81c-111">Con i database relazionali, i dati di cui si è interessati a lavorare sono spesso distribuiti in più tabelle.</span><span class="sxs-lookup"><span data-stu-id="fe81c-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="fe81c-112">Ad esempio, quando si visualizzano le informazioni sul prodotto, è probabile che si desideri elencare i nomi dei fornitori e delle categorie corrispondenti di ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="fe81c-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="fe81c-113">La tabella `Products` dispone di valori `CategoryID` e `SupplierID`, ma i nomi di categoria e fornitore effettivi sono rispettivamente nelle tabelle `Categories` e `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="fe81c-114">Per recuperare informazioni da un'altra tabella correlata, è possibile usare *sottoquery correlate* *o `JOIN`.*</span><span class="sxs-lookup"><span data-stu-id="fe81c-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="fe81c-115">Una sottoquery correlata è una query `SELECT` nidificata che fa riferimento a colonne della query esterna.</span><span class="sxs-lookup"><span data-stu-id="fe81c-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="fe81c-116">Nell'esercitazione [creazione di un livello di accesso ai dati](../introduction/creating-a-data-access-layer-vb.md) , ad esempio, sono state usate due sottoquery correlate nella query principale di `ProductsTableAdapter` s per restituire i nomi di categoria e Supplier per ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="fe81c-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="fe81c-117">Un `JOIN` è un costrutto SQL che unisce le righe correlate di due tabelle diverse.</span><span class="sxs-lookup"><span data-stu-id="fe81c-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="fe81c-118">Per visualizzare le informazioni sulle categorie insieme a ogni prodotto è stata usata una `JOIN` nell'esercitazione sui [dati di query con il controllo SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="fe81c-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="fe81c-119">Il motivo per cui si è astenuta l'uso di `JOIN` s con gli oggetti TableAdapter è dovuto a limitazioni nella procedura guidata di TableAdapter per generare automaticamente le istruzioni `INSERT`, `UPDATE`e `DELETE` corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="fe81c-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="fe81c-120">In particolare, se la query principale di TableAdapter contiene `JOIN` s, il TableAdapter non è in grado di creare automaticamente le istruzioni SQL ad hoc o le stored procedure per le proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="fe81c-121">In questa esercitazione si confronteranno brevemente e si contrasteranno le sottoquery correlate e `JOIN` s prima di esplorare come creare un TableAdapter che includa `JOIN` nella query principale.</span><span class="sxs-lookup"><span data-stu-id="fe81c-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="fe81c-122">Confronto e contrasto tra sottoquery correlate e`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="fe81c-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="fe81c-123">Tenere presente che il `ProductsTableAdapter` creato nella prima esercitazione del set di dati `Northwind` USA sottoquery correlate per ripristinare la categoria e il nome del fornitore corrispondenti di ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="fe81c-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="fe81c-124">La query principale `ProductsTableAdapter` s è illustrata di seguito.</span><span class="sxs-lookup"><span data-stu-id="fe81c-124">The `ProductsTableAdapter` s main query is shown below.</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample1.sql)]

<span data-ttu-id="fe81c-125">Le due sottoquery correlate: `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` e `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` sono `SELECT` query che restituiscono un singolo valore per prodotto come colonna aggiuntiva nell'elenco di colonne dell'istruzione `SELECT` esterna.</span><span class="sxs-lookup"><span data-stu-id="fe81c-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="fe81c-126">In alternativa, è possibile utilizzare un `JOIN` per restituire il fornitore e il nome della categoria di ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="fe81c-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="fe81c-127">La query seguente restituisce lo stesso output di quello precedente, ma usa `JOIN` s al posto delle sottoquery:</span><span class="sxs-lookup"><span data-stu-id="fe81c-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample2.sql)]

<span data-ttu-id="fe81c-128">Un `JOIN` unisce i record di una tabella con i record di un'altra tabella in base ad alcuni criteri.</span><span class="sxs-lookup"><span data-stu-id="fe81c-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="fe81c-129">Nella query precedente, ad esempio, il `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` indica SQL Server di unire ogni record di prodotto con il record di categoria il cui valore `CategoryID` corrisponde al valore `CategoryID` del prodotto.</span><span class="sxs-lookup"><span data-stu-id="fe81c-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="fe81c-130">Il risultato Unito consente di usare i campi di categoria corrispondenti per ogni prodotto, ad esempio `CategoryName`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="fe81c-131">per l'esecuzione di query sui dati dei database relazionali vengono comunemente usati `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="fe81c-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="fe81c-132">Se non si ha familiarità con la sintassi di `JOIN` o se è necessario riattivarne l'utilizzo, è consigliabile eseguire l' [esercitazione su SQL Join](http://www.w3schools.com/sql/sql_join.asp) in [W3 Schools](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="fe81c-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="fe81c-133">Vale la pena leggere anche le sezioni nozioni fondamentali [`JOIN`](https://msdn.microsoft.com/library/ms191517.aspx) e [sottoquery](https://msdn.microsoft.com/library/ms189575.aspx) della [documentazione online di SQL](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="fe81c-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>

<span data-ttu-id="fe81c-134">Poiché `JOIN` s e le sottoquery correlate possono essere utilizzate entrambi per recuperare i dati correlati da altre tabelle, molti sviluppatori lasciano la testa e chiedono quale approccio utilizzare.</span><span class="sxs-lookup"><span data-stu-id="fe81c-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="fe81c-135">Tutti i guru SQL di cui ho parlato hanno detto approssimativamente la stessa cosa, che non è importante per le prestazioni, poiché SQL Server produrrà piani di esecuzione approssimativamente identici.</span><span class="sxs-lookup"><span data-stu-id="fe81c-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="fe81c-136">Il loro Consiglio, quindi, consiste nell'usare la tecnica che l'utente e il team sono più comodi con.</span><span class="sxs-lookup"><span data-stu-id="fe81c-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="fe81c-137">È importante notare che, dopo aver preso in considerazione questo Consiglio, questi esperti esprimono immediatamente le proprie preferenze di `JOIN` s rispetto alle sottoquery correlate.</span><span class="sxs-lookup"><span data-stu-id="fe81c-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="fe81c-138">Quando si compila un livello di accesso ai dati utilizzando DataSet tipizzati, gli strumenti funzionano meglio quando si utilizzano sottoquery.</span><span class="sxs-lookup"><span data-stu-id="fe81c-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="fe81c-139">In particolare, la procedura guidata di TableAdapter non genera automaticamente le istruzioni corrispondenti `INSERT`, `UPDATE`e `DELETE` se la query principale contiene `JOIN` s, ma genera automaticamente tali istruzioni quando si utilizzano sottoquery correlate.</span><span class="sxs-lookup"><span data-stu-id="fe81c-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="fe81c-140">Per esplorare questa lacuna, creare un set di dati tipizzato temporaneo nella cartella `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="fe81c-141">Durante la configurazione guidata TableAdapter, scegliere di usare istruzioni SQL ad hoc e immettere la query `SELECT` seguente (vedere la figura 1):</span><span class="sxs-lookup"><span data-stu-id="fe81c-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample3.sql)]

<span data-ttu-id="fe81c-142">[![immettere una query principale contenente JOIN](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span></span>

<span data-ttu-id="fe81c-143">**Figura 1**: immettere una query principale che contiene `JOIN` s ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span></span>

<span data-ttu-id="fe81c-144">Per impostazione predefinita, il TableAdapter creerà automaticamente le istruzioni `INSERT`, `UPDATE`e `DELETE` basate sulla query principale.</span><span class="sxs-lookup"><span data-stu-id="fe81c-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="fe81c-145">Se si fa clic sul pulsante Avanzate, è possibile vedere che questa funzionalità è abilitata.</span><span class="sxs-lookup"><span data-stu-id="fe81c-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="fe81c-146">Nonostante questa impostazione, il TableAdapter non sarà in grado di creare le istruzioni `INSERT`, `UPDATE`e `DELETE` perché la query principale contiene una `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>

![Immettere una query principale contenente JOIN](updating-the-tableadapter-to-use-joins-vb/_static/image4.png)

<span data-ttu-id="fe81c-148">**Figura 2**: immettere una query principale che contiene `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="fe81c-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>

<span data-ttu-id="fe81c-149">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="fe81c-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="fe81c-150">A questo punto, nella finestra di progettazione del set di dati verrà incluso un solo TableAdapter con una DataTable con colonne per ognuno dei campi restituiti nell'elenco di colonne della query `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="fe81c-151">Sono inclusi i `CategoryName` e `SupplierName`, come illustrato nella figura 3.</span><span class="sxs-lookup"><span data-stu-id="fe81c-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>

![Il DataTable include una colonna per ogni campo restituito nell'elenco di colonne](updating-the-tableadapter-to-use-joins-vb/_static/image5.png)

<span data-ttu-id="fe81c-153">**Figura 3**: la DataTable include una colonna per ogni campo restituito nell'elenco di colonne</span><span class="sxs-lookup"><span data-stu-id="fe81c-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>

<span data-ttu-id="fe81c-154">Mentre la DataTable contiene le colonne appropriate, il TableAdapter non dispone di valori per le proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="fe81c-155">Per confermare questa operazione, fare clic sul TableAdapter nella finestra di progettazione e quindi passare al Finestra Proprietà.</span><span class="sxs-lookup"><span data-stu-id="fe81c-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="fe81c-156">Si noterà che le proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand` sono impostate su (nessuno).</span><span class="sxs-lookup"><span data-stu-id="fe81c-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>

<span data-ttu-id="fe81c-157">[![le proprietà InsertCommand, UpdateCommand e DeleteCommand sono impostate su (nessuno)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span></span>

<span data-ttu-id="fe81c-158">**Figura 4**: le proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand` sono impostate su (nessuno) ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span></span>

<span data-ttu-id="fe81c-159">Per ovviare a questo problema, è possibile fornire manualmente le istruzioni e i parametri SQL per le proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand` tramite il Finestra Proprietà.</span><span class="sxs-lookup"><span data-stu-id="fe81c-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="fe81c-160">In alternativa, è possibile iniziare configurando la query principale di TableAdapter in modo da *non* includere alcun `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="fe81c-161">Questo consentirà di generare automaticamente le istruzioni `INSERT`, `UPDATE`e `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="fe81c-162">Dopo aver completato la procedura guidata, è possibile aggiornare manualmente il `SelectCommand` TableAdapter dall'Finestra Proprietà in modo che includa la sintassi `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="fe81c-163">Sebbene questo approccio funzioni, è molto fragile quando si usano query SQL ad hoc poiché ogni volta che la query principale di TableAdapter viene riconfigurata tramite la procedura guidata, le istruzioni `INSERT`, `UPDATE`e `DELETE` generate automaticamente vengono ricreate.</span><span class="sxs-lookup"><span data-stu-id="fe81c-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="fe81c-164">Ciò significa che tutte le personalizzazioni apportate in un secondo momento andranno perse se si fa clic con il pulsante destro del mouse sul TableAdapter, si sceglie Configura dal menu di scelta rapida e si completa nuovamente la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="fe81c-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="fe81c-165">La fragilità delle istruzioni `INSERT`, `UPDATE`e `DELETE` di TableAdapter generate automaticamente è fortunatamente limitata alle istruzioni SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="fe81c-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="fe81c-166">Se il TableAdapter utilizza stored procedure, è possibile personalizzare le stored procedure `SelectCommand`, `InsertCommand`, `UpdateCommand`o `DeleteCommand` ed eseguire nuovamente la configurazione guidata TableAdapter senza dover temere che le stored procedure vengano modificate.</span><span class="sxs-lookup"><span data-stu-id="fe81c-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="fe81c-167">Nei passaggi successivi verrà creato un TableAdapter che inizialmente usa una query principale che omette qualsiasi `JOIN` s in modo che le stored procedure di inserimento, aggiornamento ed eliminazione corrispondenti vengano generate automaticamente.</span><span class="sxs-lookup"><span data-stu-id="fe81c-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="fe81c-168">Si aggiornerà quindi il `SelectCommand` in modo che usi una `JOIN` che restituisce colonne aggiuntive dalle tabelle correlate.</span><span class="sxs-lookup"><span data-stu-id="fe81c-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="fe81c-169">Infine, si creerà una classe del livello della logica di business corrispondente e si dimostrerà l'uso del TableAdapter in una pagina Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="fe81c-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="fe81c-170">Passaggio 1: creazione del TableAdapter usando una query principale semplificata</span><span class="sxs-lookup"><span data-stu-id="fe81c-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="fe81c-171">Per questa esercitazione si aggiungeranno un TableAdapter e DataTable fortemente tipizzati per la tabella `Employees` nel set di dati `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="fe81c-172">La tabella `Employees` contiene un campo di `ReportsTo` che specifica il `EmployeeID` del responsabile del dipendente.</span><span class="sxs-lookup"><span data-stu-id="fe81c-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="fe81c-173">Il dipendente Anne Dodsworth, ad esempio, ha un valore `ReportTo` pari a 5, che corrisponde al `EmployeeID` di Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="fe81c-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="fe81c-174">Di conseguenza, Anne segnala a Steven, il suo responsabile.</span><span class="sxs-lookup"><span data-stu-id="fe81c-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="fe81c-175">Insieme alla segnalazione di ogni valore di `ReportsTo` dei dipendenti, è possibile che si desideri recuperare anche il nome del proprio responsabile.</span><span class="sxs-lookup"><span data-stu-id="fe81c-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="fe81c-176">Questa operazione può essere eseguita utilizzando un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="fe81c-177">Tuttavia, se si usa un `JOIN` durante la creazione iniziale del TableAdapter, impedisce alla procedura guidata di generare automaticamente le corrispondenti funzionalità di inserimento, aggiornamento ed eliminazione.</span><span class="sxs-lookup"><span data-stu-id="fe81c-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="fe81c-178">Pertanto, si inizierà creando un TableAdapter la cui query principale non contiene `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="fe81c-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="fe81c-179">Quindi, nel passaggio 2, verrà aggiornata la query principale stored procedure per recuperare il nome del Manager tramite una `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="fe81c-180">Per iniziare, aprire il set di dati `NorthwindWithSprocs` nella cartella `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="fe81c-181">Fare clic con il pulsante destro del mouse sulla finestra di progettazione, selezionare l'opzione Aggiungi dal menu di scelta rapida e scegliere la voce di menu TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fe81c-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="fe81c-182">Verrà avviata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fe81c-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="fe81c-183">Come illustrato nella figura 5, fare in modo che la procedura guidata crei nuove stored procedure e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="fe81c-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="fe81c-184">Per un aggiornamento della creazione di nuove stored procedure dalla procedura guidata di TableAdapter, vedere l'esercitazione [creazione di nuove stored procedure per il DataSet tipizzato s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="fe81c-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="fe81c-185">[![selezionare l'opzione crea nuove stored procedure](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span></span>

<span data-ttu-id="fe81c-186">**Figura 5**: selezionare l'opzione crea nuove stored procedure ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span></span>

<span data-ttu-id="fe81c-187">Usare l'istruzione `SELECT` seguente per la query principale di TableAdapter:</span><span class="sxs-lookup"><span data-stu-id="fe81c-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample4.sql)]

<span data-ttu-id="fe81c-188">Poiché questa query non include `JOIN` s, la procedura guidata TableAdapter creerà automaticamente le stored procedure con le istruzioni `INSERT`, `UPDATE`e `DELETE` corrispondenti, nonché un stored procedure per l'esecuzione della query principale.</span><span class="sxs-lookup"><span data-stu-id="fe81c-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="fe81c-189">Il passaggio seguente consente di denominare le stored procedure di TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fe81c-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="fe81c-190">Usare i nomi `Employees_Select`, `Employees_Insert`, `Employees_Update`e `Employees_Delete`, come illustrato nella figura 6.</span><span class="sxs-lookup"><span data-stu-id="fe81c-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>

<span data-ttu-id="fe81c-191">[Nome ![le stored procedure di TableAdapter](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span></span>

<span data-ttu-id="fe81c-192">**Figura 6**: assegnare un nome alle stored procedure di TableAdapter ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span></span>

<span data-ttu-id="fe81c-193">Nel passaggio finale viene richiesto di assegnare un nome ai metodi TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fe81c-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="fe81c-194">Utilizzare `Fill` e `GetEmployees` come nomi di metodo.</span><span class="sxs-lookup"><span data-stu-id="fe81c-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="fe81c-195">Assicurarsi anche di lasciare selezionata la casella di controllo Crea metodi per inviare aggiornamenti direttamente al database (GenerateDBDirectMethods).</span><span class="sxs-lookup"><span data-stu-id="fe81c-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>

<span data-ttu-id="fe81c-196">[Nome ![i metodi di TableAdapter Fill e GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span></span>

<span data-ttu-id="fe81c-197">**Figura 7**: assegnare un nome ai metodi TableAdapter `Fill` e `GetEmployees` ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span></span>

<span data-ttu-id="fe81c-198">Dopo aver completato la procedura guidata, esaminare le stored procedure nel database.</span><span class="sxs-lookup"><span data-stu-id="fe81c-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="fe81c-199">Verranno visualizzati quattro nuovi: `Employees_Select`, `Employees_Insert`, `Employees_Update`e `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="fe81c-200">Esaminare quindi i `EmployeesDataTable` e `EmployeesTableAdapter` appena creati.</span><span class="sxs-lookup"><span data-stu-id="fe81c-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="fe81c-201">Il DataTable contiene una colonna per ogni campo restituito dalla query principale.</span><span class="sxs-lookup"><span data-stu-id="fe81c-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="fe81c-202">Fare clic sul TableAdapter, quindi passare al Finestra Proprietà.</span><span class="sxs-lookup"><span data-stu-id="fe81c-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="fe81c-203">Si noterà che le proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand` sono configurate correttamente per chiamare le stored procedure corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="fe81c-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>

<span data-ttu-id="fe81c-204">[![TableAdapter include funzionalità di inserimento, aggiornamento ed eliminazione](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span></span>

<span data-ttu-id="fe81c-205">**Figura 8**: il TableAdapter include funzionalità di inserimento, aggiornamento ed eliminazione ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span></span>

<span data-ttu-id="fe81c-206">Con le stored procedure INSERT, Update e Delete create automaticamente e le proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand` configurate correttamente, è possibile personalizzare il stored procedure `SelectCommand` s per restituire informazioni aggiuntive su ogni responsabile del dipendente.</span><span class="sxs-lookup"><span data-stu-id="fe81c-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="fe81c-207">In particolare, è necessario aggiornare il `Employees_Select` stored procedure per usare un `JOIN` e restituire i valori `FirstName` e `LastName` del Manager.</span><span class="sxs-lookup"><span data-stu-id="fe81c-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="fe81c-208">Al termine dell'aggiornamento del stored procedure, sarà necessario aggiornare la DataTable in modo che includa le colonne aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="fe81c-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="fe81c-209">Queste due attività verranno affrontate nei passaggi 2 e 3.</span><span class="sxs-lookup"><span data-stu-id="fe81c-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="fe81c-210">Passaggio 2: personalizzazione della stored procedure per includere un`JOIN`</span><span class="sxs-lookup"><span data-stu-id="fe81c-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="fe81c-211">Per iniziare, passare alla Esplora server, eseguire il drill-down nella cartella stored procedure del database Northwind e aprire la stored procedure `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="fe81c-212">Se questo stored procedure non viene visualizzato, fare clic con il pulsante destro del mouse sulla cartella stored procedure e scegliere Aggiorna.</span><span class="sxs-lookup"><span data-stu-id="fe81c-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="fe81c-213">Aggiornare il stored procedure in modo che usi un `LEFT JOIN` per restituire il nome e il cognome del Manager:</span><span class="sxs-lookup"><span data-stu-id="fe81c-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample5.sql)]

<span data-ttu-id="fe81c-214">Dopo aver aggiornato l'istruzione `SELECT`, salvare le modifiche scegliendo Salva `Employees_Select`dal menu file.</span><span class="sxs-lookup"><span data-stu-id="fe81c-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="fe81c-215">In alternativa, è possibile fare clic sull'icona Salva sulla barra degli strumenti o premere CTRL + S.</span><span class="sxs-lookup"><span data-stu-id="fe81c-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="fe81c-216">Dopo aver salvato le modifiche, fare clic con il pulsante destro del mouse sul `Employees_Select` stored procedure nel Esplora server e scegliere Esegui.</span><span class="sxs-lookup"><span data-stu-id="fe81c-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="fe81c-217">In questo modo verrà eseguito il stored procedure e i risultati vengono visualizzati nella finestra di output (vedere la figura 9).</span><span class="sxs-lookup"><span data-stu-id="fe81c-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>

<span data-ttu-id="fe81c-218">[![i risultati delle stored procedure vengono visualizzati nell'Finestra di output](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span></span>

<span data-ttu-id="fe81c-219">**Figura 9**: i risultati delle stored procedure vengono visualizzati nel finestra di output ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span></span>

## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="fe81c-220">Passaggio 3: aggiornamento delle colonne di DataTable</span><span class="sxs-lookup"><span data-stu-id="fe81c-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="fe81c-221">A questo punto, il `Employees_Select` stored procedure restituisce i valori `ManagerFirstName` e `ManagerLastName`, ma mancano le colonne nel `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="fe81c-222">Queste colonne mancanti possono essere aggiunte alla DataTable in uno dei due modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="fe81c-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="fe81c-223">**Manualmente** , fare clic con il pulsante destro del mouse sulla DataTable in Progettazione DataSet e scegliere colonna dal menu Aggiungi.</span><span class="sxs-lookup"><span data-stu-id="fe81c-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="fe81c-224">È quindi possibile assegnare un nome alla colonna e impostarne le proprietà di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="fe81c-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="fe81c-225">**Automaticamente** : la configurazione guidata TableAdapter aggiornerà le colonne di DataTable in modo da riflettere i campi restituiti dall'stored procedure di `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="fe81c-226">Quando si utilizzano istruzioni SQL ad hoc, verranno rimosse anche le proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand` poiché il `SelectCommand` contiene ora un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="fe81c-227">Tuttavia, quando si utilizzano stored procedure, queste proprietà del comando rimangono intatte.</span><span class="sxs-lookup"><span data-stu-id="fe81c-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="fe81c-228">È stata esaminata l'aggiunta manuale di colonne DataTable nelle esercitazioni precedenti, tra cui [Master/Detail usando un elenco puntato di record master con un DataList di dettagli e il](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) [caricamento di file](../working-with-binary-files/uploading-files-vb.md). il processo verrà esaminato più dettagliatamente nell'esercitazione successiva.</span><span class="sxs-lookup"><span data-stu-id="fe81c-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) and [Uploading Files](../working-with-binary-files/uploading-files-vb.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="fe81c-229">Per questa esercitazione, tuttavia, è consigliabile usare l'approccio automatico tramite la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fe81c-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="fe81c-230">Per iniziare, fare clic con il pulsante destro del mouse sul `EmployeesTableAdapter` e scegliere Configura dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="fe81c-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="fe81c-231">Viene visualizzata la configurazione guidata TableAdapter, in cui sono elencate le stored procedure utilizzate per la selezione, l'inserimento, l'aggiornamento e l'eliminazione, insieme ai relativi valori restituiti e parametri (se presenti).</span><span class="sxs-lookup"><span data-stu-id="fe81c-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="fe81c-232">Nella figura 10 è illustrata questa procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="fe81c-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="fe81c-233">Qui è possibile osservare che il `Employees_Select` stored procedure ora restituisce i campi `ManagerFirstName` e `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>

<span data-ttu-id="fe81c-234">[![procedura guidata mostra l'elenco di colonne aggiornato per la stored procedure Employees_Select](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span></span>

<span data-ttu-id="fe81c-235">**Figura 10**: la procedura guidata mostra l'elenco di colonne aggiornato per la stored procedure `Employees_Select` ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span></span>

<span data-ttu-id="fe81c-236">Completare la procedura guidata facendo clic su fine.</span><span class="sxs-lookup"><span data-stu-id="fe81c-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="fe81c-237">Quando si torna a Progettazione DataSet, il `EmployeesDataTable` include due colonne aggiuntive: `ManagerFirstName` e `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>

<span data-ttu-id="fe81c-238">[![EmployeesDataTable contiene due nuove colonne](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span></span>

<span data-ttu-id="fe81c-239">**Figura 11**: il `EmployeesDataTable` contiene due nuove colonne ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span></span>

<span data-ttu-id="fe81c-240">Per illustrare che il stored procedure di `Employees_Select` aggiornato è attivo e che le funzionalità di inserimento, aggiornamento ed eliminazione del TableAdapter sono ancora funzionali, è possibile creare una pagina Web che consenta agli utenti di visualizzare ed eliminare i dipendenti.</span><span class="sxs-lookup"><span data-stu-id="fe81c-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="fe81c-241">Prima di creare una pagina di questo tipo, tuttavia, è necessario innanzitutto creare una nuova classe nel livello della logica di business per l'utilizzo dei dipendenti dal set di dati `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="fe81c-242">Nel passaggio 4 si creerà una classe `EmployeesBLLWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="fe81c-243">Nel passaggio 5 verrà usata questa classe da una pagina ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="fe81c-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="fe81c-244">Passaggio 4: implementazione del livello di logica di business</span><span class="sxs-lookup"><span data-stu-id="fe81c-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="fe81c-245">Creare un nuovo file di classe nella cartella `~/App_Code/BLL` denominata `EmployeesBLLWithSprocs.vb`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.vb`.</span></span> <span data-ttu-id="fe81c-246">Questa classe simula la semantica della classe `EmployeesBLL` esistente. solo questo nuovo fornisce un minor numero di metodi e usa il set di dati di `NorthwindWithSprocs` (anziché il set di dati `Northwind`).</span><span class="sxs-lookup"><span data-stu-id="fe81c-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="fe81c-247">Aggiungere il codice seguente alla classe `EmployeesBLLWithSprocs` .</span><span class="sxs-lookup"><span data-stu-id="fe81c-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>

[!code-vb[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample6.vb)]

<span data-ttu-id="fe81c-248">La proprietà `Adapter` della classe `EmployeesBLLWithSprocs` restituisce un'istanza del `EmployeesTableAdapter`del set di dati `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="fe81c-249">Viene utilizzato dai metodi `GetEmployees` e `DeleteEmployee` della classe.</span><span class="sxs-lookup"><span data-stu-id="fe81c-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="fe81c-250">Il metodo `GetEmployees` chiama il metodo di `GetEmployees` corrispondente `EmployeesTableAdapter`, che richiama il `Employees_Select` stored procedure e popola i risultati in un `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="fe81c-251">Il metodo `DeleteEmployee` chiama in modo analogo il metodo `EmployeesTableAdapter` s `Delete`, che richiama il stored procedure `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="fe81c-252">Passaggio 5: uso dei dati nel livello di presentazione</span><span class="sxs-lookup"><span data-stu-id="fe81c-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="fe81c-253">Con la classe `EmployeesBLLWithSprocs` completata, si è pronti per lavorare con i dati dei dipendenti tramite una pagina ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="fe81c-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="fe81c-254">Aprire la pagina `JOINs.aspx` nella cartella `AdvancedDAL` e trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione, impostando la relativa proprietà `ID` su `Employees`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="fe81c-255">Successivamente, dallo smart tag GridView s, associare la griglia a un nuovo controllo ObjectDataSource denominato `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="fe81c-256">Configurare ObjectDataSource per l'utilizzo della classe `EmployeesBLLWithSprocs` e, dalle schede SELECT ed DELETE, assicurarsi che i metodi `GetEmployees` e `DeleteEmployee` siano selezionati dagli elenchi a discesa.</span><span class="sxs-lookup"><span data-stu-id="fe81c-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="fe81c-257">Fare clic su fine per completare la configurazione di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="fe81c-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>

<span data-ttu-id="fe81c-258">[![configurare ObjectDataSource per l'utilizzo della classe EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span></span>

<span data-ttu-id="fe81c-259">**Figura 12**: configurare ObjectDataSource per l'uso della classe `EmployeesBLLWithSprocs` ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span></span>

<span data-ttu-id="fe81c-260">[per ![usare ObjectDataSource, usare i metodi GetEmployees e DeleteEmployee](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span></span>

<span data-ttu-id="fe81c-261">**Figura 13**: fare in modo che ObjectDataSource usi i metodi `GetEmployees` e `DeleteEmployee` ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span></span>

<span data-ttu-id="fe81c-262">In Visual Studio viene aggiunto un BoundField al GridView per ognuna delle colonne `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="fe81c-263">Rimuovere tutti i BoundField, ad eccezione di `Title`, `LastName`, `FirstName`, `ManagerFirstName`e `ManagerLastName` e rinominare rispettivamente le proprietà `HeaderText` per gli ultimi quattro BoundField in cognome, nome, Manager e nome e Manager s cognome.</span><span class="sxs-lookup"><span data-stu-id="fe81c-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="fe81c-264">Per consentire agli utenti di eliminare i dipendenti da questa pagina, è necessario eseguire due operazioni.</span><span class="sxs-lookup"><span data-stu-id="fe81c-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="fe81c-265">Per prima cosa, indicare a GridView di fornire funzionalità di eliminazione selezionando l'opzione Abilita eliminazione dallo smart tag.</span><span class="sxs-lookup"><span data-stu-id="fe81c-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="fe81c-266">In secondo luogo, modificare la proprietà `OldValuesParameterFormatString` di ObjectDataSource dal valore impostato dalla procedura guidata ObjectDataSource (`original_{0}`) al valore predefinito (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="fe81c-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="fe81c-267">Dopo aver apportato queste modifiche, il markup dichiarativo GridView e ObjectDataSource dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="fe81c-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample7.aspx)]

<span data-ttu-id="fe81c-268">Testare la pagina visitando il browser.</span><span class="sxs-lookup"><span data-stu-id="fe81c-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="fe81c-269">Come illustrato nella figura 14, nella pagina sono elencati tutti i dipendenti e il nome del suo Manager (presupponendo che abbiano uno).</span><span class="sxs-lookup"><span data-stu-id="fe81c-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>

<span data-ttu-id="fe81c-270">[![il JOIN nella stored procedure Employees_Select restituisce il nome del Manager](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span></span>

<span data-ttu-id="fe81c-271">**Figura 14**: il `JOIN` nella stored procedure `Employees_Select` restituisce il nome del Manager ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span></span>

<span data-ttu-id="fe81c-272">Facendo clic sul pulsante Elimina viene avviato il flusso di lavoro di eliminazione, che culmina nell'esecuzione del `Employees_Delete` stored procedure.</span><span class="sxs-lookup"><span data-stu-id="fe81c-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="fe81c-273">Tuttavia, l'istruzione `DELETE` tentata nel stored procedure ha esito negativo a causa di una violazione del vincolo di chiave esterna (vedere la figura 15).</span><span class="sxs-lookup"><span data-stu-id="fe81c-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="fe81c-274">In particolare, ogni dipendente ha uno o più record nella tabella `Orders`, causando l'esito negativo dell'eliminazione.</span><span class="sxs-lookup"><span data-stu-id="fe81c-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>

<span data-ttu-id="fe81c-275">[![l'eliminazione di un dipendente con ordini corrispondenti comporta una violazione del vincolo di chiave esterna](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="fe81c-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span></span>

<span data-ttu-id="fe81c-276">**Figura 15**: l'eliminazione di un dipendente con ordini corrispondenti comporta una violazione del vincolo di chiave esterna ([fare clic per visualizzare l'immagine con dimensioni complete](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="fe81c-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span></span>

<span data-ttu-id="fe81c-277">Per consentire l'eliminazione di un dipendente, è possibile:</span><span class="sxs-lookup"><span data-stu-id="fe81c-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="fe81c-278">Aggiornare il vincolo FOREIGN KEY alle eliminazioni a catena,</span><span class="sxs-lookup"><span data-stu-id="fe81c-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="fe81c-279">Eliminare manualmente i record dalla tabella `Orders` per i dipendenti che si desidera eliminare.</span><span class="sxs-lookup"><span data-stu-id="fe81c-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="fe81c-280">Aggiornare i stored procedure di `Employees_Delete` per eliminare prima di tutto i record correlati dalla tabella `Orders` prima di eliminare il record `Employees`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="fe81c-281">Questa tecnica è stata illustrata nell'esercitazione [utilizzo di stored procedure esistenti per i TableAdapter tipizzati del set di dati](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="fe81c-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="fe81c-282">Lo lascio come esercizio per il lettore.</span><span class="sxs-lookup"><span data-stu-id="fe81c-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="fe81c-283">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="fe81c-283">Summary</span></span>

<span data-ttu-id="fe81c-284">Quando si utilizzano i database relazionali, è normale che le query estraggano i dati da più tabelle correlate.</span><span class="sxs-lookup"><span data-stu-id="fe81c-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="fe81c-285">Le sottoquery correlate e `JOIN` s forniscono due tecniche diverse per accedere ai dati dalle tabelle correlate in una query.</span><span class="sxs-lookup"><span data-stu-id="fe81c-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="fe81c-286">Nelle esercitazioni precedenti abbiamo usato più di frequente le sottoquery correlate perché TableAdapter non è in grado di generare automaticamente istruzioni `INSERT`, `UPDATE`e `DELETE` per le query che comportano `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="fe81c-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="fe81c-287">Anche se questi valori possono essere forniti manualmente, quando si usano istruzioni SQL ad hoc, le personalizzazioni verranno sovrascritte al termine della configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fe81c-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="fe81c-288">Fortunatamente, gli oggetti TableAdapter creati utilizzando le stored procedure non soffrono della stessa fragilità di quelli creati mediante istruzioni SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="fe81c-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="fe81c-289">Pertanto, è possibile creare un oggetto TableAdapter la cui query principale utilizza un `JOIN` quando si utilizzano stored procedure.</span><span class="sxs-lookup"><span data-stu-id="fe81c-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="fe81c-290">In questa esercitazione è stato illustrato come creare un oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fe81c-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="fe81c-291">È stata avviata usando una query di `SELECT` senza `JOIN`per la query principale di TableAdapter in modo da creare automaticamente le stored procedure di inserimento, aggiornamento ed eliminazione corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="fe81c-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="fe81c-292">Con la configurazione iniziale di TableAdapter completata, è stata aumentata la `SelectCommand` stored procedure per usare un `JOIN` ed è stata rieseguita la configurazione guidata TableAdapter per aggiornare le colonne `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="fe81c-293">Se si esegue nuovamente la configurazione guidata TableAdapter, le colonne `EmployeesDataTable` verranno aggiornate in modo da riflettere i campi dati restituiti dalla stored procedure `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="fe81c-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="fe81c-294">In alternativa, è possibile che queste colonne siano state aggiunte manualmente alla DataTable.</span><span class="sxs-lookup"><span data-stu-id="fe81c-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="fe81c-295">Nell'esercitazione successiva si analizzerà manualmente l'aggiunta di colonne alla DataTable.</span><span class="sxs-lookup"><span data-stu-id="fe81c-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="fe81c-296">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="fe81c-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="fe81c-297">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="fe81c-297">About the Author</span></span>

<span data-ttu-id="fe81c-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="fe81c-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="fe81c-299">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="fe81c-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="fe81c-300">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="fe81c-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="fe81c-301">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fe81c-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="fe81c-302">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="fe81c-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="fe81c-303">Grazie speciale</span><span class="sxs-lookup"><span data-stu-id="fe81c-303">Special Thanks To</span></span>

<span data-ttu-id="fe81c-304">Questa serie di esercitazioni è stata esaminata da molti revisori utili.</span><span class="sxs-lookup"><span data-stu-id="fe81c-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="fe81c-305">I revisori del lead per questa esercitazione erano Hilton Geisenow, David Suru e Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="fe81c-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="fe81c-306">Sei interessato a esaminare i miei prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="fe81c-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="fe81c-307">In tal caso, rilasciare una riga in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fe81c-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="fe81c-308">[Precedente](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [Successivo](adding-additional-datatable-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="fe81c-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](adding-additional-datatable-columns-vb.md)</span></span>
