---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-cs
title: Uso di colonne calcolate (C#) | Microsoft Docs
author: rick-anderson
description: Quando si crea una tabella di database, Microsoft SQL Server consente di definire una colonna calcolata il cui valore viene calcolato da un'espressione che in genere fa riferimento a...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 57459065-ed7c-4dfe-ac9c-54c093abc261
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-cs
msc.type: authoredcontent
ms.openlocfilehash: ad6a96f2721510c2478f707c8eed018ae797f27a
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/28/2019
ms.locfileid: "74603149"
---
# <a name="working-with-computed-columns-c"></a><span data-ttu-id="0395e-103">Uso di colonne calcolate (C#)</span><span class="sxs-lookup"><span data-stu-id="0395e-103">Working with Computed Columns (C#)</span></span>

<span data-ttu-id="0395e-104">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0395e-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0395e-105">[Scarica codice](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_CS.zip) o [Scarica PDF](working-with-computed-columns-cs/_static/datatutorial71cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0395e-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_CS.zip) or [Download PDF](working-with-computed-columns-cs/_static/datatutorial71cs1.pdf)</span></span>

> <span data-ttu-id="0395e-106">Quando si crea una tabella di database, Microsoft SQL Server consente di definire una colonna calcolata il cui valore viene calcolato da un'espressione che in genere fa riferimento ad altri valori nello stesso record del database.</span><span class="sxs-lookup"><span data-stu-id="0395e-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="0395e-107">Tali valori sono di sola lettura nel database, che richiede considerazioni speciali quando si utilizzano TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="0395e-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="0395e-108">In questa esercitazione si apprenderà come soddisfare le sfide poste dalle colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="0395e-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="0395e-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="0395e-109">Introduction</span></span>

<span data-ttu-id="0395e-110">Microsoft SQL Server consente le *[colonne calcolate](https://msdn.microsoft.com/library/ms191250.aspx)* , ovvero colonne i cui valori vengono calcolati da un'espressione che in genere fa riferimento ai valori di altre colonne nella stessa tabella.</span><span class="sxs-lookup"><span data-stu-id="0395e-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="0395e-111">Un modello di dati di rilevamento ora può ad esempio avere una tabella denominata `ServiceLog` con colonne, tra cui `ServicePerformed`, `EmployeeID`, `Rate`e `Duration`.</span><span class="sxs-lookup"><span data-stu-id="0395e-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="0395e-112">Sebbene la quantità dovuta all'elemento di servizio (la percentuale moltiplicata per la durata) venga calcolata tramite una pagina Web o un'altra interfaccia a livello di codice, potrebbe essere utile includere una colonna nella tabella `ServiceLog` denominata `AmountDue` che ha segnalato queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="0395e-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="0395e-113">Questa colonna può essere creata come colonna normale, ma deve essere aggiornata ogni volta che i valori della colonna `Rate` o `Duration` sono stati modificati.</span><span class="sxs-lookup"><span data-stu-id="0395e-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="0395e-114">Un approccio migliore consiste nel rendere la colonna `AmountDue` una colonna calcolata usando l'espressione `Rate * Duration`.</span><span class="sxs-lookup"><span data-stu-id="0395e-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="0395e-115">In questo modo SQL Server calcolare automaticamente il valore della colonna `AmountDue` ogni volta che viene fatto riferimento in una query.</span><span class="sxs-lookup"><span data-stu-id="0395e-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="0395e-116">Poiché un valore della colonna calcolata è determinato da un'espressione, tali colonne sono di sola lettura e pertanto non possono avere valori assegnati nelle istruzioni `INSERT` o `UPDATE`.</span><span class="sxs-lookup"><span data-stu-id="0395e-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="0395e-117">Tuttavia, quando le colonne calcolate fanno parte della query principale per un TableAdapter che utilizza istruzioni SQL ad hoc, vengono incluse automaticamente nelle istruzioni `INSERT` e `UPDATE` generate automaticamente.</span><span class="sxs-lookup"><span data-stu-id="0395e-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="0395e-118">Di conseguenza, è necessario aggiornare le proprietà `INSERT` e `UPDATE` di TableAdapter e `InsertCommand` e `UpdateCommand` per rimuovere i riferimenti a tutte le colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="0395e-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="0395e-119">Una sfida nell'uso di colonne calcolate con un TableAdapter che usa istruzioni SQL ad hoc è che le query di TableAdapter `INSERT` e `UPDATE` vengono rigenerate automaticamente ogni volta che viene completata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="0395e-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="0395e-120">Pertanto, le colonne calcolate rimosse manualmente dal `INSERT` e `UPDATE` query verranno visualizzate di nuovo se la procedura guidata viene rieseguita.</span><span class="sxs-lookup"><span data-stu-id="0395e-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="0395e-121">Sebbene gli oggetti TableAdapter che usano stored procedure non soffrano di questa fragilità, hanno le proprie peculiarità che verranno affrontate nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="0395e-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="0395e-122">In questa esercitazione si aggiungerà una colonna calcolata alla tabella `Suppliers` nel database Northwind e quindi si creerà un TableAdapter corrispondente per lavorare con questa tabella e la relativa colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="0395e-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="0395e-123">Il TableAdapter utilizzerà stored procedure anziché istruzioni SQL ad hoc, in modo che le personalizzazioni non vadano perse quando viene utilizzata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="0395e-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren't lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="0395e-124">Inizia subito.</span><span class="sxs-lookup"><span data-stu-id="0395e-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="0395e-125">Passaggio 1: aggiunta di una colonna calcolata alla tabella`Suppliers`</span><span class="sxs-lookup"><span data-stu-id="0395e-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="0395e-126">Il database Northwind non include colonne calcolate, quindi è necessario aggiungerne una.</span><span class="sxs-lookup"><span data-stu-id="0395e-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="0395e-127">Per questa esercitazione è possibile aggiungere una colonna calcolata alla tabella `Suppliers` denominata `FullContactName` che restituisce il nome del contatto, il titolo e la società per cui lavorano nel formato seguente: `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="0395e-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="0395e-128">Questa colonna calcolata può essere utilizzata nei report quando si visualizzano informazioni sui fornitori.</span><span class="sxs-lookup"><span data-stu-id="0395e-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="0395e-129">Per iniziare, aprire la definizione della tabella `Suppliers` facendo clic con il pulsante destro del mouse sulla tabella `Suppliers` nel Esplora server e scegliendo Apri definizione tabella dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="0395e-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="0395e-130">Verranno visualizzate le colonne della tabella e le relative proprietà, ad esempio il tipo di dati, se consentono `NULL` s e così via.</span><span class="sxs-lookup"><span data-stu-id="0395e-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="0395e-131">Per aggiungere una colonna calcolata, iniziare digitando il nome della colonna nella definizione della tabella.</span><span class="sxs-lookup"><span data-stu-id="0395e-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="0395e-132">Immettere quindi l'espressione nella casella di testo (formula) nella sezione specifica della colonna calcolata nella colonna Finestra Proprietà (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="0395e-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="0395e-133">Denominare la colonna calcolata `FullContactName` e utilizzare l'espressione seguente:</span><span class="sxs-lookup"><span data-stu-id="0395e-133">Name the computed column `FullContactName` and use the following expression:</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample1.sql)]

<span data-ttu-id="0395e-134">Si noti che le stringhe possono essere concatenate in SQL utilizzando l'operatore `+`.</span><span class="sxs-lookup"><span data-stu-id="0395e-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="0395e-135">L'istruzione `CASE` può essere usata come un condizionale in un linguaggio di programmazione tradizionale.</span><span class="sxs-lookup"><span data-stu-id="0395e-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="0395e-136">Nell'espressione precedente l'istruzione `CASE` può essere letta come: se `ContactTitle` non è `NULL`, restituire il valore di `ContactTitle` concatenato a una virgola, in caso contrario, non emettere alcun elemento.</span><span class="sxs-lookup"><span data-stu-id="0395e-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="0395e-137">Per ulteriori informazioni sull'utilità dell'istruzione `CASE`, vedere [le istruzioni relative alla potenza di SQL `CASE`](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="0395e-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="0395e-138">Invece di usare un'istruzione `CASE`, avremmo potuto usare `ISNULL(ContactTitle, '')`.</span><span class="sxs-lookup"><span data-stu-id="0395e-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="0395e-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) restituisce *checkExpression* se è diverso da null. in caso contrario, restituisce *replacementValue*.</span><span class="sxs-lookup"><span data-stu-id="0395e-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="0395e-140">Mentre `ISNULL` o `CASE` funzioneranno in questa istanza, esistono scenari più complessi in cui la flessibilità dell'istruzione `CASE` non può essere confrontata con `ISNULL`.</span><span class="sxs-lookup"><span data-stu-id="0395e-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>

<span data-ttu-id="0395e-141">Dopo l'aggiunta di questa colonna calcolata, la schermata dovrebbe essere simile a quella illustrata nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="0395e-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>

<span data-ttu-id="0395e-142">[![aggiungere una colonna calcolata denominata FullContactName alla tabella Suppliers](working-with-computed-columns-cs/_static/image2.png)](working-with-computed-columns-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-cs/_static/image2.png)](working-with-computed-columns-cs/_static/image1.png)</span></span>

<span data-ttu-id="0395e-143">**Figura 1**: aggiungere una colonna calcolata denominata `FullContactName` alla tabella `Suppliers` ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-cs/_static/image3.png))</span></span>

<span data-ttu-id="0395e-144">Dopo aver denominato la colonna calcolata e immettendo l'espressione, salvare le modifiche apportate alla tabella facendo clic sull'icona Salva sulla barra degli strumenti, premendo CTRL + S oppure scegliendo Salva `Suppliers`dal menu file.</span><span class="sxs-lookup"><span data-stu-id="0395e-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="0395e-145">Il salvataggio della tabella dovrebbe aggiornare il Esplora server, inclusa la colonna appena aggiunta nell'elenco di colonne della tabella `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="0395e-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="0395e-146">Inoltre, l'espressione immessa nella casella di testo (formula) verrà automaticamente modificata in un'espressione equivalente che rimuove gli spazi vuoti superflui, racchiude i nomi di colonna tra parentesi quadre (`[]`) e include le parentesi per visualizzare in modo più esplicito l'ordine delle operazioni:</span><span class="sxs-lookup"><span data-stu-id="0395e-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample2.sql)]

<span data-ttu-id="0395e-147">Per ulteriori informazioni sulle colonne calcolate in Microsoft SQL Server, consultare la [documentazione tecnica](https://msdn.microsoft.com/library/ms191250.aspx).</span><span class="sxs-lookup"><span data-stu-id="0395e-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="0395e-148">Vedere anche procedura [: specificare le colonne calcolate](https://msdn.microsoft.com/library/ms188300.aspx) per una procedura dettagliata per la creazione di colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="0395e-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="0395e-149">Per impostazione predefinita, le colonne calcolate non vengono archiviate fisicamente nella tabella, ma vengono ricalcolate ogni volta che viene fatto riferimento in una query.</span><span class="sxs-lookup"><span data-stu-id="0395e-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="0395e-150">Selezionando la casella di controllo è permanente, tuttavia, è possibile indicare SQL Server di archiviare fisicamente la colonna calcolata nella tabella.</span><span class="sxs-lookup"><span data-stu-id="0395e-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="0395e-151">In questo modo è possibile creare un indice sulla colonna calcolata, in modo da migliorare le prestazioni delle query che utilizzano il valore della colonna calcolata nelle clausole `WHERE`.</span><span class="sxs-lookup"><span data-stu-id="0395e-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="0395e-152">Per ulteriori informazioni, vedere [creazione di indici su colonne calcolate](https://msdn.microsoft.com/library/ms189292.aspx) .</span><span class="sxs-lookup"><span data-stu-id="0395e-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>

## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="0395e-153">Passaggio 2: visualizzazione dei valori della colonna calcolata</span><span class="sxs-lookup"><span data-stu-id="0395e-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="0395e-154">Prima di iniziare a lavorare sul livello di accesso ai dati, è necessario un minuto per visualizzare i valori `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="0395e-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="0395e-155">Dal Esplora server fare clic con il pulsante destro del mouse sul nome della tabella `Suppliers` e scegliere nuova query dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="0395e-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="0395e-156">Verrà mostrata una finestra di query che richiede di scegliere le tabelle da includere nella query.</span><span class="sxs-lookup"><span data-stu-id="0395e-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="0395e-157">Aggiungere la tabella `Suppliers` e fare clic su Chiudi.</span><span class="sxs-lookup"><span data-stu-id="0395e-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="0395e-158">Controllare quindi le colonne `CompanyName`, `ContactName`, `ContactTitle`e `FullContactName` dalla tabella Suppliers.</span><span class="sxs-lookup"><span data-stu-id="0395e-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="0395e-159">Infine, fare clic sull'icona del punto esclamativo rosso sulla barra degli strumenti per eseguire la query e visualizzare i risultati.</span><span class="sxs-lookup"><span data-stu-id="0395e-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="0395e-160">Come illustrato nella figura 2, i risultati includono `FullContactName`, che elenca le colonne `CompanyName`, `ContactName`e `ContactTitle` usando il formato ldquo;`ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="0395e-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format ldquo;`ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="0395e-161">[![FullContactName usa il formato ContactName (ContactTitle, CompanyName)](working-with-computed-columns-cs/_static/image5.png)](working-with-computed-columns-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-cs/_static/image5.png)](working-with-computed-columns-cs/_static/image4.png)</span></span>

<span data-ttu-id="0395e-162">**Figura 2**: il `FullContactName` usa il formato `ContactName` (`ContactTitle`, `CompanyName`) ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-cs/_static/image6.png))</span></span>

## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="0395e-163">Passaggio 3: aggiunta del`SuppliersTableAdapter`al livello di accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="0395e-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="0395e-164">Per lavorare con le informazioni sul fornitore nell'applicazione, è necessario creare prima un TableAdapter e un DataTable nel DAL.</span><span class="sxs-lookup"><span data-stu-id="0395e-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="0395e-165">Idealmente, questa operazione viene eseguita usando gli stessi passaggi semplici esaminati nelle esercitazioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="0395e-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="0395e-166">Tuttavia, l'uso di colonne calcolate introduce alcune grinze che meritano una discussione.</span><span class="sxs-lookup"><span data-stu-id="0395e-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="0395e-167">Se si usa un TableAdapter che usa istruzioni SQL ad hoc, è possibile includere semplicemente la colonna calcolata nella query principale di TableAdapter tramite la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="0395e-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="0395e-168">Questo, tuttavia, genererà automaticamente `INSERT` e `UPDATE` istruzioni che includono la colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="0395e-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="0395e-169">Se si tenta di eseguire uno di questi metodi, una `SqlException` con il messaggio non è possibile modificare la colonna *ColumnName* perché è una colonna calcolata o il risultato di un operatore Union verrà generato.</span><span class="sxs-lookup"><span data-stu-id="0395e-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="0395e-170">Sebbene sia possibile modificare manualmente l'istruzione `INSERT` e la `UPDATE` tramite le proprietà `InsertCommand` e `UpdateCommand` di TableAdapter, le personalizzazioni andranno perse ogni volta che viene eseguita di nuovo la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="0395e-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="0395e-171">A causa della fragilità degli oggetti TableAdapter che utilizzano istruzioni SQL ad hoc, è consigliabile utilizzare stored procedure quando si utilizzano colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="0395e-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="0395e-172">Se si utilizzano stored procedure esistenti, è sufficiente configurare il TableAdapter come descritto nell'esercitazione [utilizzo di stored procedure esistenti per i TableAdapter del set di dati tipizzati](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="0395e-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="0395e-173">Se la procedura guidata TableAdapter crea le stored procedure per l'utente, tuttavia, è importante omettere inizialmente le colonne calcolate dalla query principale.</span><span class="sxs-lookup"><span data-stu-id="0395e-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="0395e-174">Se si include una colonna calcolata nella query principale, la configurazione guidata TableAdapter indicherà, al completamento, che non è possibile creare le stored procedure corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="0395e-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="0395e-175">In breve, è necessario configurare inizialmente il TableAdapter usando una query principale senza colonna calcolata e quindi aggiornare manualmente il stored procedure corrispondente e il `SelectCommand` TableAdapter per includere la colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="0395e-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="0395e-176">Questo approccio è simile a quello usato nell'esercitazione [aggiornamento del TableAdapter per l'uso di](updating-the-tableadapter-to-use-joins-cs.md)`JOIN`*s* .</span><span class="sxs-lookup"><span data-stu-id="0395e-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-cs.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="0395e-177">Per questa esercitazione, è possibile aggiungere un nuovo TableAdapter e fare in modo che crei automaticamente le stored procedure.</span><span class="sxs-lookup"><span data-stu-id="0395e-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="0395e-178">Di conseguenza, è necessario omettere inizialmente la colonna calcolata `FullContactName` dalla query principale.</span><span class="sxs-lookup"><span data-stu-id="0395e-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="0395e-179">Per iniziare, aprire il set di dati `NorthwindWithSprocs` nella cartella `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="0395e-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="0395e-180">Fare clic con il pulsante destro del mouse nella finestra di progettazione e scegliere Aggiungi nuovo TableAdapter dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="0395e-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="0395e-181">Verrà avviata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="0395e-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="0395e-182">Consente di specificare il database da cui eseguire query sui dati (`NORTHWNDConnectionString` da `Web.config`) e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="0395e-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="0395e-183">Poiché non sono state ancora create stored procedure per l'esecuzione di query o la modifica della tabella `Suppliers`, selezionare l'opzione crea nuove stored procedure in modo che vengano create automaticamente dalla procedura guidata e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="0395e-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>

<span data-ttu-id="0395e-184">[![scegliere l'opzione crea nuove stored procedure](working-with-computed-columns-cs/_static/image8.png)](working-with-computed-columns-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-cs/_static/image8.png)](working-with-computed-columns-cs/_static/image7.png)</span></span>

<span data-ttu-id="0395e-185">**Figura 3**: scegliere l'opzione crea nuove stored procedure ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-cs/_static/image9.png))</span></span>

<span data-ttu-id="0395e-186">Il passaggio successivo richiede la query principale.</span><span class="sxs-lookup"><span data-stu-id="0395e-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="0395e-187">Immettere la query seguente, che restituisce le colonne `SupplierID`, `CompanyName`, `ContactName`e `ContactTitle` per ogni fornitore.</span><span class="sxs-lookup"><span data-stu-id="0395e-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="0395e-188">Si noti che questa query omette intenzionalmente la colonna calcolata (`FullContactName`); il stored procedure corrispondente verrà aggiornato in modo da includere questa colonna nel passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="0395e-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample3.sql)]

<span data-ttu-id="0395e-189">Dopo aver immesso la query principale e aver fatto clic su Avanti, la procedura guidata consente di denominare le quattro stored procedure che verranno generate.</span><span class="sxs-lookup"><span data-stu-id="0395e-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="0395e-190">Denominare le stored procedure `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`e `Suppliers_Delete`, come illustrato nella figura 4.</span><span class="sxs-lookup"><span data-stu-id="0395e-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>

<span data-ttu-id="0395e-191">[![personalizzare i nomi delle stored procedure generate automaticamente](working-with-computed-columns-cs/_static/image11.png)](working-with-computed-columns-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-cs/_static/image11.png)](working-with-computed-columns-cs/_static/image10.png)</span></span>

<span data-ttu-id="0395e-192">**Figura 4**: personalizzare i nomi delle stored procedure generate automaticamente ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-cs/_static/image12.png))</span></span>

<span data-ttu-id="0395e-193">Il passaggio successivo della procedura guidata consente di assegnare un nome ai metodi TableAdapter e di specificare i modelli usati per accedere ai dati e aggiornarli.</span><span class="sxs-lookup"><span data-stu-id="0395e-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="0395e-194">Lasciare selezionate tutte e tre le caselle di controllo, ma rinominare il metodo `GetData` per `GetSuppliers`.</span><span class="sxs-lookup"><span data-stu-id="0395e-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="0395e-195">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="0395e-195">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="0395e-196">[![rinominare il metodo GetData in getsuppliers](working-with-computed-columns-cs/_static/image14.png)](working-with-computed-columns-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-cs/_static/image14.png)](working-with-computed-columns-cs/_static/image13.png)</span></span>

<span data-ttu-id="0395e-197">**Figura 5**: rinominare il metodo `GetData` in `GetSuppliers` ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-cs/_static/image15.png))</span></span>

<span data-ttu-id="0395e-198">Quando si fa clic su fine, la procedura guidata creerà le quattro stored procedure e aggiungerà il TableAdapter e la DataTable corrispondente al set di dati tipizzato.</span><span class="sxs-lookup"><span data-stu-id="0395e-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="0395e-199">Passaggio 4: includere la colonna calcolata nella query principale di TableAdapter</span><span class="sxs-lookup"><span data-stu-id="0395e-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="0395e-200">È ora necessario aggiornare TableAdapter e DataTable creati nel passaggio 3 per includere la colonna calcolata `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="0395e-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="0395e-201">Questa operazione include due passaggi:</span><span class="sxs-lookup"><span data-stu-id="0395e-201">This involves two steps:</span></span>

1. <span data-ttu-id="0395e-202">Aggiornamento della stored procedure `Suppliers_Select` per restituire la colonna calcolata `FullContactName` e</span><span class="sxs-lookup"><span data-stu-id="0395e-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="0395e-203">Aggiornamento del DataTable per includere una colonna di `FullContactName` corrispondente.</span><span class="sxs-lookup"><span data-stu-id="0395e-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="0395e-204">Per iniziare, passare al Esplora server ed eseguire il drill-down nella cartella stored procedure.</span><span class="sxs-lookup"><span data-stu-id="0395e-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="0395e-205">Aprire il stored procedure `Suppliers_Select` e aggiornare la query `SELECT` in modo da includere la colonna calcolata `FullContactName`:</span><span class="sxs-lookup"><span data-stu-id="0395e-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample4.sql)]

<span data-ttu-id="0395e-206">Salvare le modifiche apportate al stored procedure facendo clic sull'icona Salva sulla barra degli strumenti, premendo CTRL + S oppure scegliendo l'opzione Salva `Suppliers_Select` dal menu file.</span><span class="sxs-lookup"><span data-stu-id="0395e-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="0395e-207">Tornare quindi a Progettazione DataSet, fare clic con il pulsante destro del mouse sul `SuppliersTableAdapter`e scegliere Configura dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="0395e-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="0395e-208">Si noti che la colonna `Suppliers_Select` include ora la colonna `FullContactName` nella relativa raccolta di colonne di dati.</span><span class="sxs-lookup"><span data-stu-id="0395e-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>

<span data-ttu-id="0395e-209">[![eseguire la configurazione guidata di TableAdapter per aggiornare le colonne di DataTable](working-with-computed-columns-cs/_static/image17.png)](working-with-computed-columns-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-cs/_static/image17.png)](working-with-computed-columns-cs/_static/image16.png)</span></span>

<span data-ttu-id="0395e-210">**Figura 6**: eseguire la configurazione guidata di TableAdapter per aggiornare le colonne di DataTable ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-cs/_static/image18.png))</span></span>

<span data-ttu-id="0395e-211">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="0395e-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="0395e-212">Verrà aggiunta automaticamente una colonna corrispondente al `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="0395e-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="0395e-213">La procedura guidata TableAdapter è sufficientemente intelligente da rilevare che la colonna `FullContactName` è una colonna calcolata e quindi di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="0395e-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="0395e-214">Di conseguenza, imposta la proprietà `ReadOnly` della colonna su `true`.</span><span class="sxs-lookup"><span data-stu-id="0395e-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="0395e-215">Per verificarlo, selezionare la colonna dalla `SuppliersDataTable`, quindi passare al Finestra Proprietà (vedere la figura 7).</span><span class="sxs-lookup"><span data-stu-id="0395e-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="0395e-216">Si noti che anche le proprietà `DataType` e `MaxLength` della colonna `FullContactName` vengono impostate di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="0395e-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>

<span data-ttu-id="0395e-217">[![la colonna FullContactName è contrassegnata come di sola lettura](working-with-computed-columns-cs/_static/image20.png)](working-with-computed-columns-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-cs/_static/image20.png)](working-with-computed-columns-cs/_static/image19.png)</span></span>

<span data-ttu-id="0395e-218">**Figura 7**: la colonna `FullContactName` è contrassegnata come di sola lettura ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-cs/_static/image21.png))</span></span>

## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="0395e-219">Passaggio 5: aggiunta di un metodo di`GetSupplierBySupplierID`al TableAdapter</span><span class="sxs-lookup"><span data-stu-id="0395e-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="0395e-220">Per questa esercitazione verrà creata una pagina ASP.NET che consente di visualizzare i fornitori in una griglia aggiornabile.</span><span class="sxs-lookup"><span data-stu-id="0395e-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="0395e-221">Nelle esercitazioni precedenti è stato aggiornato un singolo record dal livello della logica di business recuperando il record particolare dal DAL come DataTable fortemente tipizzato, aggiornando le proprietà e quindi inviando di nuovo la DataTable aggiornata al DAL per propagare le modifiche a database.</span><span class="sxs-lookup"><span data-stu-id="0395e-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="0395e-222">Per eseguire questo primo passaggio: recupero del record aggiornato dal dal-è necessario innanzitutto aggiungere un metodo di `GetSupplierBySupplierID(supplierID)` al DAL.</span><span class="sxs-lookup"><span data-stu-id="0395e-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="0395e-223">Fare clic con il pulsante destro del mouse sul `SuppliersTableAdapter` nella progettazione del set di dati e scegliere l'opzione Aggiungi query dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="0395e-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="0395e-224">Come illustrato nel passaggio 3, consentire alla procedura guidata di generare un nuovo stored procedure per Microsoft selezionando l'opzione Crea nuovo stored procedure (per una schermata di questo passaggio della procedura guidata, fare riferimento alla figura 3).</span><span class="sxs-lookup"><span data-stu-id="0395e-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="0395e-225">Poiché questo metodo restituirà un record con più colonne, indicare che si desidera utilizzare una query SQL che è un oggetto SELECT che restituisce righe e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="0395e-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>

<span data-ttu-id="0395e-226">[![scegliere l'opzione per la restituzione delle righe](working-with-computed-columns-cs/_static/image23.png)](working-with-computed-columns-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-cs/_static/image23.png)](working-with-computed-columns-cs/_static/image22.png)</span></span>

<span data-ttu-id="0395e-227">**Figura 8**: scegliere l'opzione per la restituzione delle righe ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-cs/_static/image24.png))</span></span>

<span data-ttu-id="0395e-228">Il passaggio successivo richiede la query da usare per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="0395e-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="0395e-229">Immettere quanto segue, che restituisce gli stessi campi dati della query principale, ma per un fornitore specifico.</span><span class="sxs-lookup"><span data-stu-id="0395e-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>

[!code-sql[Main](working-with-computed-columns-cs/samples/sample5.sql)]

<span data-ttu-id="0395e-230">Nella schermata successiva viene chiesto di assegnare un nome alla stored procedure che verrà generata automaticamente.</span><span class="sxs-lookup"><span data-stu-id="0395e-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="0395e-231">Denominare questo stored procedure `Suppliers_SelectBySupplierID` e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="0395e-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>

<span data-ttu-id="0395e-232">[![nome della stored procedure Suppliers_SelectBySupplierID](working-with-computed-columns-cs/_static/image26.png)](working-with-computed-columns-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-cs/_static/image26.png)](working-with-computed-columns-cs/_static/image25.png)</span></span>

<span data-ttu-id="0395e-233">**Figura 9**: assegnare un nome alla stored procedure `Suppliers_SelectBySupplierID` ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-cs/_static/image27.png))</span></span>

<span data-ttu-id="0395e-234">Infine, la procedura guidata richiede i modelli di accesso ai dati e i nomi dei metodi da usare per l'oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="0395e-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="0395e-235">Lasciare selezionate entrambe le caselle di controllo, ma rinominare i metodi `FillBy` e `GetDataBy` rispettivamente per `FillBySupplierID` e `GetSupplierBySupplierID`.</span><span class="sxs-lookup"><span data-stu-id="0395e-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>

<span data-ttu-id="0395e-236">[![il nome dei metodi TableAdapter FillBySupplierID e GetSupplierBySupplierID](working-with-computed-columns-cs/_static/image29.png)](working-with-computed-columns-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-cs/_static/image29.png)](working-with-computed-columns-cs/_static/image28.png)</span></span>

<span data-ttu-id="0395e-237">**Figura 10**: assegnare un nome ai metodi TableAdapter `FillBySupplierID` e `GetSupplierBySupplierID` ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-cs/_static/image30.png))</span></span>

<span data-ttu-id="0395e-238">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="0395e-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="0395e-239">Passaggio 6: creazione del livello di logica di business</span><span class="sxs-lookup"><span data-stu-id="0395e-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="0395e-240">Prima di creare una pagina ASP.NET che usa la colonna calcolata creata nel passaggio 1, è prima di tutto necessario aggiungere i metodi corrispondenti in BLL.</span><span class="sxs-lookup"><span data-stu-id="0395e-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="0395e-241">La pagina ASP.NET, che viene creata nel passaggio 7, consentirà agli utenti di visualizzare e modificare i fornitori.</span><span class="sxs-lookup"><span data-stu-id="0395e-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="0395e-242">Per questo motivo, è necessario che il livello BLL fornisca, come minimo, un metodo per ottenere tutti i fornitori e un altro per aggiornare un particolare fornitore.</span><span class="sxs-lookup"><span data-stu-id="0395e-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="0395e-243">Creare un nuovo file di classe denominato `SuppliersBLLWithSprocs` nella cartella `~/App_Code/BLL` e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="0395e-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>

[!code-csharp[Main](working-with-computed-columns-cs/samples/sample6.cs)]

<span data-ttu-id="0395e-244">Analogamente alle altre classi BLL, `SuppliersBLLWithSprocs` dispone di una proprietà `protected` `Adapter` che restituisce un'istanza della classe `SuppliersTableAdapter` insieme a due metodi di `public`: `GetSuppliers` e `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="0395e-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="0395e-245">Il metodo `GetSuppliers` chiama e restituisce i `SuppliersDataTable` restituiti dal metodo `GetSupplier` corrispondente nel livello di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="0395e-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="0395e-246">Il metodo `UpdateSupplier` recupera le informazioni sul fornitore in corso di aggiornamento tramite una chiamata al metodo DAL `GetSupplierBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="0395e-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="0395e-247">Aggiorna quindi le proprietà `CategoryName`, `ContactName`e `ContactTitle` ed effettua il commit di queste modifiche nel database chiamando il metodo `Update` del livello di accesso ai dati, passando l'oggetto `SuppliersRow` modificato.</span><span class="sxs-lookup"><span data-stu-id="0395e-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="0395e-248">Ad eccezione di `SupplierID` e `CompanyName`, tutte le colonne nella tabella Suppliers consentono `NULL` valori.</span><span class="sxs-lookup"><span data-stu-id="0395e-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="0395e-249">Di conseguenza, se i parametri `contactName` o `contactTitle` passati sono `null` è necessario impostare le proprietà `ContactName` e `ContactTitle` corrispondenti su un valore di `NULL` database usando rispettivamente i metodi `SetContactNameNull` e `SetContactTitleNull`.</span><span class="sxs-lookup"><span data-stu-id="0395e-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `null` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>

## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="0395e-250">Passaggio 7: utilizzo della colonna calcolata dal livello di presentazione</span><span class="sxs-lookup"><span data-stu-id="0395e-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="0395e-251">Con la colonna calcolata aggiunta alla tabella `Suppliers` e il DAL e BLL aggiornati di conseguenza, è possibile creare una pagina ASP.NET che funzioni con la colonna calcolata `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="0395e-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="0395e-252">Per iniziare, aprire la pagina `ComputedColumns.aspx` nella cartella `AdvancedDAL` e trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="0395e-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="0395e-253">Impostare la proprietà GridView s `ID` su `Suppliers` e, dal relativo smart tag, associarla a un nuovo ObjectDataSource denominato `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0395e-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="0395e-254">Configurare ObjectDataSource per usare la classe `SuppliersBLLWithSprocs` aggiunta nel passaggio 6, quindi fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="0395e-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>

<span data-ttu-id="0395e-255">[![configurare ObjectDataSource per l'utilizzo della classe SuppliersBLLWithSprocs](working-with-computed-columns-cs/_static/image32.png)](working-with-computed-columns-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-cs/_static/image32.png)](working-with-computed-columns-cs/_static/image31.png)</span></span>

<span data-ttu-id="0395e-256">**Figura 11**: configurare ObjectDataSource per l'uso della classe `SuppliersBLLWithSprocs` ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-cs/_static/image33.png))</span></span>

<span data-ttu-id="0395e-257">Esistono solo due metodi definiti nella classe `SuppliersBLLWithSprocs`: `GetSuppliers` e `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="0395e-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="0395e-258">Verificare che questi due metodi siano specificati rispettivamente nelle schede seleziona e aggiorna, quindi fare clic su fine per completare la configurazione di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0395e-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="0395e-259">Al termine della configurazione guidata origine dati, in Visual Studio verrà aggiunto un BoundField per ognuno dei campi dati restituiti.</span><span class="sxs-lookup"><span data-stu-id="0395e-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="0395e-260">Rimuovere il `SupplierID` BoundField e modificare le proprietà del `HeaderText` dei BoundField `CompanyName`, `ContactName`, `ContactTitle`e `FullContactName` in società, nome contatto, titolo e nome completo del contatto, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="0395e-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="0395e-261">Dallo smart tag selezionare la casella di controllo Abilita modifica per attivare le funzionalità di modifica predefinite di GridView.</span><span class="sxs-lookup"><span data-stu-id="0395e-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="0395e-262">Oltre ad aggiungere i BoundField al GridView, il completamento della creazione guidata origine dati fa sì che Visual Studio imposti anche la proprietà `OldValuesParameterFormatString` di ObjectDataSource su\_originale {0}.</span><span class="sxs-lookup"><span data-stu-id="0395e-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="0395e-263">Ripristinare il valore predefinito di questa impostazione {0}.</span><span class="sxs-lookup"><span data-stu-id="0395e-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="0395e-264">Dopo aver apportato queste modifiche a GridView e ObjectDataSource, il relativo markup dichiarativo avrà un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="0395e-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](working-with-computed-columns-cs/samples/sample7.aspx)]

<span data-ttu-id="0395e-265">Visitare quindi questa pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="0395e-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="0395e-266">Come illustrato nella figura 12, ogni fornitore è elencato in una griglia che include la colonna `FullContactName`, il cui valore è semplicemente la concatenazione delle altre tre colonne formattate come `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="0395e-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="0395e-267">[![ogni fornitore è elencato nella griglia](working-with-computed-columns-cs/_static/image35.png)](working-with-computed-columns-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-cs/_static/image35.png)](working-with-computed-columns-cs/_static/image34.png)</span></span>

<span data-ttu-id="0395e-268">**Figura 12**: ogni fornitore è elencato nella griglia ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-cs/_static/image36.png))</span></span>

<span data-ttu-id="0395e-269">Se si fa clic sul pulsante modifica per un determinato fornitore, viene eseguito un postback e tale riga viene sottoposta a rendering nell'interfaccia di modifica (vedere la figura 13).</span><span class="sxs-lookup"><span data-stu-id="0395e-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="0395e-270">Il rendering delle prime tre colonne viene eseguito nell'interfaccia di modifica predefinita, ovvero un controllo TextBox la cui proprietà `Text` è impostata sul valore del campo dati.</span><span class="sxs-lookup"><span data-stu-id="0395e-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="0395e-271">La colonna `FullContactName`, tuttavia, rimane come testo.</span><span class="sxs-lookup"><span data-stu-id="0395e-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="0395e-272">Quando i BoundField sono stati aggiunti al controllo GridView al termine della configurazione guidata origine dati, la proprietà `ReadOnly` di `FullContactName` BoundField è stata impostata su `true` perché la relativa colonna di `FullContactName` nel `SuppliersDataTable` ha la relativa proprietà `ReadOnly` impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="0395e-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `true` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `true`.</span></span> <span data-ttu-id="0395e-273">Come indicato nel passaggio 4, la proprietà `ReadOnly` `FullContactName` s è stata impostata su `true` perché il TableAdapter ha rilevato che la colonna è una colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="0395e-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `true` because the TableAdapter detected that the column was a computed column.</span></span>

<span data-ttu-id="0395e-274">[![la colonna FullContactName non è modificabile](working-with-computed-columns-cs/_static/image38.png)](working-with-computed-columns-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="0395e-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-cs/_static/image38.png)](working-with-computed-columns-cs/_static/image37.png)</span></span>

<span data-ttu-id="0395e-275">**Figura 13**: la colonna `FullContactName` non è modificabile ([fare clic per visualizzare l'immagine con dimensioni complete](working-with-computed-columns-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="0395e-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-cs/_static/image39.png))</span></span>

<span data-ttu-id="0395e-276">Procedere con l'aggiornamento del valore di una o più colonne modificabili e fare clic su Aggiorna.</span><span class="sxs-lookup"><span data-stu-id="0395e-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="0395e-277">Si noti che il valore `FullContactName` s viene aggiornato automaticamente per riflettere la modifica.</span><span class="sxs-lookup"><span data-stu-id="0395e-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="0395e-278">GridView usa attualmente i BoundField per i campi modificabili, ottenendo l'interfaccia di modifica predefinita.</span><span class="sxs-lookup"><span data-stu-id="0395e-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="0395e-279">Poiché il campo `CompanyName` è obbligatorio, deve essere convertito in un TemplateField che include un RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="0395e-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="0395e-280">Lo lascio come esercizio per il lettore interessato.</span><span class="sxs-lookup"><span data-stu-id="0395e-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="0395e-281">Per istruzioni dettagliate sulla conversione di un BoundField in un TemplateField e sull'aggiunta di controlli di convalida, vedere l'esercitazione [aggiunta di controlli di convalida all'interfaccia di modifica e inserimento delle interfacce](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="0395e-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>

## <a name="summary"></a><span data-ttu-id="0395e-282">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="0395e-282">Summary</span></span>

<span data-ttu-id="0395e-283">Quando si definisce lo schema per una tabella, Microsoft SQL Server consente l'inclusione di colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="0395e-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="0395e-284">Si tratta di colonne i cui valori vengono calcolati da un'espressione che in genere fa riferimento ai valori di altre colonne nello stesso record.</span><span class="sxs-lookup"><span data-stu-id="0395e-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="0395e-285">Poiché i valori per le colonne calcolate sono basati su un'espressione, sono di sola lettura e non possono essere assegnati a un valore in un'istruzione `INSERT` o `UPDATE`.</span><span class="sxs-lookup"><span data-stu-id="0395e-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="0395e-286">In questo modo si verificano problemi durante l'utilizzo di una colonna calcolata nella query principale di un TableAdapter che tenta di generare automaticamente le istruzioni `INSERT`, `UPDATE`e `DELETE` corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="0395e-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="0395e-287">In questa esercitazione sono state illustrate le tecniche per aggirare le sfide poste dalle colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="0395e-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="0395e-288">In particolare, sono state usate stored procedure nel TableAdapter per superare la fragilità insita negli oggetti TableAdapter che usano istruzioni SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="0395e-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="0395e-289">Quando la procedura guidata TableAdapter crea nuove stored procedure, è importante che la query principale omette inizialmente le colonne calcolate perché la loro presenza impedisce la generazione delle stored procedure di modifica dei dati.</span><span class="sxs-lookup"><span data-stu-id="0395e-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="0395e-290">Dopo la configurazione iniziale del TableAdapter, è possibile rieseguire il `SelectCommand` stored procedure per includere tutte le colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="0395e-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="0395e-291">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="0395e-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0395e-292">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="0395e-292">About the Author</span></span>

<span data-ttu-id="0395e-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="0395e-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0395e-294">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="0395e-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0395e-295">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0395e-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0395e-296">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0395e-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0395e-297">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0395e-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0395e-298">Grazie speciale</span><span class="sxs-lookup"><span data-stu-id="0395e-298">Special Thanks To</span></span>

<span data-ttu-id="0395e-299">Questa serie di esercitazioni è stata esaminata da molti revisori utili.</span><span class="sxs-lookup"><span data-stu-id="0395e-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0395e-300">I revisori del lead per questa esercitazione erano Hilton Geisenow e Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="0395e-300">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="0395e-301">Sei interessato a esaminare i miei prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="0395e-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0395e-302">In tal caso, rilasciare una riga in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0395e-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0395e-303">[Precedente](adding-additional-datatable-columns-cs.md)
> [Successivo](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs.md)</span><span class="sxs-lookup"><span data-stu-id="0395e-303">[Previous](adding-additional-datatable-columns-cs.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs.md)</span></span>
