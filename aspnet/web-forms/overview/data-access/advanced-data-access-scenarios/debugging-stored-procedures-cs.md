---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-cs
title: Debug di stored procedureC#() | Microsoft Docs
author: rick-anderson
description: Le edizioni Visual Studio Professional e Team System consentono di impostare punti di interruzione ed eseguire un'istruzione alle stored procedure all'interno di SQL Server, rendendo archiviato il debug...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: c655c324-2ffa-4c21-8265-a254d79a693d
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-cs
msc.type: authoredcontent
ms.openlocfilehash: 12a8500b107345b9cc9ab457016fdef09ca1bb9d
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/28/2019
ms.locfileid: "74604718"
---
# <a name="debugging-stored-procedures-c"></a><span data-ttu-id="20b55-103">Debug di stored procedure (C#)</span><span class="sxs-lookup"><span data-stu-id="20b55-103">Debugging Stored Procedures (C#)</span></span>

<span data-ttu-id="20b55-104">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="20b55-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="20b55-105">[Scarica codice](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_CS.zip) o [Scarica PDF](debugging-stored-procedures-cs/_static/datatutorial74cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="20b55-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_CS.zip) or [Download PDF](debugging-stored-procedures-cs/_static/datatutorial74cs1.pdf)</span></span>

> <span data-ttu-id="20b55-106">Le edizioni Visual Studio Professional e Team System consentono di impostare punti di interruzione ed eseguire un'istruzione nelle stored procedure all'interno di SQL Server, semplificando il debug delle stored procedure per il debug del codice dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="20b55-106">Visual Studio Professional and Team System editions allow you to set breakpoints and step in to stored procedures within SQL Server, making debugging stored procedures as easy as debugging application code.</span></span> <span data-ttu-id="20b55-107">Questa esercitazione illustra il debug diretto del database e il debug di applicazioni di stored procedure.</span><span class="sxs-lookup"><span data-stu-id="20b55-107">This tutorial demonstrates direct database debugging and application debugging of stored procedures.</span></span>

## <a name="introduction"></a><span data-ttu-id="20b55-108">Introduzione</span><span class="sxs-lookup"><span data-stu-id="20b55-108">Introduction</span></span>

<span data-ttu-id="20b55-109">Visual Studio offre un'esperienza di debug avanzata.</span><span class="sxs-lookup"><span data-stu-id="20b55-109">Visual Studio provides a rich debugging experience.</span></span> <span data-ttu-id="20b55-110">Con poche sequenze di tasti o clic del mouse, è possibile usare i punti di interruzione per arrestare l'esecuzione di un programma ed esaminarne lo stato e il flusso di controllo.</span><span class="sxs-lookup"><span data-stu-id="20b55-110">With a few keystrokes or clicks of the mouse, it s possible to use breakpoints to stop execution of a program and examine its state and control flow.</span></span> <span data-ttu-id="20b55-111">Oltre al debug del codice dell'applicazione, Visual Studio offre il supporto per il debug di stored procedure dall'interno SQL Server.</span><span class="sxs-lookup"><span data-stu-id="20b55-111">Along with debugging application code, Visual Studio offers support for debugging stored procedures from within SQL Server.</span></span> <span data-ttu-id="20b55-112">Analogamente ai punti di interruzione possono essere impostati all'interno del codice di una classe code-behind ASP.NET o di una classe del livello della logica di business, anche se possono essere inseriti all'interno di stored procedure.</span><span class="sxs-lookup"><span data-stu-id="20b55-112">Just like breakpoints can be set within the code of an ASP.NET code-behind class or Business Logic Layer class, so too can they be placed within stored procedures.</span></span>

<span data-ttu-id="20b55-113">In questa esercitazione verrà illustrato come eseguire le stored procedure dall'Esplora server all'interno di Visual Studio e come impostare i punti di interruzione che vengono raggiunti quando il stored procedure viene chiamato dall'applicazione ASP.NET in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="20b55-113">In this tutorial we will look at stepping into stored procedures from the Server Explorer within Visual Studio as well as how to set breakpoints that are hit when the stored procedure is called from the running ASP.NET application.</span></span>

> [!NOTE]
> <span data-ttu-id="20b55-114">Sfortunatamente, le stored procedure possono essere sottoposte a debug solo tramite le versioni Professional e team Systems di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="20b55-114">Unfortunately, stored procedures can only be stepped into and debugged through the Professional and Team Systems versions of Visual Studio.</span></span> <span data-ttu-id="20b55-115">Se si usa Visual Web Developer o la versione standard di Visual Studio, è possibile leggere insieme ai passaggi necessari per eseguire il debug delle stored procedure, ma non sarà possibile replicare questi passaggi nel computer.</span><span class="sxs-lookup"><span data-stu-id="20b55-115">If you are using Visual Web Developer or the standard version of Visual Studio, you are welcome to read along as we walk through the steps necessary to debug stored procedures, but you will not be able to replicate these steps on your machine.</span></span>

## <a name="sql-server-debugging-concepts"></a><span data-ttu-id="20b55-116">Concetti relativi al debug di SQL Server</span><span class="sxs-lookup"><span data-stu-id="20b55-116">SQL Server Debugging Concepts</span></span>

<span data-ttu-id="20b55-117">Microsoft SQL Server 2005 è stato progettato per fornire l'integrazione con [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), ovvero il runtime utilizzato da tutti gli assembly .NET.</span><span class="sxs-lookup"><span data-stu-id="20b55-117">Microsoft SQL Server 2005 was designed to provide integration with the [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), which is the runtime used by all .NET assemblies.</span></span> <span data-ttu-id="20b55-118">Di conseguenza, SQL Server 2005 supporta oggetti di database gestiti.</span><span class="sxs-lookup"><span data-stu-id="20b55-118">Consequently, SQL Server 2005 supports managed database objects.</span></span> <span data-ttu-id="20b55-119">Ovvero, è possibile creare oggetti di database come stored procedure e funzioni definite dall'utente come metodi in una C# classe.</span><span class="sxs-lookup"><span data-stu-id="20b55-119">That is, you can create database objects like stored procedures and User-Defined Functions (UDFs) as methods in a C# class.</span></span> <span data-ttu-id="20b55-120">In questo modo, le stored procedure e le funzioni definite dall'utente utilizzeranno le funzionalità nell'.NET Framework e dalle classi personalizzate.</span><span class="sxs-lookup"><span data-stu-id="20b55-120">This enables these stored procedures and UDFs to utilize functionality in the .NET Framework and from your own custom classes.</span></span> <span data-ttu-id="20b55-121">Naturalmente, SQL Server 2005 fornisce anche il supporto per gli oggetti di database T-SQL.</span><span class="sxs-lookup"><span data-stu-id="20b55-121">Of course, SQL Server 2005 also provides support for T-SQL database objects.</span></span>

<span data-ttu-id="20b55-122">SQL Server 2005 offre supporto per il debug sia per gli oggetti T-SQL che per gli oggetti di database gestiti.</span><span class="sxs-lookup"><span data-stu-id="20b55-122">SQL Server 2005 offers debugging support for both T-SQL and managed database objects.</span></span> <span data-ttu-id="20b55-123">Tuttavia, è possibile eseguire il debug di questi oggetti solo tramite le edizioni di Visual Studio 2005 Professional e team Systems.</span><span class="sxs-lookup"><span data-stu-id="20b55-123">However, these objects can only be debugged through Visual Studio 2005 Professional and Team Systems editions.</span></span> <span data-ttu-id="20b55-124">In questa esercitazione verrà esaminato il debug di oggetti di database T-SQL.</span><span class="sxs-lookup"><span data-stu-id="20b55-124">In this tutorial we will examine debugging T-SQL database objects.</span></span> <span data-ttu-id="20b55-125">L'esercitazione successiva esamina il debug di oggetti di database gestiti.</span><span class="sxs-lookup"><span data-stu-id="20b55-125">The subsequent tutorial looks at debugging managed database objects.</span></span>

<span data-ttu-id="20b55-126">La [Panoramica del debug di T-SQL e CLR nel SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) di Blog del [team di integrazione clr di SQL Server 2005](https://blogs.msdn.com/sqlclr/default.aspx) evidenzia i tre modi per eseguire il debug di SQL Server 2005 oggetti da Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="20b55-126">The [Overview of T-SQL and CLR Debugging in SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) blog entry from the [SQL Server 2005 CLR Integration team](https://blogs.msdn.com/sqlclr/default.aspx) highlights the three ways to debug SQL Server 2005 objects from Visual Studio:</span></span>

- <span data-ttu-id="20b55-127">**Debug di database diretti (DDD)** : da Esplora server è possibile eseguire istruzioni su qualsiasi oggetto di database T-SQL, ad esempio stored procedure e funzioni definite dall'utente.</span><span class="sxs-lookup"><span data-stu-id="20b55-127">**Direct Database Debugging (DDD)** - from Server Explorer we can step into any T-SQL database object, such as stored procedures and UDFs.</span></span> <span data-ttu-id="20b55-128">Nel passaggio 1 viene esaminato DDD.</span><span class="sxs-lookup"><span data-stu-id="20b55-128">We will examine DDD in Step 1.</span></span>
- <span data-ttu-id="20b55-129">**Debug dell'applicazione** : è possibile impostare punti di interruzione in un oggetto di database e quindi eseguire l'applicazione ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="20b55-129">**Application Debugging** - we can set breakpoints within a database object and then run our ASP.NET application.</span></span> <span data-ttu-id="20b55-130">Quando l'oggetto di database viene eseguito, il punto di interruzione viene raggiunto e il controllo viene convertito nel debugger.</span><span class="sxs-lookup"><span data-stu-id="20b55-130">When the database object is executed, the breakpoint will be hit and control turned over to the debugger.</span></span> <span data-ttu-id="20b55-131">Si noti che con il debug dell'applicazione non è possibile eseguire un'istruzione in un oggetto di database dal codice dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="20b55-131">Note that with application debugging we cannot step into a database object from application code.</span></span> <span data-ttu-id="20b55-132">È necessario impostare in modo esplicito i punti di interruzione nelle stored procedure o nelle funzioni definite dall'utente in cui si desidera arrestare il debugger.</span><span class="sxs-lookup"><span data-stu-id="20b55-132">We must explicitly set breakpoints in those stored procedures or UDFs where we want the debugger to stop.</span></span> <span data-ttu-id="20b55-133">Il debug dell'applicazione viene esaminato a partire dal passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="20b55-133">Application debugging is examined starting in Step 2.</span></span>
- <span data-ttu-id="20b55-134">Il **debug da un SQL Server Project** -Visual Studio Professional e team Systems Edition includono un tipo di progetto SQL Server comunemente utilizzato per creare oggetti di database gestiti.</span><span class="sxs-lookup"><span data-stu-id="20b55-134">**Debugging from a SQL Server Project** - Visual Studio Professional and Team Systems editions include a SQL Server Project type that is commonly used to create managed database objects.</span></span> <span data-ttu-id="20b55-135">Nell'esercitazione successiva verrà esaminato l'utilizzo di progetti SQL Server e il relativo contenuto.</span><span class="sxs-lookup"><span data-stu-id="20b55-135">We will examine using SQL Server Projects and debugging their contents in the next tutorial.</span></span>

<span data-ttu-id="20b55-136">Visual Studio è in grado di eseguire il debug di stored procedure in istanze SQL Server locali e remote.</span><span class="sxs-lookup"><span data-stu-id="20b55-136">Visual Studio can debug stored procedures on local and remote SQL Server instances.</span></span> <span data-ttu-id="20b55-137">Un'istanza di SQL Server locale è installata nello stesso computer di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="20b55-137">A local SQL Server instance is one that is installed on the same machine as Visual Studio.</span></span> <span data-ttu-id="20b55-138">Se il database di SQL Server in uso non si trova nel computer di sviluppo, viene considerato un'istanza remota.</span><span class="sxs-lookup"><span data-stu-id="20b55-138">If the SQL Server database you are using is not located on your development machine, then it is considered a remote instance.</span></span> <span data-ttu-id="20b55-139">Per queste esercitazioni sono state usate istanze di SQL Server locali.</span><span class="sxs-lookup"><span data-stu-id="20b55-139">For these tutorials we have been using local SQL Server instances.</span></span> <span data-ttu-id="20b55-140">Per eseguire il debug di stored procedure in un'istanza remota di SQL Server sono necessari più passaggi di configurazione rispetto al debug di stored procedure in un'istanza locale.</span><span class="sxs-lookup"><span data-stu-id="20b55-140">Debugging stored procedures on a remote SQL server instance requires more configuration steps than when debugging stored procedures on a local instance.</span></span>

<span data-ttu-id="20b55-141">Se si usa un'istanza di SQL Server locale, è possibile iniziare con il passaggio 1 e completare questa esercitazione fino alla fine.</span><span class="sxs-lookup"><span data-stu-id="20b55-141">If you are using a local SQL Server instance, you can start with Step 1 and work through this tutorial to the end.</span></span> <span data-ttu-id="20b55-142">Se si utilizza un'istanza di SQL Server remota, tuttavia, prima di tutto è necessario assicurarsi che, durante il debug, il computer di sviluppo venga registrato con un account utente di Windows che disponga di un account di accesso SQL Server nell'istanza remota.</span><span class="sxs-lookup"><span data-stu-id="20b55-142">If you are using a remote SQL Server instance, however, you will first need to ensure that when debugging you are logged to your development machine with a Windows user account that has a SQL Server login on the remote instance.</span></span> <span data-ttu-id="20b55-143">Inoltre, l'account di accesso al database e l'account di accesso al database utilizzati per connettersi al database dall'applicazione ASP.NET in esecuzione devono essere membri del ruolo `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="20b55-143">Moreover, both this database login and the database login used to connect to the database from the running ASP.NET application must be members of the `sysadmin` role.</span></span> <span data-ttu-id="20b55-144">Per ulteriori informazioni sulla configurazione di Visual Studio e SQL Server per eseguire il debug di un'istanza remota, vedere la sezione debug di oggetti di database T-SQL in istanze remote.</span><span class="sxs-lookup"><span data-stu-id="20b55-144">See the Debugging T-SQL Database Objects on Remote Instances section at the end of this tutorial for more information on configuring Visual Studio and SQL Server to debug a remote instance.</span></span>

<span data-ttu-id="20b55-145">Infine, è importante comprendere che il supporto del debug per gli oggetti di database T-SQL non è così ricco di funzionalità come il supporto del debug per le applicazioni .NET.</span><span class="sxs-lookup"><span data-stu-id="20b55-145">Finally, understand that debugging support for T-SQL database objects is not as feature rich as debugging support for .NET applications.</span></span> <span data-ttu-id="20b55-146">Ad esempio, le condizioni del punto di interruzione e i filtri non sono supportati, ma solo un subset delle finestre di debug è disponibile, non è possibile usare modifica e continuazione, il rendering della finestra immediata viene reso inutile e così via.</span><span class="sxs-lookup"><span data-stu-id="20b55-146">For example, breakpoint conditions and filters are not supported, only a subset of the debugging windows are available, you cannot use Edit and Continue, the Immediate window is rendered useless, and so forth.</span></span> <span data-ttu-id="20b55-147">Per ulteriori informazioni, vedere [limitazioni sui comandi e sulle funzionalità del debugger](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) .</span><span class="sxs-lookup"><span data-stu-id="20b55-147">See [Limitations on Debugger Commands and Features](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) for more information.</span></span>

## <a name="step-1-directly-stepping-into-a-stored-procedure"></a><span data-ttu-id="20b55-148">Passaggio 1: esecuzione diretta di una stored procedure</span><span class="sxs-lookup"><span data-stu-id="20b55-148">Step 1: Directly Stepping Into a Stored Procedure</span></span>

<span data-ttu-id="20b55-149">Visual Studio semplifica il debug diretto di un oggetto di database.</span><span class="sxs-lookup"><span data-stu-id="20b55-149">Visual Studio makes it easy to directly debug a database object.</span></span> <span data-ttu-id="20b55-150">Viene ora illustrato come utilizzare la funzionalità di debug di database diretto (DDD) per eseguire un'istruzione nel `Products_SelectByCategoryID` stored procedure nel database Northwind.</span><span class="sxs-lookup"><span data-stu-id="20b55-150">Let s look at how to use the Direct Database Debugging (DDD) feature to step into the `Products_SelectByCategoryID` stored procedure in the Northwind database.</span></span> <span data-ttu-id="20b55-151">Come suggerisce il nome, `Products_SelectByCategoryID` restituisce informazioni sul prodotto per una categoria specifica. è stato creato nell'esercitazione [utilizzo di stored procedure esistenti per il DataSet tipizzato s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="20b55-151">As its name implies, `Products_SelectByCategoryID` returns product information for a particular category; it was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="20b55-152">Per iniziare, passare al Esplora server ed espandere il nodo del database Northwind.</span><span class="sxs-lookup"><span data-stu-id="20b55-152">Start by going to the Server Explorer and expand the Northwind database node.</span></span> <span data-ttu-id="20b55-153">Successivamente, eseguire il drill-down nella cartella stored procedure, fare clic con il pulsante destro del mouse sul stored procedure `Products_SelectByCategoryID` e scegliere l'opzione Esegui istruzione stored procedure dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="20b55-153">Next, drill down into the Stored Procedures folder, right-click on the `Products_SelectByCategoryID` stored procedure, and choose the Step Into Stored Procedure option from the context menu.</span></span> <span data-ttu-id="20b55-154">Verrà avviato il debugger.</span><span class="sxs-lookup"><span data-stu-id="20b55-154">This will start the debugger.</span></span>

<span data-ttu-id="20b55-155">Poiché il `Products_SelectByCategoryID` stored procedure prevede un parametro di input `@CategoryID`, viene richiesto di fornire questo valore.</span><span class="sxs-lookup"><span data-stu-id="20b55-155">Since the `Products_SelectByCategoryID` stored procedure expects a `@CategoryID` input parameter, we are asked to provide this value.</span></span> <span data-ttu-id="20b55-156">Immettere 1, che restituirà informazioni sulle bevande.</span><span class="sxs-lookup"><span data-stu-id="20b55-156">Enter 1, which will return information about the beverages.</span></span>

![Usare il valore 1 per il parametro @CategoryID](debugging-stored-procedures-cs/_static/image1.png)

<span data-ttu-id="20b55-158">**Figura 1**: usare il valore 1 per il parametro `@CategoryID`</span><span class="sxs-lookup"><span data-stu-id="20b55-158">**Figure 1**: Use the Value 1 for the `@CategoryID` Parameter</span></span>

<span data-ttu-id="20b55-159">Dopo aver fornito il valore per il parametro `@CategoryID`, viene eseguita la stored procedure.</span><span class="sxs-lookup"><span data-stu-id="20b55-159">After supplying the value for the `@CategoryID` parameter, the stored procedure is executed.</span></span> <span data-ttu-id="20b55-160">Anziché eseguire fino al completamento, tuttavia, il debugger interrompe l'esecuzione sulla prima istruzione.</span><span class="sxs-lookup"><span data-stu-id="20b55-160">Rather than running to completion, though, the debugger halts execution on the first statement.</span></span> <span data-ttu-id="20b55-161">Prendere nota della freccia gialla nel margine, che indica la posizione corrente nel stored procedure.</span><span class="sxs-lookup"><span data-stu-id="20b55-161">Note the yellow arrow in the margin, indicating the current location in the stored procedure.</span></span> <span data-ttu-id="20b55-162">È possibile visualizzare e modificare i valori dei parametri tramite il finestra Espressioni di controllo o posizionando il puntatore del mouse sul nome del parametro nel stored procedure.</span><span class="sxs-lookup"><span data-stu-id="20b55-162">You can view and edit parameter values through the Watch window or by hovering over the parameter name in the stored procedure.</span></span>

<span data-ttu-id="20b55-163">[![il debugger si è arrestato sulla prima istruzione della stored procedure](debugging-stored-procedures-cs/_static/image3.png)](debugging-stored-procedures-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="20b55-163">[![The Debugger has Halted on the First Statement of the Stored Procedure](debugging-stored-procedures-cs/_static/image3.png)](debugging-stored-procedures-cs/_static/image2.png)</span></span>

<span data-ttu-id="20b55-164">**Figura 2**: il debugger è stato interrotto sulla prima istruzione della stored procedure ([fare clic per visualizzare l'immagine con dimensioni complete](debugging-stored-procedures-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="20b55-164">**Figure 2**: The Debugger has Halted on the First Statement of the Stored Procedure ([Click to view full-size image](debugging-stored-procedures-cs/_static/image4.png))</span></span>

<span data-ttu-id="20b55-165">Per eseguire il stored procedure un'istruzione alla volta, fare clic sul pulsante Esegui istruzione/routine sulla barra degli strumenti o premere il tasto F10.</span><span class="sxs-lookup"><span data-stu-id="20b55-165">To step through the stored procedure one statement at a time, click the Step Over button in the Toolbar or hit the F10 key.</span></span> <span data-ttu-id="20b55-166">Il `Products_SelectByCategoryID` stored procedure contiene una singola istruzione `SELECT`, quindi la funzione F10 eseguirà l'istruzione/routine della singola istruzione e completerà l'esecuzione del stored procedure.</span><span class="sxs-lookup"><span data-stu-id="20b55-166">The `Products_SelectByCategoryID` stored procedure contains a single `SELECT` statement, so hitting F10 will Step over the single statement and complete the execution of the stored procedure.</span></span> <span data-ttu-id="20b55-167">Al termine dell'stored procedure, l'output verrà visualizzato nella finestra di output e il debugger verrà terminato.</span><span class="sxs-lookup"><span data-stu-id="20b55-167">After the stored procedure has completed, its output will appear in the Output window and the debugger will terminate.</span></span>

> [!NOTE]
> <span data-ttu-id="20b55-168">Il debug T-SQL viene eseguito a livello di istruzione. non è possibile eseguire istruzioni in un'istruzione `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="20b55-168">T-SQL debugging occurs at the statement level; you cannot Step into a `SELECT` statement.</span></span>

## <a name="step-2-configuring-the-website-for-application-debugging"></a><span data-ttu-id="20b55-169">Passaggio 2: configurazione del sito Web per il debug di applicazioni</span><span class="sxs-lookup"><span data-stu-id="20b55-169">Step 2: Configuring the Website for Application Debugging</span></span>

<span data-ttu-id="20b55-170">Quando si esegue il debug di un stored procedure direttamente dall'Esplora server è utile, in molti scenari è più interessante eseguire il debug del stored procedure quando viene chiamato dall'applicazione ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="20b55-170">While debugging a stored procedure directly from the Server Explorer is handy, in many scenarios we are more interested in debugging the stored procedure when it is called from our ASP.NET application.</span></span> <span data-ttu-id="20b55-171">È possibile aggiungere punti di interruzione a un stored procedure all'interno di Visual Studio e avviare il debug dell'applicazione ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="20b55-171">We can add breakpoints to a stored procedure from within Visual Studio and then start debugging the ASP.NET application.</span></span> <span data-ttu-id="20b55-172">Quando un stored procedure con punti di interruzione viene richiamato dall'applicazione, l'esecuzione si arresterà in corrispondenza del punto di interruzione e sarà possibile visualizzare e modificare i valori dei parametri della stored procedure e scorrere le istruzioni, esattamente come nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="20b55-172">When a stored procedure with breakpoints is invoked from the application, execution will halt at the breakpoint and we can view and change the stored procedure s parameter values and step through its statements, just like we did in Step 1.</span></span>

<span data-ttu-id="20b55-173">Prima di poter avviare il debug delle stored procedure chiamate dall'applicazione, è necessario indicare all'applicazione Web ASP.NET di integrarsi con il debugger SQL Server.</span><span class="sxs-lookup"><span data-stu-id="20b55-173">Before we can start debugging stored procedures called from the application, we need to instruct the ASP.NET web application to integrate with the SQL Server debugger.</span></span> <span data-ttu-id="20b55-174">Per iniziare, fare clic con il pulsante destro del mouse sul nome del sito Web nella Esplora soluzioni (`ASPNET_Data_Tutorial_74_CS`).</span><span class="sxs-lookup"><span data-stu-id="20b55-174">Start by right-clicking on the website name in the Solution Explorer (`ASPNET_Data_Tutorial_74_CS`).</span></span> <span data-ttu-id="20b55-175">Scegliere l'opzione pagine delle proprietà dal menu di scelta rapida, selezionare l'elemento Opzioni di avvio a sinistra e selezionare la casella di controllo SQL Server nella sezione debugger (vedere la figura 3).</span><span class="sxs-lookup"><span data-stu-id="20b55-175">Choose the Property Pages option from the context menu, select the Start Options item on the left, and check the SQL Server checkbox in the Debuggers section (see Figure 3).</span></span>

<span data-ttu-id="20b55-176">[![selezionare la casella di controllo SQL Server nelle pagine delle proprietà dell'applicazione](debugging-stored-procedures-cs/_static/image6.png)](debugging-stored-procedures-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="20b55-176">[![Check the SQL Server Checkbox in the Application s Property Pages](debugging-stored-procedures-cs/_static/image6.png)](debugging-stored-procedures-cs/_static/image5.png)</span></span>

<span data-ttu-id="20b55-177">**Figura 3**: selezionare la casella di controllo SQL Server nelle pagine delle proprietà dell'applicazione ([fare clic per visualizzare l'immagine con dimensioni complete](debugging-stored-procedures-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="20b55-177">**Figure 3**: Check the SQL Server Checkbox in the Application s Property Pages ([Click to view full-size image](debugging-stored-procedures-cs/_static/image7.png))</span></span>

<span data-ttu-id="20b55-178">Inoltre, è necessario aggiornare la stringa di connessione del database usata dall'applicazione in modo che il pool di connessioni sia disabilitato.</span><span class="sxs-lookup"><span data-stu-id="20b55-178">Additionally, we need to update the database connection string used by the application so that connection pooling is disabled.</span></span> <span data-ttu-id="20b55-179">Quando una connessione a un database viene chiusa, l'oggetto `SqlConnection` corrispondente viene inserito in un pool di connessioni disponibili.</span><span class="sxs-lookup"><span data-stu-id="20b55-179">When a connection to a database is closed, the corresponding `SqlConnection` object is placed in a pool of available connections.</span></span> <span data-ttu-id="20b55-180">Quando si stabilisce una connessione a un database, è possibile recuperare un oggetto connessione disponibile da questo pool anziché dover creare e stabilire una nuova connessione.</span><span class="sxs-lookup"><span data-stu-id="20b55-180">When establishing a connection to a database, an available connection object can be retrieved from this pool rather than having to create and establish a new connection.</span></span> <span data-ttu-id="20b55-181">Questo pool di oggetti connessione rappresenta un miglioramento delle prestazioni ed è abilitato per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="20b55-181">This pooling of connection objects is a performance enhancement and is enabled by default.</span></span> <span data-ttu-id="20b55-182">Tuttavia, quando si esegue il debug si desidera disattivare il pool di connessioni perché l'infrastruttura di debug non viene ristabilita correttamente quando si utilizza una connessione ricavata dal pool.</span><span class="sxs-lookup"><span data-stu-id="20b55-182">However, when debugging we want to turn off connection pooling because the debugging infrastructure is not correctly reestablished when working with a connection that was taken from the pool.</span></span>

<span data-ttu-id="20b55-183">Per disabilitare il pool di connessioni, aggiornare il `NORTHWNDConnectionString` in `Web.config` in modo che includa l'impostazione `Pooling=false`.</span><span class="sxs-lookup"><span data-stu-id="20b55-183">To disabled connection pooling, update the `NORTHWNDConnectionString` in `Web.config` so that it includes the setting `Pooling=false` .</span></span>

[!code-xml[Main](debugging-stored-procedures-cs/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="20b55-184">Una volta terminato il debug SQL Server tramite l'applicazione ASP.NET, assicurarsi di ripristinare il pool di connessioni rimuovendo l'impostazione `Pooling` dalla stringa di connessione (oppure impostando il valore su `Pooling=true`).</span><span class="sxs-lookup"><span data-stu-id="20b55-184">Once you have finished debugging SQL Server through the ASP.NET application be sure to reinstate connection pooling by removing the `Pooling` setting from the connection string (or by setting it to `Pooling=true` ).</span></span>

<span data-ttu-id="20b55-185">A questo punto l'applicazione ASP.NET è stata configurata in modo da consentire a Visual Studio di eseguire il debug di SQL Server oggetti di database quando viene richiamato tramite l'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="20b55-185">At this point the ASP.NET application has been configured to allow Visual Studio to debug SQL Server database objects when invoked through the web application.</span></span> <span data-ttu-id="20b55-186">Non resta che aggiungere un punto di interruzione a una stored procedure e avviare il debug.</span><span class="sxs-lookup"><span data-stu-id="20b55-186">All that remains now is to add a breakpoint to a stored procedure and start debugging!</span></span>

## <a name="step-3-adding-a-breakpoint-and-debugging"></a><span data-ttu-id="20b55-187">Passaggio 3: aggiunta di un punto di interruzione e debug</span><span class="sxs-lookup"><span data-stu-id="20b55-187">Step 3: Adding a Breakpoint and Debugging</span></span>

<span data-ttu-id="20b55-188">Aprire il `Products_SelectByCategoryID` stored procedure e impostare un punto di interruzione all'inizio dell'istruzione `SELECT` facendo clic sul margine nella posizione appropriata o posizionando il cursore all'inizio dell'istruzione `SELECT` e premendo F9.</span><span class="sxs-lookup"><span data-stu-id="20b55-188">Open the `Products_SelectByCategoryID` stored procedure and set a breakpoint at the start of the `SELECT` statement by clicking in the margin at the appropriate place or by placing your cursor at the start of the `SELECT` statement and hitting F9.</span></span> <span data-ttu-id="20b55-189">Come illustrato nella figura 4, il punto di interruzione viene visualizzato come cerchio rosso nel margine.</span><span class="sxs-lookup"><span data-stu-id="20b55-189">As Figure 4 illustrates, the breakpoint appears as a red circle in the margin.</span></span>

<span data-ttu-id="20b55-190">[![impostare un punto di interruzione nella stored procedure Products_SelectByCategoryID](debugging-stored-procedures-cs/_static/image9.png)](debugging-stored-procedures-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="20b55-190">[![Set a Breakpoint in the Products_SelectByCategoryID Stored Procedure](debugging-stored-procedures-cs/_static/image9.png)](debugging-stored-procedures-cs/_static/image8.png)</span></span>

<span data-ttu-id="20b55-191">**Figura 4**: impostare un punto di interruzione nella stored procedure `Products_SelectByCategoryID` ([fare clic per visualizzare l'immagine con dimensioni complete](debugging-stored-procedures-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="20b55-191">**Figure 4**: Set a Breakpoint in the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](debugging-stored-procedures-cs/_static/image10.png))</span></span>

<span data-ttu-id="20b55-192">Per eseguire il debug di un oggetto di database SQL tramite un'applicazione client, è necessario che il database sia configurato per supportare il debug delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="20b55-192">In order for a SQL database object to be debugged through a client application, it is imperative that the database be configured to support application debugging.</span></span> <span data-ttu-id="20b55-193">Quando si imposta un punto di interruzione per la prima volta, questa impostazione deve essere attivata automaticamente, ma è prudente eseguire un doppio controllo.</span><span class="sxs-lookup"><span data-stu-id="20b55-193">When you first set a breakpoint, this setting should automatically be switched on, but it is prudent to double-check.</span></span> <span data-ttu-id="20b55-194">Fare clic con il pulsante destro del mouse sul nodo `NORTHWND.MDF` nel Esplora server.</span><span class="sxs-lookup"><span data-stu-id="20b55-194">Right-click on the `NORTHWND.MDF` node in the Server Explorer.</span></span> <span data-ttu-id="20b55-195">Il menu di scelta rapida deve includere una voce di menu selezionata denominata debug applicazione.</span><span class="sxs-lookup"><span data-stu-id="20b55-195">The context menu should include a checked menu item named Application Debugging .</span></span>

![Verificare che l'opzione di debug dell'applicazione sia abilitata](debugging-stored-procedures-cs/_static/image11.png)

<span data-ttu-id="20b55-197">**Figura 5**: assicurarsi che l'opzione di debug dell'applicazione sia abilitata</span><span class="sxs-lookup"><span data-stu-id="20b55-197">**Figure 5**: Ensure that the Application Debugging Option is Enabled</span></span>

<span data-ttu-id="20b55-198">Con il punto di interruzione impostato e l'opzione di debug dell'applicazione abilitata, è possibile eseguire il debug del stored procedure quando viene chiamato dall'applicazione ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="20b55-198">With the breakpoint set and the Application Debugging option enabled, we are ready to debug the stored procedure when called from the ASP.NET application.</span></span> <span data-ttu-id="20b55-199">Avviare il debugger scegliendo Avvia debug dal menu debug, premendo F5 oppure facendo clic sull'icona di riproduzione verde sulla barra degli strumenti.</span><span class="sxs-lookup"><span data-stu-id="20b55-199">Start the debugger by going to the Debug menu and choosing Start Debugging, by hitting F5, or by clicking the green play icon in the Toolbar.</span></span> <span data-ttu-id="20b55-200">Questo avvierà il debugger e avvierà il sito Web.</span><span class="sxs-lookup"><span data-stu-id="20b55-200">This will start the debugger and launch the website.</span></span>

<span data-ttu-id="20b55-201">Il stored procedure `Products_SelectByCategoryID` è stato creato nell'esercitazione [utilizzo di stored procedure esistenti per i TableAdapter tipizzati del set di dati](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="20b55-201">The `Products_SelectByCategoryID` stored procedure was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="20b55-202">La pagina Web corrispondente (`~/AdvancedDAL/ExistingSprocs.aspx`) contiene un GridView che Visualizza i risultati restituiti da questo stored procedure.</span><span class="sxs-lookup"><span data-stu-id="20b55-202">Its corresponding web page (`~/AdvancedDAL/ExistingSprocs.aspx`) contains a GridView that displays the results returned by this stored procedure.</span></span> <span data-ttu-id="20b55-203">Visitare questa pagina tramite il browser.</span><span class="sxs-lookup"><span data-stu-id="20b55-203">Visit this page through the browser.</span></span> <span data-ttu-id="20b55-204">Al raggiungimento della pagina, il punto di interruzione nella `Products_SelectByCategoryID` stored procedure viene raggiunto e il controllo viene restituito a Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="20b55-204">Upon reaching the page, the breakpoint in the `Products_SelectByCategoryID` stored procedure will be hit and control returned to Visual Studio.</span></span> <span data-ttu-id="20b55-205">Proprio come nel passaggio 1, è possibile eseguire le istruzioni stored procedure s e visualizzare e modificare i valori dei parametri.</span><span class="sxs-lookup"><span data-stu-id="20b55-205">Just like in Step 1, you can step through the stored procedure s statements and view and modify the parameter values.</span></span>

<span data-ttu-id="20b55-206">[![pagina ExistingSprocs. aspx inizialmente Visualizza le bevande](debugging-stored-procedures-cs/_static/image13.png)](debugging-stored-procedures-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="20b55-206">[![The ExistingSprocs.aspx Page Initially Displays the Beverages](debugging-stored-procedures-cs/_static/image13.png)](debugging-stored-procedures-cs/_static/image12.png)</span></span>

<span data-ttu-id="20b55-207">**Figura 6**: la pagina `ExistingSprocs.aspx` Visualizza inizialmente le bevande ([fare clic per visualizzare l'immagine con dimensioni complete](debugging-stored-procedures-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="20b55-207">**Figure 6**: The `ExistingSprocs.aspx` Page Initially Displays the Beverages ([Click to view full-size image](debugging-stored-procedures-cs/_static/image14.png))</span></span>

<span data-ttu-id="20b55-208">[![è stato raggiunto il punto di interruzione della stored procedure](debugging-stored-procedures-cs/_static/image16.png)](debugging-stored-procedures-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="20b55-208">[![The Stored Procedure s Breakpoint has been Reached](debugging-stored-procedures-cs/_static/image16.png)](debugging-stored-procedures-cs/_static/image15.png)</span></span>

<span data-ttu-id="20b55-209">**Figura 7**: è stato raggiunto il punto di interruzione della stored procedure ([fare clic per visualizzare l'immagine con dimensioni complete](debugging-stored-procedures-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="20b55-209">**Figure 7**: The Stored Procedure s Breakpoint has been Reached ([Click to view full-size image](debugging-stored-procedures-cs/_static/image17.png))</span></span>

<span data-ttu-id="20b55-210">Come illustrato nell'finestra Espressioni di controllo della figura 7, il valore del parametro `@CategoryID` è 1.</span><span class="sxs-lookup"><span data-stu-id="20b55-210">As the Watch window in Figure 7 shows, the value of the `@CategoryID` parameter is 1.</span></span> <span data-ttu-id="20b55-211">Questo è dovuto al fatto che la pagina `ExistingSprocs.aspx` Visualizza inizialmente i prodotti nella categoria bevande, il cui valore `CategoryID` è pari a 1.</span><span class="sxs-lookup"><span data-stu-id="20b55-211">This is because the `ExistingSprocs.aspx` page initially displays products in the beverages category, which has a `CategoryID` value of 1.</span></span> <span data-ttu-id="20b55-212">Scegliere una categoria diversa dall'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="20b55-212">Choose a different category from the drop-down list.</span></span> <span data-ttu-id="20b55-213">Questa operazione provoca un postback ed esegue nuovamente il `Products_SelectByCategoryID` stored procedure.</span><span class="sxs-lookup"><span data-stu-id="20b55-213">Doing so causes a postback and re-executes the `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="20b55-214">Il punto di interruzione viene raggiunto di nuovo, ma questa volta il valore del parametro `@CategoryID` riflette l'elemento dell'elenco a discesa selezionato s `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="20b55-214">The breakpoint is hit again, but this time the `@CategoryID` parameter s value reflects the selected drop-down list item s `CategoryID`.</span></span>

<span data-ttu-id="20b55-215">[![scegliere una categoria diversa dall'elenco a discesa](debugging-stored-procedures-cs/_static/image19.png)](debugging-stored-procedures-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="20b55-215">[![Choose a Different Category from the Drop-Down List](debugging-stored-procedures-cs/_static/image19.png)](debugging-stored-procedures-cs/_static/image18.png)</span></span>

<span data-ttu-id="20b55-216">**Figura 8**: scegliere una categoria diversa dall'elenco a discesa ([fare clic per visualizzare l'immagine con dimensioni complete](debugging-stored-procedures-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="20b55-216">**Figure 8**: Choose a Different Category from the Drop-Down List ([Click to view full-size image](debugging-stored-procedures-cs/_static/image20.png))</span></span>

<span data-ttu-id="20b55-217">[![il parametro @CategoryID riflette la categoria selezionata dalla pagina Web](debugging-stored-procedures-cs/_static/image22.png)](debugging-stored-procedures-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="20b55-217">[![The @CategoryID Parameter Reflects the Category Selected from the Web Page](debugging-stored-procedures-cs/_static/image22.png)](debugging-stored-procedures-cs/_static/image21.png)</span></span>

<span data-ttu-id="20b55-218">**Figura 9**: il parametro `@CategoryID` riflette la categoria selezionata dalla pagina Web ([fare clic per visualizzare l'immagine con dimensioni complete](debugging-stored-procedures-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="20b55-218">**Figure 9**: The `@CategoryID` Parameter Reflects the Category Selected from the Web Page ([Click to view full-size image](debugging-stored-procedures-cs/_static/image23.png))</span></span>

> [!NOTE]
> <span data-ttu-id="20b55-219">Se il punto di interruzione nel stored procedure `Products_SelectByCategoryID` non viene raggiunto quando si visita la pagina `ExistingSprocs.aspx`, assicurarsi che la casella di controllo SQL Server sia stata selezionata nella sezione debugger della pagina delle proprietà dell'applicazione ASP.NET, che il pool di connessioni sia stato disabilitato e che l'opzione di debug dell'applicazione del database sia abilitata.</span><span class="sxs-lookup"><span data-stu-id="20b55-219">If the breakpoint in the `Products_SelectByCategoryID` stored procedure is not hit when visiting the `ExistingSprocs.aspx` page, make sure that the SQL Server checkbox has been checked in the Debuggers section of the ASP.NET application s Properties Page, that connection pooling has been disabled, and that the database s Application Debugging option is enabled.</span></span> <span data-ttu-id="20b55-220">Se si verificano ancora problemi, riavviare Visual Studio e riprovare.</span><span class="sxs-lookup"><span data-stu-id="20b55-220">If you re still having problems, restart Visual Studio and try again.</span></span>

## <a name="debugging-t-sql-database-objects-on-remote-instances"></a><span data-ttu-id="20b55-221">Debug di oggetti di database T-SQL in istanze remote</span><span class="sxs-lookup"><span data-stu-id="20b55-221">Debugging T-SQL Database Objects on Remote Instances</span></span>

<span data-ttu-id="20b55-222">Il debug di oggetti di database tramite Visual Studio è piuttosto semplice quando l'istanza di database SQL Server si trova nello stesso computer di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="20b55-222">Debugging database objects through Visual Studio is fairly straightforward when the SQL Server database instance is on the same machine as Visual Studio.</span></span> <span data-ttu-id="20b55-223">Tuttavia, se SQL Server e Visual Studio si trovano in computer diversi, è necessaria una configurazione attenta per ottenere tutto il funzionamento corretto.</span><span class="sxs-lookup"><span data-stu-id="20b55-223">However, if SQL Server and Visual Studio reside on different machines then some careful configuration is required to get everything working properly.</span></span> <span data-ttu-id="20b55-224">Ci sono due attività principali da affrontare:</span><span class="sxs-lookup"><span data-stu-id="20b55-224">There are two core tasks we are faced with:</span></span>

- <span data-ttu-id="20b55-225">Verificare che l'account di accesso utilizzato per la connessione al database tramite ADO.NET appartenga al ruolo `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="20b55-225">Ensure that the login used to connect to the database via ADO.NET belongs to the `sysadmin` role.</span></span>
- <span data-ttu-id="20b55-226">Verificare che l'account utente di Windows usato da Visual Studio nel computer di sviluppo sia un account di accesso SQL Server valido che appartenga al ruolo `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="20b55-226">Ensure that the Windows user account used by Visual Studio on the development machine is a valid SQL Server login account that belongs to the `sysadmin` role.</span></span>

<span data-ttu-id="20b55-227">Il primo passaggio è relativamente semplice.</span><span class="sxs-lookup"><span data-stu-id="20b55-227">The first step is relatively straightforward.</span></span> <span data-ttu-id="20b55-228">Per prima cosa, identificare l'account utente usato per connettersi al database dall'applicazione ASP.NET e quindi, da SQL Server Management Studio, aggiungere tale account di accesso al ruolo `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="20b55-228">First, identify the user account used to connect to the database from the ASP.NET application and then, from SQL Server Management Studio, add that login account to the `sysadmin` role.</span></span>

<span data-ttu-id="20b55-229">La seconda attività richiede che l'account utente di Windows utilizzato per eseguire il debug dell'applicazione sia un account di accesso valido nel database remoto.</span><span class="sxs-lookup"><span data-stu-id="20b55-229">The second task requires that the Windows user account you use to debug the application be a valid login on the remote database.</span></span> <span data-ttu-id="20b55-230">Tuttavia, è probabile che l'account di Windows con cui si è effettuato l'accesso alla workstation non sia un account di accesso valido per SQL Server.</span><span class="sxs-lookup"><span data-stu-id="20b55-230">However, chances are the Windows account you logged on to your workstation with is not a valid login on SQL Server.</span></span> <span data-ttu-id="20b55-231">Anziché aggiungere un account di accesso specifico a SQL Server, una scelta migliore consiste nel designare un account utente di Windows come account di debug SQL Server.</span><span class="sxs-lookup"><span data-stu-id="20b55-231">Rather than adding your particular login account to SQL Server, a better choice would be to designate some Windows user account as the SQL Server debugging account.</span></span> <span data-ttu-id="20b55-232">Per eseguire il debug degli oggetti di database di un'istanza di SQL Server remota, è quindi necessario eseguire Visual Studio utilizzando le credenziali dell'account di accesso di Windows.</span><span class="sxs-lookup"><span data-stu-id="20b55-232">Then, to debug the database objects of a remote SQL Server instance, you would run Visual Studio using that Windows login account s credentials.</span></span>

<span data-ttu-id="20b55-233">Un esempio dovrebbe aiutare a chiarire la situazione.</span><span class="sxs-lookup"><span data-stu-id="20b55-233">An example should help clarify things.</span></span> <span data-ttu-id="20b55-234">Si supponga che sia presente un account di Windows denominato `SQLDebug` all'interno del dominio Windows.</span><span class="sxs-lookup"><span data-stu-id="20b55-234">Imagine that there is a Windows account named `SQLDebug` within the Windows domain.</span></span> <span data-ttu-id="20b55-235">Questo account deve essere aggiunto all'istanza di SQL Server remota come account di accesso valido e come membro del ruolo `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="20b55-235">This account would need to be added to the remote SQL Server instance as a valid login and as a member of the `sysadmin` role.</span></span> <span data-ttu-id="20b55-236">Quindi, per eseguire il debug dell'istanza di SQL Server remota da Visual Studio, è necessario eseguire Visual Studio come utente `SQLDebug`.</span><span class="sxs-lookup"><span data-stu-id="20b55-236">Then, to debug the remote SQL Server instance from Visual Studio, we would need to run Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="20b55-237">Questa operazione può essere eseguita tramite la disconnessione dalla workstation, l'accesso come `SQLDebug`e l'avvio di Visual Studio, ma un approccio più semplice consiste nell'accedere alla workstation usando le proprie credenziali e quindi usare `runas.exe` per avviare Visual Studio come utente `SQLDebug`.</span><span class="sxs-lookup"><span data-stu-id="20b55-237">This could be done by logging out of our workstation, logging back in as `SQLDebug`, and then launching Visual Studio, but a simpler approach would be to login to our workstation using our own credentials and then use `runas.exe` to launch Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="20b55-238">`runas.exe` consente l'esecuzione di una particolare applicazione con le sembianze di un account utente diverso.</span><span class="sxs-lookup"><span data-stu-id="20b55-238">`runas.exe` allows a particular application to be executed under the guise of a different user account.</span></span> <span data-ttu-id="20b55-239">Per avviare Visual Studio come `SQLDebug`, è possibile immettere la seguente istruzione dalla riga di comando:</span><span class="sxs-lookup"><span data-stu-id="20b55-239">To launch Visual Studio as `SQLDebug`, you could enter the following statement at the command line:</span></span>

[!code-console[Main](debugging-stored-procedures-cs/samples/sample2.cmd)]

<span data-ttu-id="20b55-240">Per una spiegazione più dettagliata di questo processo, vedere la Guida di [William R. Vaughn](http://betav.com/BLOG/billva/) s *autostop a Visual Studio e SQL Server, settima edizione* , nonché [procedura: impostare le autorizzazioni SQL Server per il debug](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="20b55-240">For a more detailed explanation on this process, see [William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker s Guide to Visual Studio and SQL Server, Seventh Edition* as well as [How To: Set SQL Server Permissions for Debugging](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="20b55-241">Se nel computer di sviluppo è in esecuzione Windows XP Service Pack 2, sarà necessario configurare il firewall della connessione Internet per consentire il debug remoto.</span><span class="sxs-lookup"><span data-stu-id="20b55-241">If your development machine is running Windows XP Service Pack 2 you will need to configure the Internet Connection Firewall to allow remote debugging.</span></span> <span data-ttu-id="20b55-242">[L'articolo How to: Enable SQL Server 2005 Debugging](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) note che prevede due passaggi: (a) nel computer host di Visual Studio, è necessario aggiungere `Devenv.exe` all'elenco di eccezioni e aprire la porta TCP 135. e (b) nel computer remoto (SQL), è necessario aprire la porta TCP 135 e aggiungere `sqlservr.exe` all'elenco delle eccezioni.</span><span class="sxs-lookup"><span data-stu-id="20b55-242">[The How To: Enable SQL Server 2005 Debugging](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) article notes that this involves two steps: (a) On the Visual Studio host machine, you must add `Devenv.exe` to the Exceptions list and open the TCP 135 port; and (b) On the remote (SQL) machine, you must open the TCP 135 port and add `sqlservr.exe` to the Exceptions list.</span></span> <span data-ttu-id="20b55-243">Se i criteri di dominio richiedono che le comunicazioni di rete vengano eseguite tramite IPSec, è necessario aprire le porte UDP 4500 e UDP 500.</span><span class="sxs-lookup"><span data-stu-id="20b55-243">If your domain policy requires network communication to be done through IPSec, you must open the UDP 4500 and UDP 500 ports.</span></span>

## <a name="summary"></a><span data-ttu-id="20b55-244">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="20b55-244">Summary</span></span>

<span data-ttu-id="20b55-245">Oltre a fornire supporto per il debug per il codice dell'applicazione .NET, Visual Studio offre anche un'ampia gamma di opzioni di debug per SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="20b55-245">In addition to providing debugging support for .NET application code, Visual Studio also provides a variety of debugging options for SQL Server 2005.</span></span> <span data-ttu-id="20b55-246">In questa esercitazione sono state esaminate due di queste opzioni: debug diretto del database e debug delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="20b55-246">In this tutorial we looked at two of those options: Direct Database Debugging and application debugging.</span></span> <span data-ttu-id="20b55-247">Per eseguire direttamente il debug di un oggetto di database T-SQL, individuare l'oggetto tramite il Esplora server quindi fare clic con il pulsante destro del mouse su di esso e scegliere Esegui istruzione.</span><span class="sxs-lookup"><span data-stu-id="20b55-247">To directly debug a T-SQL database object, locate the object through the Server Explorer then right-click on it and choose Step Into.</span></span> <span data-ttu-id="20b55-248">Questa operazione avvia il debugger e si interrompe sulla prima istruzione nell'oggetto di database. in questo punto è possibile eseguire le istruzioni dell'oggetto e visualizzare e modificare i valori dei parametri.</span><span class="sxs-lookup"><span data-stu-id="20b55-248">This starts the debugger and halts on the first statement in the database object, at which point you can step through the object s statements and view and modify parameter values.</span></span> <span data-ttu-id="20b55-249">Nel passaggio 1 è stato usato questo approccio per eseguire un'istruzione nell'`Products_SelectByCategoryID` stored procedure.</span><span class="sxs-lookup"><span data-stu-id="20b55-249">In Step 1 we used this approach to step into the `Products_SelectByCategoryID` stored procedure.</span></span>

<span data-ttu-id="20b55-250">Il debug dell'applicazione consente di impostare i punti di interruzione direttamente all'interno degli oggetti di database.</span><span class="sxs-lookup"><span data-stu-id="20b55-250">Application debugging allows breakpoints to be set directly within the database objects.</span></span> <span data-ttu-id="20b55-251">Quando un oggetto di database con punti di interruzione viene richiamato da un'applicazione client, ad esempio un'applicazione Web ASP.NET, il programma si interrompe quando il debugger acquisisce il sopravvento.</span><span class="sxs-lookup"><span data-stu-id="20b55-251">When a database object with breakpoints is invoked from a client application (such as an ASP.NET web application), the program halts as the debugger takes over.</span></span> <span data-ttu-id="20b55-252">Il debug dell'applicazione è utile perché mostra in modo più chiaro quale azione dell'applicazione causa la chiamata di un determinato oggetto di database.</span><span class="sxs-lookup"><span data-stu-id="20b55-252">Application debugging is useful because it more clearly shows what application action causes a particular database object to be invoked.</span></span> <span data-ttu-id="20b55-253">Tuttavia, richiede un po' più di configurazione e configurazione rispetto al debug diretto del database.</span><span class="sxs-lookup"><span data-stu-id="20b55-253">However, it requires a bit more configuration and setup than Direct Database Debugging.</span></span>

<span data-ttu-id="20b55-254">È anche possibile eseguire il debug di oggetti di database tramite SQL Server progetti.</span><span class="sxs-lookup"><span data-stu-id="20b55-254">Database objects can also be debugged through SQL Server Projects.</span></span> <span data-ttu-id="20b55-255">Nell'esercitazione successiva verrà illustrato l'utilizzo di progetti SQL Server e di come utilizzarli per creare ed eseguire il debug di oggetti di database gestiti.</span><span class="sxs-lookup"><span data-stu-id="20b55-255">We will look at using SQL Server Projects and how to use them to create and debug managed database objects in the next tutorial.</span></span>

<span data-ttu-id="20b55-256">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="20b55-256">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="20b55-257">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="20b55-257">About the Author</span></span>

<span data-ttu-id="20b55-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="20b55-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="20b55-259">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="20b55-259">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="20b55-260">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="20b55-260">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="20b55-261">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="20b55-261">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="20b55-262">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="20b55-262">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="20b55-263">[Precedente](protecting-connection-strings-and-other-configuration-information-cs.md)
> [Successivo](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs.md)</span><span class="sxs-lookup"><span data-stu-id="20b55-263">[Previous](protecting-connection-strings-and-other-configuration-information-cs.md)
[Next](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs.md)</span></span>
