---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
title: Utilizzo delle colonne calcolate (VB) | Microsoft Docs
author: rick-anderson
description: Quando si crea una tabella di database, Microsoft SQL Server consente di definire una colonna calcolata il cui valore viene calcolato da un'espressione che, in genere referen...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 5811b8ff-ed56-40fc-9397-6b69ae09a8f6
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: ba01931dd4c728067975f2949d4ed81adcd97e2f
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/06/2019
ms.locfileid: "65108625"
---
# <a name="working-with-computed-columns-vb"></a><span data-ttu-id="3f5c9-103">Uso di colonne calcolate (VB)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-103">Working with Computed Columns (VB)</span></span>

<span data-ttu-id="3f5c9-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3f5c9-105">[Scaricare il codice](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) o [Scarica il PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-105">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) or [Download PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span></span>

> <span data-ttu-id="3f5c9-106">Quando si crea una tabella di database, Microsoft SQL Server consente di definire una colonna calcolata il cui valore viene calcolato da un'espressione che fa riferimento in genere altri valori nel record del database stesso.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="3f5c9-107">Tali valori sono di sola lettura a livello di database, che richiede considerazioni speciali quando si lavora con gli oggetti TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="3f5c9-108">In questa esercitazione sono come le sfide poste dalle colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="3f5c9-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="3f5c9-109">Introduction</span></span>

<span data-ttu-id="3f5c9-110">Microsoft SQL Server consente  *[le colonne calcolate](https://msdn.microsoft.com/library/ms191250.aspx)*, quali sono le colonne i cui valori vengono calcolati da un'espressione che in genere fa riferimento a valori di altre colonne nella stessa tabella.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="3f5c9-111">Ad esempio, un modello di dati di rilevamento di tempo potrebbe creare una tabella denominata `ServiceLog` con colonne incluse `ServicePerformed`, `EmployeeID`, `Rate`, e `Duration`, tra gli altri.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="3f5c9-112">Anche se l'importo dovuto per ogni servizio (in corso la frequenza moltiplicata per la durata) può essere calcolato tramite una pagina web o altre interfacce a livello di codice, potrebbe essere utile per includere una colonna nel `ServiceLog` tabella denominata `AmountDue` che ha segnalato questo informazioni.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="3f5c9-113">Questa colonna può essere creata come una normale colonna, ma dovranno essere aggiornati in qualsiasi momento il `Rate` o `Duration` valori della colonna modificati.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="3f5c9-114">Un approccio migliore sarebbe per rendere il `AmountDue` una colonna calcolata utilizzando l'espressione di colonna `Rate * Duration`.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="3f5c9-115">Questa operazione causerebbe SQL Server calcolare automaticamente il `AmountDue` valore della colonna ogni volta che vi viene fatto riferimento in una query.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="3f5c9-116">Poiché un valore di colonna calcolata s è determinato da un'espressione, tali colonne sono di sola lettura e pertanto non possono essere assegnati valori ad essi nel `INSERT` o `UPDATE` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="3f5c9-117">Tuttavia, quando le colonne calcolate sono parte della query principale per un oggetto TableAdapter che Usa istruzioni SQL ad hoc, sono incluse automaticamente nel generata automaticamente `INSERT` e `UPDATE` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="3f5c9-118">Di conseguenza, i TableAdapter `INSERT` e `UPDATE` query e `InsertCommand` e `UpdateCommand` proprietà devono essere aggiornate per rimuovere i riferimenti alle colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="3f5c9-119">Uno dei problemi di utilizzo di colonne con un TableAdapter che Usa istruzioni SQL ad-hoc calcolate è che i TableAdapter `INSERT` e `UPDATE` le query vengono rigenerate automaticamente ogni volta che viene completata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="3f5c9-120">Di conseguenza, le colonne calcolate rimosse manualmente dal `INSERT` e `UPDATE` query verrà visualizzato nuovamente se la procedura guidata viene rieseguita.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="3f5c9-121">Anche se gli oggetti TableAdapter che utilizzano le stored procedure desidero soggette a questa inconvenienti, hanno i propri comportamenti anomali vengono descritte nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="3f5c9-122">In questa esercitazione si aggiungerà una colonna calcolata per il `Suppliers` tabella nel database Northwind e quindi creare un oggetto TableAdapter corrispondente per usare questa tabella e la relativa colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="3f5c9-123">Si avrà il TableAdapter utilizzare stored procedure anziché le istruzioni SQL ad hoc in modo che i nostri personalizzazioni non vengono perse quando viene usata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren't lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="3f5c9-124">Introduzione a ti permettono di s.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="3f5c9-125">Passaggio 1: Aggiunta di una colonna calcolata per il`Suppliers`tabella</span><span class="sxs-lookup"><span data-stu-id="3f5c9-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="3f5c9-126">Il database Northwind non dispone le colonne calcolate in modo che è necessario aggiungere uno noi stessi.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="3f5c9-127">Per questa esercitazione lasciare s aggiungere una colonna calcolata per il `Suppliers` tabella denominata `FullContactName` che restituisce il nome di contatto s, titolo e l'azienda che lavorano per il formato seguente: `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="3f5c9-128">Questa calcolata colonna potrebbe essere utilizzata nel report quando si visualizzano informazioni sui fornitori.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="3f5c9-129">Iniziare aprendo il `Suppliers` definizione di tabella facendo clic su di `Suppliers` tabella in Esplora Server e scegliendo Apri definizione tabella dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="3f5c9-130">Le colonne della tabella e le relative proprietà, ad esempio tipo di dati, verrà visualizzata se consentono `NULL` s e così via.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="3f5c9-131">Per aggiungere una colonna calcolata, iniziare digitando il nome della colonna nella definizione della tabella.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="3f5c9-132">Immettere quindi la relativa espressione nella casella di testo (Formula) nella sezione specifica della colonna calcolata nella finestra proprietà di colonna (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="3f5c9-133">Assegnare un nome di colonna calcolata `FullContactName` e utilizzare l'espressione seguente:</span><span class="sxs-lookup"><span data-stu-id="3f5c9-133">Name the computed column `FullContactName` and use the following expression:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample1.sql)]

<span data-ttu-id="3f5c9-134">Si noti che le stringhe possono essere concatenate in SQL usando il `+` operatore.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="3f5c9-135">Il `CASE` istruzione può essere utilizzata come un'istruzione condizionale in un linguaggio di programmazione tradizionali.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="3f5c9-136">Nell'espressione sopra indicata la `CASE` istruzione può essere letto come: Se `ContactTitle` non è `NULL` quindi restituiti il `ContactTitle` valore concatenato con una virgola, in caso contrario generare nulla.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="3f5c9-137">Per altre informazioni sull'utilità delle `CASE` istruzione, vedere [potenza di SQL `CASE` istruzioni](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="3f5c9-138">Invece di usare una `CASE` istruzione qui, si sarebbe potuto in alternativa usare `ISNULL(ContactTitle, '')`.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="3f5c9-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) Restituisce *checkExpression* se è diverso da NULL, in caso contrario, restituisce *replacementValue*.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="3f5c9-140">Mentre uno `ISNULL` oppure `CASE` funzionerà in questo caso, esistono scenari più complessi in cui la flessibilità del `CASE` istruzione non possa essere trovata da `ISNULL`.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>

<span data-ttu-id="3f5c9-141">Dopo aver aggiunto la colonna calcolata la schermata dovrebbe essere simile all'immagine riportata nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>

<span data-ttu-id="3f5c9-142">[![Aggiungere una colonna calcolata denominata FullContactName alla tabella Suppliers](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="3f5c9-143">**Figura 1**: Aggiungere una colonna calcolata denominata `FullContactName` per il `Suppliers` tabella ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-vb/_static/image3.png))</span></span>

<span data-ttu-id="3f5c9-144">Dopo aver creato la colonna calcolata e immettere la relativa espressione, salvare le modifiche alla tabella facendo clic sull'icona Salva nella barra degli strumenti, premendo Ctrl + S oppure selezionando il menu File e scegliendo Salva `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="3f5c9-145">Salvataggio della tabella deve essere aggiornata Esplora Server, tra cui la colonna appena aggiunta nel `Suppliers` elenco colonne di tabella s.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="3f5c9-146">Inoltre, l'espressione immessa nella casella di testo (Formula) regolerà automaticamente a un'espressione equivalente che rimuove spazi vuoti non necessari, racchiuso tra parentesi quadre i nomi di colonna (`[]`) e include le parentesi per mostrare in modo più esplicito l'ordine delle operazioni:</span><span class="sxs-lookup"><span data-stu-id="3f5c9-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample2.sql)]

<span data-ttu-id="3f5c9-147">Per altre informazioni su colonne calcolate in Microsoft SQL Server, vedere la [documentazione tecnica](https://msdn.microsoft.com/library/ms191250.aspx).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="3f5c9-148">Vedere anche il [come: Specificare le colonne calcolate](https://msdn.microsoft.com/library/ms188300.aspx) per una procedura dettagliata di creazione di colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="3f5c9-149">Per impostazione predefinita, le colonne calcolate non sono archiviate fisicamente nella tabella ma vengono invece ricalcolate ogni volta che vi viene fatto riferimento in una query.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="3f5c9-150">Selezionando la casella di controllo viene reso persistente, si può però istruire SQL Server per archiviare fisicamente la colonna calcolata nella tabella.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="3f5c9-151">In questo modo consente a un indice da creare la colonna calcolata, che consente di migliorare le prestazioni delle query che utilizzano il valore della colonna calcolata nella loro `WHERE` clausole.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="3f5c9-152">Visualizzare [creazione di indici per colonne calcolate](https://msdn.microsoft.com/library/ms189292.aspx) per altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>

## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="3f5c9-153">Passaggio 2: La visualizzazione dei valori di colonna calcolata s</span><span class="sxs-lookup"><span data-stu-id="3f5c9-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="3f5c9-154">Prima di iniziare lavoro nel livello di accesso ai dati, ti permettono di s richiedere un minuto per visualizzare il `FullContactName` valori.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="3f5c9-155">Da Esplora Server, fare clic su di `Suppliers` nome tabella e scegliere Nuova Query dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="3f5c9-156">Verrà visualizzata una finestra di Query che consente di scegliere quali le tabelle da includere nella query.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="3f5c9-157">Aggiungere il `Suppliers` di tabella e fare clic su Chiudi.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="3f5c9-158">Successivamente, controllare la `CompanyName`, `ContactName`, `ContactTitle`, e `FullContactName` colonne dalla tabella Suppliers.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="3f5c9-159">Infine, selezionare l'icona punto esclamativo rosso nella barra degli strumenti per eseguire la query e visualizzare i risultati.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="3f5c9-160">Come illustrato nella figura 2, i risultati includono `FullContactName`, che elenca i `CompanyName`, `ContactName`, e `ContactTitle` colonne usando il formato `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="3f5c9-161">[![Il FullContactName Usa il formato ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="3f5c9-162">**Figura 2**: Il `FullContactName` Usa il formato `ContactName` (`ContactTitle`, `CompanyName`) ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-vb/_static/image6.png))</span></span>

## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="3f5c9-163">Passaggio 3: Aggiunta di`SuppliersTableAdapter`a livello di accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="3f5c9-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="3f5c9-164">Per usare le informazioni del fornitore dell'applicazione è necessario innanzitutto creare un oggetto TableAdapter e DataTable in nostro DAL.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="3f5c9-165">In teoria, ciò verrebbe eseguito usando la stessa procedura semplice esaminata nelle esercitazioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="3f5c9-166">Lavorare con le colonne calcolate, tuttavia, introduce alcuni rughe che meritano discussione.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="3f5c9-167">Se si usa un oggetto TableAdapter che Usa istruzioni SQL ad hoc, è sufficiente includere la colonna calcolata nella query TableAdapter s principale tramite la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="3f5c9-168">Questa operazione, tuttavia, verrà generato automaticamente `INSERT` e `UPDATE` istruzioni che includono la colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="3f5c9-169">Se si prova a eseguire uno di questi metodi, una `SqlException` con il messaggio della colonna *ColumnName* non può essere modificato perché è una colonna calcolata o verrà generato il risultato di un operatore UNION.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="3f5c9-170">Mentre il `INSERT` e `UPDATE` istruzione può essere modificata manualmente tramite i TableAdapter `InsertCommand` e `UpdateCommand` proprietà, queste personalizzazioni andranno perse ogni volta che la configurazione guidata TableAdapter viene rieseguita.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="3f5c9-171">A causa di inconvenienti degli oggetti TableAdapter che usano istruzioni SQL ad hoc, è consigliabile che usiamo le stored procedure quando si lavora con le colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="3f5c9-172">Se si Usa stored procedure esistenti, è sufficiente configurare il TableAdapter come descritto nel [utilizzando Stored procedure esistenti per DataSet tipizzata s TableAdapter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="3f5c9-173">Se si ha la configurazione guidata TableAdapter creare le stored procedure per l'utente, tuttavia, è importante inizialmente omettere le colonne calcolate dalla query principale.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="3f5c9-174">Se si include una colonna calcolata nella query principali, la configurazione guidata TableAdapter indicherà, dopo il completamento, che non è possibile creare le stored procedure corrispondente.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="3f5c9-175">In breve, è necessario configurare inizialmente il TableAdapter utilizzando una query principale privi di colonna calcolata e quindi aggiornare manualmente la stored procedure corrispondente e ai TableAdapter `SelectCommand` per includere la colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="3f5c9-176">Questo approccio è simile a quella usata nel [aggiornamento del TableAdapter per l'uso](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* esercitazione.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="3f5c9-177">Per questa esercitazione, lasciare s aggiungere un nuovo TableAdapter, che verrà automaticamente create le stored procedure per noi.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="3f5c9-178">Di conseguenza, è necessario omettere inizialmente il `FullContactName` colonna calcolata dalla query principale.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="3f5c9-179">Iniziare aprendo il `NorthwindWithSprocs` set di dati nel `~/App_Code/DAL` cartella.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="3f5c9-180">Fare doppio clic nella finestra di progettazione e, da menu di scelta rapida, scegliere di aggiungere un nuovo TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="3f5c9-181">Verrà avviata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="3f5c9-182">Specificare il database per eseguire query sui dati da (`NORTHWNDConnectionString` da `Web.config`) e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="3f5c9-183">Poiché le stored procedure per l'esecuzione di query o la modifica non è stata ancora creata la `Suppliers` di tabella, selezionare la creazione di nuove stored procedure opzione in modo che la procedura guidata verrà creati automaticamente e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>

<span data-ttu-id="3f5c9-184">[![Scegliere Crea nuove stored procedure. opzione](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="3f5c9-185">**Figura 3**: Scegliere Crea nuove stored procedure. opzione ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image9.png))</span></span>

<span data-ttu-id="3f5c9-186">Il passaggio successivo richiede per la query principale.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="3f5c9-187">Immettere la query seguente, che restituisce il `SupplierID`, `CompanyName`, `ContactName`, e `ContactTitle` colonne per ogni fornitore.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="3f5c9-188">Si noti che questa query esclude intenzionalmente la colonna calcolata (`FullContactName`); verrà aggiornata la stored procedure corrispondente per includere tale colonna nel passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample3.sql)]

<span data-ttu-id="3f5c9-189">Dopo aver immesso la query principale e fare clic su Avanti, la procedura guidata consente di assegnare un nome di quattro stored procedure che verrà generato.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="3f5c9-190">Assegnare un nome queste stored procedure `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, e `Suppliers_Delete`, come illustrato nella figura 4.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>

<span data-ttu-id="3f5c9-191">[![Personalizzare i nomi delle Stored procedure generata automaticamente](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="3f5c9-192">**Figura 4**: Personalizzare i nomi delle Stored procedure Auto-Generated ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-vb/_static/image12.png))</span></span>

<span data-ttu-id="3f5c9-193">Il passaggio successivo della procedura guidata consente di denominare i metodi di s TableAdapter e specificare gli schemi utilizzati per accedere e aggiornare i dati.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="3f5c9-194">Lasciare tutte le tre caselle di controllo selezionate, ma non rinominare i `GetData` metodo `GetSuppliers`.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="3f5c9-195">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-195">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="3f5c9-196">[![Rinominare il metodo GetData per GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="3f5c9-197">**Figura 5**: Rinominare il `GetData` al metodo `GetSuppliers` ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-vb/_static/image15.png))</span></span>

<span data-ttu-id="3f5c9-198">Facendo clic su Fine, la procedura guidata verrà creare quattro stored procedure e aggiungere il TableAdapter e DataTable corrispondente al set di dati tipizzato.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="3f5c9-199">Passaggio 4: Tra cui la colonna calcolata nella Query principali s TableAdapter</span><span class="sxs-lookup"><span data-stu-id="3f5c9-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="3f5c9-200">È ora necessario Aggiorna oggetto TableAdapter e DataTable creato nel passaggio 3 per includere il `FullContactName` colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="3f5c9-201">Ciò comporta due passaggi:</span><span class="sxs-lookup"><span data-stu-id="3f5c9-201">This involves two steps:</span></span>

1. <span data-ttu-id="3f5c9-202">L'aggiornamento di `Suppliers_Select` stored procedure per restituire il `FullContactName` colonna calcolata, e</span><span class="sxs-lookup"><span data-stu-id="3f5c9-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="3f5c9-203">L'aggiornamento di DataTable per includere un corrispondente `FullContactName` colonna.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="3f5c9-204">Per iniziare, passare a Esplora Server e il drill-down nella cartella di Stored procedure.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="3f5c9-205">Aprire il `Suppliers_Select` stored procedure e aggiornamento il `SELECT` query per includere il `FullContactName` colonna calcolata:</span><span class="sxs-lookup"><span data-stu-id="3f5c9-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample4.sql)]

<span data-ttu-id="3f5c9-206">Salvare le modifiche apportate alla stored procedure facendo clic sull'icona Salva nella barra degli strumenti, premendo Ctrl + S o scegliendo Salva `Suppliers_Select` opzione dal menu File.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="3f5c9-207">Successivamente, tornare alla finestra di progettazione set di dati, fare clic su di `SuppliersTableAdapter`e scegliere Configura dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="3f5c9-208">Si noti che il `Suppliers_Select` colonna include ora il `FullContactName` nella propria raccolta di colonne di dati della colonna.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>

<span data-ttu-id="3f5c9-209">[![Eseguire la configurazione guidata s TableAdapter per aggiornare le colonne s DataTable](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="3f5c9-210">**Figura 6**: Eseguire i TableAdapter configurazione guidata per aggiornare gli oggetti DataTable colonne ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-vb/_static/image18.png))</span></span>

<span data-ttu-id="3f5c9-211">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="3f5c9-212">Questo aggiungerà automaticamente una colonna corrispondente per il `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="3f5c9-213">La configurazione guidata TableAdapter è abbastanza intelligente da rilevare che il `FullContactName` colonna è una colonna calcolata e pertanto di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="3f5c9-214">Di conseguenza, imposta la colonna 1!s `ReadOnly` proprietà `true`.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="3f5c9-215">A questo scopo, selezionare la colonna dal `SuppliersDataTable` e quindi passare alla finestra delle proprietà (vedere la figura 7).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="3f5c9-216">Si noti che il `FullContactName` s' `DataType` e `MaxLength` proprietà vengono inoltre impostate di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>

<span data-ttu-id="3f5c9-217">[![La colonna FullContactName è contrassegnata come sola lettura](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span></span>

<span data-ttu-id="3f5c9-218">**Figura 7**: Il `FullContactName` colonna è contrassegnata come di sola lettura ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-vb/_static/image21.png))</span></span>

## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="3f5c9-219">Passaggio 5: Aggiunta di un`GetSupplierBySupplierID`all'oggetto TableAdapter (metodo)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="3f5c9-220">Per questa esercitazione si creerà una pagina ASP.NET che consente di visualizzare i fornitori in una griglia aggiornabile.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="3f5c9-221">Nelle precedenti esercitazioni sono state aggiornate un singolo record dal livello della logica di Business recuperando nuovamente i record specifico DAL come DataTable fortemente tipizzato, l'aggiornamento delle relative proprietà e quindi l'invio di DataTable aggiornate al livello per propagare le modifiche apportate a il database.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="3f5c9-222">Per eseguire il primo passaggio - recuperare il record viene aggiornato DAL: è necessario innanzitutto aggiungere un `GetSupplierBySupplierID(supplierID)` DAL metodo.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="3f5c9-223">Fare clic su di `SuppliersTableAdapter` nella struttura del set di dati e scegliere l'opzione di Query aggiunta dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="3f5c9-224">Come è stato fatto nel passaggio 3, consentire alla procedura guidata genera una nuova stored procedure per noi selezionando l'opzione di creazione nuova stored procedure (vedere la figura 3 per visualizzare uno screenshot di questo passaggio della procedura guidata).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="3f5c9-225">Poiché questo metodo restituisce un record con più colonne, indicano che si desidera utilizzare una query SQL che è un'istruzione SELECT che restituisce le righe e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>

<span data-ttu-id="3f5c9-226">[![Scegliere il SELECT che restituisce righe opzione](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span></span>

<span data-ttu-id="3f5c9-227">**Figura 8**: Scegliere il SELECT che restituisce righe opzione ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image24.png))</span></span>

<span data-ttu-id="3f5c9-228">Il passaggio successivo richiede per la query da usare per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="3f5c9-229">Immettere le informazioni seguenti, che restituisce gli stessi campi di dati come query principale, ma per un particolare fornitore.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample5.sql)]

<span data-ttu-id="3f5c9-230">Nella schermata successiva viene chiesto di specificare un nome di stored procedure che sarà generato automaticamente.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="3f5c9-231">Nome di questa stored procedure `Suppliers_SelectBySupplierID` e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>

<span data-ttu-id="3f5c9-232">[![Nome Suppliers_SelectBySupplierID la Stored Procedure](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span></span>

<span data-ttu-id="3f5c9-233">**Figura 9**: Nome della Stored Procedure `Suppliers_SelectBySupplierID` ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image27.png))</span></span>

<span data-ttu-id="3f5c9-234">Infine, le istruzioni della procedura guidata us per i dati di accedere ai modelli e i nomi dei metodi da usare per l'oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="3f5c9-235">Lasciare entrambe le caselle di controllo selezionate, ma non rinominare i `FillBy` e `GetDataBy` metodi `FillBySupplierID` e `GetSupplierBySupplierID`, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>

<span data-ttu-id="3f5c9-236">[![Nome FillBySupplierID i metodi TableAdapter e GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span></span>

<span data-ttu-id="3f5c9-237">**Figura 10**: Denominare i metodi TableAdapter `FillBySupplierID` e `GetSupplierBySupplierID` ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image30.png))</span></span>

<span data-ttu-id="3f5c9-238">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="3f5c9-239">Passaggio 6: La creazione del livello per la logica di Business</span><span class="sxs-lookup"><span data-stu-id="3f5c9-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="3f5c9-240">Prima di creare una pagina ASP.NET che usa la colonna calcolata creata nel passaggio 1, è innanzitutto necessario aggiungere i metodi corrispondenti nel livello BLL.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="3f5c9-241">La pagina ASP.NET, che verrà creato nel passaggio 7, consentirà agli utenti di visualizzare e modificare i suoi fornitori.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="3f5c9-242">Pertanto, è necessario il livello BLL fornire, come minimo, un metodo per ottenere tutti i fornitori e un altro per aggiornare un particolare fornitore.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="3f5c9-243">Creare un nuovo file di classe denominato `SuppliersBLLWithSprocs` nella `~/App_Code/BLL` cartella e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="3f5c9-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>

[!code-vb[Main](working-with-computed-columns-vb/samples/sample6.vb)]

<span data-ttu-id="3f5c9-244">Come le altre classi BLL `SuppliersBLLWithSprocs` ha un `Protected` `Adapter` proprietà che restituisce un'istanza del `SuppliersTableAdapter` classe insieme a due `Public` metodi: `GetSuppliers` e `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `Protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `Public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="3f5c9-245">Il `GetSuppliers` metodo viene chiamato e restituisce il `SuppliersDataTable` restituito dalla corrispondente `GetSupplier` metodo nel livello di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="3f5c9-246">Il `UpdateSupplier` recupera informazioni relative in corso l'aggiornamento tramite una chiamata a s DAL fornitore specifico `GetSupplierBySupplierID(supplierID)` (metodo).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="3f5c9-247">Quindi aggiorna il `CategoryName`, `ContactName`, e `ContactTitle` proprietà ed esegue il commit di queste modifiche al database chiamando il livello di accesso ai dati di s `Update` , passando nella versione modificata `SuppliersRow` oggetto.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="3f5c9-248">Ad eccezione di `SupplierID` e `CompanyName`, tutte le colonne nella tabella Suppliers consentono `NULL` valori.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="3f5c9-249">Pertanto, se passato `contactName` o `contactTitle` i parametri sono `Nothing` , dobbiamo impostare corrispondente `ContactName` e `ContactTitle` le proprietà per un `NULL` database valore usando il `SetContactNameNull` e`SetContactTitleNull`metodi di, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `Nothing` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>

## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="3f5c9-250">Passaggio 7: Utilizzo con la colonna calcolata dal livello di presentazione</span><span class="sxs-lookup"><span data-stu-id="3f5c9-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="3f5c9-251">Con la colonna calcolata aggiunta al `Suppliers` tabella e DAL e BLL aggiornato di conseguenza, si è pronti a compilare una pagina ASP.NET che funziona con il `FullContactName` colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="3f5c9-252">Iniziare aprendo il `ComputedColumns.aspx` nella pagina di `AdvancedDAL` cartelle e trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="3f5c9-253">Impostare la s GridView `ID` proprietà `Suppliers` e, dal suo smart tag, associarlo a un nuovo oggetto ObjectDataSource denominato `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="3f5c9-254">Configurare ObjectDataSource per usare il `SuppliersBLLWithSprocs` classe è stato aggiunto il nuovo nel passaggio 6 e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>

<span data-ttu-id="3f5c9-255">[![Configurare ObjectDataSource per usare la classe SuppliersBLLWithSprocs](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span></span>

<span data-ttu-id="3f5c9-256">**Figura 11**: Configurare ObjectDataSource per usare la `SuppliersBLLWithSprocs` classe ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-vb/_static/image33.png))</span></span>

<span data-ttu-id="3f5c9-257">Sono disponibili solo due metodi definiti nel `SuppliersBLLWithSprocs` classe: `GetSuppliers` e `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="3f5c9-258">Assicurarsi che questi due metodi sono specificati in SELECT e aggiornare le schede, rispettivamente e fare clic su Fine per completare la configurazione di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="3f5c9-259">Dopo avere completato la configurazione guidata origine dati, Visual Studio aggiungerà un BoundField per ognuno dei campi di dati restituiti.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="3f5c9-260">Rimuovere il `SupplierID` BoundField e modificare il `HeaderText` delle proprietà delle `CompanyName`, `ContactName`, `ContactTitle`, e `FullContactName` BoundField per società, nome contatto, titolo e il nome di contatto completo, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="3f5c9-261">Nello smart tag, la casella Abilita modifica per attivare la funzionalità di modifica predefinita s di GridView.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="3f5c9-262">Oltre ad aggiungere i BoundField di GridView, il completamento della creazione guidata origine dati provoca anche Visual Studio consente di impostare la s ObjectDataSource `OldValuesParameterFormatString` proprietà originale\_{0}.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="3f5c9-263">Annullare tale impostazione il valore predefinito, {0} .</span><span class="sxs-lookup"><span data-stu-id="3f5c9-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="3f5c9-264">Dopo aver apportato queste modifiche per il controllo GridView e ObjectDataSource, il relativo markup dichiarativo dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="3f5c9-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](working-with-computed-columns-vb/samples/sample7.aspx)]

<span data-ttu-id="3f5c9-265">Successivamente, visitare questa pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="3f5c9-266">Come illustrato nella figura 12, ogni fornitore è elencato in una griglia contenente le `FullContactName` colonna, il cui valore è semplicemente la concatenazione delle altre tre colonne formattato come `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="3f5c9-267">[![Ogni fornitore è elencata nella griglia](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span></span>

<span data-ttu-id="3f5c9-268">**Figura 12**: Ogni fornitore è elencata nella griglia ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-vb/_static/image36.png))</span></span>

<span data-ttu-id="3f5c9-269">Facendo clic sul pulsante Modifica per un particolare fornitore determina un postback e dispone di tale riga viene eseguito il rendering nel relativo tipo di modifica dell'interfaccia (vedere la figura 13).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="3f5c9-270">Eseguire il rendering le prime tre colonne in base all'impostazione predefinita dell'interfaccia di modifica - controllo di una casella di testo la cui `Text` proprietà è impostata sul valore del campo dati.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="3f5c9-271">Il `FullContactName` colonna, tuttavia, rimane come testo.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="3f5c9-272">Quando sono stati aggiunti i BoundField di GridView dopo aver completato la configurazione guidata origine dati, il `FullContactName` s BoundField `ReadOnly` è stata impostata su `True` perché corrispondente `FullContactName` colonna il `SuppliersDataTable` ha relativi `ReadOnly` impostata su `True`.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `True` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `True`.</span></span> <span data-ttu-id="3f5c9-273">Come indicato nel passaggio 4, il `FullContactName` s `ReadOnly` è stata impostata su `True` perché TableAdapter rilevato che la colonna è una colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `True` because the TableAdapter detected that the column was a computed column.</span></span>

<span data-ttu-id="3f5c9-274">[![La colonna FullContactName non è modificabile](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span></span>

<span data-ttu-id="3f5c9-275">**Figura 13**: Il `FullContactName` colonna non è modificabile ([fare clic per visualizzare l'immagine con dimensioni normali](working-with-computed-columns-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="3f5c9-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-vb/_static/image39.png))</span></span>

<span data-ttu-id="3f5c9-276">Proseguire e aggiornare il valore di uno o più colonne modificabili e fare clic su Aggiorna.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="3f5c9-277">Si noti come il `FullContactName` s valore viene automaticamente aggiornato per riflettere la modifica.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="3f5c9-278">Il controllo GridView Usa attualmente BoundField per i campi modificabili, determinando il valore predefinito dell'interfaccia di modifica.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="3f5c9-279">Poiché il `CompanyName` campo è obbligatorio, deve essere convertito in un TemplateField che include un RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="3f5c9-280">Lasciare come esercizio per il lettore di interesse.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="3f5c9-281">Consultare il [aggiunta di controlli di convalida per la modifica e inserimento di interfacce](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) esercitazione per istruzioni dettagliate sulla conversione di un BoundField in un TemplateField e aggiunta di controlli di convalida.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>

## <a name="summary"></a><span data-ttu-id="3f5c9-282">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="3f5c9-282">Summary</span></span>

<span data-ttu-id="3f5c9-283">Quando si definisce lo schema per una tabella, Microsoft SQL Server consente l'inclusione di colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="3f5c9-284">Queste sono colonne i cui valori vengono calcolati da un'espressione che in genere fa riferimento a valori di altre colonne nello stesso record.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="3f5c9-285">Poiché i valori per le colonne calcolate sono basate su un'espressione, sono di sola lettura e non può essere assegnati un valore in un `INSERT` o `UPDATE` istruzione.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="3f5c9-286">Ciò introduce sfide quando si usa una colonna calcolata nella query principali di un oggetto TableAdapter che tenta di generare automaticamente corrispondente `INSERT`, `UPDATE`, e `DELETE` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="3f5c9-287">In questa esercitazione viene illustrato le tecniche per eludere le sfide poste dalle colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="3f5c9-288">In particolare, abbiamo utilizzato le stored procedure nel nostro TableAdapter per superare inconvenienti inerenti alla classe TableAdapter che usano istruzioni SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="3f5c9-289">Con la configurazione guidata TableAdapter di creare nuove stored procedure, è importante che abbiamo la query principale inizialmente omettere le colonne calcolate perché la loro presenza impedisce la generazione dei dati stored procedure di modifica.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="3f5c9-290">Dopo aver configurato inizialmente TableAdapter, relativo `SelectCommand` stored procedure può essere retooled per includere le colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="3f5c9-291">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="3f5c9-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="3f5c9-292">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="3f5c9-292">About the Author</span></span>

<span data-ttu-id="3f5c9-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3f5c9-294">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3f5c9-295">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="3f5c9-296">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="3f5c9-297">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="3f5c9-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="3f5c9-298">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="3f5c9-298">Special Thanks To</span></span>

<span data-ttu-id="3f5c9-299">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3f5c9-300">I revisori per questa esercitazione sono state Hilton Geisenow e Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="3f5c9-300">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="3f5c9-301">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="3f5c9-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3f5c9-302">In questo caso, Inviami una riga in corrispondenza [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="3f5c9-303">[Precedente](adding-additional-datatable-columns-vb.md)
> [Successivo](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span><span class="sxs-lookup"><span data-stu-id="3f5c9-303">[Previous](adding-additional-datatable-columns-vb.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span></span>
