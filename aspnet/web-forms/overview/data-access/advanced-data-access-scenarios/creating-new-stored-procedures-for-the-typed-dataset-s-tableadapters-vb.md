---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
title: Creazione di nuove Stored procedure per i TableAdapter del set di dati tipizzato (VB) | Microsoft Docs
author: rick-anderson
description: Nelle esercitazioni precedenti abbiamo creato istruzioni SQL nel codice e passare le istruzioni per il database deve essere eseguito. Un approccio alternativo consiste nell'usare s...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: a5a4a9ba-d18d-489a-a6b0-a3c26d6b0274
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
msc.type: authoredcontent
ms.openlocfilehash: 1d8387f782ace50f16d44ba8df4df8014d563674
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/17/2019
ms.locfileid: "59396460"
---
# <a name="creating-new-stored-procedures-for-the-typed-datasets-tableadapters-vb"></a><span data-ttu-id="1ca03-104">Creazione di nuove stored procedure per i TableAdapter del set di dati tipizzato (VB)</span><span class="sxs-lookup"><span data-stu-id="1ca03-104">Creating New Stored Procedures for the Typed DataSet's TableAdapters (VB)</span></span>

<span data-ttu-id="1ca03-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1ca03-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1ca03-106">[Scaricare il codice](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_67_VB.zip) o [Scarica il PDF](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial67vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1ca03-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_67_VB.zip) or [Download PDF](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial67vb1.pdf)</span></span>

> <span data-ttu-id="1ca03-107">Nelle esercitazioni precedenti abbiamo creato istruzioni SQL nel codice e passare le istruzioni per il database deve essere eseguito.</span><span class="sxs-lookup"><span data-stu-id="1ca03-107">In earlier tutorials we have created SQL statements in our code and passed the statements to the database to be executed.</span></span> <span data-ttu-id="1ca03-108">Un approccio alternativo consiste nell'utilizzare le stored procedure, in cui le istruzioni SQL sono predefinite a livello di database.</span><span class="sxs-lookup"><span data-stu-id="1ca03-108">An alternative approach is to use stored procedures, where the SQL statements are pre-defined at the database.</span></span> <span data-ttu-id="1ca03-109">In questa esercitazione è come avere la configurazione guidata TableAdapter generate nuove stored procedure per noi.</span><span class="sxs-lookup"><span data-stu-id="1ca03-109">In this tutorial we learn how to have the TableAdapter Wizard generate new stored procedures for us.</span></span>


## <a name="introduction"></a><span data-ttu-id="1ca03-110">Introduzione</span><span class="sxs-lookup"><span data-stu-id="1ca03-110">Introduction</span></span>

<span data-ttu-id="1ca03-111">Data Access Layer (DAL) per queste esercitazioni Usa i set di dati tipizzato.</span><span class="sxs-lookup"><span data-stu-id="1ca03-111">The Data Access Layer (DAL) for these tutorials uses Typed DataSets.</span></span> <span data-ttu-id="1ca03-112">Come descritto nel [creazione di un livello di accesso ai dati](../introduction/creating-a-data-access-layer-vb.md) esercitazione, i set di dati tipizzato costituiti da oggetti DataTable fortemente tipizzato e gli oggetti TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="1ca03-112">As discussed in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial, Typed DataSets consist of strongly-typed DataTables and TableAdapters.</span></span> <span data-ttu-id="1ca03-113">Oggetti DataTable rappresentano le entità logiche nel sistema durante l'interfaccia di classe TableAdapter con il database sottostante per eseguire le operazioni di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="1ca03-113">The DataTables represent the logical entities in the system while the TableAdapters interface with the underlying database to perform the data access work.</span></span> <span data-ttu-id="1ca03-114">Ciò include la compilazione di oggetti DataTable con i dati, l'esecuzione di query che restituiscono dati scalari, inserimento, aggiornamento e l'eliminazione di record dal database.</span><span class="sxs-lookup"><span data-stu-id="1ca03-114">This includes populating the DataTables with data, executing queries that return scalar data, and inserting, updating, and deleting records from the database.</span></span>

<span data-ttu-id="1ca03-115">I comandi SQL eseguiti per gli oggetti TableAdapter possono essere entrambe le istruzioni SQL ad hoc, ad esempio `SELECT columnList FROM TableName`, o stored procedure.</span><span class="sxs-lookup"><span data-stu-id="1ca03-115">The SQL commands executed by the TableAdapters can be either ad-hoc SQL statements, such as `SELECT columnList FROM TableName`, or stored procedures.</span></span> <span data-ttu-id="1ca03-116">Gli oggetti TableAdapter nella nostra architettura utilizzare istruzioni SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="1ca03-116">The TableAdapters in our architecture use ad-hoc SQL statements.</span></span> <span data-ttu-id="1ca03-117">Molti sviluppatori e amministratori di database, tuttavia, preferiscono la stored procedure le istruzioni SQL ad hoc per motivi di sicurezza, gestibilità e aggiornabilità.</span><span class="sxs-lookup"><span data-stu-id="1ca03-117">Many developers and database administrators, however, prefer stored procedures over ad-hoc SQL statements for security, maintainability, and updatability reasons.</span></span> <span data-ttu-id="1ca03-118">Altri preferiscono ardently istruzioni SQL ad hoc per loro flessibilità.</span><span class="sxs-lookup"><span data-stu-id="1ca03-118">Others ardently prefer ad-hoc SQL statements for their flexibility.</span></span> <span data-ttu-id="1ca03-119">Nel mio lavoro preferire le stored procedure su istruzioni SQL ad hoc, ma ha scelto di usare le istruzioni SQL ad hoc per semplificare le esercitazioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="1ca03-119">In my own work I favor stored procedures over ad-hoc SQL statements, but chose to use ad-hoc SQL statements to simplify the earlier tutorials.</span></span>

<span data-ttu-id="1ca03-120">Quando la definizione di un oggetto TableAdapter o aggiunta di nuovi metodi, la configurazione guidata TableAdapter s rende altrettanto facile creare nuove stored procedure o utilizzare le stored procedure esistente come avviene per l'uso di istruzioni SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="1ca03-120">When defining a TableAdapter or adding new methods, the TableAdapter s wizard makes it just as easy to create new stored procedures or use existing stored procedures as it does to use ad-hoc SQL statements.</span></span> <span data-ttu-id="1ca03-121">In questa esercitazione verrà esaminato come ottenere la configurazione guidata TableAdapter s generare automaticamente stored procedure.</span><span class="sxs-lookup"><span data-stu-id="1ca03-121">In this tutorial we'll examine how to have the TableAdapter s wizard auto-generate stored procedures.</span></span> <span data-ttu-id="1ca03-122">Nella prossima esercitazione si esaminerà come configurare i metodi di s TableAdapter per utilizzare le stored procedure esistente o creato manualmente.</span><span class="sxs-lookup"><span data-stu-id="1ca03-122">In the next tutorial we will look at how to configure the TableAdapter s methods to use existing or manually-created stored procedures.</span></span>

> [!NOTE]
> <span data-ttu-id="1ca03-123">Vedere il post di blog di Rob Howard [Don usare Stored procedure ancora t?](http://grokable.com/2003/11/dont-use-stored-procedures-yet-must-be-suffering-from-nihs-not-invented-here-syndrome/) e [Frans Bouma](https://weblogs.asp.net/fbouma/) s post di blog [Stored procedure sono danneggiati, M Kay?](https://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx) per un vivace dibattito su vantaggi e gli svantaggi di stored procedure e SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="1ca03-123">See Rob Howard's blog entry [Don t Use Stored Procedures Yet?](http://grokable.com/2003/11/dont-use-stored-procedures-yet-must-be-suffering-from-nihs-not-invented-here-syndrome/) and [Frans Bouma](https://weblogs.asp.net/fbouma/) s blog entry [Stored Procedures are Bad, M Kay?](https://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx) for a lively debate on the pros and cons of stored procedures and ad-hoc SQL.</span></span>


## <a name="stored-procedure-basics"></a><span data-ttu-id="1ca03-124">Nozioni di base di stored Procedure</span><span class="sxs-lookup"><span data-stu-id="1ca03-124">Stored Procedure Basics</span></span>

<span data-ttu-id="1ca03-125">Le funzioni sono un costrutto comune a tutti i linguaggi di programmazione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-125">Functions are a construct common to all programming languages.</span></span> <span data-ttu-id="1ca03-126">Una funzione è una raccolta di istruzioni che vengono eseguiti quando viene chiamata la funzione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-126">A function is a collection of statements that are executed when the function is called.</span></span> <span data-ttu-id="1ca03-127">Le funzioni possono accettare parametri di input e, facoltativamente, possono restituire un valore.</span><span class="sxs-lookup"><span data-stu-id="1ca03-127">Functions can accept input parameters and may optionally return a value.</span></span> <span data-ttu-id="1ca03-128">*[Le stored procedure](http://en.wikipedia.org/wiki/Stored_procedure)*  sono costrutti di database che presentano molte similitudini con le funzioni nei linguaggi di programmazione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-128">*[Stored procedures](http://en.wikipedia.org/wiki/Stored_procedure)* are database constructs that share many similarities with functions in programming languages.</span></span> <span data-ttu-id="1ca03-129">Una stored procedure è costituita da un set di istruzioni T-SQL che vengono eseguite quando viene chiamata la stored procedure.</span><span class="sxs-lookup"><span data-stu-id="1ca03-129">A stored procedure is made up of a set of T-SQL statements that are executed when the stored procedure is called.</span></span> <span data-ttu-id="1ca03-130">Una stored procedure può accettare zero a molti parametri di input e può restituire valori scalari, i parametri di output o, in genere, set di risultati da `SELECT` le query.</span><span class="sxs-lookup"><span data-stu-id="1ca03-130">A stored procedure may accept zero to many input parameters and can return scalar values, output parameters, or, most commonly, result sets from `SELECT` queries.</span></span>

> [!NOTE]
> <span data-ttu-id="1ca03-131">Le stored procedure sono spesso detta sprocs o Service Pack.</span><span class="sxs-lookup"><span data-stu-id="1ca03-131">Stored procedures are oftentimes referred to as sprocs or SPs .</span></span>


<span data-ttu-id="1ca03-132">Vengono create stored procedure utilizzando il [ `CREATE PROCEDURE` ](https://msdn.microsoft.com/library/aa258259(SQL.80).aspx) istruzione T-SQL.</span><span class="sxs-lookup"><span data-stu-id="1ca03-132">Stored procedures are created using the [`CREATE PROCEDURE`](https://msdn.microsoft.com/library/aa258259(SQL.80).aspx) T-SQL statement.</span></span> <span data-ttu-id="1ca03-133">Ad esempio, lo script T-SQL seguente crea una stored procedure denominata `GetProductsByCategoryID` che accetta un singolo parametro denominato `@CategoryID` e restituisce il `ProductID`, `ProductName`, `UnitPrice`, e `Discontinued` campi di tali colonne di `Products` tabella che dispone di un oggetto corrispondente `CategoryID` valore:</span><span class="sxs-lookup"><span data-stu-id="1ca03-133">For example, the following T-SQL script creates a stored procedure named `GetProductsByCategoryID` that takes in a single parameter named `@CategoryID` and returns the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` fields of those columns in the `Products` table that have a matching `CategoryID` value:</span></span>


[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample1.sql)]

<span data-ttu-id="1ca03-134">Dopo aver creata questa stored procedure, può essere chiamato usando la sintassi seguente:</span><span class="sxs-lookup"><span data-stu-id="1ca03-134">Once this stored procedure has been created, it can be called using the following syntax:</span></span>


[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample2.sql)]

> [!NOTE]
> <span data-ttu-id="1ca03-135">Nella prossima esercitazione verrà esaminato la creazione di stored procedure tramite l'IDE di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1ca03-135">In the next tutorial we will examine creating stored procedures through the Visual Studio IDE.</span></span> <span data-ttu-id="1ca03-136">Per questa esercitazione, tuttavia, si userà per consentire la configurazione guidata TableAdapter genera automaticamente le stored procedure per noi.</span><span class="sxs-lookup"><span data-stu-id="1ca03-136">For this tutorial, however, we are going to let the TableAdapter wizard automatically generate the stored procedures for us.</span></span>


<span data-ttu-id="1ca03-137">Oltre a restituire semplicemente i dati, le stored procedure vengono spesso utilizzate per eseguire più comandi di database all'interno dell'ambito di una singola transazione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-137">In addition to simply returning data, stored procedures are often used to perform multiple database commands within the scope of a single transaction.</span></span> <span data-ttu-id="1ca03-138">Una stored procedure denominata `DeleteCategory`, ad esempio, potrebbero essere necessari un `@CategoryID` parametro ed eseguire due `DELETE` istruzioni: prima di tutto, uno per eliminare i prodotti correlati e un altro eliminando la categoria specificata.</span><span class="sxs-lookup"><span data-stu-id="1ca03-138">A stored procedure named `DeleteCategory`, for example, might take in a `@CategoryID` parameter and perform two `DELETE` statements: first, one to delete the related products and a second one deleting the specified category.</span></span> <span data-ttu-id="1ca03-139">Più istruzioni all'interno di una stored procedure vengono *non* automaticamente sottoposta a wrapping in una transazione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-139">Multiple statements within a stored procedure are *not* automatically wrapped within a transaction.</span></span> <span data-ttu-id="1ca03-140">Altri comandi T-SQL dovranno essere emesso per assicurarsi che la stored procedure s che più comandi vengono trattati come operazione atomica.</span><span class="sxs-lookup"><span data-stu-id="1ca03-140">Additional T-SQL commands need to be issued to ensure the stored procedure s multiple commands are treated as an atomic operation.</span></span> <span data-ttu-id="1ca03-141">Si vedrà come eseguire il wrapping di comandi una stored procedure all'interno dell'ambito di una transazione nell'esercitazione successiva.</span><span class="sxs-lookup"><span data-stu-id="1ca03-141">We'll see how to wrap a stored procedure s commands within the scope of a transaction in the subsequent tutorial.</span></span>

<span data-ttu-id="1ca03-142">Quando si utilizzano le stored procedure all'interno di un'architettura, il livello di accesso ai dati s richiama una particolare stored procedure, anziché eseguire un'istruzione SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="1ca03-142">When using stored procedures within an architecture, the Data Access Layer s methods invoke a particular stored procedure rather than issuing an ad-hoc SQL statement.</span></span> <span data-ttu-id="1ca03-143">Consente di centralizzare la posizione delle istruzioni SQL eseguite (on database) anziché averlo definito all'interno dell'architettura s dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-143">This centralizes the location of the SQL statements executed (on the database) rather than having it defined within the application s architecture.</span></span> <span data-ttu-id="1ca03-144">Questa centralizzazione senza dubbio rende più semplice individuare, analizzare e ottimizzare le query e offre un quadro molto più chiaro per quanto riguarda come e dove il database è in uso.</span><span class="sxs-lookup"><span data-stu-id="1ca03-144">This centralization arguably makes it easier to find, analyze, and tune the queries and provides a much clearer picture as to where and how the database is being used.</span></span>

<span data-ttu-id="1ca03-145">Per altre informazioni su nozioni fondamentali sulla stored procedure, consultare le risorse nella sezione ulteriori letture alla fine di questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-145">For more information on stored procedure fundamentals, consult the resources in the Further Reading section at the end of this tutorial.</span></span>

## <a name="step-1-creating-the-advanced-data-access-layer-scenarios-web-pages"></a><span data-ttu-id="1ca03-146">Passaggio 1: Creazione delle pagine Web scenari di livello accesso dati avanzati</span><span class="sxs-lookup"><span data-stu-id="1ca03-146">Step 1: Creating the Advanced Data Access Layer Scenarios Web Pages</span></span>

<span data-ttu-id="1ca03-147">Prima di iniziare la discussione sulla creazione di un utilizzo di stored procedure DAL, consentire s prima di tutto si consiglia di creare le pagine ASP.NET nel progetto di sito Web che è necessario per questa e le esercitazioni più avanti.</span><span class="sxs-lookup"><span data-stu-id="1ca03-147">Before we start our discussion on creating a DAL using stored procedures, let s first take a moment to create the ASP.NET pages in our website project that we will need for this and the next several tutorials.</span></span> <span data-ttu-id="1ca03-148">Iniziare aggiungendo una nuova cartella denominata `AdvancedDAL`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-148">Start by adding a new folder named `AdvancedDAL`.</span></span> <span data-ttu-id="1ca03-149">Successivamente, aggiungere le seguenti pagine ASP.NET per quella cartella, assicurandosi di associare ogni pagina con il `Site.master` pagina master:</span><span class="sxs-lookup"><span data-stu-id="1ca03-149">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `NewSprocs.aspx`
- `ExistingSprocs.aspx`
- `JOINs.aspx`
- `AddingColumns.aspx`
- `ComputedColumns.aspx`
- `EncryptingConfigSections.aspx`
- `ManagedFunctionsAndSprocs.aspx`


![Aggiungere le pagine ASP.NET per le esercitazioni di scenari livello accesso dati avanzati](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)

<span data-ttu-id="1ca03-151">**Figura 1**: Aggiungere le pagine ASP.NET per le esercitazioni di scenari livello accesso dati avanzati</span><span class="sxs-lookup"><span data-stu-id="1ca03-151">**Figure 1**: Add the ASP.NET Pages for the Advanced Data Access Layer Scenarios Tutorials</span></span>


<span data-ttu-id="1ca03-152">In altre cartelle, analogo a `Default.aspx` nella `AdvancedDAL` cartella elencherà le esercitazioni nella relativa sezione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-152">Like in the other folders, `Default.aspx` in the `AdvancedDAL` folder will list the tutorials in its section.</span></span> <span data-ttu-id="1ca03-153">Si tenga presente che il `SectionLevelTutorialListing.ascx` controllo utente fornisce questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="1ca03-153">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="1ca03-154">Pertanto, aggiungere questo controllo utente da `Default.aspx` trascinandolo da Esplora soluzioni nella pagina di visualizzazione della struttura s.</span><span class="sxs-lookup"><span data-stu-id="1ca03-154">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="1ca03-155">[![Aggiungere il controllo utente sectionleveltutoriallisting. ascx a default. aspx](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-155">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)</span></span>

<span data-ttu-id="1ca03-156">**Figura 2**: Aggiungere il `SectionLevelTutorialListing.ascx` controllo utente da `Default.aspx` ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-156">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png))</span></span>


<span data-ttu-id="1ca03-157">Infine, aggiungere queste pagine come voci per il `Web.sitemap` file.</span><span class="sxs-lookup"><span data-stu-id="1ca03-157">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="1ca03-158">In particolare, aggiungere il markup seguente dopo l'utilizzo dei dati in batch `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="1ca03-158">Specifically, add the following markup after the Working with Batched Data `<siteMapNode>`:</span></span>


[!code-xml[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample3.xml)]

<span data-ttu-id="1ca03-159">Dopo aver aggiornato `Web.sitemap`, si consiglia di visualizzare il sito Web di esercitazioni tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="1ca03-159">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="1ca03-160">Il menu a sinistra ora include elementi per le esercitazioni di scenari DAL avanzate.</span><span class="sxs-lookup"><span data-stu-id="1ca03-160">The menu on the left now includes items for the advanced DAL scenarios tutorials.</span></span>


![Mappa del sito include ora voci per le esercitazioni di scenari avanzati DAL](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)

<span data-ttu-id="1ca03-162">**Figura 3**: Mappa del sito include ora voci per le esercitazioni di scenari avanzati DAL</span><span class="sxs-lookup"><span data-stu-id="1ca03-162">**Figure 3**: The Site Map Now Includes Entries for the Advanced DAL Scenarios Tutorials</span></span>


## <a name="step-2-configuring-a-tableadapter-to-create-new-stored-procedures"></a><span data-ttu-id="1ca03-163">Passaggio 2: Configurazione di un oggetto TableAdapter per creare nuove Stored procedure</span><span class="sxs-lookup"><span data-stu-id="1ca03-163">Step 2: Configuring a TableAdapter to Create New Stored Procedures</span></span>

<span data-ttu-id="1ca03-164">Per illustrare la creazione di un livello di accesso ai dati che utilizza stored procedure anziché le istruzioni SQL ad hoc, s ti permettono di creare un nuovo DataSet tipizzati nelle `~/App_Code/DAL` cartella denominata `NorthwindWithSprocs.xsd`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-164">To demonstrate creating a Data Access Layer that uses stored procedures instead of ad-hoc SQL statements, let s create a new Typed DataSet in the `~/App_Code/DAL` folder named `NorthwindWithSprocs.xsd`.</span></span> <span data-ttu-id="1ca03-165">Poiché è stato eseguito l'accesso durante il processo in dettaglio nelle esercitazioni precedenti, si procederà rapidamente tramite la procedura seguente.</span><span class="sxs-lookup"><span data-stu-id="1ca03-165">Since we have stepped through this process in detail in previous tutorials, we will proceed quickly through the steps here.</span></span> <span data-ttu-id="1ca03-166">Rimanere bloccati o per richiedere un'ulteriore istruzioni di creazione e configurazione di un DataSet tipizzato, vedere la [creazione di un livello di accesso ai dati](../introduction/creating-a-data-access-layer-vb.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-166">If you get stuck or need further step-by-step instructions in creating and configuring a Typed DataSet, refer back to the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial.</span></span>

<span data-ttu-id="1ca03-167">Aggiungere un nuovo set di dati al progetto facendo clic su di `DAL` cartella, scegliere Aggiungi nuovo elemento e selezionando il modello di set di dati, come illustrato nella figura 4.</span><span class="sxs-lookup"><span data-stu-id="1ca03-167">Add a new DataSet to the project by right-clicking on the `DAL` folder, choosing Add New Item, and selecting the DataSet template as shown in Figure 4.</span></span>


<span data-ttu-id="1ca03-168">[![Aggiungere un nuovo set di dati tipizzato al progetto denominato NorthwindWithSprocs.xsd](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-168">[![Add a New Typed DataSet to the Project Named NorthwindWithSprocs.xsd](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png)</span></span>

<span data-ttu-id="1ca03-169">**Figura 4**: Aggiungere un nuovo set di dati tipizzato per il progetto denominato `NorthwindWithSprocs.xsd` ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-169">**Figure 4**: Add a New Typed DataSet to the Project Named `NorthwindWithSprocs.xsd` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png))</span></span>


<span data-ttu-id="1ca03-170">Questo verrà creare il nuovo set di dati tipizzato, aprire la finestra di progettazione, creare un nuovo TableAdapter e avviare la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="1ca03-170">This will create the new Typed DataSet, open its Designer, create a new TableAdapter, and launch the TableAdapter Configuration Wizard.</span></span> <span data-ttu-id="1ca03-171">Il primo passaggio s di configurazione guidata TableAdapter chiede di selezionare il database da usare.</span><span class="sxs-lookup"><span data-stu-id="1ca03-171">The TableAdapter Configuration Wizard s first step asks us to select the database to work with.</span></span> <span data-ttu-id="1ca03-172">La stringa di connessione al database Northwind dovrebbe essere elencata nell'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="1ca03-172">The connection string to the Northwind database should be listed in the drop-down list.</span></span> <span data-ttu-id="1ca03-173">Selezionare questa opzione e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="1ca03-173">Select this and click Next.</span></span>

<span data-ttu-id="1ca03-174">In questa schermata successiva è possibile scegliere la modalità dell'oggetto TableAdapter di accesso del database.</span><span class="sxs-lookup"><span data-stu-id="1ca03-174">From this next screen we can choose how the TableAdapter should access the database.</span></span> <span data-ttu-id="1ca03-175">Nelle esercitazioni precedenti è selezionata la prima opzione, Usa istruzioni SQL.</span><span class="sxs-lookup"><span data-stu-id="1ca03-175">In previous tutorials, we selected the first option, Use SQL statements.</span></span> <span data-ttu-id="1ca03-176">Per questa esercitazione, selezionare la seconda opzione, creare nuove stored procedure e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="1ca03-176">For this tutorial, select the second option, Create new stored procedures, and click Next.</span></span>


<span data-ttu-id="1ca03-177">[![Richiedere del TableAdapter per creare nuove Stored procedure](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-177">[![Instruct the TableAdapter to Create New Stored Procedures](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png)</span></span>

<span data-ttu-id="1ca03-178">**Figura 5**: Richiedere del TableAdapter per creare nuove Stored procedure ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-178">**Figure 5**: Instruct the TableAdapter to Create New Stored Procedures ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png))</span></span>


<span data-ttu-id="1ca03-179">Analogamente all'utilizzo di istruzioni SQL ad hoc, a nel passaggio seguente ci viene richiesto di fornire il `SELECT` istruzione per la query principale s TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="1ca03-179">Just like with using ad-hoc SQL statements, in the following step we are asked to provide the `SELECT` statement for the TableAdapter s main query.</span></span> <span data-ttu-id="1ca03-180">Ma invece di usare la `SELECT` istruzione immessi qui per eseguire direttamente una query ad hoc, la configurazione guidata TableAdapter s creerà una stored procedure che contiene questo `SELECT` query.</span><span class="sxs-lookup"><span data-stu-id="1ca03-180">But instead of using the `SELECT` statement entered here to perform an ad-hoc query directly, the TableAdapter s wizard will create a stored procedure that contains this `SELECT` query.</span></span>

<span data-ttu-id="1ca03-181">Usare il comando seguente `SELECT` query per questo oggetto TableAdapter:</span><span class="sxs-lookup"><span data-stu-id="1ca03-181">Use the following `SELECT` query for this TableAdapter:</span></span>


[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample4.sql)]


<span data-ttu-id="1ca03-182">[![Immettere la Query SELECT](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-182">[![Enter the SELECT Query](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png)</span></span>

<span data-ttu-id="1ca03-183">**Figura 6**: Immettere il `SELECT` Query ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-183">**Figure 6**: Enter the `SELECT` Query ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png))</span></span>


> [!NOTE]
> <span data-ttu-id="1ca03-184">La query precedente si differenzia leggermente dalla query principale della `ProductsTableAdapter` nella `Northwind` DataSet tipizzato.</span><span class="sxs-lookup"><span data-stu-id="1ca03-184">The query above differs slightly from the main query of the `ProductsTableAdapter` in the `Northwind` Typed DataSet.</span></span> <span data-ttu-id="1ca03-185">Si tenga presente che il `ProductsTableAdapter` nella `Northwind` DataSet tipizzata include due sottoquery correlate per riportare online il nome di categoria e il nome della società per ogni categoria di prodotto s e fornitore.</span><span class="sxs-lookup"><span data-stu-id="1ca03-185">Recall that the `ProductsTableAdapter` in the `Northwind` Typed DataSet includes two correlated subqueries to bring back the category name and company name for each product s category and supplier.</span></span> <span data-ttu-id="1ca03-186">Nella imminente [aggiornamento del TableAdapter per usare join](updating-the-tableadapter-to-use-joins-vb.md) si esaminerà l'aggiunta di questa esercitazione i dati correlati a questo oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="1ca03-186">In the upcoming [Updating the TableAdapter to Use JOINs](updating-the-tableadapter-to-use-joins-vb.md) tutorial we will look at adding this related data to this TableAdapter.</span></span>


<span data-ttu-id="1ca03-187">Si consiglia di fare clic sul pulsante Opzioni avanzate.</span><span class="sxs-lookup"><span data-stu-id="1ca03-187">Take a moment to click the Advanced Options button.</span></span> <span data-ttu-id="1ca03-188">Da qui è possibile specificare se la procedura guidata deve generare anche insert, update e istruzioni di eliminazione per i TableAdapter, se si desidera usare la concorrenza ottimistica e indica se la tabella di dati deve essere aggiornata dopo inserimenti e aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="1ca03-188">From here we can specify whether the wizard should also generate insert, update, and delete statements for the TableAdapter, whether to use optimistic concurrency, and whether the data table should be refreshed after inserts and updates.</span></span> <span data-ttu-id="1ca03-189">Per impostazione predefinita è selezionata l'opzione di istruzioni genera istruzioni Insert, Update e Delete.</span><span class="sxs-lookup"><span data-stu-id="1ca03-189">The Generate Insert, Update and Delete statements option is checked by default.</span></span> <span data-ttu-id="1ca03-190">Lasciare selezionata.</span><span class="sxs-lookup"><span data-stu-id="1ca03-190">Leave it checked.</span></span> <span data-ttu-id="1ca03-191">Per questa esercitazione, lasciare deselezionata Usa le opzioni di concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="1ca03-191">For this tutorial, leave the Use optimistic concurrency options unchecked.</span></span>

<span data-ttu-id="1ca03-192">Quando si verificano le stored procedure create automaticamente la configurazione guidata TableAdapter, sembra che l'aggiornamento, l'opzione di tabella di dati viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="1ca03-192">When having the stored procedures automatically created by the TableAdapter wizard, it appears that the Refresh the data table option is ignored.</span></span> <span data-ttu-id="1ca03-193">Indipendentemente dal fatto che questa casella di controllo è selezionata, il risultante insert e update stored procedure recuperano il record appena-inserite o aggiornate just, come vedremo nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="1ca03-193">Regardless of whether this checkbox is checked, the resulting insert and update stored procedures retrieve the just-inserted or just-updated record, as we will see in Step 3.</span></span>


![Lasciare le istruzioni genera istruzioni Insert, Update e Delete opzione selezionata](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png)

<span data-ttu-id="1ca03-195">**Figura 7**: Lasciare le istruzioni genera istruzioni Insert, Update e Delete opzione selezionata</span><span class="sxs-lookup"><span data-stu-id="1ca03-195">**Figure 7**: Leave the Generate Insert, Update and Delete statements Option Checked</span></span>


> [!NOTE]
> <span data-ttu-id="1ca03-196">Se è selezionata l'opzione di usare la concorrenza ottimistica, la procedura guidata aggiungerà condizioni aggiuntive per il `WHERE` clausola che impedire l'aggiornamento se sono state eseguite modifiche in altri campi di dati.</span><span class="sxs-lookup"><span data-stu-id="1ca03-196">If the Use optimistic concurrency option is checked, the wizard will add additional conditions to the `WHERE` clause that prevent data from being updated if there were changes in other fields.</span></span> <span data-ttu-id="1ca03-197">Fare riferimento al [implementazione della concorrenza ottimistica](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) esercitazione per altre informazioni sull'uso della funzionalità di controllo della concorrenza ottimistica predefinita s TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="1ca03-197">Refer back to the [Implementing Optimistic Concurrency](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) tutorial for more information on using the TableAdapter s built-in optimistic concurrency control feature.</span></span>


<span data-ttu-id="1ca03-198">Dopo aver immesso il `SELECT` eseguire una query e per confermare che sia selezionata l'opzione di istruzioni genera istruzioni Insert, Update e Delete, fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="1ca03-198">After entering the `SELECT` query and confirming that the Generate Insert, Update and Delete statements option is checked, click Next.</span></span> <span data-ttu-id="1ca03-199">Questa schermata successiva, illustrata nella figura 8, richiesto per i nomi delle stored procedure che creerà la procedura guidata per la selezione, inserimento, aggiornamento ed eliminazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="1ca03-199">This next screen, shown in Figure 8, prompts for the names of the stored procedures the wizard will create for selecting, inserting, updating, and deleting data.</span></span> <span data-ttu-id="1ca03-200">Modifica i nomi di procedure per questi dati archiviati `Products_Select`, `Products_Insert`, `Products_Update`, e `Products_Delete`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-200">Change these stored procedures names to `Products_Select`, `Products_Insert`, `Products_Update`, and `Products_Delete`.</span></span>


<span data-ttu-id="1ca03-201">[![Rinominare le Stored procedure](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-201">[![Rename the Stored Procedures](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span></span>

<span data-ttu-id="1ca03-202">**Figura 8**: Rinominare le Stored procedure ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-202">**Figure 8**: Rename the Stored Procedures ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span></span>


<span data-ttu-id="1ca03-203">Per visualizzare la configurazione guidata TableAdapter verrà utilizzato per creare quattro stored procedure T-SQL, fare clic sul pulsante Anteprima Script SQL.</span><span class="sxs-lookup"><span data-stu-id="1ca03-203">To see the T-SQL the TableAdapter wizard will use to create the four stored procedures, click the Preview SQL Script button.</span></span> <span data-ttu-id="1ca03-204">Nella finestra di dialogo Anteprima Script SQL può salvare lo script in un file o copiarlo negli Appunti.</span><span class="sxs-lookup"><span data-stu-id="1ca03-204">From the Preview SQL Script dialog box you may save the script to a file or copy it to the clipboard.</span></span>


![Visualizzare in anteprima lo Script SQL usato per generare le Stored procedure](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)

<span data-ttu-id="1ca03-206">**Figura 9**: Visualizzare in anteprima lo Script SQL usato per generare le Stored procedure</span><span class="sxs-lookup"><span data-stu-id="1ca03-206">**Figure 9**: Preview the SQL Script Used to Generate the Stored Procedures</span></span>


<span data-ttu-id="1ca03-207">Dopo la denominazione delle stored procedure, fare clic accanto ai metodi corrispondenti ai TableAdapter nome.</span><span class="sxs-lookup"><span data-stu-id="1ca03-207">After naming the stored procedures, click Next to name the TableAdapter s corresponding methods.</span></span> <span data-ttu-id="1ca03-208">Proprio come quando si Usa istruzioni SQL ad hoc, possiamo creare metodi che è riempire un DataTable esistenti o restituiscono una nuova.</span><span class="sxs-lookup"><span data-stu-id="1ca03-208">Just like when using ad-hoc SQL statements, we can create methods that fill an existing DataTable or return a new one.</span></span> <span data-ttu-id="1ca03-209">Possiamo inoltre specificare se l'oggetto TableAdapter deve includere il modello di DB-Direct per inserimento, aggiornamento ed eliminazione di record.</span><span class="sxs-lookup"><span data-stu-id="1ca03-209">We can also specify whether the TableAdapter should include the DB-Direct pattern for inserting, updating, and deleting records.</span></span> <span data-ttu-id="1ca03-210">Lasciare tutte le tre caselle di controllo selezionate, ma il valore restituito non rinominare un metodo di DataTable per `GetProducts` (come illustrato nella figura 10).</span><span class="sxs-lookup"><span data-stu-id="1ca03-210">Leave all three checkboxes checked, but rename the Return a DataTable method to `GetProducts` (as shown in Figure 10).</span></span>


<span data-ttu-id="1ca03-211">[![Denominare i metodi Fill e GetProducts](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-211">[![Name the Methods Fill and GetProducts](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)</span></span>

<span data-ttu-id="1ca03-212">**Figura 10**: Denominare i metodi `Fill` e `GetProducts` ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-212">**Figure 10**: Name the Methods `Fill` and `GetProducts` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png))</span></span>


<span data-ttu-id="1ca03-213">Fare clic su Avanti per visualizzare un riepilogo dei passaggi che eseguirà la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="1ca03-213">Click Next to see a summary of the steps the wizard will perform.</span></span> <span data-ttu-id="1ca03-214">Completare la procedura guidata facendo clic sul pulsante Fine.</span><span class="sxs-lookup"><span data-stu-id="1ca03-214">Complete the wizard by clicking the Finish button.</span></span> <span data-ttu-id="1ca03-215">Al termine della procedura guidata, verrà di nuovo per i DataSet Designer, che dovrebbe ora includere la `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-215">Once the wizard completes, you will be returned to the DataSet s Designer, which should now include the `ProductsDataTable`.</span></span>


<span data-ttu-id="1ca03-216">[![Progettazione DataSet s Mostra il ProductsDataTable appena aggiunta](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-216">[![The DataSet s Designer Shows the Newly Added ProductsDataTable](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)</span></span>

<span data-ttu-id="1ca03-217">**Figura 11**: I DataSet finestra di progettazione Mostra le appena aggiunto `ProductsDataTable` ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-217">**Figure 11**: The DataSet s Designer Shows the Newly Added `ProductsDataTable` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png))</span></span>


## <a name="step-3-examining-the-newly-created-stored-procedures"></a><span data-ttu-id="1ca03-218">Passaggio 3: Esaminare le Stored procedure appena create</span><span class="sxs-lookup"><span data-stu-id="1ca03-218">Step 3: Examining the Newly Created Stored Procedures</span></span>

<span data-ttu-id="1ca03-219">La configurazione guidata TableAdapter usata nel passaggio 2 automaticamente create le stored procedure per la selezione, inserimento, aggiornamento ed eliminazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="1ca03-219">The TableAdapter wizard used in Step 2 automatically created the stored procedures for selecting, inserting, updating, and deleting data.</span></span> <span data-ttu-id="1ca03-220">Queste stored procedure possono essere visualizzate o modificate tramite Visual Studio da Esplora Server e il drill-down nella cartella database s Stored procedure.</span><span class="sxs-lookup"><span data-stu-id="1ca03-220">These stored procedures can be viewed or modified through Visual Studio by going to the Server Explorer and drilling down into the database s Stored Procedures folder.</span></span> <span data-ttu-id="1ca03-221">Come illustrato nella figura 12, il database di Northwind contiene quattro nuove stored procedure: `Products_Delete`, `Products_Insert`, `Products_Select`, e `Products_Update`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-221">As Figure 12 shows, the Northwind database contains four new stored procedures: `Products_Delete`, `Products_Insert`, `Products_Select`, and `Products_Update`.</span></span>


![Le quattro Stored procedure create nel passaggio 2 sono reperibile nella cartella Database s Stored procedure](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)

<span data-ttu-id="1ca03-223">**Figura 12**: Le quattro Stored procedure create nel passaggio 2 sono reperibile nella cartella Database s Stored procedure</span><span class="sxs-lookup"><span data-stu-id="1ca03-223">**Figure 12**: The Four Stored Procedures Created in Step 2 Can Be Found in the Database s Stored Procedures Folder</span></span>


> [!NOTE]
> <span data-ttu-id="1ca03-224">Se non è possibile visualizzare Esplora Server, passare al menu Visualizza e scegliere l'opzione di Esplora Server.</span><span class="sxs-lookup"><span data-stu-id="1ca03-224">If you do not see the Server Explorer, go to the View menu and choose the Server Explorer option.</span></span> <span data-ttu-id="1ca03-225">Se non è possibile visualizzare le relative al prodotto stored procedure aggiunte dal passaggio 2, provare a facendo clic sulla cartella Stored procedure e scegliendo di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="1ca03-225">If you do not see the product-related stored procedures added from Step 2, try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>


<span data-ttu-id="1ca03-226">Per visualizzare o modificare una stored procedure, fare doppio clic sul relativo nome in Esplora Server o, in alternativa, fare doppio clic su nella stored procedure e scegliere Apri.</span><span class="sxs-lookup"><span data-stu-id="1ca03-226">To view or modify a stored procedure, double-click its name in the Server Explorer or, alternatively, right-click on the stored procedure and choose Open.</span></span> <span data-ttu-id="1ca03-227">Figura 13 Mostra il `Products_Delete` stored procedure, di apertura.</span><span class="sxs-lookup"><span data-stu-id="1ca03-227">Figure 13 shows the `Products_Delete` stored procedure, when opened.</span></span>


<span data-ttu-id="1ca03-228">[![Le stored procedure possono essere aperto e modificate da Visual Studio](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-228">[![Stored Procedures Can Be Opened and Modified From Within Visual Studio](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png)</span></span>

<span data-ttu-id="1ca03-229">**Figura 13**: Stored procedure possono essere aperti e modificati da all'interno di Visual Studio ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-229">**Figure 13**: Stored Procedures Can Be Opened and Modified From Within Visual Studio ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png))</span></span>


<span data-ttu-id="1ca03-230">Il contenuto di entrambe le `Products_Delete` e `Products_Select` stored procedure sono piuttosto semplici.</span><span class="sxs-lookup"><span data-stu-id="1ca03-230">The contents of both the `Products_Delete` and `Products_Select` stored procedures are quite straightforward.</span></span> <span data-ttu-id="1ca03-231">Il `Products_Insert` e `Products_Update` stored procedure, d'altra parte, giustificano un esame più da vicino come entrambe eseguono un `SELECT` istruzione dopo il loro `INSERT` e `UPDATE` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="1ca03-231">The `Products_Insert` and `Products_Update` stored procedures, on the other hand, warrant a closer inspection as they both perform a `SELECT` statement after their `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="1ca03-232">Ad esempio, il codice SQL seguente costituisce il `Products_Insert` stored procedure:</span><span class="sxs-lookup"><span data-stu-id="1ca03-232">For example, the following SQL makes up the `Products_Insert` stored procedure:</span></span>


[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample5.sql)]

<span data-ttu-id="1ca03-233">La stored procedure accetta come parametri di input il `Products` le colonne che sono state restituite dai `SELECT` query specificata nella procedura guidata s TableAdapter e questi valori vengono usati in un `INSERT` istruzione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-233">The stored procedure accepts as input parameters the `Products` columns that were returned by the `SELECT` query specified in the TableAdapter s wizard and these values are used in an `INSERT` statement.</span></span> <span data-ttu-id="1ca03-234">Seguendo la `INSERT` istruzione, una `SELECT` query viene usata per restituire il `Products` i valori di colonna (incluso il `ProductID`) del record appena aggiunto.</span><span class="sxs-lookup"><span data-stu-id="1ca03-234">Following the `INSERT` statement, a `SELECT` query is used to return the `Products` column values (including the `ProductID`) of the newly added record.</span></span> <span data-ttu-id="1ca03-235">Questa funzionalità di aggiornamento è utile quando l'aggiunta di un nuovo record usando il modello di aggiornamento Batch che automaticamente Aggiorna appena aggiunta `ProductRow` istanze `ProductID` proprietà con i valori con incremento automatico assegnati dal database.</span><span class="sxs-lookup"><span data-stu-id="1ca03-235">This refresh capability is useful when adding a new record using the Batch Update pattern as it automatically updates the newly added `ProductRow` instances `ProductID` properties with the auto-incremented values assigned by the database.</span></span>

<span data-ttu-id="1ca03-236">Il codice seguente illustra questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="1ca03-236">The following code illustrates this feature.</span></span> <span data-ttu-id="1ca03-237">Contiene un `ProductsTableAdapter` e `ProductsDataTable` creata per il `NorthwindWithSprocs` DataSet tipizzato.</span><span class="sxs-lookup"><span data-stu-id="1ca03-237">It contains a `ProductsTableAdapter` and `ProductsDataTable` created for the `NorthwindWithSprocs` Typed DataSet.</span></span> <span data-ttu-id="1ca03-238">Un nuovo prodotto viene aggiunto al database tramite la creazione di un `ProductsRow` istanza, specificando i relativi valori e chiamando i TableAdapter `Update` metodo, passando il `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-238">A new product is added to the database by creating a `ProductsRow` instance, supplying its values, and calling the TableAdapter s `Update` method, passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="1ca03-239">Internamente, i TableAdapter `Update` metodo enumera la `ProductsRow` istanze DataTable passato (in questo esempio è presente un solo - quello appena aggiunto) ed esegue appropriato di inserire, aggiornare o eliminare comandi.</span><span class="sxs-lookup"><span data-stu-id="1ca03-239">Internally, the TableAdapter s `Update` method enumerates the `ProductsRow` instances in the passed-in DataTable (in this example there is only one - the one we just added), and performs the appropriate insert, update, or delete command.</span></span> <span data-ttu-id="1ca03-240">In questo caso, il `Products_Insert` stored procedure viene eseguita, che aggiunge un nuovo record per il `Products` di tabella e restituisce i dettagli del record appena aggiunto.</span><span class="sxs-lookup"><span data-stu-id="1ca03-240">In this case, the `Products_Insert` stored procedure is executed, which adds a new record to the `Products` table and returns the details of the newly-added record.</span></span> <span data-ttu-id="1ca03-241">Il `ProductsRow` istanza s `ProductID` valore viene quindi aggiornato.</span><span class="sxs-lookup"><span data-stu-id="1ca03-241">The `ProductsRow` instance s `ProductID` value is then updated.</span></span> <span data-ttu-id="1ca03-242">Dopo il `Update` completamento del metodo, è possibile accedere al record appena aggiunti s `ProductID` valore tramite il `ProductsRow` s `ProductID` proprietà.</span><span class="sxs-lookup"><span data-stu-id="1ca03-242">After the `Update` method has completed, we can access the newly-added record s `ProductID` value through the `ProductsRow` s `ProductID` property.</span></span>


[!code-vb[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample6.vb)]

<span data-ttu-id="1ca03-243">Il `Products_Update` stored procedure in modo analogo include un `SELECT` istruzione dopo il relativo `UPDATE` istruzione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-243">The `Products_Update` stored procedure similarly includes a `SELECT` statement after its `UPDATE` statement.</span></span>


[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample7.sql)]

<span data-ttu-id="1ca03-244">Si noti che questa stored procedure includono due parametri di input per `ProductID`: `@Original_ProductID` e `@ProductID`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-244">Note that this stored procedure includes two input parameters for `ProductID`: `@Original_ProductID` and `@ProductID`.</span></span> <span data-ttu-id="1ca03-245">Questa funzionalità permette scenari in cui la chiave primaria può essere modificata.</span><span class="sxs-lookup"><span data-stu-id="1ca03-245">This functionality allows for scenarios where the primary key might be changed.</span></span> <span data-ttu-id="1ca03-246">Ad esempio, in un database di dipendenti, ogni record dipendente potrebbe usare il numero di previdenza sociale s dipendente come la propria chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="1ca03-246">For example, in an employee database, each employee record might use the employee s social security number as their primary key.</span></span> <span data-ttu-id="1ca03-247">Per modificare un numero di previdenza sociale di s dipendente esistente, è necessario che venga forniti sia il nuovo numero di previdenza sociale e quella originale.</span><span class="sxs-lookup"><span data-stu-id="1ca03-247">In order to change an existing employee s social security number, both the new social security number and the original one must be supplied.</span></span> <span data-ttu-id="1ca03-248">Per il `Products` tabella, tale funzionalità non è necessaria perché la `ProductID` colonna è un `IDENTITY` colonna e non deve mai essere modificato.</span><span class="sxs-lookup"><span data-stu-id="1ca03-248">For the `Products` table, such functionality is not needed because the `ProductID` column is an `IDENTITY` column and should never be changed.</span></span> <span data-ttu-id="1ca03-249">In effetti, il `UPDATE` istruzione il `Products_Update` includono stored procedure t il `ProductID` colonna nell'elenco di colonne.</span><span class="sxs-lookup"><span data-stu-id="1ca03-249">In fact, the `UPDATE` statement in the `Products_Update` stored procedure doesn t include the `ProductID` column in its column list.</span></span> <span data-ttu-id="1ca03-250">Pertanto, mentre `@Original_ProductID` viene utilizzata per il `UPDATE` istruzione s `WHERE` clausola è superfluo per il `Products` tabella e possono essere sostituiti dal `@ProductID` parametro.</span><span class="sxs-lookup"><span data-stu-id="1ca03-250">So, while `@Original_ProductID` is used in the `UPDATE` statement s `WHERE` clause, it is superfluous for the `Products` table and could be replaced by the `@ProductID` parameter.</span></span> <span data-ttu-id="1ca03-251">Quando si modifica un parametri delle stored procedure s è importante che vengono aggiornati anche i metodi TableAdapter che usano la stored procedure.</span><span class="sxs-lookup"><span data-stu-id="1ca03-251">When modifying a stored procedure s parameters it is important that the TableAdapter method(s) that use that stored procedure are also updated.</span></span>

## <a name="step-4-modifying-a-stored-procedure-s-parameters-and-updating-the-tableadapter"></a><span data-ttu-id="1ca03-252">Passaggio 4: Modifica di una Stored Procedure s parametri e aggiornamento del TableAdapter</span><span class="sxs-lookup"><span data-stu-id="1ca03-252">Step 4: Modifying a Stored Procedure s Parameters and Updating the TableAdapter</span></span>

<span data-ttu-id="1ca03-253">Poiché il `@Original_ProductID` parametro è superflua, ti permettono di s rimuoverla dal `Products_Update` stored procedure di completamente.</span><span class="sxs-lookup"><span data-stu-id="1ca03-253">Since the `@Original_ProductID` parameter is superfluous, let s remove it from the `Products_Update` stored procedure altogether.</span></span> <span data-ttu-id="1ca03-254">Aprire il `Products_Update` stored procedure elimina il `@Original_ProductID` parametro e, nel `WHERE` clausola del `UPDATE` istruzione, cambiare il nome del parametro utilizzato da `@Original_ProductID` a `@ProductID`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-254">Open the `Products_Update` stored procedure, delete the `@Original_ProductID` parameter, and, in the `WHERE` clause of the `UPDATE` statement, change the parameter name used from `@Original_ProductID` to `@ProductID`.</span></span> <span data-ttu-id="1ca03-255">Dopo aver apportato queste modifiche, l'istruzione T-SQL della stored procedure dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="1ca03-255">After making these changes, the T-SQL within the stored procedure should look like the following:</span></span>


[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample8.sql)]

<span data-ttu-id="1ca03-256">Per salvare queste modifiche al database, fare clic sull'icona Salva nella barra degli strumenti o premere Ctrl + S.</span><span class="sxs-lookup"><span data-stu-id="1ca03-256">To save these changes to the database, click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="1ca03-257">A questo punto, il `Products_Update` stored procedure non prevede un `@Original_ProductID` parametro di input, ma il TableAdapter sia configurato per passare un parametro di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="1ca03-257">At this point, the `Products_Update` stored procedure does not expect an `@Original_ProductID` input parameter, but the TableAdapter is configured to pass such a parameter.</span></span> <span data-ttu-id="1ca03-258">È possibile visualizzare i parametri dell'oggetto TableAdapter verrà inviato al `Products_Update` stored procedure di selezionando TableAdapter in Progettazione DataSet, passare alla finestra proprietà e facendo clic sui puntini di sospensione nel `UpdateCommand` s `Parameters` raccolta.</span><span class="sxs-lookup"><span data-stu-id="1ca03-258">You can see the parameters the TableAdapter will send to the `Products_Update` stored procedure by selecting the TableAdapter in the DataSet Designer, going to the Properties window, and clicking the ellipses in the `UpdateCommand` s `Parameters` collection.</span></span> <span data-ttu-id="1ca03-259">Verrà visualizzata la finestra di dialogo Editor dell'insieme di parametri, illustrato nella figura 14.</span><span class="sxs-lookup"><span data-stu-id="1ca03-259">This brings up the Parameters Collection Editor dialog box shown in Figure 14.</span></span>


![Gli elenchi di Editor della raccolta di parametri i parametri utilizzati passato al Products_Update Stored Procedure](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png)

<span data-ttu-id="1ca03-261">**Figura 14**: Gli elenchi di Editor della raccolta di parametri i parametri utilizzati passato al `Products_Update` Stored Procedure</span><span class="sxs-lookup"><span data-stu-id="1ca03-261">**Figure 14**: The Parameters Collection Editor Lists the Parameters Used Passed to the `Products_Update` Stored Procedure</span></span>


<span data-ttu-id="1ca03-262">È possibile rimuovere questo parametro da qui, selezionando semplicemente il `@Original_ProductID` parametro dall'elenco dei membri e facendo clic sul pulsante Rimuovi.</span><span class="sxs-lookup"><span data-stu-id="1ca03-262">You can remove this parameter from here by simply selecting the `@Original_ProductID` parameter from the list of members and clicking the Remove button.</span></span>

<span data-ttu-id="1ca03-263">In alternativa, è possibile aggiornare i parametri utilizzati per tutti i metodi, pulsante destro del mouse su TableAdapter nella finestra di progettazione e scegliere Configura.</span><span class="sxs-lookup"><span data-stu-id="1ca03-263">Alternatively, you can refresh the parameters used for all of the methods by right-clicking on the TableAdapter in the Designer and choosing Configure.</span></span> <span data-ttu-id="1ca03-264">Verrà visualizzata la configurazione guidata TableAdapter, elencare le stored procedure utilizzate per la selezione, inserimento, aggiornamento, e l'eliminazione, insieme a parametri di stored procedure prevedono di ricevere.</span><span class="sxs-lookup"><span data-stu-id="1ca03-264">This will bring up the TableAdapter Configuration wizard, listing the stored procedures used for selecting, inserting, updating, and deleting, along with the parameters the stored procedures expect to receive.</span></span> <span data-ttu-id="1ca03-265">Se si fa clic nell'elenco a discesa di aggiornamenti è possibile vedere le `Products_Update` stored procedure prevede parametri di input, che ora non sono più inclusi `@Original_ProductID` (vedere Figura 15).</span><span class="sxs-lookup"><span data-stu-id="1ca03-265">If you click on the Update drop-down list you can see the `Products_Update` stored procedures expected input parameters, which now no longer includes `@Original_ProductID` (see Figure 15).</span></span> <span data-ttu-id="1ca03-266">È sufficiente fare clic su Fine per aggiornare automaticamente la raccolta di parametri utilizzata dall'oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="1ca03-266">Simply click Finish to automatically update the parameter collection used by the TableAdapter.</span></span>


<span data-ttu-id="1ca03-267">[![In alternativa, è possibile utilizzare la configurazione guidata TableAdapter s per le raccolte di parametri di metodi di aggiornamento](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-267">[![You Can Alternatively Use the TableAdapter s Configuration Wizard to Refresh Its Methods Parameter Collections](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span></span>

<span data-ttu-id="1ca03-268">**Figura 15**: In alternativa è possibile usare i TableAdapter configurazione guidata per aggiornare insiemi di parametri metodi Its ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-268">**Figure 15**: You Can Alternatively Use the TableAdapter s Configuration Wizard to Refresh Its Methods Parameter Collections ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span></span>


## <a name="step-5-adding-additional-tableadapter-methods"></a><span data-ttu-id="1ca03-269">Passaggio 5: Aggiunta di metodi TableAdapter aggiuntive</span><span class="sxs-lookup"><span data-stu-id="1ca03-269">Step 5: Adding Additional TableAdapter Methods</span></span>

<span data-ttu-id="1ca03-270">Come passaggio 2 illustrato, quando si crea un nuovo TableAdapter è facile per la stored procedure corrispondenti vengono generati automaticamente.</span><span class="sxs-lookup"><span data-stu-id="1ca03-270">As Step 2 illustrated, when creating a new TableAdapter it is easy to have the corresponding stored procedures automatically generated.</span></span> <span data-ttu-id="1ca03-271">Lo stesso vale quando si aggiungono altri metodi a un oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="1ca03-271">The same is true when adding additional methods to a TableAdapter.</span></span> <span data-ttu-id="1ca03-272">Per illustrare questo concetto, consentire s aggiungere una `GetProductByProductID(productID)` metodo di `ProductsTableAdapter` creato nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="1ca03-272">To illustrate this, let s add a `GetProductByProductID(productID)` method to the `ProductsTableAdapter` created in Step 2.</span></span> <span data-ttu-id="1ca03-273">Questo metodo utilizzerà come input un `ProductID` valore e restituire i dettagli relativi al prodotto specificato.</span><span class="sxs-lookup"><span data-stu-id="1ca03-273">This method will take as input a `ProductID` value and return details about the specified product.</span></span>

<span data-ttu-id="1ca03-274">Avviare facendo clic sull'oggetto TableAdapter e scegliendo Aggiungi Query dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="1ca03-274">Start by right-clicking on the TableAdapter and choosing Add Query from the context menu.</span></span>


![Aggiungere una nuova Query al TableAdapter.](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)

<span data-ttu-id="1ca03-276">**Figura 16**: Aggiungere una nuova Query al TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="1ca03-276">**Figure 16**: Add a New Query to the TableAdapter</span></span>


<span data-ttu-id="1ca03-277">Verrà avviata la configurazione guidata Query TableAdapter, che richiede prima di tutto come oggetto TableAdapter deve accedere al database.</span><span class="sxs-lookup"><span data-stu-id="1ca03-277">This will start the TableAdapter Query Configuration wizard, which first prompts for how the TableAdapter should access the database.</span></span> <span data-ttu-id="1ca03-278">Per una nuova stored procedure creata, scegliere Crea una nuova opzione della stored procedure e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="1ca03-278">To have a new stored procedure created, choose the Create a new stored procedure option and click Next.</span></span>


<span data-ttu-id="1ca03-279">[![Scegliere di creare una nuova stored procedure, opzione](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-279">[![Choose the Create a new stored procedure Option](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)</span></span>

<span data-ttu-id="1ca03-280">**Figura 17**: Scegliere di creare una nuova stored procedure opzione ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-280">**Figure 17**: Choose the Create a new stored procedure Option ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png))</span></span>


<span data-ttu-id="1ca03-281">Nella schermata successiva viene chiesto di specificare per identificare il tipo di query da eseguire, se viene restituito un set di righe o un singolo valore scalare o eseguire un' `UPDATE`, `INSERT`, o `DELETE` istruzione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-281">The next screen asks us to identify the type of query to execute, whether it will return a set of rows or a single scalar value, or perform an `UPDATE`, `INSERT`, or `DELETE` statement.</span></span> <span data-ttu-id="1ca03-282">Poiché il `GetProductByProductID(productID)` metodo verrà restituita una riga, lasciare il SELECT che restituisce righe opzione selezionata e scegliere "Avanti".</span><span class="sxs-lookup"><span data-stu-id="1ca03-282">Since the `GetProductByProductID(productID)` method will return a row, leave the SELECT which returns row option selected and hit Next.</span></span>


<span data-ttu-id="1ca03-283">[![Scegliere il SELECT che restituisce righe opzione](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-283">[![Choose the SELECT which returns row Option](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)</span></span>

<span data-ttu-id="1ca03-284">**Figura 18**: Seleziona che restituisce righe opzione ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-284">**Figure 18**: Choose the SELECT which returns row Option ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png))</span></span>


<span data-ttu-id="1ca03-285">Nella schermata successiva consente di visualizzare la query principale di s TableAdapter, che viene elencato solo il nome della stored procedure (`dbo.Products_Select`).</span><span class="sxs-lookup"><span data-stu-id="1ca03-285">The next screen displays the TableAdapter s main query, which just lists the name of the stored procedure (`dbo.Products_Select`).</span></span> <span data-ttu-id="1ca03-286">Sostituire il nome della stored procedure con il codice seguente `SELECT` istruzione che restituisce tutti i campi di prodotto per un prodotto specificato:</span><span class="sxs-lookup"><span data-stu-id="1ca03-286">Replace the stored procedure name with the following `SELECT` statement, which returns all of the product fields for a specified product:</span></span>


[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample9.sql)]


<span data-ttu-id="1ca03-287">[![Sostituire il nome della Stored Procedure con una Query SELECT](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-287">[![Replace the Stored Procedure Name with a SELECT Query](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)</span></span>

<span data-ttu-id="1ca03-288">**Figura 19**: Sostituire il nome di Stored Procedure con un `SELECT` Query ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-288">**Figure 19**: Replace the Stored Procedure Name with a `SELECT` Query ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image43.png))</span></span>


<span data-ttu-id="1ca03-289">La schermata successiva viene chiesto di assegnare un nome di stored procedure che verrà creata.</span><span class="sxs-lookup"><span data-stu-id="1ca03-289">The subsequent screen asks you to name the stored procedure that will be created.</span></span> <span data-ttu-id="1ca03-290">Immettere il nome `Products_SelectByProductID` e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="1ca03-290">Enter the name `Products_SelectByProductID` and click Next.</span></span>


<span data-ttu-id="1ca03-291">[![Denominare il nuovo Products_SelectByProductID Stored Procedure](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image45.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-291">[![Name the New Stored Procedure Products_SelectByProductID](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image45.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image44.png)</span></span>

<span data-ttu-id="1ca03-292">**Figura 20**: Denominare la nuova Stored Procedure `Products_SelectByProductID` ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-292">**Figure 20**: Name the New Stored Procedure `Products_SelectByProductID` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image46.png))</span></span>


<span data-ttu-id="1ca03-293">Il passaggio finale della procedura guidata consente di modificare il metodo nomi generati, nonché indicano se si desidera utilizzare il riempimento di un modello di DataTable, restituire una serie di DataTable, o entrambi.</span><span class="sxs-lookup"><span data-stu-id="1ca03-293">The final step of the wizard allows us to change the method names generated as well as indicate whether to use the Fill a DataTable pattern, Return a DataTable pattern, or both.</span></span> <span data-ttu-id="1ca03-294">Per questo metodo, non modificare entrambe le opzioni selezionate, ma rinominare i metodi `FillByProductID` e `GetProductByProductID`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-294">For this method, leave both options checked, but rename the methods to `FillByProductID` and `GetProductByProductID`.</span></span> <span data-ttu-id="1ca03-295">Fare clic su Avanti per visualizzare un riepilogo dei passaggi di eseguire la procedura guidata e quindi fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="1ca03-295">Click Next to view a summary of the steps the wizard will perform and then click Finish to complete the wizard.</span></span>


<span data-ttu-id="1ca03-296">[![Rinominare i metodi di s TableAdapter FillByProductID e GetProductByProductID](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image48.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-296">[![Rename the TableAdapter s Methods to FillByProductID and GetProductByProductID](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image48.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image47.png)</span></span>

<span data-ttu-id="1ca03-297">**Figura 21**: Rinominare i metodi s TableAdapter `FillByProductID` e `GetProductByProductID` ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-297">**Figure 21**: Rename the TableAdapter s Methods to `FillByProductID` and `GetProductByProductID` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image49.png))</span></span>


<span data-ttu-id="1ca03-298">Dopo aver completato la procedura guidata, TableAdapter dispone di un metodo di nuovo disponibile, `GetProductByProductID(productID)` che, quando richiamata, eseguirà il `Products_SelectByProductID` stored procedure che è stato appena creata.</span><span class="sxs-lookup"><span data-stu-id="1ca03-298">After completing the wizard, the TableAdapter has a new method available, `GetProductByProductID(productID)` that, when invoked, will execute the `Products_SelectByProductID` stored procedure that was just created.</span></span> <span data-ttu-id="1ca03-299">Richiedere qualche istante per visualizzare questa nuova stored procedure da Esplora Server drill-down della cartella Stored Procedures e aprendo `Products_SelectByProductID` (se non è visualizzato, fare doppio clic sulla cartella Stored procedure e scegliere Aggiorna).</span><span class="sxs-lookup"><span data-stu-id="1ca03-299">Take a moment to view this new stored procedure from the Server Explorer by drilling into the Stored Procedures folder and opening `Products_SelectByProductID` (if you do not see it, right-click on the Stored Procedures folder and choose Refresh).</span></span>

<span data-ttu-id="1ca03-300">Si noti che il `SelectByProductID` stored procedure accetta `@ProductID` come parametro di input ed esegue il `SELECT` istruzione che viene immesso nella procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="1ca03-300">Note that the `SelectByProductID` stored procedure takes `@ProductID` as an input parameter and executes the `SELECT` statement that we entered in the wizard.</span></span>


[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample10.sql)]

## <a name="step-6-creating-a-business-logic-layer-class"></a><span data-ttu-id="1ca03-301">Passaggio 6: Creazione di una classe di livello per la logica di Business</span><span class="sxs-lookup"><span data-stu-id="1ca03-301">Step 6: Creating a Business Logic Layer Class</span></span>

<span data-ttu-id="1ca03-302">In tutta la serie di esercitazioni sono state strived mantenere un'architettura a livelli in cui il livello di presentazione apportate tutte le chiamate a livello BLL (Business LOGIC Layer).</span><span class="sxs-lookup"><span data-stu-id="1ca03-302">Throughout the tutorial series we have strived to maintain a layered architecture in which the Presentation Layer made all of its calls to the Business Logic Layer (BLL).</span></span> <span data-ttu-id="1ca03-303">Per essere conformi a questa decisione progettuale, è necessario innanzitutto creare una classe BLL per il nuovo set di dati tipizzato prima che sia possibile accedere a dati del prodotto dal livello di presentazione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-303">In order to adhere to this design decision, we first need to create a BLL class for the new Typed DataSet before we can access product data from the Presentation Layer.</span></span>

<span data-ttu-id="1ca03-304">Creare un nuovo file di classe denominato `ProductsBLLWithSprocs.vb` nella `~/App_Code/BLL` cartella e aggiungervi il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="1ca03-304">Create a new class file named `ProductsBLLWithSprocs.vb` in the `~/App_Code/BLL` folder and add to it the following code:</span></span>


[!code-vb[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample11.vb)]

<span data-ttu-id="1ca03-305">Questa classe è in grado di simulare il `ProductsBLL` classe semantica dalle esercitazioni precedenti, ma utilizza il `ProductsTableAdapter` e `ProductsDataTable` oggetti dal `NorthwindWithSprocs` set di dati.</span><span class="sxs-lookup"><span data-stu-id="1ca03-305">This class mimics the `ProductsBLL` class semantics from earlier tutorials, but uses the `ProductsTableAdapter` and `ProductsDataTable` objects from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="1ca03-306">Ad esempio, anziché un `Imports NorthwindTableAdapters` istruzione all'inizio del file di classe come `ProductsBLL` affermativo, il `ProductsBLLWithSprocs` utilizzato dalla classe `Imports NorthwindWithSprocsTableAdapters`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-306">For example, rather than having a `Imports NorthwindTableAdapters` statement at the start of the class file as `ProductsBLL` does, the `ProductsBLLWithSprocs` class uses `Imports NorthwindWithSprocsTableAdapters`.</span></span> <span data-ttu-id="1ca03-307">Analogamente, il `ProductsDataTable` e `ProductsRow` gli oggetti utilizzati in questa classe sono preceduti il `NorthwindWithSprocs` dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="1ca03-307">Likewise, the `ProductsDataTable` and `ProductsRow` objects used in this class are prefixed with the `NorthwindWithSprocs` namespace.</span></span> <span data-ttu-id="1ca03-308">Il `ProductsBLLWithSprocs` classe fornisce due metodi, DAS `GetProducts` e `GetProductByProductID`, e i metodi per aggiungere, aggiornare ed eliminare un'istanza singola del prodotto.</span><span class="sxs-lookup"><span data-stu-id="1ca03-308">The `ProductsBLLWithSprocs` class provides two data access methods, `GetProducts` and `GetProductByProductID`, and methods to add, update, and delete a single product instance.</span></span>

## <a name="step-7-working-with-thenorthwindwithsprocsdataset-from-the-presentation-layer"></a><span data-ttu-id="1ca03-309">Passaggio 7: Utilizzo di`NorthwindWithSprocs`set di dati dal livello di presentazione</span><span class="sxs-lookup"><span data-stu-id="1ca03-309">Step 7: Working with the`NorthwindWithSprocs`DataSet from the Presentation Layer</span></span>

<span data-ttu-id="1ca03-310">A questo punto è stata creata DAL che utilizza stored procedure per accedere e modificare i dati del database sottostante.</span><span class="sxs-lookup"><span data-stu-id="1ca03-310">At this point we have created a DAL that uses stored procedures to access and modify the underlying database data.</span></span> <span data-ttu-id="1ca03-311">È stato creato anche un rudimentale BLL con i metodi per recuperare tutti i prodotti o un determinato prodotto insieme ai metodi per l'aggiunta, aggiornamento e l'eliminazione di prodotti.</span><span class="sxs-lookup"><span data-stu-id="1ca03-311">We have also built a rudimentary BLL with methods to retrieve all products or a particular product along with methods for adding, updating, and deleting products.</span></span> <span data-ttu-id="1ca03-312">Per arrotondare disattivata in questa esercitazione, s ti permettono di creare una pagina ASP.NET che usa la s BLL `ProductsBLLWithSprocs` classe per la visualizzazione, aggiornamento ed eliminazione di record.</span><span class="sxs-lookup"><span data-stu-id="1ca03-312">To round off this tutorial, let s create an ASP.NET page that uses the BLL s `ProductsBLLWithSprocs` class for displaying, updating, and deleting records.</span></span>

<span data-ttu-id="1ca03-313">Aprire il `NewSprocs.aspx` nella pagina la `AdvancedDAL` cartelle e trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione, denominarlo `Products`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-313">Open the `NewSprocs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, naming it `Products`.</span></span> <span data-ttu-id="1ca03-314">Il controllo GridView tag smart s scegliere da associare a un nuovo oggetto ObjectDataSource denominato `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-314">From the GridView s smart tag choose to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="1ca03-315">Configurare ObjectDataSource per usare il `ProductsBLLWithSprocs` classe, come illustrato nella figura 22.</span><span class="sxs-lookup"><span data-stu-id="1ca03-315">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class, as shown in Figure 22.</span></span>


<span data-ttu-id="1ca03-316">[![Configurare ObjectDataSource per usare la classe ProductsBLLWithSprocs](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image51.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-316">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image51.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image50.png)</span></span>

<span data-ttu-id="1ca03-317">**Figura 22**: Configurare ObjectDataSource per usare la `ProductsBLLWithSprocs` classe ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-317">**Figure 22**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image52.png))</span></span>


<span data-ttu-id="1ca03-318">L'elenco di riepilogo a discesa della scheda selezionare ha due opzioni `GetProducts` e `GetProductByProductID`.</span><span class="sxs-lookup"><span data-stu-id="1ca03-318">The drop-down list in the SELECT tab has two options, `GetProducts` and `GetProductByProductID`.</span></span> <span data-ttu-id="1ca03-319">Poiché si desidera visualizzare tutti i prodotti in GridView, scegliere il `GetProducts` (metodo).</span><span class="sxs-lookup"><span data-stu-id="1ca03-319">Since we want to display all products in the GridView, choose the `GetProducts` method.</span></span> <span data-ttu-id="1ca03-320">Gli elenchi a discesa nelle schede UPDATE, INSERT e DELETE presente un solo metodo.</span><span class="sxs-lookup"><span data-stu-id="1ca03-320">The drop-down lists in the UPDATE, INSERT, and DELETE tabs each only have one method.</span></span> <span data-ttu-id="1ca03-321">Assicurarsi che ciascuno di questi elenchi a discesa dispone di un metodo appropriato selezionato e quindi fare clic su Fine.</span><span class="sxs-lookup"><span data-stu-id="1ca03-321">Ensure that each of these drop-down lists has its appropriate method selected and then click Finish.</span></span>

<span data-ttu-id="1ca03-322">Dopo aver completato la procedura guidata ObjectDataSource, Visual Studio aggiungerà BoundField e un CampoCasellaDiControllo a GridView per i campi di dati del prodotto.</span><span class="sxs-lookup"><span data-stu-id="1ca03-322">After the ObjectDataSource wizard has completed, Visual Studio will add BoundFields and a CheckBoxField to the GridView for the product data fields.</span></span> <span data-ttu-id="1ca03-323">Attivare le funzionalità di eliminazione e GridView s incorporati di modifica selezionando le Abilita modifica e le opzioni Abilita eliminazione presente nello smart tag.</span><span class="sxs-lookup"><span data-stu-id="1ca03-323">Turn on the GridView s built-in editing and deleting features by checking the Enable Editing and Enable Deleting options present in the smart tag.</span></span>


<span data-ttu-id="1ca03-324">[![La pagina contiene un controllo GridView con modifica e l'eliminazione di supporto abilitato](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image54.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-324">[![The Page Contains a GridView with Editing and Deleting Support Enabled](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image54.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image53.png)</span></span>

<span data-ttu-id="1ca03-325">**Figura 23**: La pagina contiene un controllo GridView con modifica e l'eliminazione di supporto abilitato ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-325">**Figure 23**: The Page Contains a GridView with Editing and Deleting Support Enabled ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image55.png))</span></span>


<span data-ttu-id="1ca03-326">Come abbiamo ve illustrati nelle esercitazioni precedenti, al termine della procedura guidata ObjectDataSource s, set di Visual Studio il `OldValuesParameterFormatString` proprietà originale\_{0}.</span><span class="sxs-lookup"><span data-stu-id="1ca03-326">As we ve discussed in previous tutorials, at the completion of the ObjectDataSource s wizard, Visual Studio sets the `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="1ca03-327">Questa operazione deve essere ripristinato al valore predefinito di {0} affinché le funzionalità di modifica dei dati per il corretto funzionamento specificato i parametri previsti dai metodi nel nostro BLL.</span><span class="sxs-lookup"><span data-stu-id="1ca03-327">This needs to be reverted to its default value of {0} in order for the data modification features to work properly given the parameters expected by the methods in our BLL.</span></span> <span data-ttu-id="1ca03-328">Pertanto, assicurarsi di impostare il `OldValuesParameterFormatString` proprietà {0} oppure rimuovere completamente la proprietà con la sintassi dichiarativa.</span><span class="sxs-lookup"><span data-stu-id="1ca03-328">Therefore, be sure to set the `OldValuesParameterFormatString` property to {0} or remove the property altogether from the declarative syntax.</span></span>

<span data-ttu-id="1ca03-329">Dopo aver completato la procedura guidata Configura origine dati, attivare la modifica e l'eliminazione di supporto in GridView e restituendo la s ObjectDataSource `OldValuesParameterFormatString` proprietà sul valore predefinito, il markup dichiarativo pagina s dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="1ca03-329">After completing the Configure Data Source wizard, turning on editing and deleting support in the GridView, and returning the ObjectDataSource s `OldValuesParameterFormatString` property to its default value, your page s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample12.aspx)]

<span data-ttu-id="1ca03-330">A questo punto è stato possibile riordinarne GridView personalizzando l'interfaccia di modifica per includere la convalida, con la `CategoryID` e `SupplierID` sottoposti a rendering come controlli DropDownList, colonne e così via.</span><span class="sxs-lookup"><span data-stu-id="1ca03-330">At this point we could tidy up the GridView by customizing the editing interface to include validation, having the `CategoryID` and `SupplierID` columns render as DropDownLists, and so on.</span></span> <span data-ttu-id="1ca03-331">È anche possibile aggiungere una conferma lato client per il pulsante di eliminazione e ti invitiamo al tempo necessario per implementare tali miglioramenti.</span><span class="sxs-lookup"><span data-stu-id="1ca03-331">We could also add a client-side confirmation to the Delete button, and I encourage you to take the time to implement these enhancements.</span></span> <span data-ttu-id="1ca03-332">Poiché questi argomenti sono stati trattati nelle esercitazioni precedenti, tuttavia, non copriremo li nuovo qui.</span><span class="sxs-lookup"><span data-stu-id="1ca03-332">Since these topics have been covered in previous tutorials, however, we will not cover them again here.</span></span>

<span data-ttu-id="1ca03-333">Indipendentemente dal fatto che è ottimizzato GridView o non, testare le funzionalità di base di pagina s in un browser.</span><span class="sxs-lookup"><span data-stu-id="1ca03-333">Regardless of whether you enhance the GridView or not, test out the page s core features in a browser.</span></span> <span data-ttu-id="1ca03-334">Come illustrato nella figura 24, nella pagina vengono elencati i prodotti in un controllo GridView che fornisce ogni riga di modifica ed eliminazione di funzionalità.</span><span class="sxs-lookup"><span data-stu-id="1ca03-334">As Figure 24 shows, the page lists the products in a GridView that provides per-row editing and deleting capabilities.</span></span>


<span data-ttu-id="1ca03-335">[![I prodotti possono essere visualizzati, modificati ed eliminati dal controllo GridView.](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image57.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="1ca03-335">[![The Products Can Be Viewed, Edited, and Deleted from the GridView](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image57.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image56.png)</span></span>

<span data-ttu-id="1ca03-336">**Figura 24**: I prodotti possono essere visualizzati, modificata e Deleted da GridView ([fare clic per visualizzare l'immagine con dimensioni normali](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="1ca03-336">**Figure 24**: The Products Can Be Viewed, Edited, and Deleted from the GridView ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image58.png))</span></span>


## <a name="summary"></a><span data-ttu-id="1ca03-337">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="1ca03-337">Summary</span></span>

<span data-ttu-id="1ca03-338">Gli oggetti TableAdapter in un set di dati tipizzati possono accedere ai dati dal database tramite istruzioni SQL ad hoc o tramite le stored procedure.</span><span class="sxs-lookup"><span data-stu-id="1ca03-338">The TableAdapters in a Typed DataSet can access data from the database using ad-hoc SQL statements or through stored procedures.</span></span> <span data-ttu-id="1ca03-339">Quando si utilizzano le stored procedure, una stored procedure esistenti possono essere utilizzate o è possibile indicare la configurazione guidata TableAdapter per creare nuove stored procedure basate su un `SELECT` query.</span><span class="sxs-lookup"><span data-stu-id="1ca03-339">When working with stored procedures, either existing stored procedures can be used or the TableAdapter wizard can be instructed to create new stored procedures based on a `SELECT` query.</span></span> <span data-ttu-id="1ca03-340">In questa esercitazione è stato illustrato come le stored procedure vengono creati automaticamente per noi.</span><span class="sxs-lookup"><span data-stu-id="1ca03-340">In this tutorial we explored how to have the stored procedures automatically created for us.</span></span>

<span data-ttu-id="1ca03-341">Mantenendo le stored procedure generata automaticamente consente di risparmiare tempo, esistono casi in cui la stored procedure creata dalla procedura guidata t allineare con ciò che si sarebbero creati da soli.</span><span class="sxs-lookup"><span data-stu-id="1ca03-341">While having the stored procedures auto-generated helps save time, there are certain cases where the stored procedure created by the wizard doesn t align with what we would have created on our own.</span></span> <span data-ttu-id="1ca03-342">Un esempio è il `Products_Update` stored procedure, che sia previsto `@Original_ProductID` e `@ProductID` anche se i parametri di input di `@Original_ProductID` parametro è superfluo.</span><span class="sxs-lookup"><span data-stu-id="1ca03-342">One example is the `Products_Update` stored procedure, which expected both `@Original_ProductID` and `@ProductID` input parameters even though the `@Original_ProductID` parameter was superfluous.</span></span>

<span data-ttu-id="1ca03-343">In molti scenari, le stored procedure sia già state create oppure potrebbe essere necessario compilarle manualmente in modo da avere un miglior grado di controllare i comandi s stored procedure.</span><span class="sxs-lookup"><span data-stu-id="1ca03-343">In many scenarios, the stored procedures may already have been created, or we may want to build them manually so as to have a finer degree of control over the stored procedure s commands.</span></span> <span data-ttu-id="1ca03-344">In entrambi i casi, si potrebbe richiedere del TableAdapter utilizzare stored procedure esistenti per i relativi metodi.</span><span class="sxs-lookup"><span data-stu-id="1ca03-344">In either case, we would want to instruct the TableAdapter to use existing stored procedures for its methods.</span></span> <span data-ttu-id="1ca03-345">Vogliamo vediamo come eseguire questa operazione nella prossima esercitazione.</span><span class="sxs-lookup"><span data-stu-id="1ca03-345">We shall see how to accomplish this in the next tutorial.</span></span>

<span data-ttu-id="1ca03-346">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="1ca03-346">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="1ca03-347">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="1ca03-347">Further Reading</span></span>

<span data-ttu-id="1ca03-348">Per altre informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="1ca03-348">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- <span data-ttu-id="1ca03-349">[Creazione e gestione le Stored procedure](https://msdn.microsoft.com/library/aa214299(SQL.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="1ca03-349">[Creating and Maintaining Stored Procedures](https://msdn.microsoft.com/library/aa214299(SQL.80).aspx)</span></span>
- [<span data-ttu-id="1ca03-350">Il recupero di dati scalare da una Stored Procedure</span><span class="sxs-lookup"><span data-stu-id="1ca03-350">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)
- [<span data-ttu-id="1ca03-351">Stored Procedure nozioni di base di SQL Server</span><span class="sxs-lookup"><span data-stu-id="1ca03-351">SQL Server Stored Procedure Basics</span></span>](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1)
- [<span data-ttu-id="1ca03-352">Stored procedure: Una panoramica</span><span class="sxs-lookup"><span data-stu-id="1ca03-352">Stored Procedures: An Overview</span></span>](http://www.sqlteam.com/item.asp?ItemID=563)
- [<span data-ttu-id="1ca03-353">La scrittura di una Stored Procedure</span><span class="sxs-lookup"><span data-stu-id="1ca03-353">Writing a Stored Procedure</span></span>](http://www.4guysfromrolla.com/webtech/111499-1.shtml)

## <a name="about-the-author"></a><span data-ttu-id="1ca03-354">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="1ca03-354">About the Author</span></span>

<span data-ttu-id="1ca03-355">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="1ca03-355">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1ca03-356">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="1ca03-356">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1ca03-357">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="1ca03-357">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1ca03-358">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1ca03-358">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1ca03-359">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="1ca03-359">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="1ca03-360">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="1ca03-360">Special Thanks To</span></span>

<span data-ttu-id="1ca03-361">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="1ca03-361">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="1ca03-362">Il revisore capo di questa esercitazione è stata Hilton Geisenow.</span><span class="sxs-lookup"><span data-stu-id="1ca03-362">Lead reviewer for this tutorial was Hilton Geisenow.</span></span> <span data-ttu-id="1ca03-363">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="1ca03-363">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="1ca03-364">In questo caso, Inviami una riga in corrispondenza [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1ca03-364">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1ca03-365">[Precedente](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs.md)
> [Successivo](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)</span><span class="sxs-lookup"><span data-stu-id="1ca03-365">[Previous](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs.md)
[Next](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)</span></span>
