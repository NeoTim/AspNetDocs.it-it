---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
title: Aggiunta di una conferma lato Client durante l'eliminazione (VB) | Microsoft Docs
author: rick-anderson
description: Nelle interfacce che abbiamo creato finora, un utente può eliminare accidentalmente dei dati facendo clic sul pulsante Elimina quando si intende fare clic sul pulsante Modifica. In questo t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 6331e02e-c465-4cdf-bd3f-f07680c289d6
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: fc5c99ce6c5da7d004b95462a3338aefbed31b36
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/17/2019
ms.locfileid: "59388712"
---
# <a name="adding-client-side-confirmation-when-deleting-vb"></a><span data-ttu-id="9a4ca-104">Aggiunta di una conferma lato client durante l'eliminazione (VB)</span><span class="sxs-lookup"><span data-stu-id="9a4ca-104">Adding Client-Side Confirmation When Deleting (VB)</span></span>

<span data-ttu-id="9a4ca-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9a4ca-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9a4ca-106">[Scaricare l'App di esempio](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) o [Scarica il PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="9a4ca-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) or [Download PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span></span>

> <span data-ttu-id="9a4ca-107">Nelle interfacce che abbiamo creato finora, un utente può eliminare accidentalmente dei dati facendo clic sul pulsante Elimina quando si intende fare clic sul pulsante Modifica.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-107">In the interfaces we've created so far, a user can accidentally delete data by clicking the Delete button when they meant to click the Edit button.</span></span> <span data-ttu-id="9a4ca-108">In questa esercitazione si aggiungerà una finestra di dialogo di conferma lato client che viene visualizzato quando si fa clic sul pulsante Elimina.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-108">In this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>


## <a name="introduction"></a><span data-ttu-id="9a4ca-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="9a4ca-109">Introduction</span></span>

<span data-ttu-id="9a4ca-110">Tramite le varie esercitazioni precedenti abbiamo ve appreso come usare l'architettura delle applicazioni, ObjectDataSource e i controlli Web dei dati insieme per fornire l'inserimento, la modifica e l'eliminazione di funzionalità.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-110">Over the past several tutorials we ve seen how to use our application architecture, ObjectDataSource, and the data Web controls in concert to provide inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="9a4ca-111">L'eliminazione di interfacce è stato esaminato finora sono stati composto da un'operazione di eliminazione pulsante che, quando selezionato, causa un postback e richiama gli oggetti ObjectDataSource `Delete()` (metodo).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-111">The deleting interfaces we ve examined thus far have been composed of a Delete button that, when clicked, causes a postback and invokes the ObjectDataSource s `Delete()` method.</span></span> <span data-ttu-id="9a4ca-112">Il `Delete()` metodo richiama quindi il metodo configurato dal livello della logica di Business, che propaga la chiamata al livello di accesso ai dati, emissione effettiva `DELETE` istruzione per il database.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-112">The `Delete()` method then invokes the configured method from the Business Logic Layer, which propagates the call down to the Data Access Layer, issuing the actual `DELETE` statement to the database.</span></span>

<span data-ttu-id="9a4ca-113">Anche se questa interfaccia utente consente visitatori eliminare i record tra i controlli GridView, DetailsView e FormView, non l'ha una sorta di conferma quando l'utente fa clic sul pulsante Elimina.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-113">While this user interface enables visitors to delete records through the GridView, DetailsView, or FormView controls, it lacks any sort of confirmation when the user clicks the Delete button.</span></span> <span data-ttu-id="9a4ca-114">Se un utente fa clic accidentalmente il pulsante di eliminazione quando si intende fare clic su Modifica, verrà eliminato invece il record che si intende aggiornare.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-114">If a user accidentally clicks the Delete button when they meant to click Edit, the record they meant to update will instead be deleted.</span></span> <span data-ttu-id="9a4ca-115">Per evitare ciò, in questa esercitazione si aggiungerà una finestra di dialogo di conferma lato client che viene visualizzato quando si fa clic sul pulsante Elimina.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-115">To help prevent this, in this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

<span data-ttu-id="9a4ca-116">Il codice JavaScript `confirm(string)` funzione consente di visualizzare il parametro di input di stringa come testo all'interno di una finestra di dialogo modale che è dotato di due pulsanti - OK e Cancel (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-116">The JavaScript `confirm(string)` function displays its string input parameter as the text inside a modal dialog box that comes equipped with two buttons - OK and Cancel (see Figure 1).</span></span> <span data-ttu-id="9a4ca-117">Il `confirm(string)` funzione restituisce un valore booleano in base alla quale pulsante (`true`, se l'utente fa clic su OK, e `false` se si fa clic su Annulla).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-117">The `confirm(string)` function returns a Boolean value depending on what button is clicked (`true`, if the user clicks OK, and `false` if they click Cancel).</span></span>


![Il confirm(string) JavaScript (metodo) Visualizza una finestra modale, Messagebox lato Client](adding-client-side-confirmation-when-deleting-vb/_static/image1.png)

<span data-ttu-id="9a4ca-119">**Figura 1**: Il codice JavaScript `confirm(string)` metodo visualizza una finestra di messaggio modale, lato Client</span><span class="sxs-lookup"><span data-stu-id="9a4ca-119">**Figure 1**: The JavaScript `confirm(string)` Method Displays a Modal, Client-Side Messagebox</span></span>


<span data-ttu-id="9a4ca-120">Durante l'invio di un modulo, se il valore `false` viene restituito da un gestore eventi lato client, l'invio del form è stata annullata.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-120">During a form submission, if a value of `false` is returned from a client-side event handler then the form submission is cancelled.</span></span> <span data-ttu-id="9a4ca-121">Utilizzare questa funzionalità, possiamo avere Delete pulsante s lato client `onclick` gestore eventi restituire il valore di una chiamata a `confirm("Are you sure you want to delete this product?")`.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-121">Using this feature, we can have the Delete button s client-side `onclick` event handler return the value of a call to `confirm("Are you sure you want to delete this product?")`.</span></span> <span data-ttu-id="9a4ca-122">Se l'utente fa clic su Annulla, `confirm(string)` restituirà false, in tal modo che causa l'invio del modulo annullare.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-122">If the user clicks Cancel, `confirm(string)` will return false, thereby causing the form submission to cancel.</span></span> <span data-ttu-id="9a4ca-123">Con alcun postback, il prodotto è stato fatto clic sul pulsante la cui eliminazione non verrà eliminato.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-123">With no postback, the product whose Delete button was clicked won't be deleted.</span></span> <span data-ttu-id="9a4ca-124">Se, tuttavia, l'utente fa clic su OK nella finestra di dialogo di conferma, il postback continueranno maniera e verrà eliminato il prodotto.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-124">If, however, the user clicks OK in the confirmation dialog box, the postback will continue unabated and the product will be deleted.</span></span> <span data-ttu-id="9a4ca-125">Consultare [uso di JavaScript s `confirm()` metodo per l'invio di Form di controllo](http://www.webreference.com/programming/javascript/confirm/) per altre informazioni su questa tecnica.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-125">Consult [Using JavaScript s `confirm()` Method to Control Form Submission](http://www.webreference.com/programming/javascript/confirm/) for more information on this technique.</span></span>

<span data-ttu-id="9a4ca-126">Aggiungere lo script lato client necessario differisce leggermente se usano i modelli rispetto all'uso di un CommandField.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-126">Adding the necessary client-side script differs slightly if using templates than when using a CommandField.</span></span> <span data-ttu-id="9a4ca-127">Pertanto, in questa esercitazione si esaminerà esempio un controllo FormView e GridView.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-127">Therefore, in this tutorial we will look at both a FormView and GridView example.</span></span>

> [!NOTE]
> <span data-ttu-id="9a4ca-128">Usa tecniche di conferma lato client, come quelle descritte in questa esercitazione si presuppone che gli utenti vengono visitate con i browser che supportano JavaScript e che siano presenti JavaScript abilitato.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-128">Using client-side confirmation techniques, like the ones discussed in this tutorial, assumes that your users are visiting with browsers that support JavaScript and that they have JavaScript enabled.</span></span> <span data-ttu-id="9a4ca-129">Se uno di questi presupposti non sono true per un utente specifico, facendo clic sul pulsante Elimina immediatamente causa un postback (non la visualizzazione di una finestra di messaggio di conferma).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-129">If either of these assumptions are not true for a particular user, clicking the Delete button will immediately cause a postback (not displaying a confirm messagebox).</span></span>


## <a name="step-1-creating-a-formview-that-supports-deletion"></a><span data-ttu-id="9a4ca-130">Passaggio 1: Creazione di un controllo FormView che supporta l'eliminazione</span><span class="sxs-lookup"><span data-stu-id="9a4ca-130">Step 1: Creating a FormView That Supports Deletion</span></span>

<span data-ttu-id="9a4ca-131">Iniziare aggiungendo un controllo FormView per il `ConfirmationOnDelete.aspx` nella pagina la `EditInsertDelete` cartella, associarla a un nuovo oggetto ObjectDataSource che esegue il pull nuovamente le informazioni sul prodotto tramite il `ProductsBLL` classe s `GetProducts()` (metodo).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-131">Start by adding a FormView to the `ConfirmationOnDelete.aspx` page in the `EditInsertDelete` folder, binding it to a new ObjectDataSource that pulls back the product information via the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="9a4ca-132">Inoltre configurare ObjectDataSource in modo che il `ProductsBLL` classe s `DeleteProduct(productID)` metodo viene eseguito il mapping agli oggetti ObjectDataSource `Delete()` metodo; assicurarsi che le schede INSERT e UPDATE elenchi a discesa sono impostati su (nessuno).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-132">Also configure the ObjectDataSource so that the `ProductsBLL` class s `DeleteProduct(productID)` method is mapped to the ObjectDataSource s `Delete()` method; ensure that the INSERT and UPDATE tabs drop-down lists are set to (None).</span></span> <span data-ttu-id="9a4ca-133">Infine, controllare la casella di controllo Attiva Paging nello smart tag FormView s.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-133">Finally, check the Enable Paging checkbox in the FormView s smart tag.</span></span>

<span data-ttu-id="9a4ca-134">Dopo questi passaggi, il nuovo markup dichiarativo di ObjectDataSource s avrà un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="9a4ca-134">After these steps, the new ObjectDataSource s declarative markup will look like the following:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample1.aspx)]

<span data-ttu-id="9a4ca-135">Come negli esempi precedenti che non è stata utilizzata la concorrenza ottimistica, si consiglia di cancellare i dispositivi di ObjectDataSource `OldValuesParameterFormatString` proprietà.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-135">As in our past examples that did not use optimistic concurrency, take a moment to clear out the ObjectDataSource s `OldValuesParameterFormatString` property.</span></span>

<span data-ttu-id="9a4ca-136">Poiché è stato associato a un controllo ObjectDataSource che supporta solo l'eliminazione, la s FormView `ItemTemplate` offre solo il pulsante di eliminazione, se ne manca i pulsanti New e Update.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-136">Since it has been bound to an ObjectDataSource control that only supports deleting, the FormView s `ItemTemplate` offers only the Delete button, lacking the New and Update buttons.</span></span> <span data-ttu-id="9a4ca-137">FormView s dichiarativo, tuttavia, include una superflua `EditItemTemplate` e `InsertItemTemplate`, che può essere rimosso.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-137">The FormView s declarative markup, however, includes a superfluous `EditItemTemplate` and `InsertItemTemplate`, which can be removed.</span></span> <span data-ttu-id="9a4ca-138">Si consiglia di personalizzare il `ItemTemplate` in modo che sia illustra solo un subset del prodotto dei campi dati.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-138">Take a moment to customize the `ItemTemplate` so that is shows only a subset of the product data fields.</span></span> <span data-ttu-id="9a4ca-139">Si va configurato data mining per visualizzare il nome del prodotto s in un `<h3>` intestazione sopra i nomi di categoria e fornitore (con il pulsante Elimina).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-139">I ve configured mine to show the product s name in an `<h3>` heading above its supplier and category names (along with the Delete button).</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="9a4ca-140">Con queste modifiche, è disponibile una pagina web completamente funzionale che consente agli utenti di passare tra i prodotti uno alla volta, con la possibilità di eliminare un prodotto facendo semplicemente clic sul pulsante Elimina.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-140">With these changes, we have a fully functional web page that allows a user to toggle through the products one at a time, with the ability to delete a product by simply clicking the Delete button.</span></span> <span data-ttu-id="9a4ca-141">Figura 2 mostra una cattura di schermata dello stato di avanzamento fino ad ora, quando viene visualizzato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-141">Figure 2 shows a screen shot of our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="9a4ca-142">[![FormView mostra le informazioni su un solo prodotto](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="9a4ca-142">[![The FormView Shows Information About a Single Product](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span></span>

<span data-ttu-id="9a4ca-143">**Figura 2**: FormView mostra informazioni su un singolo prodotto ([fare clic per visualizzare l'immagine con dimensioni normali](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="9a4ca-143">**Figure 2**: The FormView Shows Information About a Single Product ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span></span>


## <a name="step-2-calling-the-confirmstring-function-from-the-delete-buttons-client-side-onclick-event"></a><span data-ttu-id="9a4ca-144">Passaggio 2: Chiamata di confirm(string) funzione da onclick di eliminare i pulsanti lato Client evento</span><span class="sxs-lookup"><span data-stu-id="9a4ca-144">Step 2: Calling the confirm(string) Function from the Delete Buttons Client-Side onclick Event</span></span>

<span data-ttu-id="9a4ca-145">Con il controllo FormView creato, il passaggio finale consiste nel configurare il pulsante Elimina tali che, se si s fa clic con il visitatore, il codice JavaScript sul `confirm(string)` funzione viene richiamata.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-145">With the FormView created, the final step is to configure the Delete button such that when it s clicked by the visitor, the JavaScript `confirm(string)` function is invoked.</span></span> <span data-ttu-id="9a4ca-146">Aggiunta di script sul lato client a un pulsante, LinkButton e ImageButton s client-side `onclick` evento può essere eseguito tramite l'uso del `OnClientClick property`, che è una novità di ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-146">Adding client-side script to a Button, LinkButton, or ImageButton s client-side `onclick` event can be accomplished through the use of the `OnClientClick property`, which is new to ASP.NET 2.0.</span></span> <span data-ttu-id="9a4ca-147">Poiché si vuole che il valore della `confirm(string)` restituito di funzione, è sufficiente impostare questa proprietà: `return confirm('Are you certain that you want to delete this product?');`</span><span class="sxs-lookup"><span data-stu-id="9a4ca-147">Since we want to have the value of the `confirm(string)` function returned, simply set this property to: `return confirm('Are you certain that you want to delete this product?');`</span></span>

<span data-ttu-id="9a4ca-148">Dopo questa modifica, la sintassi dichiarativa s eliminare LinkButton dovrebbe essere simile:</span><span class="sxs-lookup"><span data-stu-id="9a4ca-148">After this change the Delete LinkButton s declarative syntax should look something like:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="9a4ca-149">Che s ne è a esso.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-149">That s all there is to it!</span></span> <span data-ttu-id="9a4ca-150">Figura 3 mostra una schermata di questa conferma in azione.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-150">Figure 3 shows a screen shot of this confirmation in action.</span></span> <span data-ttu-id="9a4ca-151">Facendo clic sul pulsante Elimina viene visualizzata la finestra di dialogo di conferma.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-151">Clicking the Delete button brings up the confirm dialog box.</span></span> <span data-ttu-id="9a4ca-152">Se l'utente fa clic su Annulla, viene annullato il postback e il prodotto non viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-152">If the user clicks Cancel, the postback is cancelled and the product is not deleted.</span></span> <span data-ttu-id="9a4ca-153">Se, tuttavia, l'utente fa clic su OK, continua il postback e gli oggetti ObjectDataSource `Delete()` metodo viene richiamato, che si conclude con il record del database in corso l'eliminazione.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-153">If, however, the user clicks OK, the postback continues and the ObjectDataSource s `Delete()` method is invoked, culminating in the database record being deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="9a4ca-154">La stringa passata nel `confirm(string)` funzione JavaScript è delimitato da apostrofi (anziché le virgolette).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-154">The string passed into the `confirm(string)` JavaScript function is delimited with apostrophes (rather than quotation marks).</span></span> <span data-ttu-id="9a4ca-155">In JavaScript, le stringhe possono essere delimitati da un carattere.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-155">In JavaScript, strings can be delimited using either character.</span></span> <span data-ttu-id="9a4ca-156">Usiamo apostrofi qui in modo che i delimitatori per la stringa passati `confirm(string)` non introducono ambiguità con i delimitatori utilizzati per il `OnClientClick` valore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-156">We use apostrophes here so that the delimiters for the string passed into `confirm(string)` do not introduce an ambiguity with the delimiters used for the `OnClientClick` property value.</span></span>


<span data-ttu-id="9a4ca-157">[![Un messaggio di conferma viene ora visualizzata quando facendo clic sul pulsante Elimina](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="9a4ca-157">[![A Confirmation is Now Displayed When Clicking the Delete Button](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="9a4ca-158">**Figura 3**: Un messaggio di conferma viene ora visualizzata quando si fa clic su Delete ([fare clic per visualizzare l'immagine con dimensioni normali](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="9a4ca-158">**Figure 3**: A Confirmation is Now Displayed When Clicking the Delete Button ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span></span>


## <a name="step-3-configuring-the-onclientclick-property-for-the-delete-button-in-a-commandfield"></a><span data-ttu-id="9a4ca-159">Passaggio 3: Configura la proprietà OnClientClick per il pulsante Elimina in un CommandField</span><span class="sxs-lookup"><span data-stu-id="9a4ca-159">Step 3: Configuring the OnClientClick Property for the Delete Button in a CommandField</span></span>

<span data-ttu-id="9a4ca-160">Quando si lavora con un pulsante, LinkButton e ImageButton direttamente in un modello, una finestra di dialogo di conferma può essere associata ad esso configurando semplicemente relativi `OnClientClick` proprietà per restituire i risultati del codice JavaScript `confirm(string)` (funzione).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-160">When working with a Button, LinkButton, or ImageButton directly in a template, a confirmation dialog box can be associated with it by simply configuring its `OnClientClick` property to return the results of the JavaScript `confirm(string)` function.</span></span> <span data-ttu-id="9a4ca-161">Tuttavia, non dispone di CommandField, che aggiunge un campo di pulsanti di eliminazione a un controllo GridView o DetailsView - un `OnClientClick` proprietà che può essere impostata in modo dichiarativo.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-161">However, the CommandField - which adds a field of Delete buttons to a GridView or DetailsView - does not have an `OnClientClick` property that can be set declaratively.</span></span> <span data-ttu-id="9a4ca-162">In alternativa, è necessario a livello di codice fare riferimento a sul pulsante Elimina in s GridView o DetailsView appropriato `DataBound` gestore dell'evento e quindi impostare relativo `OnClientClick` proprietà non esiste.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-162">Instead, we must programmatically reference the Delete button in the GridView or DetailsView s appropriate `DataBound` event handler, and then set its `OnClientClick` property there.</span></span>

> [!NOTE]
> <span data-ttu-id="9a4ca-163">Quando si imposta il pulsante Elimina s `OnClientClick` proprietà nelle rispettive caselle `DataBound` gestore eventi, è possibile accedere a dati è stati associati al record corrente.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-163">When setting the Delete button s `OnClientClick` property in the appropriate `DataBound` event handler, we have access to the data was bound to the current record.</span></span> <span data-ttu-id="9a4ca-164">Ciò significa che è possibile estendere il messaggio di conferma per includere i dettagli del record specifico, ad esempio, "Sono certi di che voler eliminare il prodotto Chai?"</span><span class="sxs-lookup"><span data-stu-id="9a4ca-164">This means we can extend the confirmation message to include details about the particular record, such as, "Are you sure you want to delete the Chai product?"</span></span> <span data-ttu-id="9a4ca-165">Queste attività di personalizzazione è anche possibile nei modelli usando la sintassi di associazione dati.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-165">Such customization is also possible in templates using databinding syntax.</span></span>


<span data-ttu-id="9a4ca-166">Impostazione di procedure consigliate di `OnClientClick` proprietà per l'aziona Delete in una CommandField, s "Let" aggiungere un controllo GridView alla pagina.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-166">To practice setting the `OnClientClick` property for the Delete button(s) in a CommandField, let s add a GridView to the page.</span></span> <span data-ttu-id="9a4ca-167">Configurare il controllo GridView per usare lo stesso controllo ObjectDataSource che utilizza il controllo FormView.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-167">Configure this GridView to use the same ObjectDataSource control that the FormView uses.</span></span> <span data-ttu-id="9a4ca-168">Anche limitare i dispositivi di GridView BoundField per includere solo la s nome prodotto, categoria e fornitore.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-168">Also limit the GridView s BoundFields to only include the product s name, category, and supplier.</span></span> <span data-ttu-id="9a4ca-169">Infine, controllare la casella di controllo Abilita eliminazione nello smart tag s GridView.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-169">Lastly, check the Enable Deleting checkbox from the GridView s smart tag.</span></span> <span data-ttu-id="9a4ca-170">Verrà aggiunto un CommandField al s GridView `Columns` raccolta con il relativo `ShowDeleteButton` impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-170">This will add a CommandField to the GridView s `Columns` collection with its `ShowDeleteButton` property set to `true`.</span></span>

<span data-ttu-id="9a4ca-171">Dopo aver apportato queste modifiche, il markup dichiarativo di GridView s dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="9a4ca-171">After making these changes, your GridView s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample4.aspx)]

<span data-ttu-id="9a4ca-172">Il CommandField contiene una singola istanza di LinkButton eliminazione che è possibile accedere a livello di codice da s GridView `RowDataBound` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-172">The CommandField contains a single Delete LinkButton instance that can be accessed programmatically from the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="9a4ca-173">Dopo aver fatto riferimento, è possibile impostare relativo `OnClientClick` proprietà conseguenza.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-173">Once referenced, we can set its `OnClientClick` property accordingly.</span></span> <span data-ttu-id="9a4ca-174">Creare un gestore eventi per il `RowDataBound` eventi usando il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="9a4ca-174">Create an event handler for the `RowDataBound` event using the following code:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample5.vb)]

<span data-ttu-id="9a4ca-175">Questo gestore di evento funziona con le righe di dati (quelli che avrà il pulsante Elimina) e inizia a livello di codice facendo clic sul pulsante Elimina.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-175">This event handler works with data rows (those that will have the Delete button) and begins by programmatically referencing the Delete button.</span></span> <span data-ttu-id="9a4ca-176">In generale, usare il modello seguente:</span><span class="sxs-lookup"><span data-stu-id="9a4ca-176">In general use the following pattern:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="9a4ca-177">*ButtonType* è il tipo di pulsante utilizzato da CommandField - pulsante, LinkButton e ImageButton.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-177">*ButtonType* is the type of button being used by the CommandField - Button, LinkButton, or ImageButton.</span></span> <span data-ttu-id="9a4ca-178">Per impostazione predefinita, il CommandField Usa i controlli LinkButton, ma può essere personalizzato tramite gli oggetti CommandField `ButtonType property`.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-178">By default, the CommandField uses LinkButtons, but this can be customized via the CommandField s `ButtonType property`.</span></span> <span data-ttu-id="9a4ca-179">Il *commandFieldIndex* è l'indice ordinale del CommandField entro la s GridView `Columns` insieme, mentre il *controlIndex* è l'indice del pulsante di eliminazione entro la s CommandField `Controls` raccolta.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-179">The *commandFieldIndex* is the ordinal index of the CommandField within the GridView s `Columns` collection, whereas the *controlIndex* is the index of the Delete button within the CommandField s `Controls` collection.</span></span> <span data-ttu-id="9a4ca-180">Il *controlIndex* valore dipende la posizione del pulsante s rispetto agli altri pulsanti nella CommandField.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-180">The *controlIndex* value depends on the button s position relative to other buttons in the CommandField.</span></span> <span data-ttu-id="9a4ca-181">Ad esempio, se l'unico pulsante visualizzato nella finestra di CommandField è il pulsante di eliminazione, usare un indice pari a 0.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-181">For example, if the only button displayed in the CommandField is the Delete button, use an index of 0.</span></span> <span data-ttu-id="9a4ca-182">Se, tuttavia, ci un pulsante di modifica che precede il pulsante di eliminazione, usare un indice di 2.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-182">If, however, there s an Edit button that precedes the Delete button, use an index of 2.</span></span> <span data-ttu-id="9a4ca-183">Il motivo viene usato un indice pari a 2 è che vengono aggiunti due controlli per il CommandField prima del pulsante di eliminazione: il pulsante di modifica e LiteralControl tale s utilizzato per aggiungere alcuni spazi tra i pulsanti di modifica ed eliminazione.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-183">The reason an index of 2 is used is because two controls are added by the CommandField before the Delete button: the Edit button and a LiteralControl that s used to add some space between the Edit and Delete buttons.</span></span>

<span data-ttu-id="9a4ca-184">Per questo particolare esempio, il CommandField Usa LinkButton e, in corso il campo più a sinistra ha un *commandFieldIndex* pari a 0.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-184">For our particular example, the CommandField uses LinkButtons and, being the left-most field, has a *commandFieldIndex* of 0.</span></span> <span data-ttu-id="9a4ca-185">Poiché sono presenti sul pulsante Elimina nel CommandField ma non altri pulsanti, usiamo una *controlIndex* pari a 0.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-185">Since there are no other buttons but the Delete button in the CommandField, we use a *controlIndex* of 0.</span></span>

<span data-ttu-id="9a4ca-186">Dopo aver fatto riferimento il pulsante Elimina nel CommandField, si ottiene quindi le informazioni sul prodotto associato alla riga corrente di GridView.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-186">After referencing the Delete button in the CommandField, we next grab information about the product bound to the current GridView row.</span></span> <span data-ttu-id="9a4ca-187">Infine, impostiamo il pulsante Elimina s `OnClientClick` proprietà JavaScript appropriato, che include il nome del prodotto s.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-187">Finally, we set the Delete button s `OnClientClick` property to the appropriate JavaScript, which includes the product s name.</span></span> <span data-ttu-id="9a4ca-188">Poiché la stringa di JavaScript passato il `confirm(string)` funzione delimitata usando apostrofi è necessario eseguire l'escape qualsiasi apostrofi visualizzati all'interno del nome di prodotto s.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-188">Since the JavaScript string passed into the `confirm(string)` function is delimited using apostrophes we must escape any apostrophes that appear within the product s name.</span></span> <span data-ttu-id="9a4ca-189">In particolare, qualsiasi apostrofi nel nome del prodotto s sono preceduti da "`\'`".</span><span class="sxs-lookup"><span data-stu-id="9a4ca-189">In particular, any apostrophes in the product s name are escaped with "`\'`".</span></span>

<span data-ttu-id="9a4ca-190">Con queste modifiche completate, facendo clic sul pulsante Elimina in GridView Visualizza una finestra di dialogo di conferma personalizzata casella (vedere la figura 4).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-190">With these changes complete, clicking on a Delete button in the GridView displays a customized confirmation dialog box (see Figure 4).</span></span> <span data-ttu-id="9a4ca-191">Come con il messagebox conferma di FormView, se l'utente fa clic su Annulla il postback è stato annullato, impedendo in tal modo l'eliminazione che si verifichi.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-191">As with the confirmation messagebox from the FormView, if the user clicks Cancel the postback is cancelled, thereby preventing the deletion from occurring.</span></span>

> [!NOTE]
> <span data-ttu-id="9a4ca-192">Questa tecnica può essere utilizzata anche per accedere a livello di codice al pulsante di eliminazione in CommandField in un controllo DetailsView.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-192">This technique can also be used to programmatically access the Delete button in the CommandField in a DetailsView.</span></span> <span data-ttu-id="9a4ca-193">Per DetailsView, tuttavia, è il d creare un gestore eventi per il `DataBound` evento, poiché non esiste un DetailsView un `RowDataBound` evento.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-193">For the DetailsView, however, you d create an event handler for the `DataBound` event, since the DetailsView does not have a `RowDataBound` event.</span></span>


<span data-ttu-id="9a4ca-194">[![Facendo clic sul pulsante Elimina s GridView Visualizza una finestra di dialogo di conferma personalizzata](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="9a4ca-194">[![Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span></span>

<span data-ttu-id="9a4ca-195">**Figura 4**: Facendo clic sul pulsante Elimina s GridView Visualizza una finestra di dialogo di conferma personalizzata ([fare clic per visualizzare l'immagine con dimensioni normali](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="9a4ca-195">**Figure 4**: Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span></span>


## <a name="using-templatefields"></a><span data-ttu-id="9a4ca-196">Uso di TemplateFields</span><span class="sxs-lookup"><span data-stu-id="9a4ca-196">Using TemplateFields</span></span>

<span data-ttu-id="9a4ca-197">Uno degli svantaggi del CommandField è che i pulsanti è possibile accedervi tramite l'indicizzazione e che l'oggetto risultante deve essere impostata sul tipo di pulsante appropriato (pulsante, LinkButton e ImageButton).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-197">One of the disadvantages of the CommandField is that its buttons must be accessed through indexing and that the resulting object must be cast to the appropriate button type (Button, LinkButton, or ImageButton).</span></span> <span data-ttu-id="9a4ca-198">Utilizzo di "numeri chiave" e tipi a livello di codice invita i problemi che non è possibile individuare fino al runtime.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-198">Using "magic numbers" and hard-coded types invites problems that cannot be discovered until runtime.</span></span> <span data-ttu-id="9a4ca-199">Ad esempio, se è o un altro sviluppatore, aggiunge nuovi pulsanti alla finestra di CommandField a un certo punto in futuro (ad esempio un pulsante di modifica) o le modifiche di `ButtonType` proprietà, il codice esistente verrà comunque compilato senza errori, ma visitando la pagina potrebbe causare un'eccezione o un comportamento imprevisto, a seconda del modo in cui è stato scritto il codice e le modifiche apportate.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-199">For example, if you, or another developer, adds new buttons to the CommandField at some point in the future (such as an Edit button) or changes the `ButtonType` property, the existing code will still compile without error, but visiting the page may cause an exception or unexpected behavior, depending on how your code was written and what changes were made.</span></span>

<span data-ttu-id="9a4ca-200">Un approccio alternativo consiste nel convertire la s GridView e DetailsView CommandFields in TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-200">An alternative approach is to convert the GridView and DetailsView s CommandFields into TemplateFields.</span></span> <span data-ttu-id="9a4ca-201">Verrà generato un TemplateField con un `ItemTemplate` che ha un LinkButton (o sul pulsante o ImageButton) per ciascun pulsante nel CommandField.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-201">This will generate a TemplateField with an `ItemTemplate` that has a LinkButton (or Button or ImageButton) for each button in the CommandField.</span></span> <span data-ttu-id="9a4ca-202">Questi pulsanti `OnClientClick` delle proprietà possono essere assegnate in modo dichiarativo, come abbiamo visto con FormView o sono accessibili a livello di codice nelle rispettive caselle `DataBound` gestore eventi usando il modello seguente:</span><span class="sxs-lookup"><span data-stu-id="9a4ca-202">These buttons `OnClientClick` properties can be assigned declaratively, as we saw with the FormView, or can be programmatically accessed in the appropriate `DataBound` event handler using the following pattern:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="9a4ca-203">In cui *controlID* è il valore del pulsante s `ID` proprietà.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-203">Where *controlID* is the value of the button s `ID` property.</span></span> <span data-ttu-id="9a4ca-204">Mentre questo modello richiede comunque un tipo a livello di codice per il cast, Elimina la necessità per l'indicizzazione, consentendo il layout modificare senza causando un errore di runtime.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-204">While this pattern still requires a hard-coded type for the cast, it removes the need for indexing, allowing for the layout to change without resulting in a runtime error.</span></span>

## <a name="summary"></a><span data-ttu-id="9a4ca-205">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="9a4ca-205">Summary</span></span>

<span data-ttu-id="9a4ca-206">Il codice JavaScript `confirm(string)` funzione è una tecnica comunemente utilizzata per il controllo del flusso di lavoro invio dei form.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-206">The JavaScript `confirm(string)` function is a commonly used technique for controlling form submission workflow.</span></span> <span data-ttu-id="9a4ca-207">Quando viene eseguita, la funzione consente di visualizzare una finestra di dialogo modale, sul lato client, che include due pulsanti OK e Annulla.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-207">When executed, the function displays a modal, client-side dialog box that includes two buttons, OK and Cancel.</span></span> <span data-ttu-id="9a4ca-208">Se l'utente fa clic su OK, il `confirm(string)` funzione restituisce `true`; facendo clic su Annulla restituisce `false`.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-208">If the user clicks OK, the `confirm(string)` function returns `true`; clicking Cancel returns `false`.</span></span> <span data-ttu-id="9a4ca-209">Questa funzionalità, insieme a un comportamento di browser s per annullare l'invio di un form se restituisce un gestore di eventi durante il processo di invio `false`, può essere utilizzato per visualizzare una finestra di messaggio di conferma quando si elimina un record.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-209">This functionality, coupled with a browser s behavior to cancel a form submission if an event handler during the submission process returns `false`, can be used to display a confirmation messagebox when deleting a record.</span></span>

<span data-ttu-id="9a4ca-210">Il `confirm(string)` funzione può essere associata a un controllo s Web pulsante client-side `onclick` gestore dell'evento tramite il controllo s `OnClientClick` proprietà.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-210">The `confirm(string)` function can be associated with a Button Web control s client-side `onclick` event handler through the control s `OnClientClick` property.</span></span> <span data-ttu-id="9a4ca-211">Quando si lavora con un pulsante Elimina in un modello: in uno dei modelli di FormView s o in un TemplateField nel controllo DetailsView o GridView - questa proprietà può essere impostata in modo dichiarativo o a livello di programmazione, come abbiamo visto in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-211">When working with a Delete button in a template - either in one of the FormView s templates or in a TemplateField in the DetailsView or GridView - this property can be set either declaratively or programmatically, as we saw in this tutorial.</span></span>

<span data-ttu-id="9a4ca-212">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="9a4ca-212">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="9a4ca-213">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="9a4ca-213">About the Author</span></span>

<span data-ttu-id="9a4ca-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9a4ca-215">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="9a4ca-215">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9a4ca-216">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-216">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="9a4ca-217">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9a4ca-217">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="9a4ca-218">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="9a4ca-218">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9a4ca-219">[Precedente](implementing-optimistic-concurrency-vb.md)
> [Successivo](limiting-data-modification-functionality-based-on-the-user-vb.md)</span><span class="sxs-lookup"><span data-stu-id="9a4ca-219">[Previous](implementing-optimistic-concurrency-vb.md)
[Next](limiting-data-modification-functionality-based-on-the-user-vb.md)</span></span>
