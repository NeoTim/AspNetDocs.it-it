---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
title: Limitazione della funzionalità di modifica dei dati in base all'utente (VB) | Microsoft Docs
author: rick-anderson
description: In un'applicazione web che consente agli utenti di modificare i dati, account utente diversi possono avere privilegi di modifica dei dati diversi. In questa esercitazione verrà esaminato come t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 9dc264a6-feb8-474b-8b91-008c50708065
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
msc.type: authoredcontent
ms.openlocfilehash: f0ba98d4049cd7ad10d5e1238d4580b3f767924b
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/17/2019
ms.locfileid: "59420575"
---
# <a name="limiting-data-modification-functionality-based-on-the-user-vb"></a><span data-ttu-id="c9b2c-104">Limitazione della funzionalità di modifica dei dati in base all'utente (VB)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-104">Limiting Data Modification Functionality Based on the User (VB)</span></span>

<span data-ttu-id="c9b2c-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c9b2c-106">[Scaricare l'App di esempio](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) o [Scarica il PDF](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) or [Download PDF](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span></span>

> <span data-ttu-id="c9b2c-107">In un'applicazione web che consente agli utenti di modificare i dati, account utente diversi possono avere privilegi di modifica dei dati diversi.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-107">In a web application that allows users to edit data, different user accounts may have different data-editing privileges.</span></span> <span data-ttu-id="c9b2c-108">In questa esercitazione verrà esaminato come modificare dinamicamente le funzionalità di modifica dei dati in base all'utente visita.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-108">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span>


## <a name="introduction"></a><span data-ttu-id="c9b2c-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="c9b2c-109">Introduction</span></span>

<span data-ttu-id="c9b2c-110">Un numero di applicazioni web che supporta gli account utente e offre diverse opzioni, report e funzionalità di base dell'utente connesso.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-110">A number of web applications support user accounts and provide different options, reports, and functionality based on the logged in user.</span></span> <span data-ttu-id="c9b2c-111">Ad esempio, le esercitazioni illustrano potrebbe essere necessario consentire agli utenti da società il fornitore per l'accesso al sito e aggiornare le informazioni generali sui prodotti - il nome e la quantità per unità, ad esempio, insieme alle informazioni di fornitore, ad esempio il nome della società, indirizzo, le informazioni di contatto s e così via.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-111">For example, with our tutorials we might want to allow users from the supplier companies to log on to the site and update general information about their products - their name and quantity per unit, perhaps - along with supplier information, such as their company name, address, the contact person s information, and so on.</span></span> <span data-ttu-id="c9b2c-112">Inoltre, si potrebbe essere opportuno includere alcuni account utente per gli utenti dalla nostra azienda in modo che possano accedere e aggiornare le informazioni sul prodotto, ad esempio unità in magazzino, livello di riordinamento e così via.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-112">Furthermore, we might want to include some user accounts for people from our company so that they can log on and update product information like units on stock, reorder level, and so forth.</span></span> <span data-ttu-id="c9b2c-113">L'applicazione web potrebbe anche consentire agli utenti anonimi da visitare (persone che non hanno effettuato l'accesso), ma sarà limitata a visualizzare solo i dati.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-113">Our web application might also allow anonymous users to visit (people who have not logged on), but would limit them to just viewing data.</span></span> <span data-ttu-id="c9b2c-114">Con tale utente account sistema posto, sarebbe opportuno i controlli Web dei dati in nostro pagine ASP.NET per offrire l'inserimento, la modifica e l'eliminazione di privilegi appropriati per l'utente attualmente connesso.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-114">With such a user account system in place, we would want the data Web controls in our ASP.NET pages to offer the inserting, editing, and deleting capabilities appropriate for the currently logged on user.</span></span>

<span data-ttu-id="c9b2c-115">In questa esercitazione verrà esaminato come modificare dinamicamente le funzionalità di modifica dei dati in base all'utente visita.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-115">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span> <span data-ttu-id="c9b2c-116">In particolare, si creerà una pagina che visualizza le informazioni di fornitori in un controllo DetailsView modificabile insieme a un controllo GridView in cui sono elencati i prodotti specificati dal fornitore.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-116">In particular, we'll create a page that displays the suppliers information in an editable DetailsView along with a GridView that lists the products provided by the supplier.</span></span> <span data-ttu-id="c9b2c-117">Se l'utente visitando la pagina dalla nostra società, è possibile: visualizzare le informazioni di qualsiasi fornitore s; modificare l'indirizzo; e modificare le informazioni per tutti i prodotti specificati dal fornitore.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-117">If the user visiting the page is from our company, they can: view any supplier s information; edit their address; and edit the information for any product provided by the supplier.</span></span> <span data-ttu-id="c9b2c-118">Se, tuttavia, l'utente proviene da una particolare azienda, questi possono solo visualizzare e modificare le proprie informazioni di indirizzo e potranno essere modificati solo i prodotti che non sono stati contrassegnati come non più disponibile.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-118">If, however, the user is from a particular company, they can only view and edit their own address information and can only edit their products that have not been marked as discontinued.</span></span>


<span data-ttu-id="c9b2c-119">[![Un utente dalla nostra azienda può modificare eventuali informazioni s fornitore](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-119">[![A User from Our Company Can Edit Any Supplier s Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span></span>

<span data-ttu-id="c9b2c-120">**Figura 1**: Un utente la nostra società possono modificare qualsiasi fornitore s informazioni ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-120">**Figure 1**: A User from Our Company Can Edit Any Supplier s Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span></span>


<span data-ttu-id="c9b2c-121">[![Un utente da un particolare fornitore possono solo visualizzare e modificare le relative informazioni](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-121">[![A User from a Particular Supplier Can Only View and Edit their Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span></span>

<span data-ttu-id="c9b2c-122">**Figura 2**: Un utente da un particolare fornitore possono solo visualizzare e modificare le relative informazioni ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-122">**Figure 2**: A User from a Particular Supplier Can Only View and Edit their Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span></span>


<span data-ttu-id="c9b2c-123">Introduzione a ti permettono di s.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-123">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="c9b2c-124">ASP.NET 2.0 il sistema di appartenenze s offre una piattaforma standardizzata ed estendibile per la creazione, la gestione e la convalida degli account utente.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-124">ASP.NET 2.0 s membership system provides a standardized, extensible platform for creating, managing, and validating user accounts.</span></span> <span data-ttu-id="c9b2c-125">Poiché un esame del sistema di appartenenze è oltre l'ambito delle esercitazioni seguenti, in questa esercitazione invece "fakes" appartenenza in quanto consente visitatori anonimi scegliere se sono da un particolare fornitore o dalla nostra azienda.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-125">Since an examination of the membership system is beyond the scope of these tutorials, this tutorial instead "fakes" membership by allowing anonymous visitors to choose whether they are from a particular supplier or from our company.</span></span> <span data-ttu-id="c9b2c-126">Per altre informazioni sull'appartenenza, fare riferimento alla mia [analisi ASP.NET 2.0 s appartenenza, ruoli e profilo](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) serie di articoli.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-126">For more on membership, refer to my [Examining ASP.NET 2.0 s Membership, Roles, and Profile](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) article series.</span></span>


## <a name="step-1-allowing-the-user-to-specify-their-access-rights"></a><span data-ttu-id="c9b2c-127">Passaggio 1: Che consente all'utente di specificare i diritti di accesso</span><span class="sxs-lookup"><span data-stu-id="c9b2c-127">Step 1: Allowing the User to Specify their Access Rights</span></span>

<span data-ttu-id="c9b2c-128">In un'applicazione web reale, informazioni su account utente s includerà se hanno collaborato per la nostra azienda o per un particolare fornitore e tali informazioni saranno accessibili a livello di codice da alle pagine ASP.NET dopo che l'utente ha effettuato l'accesso al sito.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-128">In a real-world web application, a user s account information would include whether they worked for our company or for a particular supplier, and this information would be programmatically accessible from our ASP.NET pages once the user has logged on to the site.</span></span> <span data-ttu-id="c9b2c-129">Queste informazioni può essere acquisite tramite ASP.NET 2.0 sistema ruoli, come informazioni dell'account a livello di utente attraverso il sistema di profilo, o tramite alcuni metodi personalizzati.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-129">This information could be captured through ASP.NET 2.0 s roles system, as user-level account information through the profile system, or through some custom means.</span></span>

<span data-ttu-id="c9b2c-130">Poiché l'obiettivo di questa esercitazione è illustrare modificando le funzionalità di modifica dei dati in base all'utente connesso e non è destinato a ASP.NET 2.0 in evidenza s appartenenza, ruoli e i sistemi di profilo, si userà un meccanismo molto semplice per determinare il funzionalità per l'utente visitando la pagina - un controllo DropDownList da cui l'utente può indicare se deve essere in grado di visualizzare e modificare tutte le informazioni di fornitori o, in alternativa, quali informazioni particolare fornitore s possono visualizzare e modificare.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-130">Since the aim of this tutorial is to demonstrate adjusting the data modification capabilities based on the logged on user, and is not meant to showcase ASP.NET 2.0 s membership, roles, and profile systems, we'll use a very simply mechanism to determine the capabilities for the user visiting the page - a DropDownList from which the user can indicate if they should be able to view and edit any of the suppliers information or, alternatively, what particular supplier s information they can view and edit.</span></span> <span data-ttu-id="c9b2c-131">Se l'utente indica che potrà quindi visualizzare e modificare tutte le informazioni di fornitore (predefinito), Anna può spostarsi tra tutti i fornitori, modificare le informazioni sugli indirizzi s fornitore e modificare il nome e la quantità per unità per i prodotti specificati dal fornitore selezionato.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-131">If the user indicates that she can view and edit all supplier information (the default), she can page through all suppliers, edit any supplier s address information, and edit the name and quantity per unit for any product provided by the selected supplier.</span></span> <span data-ttu-id="c9b2c-132">Se l'utente indica che può solo visualizzare e modificare un particolare fornitore, tuttavia, Anna può solo visualizzare i dettagli e i prodotti per tale uno fornitore e quindi può solo aggiornare il nome e una quantità per informazioni sulle unità per i prodotti *non* non più disponibile.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-132">If the user indicates that she can only view and edit a particular supplier, however, then she can only view the details and products for that one supplier and can only update the name and quantity per unit information for those products that are *not* discontinued.</span></span>

<span data-ttu-id="c9b2c-133">Il primo passaggio in questa esercitazione, è quindi, per creare questo DropDownList e popolarla con i fornitori nel sistema.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-133">Our first step in this tutorial, then, is to create this DropDownList and populate it with the suppliers in the system.</span></span> <span data-ttu-id="c9b2c-134">Aprire il `UserLevelAccess.aspx` nella pagina la `EditInsertDelete` cartella, aggiungere un controllo DropDownList cui `ID` è impostata su `Suppliers`e associare questo controllo DropDownList per un nuovo oggetto ObjectDataSource denominato `AllSuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-134">Open the `UserLevelAccess.aspx` page in the `EditInsertDelete` folder, add a DropDownList whose `ID` property is set to `Suppliers`, and bind this DropDownList to a new ObjectDataSource named `AllSuppliersDataSource`.</span></span>


<span data-ttu-id="c9b2c-135">[![Creare un nuovo oggetto ObjectDataSource denominato AllSuppliersDataSource](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-135">[![Create a New ObjectDataSource Named AllSuppliersDataSource](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span></span>

<span data-ttu-id="c9b2c-136">**Figura 3**: Creare un nuovo oggetto ObjectDataSource denominato `AllSuppliersDataSource` ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-136">**Figure 3**: Create a New ObjectDataSource Named `AllSuppliersDataSource` ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span></span>


<span data-ttu-id="c9b2c-137">Poiché si desidera che questo controllo DropDownList per includere tutti i fornitori, configurare ObjectDataSource per richiamare il `SuppliersBLL` classe s `GetSuppliers()` (metodo).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-137">Since we want this DropDownList to include all suppliers, configure the ObjectDataSource to invoke the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="c9b2c-138">Assicurarsi inoltre che gli oggetti ObjectDataSource `Update()` metodo viene eseguito il mapping per il `SuppliersBLL` classe s `UpdateSupplierAddress` metodo, come ObjectDataSource verrà anche essere usato da DetailsView verranno aggiunte nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-138">Also ensure that the ObjectDataSource s `Update()` method is mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method, as this ObjectDataSource will also be used by the DetailsView we'll be adding in Step 2.</span></span>

<span data-ttu-id="c9b2c-139">Dopo aver completato la procedura guidata ObjectDataSource, completare i passaggi configurando il `Suppliers` DropDownList tale che mostra il `CompanyName` campo dati e il `SupplierID` il valore per ogni campo di dati `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-139">After completing the ObjectDataSource wizard, complete the steps by configuring the `Suppliers` DropDownList such that it shows the `CompanyName` data field and uses the `SupplierID` data field as the value for each `ListItem`.</span></span>


<span data-ttu-id="c9b2c-140">[![Configurare il controllo DropDownList fornitori per usare il CompanyName e campi dati SupplierID](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-140">[![Configure the Suppliers DropDownList to Use the CompanyName and SupplierID Data Fields](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span></span>

<span data-ttu-id="c9b2c-141">**Figura 4**: Configurare il `Suppliers` DropDownList per usare il `CompanyName` e `SupplierID` campi dati ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-141">**Figure 4**: Configure the `Suppliers` DropDownList to Use the `CompanyName` and `SupplierID` Data Fields ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span></span>


<span data-ttu-id="c9b2c-142">A questo punto, il controllo DropDownList Elenca i nomi società dei fornitori nel database.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-142">At this point, the DropDownList lists the company names of the suppliers in the database.</span></span> <span data-ttu-id="c9b2c-143">Tuttavia, è anche necessario includere un'opzione "Mostra o modifica tutti i fornitori" per il controllo DropDownList.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-143">However, we also need to include a "Show/Edit ALL Suppliers" option to the DropDownList.</span></span> <span data-ttu-id="c9b2c-144">A tale scopo, impostare il `Suppliers` s DropDownList `AppendDataBoundItems` proprietà `true` e quindi aggiungere un `ListItem` cui `Text` proprietà è "Mostra o modifica tutti i fornitori" e il cui valore è `-1`.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-144">To accomplish this, set the `Suppliers` DropDownList s `AppendDataBoundItems` property to `true` and then add a `ListItem` whose `Text` property is "Show/Edit ALL Suppliers" and whose value is `-1`.</span></span> <span data-ttu-id="c9b2c-145">Questo può essere aggiunto direttamente tramite markup dichiarativo o tramite la finestra di progettazione accedendo alla finestra proprietà e facendo clic sui puntini di sospensione in s DropDownList `Items` proprietà.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-145">This can be added directly through the declarative markup or through the Designer by going to the Properties window and clicking on the ellipses in the DropDownList s `Items` property.</span></span>

> [!NOTE]
> <span data-ttu-id="c9b2c-146">Vedere la [ *Master/Dettagli filtro con un controllo DropDownList* ](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) esercitazione per informazioni più dettagliate sull'aggiunta di un elemento Seleziona tutto a un controllo DropDownList con associazione a dati.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-146">Refer back to the [*Master/Detail Filtering With a DropDownList*](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial for a more detailed discussion on adding a Select All item to a databound DropDownList.</span></span>


<span data-ttu-id="c9b2c-147">Dopo il `AppendDataBoundItems` proprietà è stata impostata e `ListItem` aggiunto, il markup dichiarativo s DropDownList dovrebbe essere, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="c9b2c-147">After the `AppendDataBoundItems` property has been set and the `ListItem` added, the DropDownList s declarative markup should look like:</span></span>


[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample1.aspx)]

<span data-ttu-id="c9b2c-148">Figura 5 mostra una schermata di stato di avanzamento corrente, quando viene visualizzato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-148">Figure 5 shows a screen shot of our current progress, when viewed through a browser.</span></span>


<span data-ttu-id="c9b2c-149">[![DropDownList Suppliers contiene una presentazione ListItem tutti, più uno per ogni fornitore](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-149">[![The Suppliers DropDownList Contains a Show ALL ListItem, Plus One for Each Supplier](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span></span>

<span data-ttu-id="c9b2c-150">**Figura 5**: Il `Suppliers` DropDownList contiene Mostra tutto `ListItem`, oltre a uno per ogni fornitore ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-150">**Figure 5**: The `Suppliers` DropDownList Contains a Show ALL `ListItem`, Plus One for Each Supplier ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span></span>


<span data-ttu-id="c9b2c-151">Poiché si vuole aggiornare l'interfaccia utente immediatamente dopo che l'utente ha modificato la selezione, impostare il `Suppliers` s DropDownList `AutoPostBack` proprietà `true`.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-151">Since we want to update the user interface immediately after the user has changed their selection, set the `Suppliers` DropDownList s `AutoPostBack` property to `true`.</span></span> <span data-ttu-id="c9b2c-152">Nel passaggio 2 si creerà un controllo DetailsView che mostra le informazioni per i suoi fornitori in base alla selezione DropDownList.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-152">In Step 2 we'll create a DetailsView control that will show the information for the supplier(s) based on the DropDownList selection.</span></span> <span data-ttu-id="c9b2c-153">Quindi, nel passaggio 3, creeremo un gestore eventi per questo s DropDownList `SelectedIndexChanged` evento, in cui verrà aggiunto codice che associa le informazioni appropriate supplier a DetailsView in base al fornitore selezionato.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-153">Then, in Step 3, we'll create an event handler for this DropDownList s `SelectedIndexChanged` event, in which we'll add code that binds the appropriate supplier information to the DetailsView based upon the selected supplier.</span></span>

## <a name="step-2-adding-a-detailsview-control"></a><span data-ttu-id="c9b2c-154">Passaggio 2: Aggiunta di un controllo DetailsView</span><span class="sxs-lookup"><span data-stu-id="c9b2c-154">Step 2: Adding a DetailsView Control</span></span>

<span data-ttu-id="c9b2c-155">Consentire s di usare un controllo DetailsView per mostrare informazioni relative al fornitore.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-155">Let s use a DetailsView to show supplier information.</span></span> <span data-ttu-id="c9b2c-156">Per l'utente che è possibile visualizzare e modificare tutti i fornitori, DetailsView supporterà il paging, consentendo all'utente di scorrere la supplier informazioni al record alla volta.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-156">For the user who can view and edit all suppliers, the DetailsView will support paging, allowing the user to step through the supplier information one record at a time.</span></span> <span data-ttu-id="c9b2c-157">Se l'utente appropriato per un particolare fornitore, tuttavia, DetailsView verrà visualizzato solo quel particolare fornitore informazioni s e non include un'interfaccia di paging.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-157">If the user works for a particular supplier, however, the DetailsView will show only that particular supplier s information and will not include a paging interface.</span></span> <span data-ttu-id="c9b2c-158">In entrambi i casi, deve consentire all'utente di modificare l'indirizzo fornitore, città e paese campi DetailsView.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-158">In either case, the DetailsView needs to allow the user to edit the supplier s address, city, and country fields.</span></span>

<span data-ttu-id="c9b2c-159">Aggiungere un controllo DetailsView alla pagina sotto il `Suppliers` DropDownList, impostare relativo `ID` proprietà `SupplierDetails`e associarlo al `AllSuppliersDataSource` ObjectDataSource creato nel passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-159">Add a DetailsView to the page beneath the `Suppliers` DropDownList, set its `ID` property to `SupplierDetails`, and bind it to the `AllSuppliersDataSource` ObjectDataSource created in the previous step.</span></span> <span data-ttu-id="c9b2c-160">Successivamente, controllare le caselle di controllo Abilita modifica e attiva Paging nello smart tag s DetailsView.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-160">Next, check the Enable Paging and Enable Editing checkboxes from the DetailsView s smart tag.</span></span>

> [!NOTE]
> <span data-ttu-id="c9b2c-161">Se non si t visualizzata un'opzione Abilita modifica in s DetailsView smart tag s perché non è stato mappato s ObjectDataSource `Update()` metodo per il `SuppliersBLL` classe s `UpdateSupplierAddress` (metodo).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-161">If you don t see an Enable Editing option in the DetailsView s smart tag it s because you did not map the ObjectDataSource s `Update()` method to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span> <span data-ttu-id="c9b2c-162">Si consiglia di tornare indietro e modificare questa configurazione, dopo che l'opzione Abilita modifica dovrebbe essere visualizzato nello smart tag s DetailsView.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-162">Take a moment to go back and make this configuration change, after which the Enable Editing option should appear in the DetailsView s smart tag.</span></span>


<span data-ttu-id="c9b2c-163">Poiché il `SuppliersBLL` classe s `UpdateSupplierAddress` metodo accetti solo quattro parametri: `supplierID`, `address`, `city`, e `country` -modificare i BoundField di DetailsView s in modo che il `CompanyName` e `Phone` BoundField sono di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-163">Since the `SuppliersBLL` class s `UpdateSupplierAddress` method only accepts four parameters - `supplierID`, `address`, `city`, and `country` - modify the DetailsView s BoundFields so that the `CompanyName` and `Phone` BoundFields are read-only.</span></span> <span data-ttu-id="c9b2c-164">Inoltre, rimuovere il `SupplierID` BoundField completamente.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-164">Additionally, remove the `SupplierID` BoundField altogether.</span></span> <span data-ttu-id="c9b2c-165">Infine, il `AllSuppliersDataSource` ObjectDataSource è attualmente relativo `OldValuesParameterFormatString` impostata su `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-165">Finally, the `AllSuppliersDataSource` ObjectDataSource currently has its `OldValuesParameterFormatString` property set to `original_{0}`.</span></span> <span data-ttu-id="c9b2c-166">Si consiglia di rimuovere questa impostazione di proprietà da completamente di sintassi dichiarativa o impostarlo sul valore predefinito, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-166">Take a moment to remove this property setting from the declarative syntax altogether, or set it to the default value, `{0}`.</span></span>

<span data-ttu-id="c9b2c-167">Dopo aver configurato il `SupplierDetails` DetailsView e `AllSuppliersDataSource` ObjectDataSource, si avrà il seguente markup dichiarativo:</span><span class="sxs-lookup"><span data-stu-id="c9b2c-167">After configuring the `SupplierDetails` DetailsView and `AllSuppliersDataSource` ObjectDataSource, we will have the following declarative markup:</span></span>


[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample2.aspx)]

<span data-ttu-id="c9b2c-168">A questo punto DetailsView possono essere inviati tramite cercapersone tramite e possono essere aggiornate le informazioni sull'indirizzo fornitore selezionato s, indipendentemente dalla selezione effettuata nella `Suppliers` DropDownList (vedere la figura 6).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-168">At this point the DetailsView can be paged through and the selected supplier s address information can be updated, regardless of the selection made in the `Suppliers` DropDownList (see Figure 6).</span></span>


<span data-ttu-id="c9b2c-169">[![Qualsiasi informazione di fornitori può essere visualizzati e il relativo indirizzo aggiornato](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-169">[![Any Suppliers Information Can Be Viewed, and Its Address Updated](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span></span>

<span data-ttu-id="c9b2c-170">**Figura 6**: Qualsiasi fornitori informazioni possono essere visualizzate e aggiornato l'indirizzo relativo ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-170">**Figure 6**: Any Suppliers Information Can Be Viewed, and Its Address Updated ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span></span>


## <a name="step-3-displaying-only-the-selected-supplier-s-information"></a><span data-ttu-id="c9b2c-171">Passaggio 3: Visualizzando solo le informazioni s fornitore selezionato</span><span class="sxs-lookup"><span data-stu-id="c9b2c-171">Step 3: Displaying Only the Selected Supplier s Information</span></span>

<span data-ttu-id="c9b2c-172">La pagina attualmente Visualizza le informazioni per tutti i suoi fornitori indipendentemente dal fatto che un fornitore particolare è stato selezionato dal `Suppliers` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-172">Our page currently displays the information for all suppliers regardless of whether a particular supplier has been selected from the `Suppliers` DropDownList.</span></span> <span data-ttu-id="c9b2c-173">Per visualizzare solo le informazioni sui fornitori per il fornitore selezionato è necessario aggiungere un altro oggetto ObjectDataSource alla pagina, che recupera informazioni su un particolare fornitore.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-173">In order to display just the supplier information for the selected supplier we need to add another ObjectDataSource to our page, one that retrieves information about a particular supplier.</span></span>

<span data-ttu-id="c9b2c-174">Aggiungere un nuovo oggetto ObjectDataSource alla pagina, denominarlo `SingleSupplierDataSource`.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-174">Add a new ObjectDataSource to the page, naming it `SingleSupplierDataSource`.</span></span> <span data-ttu-id="c9b2c-175">Dal suo smart tag, fare clic sul collegamento Configura origine dati e che usi il `SuppliersBLL` classe s `GetSupplierBySupplierID(supplierID)` (metodo).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-175">From its smart tag, click the Configure Data Source link and have it use the `SuppliersBLL` class s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="c9b2c-176">Come con le `AllSuppliersDataSource` ObjectDataSource, hanno il `SingleSupplierDataSource` s ObjectDataSource `Update()` metodo di cui è stato eseguito il mapping al `SuppliersBLL` classe s `UpdateSupplierAddress` (metodo).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-176">As with the `AllSuppliersDataSource` ObjectDataSource, have the `SingleSupplierDataSource` ObjectDataSource s `Update()` method mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span>


<span data-ttu-id="c9b2c-177">[![Configurare SingleSupplierDataSource ObjectDataSource per usare il metodo GetSupplierBySupplierID(supplierID)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-177">[![Configure the SingleSupplierDataSource ObjectDataSource to Use the GetSupplierBySupplierID(supplierID) Method](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span></span>

<span data-ttu-id="c9b2c-178">**Figura 7**: Configurare il `SingleSupplierDataSource` ObjectDataSource per usare il `GetSupplierBySupplierID(supplierID)` metodo ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-178">**Figure 7**: Configure the `SingleSupplierDataSource` ObjectDataSource to Use the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span></span>


<span data-ttu-id="c9b2c-179">Successivamente, viene nuovamente richiesto di specificare l'origine del parametro per il `GetSupplierBySupplierID(supplierID)` metodo s `supplierID` parametro di input.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-179">Next, we re prompted to specify the parameter source for the `GetSupplierBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="c9b2c-180">Poiché si vogliono visualizzare le informazioni per il fornitore selezionato da DropDownList, usare il `Suppliers` DropDownList s `SelectedValue` proprietà come origine del parametro.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-180">Since we want to show the information for the supplier selected from the DropDownList, use the `Suppliers` DropDownList s `SelectedValue` property as the parameter source.</span></span>


<span data-ttu-id="c9b2c-181">[![Usare il controllo DropDownList Suppliers come origine del parametro supplierID](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-181">[![Use the Suppliers DropDownList as the supplierID Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span></span>

<span data-ttu-id="c9b2c-182">**Figura 8**: Usare la `Suppliers` DropDownList come i `supplierID` origine del parametro ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-182">**Figure 8**: Use the `Suppliers` DropDownList as the `supplierID` Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span></span>


<span data-ttu-id="c9b2c-183">Anche con questo secondo ObjectDataSource aggiunto, il controllo DetailsView è attualmente configurato per usare sempre la `AllSuppliersDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-183">Even with this second ObjectDataSource added, the DetailsView control is currently configured to always use the `AllSuppliersDataSource` ObjectDataSource.</span></span> <span data-ttu-id="c9b2c-184">È necessario aggiungere la logica necessaria per modificare l'origine dati utilizzata dal controllo DetailsView. a seconda di `Suppliers` DropDownList elemento selezionato.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-184">We need to add logic to adjust the data source used by the DetailsView depending on the `Suppliers` DropDownList item selected.</span></span> <span data-ttu-id="c9b2c-185">A questo scopo, creare un `SelectedIndexChanged` gestore eventi per il controllo DropDownList Suppliers.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-185">To accomplish this, create a `SelectedIndexChanged` event handler for the Suppliers DropDownList.</span></span> <span data-ttu-id="c9b2c-186">Ciò è possibile creare più facilmente facendo doppio clic su DropDownList nella finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-186">This can most easily be created by double-clicking the DropDownList in the Designer.</span></span> <span data-ttu-id="c9b2c-187">Questo gestore eventi deve determinare l'origine dati da usare e deve riassociare i dati in DetailsView.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-187">This event handler needs to determine what data source to use and must rebind the data to the DetailsView.</span></span> <span data-ttu-id="c9b2c-188">Questa operazione viene eseguita con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="c9b2c-188">This is accomplished with the following code:</span></span>


[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample3.vb)]

<span data-ttu-id="c9b2c-189">Il gestore dell'evento inizia determinando se è stata selezionata l'opzione "Mostra o modifica tutti i fornitori".</span><span class="sxs-lookup"><span data-stu-id="c9b2c-189">The event handler begins by determining whether the "Show/Edit ALL Suppliers" option was selected.</span></span> <span data-ttu-id="c9b2c-190">Se si tratta, imposta il `SupplierDetails` s DetailsView `DataSourceID` a `AllSuppliersDataSource` e restituisce all'utente per il primo record nel set di fornitori impostando il `PageIndex` proprietà su 0.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-190">If it was, it sets the `SupplierDetails` DetailsView s `DataSourceID` to `AllSuppliersDataSource` and returns the user to the first record in the set of suppliers by setting the `PageIndex` property to 0.</span></span> <span data-ttu-id="c9b2c-191">Se, tuttavia, l'utente ha selezionato un particolare fornitore da DropDownList, s DetailsView `DataSourceID` viene assegnato a `SingleSuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-191">If, however, the user has selected a particular supplier from the DropDownList, the DetailsView s `DataSourceID` is assigned to `SingleSuppliersDataSource`.</span></span> <span data-ttu-id="c9b2c-192">Indipendentemente dal fatto che i dati viene usata l'origine, il `SuppliersDetails` modalità viene ripristinata la modalità di sola lettura e la data è riassociata per DetailsView da una chiamata ai `SuppliersDetails` controllo s `DataBind()` (metodo).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-192">Regardless of what data source is used, the `SuppliersDetails` mode is reverted back to the read-only mode and the data is rebound to the DetailsView by a call to the `SuppliersDetails` control s `DataBind()` method.</span></span>

<span data-ttu-id="c9b2c-193">A questo gestore eventi posto, il controllo DetailsView Mostra ora il fornitore selezionato, a meno che non è stata selezionata l'opzione "Mostra o modifica tutti i fornitori", nel qual caso tutti i fornitori possono essere visualizzati tramite l'interfaccia di paging.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-193">With this event handler in place, the DetailsView control now shows the selected supplier, unless the "Show/Edit ALL Suppliers" option was selected, in which case all of the suppliers can be viewed through the paging interface.</span></span> <span data-ttu-id="c9b2c-194">Figura 9 mostra la pagina con l'opzione "Mostra o modifica tutti i fornitori" selezionata; Si noti che l'interfaccia di paging è presente, che consente all'utente di visitare e aggiornare qualsiasi fornitore.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-194">Figure 9 shows the page with the "Show/Edit ALL Suppliers" option selected; note that the paging interface is present, allowing the user to visit and update any supplier.</span></span> <span data-ttu-id="c9b2c-195">Figura 10 Mostra la pagina con il fornitore Ma Maison selezionato.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-195">Figure 10 shows the page with the Ma Maison supplier selected.</span></span> <span data-ttu-id="c9b2c-196">Solo le informazioni s Ma Maison sono visualizzabile e modificabile in questo caso.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-196">Only Ma Maison s information is viewable and editable in this case.</span></span>


<span data-ttu-id="c9b2c-197">[![Tutte le informazioni di fornitori possono essere visualizzate e modificate](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-197">[![All of the Suppliers Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span></span>

<span data-ttu-id="c9b2c-198">**Figura 9**: Tutti i suoi fornitori informazioni possono essere visualizzate e modificate ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-198">**Figure 9**: All of the Suppliers Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span></span>


<span data-ttu-id="c9b2c-199">[![Solo le informazioni selezionate Supplier s possono essere visualizzate e modificate](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-199">[![Only the Selected Supplier s Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span></span>

<span data-ttu-id="c9b2c-200">**Figura 10**: Solo informazioni s fornitore selezionato possono essere visualizzabile e modificata ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-200">**Figure 10**: Only the Selected Supplier s Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span></span>


> [!NOTE]
> <span data-ttu-id="c9b2c-201">Per questa esercitazione, il controllo DropDownList e DetailsView controllare s `EnableViewState` deve essere impostata su `true` (predefinito) perché la s DropDownList `SelectedIndex` e gli oggetti DetailsView `DataSourceID` le modifiche alle proprietà s devono essere memorizzati nella navigazione tra i postback.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-201">For this tutorial, both the DropDownList and DetailsView control s `EnableViewState` must be set to `true` (the default) because the DropDownList s `SelectedIndex` and the DetailsView s `DataSourceID` property s changes must be remembered across postbacks.</span></span>


## <a name="step-4-listing-the-suppliers-products-in-an-editable-gridview"></a><span data-ttu-id="c9b2c-202">Passaggio 4: Elenco dei prodotti di fornitori in un controllo GridView modificabile</span><span class="sxs-lookup"><span data-stu-id="c9b2c-202">Step 4: Listing the Suppliers Products in an Editable GridView</span></span>

<span data-ttu-id="c9b2c-203">Con DetailsView completa, il passaggio successivo consiste nell'includere un GridView modificabile in cui sono elencati i prodotti specificati dal fornitore selezionato.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-203">With the DetailsView complete, our next step is to include an editable GridView that lists those products provided by the selected supplier.</span></span> <span data-ttu-id="c9b2c-204">Questo controllo GridView deve consentire le modifiche solo per i `ProductName` e `QuantityPerUnit` campi.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-204">This GridView should allow edits to only the `ProductName` and `QuantityPerUnit` fields.</span></span> <span data-ttu-id="c9b2c-205">Inoltre, se l'utente visitando la pagina proviene da un fornitore particolare, deve consentire solo gli aggiornamenti per i prodotti *non* non più disponibile.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-205">Moreover, if the user visiting the page is from a particular supplier, it should only allow updates to those products that are *not* discontinued.</span></span> <span data-ttu-id="c9b2c-206">A tale scopo è necessario innanzitutto aggiungere un overload del `ProductsBLL` classe s `UpdateProducts` metodo che accetta solo la `ProductID`, `ProductName`, e `QuantityPerUnit` campi come input.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-206">To accomplish this we'll need to first add an overload of the `ProductsBLL` class s `UpdateProducts` method that takes in just the `ProductID`, `ProductName`, and `QuantityPerUnit` fields as inputs.</span></span> <span data-ttu-id="c9b2c-207">Abbiamo ve una alla volta questo processo in anticipo nelle numerose esercitazioni sulla, ma vediamo s just esaminare il codice in questo caso, che deve essere aggiunto al `ProductsBLL`:</span><span class="sxs-lookup"><span data-stu-id="c9b2c-207">We ve stepped through this process beforehand in numerous tutorials, so let s just look at the code here, which should be added to `ProductsBLL`:</span></span>


[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample4.vb)]

<span data-ttu-id="c9b2c-208">Con questo overload creato, sono pronti per aggiungere il controllo GridView e relativo ObjectDataSource associata.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-208">With this overload created, we re ready to add the GridView control and its associated ObjectDataSource.</span></span> <span data-ttu-id="c9b2c-209">Aggiungere un controllo GridView di nuovo alla pagina, impostare relativi `ID` proprietà `ProductsBySupplier`e configurarlo per usare un nuovo oggetto ObjectDataSource denominato `ProductsBySupplierDataSource`.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-209">Add a new GridView to the page, set its `ID` property to `ProductsBySupplier`, and configure it to use a new ObjectDataSource named `ProductsBySupplierDataSource`.</span></span> <span data-ttu-id="c9b2c-210">Poiché si desidera che questo controllo GridView per visualizzare l'elenco di tali prodotti dal fornitore selezionato, usare il `ProductsBLL` classe s `GetProductsBySupplierID(supplierID)` (metodo).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-210">Since we want this GridView to list those products by the selected supplier, use the `ProductsBLL` class s `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="c9b2c-211">Anche eseguire il mapping di `Update()` metodo al nuovo `UpdateProduct` overload appena creato.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-211">Also map the `Update()` method to the new `UpdateProduct` overload we just created.</span></span>


<span data-ttu-id="c9b2c-212">[![Configurare ObjectDataSource per usare l'Overload UpdateProduct appena creato](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-212">[![Configure the ObjectDataSource to Use the UpdateProduct Overload Just Created](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span></span>

<span data-ttu-id="c9b2c-213">**Figura 11**: Configurare ObjectDataSource per usare la `UpdateProduct` Overload appena creato ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-213">**Figure 11**: Configure the ObjectDataSource to Use the `UpdateProduct` Overload Just Created ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span></span>


<span data-ttu-id="c9b2c-214">Abbiamo re viene richiesto di selezionare l'origine del parametro per il `GetProductsBySupplierID(supplierID)` metodo s `supplierID` parametro di input.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-214">We re prompted to select the parameter source for the `GetProductsBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="c9b2c-215">Poiché si vogliono visualizzare i prodotti per il fornitore selezionato nel controllo DetailsView, usare il `SuppliersDetails` controllo DetailsView s `SelectedValue` proprietà come origine del parametro.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-215">Since we want to show the products for the supplier selected in the DetailsView, use the `SuppliersDetails` DetailsView control s `SelectedValue` property as the parameter source.</span></span>


<span data-ttu-id="c9b2c-216">[![Usare la proprietà SelectedValue s SuppliersDetails DetailsView come origine del parametro](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-216">[![Use the SuppliersDetails DetailsView s SelectedValue Property as the Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span></span>

<span data-ttu-id="c9b2c-217">**Figura 12**: Usare la `SuppliersDetails` s DetailsView `SelectedValue` proprietà come origine del parametro ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-217">**Figure 12**: Use the `SuppliersDetails` DetailsView s `SelectedValue` Property as the Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span></span>


<span data-ttu-id="c9b2c-218">Restituzione di GridView, rimuovere tutti i campi di GridView, ad eccezione di `ProductName`, `QuantityPerUnit`, e `Discontinued`, contrassegno di `Discontinued` CampoCasellaDiControllo in sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-218">Returning to the GridView, remove all of the GridView fields except for `ProductName`, `QuantityPerUnit`, and `Discontinued`, marking the `Discontinued` CheckBoxField as read-only.</span></span> <span data-ttu-id="c9b2c-219">Inoltre, selezionare l'opzione Abilita modifica dallo smart tag s GridView.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-219">Also, check the Enable Editing option from the GridView s smart tag.</span></span> <span data-ttu-id="c9b2c-220">Dopo aver apportate queste modifiche, il markup dichiarativo per il controllo GridView e ObjectDataSource dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="c9b2c-220">After these changes have been made, the declarative markup for the GridView and ObjectDataSource should look similar to the following:</span></span>


[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample5.aspx)]

<span data-ttu-id="c9b2c-221">Come con i nostri ObjectDataSource precedente, si tratta di uno `OldValuesParameterFormatString` è impostata su `original_{0}`, che si verificheranno problemi durante il tentativo di aggiornare un prodotto s nome o la quantità per unità.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-221">As with our previous ObjectDataSources, this one s `OldValuesParameterFormatString` property is set to `original_{0}`, which will cause problems when attempting to update a product s name or quantity per unit.</span></span> <span data-ttu-id="c9b2c-222">Rimuovere completamente questa proprietà con la sintassi dichiarativa o impostarlo sul valore predefinito, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-222">Remove this property from the declarative syntax altogether or set it to its default, `{0}`.</span></span>

<span data-ttu-id="c9b2c-223">Con questa configurazione è completata, la pagina sono ora elencati i prodotti specificati dal fornitore selezionato nel GridView (vedere la figura 13).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-223">With this configuration complete, our page now lists the products provided by the supplier selected in the GridView (see Figure 13).</span></span> <span data-ttu-id="c9b2c-224">Attualmente *qualsiasi* quantity per ogni unità o il nome del prodotto s possono essere aggiornati.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-224">Currently *any* product s name or quantity per unit can be updated.</span></span> <span data-ttu-id="c9b2c-225">Tuttavia, è necessario aggiornare la logica della pagina in modo che tale funzionalità non è consentito per i prodotti non più disponibili per gli utenti associati a un particolare fornitore.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-225">However, we need to update our page logic so that such functionality is prohibited for discontinued products for users associated with a particular supplier.</span></span> <span data-ttu-id="c9b2c-226">Che verranno affrontati in questo componente finale nel passaggio 5.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-226">We'll tackle this final piece in Step 5.</span></span>


<span data-ttu-id="c9b2c-227">[![Vengono visualizzati i prodotti specificati dal fornitore selezionato](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-227">[![The Products Provided by the Selected Supplier are Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span></span>

<span data-ttu-id="c9b2c-228">**Figura 13**: Vengono visualizzati i prodotti specificati dal fornitore selezionato ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-228">**Figure 13**: The Products Provided by the Selected Supplier are Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span></span>


> [!NOTE]
> <span data-ttu-id="c9b2c-229">Con l'aggiunta di questo controllo GridView modificabile il `Suppliers` DropDownList s `SelectedIndexChanged` gestore dell'evento deve essere aggiornato per restituire il controllo GridView a uno stato di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-229">With the addition of this editable GridView the `Suppliers` DropDownList s `SelectedIndexChanged` event handler should be updated to return the GridView to a read-only state.</span></span> <span data-ttu-id="c9b2c-230">In caso contrario, se un fornitore diverso viene selezionato mentre è in corso la modifica delle informazioni sul prodotto, l'indice corrispondente in GridView per il nuovo fornitore sarà anche modificabile.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-230">Otherwise, if a different supplier is selected while in the middle of editing product information, the corresponding index in the GridView for the new supplier will also be editable.</span></span> <span data-ttu-id="c9b2c-231">Per evitare questo problema, è sufficiente impostare la s GridView `EditIndex` proprietà `-1` nel `SelectedIndexChanged` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-231">To prevent this, simply set the GridView s `EditIndex` property to `-1` in the `SelectedIndexChanged` event handler.</span></span>


<span data-ttu-id="c9b2c-232">Inoltre, è importante ricordare che è importante che il controllo GridView lo stato di visualizzazione s essere abilitato (comportamento predefinito).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-232">Also, recall that it is important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="c9b2c-233">Se si imposta la s GridView `EnableViewState` proprietà `false`, si corre il rischio di consentire agli utenti simultanei involontariamente l'eliminazione o modifica di record.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-233">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="c9b2c-234">Vedere [avviso: Concorrenza emettere con ASP.NET 2.0 GridViews/DetailsView/FormViews che supporto la modifica e/o l'eliminazione e il cui stato di visualizzazione è disabilitato](http://scottonwriting.net/sowblog/posts/10054.aspx) per altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-234">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="step-5-disallow-editing-for-discontinued-products-when-showedit-all-suppliers-is-not-selected"></a><span data-ttu-id="c9b2c-235">Passaggio 5: Non consentire la modifica per non più disponibili prodotti quando Show o modificare tutti i fornitori non è selezionato</span><span class="sxs-lookup"><span data-stu-id="c9b2c-235">Step 5: Disallow Editing for Discontinued Products When Show/Edit ALL Suppliers is Not Selected</span></span>

<span data-ttu-id="c9b2c-236">Mentre il `ProductsBySupplier` GridView è completamente funzionale, attualmente concede accesso eccessivo agli utenti che provengono da un fornitore particolare.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-236">While the `ProductsBySupplier` GridView is fully functional, it currently grants too much access to those users who are from a particular supplier.</span></span> <span data-ttu-id="c9b2c-237">Per le regole di business, tali utenti non devono essere in grado di aggiornare i prodotti non più utilizzati.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-237">Per our business rules, such users should not be able to update discontinued products.</span></span> <span data-ttu-id="c9b2c-238">Per applicare questo comportamento, è possibile nascondere o disabilitare il pulsante di modifica delle righe di GridView con i prodotti non più disponibili quando viene visitata la pagina da un utente da un fornitore.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-238">To enforce this, we can hide (or disable) the Edit button in those GridView rows with discontinued products when the page is being visited by a user from a supplier.</span></span>

<span data-ttu-id="c9b2c-239">Creare un gestore eventi per s GridView `RowDataBound` evento.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-239">Create an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="c9b2c-240">In questo gestore eventi è necessario determinare se l'utente è associato a un particolare fornitore, che, per questa esercitazione, può essere determinato mediante il controllo DropDownList fornitori dispositivi `SelectedValue` proprietà - se si s diverso da -1, quindi l'utente è associato a un particolare fornitore.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-240">In this event handler we need to determine whether or not the user is associated with a particular supplier, which, for this tutorial, can be determined by checking the Suppliers DropDownList s `SelectedValue` property - if it s something other than -1, then the user is associated with a particular supplier.</span></span> <span data-ttu-id="c9b2c-241">Per tali utenti, è necessario quindi determinare se il prodotto non è più disponibile.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-241">For such users, we then need to determine whether or not the product is discontinued.</span></span> <span data-ttu-id="c9b2c-242">È possibile ottenere un riferimento a effettivi `ProductRow` istanza associato alla riga GridView tramite il `e.Row.DataItem` proprietà, come descritto nel [ *visualizzazione di riepilogo delle informazioni in GridView s piè di pagina* ](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-242">We can grab a reference to the actual `ProductRow` instance bound to the GridView row via the `e.Row.DataItem` property, as discussed in the [*Displaying Summary Information in the GridView s Footer*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial.</span></span> <span data-ttu-id="c9b2c-243">Se il prodotto non è più disponibile, è possibile ottenere un riferimento a livello di codice per il pulsante Modifica in GridView s CommandField utilizzando le tecniche descritte nell'esercitazione precedente, [ *aggiunta lato Client conferma quando l'eliminazione* ](adding-client-side-confirmation-when-deleting-vb.md).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-243">If the product is discontinued, we can grab a programmatic reference to the Edit button in the GridView s CommandField using the techniques discussed in the previous tutorial, [*Adding Client-Side Confirmation When Deleting*](adding-client-side-confirmation-when-deleting-vb.md).</span></span> <span data-ttu-id="c9b2c-244">Dopo aver ottenuto un riferimento può essere quindi nascondere o disabilitare il pulsante.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-244">Once we have a reference we can then hide or disable the button.</span></span>


[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample6.vb)]

<span data-ttu-id="c9b2c-245">Con questo evento gestore sul posto, quando si visita questa pagina come un utente da un determinato fornitore tali prodotti che non sono più disponibili non sono modificabili, come il pulsante Modifica è nascosto per questi prodotti.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-245">With this event handler in place, when visiting this page as a user from a specific supplier those products that are discontinued are not editable, as the Edit button is hidden for these products.</span></span> <span data-ttu-id="c9b2c-246">Ad esempio, s Chef Anton's Gumbo combinazione è un prodotto non più disponibile per il fornitore di New Orleans Cajun coinvolgente.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-246">For example, Chef Anton s Gumbo Mix is a discontinued product for the New Orleans Cajun Delights supplier.</span></span> <span data-ttu-id="c9b2c-247">Quando si visita la pagina per questo particolare fornitore, il pulsante Modifica per questo prodotto è nascosto (vedere la figura 14).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-247">When visiting the page for this particular supplier, the Edit button for this product is hidden from sight (see Figure 14).</span></span> <span data-ttu-id="c9b2c-248">Tuttavia, quando si visita usando "Show o modificare tutti i fornitori", il pulsante Modifica è disponibile (vedere Figura 15).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-248">However, when visiting using the "Show/Edit ALL Suppliers," the Edit button is available (see Figure 15).</span></span>


<span data-ttu-id="c9b2c-249">[![Per utenti specifici per fornitore pulsante Modifica per s Chef Anton's Gumbo Mix è nascosta](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-249">[![For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span></span>

<span data-ttu-id="c9b2c-250">**Figura 14**: Per utenti specifici per fornitore viene nascosto il pulsante Modifica per s Chef Anton's Gumbo Mix ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-250">**Figure 14**: For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span></span>


<span data-ttu-id="c9b2c-251">[![Per visualizzare o modificare tutti gli utenti di fornitori, viene visualizzato il pulsante Modifica per s Chef Anton's Gumbo Mix](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-251">[![For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span></span>

<span data-ttu-id="c9b2c-252">**Figura 15**: Per visualizzare o modificare tutti gli utenti di fornitori, viene visualizzato il pulsante Modifica per s Chef Anton's Gumbo Mix ([fare clic per visualizzare l'immagine con dimensioni normali](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="c9b2c-252">**Figure 15**: For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span></span>


## <a name="checking-for-access-rights-in-the-business-logic-layer"></a><span data-ttu-id="c9b2c-253">Controllo dei diritti di accesso nel livello di logica di Business</span><span class="sxs-lookup"><span data-stu-id="c9b2c-253">Checking for Access Rights in the Business Logic Layer</span></span>

<span data-ttu-id="c9b2c-254">In questa esercitazione ASP.NET pagina consente di gestire tutta la logica per quanto riguarda le informazioni che l'utente può visualizzare e quali prodotti è possibile aggiornare.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-254">In this tutorial the ASP.NET page handles all logic with regards to what information the user can see and what products he can update.</span></span> <span data-ttu-id="c9b2c-255">In teoria, questa logica anche sarebbe stata disponibile a livello di logica di Business.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-255">Ideally, this logic would also be present at the Business Logic Layer.</span></span> <span data-ttu-id="c9b2c-256">Ad esempio, il `SuppliersBLL` classe s `GetSuppliers()` metodo, che restituisce tutti i fornitori, potrebbe includere un controllo per assicurarsi che l'utente attualmente connesso sia *non* associata a un determinato fornitore.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-256">For example, the `SuppliersBLL` class s `GetSuppliers()` method (which returns all suppliers) might include a check to ensure that the currently logged on user is *not* associated with a specific supplier.</span></span> <span data-ttu-id="c9b2c-257">Analogamente, il `UpdateSupplierAddress` metodo potrebbe includere un controllo per assicurarsi che l'utente attualmente connesso sia lavorato per la nostra azienda (e pertanto può aggiornare tutte le informazioni sull'indirizzo di fornitori) o è associato il fornitore i cui dati vengono aggiornati.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-257">Likewise, the `UpdateSupplierAddress` method could include a check to ensure that the currently logged on user either worked for our company (and therefore can update all suppliers address information) or is associated with the supplier whose data is being updated.</span></span>

<span data-ttu-id="c9b2c-258">Tali controlli a livello BLL qui non ho incluso perché in questa esercitazione i diritti utente s sono determinati da un controllo DropDownList nella pagina, che non possono accedere le classi BLL.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-258">I did not include such BLL-layer checks here because in our tutorial the user s rights are determined by a DropDownList on the page, which the BLL classes cannot access.</span></span> <span data-ttu-id="c9b2c-259">Quando si usa il sistema di appartenenze o uno degli schemi di autenticazione out-pronte forniti da ASP.NET (ad esempio l'autenticazione di Windows), attualmente connesso in assegnare agli utenti informazioni e delle informazioni sui ruoli è possibile accedere dal livello BLL, in modo da ottenere autorizzazioni di accesso diritti controlla possibili nel server di presentazione e livelli BLL.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-259">When using the membership system or one of the out-of-the box authentication schemes provided by ASP.NET (such as Windows authentication), the currently logged on user s information and roles information can be accessed from the BLL, thereby making such access rights checks possible at both the presentation and BLL layers.</span></span>

## <a name="summary"></a><span data-ttu-id="c9b2c-260">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="c9b2c-260">Summary</span></span>

<span data-ttu-id="c9b2c-261">La maggior parte dei siti che forniscono gli account utente necessario personalizzare l'interfaccia di modifica dei dati in base all'utente connesso.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-261">Most sites that provide user accounts need to customize the data modification interface based upon the logged in user.</span></span> <span data-ttu-id="c9b2c-262">Utenti con privilegi amministrativi potrebbero essere possibile eliminare e modificare qualsiasi record, mentre gli utenti non amministratori possono essere limitati solo l'aggiornamento o eliminazione dei record creati da loro.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-262">Administrative users may be able to delete and edit any record, whereas non-administrative users may be limited to only updating or deleting records they created themselves.</span></span> <span data-ttu-id="c9b2c-263">Potrebbe essere insomma, i controlli Web, ObjectDataSource, dati e le classi di livello per la logica di Business possono essere esteso per aggiungere o impedire determinate funzionalità basate sull'utente attualmente connesso al computer.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-263">Whatever the scenario may be, the data Web controls, ObjectDataSource, and Business Logic Layer classes can be extended to add or deny certain functionality based on the logged on user.</span></span> <span data-ttu-id="c9b2c-264">In questa esercitazione è stato illustrato come limitare i dati visualizzabili e modificabili a seconda che l'utente sia stato associato a un particolare fornitore o se hanno collaborato per la nostra azienda.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-264">In this tutorial we saw how to limit the viewable and editable data depending on whether the user was associated with a particular supplier or if they worked for our company.</span></span>

<span data-ttu-id="c9b2c-265">Questa esercitazione è terminata l'esame di inserimento, aggiornamento ed eliminazione dei dati tramite i controlli GridView, DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-265">This tutorial concludes our examination of inserting, updating, and deleting data using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="c9b2c-266">Iniziando con l'esercitazione successiva, si sarà concentrare l'attenzione all'aggiunta di supporto per l'ordinamento e paging.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-266">Starting with the next tutorial, we'll turn our attention to adding paging and sorting support.</span></span>

<span data-ttu-id="c9b2c-267">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="c9b2c-267">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c9b2c-268">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="c9b2c-268">About the Author</span></span>

<span data-ttu-id="c9b2c-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c9b2c-270">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="c9b2c-270">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c9b2c-271">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-271">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c9b2c-272">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c9b2c-272">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c9b2c-273">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="c9b2c-273">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="c9b2c-274">Precedente</span><span class="sxs-lookup"><span data-stu-id="c9b2c-274">Previous</span></span>](adding-client-side-confirmation-when-deleting-vb.md)
