---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
title: Panoramica di inserimento, aggiornamento ed eliminazione di dati (VB) | Microsoft Docs
author: rick-anderson
description: In questa esercitazione verrà illustrato come eseguire il mapping dei metodi Insert (), Update () e Delete () di ObjectDataSource ai metodi delle classi BLL, nonché come configurare...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 35b40b8f-2ca8-4ab3-9c19-f361a91a3647
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 79491118ba1cbbc8c1b67ca9646a817d941f17ba
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78609634"
---
# <a name="an-overview-of-inserting-updating-and-deleting-data-vb"></a><span data-ttu-id="7e68c-103">Panoramica di inserimento, aggiornamento ed eliminazione di dati (VB)</span><span class="sxs-lookup"><span data-stu-id="7e68c-103">An Overview of Inserting, Updating, and Deleting Data (VB)</span></span>

<span data-ttu-id="7e68c-104">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7e68c-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7e68c-105">[Scaricare l'app di esempio](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe) o [scaricare il file PDF](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7e68c-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe) or [Download PDF](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span></span>

> <span data-ttu-id="7e68c-106">In questa esercitazione verrà illustrato come eseguire il mapping dei metodi Insert (), Update () e Delete () di ObjectDataSource ai metodi delle classi BLL, nonché come configurare i controlli GridView, DetailsView e FormView per fornire funzionalità di modifica dei dati.</span><span class="sxs-lookup"><span data-stu-id="7e68c-106">In this tutorial we'll see how to map an ObjectDataSource's Insert(), Update(), and Delete() methods to the methods of BLL classes, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="introduction"></a><span data-ttu-id="7e68c-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="7e68c-107">Introduction</span></span>

<span data-ttu-id="7e68c-108">Nelle esercitazioni precedenti sono state esaminate le procedure per visualizzare i dati in una pagina ASP.NET usando i controlli GridView, DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-108">Over the past several tutorials we've examined how to display data in an ASP.NET page using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="7e68c-109">Questi controlli funzionano semplicemente con i dati forniti.</span><span class="sxs-lookup"><span data-stu-id="7e68c-109">These controls simply work with data supplied to them.</span></span> <span data-ttu-id="7e68c-110">In genere, questi controlli accedono ai dati tramite l'uso di un controllo origine dati, ad esempio ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7e68c-110">Commonly, these controls access data through the use of a data source control, such as the ObjectDataSource.</span></span> <span data-ttu-id="7e68c-111">Abbiamo visto come ObjectDataSource funge da proxy tra la pagina ASP.NET e i dati sottostanti.</span><span class="sxs-lookup"><span data-stu-id="7e68c-111">We've seen how the ObjectDataSource acts as a proxy between the ASP.NET page and the underlying data.</span></span> <span data-ttu-id="7e68c-112">Quando un controllo GridView deve visualizzare i dati, richiama il metodo di `Select()` di ObjectDataSource, che a sua volta richiama un metodo dal livello di logica di business (BLL), che chiama un metodo nell'oggetto TableAdapter del livello di accesso ai dati (DAL) appropriato, che a sua volta invia una query di `SELECT` al database Northwind.</span><span class="sxs-lookup"><span data-stu-id="7e68c-112">When a GridView needs to display data, it invokes its ObjectDataSource's `Select()` method, which in turn invokes a method from our Business Logic Layer (BLL), which calls a method in the appropriate Data Access Layer's (DAL) TableAdapter, which in turn sends a `SELECT` query to the Northwind database.</span></span>

<span data-ttu-id="7e68c-113">Tenere presente che, durante la creazione degli oggetti TableAdapter nella [prima esercitazione](../introduction/creating-a-data-access-layer-cs.md), Visual Studio ha aggiunto automaticamente i metodi per l'inserimento, l'aggiornamento e l'eliminazione dei dati dalla tabella di database sottostante.</span><span class="sxs-lookup"><span data-stu-id="7e68c-113">Recall that when we created the TableAdapters in the DAL in [our first tutorial](../introduction/creating-a-data-access-layer-cs.md), Visual Studio automatically added methods for inserting, updating, and deleting data from the underlying database table.</span></span> <span data-ttu-id="7e68c-114">Inoltre, durante la [creazione di un livello di logica di business](../introduction/creating-a-business-logic-layer-vb.md) sono stati progettati metodi in BLL che hanno chiamato i metodi di modifica dei dati dal.</span><span class="sxs-lookup"><span data-stu-id="7e68c-114">Moreover, in [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) we designed methods in the BLL that called down into these data modification DAL methods.</span></span>

<span data-ttu-id="7e68c-115">Oltre al metodo `Select()`, ObjectDataSource dispone anche di metodi `Insert()`, `Update()`e `Delete()`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-115">In addition to its `Select()` method, the ObjectDataSource also has `Insert()`, `Update()`, and `Delete()` methods.</span></span> <span data-ttu-id="7e68c-116">Analogamente al metodo `Select()`, è possibile eseguire il mapping di questi tre metodi ai metodi di un oggetto sottostante.</span><span class="sxs-lookup"><span data-stu-id="7e68c-116">Like the `Select()` method, these three methods can be mapped to methods in an underlying object.</span></span> <span data-ttu-id="7e68c-117">Quando è configurato per inserire, aggiornare o eliminare dati, i controlli GridView, DetailsView e FormView forniscono un'interfaccia utente per la modifica dei dati sottostanti.</span><span class="sxs-lookup"><span data-stu-id="7e68c-117">When configured to insert, update, or delete data, the GridView, DetailsView, and FormView controls provide a user interface for modifying the underlying data.</span></span> <span data-ttu-id="7e68c-118">Questa interfaccia utente chiama i metodi `Insert()`, `Update()`e `Delete()` di ObjectDataSource, che quindi richiamano i metodi associati dell'oggetto sottostante (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="7e68c-118">This user interface calls the `Insert()`, `Update()`, and `Delete()` methods of the ObjectDataSource, which then invoke the underlying object's associated methods (see Figure 1).</span></span>

<span data-ttu-id="7e68c-119">[![i metodi Insert (), Update () e Delete () di ObjectDataSource vengono usati come proxy nel BLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-119">[![The ObjectDataSource's Insert(), Update(), and Delete() Methods Serve as a Proxy into the BLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span></span>

<span data-ttu-id="7e68c-120">**Figura 1**: i metodi di `Insert()`, `Update()`e `Delete()` di ObjectDataSource vengono usati come proxy nel BLL ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-120">**Figure 1**: The ObjectDataSource's `Insert()`, `Update()`, and `Delete()` Methods Serve as a Proxy into the BLL ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png))</span></span>

<span data-ttu-id="7e68c-121">In questa esercitazione verrà illustrato come eseguire il mapping dei metodi di `Insert()`, `Update()`e `Delete()` di ObjectDataSource ai metodi delle classi in BLL, nonché come configurare i controlli GridView, DetailsView e FormView per fornire funzionalità di modifica dei dati.</span><span class="sxs-lookup"><span data-stu-id="7e68c-121">In this tutorial we'll see how to map the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods to methods of classes in the BLL, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="step-1-creating-the-insert-update-and-delete-tutorials-web-pages"></a><span data-ttu-id="7e68c-122">Passaggio 1: creazione delle pagine Web delle esercitazioni di inserimento, aggiornamento ed eliminazione</span><span class="sxs-lookup"><span data-stu-id="7e68c-122">Step 1: Creating the Insert, Update, and Delete Tutorials Web Pages</span></span>

<span data-ttu-id="7e68c-123">Prima di iniziare a esplorare come inserire, aggiornare ed eliminare i dati, è necessario prima di tutto creare le pagine ASP.NET nel progetto del sito Web che saranno necessarie per questa esercitazione e le versioni successive.</span><span class="sxs-lookup"><span data-stu-id="7e68c-123">Before we start exploring how to insert, update, and delete data, let's first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="7e68c-124">Per iniziare, aggiungere una nuova cartella denominata `EditInsertDelete`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-124">Start by adding a new folder named `EditInsertDelete`.</span></span> <span data-ttu-id="7e68c-125">Aggiungere quindi le pagine ASP.NET seguenti a tale cartella, assicurandosi di associare ogni pagina alla pagina master `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="7e68c-125">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `DataModificationEvents.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`

![Aggiungere le pagine ASP.NET per le esercitazioni relative alla modifica dei dati](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image4.png)

<span data-ttu-id="7e68c-127">**Figura 2**: aggiungere le pagine ASP.NET per le esercitazioni relative alla modifica dei dati</span><span class="sxs-lookup"><span data-stu-id="7e68c-127">**Figure 2**: Add the ASP.NET Pages for the Data Modification-Related Tutorials</span></span>

<span data-ttu-id="7e68c-128">Analogamente alle altre cartelle, `Default.aspx` nella cartella `EditInsertDelete` elenca le esercitazioni nella sezione.</span><span class="sxs-lookup"><span data-stu-id="7e68c-128">Like in the other folders, `Default.aspx` in the `EditInsertDelete` folder will list the tutorials in its section.</span></span> <span data-ttu-id="7e68c-129">Si ricordi che il controllo utente `SectionLevelTutorialListing.ascx` fornisce questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="7e68c-129">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="7e68c-130">Quindi, aggiungere questo controllo utente a `Default.aspx` trascinandolo dall'Esplora soluzioni nella visualizzazione progettazione della pagina.</span><span class="sxs-lookup"><span data-stu-id="7e68c-130">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page's Design view.</span></span>

<span data-ttu-id="7e68c-131">[![aggiungere il controllo utente SectionLevelTutorialListing. ascx a default. aspx](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-131">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span></span>

<span data-ttu-id="7e68c-132">**Figura 3**: aggiungere il controllo utente `SectionLevelTutorialListing.ascx` al `Default.aspx` ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-132">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png))</span></span>

<span data-ttu-id="7e68c-133">Aggiungere infine le pagine come voci al file di `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-133">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="7e68c-134">In particolare, aggiungere il markup seguente dopo il `<siteMapNode>`di formattazione personalizzato:</span><span class="sxs-lookup"><span data-stu-id="7e68c-134">Specifically, add the following markup after the Customized Formatting `<siteMapNode>`:</span></span>

[!code-xml[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample1.xml)]

<span data-ttu-id="7e68c-135">Dopo avere aggiornato `Web.sitemap`, è possibile visualizzare il sito Web delle esercitazioni tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="7e68c-135">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="7e68c-136">Il menu a sinistra include ora gli elementi per le esercitazioni di modifica, inserimento ed eliminazione.</span><span class="sxs-lookup"><span data-stu-id="7e68c-136">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![La mappa del sito include ora le voci per le esercitazioni di modifica, inserimento ed eliminazione](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image8.png)

<span data-ttu-id="7e68c-138">**Figura 4**: la mappa del sito include ora le voci per le esercitazioni di modifica, inserimento ed eliminazione</span><span class="sxs-lookup"><span data-stu-id="7e68c-138">**Figure 4**: The Site Map Now Includes Entries for the Editing, Inserting, and Deleting Tutorials</span></span>

## <a name="step-2-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="7e68c-139">Passaggio 2: aggiunta e configurazione del controllo ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="7e68c-139">Step 2: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="7e68c-140">Poiché GridView, DetailsView e FormView si differenziano per le funzionalità di modifica dei dati e il layout, esaminiamo singolarmente ognuno di essi.</span><span class="sxs-lookup"><span data-stu-id="7e68c-140">Since the GridView, DetailsView, and FormView each differ in their data modification capabilities and layout, let's examine each one individually.</span></span> <span data-ttu-id="7e68c-141">Anziché fare in modo che ogni controllo usi il proprio ObjectDataSource, tuttavia, creiamo un solo ObjectDataSource che tutti e tre gli esempi di controllo possono condividere.</span><span class="sxs-lookup"><span data-stu-id="7e68c-141">Rather than have each control using its own ObjectDataSource, however, let's just create a single ObjectDataSource that all three control examples can share.</span></span>

<span data-ttu-id="7e68c-142">Aprire la pagina `Basics.aspx`, trascinare un ObjectDataSource dalla casella degli strumenti nella finestra di progettazione, quindi fare clic sul collegamento Configura origine dati dallo smart tag.</span><span class="sxs-lookup"><span data-stu-id="7e68c-142">Open the `Basics.aspx` page, drag an ObjectDataSource from the Toolbox onto the Designer, and click the Configure Data Source link from its smart tag.</span></span> <span data-ttu-id="7e68c-143">Poiché il `ProductsBLL` è l'unica classe BLL che fornisce i metodi di modifica, inserimento ed eliminazione, configurare ObjectDataSource per l'utilizzo di questa classe.</span><span class="sxs-lookup"><span data-stu-id="7e68c-143">Since the `ProductsBLL` is the only BLL class that provides editing, inserting, and deleting methods, configure the ObjectDataSource to use this class.</span></span>

<span data-ttu-id="7e68c-144">[![configurare ObjectDataSource per l'utilizzo della classe ProductsBLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-144">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span></span>

<span data-ttu-id="7e68c-145">**Figura 5**: configurare ObjectDataSource per l'uso della classe `ProductsBLL` ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-145">**Figure 5**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png))</span></span>

<span data-ttu-id="7e68c-146">Nella schermata successiva è possibile specificare i metodi della classe `ProductsBLL` mappati ai `Select()`, `Insert()`, `Update()`e `Delete()` di ObjectDataSource selezionando la scheda appropriata e scegliendo il metodo dall'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="7e68c-146">In the next screen we can specify what methods of the `ProductsBLL` class are mapped to the ObjectDataSource's `Select()`, `Insert()`, `Update()`, and `Delete()` by selecting the appropriate tab and choosing the method from the drop-down list.</span></span> <span data-ttu-id="7e68c-147">Figura 6, che dovrebbe avere un aspetto familiare da ora, esegue il mapping del metodo `Select()` di ObjectDataSource al metodo `GetProducts()` della classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-147">Figure 6, which should look familiar by now, maps the ObjectDataSource's `Select()` method to the `ProductsBLL` class's `GetProducts()` method.</span></span> <span data-ttu-id="7e68c-148">È possibile configurare i metodi `Insert()`, `Update()`e `Delete()` selezionando la scheda appropriata dall'elenco lungo la parte superiore.</span><span class="sxs-lookup"><span data-stu-id="7e68c-148">The `Insert()`, `Update()`, and `Delete()` methods can be configured by selecting the appropriate tab from the list along the top.</span></span>

<span data-ttu-id="7e68c-149">[![che ObjectDataSource restituisca tutti i prodotti](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-149">[![Have the ObjectDataSource Return All of the Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span></span>

<span data-ttu-id="7e68c-150">**Figura 6**: fare in modo che ObjectDataSource restituisca tutti i prodotti ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-150">**Figure 6**: Have the ObjectDataSource Return All of the Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png))</span></span>

<span data-ttu-id="7e68c-151">Figure 7, 8 e 9 mostrano le schede di aggiornamento, inserimento ed eliminazione di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7e68c-151">Figures 7, 8, and 9 show the ObjectDataSource's UPDATE, INSERT, and DELETE tabs.</span></span> <span data-ttu-id="7e68c-152">Configurare queste schede in modo che i metodi `Insert()`, `Update()`e `Delete()` richiamino rispettivamente i metodi `UpdateProduct`, `AddProduct`e `DeleteProduct` della classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-152">Configure these tabs so that the `Insert()`, `Update()`, and `Delete()` methods invoke the `ProductsBLL` class's `UpdateProduct`, `AddProduct`, and `DeleteProduct` methods, respectively.</span></span>

<span data-ttu-id="7e68c-153">[![mappare il metodo Update () di ObjectDataSource al metodo UpdateProduct della classe ProductBLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-153">[![Map the ObjectDataSource's Update() Method to the ProductBLL Class's UpdateProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span></span>

<span data-ttu-id="7e68c-154">**Figura 7**: eseguire il mapping del metodo di `Update()` di ObjectDataSource al metodo `UpdateProduct` della classe `ProductBLL` ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-154">**Figure 7**: Map the ObjectDataSource's `Update()` Method to the `ProductBLL` Class's `UpdateProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png))</span></span>

<span data-ttu-id="7e68c-155">[![mappare il metodo Insert () di ObjectDataSource al metodo AddProduct della classe ProductBLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-155">[![Map the ObjectDataSource's Insert() Method to the ProductBLL Class's AddProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span></span>

<span data-ttu-id="7e68c-156">**Figura 8**: eseguire il mapping del metodo di `Insert()` di ObjectDataSource al metodo Add `Product` della classe `ProductBLL` ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-156">**Figure 8**: Map the ObjectDataSource's `Insert()` Method to the `ProductBLL` Class's Add `Product` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png))</span></span>

<span data-ttu-id="7e68c-157">[![mappare il metodo Delete () di ObjectDataSource al metodo DeleteProduct della classe ProductBLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-157">[![Map the ObjectDataSource's Delete() Method to the ProductBLL Class's DeleteProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span></span>

<span data-ttu-id="7e68c-158">**Figura 9**: eseguire il mapping del metodo di `Delete()` di ObjectDataSource al metodo `DeleteProduct` della classe `ProductBLL` ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-158">**Figure 9**: Map the ObjectDataSource's `Delete()` Method to the `ProductBLL` Class's `DeleteProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png))</span></span>

<span data-ttu-id="7e68c-159">È possibile che si sia notato che questi metodi sono già stati selezionati negli elenchi a discesa nelle schede di aggiornamento, inserimento ed eliminazione.</span><span class="sxs-lookup"><span data-stu-id="7e68c-159">You may have noticed that the drop-down lists in the UPDATE, INSERT, and DELETE tabs already had these methods selected.</span></span> <span data-ttu-id="7e68c-160">Questo è grazie all'uso del `DataObjectMethodAttribute` che decora i metodi di `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-160">This is thanks to our use of the `DataObjectMethodAttribute` that decorates the methods of `ProductsBLL`.</span></span> <span data-ttu-id="7e68c-161">Il metodo DeleteProduct, ad esempio, ha la firma seguente:</span><span class="sxs-lookup"><span data-stu-id="7e68c-161">For example, the DeleteProduct method has the following signature:</span></span>

[!code-vb[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample2.vb)]

<span data-ttu-id="7e68c-162">L'attributo `DataObjectMethodAttribute` indica lo scopo di ogni metodo se è per la selezione, l'inserimento, l'aggiornamento o l'eliminazione e se è il valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="7e68c-162">The `DataObjectMethodAttribute` attribute indicates the purpose of each method whether it is for selecting, inserting, updating, or deleting and whether or not it's the default value.</span></span> <span data-ttu-id="7e68c-163">Se questi attributi sono stati omessi quando si creano le classi BLL, sarà necessario selezionare manualmente i metodi dalle schede Aggiorna, Inserisci ed Elimina.</span><span class="sxs-lookup"><span data-stu-id="7e68c-163">If you omitted these attributes when creating your BLL classes, you'll need to manually select the methods from the UPDATE, INSERT, and DELETE tabs.</span></span>

<span data-ttu-id="7e68c-164">Dopo aver verificato che sia stato eseguito il mapping dei metodi di `ProductsBLL` appropriati ai metodi `Insert()`, `Update()`e `Delete()` di ObjectDataSource, fare clic su fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="7e68c-164">After ensuring that the appropriate `ProductsBLL` methods are mapped to the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods, click Finish to complete the wizard.</span></span>

## <a name="examining-the-objectdatasources-markup"></a><span data-ttu-id="7e68c-165">Esame del markup di ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="7e68c-165">Examining the ObjectDataSource's Markup</span></span>

<span data-ttu-id="7e68c-166">Dopo aver configurato ObjectDataSource tramite la procedura guidata, passare alla visualizzazione origine per esaminare il markup dichiarativo generato.</span><span class="sxs-lookup"><span data-stu-id="7e68c-166">After configuring the ObjectDataSource through its wizard, go to the Source view to examine the generated declarative markup.</span></span> <span data-ttu-id="7e68c-167">Il tag `<asp:ObjectDataSource>` specifica l'oggetto sottostante e i metodi da richiamare.</span><span class="sxs-lookup"><span data-stu-id="7e68c-167">The `<asp:ObjectDataSource>` tag specifies the underlying object and the methods to invoke.</span></span> <span data-ttu-id="7e68c-168">Sono inoltre disponibili `DeleteParameters`, `UpdateParameters`e `InsertParameters` che eseguono il mapping ai parametri di input per i metodi `AddProduct`, `UpdateProduct`e `DeleteProduct` della classe `ProductsBLL`:</span><span class="sxs-lookup"><span data-stu-id="7e68c-168">Additionally, there are `DeleteParameters`, `UpdateParameters`, and `InsertParameters` that map to the input parameters for the `ProductsBLL` class's `AddProduct`, `UpdateProduct`, and `DeleteProduct` methods:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample3.aspx)]

<span data-ttu-id="7e68c-169">ObjectDataSource include un parametro per ognuno dei parametri di input per i metodi associati, analogamente a un elenco di `SelectParameter` s è presente quando ObjectDataSource è configurato per chiamare un metodo Select che prevede un parametro di input, ad esempio `GetProductsByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-169">The ObjectDataSource includes a parameter for each of the input parameters for its associated methods, just like a list of `SelectParameter` s is present when the ObjectDataSource is configured to call a select method that expects an input parameter (such as `GetProductsByCategoryID(categoryID)`).</span></span> <span data-ttu-id="7e68c-170">Come si vedrà a breve, i valori per questi `DeleteParameters`, `UpdateParameters`e `InsertParameters` vengono impostati automaticamente da GridView, DetailsView e FormView prima di richiamare il metodo di `Insert()`, `Update()`o `Delete()` di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7e68c-170">As we'll see shortly, values for these `DeleteParameters`, `UpdateParameters`, and `InsertParameters` are set automatically by the GridView, DetailsView, and FormView prior to invoking the ObjectDataSource's `Insert()`, `Update()`, or `Delete()` method.</span></span> <span data-ttu-id="7e68c-171">Questi valori possono essere impostati anche a livello di codice in base alle esigenze, come verrà illustrato in un'esercitazione futura.</span><span class="sxs-lookup"><span data-stu-id="7e68c-171">These values can also be set programmatically as needed, as we'll discuss in a future tutorial.</span></span>

<span data-ttu-id="7e68c-172">Un effetto collaterale dell'utilizzo della procedura guidata per la configurazione di ObjectDataSource è che Visual Studio imposta la [proprietà OldValuesParameterFormatString](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx) su `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-172">One side effect of using the wizard to configure to ObjectDataSource is that Visual Studio sets the [OldValuesParameterFormatString property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx) to `original_{0}`.</span></span> <span data-ttu-id="7e68c-173">Il valore di questa proprietà viene utilizzato per includere i valori originali dei dati modificati ed è utile in due scenari:</span><span class="sxs-lookup"><span data-stu-id="7e68c-173">This property value is used to include the original values of the data being edited and is useful in two scenarios:</span></span>

- <span data-ttu-id="7e68c-174">Se, durante la modifica di un record, gli utenti sono in grado di modificare il valore della chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="7e68c-174">If, when editing a record, users are able to change the primary key value.</span></span> <span data-ttu-id="7e68c-175">In questo caso, è necessario specificare sia il nuovo valore di chiave primaria che quello originale della chiave primaria, in modo che sia possibile trovare il record con il valore di chiave primaria originale e che il relativo valore sia aggiornato di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="7e68c-175">In this case, both the new primary key value and the original primary key value must be provided so that the record with the original primary key value can be found and have its value updated accordingly.</span></span>
- <span data-ttu-id="7e68c-176">Quando si usa la concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="7e68c-176">When using optimistic concurrency.</span></span> <span data-ttu-id="7e68c-177">La concorrenza ottimistica è una tecnica per garantire che due utenti simultanei non sovrascrivano le modifiche di un altro e che sia l'argomento per un'esercitazione futura.</span><span class="sxs-lookup"><span data-stu-id="7e68c-177">Optimistic concurrency is a technique to ensure that two simultaneous users don't overwrite one another's changes, and is the topic for a future tutorial.</span></span>

<span data-ttu-id="7e68c-178">La proprietà `OldValuesParameterFormatString` indica il nome dei parametri di input nei metodi Update e Delete dell'oggetto sottostante per i valori originali.</span><span class="sxs-lookup"><span data-stu-id="7e68c-178">The `OldValuesParameterFormatString` property indicates the name of the input parameters in the underlying object's update and delete methods for the original values.</span></span> <span data-ttu-id="7e68c-179">Questa proprietà e il suo scopo verranno illustrati in modo più dettagliato quando si Esplora la concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="7e68c-179">We'll discuss this property and its purpose in greater detail when we explore optimistic concurrency.</span></span> <span data-ttu-id="7e68c-180">Ora, tuttavia, poiché i metodi del BLL non prevedono i valori originali ed è quindi importante che questa proprietà venga rimossa.</span><span class="sxs-lookup"><span data-stu-id="7e68c-180">I bring it up now, however, because our BLL's methods do not expect the original values and therefore it's important that we remove this property.</span></span> <span data-ttu-id="7e68c-181">Se si lascia la proprietà `OldValuesParameterFormatString` impostata su un valore diverso da quello predefinito (`{0}`), si verificherà un errore quando un controllo Web dei dati tenta di richiamare i metodi di `Update()` o `Delete()` di ObjectDataSource perché ObjectDataSource tenterà di passare sia il `UpdateParameters` sia il `DeleteParameters` specificato, nonché i parametri del valore originale.</span><span class="sxs-lookup"><span data-stu-id="7e68c-181">Leaving the `OldValuesParameterFormatString` property set to anything other than the default (`{0}`) will cause an error when a data Web control attempts to invoke the ObjectDataSource's `Update()` or `Delete()` methods because the ObjectDataSource will attempt to pass in both the `UpdateParameters` or `DeleteParameters` specified as well as original value parameters.</span></span>

<span data-ttu-id="7e68c-182">Se questo non è molto chiaro in questo frangente, si esamineranno questa proprietà e la relativa utilità in un'esercitazione futura.</span><span class="sxs-lookup"><span data-stu-id="7e68c-182">If this isn't terribly clear at this juncture, don't worry, we'll examine this property and its utility in a future tutorial.</span></span> <span data-ttu-id="7e68c-183">Per il momento, è sufficiente assicurarsi di rimuovere questa dichiarazione di proprietà interamente dalla sintassi dichiarativa o di impostare il valore predefinito ({0}).</span><span class="sxs-lookup"><span data-stu-id="7e68c-183">For now, just be certain to either remove this property declaration entirely from the declarative syntax or set the value to the default value ({0}).</span></span>

> [!NOTE]
> <span data-ttu-id="7e68c-184">Se si deseleziona semplicemente il valore della proprietà `OldValuesParameterFormatString` dal Finestra Proprietà nella visualizzazione progettazione, la proprietà continuerà a esistere nella sintassi dichiarativa, ma sarà impostata su una stringa vuota.</span><span class="sxs-lookup"><span data-stu-id="7e68c-184">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but be set to an empty string.</span></span> <span data-ttu-id="7e68c-185">Questo, sfortunatamente, provocherà comunque lo stesso problema descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="7e68c-185">This, unfortunately, will still result in the same problem discussed above.</span></span> <span data-ttu-id="7e68c-186">Pertanto, rimuovere completamente la proprietà dalla sintassi dichiarativa oppure, dal Finestra Proprietà, impostare il valore predefinito, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-186">Therefore, either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>

## <a name="step-3-adding-a-data-web-control-and-configuring-it-for-data-modification"></a><span data-ttu-id="7e68c-187">Passaggio 3: aggiunta di un controllo Web dati e configurazione per la modifica dei dati</span><span class="sxs-lookup"><span data-stu-id="7e68c-187">Step 3: Adding a Data Web Control and Configuring It for Data Modification</span></span>

<span data-ttu-id="7e68c-188">Una volta che ObjectDataSource è stato aggiunto alla pagina e configurato, è possibile aggiungere i controlli Web di dati alla pagina per visualizzare i dati e fornire agli utenti finali la possibilità di modificarli.</span><span class="sxs-lookup"><span data-stu-id="7e68c-188">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to both display the data and provide a means for the end user to modify it.</span></span> <span data-ttu-id="7e68c-189">I controlli GridView, DetailsView e FormView verranno esaminati separatamente, poiché questi controlli Web dei dati differiscono in base alle funzionalità di modifica dei dati e alla configurazione.</span><span class="sxs-lookup"><span data-stu-id="7e68c-189">We'll look at the GridView, DetailsView, and FormView separately, as these data Web controls differ in their data modification capabilities and configuration.</span></span>

<span data-ttu-id="7e68c-190">Come si vedrà nella parte restante di questo articolo, l'aggiunta del supporto di modifica, inserimento ed eliminazione di base tramite i controlli GridView, DetailsView e FormView è molto semplice quanto la verifica di un paio di caselle di controllo.</span><span class="sxs-lookup"><span data-stu-id="7e68c-190">As we'll see in the remainder of this article, adding very basic editing, inserting, and deleting support through the GridView, DetailsView, and FormView controls is really as simple as checking a couple of checkboxes.</span></span> <span data-ttu-id="7e68c-191">Nel mondo reale sono presenti molte sottigliezze e casi limite che rendono più complessa la fornitura di funzionalità di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="7e68c-191">There are many subtleties and edge cases in the real-world that make providing such functionality more involved than just point and click.</span></span> <span data-ttu-id="7e68c-192">Questa esercitazione, tuttavia, si concentra esclusivamente sulla dimostrazione di semplici funzionalità di modifica dei dati.</span><span class="sxs-lookup"><span data-stu-id="7e68c-192">This tutorial, however, focuses solely on proving simplistic data modification capabilities.</span></span> <span data-ttu-id="7e68c-193">Nelle esercitazioni future vengono esaminati i problemi che indubbiamente si verificano in un'impostazione del mondo reale.</span><span class="sxs-lookup"><span data-stu-id="7e68c-193">Future tutorials will examine concerns that will undoubtedly arise in a real-world setting.</span></span>

## <a name="deleting-data-from-the-gridview"></a><span data-ttu-id="7e68c-194">Eliminazione di dati da GridView</span><span class="sxs-lookup"><span data-stu-id="7e68c-194">Deleting Data from the GridView</span></span>

<span data-ttu-id="7e68c-195">Per iniziare, trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="7e68c-195">Start by dragging a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="7e68c-196">Quindi, associare ObjectDataSource a GridView selezionandola dall'elenco a discesa nello smart tag di GridView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-196">Next, bind the ObjectDataSource to the GridView by selecting it from the drop-down list in the GridView's smart tag.</span></span> <span data-ttu-id="7e68c-197">A questo punto, il markup dichiarativo di GridView sarà:</span><span class="sxs-lookup"><span data-stu-id="7e68c-197">At this point the GridView's declarative markup will be:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample4.aspx)]

<span data-ttu-id="7e68c-198">L'associazione di GridView a ObjectDataSource tramite il relativo smart tag offre due vantaggi:</span><span class="sxs-lookup"><span data-stu-id="7e68c-198">Binding the GridView to the ObjectDataSource through its smart tag has two benefits:</span></span>

- <span data-ttu-id="7e68c-199">I BoundField e CheckBoxFields vengono creati automaticamente per ogni campo restituito da ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7e68c-199">BoundFields and CheckBoxFields are automatically created for each of the fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="7e68c-200">Inoltre, le proprietà BoundField e CheckBoxField vengono impostate in base ai metadati del campo sottostante.</span><span class="sxs-lookup"><span data-stu-id="7e68c-200">Moreover, the BoundField and CheckBoxField's properties are set based on the underlying field's metadata.</span></span> <span data-ttu-id="7e68c-201">Ad esempio, i campi `ProductID`, `CategoryName`e `SupplierName` sono contrassegnati come di sola lettura nel `ProductsDataTable` e pertanto non devono essere aggiornabili durante la modifica.</span><span class="sxs-lookup"><span data-stu-id="7e68c-201">For example, the `ProductID`, `CategoryName`, and `SupplierName` fields are marked as read-only in the `ProductsDataTable` and therefore shouldn't be updatable when editing.</span></span> <span data-ttu-id="7e68c-202">Per risolvere questo problema, queste proprietà di sola [lettura](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx) dei BoundField sono impostate su `True`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-202">To accommodate this, these BoundFields' [ReadOnly properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx) are set to `True`.</span></span>
- <span data-ttu-id="7e68c-203">La [proprietà al DataKeyNames](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx) viene assegnata ai campi di chiave primaria dell'oggetto sottostante.</span><span class="sxs-lookup"><span data-stu-id="7e68c-203">The [DataKeyNames property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx) is assigned to the primary key field(s) of the underlying object.</span></span> <span data-ttu-id="7e68c-204">Questo è essenziale quando si usa GridView per la modifica o l'eliminazione di dati, in quanto questa proprietà indica il campo (o set di campi) che identifica in modo univoco ogni record.</span><span class="sxs-lookup"><span data-stu-id="7e68c-204">This is essential when using the GridView for editing or deleting data, as this property indicates the field (or set of fields) that unique identifies each record.</span></span> <span data-ttu-id="7e68c-205">Per altre informazioni sulla proprietà `DataKeyNames`, fare riferimento al [master o al dettaglio usando un controllo GridView Master selezionabile con un'esercitazione relativa a controllo DetailView per dettagli](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="7e68c-205">For more information on the `DataKeyNames` property, refer back to the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="7e68c-206">Mentre GridView può essere associato a ObjectDataSource attraverso la Finestra Proprietà o la sintassi dichiarativa, in questo modo è necessario aggiungere manualmente il BoundField e `DataKeyNames` markup appropriati.</span><span class="sxs-lookup"><span data-stu-id="7e68c-206">While the GridView can be bound to the ObjectDataSource through the Properties window or declarative syntax, doing so requires you to manually add the appropriate BoundField and `DataKeyNames` markup.</span></span>

<span data-ttu-id="7e68c-207">Il controllo GridView fornisce supporto incorporato per la modifica e l'eliminazione a livello di riga.</span><span class="sxs-lookup"><span data-stu-id="7e68c-207">The GridView control provides built-in support for row-level editing and deleting.</span></span> <span data-ttu-id="7e68c-208">La configurazione di GridView per supportare l'eliminazione consente di aggiungere una colonna di pulsanti Delete.</span><span class="sxs-lookup"><span data-stu-id="7e68c-208">Configuring a GridView to support deleting adds a column of Delete buttons.</span></span> <span data-ttu-id="7e68c-209">Quando l'utente finale fa clic sul pulsante Elimina per una determinata riga, si verifica un postback e GridView esegue i passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="7e68c-209">When the end user clicks the Delete button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="7e68c-210">I valori `DeleteParameters` di ObjectDataSource sono assegnati</span><span class="sxs-lookup"><span data-stu-id="7e68c-210">The ObjectDataSource's `DeleteParameters` value(s) are assigned</span></span>
2. <span data-ttu-id="7e68c-211">Viene richiamato il metodo di `Delete()` di ObjectDataSource, che elimina il record specificato</span><span class="sxs-lookup"><span data-stu-id="7e68c-211">The ObjectDataSource's `Delete()` method is invoked, deleting the specified record</span></span>
3. <span data-ttu-id="7e68c-212">GridView viene riassociato a ObjectDataSource richiamando il relativo metodo `Select()`</span><span class="sxs-lookup"><span data-stu-id="7e68c-212">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="7e68c-213">I valori assegnati all'`DeleteParameters` sono i valori dei campi `DataKeyNames` per la riga di cui è stato fatto clic sul pulsante Elimina.</span><span class="sxs-lookup"><span data-stu-id="7e68c-213">The values assigned to the `DeleteParameters` are the values of the `DataKeyNames` field(s) for the row whose Delete button was clicked.</span></span> <span data-ttu-id="7e68c-214">È pertanto fondamentale impostare correttamente la proprietà `DataKeyNames` di GridView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-214">Therefore it's vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="7e68c-215">Se non è presente, all'`DeleteParameters` verrà assegnato il valore `Nothing` nel passaggio 1, che a sua volta non comporterà alcun record eliminato nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="7e68c-215">If it's missing, the `DeleteParameters` will be assigned a value of `Nothing` in Step 1, which in turn will not result in any deleted records in Step 2.</span></span>

> [!NOTE]
> <span data-ttu-id="7e68c-216">La raccolta di `DataKeys` viene archiviata nello stato di controllo di GridView, ovvero i valori di `DataKeys` verranno memorizzati durante il postback anche se lo stato di visualizzazione di GridView s è stato disabilitato.</span><span class="sxs-lookup"><span data-stu-id="7e68c-216">The `DataKeys` collection is stored in the GridView s control state, meaning that the `DataKeys` values will be remembered across postback even if the GridView s view state has been disabled.</span></span> <span data-ttu-id="7e68c-217">Tuttavia, è molto importante che lo stato di visualizzazione rimanga abilitato per GridView che supportano la modifica o l'eliminazione (comportamento predefinito).</span><span class="sxs-lookup"><span data-stu-id="7e68c-217">However, it is very important that view state remains enabled for GridViews that support editing or deleting (the default behavior).</span></span> <span data-ttu-id="7e68c-218">Se si imposta la proprietà `EnableViewState` GridView s su `false`, il comportamento di modifica ed eliminazione funzionerà in modo corretto per un singolo utente, ma se sono presenti utenti simultanei che eliminano i dati, è possibile che questi utenti simultanei eliminino o modifichino i record non desiderati.</span><span class="sxs-lookup"><span data-stu-id="7e68c-218">If you set the GridView s `EnableViewState` property to `false`, the editing and deleting behavior will work fine for a single user, but if there are concurrent users deleting data, there exists the possibility that these concurrent users may accidentally delete or edit records that they didn't intend.</span></span> <span data-ttu-id="7e68c-219">Vedere il mio intervento sul Blog, [Avviso: problema di concorrenza con ASP.NET 2,0 GridView/DetailsView/formviews che supportano la modifica e/o l'eliminazione e il cui stato di visualizzazione è disabilitato](http://scottonwriting.net/sowblog/posts/10054.aspx). per altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="7e68c-219">See my blog entry, [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx), for more information.</span></span>

<span data-ttu-id="7e68c-220">Questo stesso avviso si applica anche a DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-220">This same warning also applies to DetailsViews and FormViews.</span></span>

<span data-ttu-id="7e68c-221">Per aggiungere funzionalità di eliminazione a GridView, è sufficiente passare al relativo smart tag e selezionare la casella di controllo Abilita eliminazione.</span><span class="sxs-lookup"><span data-stu-id="7e68c-221">To add deleting capabilities to a GridView, simply go to its smart tag and check the Enable Deleting checkbox.</span></span>

![Selezionare la casella di controllo Abilita eliminazione](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image24.png)

<span data-ttu-id="7e68c-223">**Figura 10**: selezionare la casella di controllo Abilita eliminazione</span><span class="sxs-lookup"><span data-stu-id="7e68c-223">**Figure 10**: Check the Enable Deleting Checkbox</span></span>

<span data-ttu-id="7e68c-224">Se si seleziona la casella di controllo Abilita eliminazione dallo smart tag, viene aggiunto un oggetto CommandField al controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-224">Checking the Enable Deleting checkbox from the smart tag adds a CommandField to the GridView.</span></span> <span data-ttu-id="7e68c-225">CommandField esegue il rendering di una colonna in GridView con i pulsanti per l'esecuzione di una o più delle attività seguenti: selezione di un record, modifica di un record ed eliminazione di un record.</span><span class="sxs-lookup"><span data-stu-id="7e68c-225">The CommandField renders a column in the GridView with buttons for performing one or more of the following tasks: selecting a record, editing a record, and deleting a record.</span></span> <span data-ttu-id="7e68c-226">In precedenza, il CommandField è stato visto in azione con la selezione di record in [Master/Detail usando un'esercitazione GridView selezionabile con controllo DetailView per](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="7e68c-226">We previously saw the CommandField in action with selecting records in the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="7e68c-227">CommandField contiene una serie di `ShowXButton` proprietà che indicano la serie di pulsanti visualizzati in CommandField.</span><span class="sxs-lookup"><span data-stu-id="7e68c-227">The CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="7e68c-228">Selezionando la casella di controllo Abilita eliminazione di un oggetto CommandField il cui `ShowDeleteButton` proprietà è `True` è stato aggiunto alla raccolta Columns di GridView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-228">By checking the Enable Deleting checkbox a CommandField whose `ShowDeleteButton` property is `True` has been added to the GridView's Columns collection.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample5.aspx)]

<span data-ttu-id="7e68c-229">A questo punto, è possibile ritenerlo o meno. l'aggiunta del supporto per l'eliminazione a GridView è stata eseguita.</span><span class="sxs-lookup"><span data-stu-id="7e68c-229">At this point, believe it or not, we're done with adding deleting support to the GridView!</span></span> <span data-ttu-id="7e68c-230">Come illustrato nella figura 11, quando si visita questa pagina tramite un browser è presente una colonna di pulsanti Delete.</span><span class="sxs-lookup"><span data-stu-id="7e68c-230">As Figure 11 shows, when visiting this page through a browser a column of Delete buttons is present.</span></span>

<span data-ttu-id="7e68c-231">[![CommandField aggiunge una colonna di pulsanti Delete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-231">[![The CommandField Adds a Column of Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span></span>

<span data-ttu-id="7e68c-232">**Figura 11**: CommandField aggiunge una colonna di pulsanti Delete ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-232">**Figure 11**: The CommandField Adds a Column of Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png))</span></span>

<span data-ttu-id="7e68c-233">Se questa esercitazione è stata compilata autonomamente, quando si esegue il test della pagina facendo clic sul pulsante Elimina verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="7e68c-233">If you've been building this tutorial from the ground up on your own, when testing this page clicking the Delete button will raise an exception.</span></span> <span data-ttu-id="7e68c-234">Continuare la lettura per informazioni sul motivo per cui queste eccezioni sono state generate e su come risolverle.</span><span class="sxs-lookup"><span data-stu-id="7e68c-234">Continue reading to learn as to why these exceptions were raised and how to fix them.</span></span>

> [!NOTE]
> <span data-ttu-id="7e68c-235">Se si sta seguendo le istruzioni riportate in questa esercitazione, è già stato preso in considerazione questi problemi.</span><span class="sxs-lookup"><span data-stu-id="7e68c-235">If you're following along using the download accompanying this tutorial, these problems have already been accounted for.</span></span> <span data-ttu-id="7e68c-236">Tuttavia, si consiglia di leggere i dettagli elencati di seguito per identificare i problemi che possono verificarsi e le soluzioni alternative appropriate.</span><span class="sxs-lookup"><span data-stu-id="7e68c-236">However, I encourage you to read through the details listed below to help identify problems that may arise and suitable workarounds.</span></span>

<span data-ttu-id="7e68c-237">Se, quando si tenta di eliminare un prodotto, viene generata un'eccezione il cui messaggio è simile a "ObjectDataSource" ObjectDataSource1 "non è in*grado di trovare un metodo non generico" DeleteProduct "con parametri: ProductID, original\_ProductID*", probabilmente si dimentica di rimuovere la proprietà `OldValuesParameterFormatString` da ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7e68c-237">If, when attempting to delete a product, you get an exception whose message is similar to "*ObjectDataSource 'ObjectDataSource1' could not find a non-generic method 'DeleteProduct' that has parameters: productID, original\_ProductID*," you likely forgot to remove the `OldValuesParameterFormatString` property from the ObjectDataSource.</span></span> <span data-ttu-id="7e68c-238">Con la proprietà `OldValuesParameterFormatString` specificata, ObjectDataSource tenta di passare i parametri di input `productID` e `original_ProductID` al metodo `DeleteProduct`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-238">With the `OldValuesParameterFormatString` property specified, the ObjectDataSource attempts to pass in both `productID` and `original_ProductID` input parameters to the `DeleteProduct` method.</span></span> <span data-ttu-id="7e68c-239">`DeleteProduct`, tuttavia, accetta solo un singolo parametro di input, di conseguenza l'eccezione.</span><span class="sxs-lookup"><span data-stu-id="7e68c-239">`DeleteProduct`, however, only accepts a single input parameter, hence the exception.</span></span> <span data-ttu-id="7e68c-240">Se si rimuove la proprietà `OldValuesParameterFormatString` o la si imposta su `{0}`, l'oggetto ObjectDataSource non tenterà di passare il parametro di input originale.</span><span class="sxs-lookup"><span data-stu-id="7e68c-240">Removing the `OldValuesParameterFormatString` property (or setting it to `{0}`) instructs the ObjectDataSource to not attempt to pass in the original input parameter.</span></span>

<span data-ttu-id="7e68c-241">[![assicurarsi che la proprietà OldValuesParameterFormatString sia stata eliminata](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-241">[![Ensure That the OldValuesParameterFormatString Property Has Been Cleared Out](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span></span>

<span data-ttu-id="7e68c-242">**Figura 12**: assicurarsi che la proprietà `OldValuesParameterFormatString` sia stata cancellata ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-242">**Figure 12**: Ensure That the `OldValuesParameterFormatString` Property Has Been Cleared Out ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png))</span></span>

<span data-ttu-id="7e68c-243">Anche se è stata rimossa la proprietà `OldValuesParameterFormatString`, viene comunque generata un'eccezione quando si tenta di eliminare un prodotto con il messaggio: "*l'istruzione DELETE è in conflitto con il vincolo di riferimento ' FK\_Order\_Details\_Products '* ". Il database Northwind contiene un vincolo FOREIGN KEY tra il `Order Details` e la tabella `Products`, ovvero non è possibile eliminare un prodotto dal sistema se sono presenti uno o più record nella tabella `Order Details`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-243">Even if you had removed the `OldValuesParameterFormatString` property, you still will get an exception when trying to delete a product with the message: "*The DELETE statement conflicted with the REFERENCE constraint 'FK\_Order\_Details\_Products'*." The Northwind database contains a foreign key constraint between the `Order Details` and `Products` table, meaning that a product cannot be deleted from the system if there are one or more records for it in the `Order Details` table.</span></span> <span data-ttu-id="7e68c-244">Poiché tutti i prodotti del database Northwind hanno almeno un record in `Order Details`, non è possibile eliminare prodotti fino a quando non vengono eliminati prima i record dei dettagli degli ordini associati al prodotto.</span><span class="sxs-lookup"><span data-stu-id="7e68c-244">Since every product in the Northwind database has at least one record in `Order Details`, we cannot delete any products until we first delete the product's associated order details records.</span></span>

<span data-ttu-id="7e68c-245">[![un vincolo di chiave esterna impedisce l'eliminazione di prodotti](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-245">[![A Foreign Key Constraint Prohibits the Deletion of Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span></span>

<span data-ttu-id="7e68c-246">**Figura 13**: un vincolo di chiave esterna impedisce l'eliminazione di prodotti ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-246">**Figure 13**: A Foreign Key Constraint Prohibits the Deletion of Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png))</span></span>

<span data-ttu-id="7e68c-247">Per questa esercitazione, è sufficiente eliminare tutti i record dalla tabella `Order Details`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-247">For our tutorial, let's just delete all of the records from the `Order Details` table.</span></span> <span data-ttu-id="7e68c-248">In un'applicazione reale è necessario effettuare una delle operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="7e68c-248">In a real-world application we'd need to either:</span></span>

- <span data-ttu-id="7e68c-249">Disporre di un'altra schermata per gestire le informazioni sui dettagli dell'ordine</span><span class="sxs-lookup"><span data-stu-id="7e68c-249">Have another screen to manage order details information</span></span>
- <span data-ttu-id="7e68c-250">Aumentare il metodo `DeleteProduct` per includere la logica per eliminare i dettagli dell'ordine del prodotto specificato</span><span class="sxs-lookup"><span data-stu-id="7e68c-250">Augment the `DeleteProduct` method to include logic to delete the specified product's order details</span></span>
- <span data-ttu-id="7e68c-251">Modificare la query SQL utilizzata dal TableAdapter per includere l'eliminazione dei dettagli dell'ordine del prodotto specificato</span><span class="sxs-lookup"><span data-stu-id="7e68c-251">Modify the SQL query used by the TableAdapter to include deletion of the specified product's order details</span></span>

<span data-ttu-id="7e68c-252">È sufficiente eliminare tutti i record dalla tabella `Order Details` per aggirare il vincolo FOREIGN KEY.</span><span class="sxs-lookup"><span data-stu-id="7e68c-252">Let's just delete all of the records from the `Order Details` table to circumvent the foreign key constraint.</span></span> <span data-ttu-id="7e68c-253">Passare alla Esplora server in Visual Studio, fare clic con il pulsante destro del mouse sul nodo `NORTHWND.MDF` e scegliere nuova query.</span><span class="sxs-lookup"><span data-stu-id="7e68c-253">Go to the Server Explorer in Visual Studio, right-click on the `NORTHWND.MDF` node, and choose New Query.</span></span> <span data-ttu-id="7e68c-254">Quindi, nella finestra query eseguire l'istruzione SQL seguente: `DELETE FROM [Order Details]`</span><span class="sxs-lookup"><span data-stu-id="7e68c-254">Then, in the query window, run the following SQL statement: `DELETE FROM [Order Details]`</span></span>

<span data-ttu-id="7e68c-255">[![eliminare tutti i record dalla tabella Order Details](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-255">[![Delete All Records from the Order Details Table](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span></span>

<span data-ttu-id="7e68c-256">**Figura 14**: eliminare tutti i record dalla tabella `Order Details` ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-256">**Figure 14**: Delete All Records from the `Order Details` Table ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png))</span></span>

<span data-ttu-id="7e68c-257">Dopo aver cancellato il `Order Details` tabella facendo clic sul pulsante Elimina, il prodotto verrà eliminato senza errori.</span><span class="sxs-lookup"><span data-stu-id="7e68c-257">After clearing out the `Order Details` table clicking on the Delete button will delete the product without error.</span></span> <span data-ttu-id="7e68c-258">Se facendo clic sul pulsante Elimina il prodotto non viene eliminato, assicurarsi che la proprietà `DataKeyNames` di GridView sia impostata sul campo chiave primaria (`ProductID`).</span><span class="sxs-lookup"><span data-stu-id="7e68c-258">If clicking on the Delete button does not delete the product, check to ensure that the GridView's `DataKeyNames` property is set to the primary key field (`ProductID`).</span></span>

> [!NOTE]
> <span data-ttu-id="7e68c-259">Quando si fa clic sul pulsante Elimina, viene seguito un postback e il record viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="7e68c-259">When clicking on the Delete button a postback ensues and the record is deleted.</span></span> <span data-ttu-id="7e68c-260">Questa operazione può risultare pericolosa poiché è facile fare clic accidentalmente sul pulsante Elimina della riga sbagliata.</span><span class="sxs-lookup"><span data-stu-id="7e68c-260">This can be dangerous since it is easy to accidentally click on the wrong row's Delete button.</span></span> <span data-ttu-id="7e68c-261">In un'esercitazione futura verrà illustrato come aggiungere una conferma lato client durante l'eliminazione di un record.</span><span class="sxs-lookup"><span data-stu-id="7e68c-261">In a future tutorial we'll see how to add a client-side confirmation when deleting a record.</span></span>

## <a name="editing-data-with-the-gridview"></a><span data-ttu-id="7e68c-262">Modifica di dati con GridView</span><span class="sxs-lookup"><span data-stu-id="7e68c-262">Editing Data with the GridView</span></span>

<span data-ttu-id="7e68c-263">Oltre all'eliminazione, il controllo GridView fornisce anche il supporto predefinito per la modifica a livello di riga.</span><span class="sxs-lookup"><span data-stu-id="7e68c-263">Along with deleting, the GridView control also provides built-in row-level editing support.</span></span> <span data-ttu-id="7e68c-264">La configurazione di un controllo GridView per supportare la modifica aggiunge una colonna di pulsanti di modifica.</span><span class="sxs-lookup"><span data-stu-id="7e68c-264">Configuring a GridView to support editing adds a column of Edit buttons.</span></span> <span data-ttu-id="7e68c-265">Dal punto di vista dell'utente finale, se si fa clic sul pulsante modifica di una riga, la riga diventa modificabile, trasformando le celle in caselle di testo contenenti i valori esistenti e sostituendo il pulsante modifica con i pulsanti Aggiorna e Annulla.</span><span class="sxs-lookup"><span data-stu-id="7e68c-265">From the end user's perspective, clicking a row's Edit button causes that row to become editable, turning the cells into textboxes containing the existing values and replacing the Edit button with Update and Cancel buttons.</span></span> <span data-ttu-id="7e68c-266">Dopo aver apportato le modifiche desiderate, l'utente finale può fare clic sul pulsante Aggiorna per eseguire il commit delle modifiche o sul pulsante Annulla per ignorarle.</span><span class="sxs-lookup"><span data-stu-id="7e68c-266">After making their desired changes, the end user can click the Update button to commit the changes or the Cancel button to discard them.</span></span> <span data-ttu-id="7e68c-267">In entrambi i casi, dopo aver fatto clic su Aggiorna o Annulla, il controllo GridView torna allo stato di pre-modifica.</span><span class="sxs-lookup"><span data-stu-id="7e68c-267">In either case, after clicking Update or Cancel the GridView returns to its pre-editing state.</span></span>

<span data-ttu-id="7e68c-268">Dal punto di vista dello sviluppatore della pagina, quando l'utente finale fa clic sul pulsante modifica per una determinata riga, si verifica un postback e GridView esegue i passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="7e68c-268">From our perspective as the page developer, when the end user clicks the Edit button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="7e68c-269">La proprietà `EditItemIndex` di GridView viene assegnata all'indice della riga di cui è stato fatto clic sul pulsante modifica</span><span class="sxs-lookup"><span data-stu-id="7e68c-269">The GridView's `EditItemIndex` property is assigned to the index of the row whose Edit button was clicked</span></span>
2. <span data-ttu-id="7e68c-270">GridView viene riassociato a ObjectDataSource richiamando il relativo metodo `Select()`</span><span class="sxs-lookup"><span data-stu-id="7e68c-270">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>
3. <span data-ttu-id="7e68c-271">Viene eseguito il rendering dell'indice di riga che corrisponde alla `EditItemIndex` in "modalità di modifica".</span><span class="sxs-lookup"><span data-stu-id="7e68c-271">The row index that matches the `EditItemIndex` is rendered in "edit mode."</span></span> <span data-ttu-id="7e68c-272">In questa modalità, il pulsante modifica viene sostituito dai pulsanti Aggiorna e Annulla e dai BoundField il cui `ReadOnly` proprietà è false (impostazione predefinita) viene sottoposto a rendering come controlli Web TextBox le cui proprietà `Text` sono assegnate ai valori dei campi dati.</span><span class="sxs-lookup"><span data-stu-id="7e68c-272">In this mode, the Edit button is replaced by Update and Cancel buttons and BoundFields whose `ReadOnly` properties are False (the default) are rendered as TextBox Web controls whose `Text` properties are assigned to the data fields' values.</span></span>

<span data-ttu-id="7e68c-273">A questo punto, il markup viene restituito al browser, consentendo all'utente finale di apportare eventuali modifiche ai dati della riga.</span><span class="sxs-lookup"><span data-stu-id="7e68c-273">At this point the markup is returned to the browser, allowing the end user to make any changes to the row's data.</span></span> <span data-ttu-id="7e68c-274">Quando l'utente fa clic sul pulsante Aggiorna, viene eseguito un postback e GridView esegue i passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="7e68c-274">When the user clicks the Update button, a postback occurs and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="7e68c-275">Ai valori `UpdateParameters` di ObjectDataSource vengono assegnati i valori immessi dall'utente finale nell'interfaccia di modifica di GridView</span><span class="sxs-lookup"><span data-stu-id="7e68c-275">The ObjectDataSource's `UpdateParameters` value(s) are assigned the values entered by the end user into the GridView's editing interface</span></span>
2. <span data-ttu-id="7e68c-276">Viene richiamato il metodo di `Update()` di ObjectDataSource, che aggiorna il record specificato</span><span class="sxs-lookup"><span data-stu-id="7e68c-276">The ObjectDataSource's `Update()` method is invoked, updating the specified record</span></span>
3. <span data-ttu-id="7e68c-277">GridView viene riassociato a ObjectDataSource richiamando il relativo metodo `Select()`</span><span class="sxs-lookup"><span data-stu-id="7e68c-277">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="7e68c-278">I valori di chiave primaria assegnati al `UpdateParameters` nel passaggio 1 derivano dai valori specificati nella proprietà `DataKeyNames`, mentre i valori di chiave non primaria provengono dal testo dei controlli Web TextBox per la riga modificata.</span><span class="sxs-lookup"><span data-stu-id="7e68c-278">The primary key values assigned to the `UpdateParameters` in Step 1 come from the values specified in the `DataKeyNames` property, whereas the non-primary key values come from the text in the TextBox Web controls for the edited row.</span></span> <span data-ttu-id="7e68c-279">Come per l'eliminazione di, è fondamentale che la proprietà `DataKeyNames` di GridView sia impostata correttamente.</span><span class="sxs-lookup"><span data-stu-id="7e68c-279">As with deleting, it is vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="7e68c-280">Se non è presente, al valore della chiave primaria `UpdateParameters` verrà assegnato il valore `Nothing` nel passaggio 1, che a sua volta non comporterà alcun record aggiornato nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="7e68c-280">If it's missing, the `UpdateParameters` primary key value will be assigned a value of `Nothing` in Step 1, which in turn will not result in any updated records in Step 2.</span></span>

<span data-ttu-id="7e68c-281">La funzionalità di modifica può essere attivata semplicemente selezionando la casella di controllo Abilita modifica nello smart tag di GridView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-281">Editing functionality can be activated by simply checking the Enable Editing checkbox in the GridView's smart tag.</span></span>

![Selezionare la casella di controllo Abilita modifica](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image37.png)

<span data-ttu-id="7e68c-283">**Figura 15**: selezionare la casella di controllo Abilita modifica</span><span class="sxs-lookup"><span data-stu-id="7e68c-283">**Figure 15**: Check the Enable Editing Checkbox</span></span>

<span data-ttu-id="7e68c-284">Se si seleziona la casella di controllo Abilita modifica, viene aggiunto un oggetto CommandField (se necessario) e viene impostata la relativa proprietà `ShowEditButton` su `True`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-284">Checking the Enable Editing checkbox will add a CommandField (if needed) and set its `ShowEditButton` property to `True`.</span></span> <span data-ttu-id="7e68c-285">Come illustrato in precedenza, CommandField contiene una serie di `ShowXButton` proprietà che indicano quali serie di pulsanti sono visualizzati in CommandField.</span><span class="sxs-lookup"><span data-stu-id="7e68c-285">As we saw earlier, the CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="7e68c-286">Selezionando la casella di controllo Abilita modifica, viene aggiunta la proprietà `ShowEditButton` all'oggetto CommandField esistente:</span><span class="sxs-lookup"><span data-stu-id="7e68c-286">Checking the Enable Editing checkbox adds the `ShowEditButton` property to the existing CommandField:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample6.aspx)]

<span data-ttu-id="7e68c-287">Questo è tutto per l'aggiunta del supporto per la modifica rudimentale.</span><span class="sxs-lookup"><span data-stu-id="7e68c-287">That's all there is to adding rudimentary editing support.</span></span> <span data-ttu-id="7e68c-288">Come illustrato in Figure16, l'interfaccia di modifica è piuttosto rudimentale ogni BoundField la cui proprietà `ReadOnly` è impostata su `False` (impostazione predefinita) viene sottoposta a rendering come casella di testo.</span><span class="sxs-lookup"><span data-stu-id="7e68c-288">As Figure16 shows, the editing interface is rather crude each BoundField whose `ReadOnly` property is set to `False` (the default) is rendered as a TextBox.</span></span> <span data-ttu-id="7e68c-289">Sono inclusi i campi come `CategoryID` e `SupplierID`, ovvero chiavi per altre tabelle.</span><span class="sxs-lookup"><span data-stu-id="7e68c-289">This includes fields like `CategoryID` and `SupplierID`, which are keys to other tables.</span></span>

<span data-ttu-id="7e68c-290">[![facendo clic sul pulsante di modifica di Chai viene visualizzata la riga in modalità di modifica](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-290">[![Clicking Chai s Edit Button Displays the Row in Edit Mode](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span></span>

<span data-ttu-id="7e68c-291">**Figura 16**: facendo clic sul pulsante di modifica di Chai, viene visualizzata la riga in modalità di modifica ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-291">**Figure 16**: Clicking Chai s Edit Button Displays the Row in Edit Mode ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png))</span></span>

<span data-ttu-id="7e68c-292">Oltre a chiedere agli utenti di modificare direttamente i valori di chiave esterna, l'interfaccia dell'interfaccia di modifica risulta mancante nei modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="7e68c-292">In addition to asking users to edit foreign key values directly, the editing interface's interface is lacking in the following ways:</span></span>

- <span data-ttu-id="7e68c-293">Se l'utente immette un `CategoryID` o `SupplierID` che non esiste nel database, il `UPDATE` violerà un vincolo di chiave esterna, causando la generazione di un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="7e68c-293">If the user enters a `CategoryID` or `SupplierID` that does not exist in the database, the `UPDATE` will violate a foreign key constraint, causing an exception to be raised.</span></span>
- <span data-ttu-id="7e68c-294">L'interfaccia di modifica non include alcuna convalida.</span><span class="sxs-lookup"><span data-stu-id="7e68c-294">The editing interface doesn't include any validation.</span></span> <span data-ttu-id="7e68c-295">Se non si specifica un valore obbligatorio, ad esempio `ProductName`, oppure si immette un valore stringa in cui è previsto un valore numerico, ad esempio immettendo "troppo!"</span><span class="sxs-lookup"><span data-stu-id="7e68c-295">If you don't provide a required value (such as `ProductName`), or enter a string value where a numeric value is expected (such as entering "Too much!"</span></span> <span data-ttu-id="7e68c-296">nella casella di testo `UnitPrice`) verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="7e68c-296">into the `UnitPrice` textbox), an exception will be thrown.</span></span> <span data-ttu-id="7e68c-297">Un'esercitazione futura analizzerà come aggiungere controlli di convalida all'interfaccia utente di modifica.</span><span class="sxs-lookup"><span data-stu-id="7e68c-297">A future tutorial will examine how to add validation controls to the editing user interface.</span></span>
- <span data-ttu-id="7e68c-298">Attualmente, *tutti* i campi dei prodotti che non sono di sola lettura devono essere inclusi in GridView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-298">Currently, *all* product fields that are not read-only must be included in the GridView.</span></span> <span data-ttu-id="7e68c-299">Se dovessimo rimuovere un campo da GridView, ad `UnitPrice`, quando si aggiornano i dati, GridView non imposterà il valore del `UpdateParameters` `UnitPrice`, che cambierebbe il `UnitPrice` del record del database in un valore di `NULL`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-299">If we were to remove a field from the GridView, say `UnitPrice`, when updating the data the GridView would not set the `UnitPrice` `UpdateParameters` value, which would change the database record's `UnitPrice` to a `NULL` value.</span></span> <span data-ttu-id="7e68c-300">Analogamente, se un campo obbligatorio, ad esempio `ProductName`, viene rimosso da GridView, l'aggiornamento avrà esito negativo con la stessa eccezione "*Column ' ProductName ' non consente valori null*" menzionati in precedenza.</span><span class="sxs-lookup"><span data-stu-id="7e68c-300">Similarly, if a required field, such as `ProductName`, is removed from the GridView, the update will fail with the same "*Column 'ProductName' does not allow nulls*" exception mentioned above.</span></span>
- <span data-ttu-id="7e68c-301">La formattazione dell'interfaccia di modifica lascia molto da desiderare.</span><span class="sxs-lookup"><span data-stu-id="7e68c-301">The editing interface formatting leaves a lot to be desired.</span></span> <span data-ttu-id="7e68c-302">Il `UnitPrice` viene visualizzato con quattro punti decimali.</span><span class="sxs-lookup"><span data-stu-id="7e68c-302">The `UnitPrice` is shown with four decimal points.</span></span> <span data-ttu-id="7e68c-303">Idealmente, i valori `CategoryID` e `SupplierID` contengono DropDownList che elencano le categorie e i fornitori nel sistema.</span><span class="sxs-lookup"><span data-stu-id="7e68c-303">Ideally the `CategoryID` and `SupplierID` values would contain DropDownLists that list the categories and suppliers in the system.</span></span>

<span data-ttu-id="7e68c-304">Questi sono tutti gli svantaggi che saranno disponibili per il momento, ma verranno trattati nelle esercitazioni future.</span><span class="sxs-lookup"><span data-stu-id="7e68c-304">These are all shortcomings that we'll have to live with for now, but will be addressed in future tutorials.</span></span>

## <a name="inserting-editing-and-deleting-data-with-the-detailsview"></a><span data-ttu-id="7e68c-305">Inserimento, modifica ed eliminazione di dati con DetailsView</span><span class="sxs-lookup"><span data-stu-id="7e68c-305">Inserting, Editing, and Deleting Data with the DetailsView</span></span>

<span data-ttu-id="7e68c-306">Come illustrato nelle esercitazioni precedenti, il controllo DetailsView visualizza un record alla volta e, come GridView, consente la modifica e l'eliminazione del record attualmente visualizzato.</span><span class="sxs-lookup"><span data-stu-id="7e68c-306">As we've seen in earlier tutorials, the DetailsView control displays one record at a time and, like the GridView, allows for editing and deleting of the currently displayed record.</span></span> <span data-ttu-id="7e68c-307">L'esperienza dell'utente finale con la modifica e l'eliminazione di elementi da DetailsView e dal flusso di lavoro dal lato ASP.NET è identica a quella di GridView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-307">Both the end user's experience with editing and deleting items from a DetailsView and the workflow from the ASP.NET side is identical to that of the GridView.</span></span> <span data-ttu-id="7e68c-308">Se DetailsView differisce da GridView, fornisce anche il supporto incorporato per l'inserimento.</span><span class="sxs-lookup"><span data-stu-id="7e68c-308">Where the DetailsView differs from the GridView is that it also provides built-in inserting support.</span></span>

<span data-ttu-id="7e68c-309">Per illustrare le funzionalità di modifica dei dati di GridView, iniziare aggiungendo un oggetto DetailsView alla pagina `Basics.aspx` sopra il GridView esistente e associarlo all'oggetto ObjectDataSource esistente tramite lo smart tag di DetailsView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-309">To demonstrate the data modification capabilities of the GridView, start by adding a DetailsView to the `Basics.aspx` page above the existing GridView and bind it to the existing ObjectDataSource through the DetailsView's smart tag.</span></span> <span data-ttu-id="7e68c-310">Cancellare quindi le proprietà `Height` e `Width` di DetailsView e selezionare l'opzione Abilita paging dallo smart tag.</span><span class="sxs-lookup"><span data-stu-id="7e68c-310">Next, clear out the DetailsView's `Height` and `Width` properties, and check the Enable Paging option from the smart tag.</span></span> <span data-ttu-id="7e68c-311">Per abilitare la modifica, l'inserimento e l'eliminazione del supporto, è sufficiente selezionare le caselle di controllo Abilita modifica, Abilita inserimento e Abilita eliminazione nello smart tag.</span><span class="sxs-lookup"><span data-stu-id="7e68c-311">To enable editing, inserting, and deleting support, simply check the Enable Editing, Enable Inserting, and Enable Deleting checkboxes in the smart tag.</span></span>

![Configurare DetailsView per supportare le operazioni di modifica, inserimento ed eliminazione](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image41.png)

<span data-ttu-id="7e68c-313">**Figura 17**: configurare DetailsView per supportare le operazioni di modifica, inserimento ed eliminazione</span><span class="sxs-lookup"><span data-stu-id="7e68c-313">**Figure 17**: Configure the DetailsView to Support Editing, Inserting, and Deleting</span></span>

<span data-ttu-id="7e68c-314">Come per GridView, l'aggiunta del supporto per la modifica, l'inserimento o l'eliminazione aggiunge un oggetto CommandField a DetailsView, come illustrato nella sintassi dichiarativa seguente:</span><span class="sxs-lookup"><span data-stu-id="7e68c-314">As with the GridView, adding editing, inserting, or deleting support adds a CommandField to the DetailsView, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample7.aspx)]

<span data-ttu-id="7e68c-315">Si noti che per l'oggetto DetailsView il CommandField viene visualizzato alla fine della raccolta Columns per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="7e68c-315">Note that for the DetailsView the CommandField appears at the end of the Columns collection by default.</span></span> <span data-ttu-id="7e68c-316">Poiché i campi di DetailsView vengono sottoposti a rendering come righe, CommandField viene visualizzato come una riga con i pulsanti Inserisci, modifica ed Elimina nella parte inferiore di DetailsView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-316">Since the DetailsView's fields are rendered as rows, the CommandField appears as a row with Insert, Edit, and Delete buttons at the bottom of the DetailsView.</span></span>

<span data-ttu-id="7e68c-317">[![configurare DetailsView per supportare le operazioni di modifica, inserimento ed eliminazione](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-317">[![Configure the DetailsView to Support Editing, Inserting, and Deleting](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span></span>

<span data-ttu-id="7e68c-318">**Figura 18**: configurare DetailsView per supportare le operazioni di modifica, inserimento ed eliminazione ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-318">**Figure 18**: Configure the DetailsView to Support Editing, Inserting, and Deleting ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png))</span></span>

<span data-ttu-id="7e68c-319">Facendo clic sul pulsante Elimina viene avviata la stessa sequenza di eventi di GridView: un postback; seguito da DetailsView che popola il `DeleteParameters` di ObjectDataSource in base ai valori di `DataKeyNames`. e completato con una chiamata al metodo di `Delete()` di ObjectDataSource, che rimuove effettivamente il prodotto dal database.</span><span class="sxs-lookup"><span data-stu-id="7e68c-319">Clicking on the Delete button starts the same sequence of events as with the GridView: a postback; followed by the DetailsView populating its ObjectDataSource's `DeleteParameters` based on the `DataKeyNames` values; and completed with a call its ObjectDataSource's `Delete()` method, which actually removes the product from the database.</span></span> <span data-ttu-id="7e68c-320">La modifica in DetailsView funziona anche in modo identico a quello di GridView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-320">Editing in the DetailsView also works in a fashion identical to that of the GridView.</span></span>

<span data-ttu-id="7e68c-321">Per l'inserimento, l'utente finale viene visualizzato con un nuovo pulsante che, se selezionato, esegue il rendering del DetailsView in "modalità di inserimento".</span><span class="sxs-lookup"><span data-stu-id="7e68c-321">For inserting, the end user is presented with a New button that, when clicked, renders the DetailsView in "insert mode."</span></span> <span data-ttu-id="7e68c-322">Con "modalità di inserimento" il pulsante nuovo viene sostituito dai pulsanti Inserisci e Annulla e solo i BoundField la cui proprietà `InsertVisible` è impostata su `True` (impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="7e68c-322">With "insert mode" the New button is replaced by Insert and Cancel buttons and only those BoundFields whose `InsertVisible` property is set to `True` (the default) are displayed.</span></span> <span data-ttu-id="7e68c-323">I campi dati identificati come campi a incremento automatico, ad esempio `ProductID`, hanno la [proprietà InsertVisible](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx) impostata su `False` quando il DetailsView viene associato all'origine dati tramite lo smart tag.</span><span class="sxs-lookup"><span data-stu-id="7e68c-323">Those data fields identified as auto-increment fields, such as `ProductID`, have their [InsertVisible property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx) set to `False` when binding the DetailsView to the data source through the smart tag.</span></span>

<span data-ttu-id="7e68c-324">Quando si associa un'origine dati a un oggetto DetailsView tramite lo smart tag, Visual Studio imposta la proprietà `InsertVisible` su `False` solo per i campi con incremento automatico.</span><span class="sxs-lookup"><span data-stu-id="7e68c-324">When binding a data source to a DetailsView through the smart tag, Visual Studio sets the `InsertVisible` property to `False` only for auto-increment fields.</span></span> <span data-ttu-id="7e68c-325">I campi di sola lettura, ad esempio `CategoryName` e `SupplierName`, verranno visualizzati nell'interfaccia utente "modalità di inserimento", a meno che la relativa proprietà `InsertVisible` non venga impostata in modo esplicito su `False`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-325">Read-only fields, like `CategoryName` and `SupplierName`, will be displayed in the "insert mode" user interface unless their `InsertVisible` property is explicitly set to `False`.</span></span> <span data-ttu-id="7e68c-326">Impostare le proprietà `InsertVisible` di questi due campi su `False`, tramite la sintassi dichiarativa di DetailsView o tramite il collegamento Modifica campi nello smart tag.</span><span class="sxs-lookup"><span data-stu-id="7e68c-326">Take a moment to set these two fields' `InsertVisible` properties to `False`, either through the DetailsView's declarative syntax or through the Edit Fields link in the smart tag.</span></span> <span data-ttu-id="7e68c-327">Nella figura 19 viene illustrato come impostare le proprietà `InsertVisible` su `False` facendo clic sul collegamento Modifica campi.</span><span class="sxs-lookup"><span data-stu-id="7e68c-327">Figure 19 shows setting the `InsertVisible` properties to `False` by clicking on the Edit Fields link.</span></span>

<span data-ttu-id="7e68c-328">[![Northwind Traders offre ora Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-328">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span></span>

<span data-ttu-id="7e68c-329">**Figura 19**: Northwind Traders offre ora il tè Acme ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-329">**Figure 19**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png))</span></span>

<span data-ttu-id="7e68c-330">Dopo aver impostato le proprietà `InsertVisible`, visualizzare la pagina `Basics.aspx` in un browser e fare clic sul pulsante nuovo.</span><span class="sxs-lookup"><span data-stu-id="7e68c-330">After setting the `InsertVisible` properties, view the `Basics.aspx` page in a browser and click the New button.</span></span> <span data-ttu-id="7e68c-331">La figura 20 Mostra DetailsView durante l'aggiunta di una nuova bevanda, Acme Tea, alla nostra linea di prodotti.</span><span class="sxs-lookup"><span data-stu-id="7e68c-331">Figure 20 shows the DetailsView when adding a new beverage, Acme Tea, to our product line.</span></span>

<span data-ttu-id="7e68c-332">[![Northwind Traders offre ora Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-332">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span></span>

<span data-ttu-id="7e68c-333">**Figura 20**: Northwind Traders ora offre il tè Acme ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-333">**Figure 20**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png))</span></span>

<span data-ttu-id="7e68c-334">Dopo aver immesso i dettagli per il tè Acme e aver fatto clic sul pulsante Inserisci, viene eseguito un postback e il nuovo record viene aggiunto alla tabella di database `Products`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-334">After entering the details for Acme Tea and clicking the Insert button, a postback ensues and the new record is added to the `Products` database table.</span></span> <span data-ttu-id="7e68c-335">Poiché questo DetailsView elenca i prodotti in ordine con cui sono presenti nella tabella di database, è necessario eseguire il paging dell'ultimo prodotto per visualizzare il nuovo prodotto.</span><span class="sxs-lookup"><span data-stu-id="7e68c-335">Since this DetailsView lists the products in order with which they exist in the database table, we must page to the last product in order to see the new product.</span></span>

<span data-ttu-id="7e68c-336">[![dettagli per il tè Acme](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-336">[![Details for Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span></span>

<span data-ttu-id="7e68c-337">**Figura 21**: dettagli per il tè Acme ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-337">**Figure 21**: Details for Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png))</span></span>

> [!NOTE]
> <span data-ttu-id="7e68c-338">La [proprietà CurrentMode](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx) di DetailsView indica l'interfaccia da visualizzare. i possibili valori sono i seguenti: `Edit`, `Insert`o `ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-338">The DetailsView's [CurrentMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx) indicates the interface being displayed and can be one of the following values: `Edit`, `Insert`, or `ReadOnly`.</span></span> <span data-ttu-id="7e68c-339">La [proprietà DefaultMode](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx) indica la modalità di ritorno di DetailsView dopo il completamento di un'operazione di modifica o inserimento ed è utile per la visualizzazione di un oggetto DetailsView permanente in modalità di modifica o inserimento.</span><span class="sxs-lookup"><span data-stu-id="7e68c-339">The [DefaultMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx) indicates the mode the DetailsView returns to after an edit or insert has been completed and is useful for displaying a DetailsView that is permanently in edit or insert mode.</span></span>

<span data-ttu-id="7e68c-340">Il punto e fare clic sulle funzionalità di inserimento e modifica di DetailsView subiscono le stesse limitazioni di GridView: l'utente deve immettere i valori `CategoryID` e `SupplierID` esistenti tramite una casella di testo. l'interfaccia non dispone di alcuna logica di convalida. tutti i campi prodotto che non consentono valori `NULL` o non hanno un valore predefinito specificato a livello di database devono essere inclusi nell'interfaccia di inserimento e così via.</span><span class="sxs-lookup"><span data-stu-id="7e68c-340">The point and click inserting and editing capabilities of the DetailsView suffer from the same limitations as the GridView: the user must enter existing `CategoryID` and `SupplierID` values through a textbox; the interface lacks any validation logic; all product fields that do not allow `NULL` values or don't have a default value specified at the database level must be included in the inserting interface, and so on.</span></span>

<span data-ttu-id="7e68c-341">Le tecniche che verranno esaminate per estendere e migliorare l'interfaccia di modifica di GridView negli articoli futuri possono essere applicate anche alle interfacce di modifica e inserimento del controllo DetailsView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-341">The techniques we will examine for extending and enhancing the GridView's editing interface in future articles can be applied to the DetailsView control's editing and inserting interfaces as well.</span></span>

## <a name="using-the-formview-for-a-more-flexible-data-modification-user-interface"></a><span data-ttu-id="7e68c-342">Uso di FormView per un'interfaccia utente per la modifica dei dati più flessibile</span><span class="sxs-lookup"><span data-stu-id="7e68c-342">Using the FormView for a More Flexible Data Modification User Interface</span></span>

<span data-ttu-id="7e68c-343">FormView offre supporto incorporato per l'inserimento, la modifica e l'eliminazione dei dati, ma poiché usa i modelli anziché i campi, non è possibile aggiungere i BoundField o CommandField usati dai controlli GridView e DetailsView per fornire i dati interfaccia di modifica.</span><span class="sxs-lookup"><span data-stu-id="7e68c-343">The FormView offers built-in support for inserting, editing, and deleting data, but because it uses templates instead of fields there's no place to add the BoundFields or the CommandField used by the GridView and DetailsView controls to provide the data modification interface.</span></span> <span data-ttu-id="7e68c-344">Al contrario, questa interfaccia i controlli Web per la raccolta di input utente quando si aggiunge un nuovo elemento o la modifica di una esistente insieme ai pulsanti nuovo, modifica, Elimina, Inserisci, aggiorna e Annulla deve essere aggiunto manualmente ai modelli appropriati.</span><span class="sxs-lookup"><span data-stu-id="7e68c-344">Instead, this interface the Web controls for collecting user input when adding a new item or editing an existing one along with the New, Edit, Delete, Insert, Update, and Cancel buttons must be added manually to the appropriate templates.</span></span> <span data-ttu-id="7e68c-345">Fortunatamente, Visual Studio creerà automaticamente l'interfaccia necessaria quando il FormView viene associato a un'origine dati tramite l'elenco a discesa nello smart tag.</span><span class="sxs-lookup"><span data-stu-id="7e68c-345">Fortunately, Visual Studio will automatically create the needed interface when binding the FormView to a data source through the drop-down list in its smart tag.</span></span>

<span data-ttu-id="7e68c-346">Per illustrare queste tecniche, iniziare aggiungendo un FormView alla pagina `Basics.aspx` e, dallo smart tag di FormView, associarlo a ObjectDataSource già creato.</span><span class="sxs-lookup"><span data-stu-id="7e68c-346">To illustrate these techniques, start by adding a FormView to the `Basics.aspx` page and, from the FormView's smart tag, bind it to the ObjectDataSource already created.</span></span> <span data-ttu-id="7e68c-347">Verrà generato un `EditItemTemplate`, `InsertItemTemplate`e `ItemTemplate` per l'oggetto FormView con i controlli Web TextBox per la raccolta dei controlli Web di input e pulsanti dell'utente per i pulsanti nuovo, modifica, Elimina, Inserisci, aggiorna e Annulla.</span><span class="sxs-lookup"><span data-stu-id="7e68c-347">This will generate an `EditItemTemplate`, `InsertItemTemplate`, and `ItemTemplate` for the FormView with TextBox Web controls for collecting the user's input and Button Web controls for the New, Edit, Delete, Insert, Update, and Cancel buttons.</span></span> <span data-ttu-id="7e68c-348">Inoltre, la proprietà `DataKeyNames` di FormView viene impostata sul campo di chiave primaria (`ProductID`) dell'oggetto restituito da ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7e68c-348">Additionally, the FormView's `DataKeyNames` property is set to the primary key field (`ProductID`) of the object returned by the ObjectDataSource.</span></span> <span data-ttu-id="7e68c-349">Infine, selezionare l'opzione Abilita paging nello smart tag di FormView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-349">Lastly, check the Enable Paging option in the FormView's smart tag.</span></span>

<span data-ttu-id="7e68c-350">Di seguito viene illustrato il markup dichiarativo per la `ItemTemplate` di FormView dopo che il FormView è stato associato a ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7e68c-350">The following shows the declarative markup for the FormView's `ItemTemplate` after the FormView has been bound to the ObjectDataSource.</span></span> <span data-ttu-id="7e68c-351">Per impostazione predefinita, ogni campo prodotto valore non booleano viene associato alla proprietà `Text` di un controllo Web Label mentre ogni campo di valore booleano (`Discontinued`) viene associato alla proprietà `Checked` di un controllo Web CheckBox disabilitato.</span><span class="sxs-lookup"><span data-stu-id="7e68c-351">By default, each non-Boolean value product field is bound to the `Text` property of a Label Web control while each Boolean value field (`Discontinued`) is bound to the `Checked` property of a disabled CheckBox Web control.</span></span> <span data-ttu-id="7e68c-352">Per consentire ai pulsanti nuovo, modifica ed Elimina di attivare determinati comportamenti FormView quando si fa clic, è fondamentale che i valori `CommandName` siano impostati rispettivamente su `New`, `Edit`e `Delete`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-352">In order for the New, Edit, and Delete buttons to trigger certain FormView behavior when clicked, it is imperative that their `CommandName` values be set to `New`, `Edit`, and `Delete`, respectively.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample8.aspx)]

<span data-ttu-id="7e68c-353">La figura 22 Mostra la `ItemTemplate` di FormView quando viene visualizzata tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="7e68c-353">Figure 22 shows the FormView's `ItemTemplate` when viewed through a browser.</span></span> <span data-ttu-id="7e68c-354">Ogni campo prodotto è elencato con i pulsanti nuovo, modifica ed Elimina in basso.</span><span class="sxs-lookup"><span data-stu-id="7e68c-354">Each product field is listed with the New, Edit, and Delete buttons at the bottom.</span></span>

<span data-ttu-id="7e68c-355">[![predefinita FormView ItemTemplate elenca ogni campo prodotto insieme ai pulsanti nuovo, modifica ed Elimina](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-355">[![The Defaut FormView ItemTemplate Lists Each Product Field Along with New, Edit, and Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span></span>

<span data-ttu-id="7e68c-356">**Figura 22**: il `ItemTemplate` FormView predefinita elenca ogni campo prodotto insieme ai pulsanti nuovo, modifica ed Elimina ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-356">**Figure 22**: The Defaut FormView `ItemTemplate` Lists Each Product Field Along with New, Edit, and Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png))</span></span>

<span data-ttu-id="7e68c-357">Analogamente a GridView e DetailsView, facendo clic sul pulsante Elimina o su qualsiasi pulsante, LinkButton o ImageButton la cui proprietà `CommandName` è impostata su Elimina causa un postback, popola l'`DeleteParameters` di ObjectDataSource in base al valore `DataKeyNames` di FormView e richiama il metodo di `Delete()` di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7e68c-357">Like with the GridView and DetailsView, clicking the Delete button or any Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete causes a postback, populates the ObjectDataSource's `DeleteParameters` based on the FormView's `DataKeyNames` value, and invokes the ObjectDataSource's `Delete()` method.</span></span>

<span data-ttu-id="7e68c-358">Quando si fa clic sul pulsante modifica, viene eseguito un postback e i dati vengono riassociati al `EditItemTemplate`, che è responsabile del rendering dell'interfaccia di modifica.</span><span class="sxs-lookup"><span data-stu-id="7e68c-358">When the Edit button is clicked a postback ensues and the data is rebound to the `EditItemTemplate`, which is responsible for rendering the editing interface.</span></span> <span data-ttu-id="7e68c-359">Questa interfaccia include i controlli Web per la modifica dei dati insieme ai pulsanti Aggiorna e Annulla.</span><span class="sxs-lookup"><span data-stu-id="7e68c-359">This interface includes the Web controls for editing data along with the Update and Cancel buttons.</span></span> <span data-ttu-id="7e68c-360">Il `EditItemTemplate` predefinito generato da Visual Studio contiene un'etichetta per tutti i campi di incremento automatico (`ProductID`), una casella di testo per ogni campo valore non booleano e una casella di controllo per ogni campo di valore booleano.</span><span class="sxs-lookup"><span data-stu-id="7e68c-360">The default `EditItemTemplate` generated by Visual Studio contains a Label for any auto-increment fields (`ProductID`), a TextBox for each non-Boolean value field, and a CheckBox for each Boolean value field.</span></span> <span data-ttu-id="7e68c-361">Questo comportamento è molto simile ai BoundField generati automaticamente nei controlli GridView e DetailsView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-361">This behavior is very similar to the auto-generated BoundFields in the GridView and DetailsView controls.</span></span>

> [!NOTE]
> <span data-ttu-id="7e68c-362">Un piccolo problema con la generazione automatica del `EditItemTemplate` di FormView è che esegue il rendering dei controlli Web TextBox per i campi di sola lettura, ad esempio `CategoryName` e `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-362">One small issue with the FormView's auto-generation of the `EditItemTemplate` is that it renders TextBox Web controls for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="7e68c-363">A breve verrà illustrato come considerare questo problema.</span><span class="sxs-lookup"><span data-stu-id="7e68c-363">We'll see how to account for this shortly.</span></span>

<span data-ttu-id="7e68c-364">I controlli TextBox nella `EditItemTemplate` hanno la proprietà `Text` associata al valore del campo dati corrispondente usando l'associazione dati *bidirezionale*.</span><span class="sxs-lookup"><span data-stu-id="7e68c-364">The TextBox controls in the `EditItemTemplate` have their `Text` property bound to the value of their corresponding data field using *two-way databinding*.</span></span> <span data-ttu-id="7e68c-365">L'associazione dati bidirezionale, indicata da `<%# Bind("dataField") %>`, esegue l'associazione dati sia durante l'associazione dei dati al modello che durante il popolamento dei parametri di ObjectDataSource per l'inserimento o la modifica di record.</span><span class="sxs-lookup"><span data-stu-id="7e68c-365">Two-way databinding, denoted by `<%# Bind("dataField") %>`, performs databinding both when binding data to the template and when populating the ObjectDataSource's parameters for inserting or editing records.</span></span> <span data-ttu-id="7e68c-366">Ovvero, quando l'utente fa clic sul pulsante modifica dal `ItemTemplate`, il metodo `Bind()` restituisce il valore del campo dati specificato.</span><span class="sxs-lookup"><span data-stu-id="7e68c-366">That is, when the user clicks the Edit button from the `ItemTemplate`, the `Bind()` method returns the specified data field value.</span></span> <span data-ttu-id="7e68c-367">Dopo che l'utente ha apportato le modifiche e fa clic su Aggiorna, i valori di cui è stato eseguito il postback corrispondenti ai campi dati specificati con `Bind()` vengono applicati al `UpdateParameters`di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7e68c-367">After the user makes their changes and clicks Update, the values posted back that correspond to the data fields specified using `Bind()` are applied to the ObjectDataSource's `UpdateParameters`.</span></span> <span data-ttu-id="7e68c-368">In alternativa, l'associazione dati unidirezionale, indicata da `<%# Eval("dataField") %>`, recupera i valori dei campi dati solo quando si associano i dati al modello e *non* restituisce i valori immessi dall'utente ai parametri dell'origine dati durante il postback.</span><span class="sxs-lookup"><span data-stu-id="7e68c-368">Alternatively, one-way databinding, denoted by `<%# Eval("dataField") %>`, only retrieves the data field values when binding data to the template and does *not* return the user-entered values to the data source's parameters on postback.</span></span>

<span data-ttu-id="7e68c-369">Il markup dichiarativo seguente mostra la `EditItemTemplate`di FormView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-369">The following declarative markup shows the FormView's `EditItemTemplate`.</span></span> <span data-ttu-id="7e68c-370">Si noti che il metodo `Bind()` viene usato nella sintassi di associazione dei dati e che i controlli Web dei pulsanti Aggiorna e Annulla hanno le proprietà `CommandName` impostate di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="7e68c-370">Note that the `Bind()` method is used in the databinding syntax here and that the Update and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample9.aspx)]

<span data-ttu-id="7e68c-371">L'`EditItemTemplate`, a questo punto, causerà la generazione di un'eccezione se si tenta di usarla.</span><span class="sxs-lookup"><span data-stu-id="7e68c-371">Our `EditItemTemplate`, at this point, will cause an exception to be thrown if we attempt to use it.</span></span> <span data-ttu-id="7e68c-372">Il problema è che i campi `CategoryName` e `SupplierName` vengono sottoposti a rendering come controlli Web TextBox nell'`EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-372">The problem is that the `CategoryName` and `SupplierName` fields are rendered as TextBox Web controls in the `EditItemTemplate`.</span></span> <span data-ttu-id="7e68c-373">È necessario modificare queste caselle di testo in etichette o rimuoverle completamente.</span><span class="sxs-lookup"><span data-stu-id="7e68c-373">We either need to change these TextBoxes to Labels or remove them altogether.</span></span> <span data-ttu-id="7e68c-374">È sufficiente eliminarli completamente dal `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-374">Let's simply delete them entirely from the `EditItemTemplate`.</span></span>

<span data-ttu-id="7e68c-375">La figura 23 Mostra il FormView in un browser dopo aver fatto clic sul pulsante modifica per Chai.</span><span class="sxs-lookup"><span data-stu-id="7e68c-375">Figure 23 shows the FormView in a browser after the Edit button has been clicked for Chai.</span></span> <span data-ttu-id="7e68c-376">Si noti che i campi `SupplierName` e `CategoryName` visualizzati nel `ItemTemplate` non sono più presenti, perché sono stati appena rimossi dal `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-376">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them from the `EditItemTemplate`.</span></span> <span data-ttu-id="7e68c-377">Quando si fa clic sul pulsante Aggiorna, FormView continua con la stessa sequenza di passaggi dei controlli GridView e DetailsView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-377">When the Update button is clicked the FormView proceeds through the same sequence of steps as the GridView and DetailsView controls.</span></span>

<span data-ttu-id="7e68c-378">[![per impostazione predefinita EditItemTemplate Mostra ogni campo prodotto modificabile come casella di testo o casella di controllo](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-378">[![By Default the EditItemTemplate Shows Each Editable Product Field as a TextBox or CheckBox](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span></span>

<span data-ttu-id="7e68c-379">**Figura 23**: per impostazione predefinita, il `EditItemTemplate` Mostra ogni campo prodotto modificabile come casella di testo o casella di controllo ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-379">**Figure 23**: By Default the `EditItemTemplate` Shows Each Editable Product Field as a TextBox or CheckBox ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png))</span></span>

<span data-ttu-id="7e68c-380">Quando si fa clic sul pulsante Inserisci per il `ItemTemplate` di FormView viene seguito un postback.</span><span class="sxs-lookup"><span data-stu-id="7e68c-380">When the Insert button is clicked the FormView's `ItemTemplate` a postback ensues.</span></span> <span data-ttu-id="7e68c-381">Tuttavia, nessun dato è associato a FormView perché è in corso l'aggiunta di un nuovo record.</span><span class="sxs-lookup"><span data-stu-id="7e68c-381">However, no data is bound to the FormView because a new record is being added.</span></span> <span data-ttu-id="7e68c-382">L'interfaccia `InsertItemTemplate` include i controlli Web per l'aggiunta di un nuovo record insieme ai pulsanti Inserisci e Annulla.</span><span class="sxs-lookup"><span data-stu-id="7e68c-382">The `InsertItemTemplate` interface includes the Web controls for adding a new record along with the Insert and Cancel buttons.</span></span> <span data-ttu-id="7e68c-383">Il `InsertItemTemplate` predefinito generato da Visual Studio contiene una casella di testo per ogni campo valore non booleano e una casella di controllo per ogni campo di valore booleano, in modo analogo all'interfaccia `EditItemTemplate`generata automaticamente.</span><span class="sxs-lookup"><span data-stu-id="7e68c-383">The default `InsertItemTemplate` generated by Visual Studio contains a TextBox for each non-Boolean value field and a CheckBox for each Boolean value field, similar to the auto-generated `EditItemTemplate`'s interface.</span></span> <span data-ttu-id="7e68c-384">I controlli TextBox hanno la proprietà `Text` associata al valore del campo dati corrispondente usando DataBinding bidirezionale.</span><span class="sxs-lookup"><span data-stu-id="7e68c-384">The TextBox controls have their `Text` property bound to the value of their corresponding data field using two-way databinding.</span></span>

<span data-ttu-id="7e68c-385">Il markup dichiarativo seguente mostra la `InsertItemTemplate`di FormView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-385">The following declarative markup shows the FormView's `InsertItemTemplate`.</span></span> <span data-ttu-id="7e68c-386">Si noti che il metodo `Bind()` viene usato nella sintassi di associazione dei dati e che i controlli Web del pulsante Inserisci e Annulla hanno le proprietà `CommandName` impostate di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="7e68c-386">Note that the `Bind()` method is used in the databinding syntax here and that the Insert and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample10.aspx)]

<span data-ttu-id="7e68c-387">C'è una sottigliezza con la generazione automatica del `InsertItemTemplate`di FormView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-387">There's a subtlety with the FormView's auto-generation of the `InsertItemTemplate`.</span></span> <span data-ttu-id="7e68c-388">In particolare, i controlli Web della casella di testo vengono creati anche per i campi di sola lettura, ad esempio `CategoryName` e `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-388">Specifically, the TextBox Web controls are created even for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="7e68c-389">Analogamente alla `EditItemTemplate`, è necessario rimuovere queste caselle di testo dall'`InsertItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-389">Like with the `EditItemTemplate`, we need to remove these TextBoxes from the `InsertItemTemplate`.</span></span>

<span data-ttu-id="7e68c-390">La figura 24 Mostra il FormView in un browser quando si aggiunge un nuovo prodotto, Acme coffee.</span><span class="sxs-lookup"><span data-stu-id="7e68c-390">Figure 24 shows the FormView in a browser when adding a new product, Acme Coffee.</span></span> <span data-ttu-id="7e68c-391">Si noti che i campi `SupplierName` e `CategoryName` visualizzati nel `ItemTemplate` non sono più presenti, perché sono stati appena rimossi.</span><span class="sxs-lookup"><span data-stu-id="7e68c-391">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them.</span></span> <span data-ttu-id="7e68c-392">Quando si fa clic sul pulsante Inserisci, FormView procede attraverso la stessa sequenza di passaggi del controllo DetailsView, aggiungendo un nuovo record alla tabella `Products`.</span><span class="sxs-lookup"><span data-stu-id="7e68c-392">When the Insert button is clicked the FormView proceeds through the same sequence of steps as the DetailsView control, adding a new record to the `Products` table.</span></span> <span data-ttu-id="7e68c-393">La figura 25 Mostra i dettagli del prodotto di Acme coffee in FormView dopo l'inserimento.</span><span class="sxs-lookup"><span data-stu-id="7e68c-393">Figure 25 shows Acme Coffee product's details in the FormView after it has been inserted.</span></span>

<span data-ttu-id="7e68c-394">[![InsertItemTemplate impone l'interfaccia di inserimento di FormView](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-394">[![The InsertItemTemplate Dictates the FormView's Inserting Interface](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span></span>

<span data-ttu-id="7e68c-395">**Figura 24**: il `InsertItemTemplate` impone l'interfaccia di inserimento di FormView ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-395">**Figure 24**: The `InsertItemTemplate` Dictates the FormView's Inserting Interface ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png))</span></span>

<span data-ttu-id="7e68c-396">[![i dettagli relativi al nuovo prodotto, il caffè Acme, viene visualizzato in FormView](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span><span class="sxs-lookup"><span data-stu-id="7e68c-396">[![The Details for New Product, Acme Coffee, are Displayed in the FormView](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span></span>

<span data-ttu-id="7e68c-397">**Figura 25**: i dettagli per il nuovo prodotto, il caffè Acme, vengono visualizzati in FormView ([fare clic per visualizzare l'immagine con dimensioni complete](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png))</span><span class="sxs-lookup"><span data-stu-id="7e68c-397">**Figure 25**: The Details for New Product, Acme Coffee, are Displayed in the FormView ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png))</span></span>

<span data-ttu-id="7e68c-398">Separando le interfacce di sola lettura, la modifica e l'inserimento in tre modelli distinti, FormView consente un livello di controllo più preciso su queste interfacce rispetto a DetailsView e GridView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-398">By separating out the read-only, editing, and inserting interfaces into three separate templates, the FormView allows for a finer degree of control over these interfaces than the DetailsView and GridView.</span></span>

> [!NOTE]
> <span data-ttu-id="7e68c-399">Analogamente a DetailsView, la proprietà `CurrentMode` di FormView indica l'interfaccia da visualizzare e la relativa proprietà `DefaultMode` indica la modalità di ritorno di FormView dopo il completamento di un'operazione di modifica o inserimento.</span><span class="sxs-lookup"><span data-stu-id="7e68c-399">Like the DetailsView, the FormView's `CurrentMode` property indicates the interface being displayed and its `DefaultMode` property indicates the mode the FormView returns to after an edit or insert has been completed.</span></span>

## <a name="summary"></a><span data-ttu-id="7e68c-400">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="7e68c-400">Summary</span></span>

<span data-ttu-id="7e68c-401">In questa esercitazione sono state esaminate le nozioni di base per l'inserimento, la modifica e l'eliminazione di dati tramite GridView, DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="7e68c-401">In this tutorial we examined the basics of inserting, editing, and deleting data using the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="7e68c-402">Tutti e tre questi controlli forniscono un certo livello di funzionalità di modifica dei dati predefinite che possono essere utilizzate senza scrivere una sola riga di codice nella pagina ASP.NET, grazie ai controlli Web dei dati e a ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7e68c-402">All three of these controls provide some level of built-in data modification capabilities that can be utilized without writing a single line of code in the ASP.NET page thanks to the data Web controls and the ObjectDataSource.</span></span> <span data-ttu-id="7e68c-403">Tuttavia, le tecniche semplici per il punto e il clic eseguono il rendering di un'interfaccia utente di modifica dei dati piuttosto fragile e ingenua.</span><span class="sxs-lookup"><span data-stu-id="7e68c-403">However, the simple point and click techniques render a fairly frail and naïve data modification user interface.</span></span> <span data-ttu-id="7e68c-404">Per fornire la convalida, inserire i valori a livello di codice, gestire normalmente le eccezioni, personalizzare l'interfaccia utente e così via, è necessario affidarsi a una serie di tecniche che verranno discusse nelle varie esercitazioni successive.</span><span class="sxs-lookup"><span data-stu-id="7e68c-404">To provide validation, inject programmatic values, gracefully handle exceptions, customize the user interface, and so on, we'll need to rely on a bevy of techniques that will be discussed over the next several tutorials.</span></span>

<span data-ttu-id="7e68c-405">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="7e68c-405">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="7e68c-406">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="7e68c-406">About the Author</span></span>

<span data-ttu-id="7e68c-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="7e68c-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7e68c-408">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="7e68c-408">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7e68c-409">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="7e68c-409">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7e68c-410">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7e68c-410">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="7e68c-411">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="7e68c-411">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7e68c-412">[Precedente](limiting-data-modification-functionality-based-on-the-user-cs.md)
> [Successivo](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="7e68c-412">[Previous](limiting-data-modification-functionality-based-on-the-user-cs.md)
[Next](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span></span>
