---
uid: web-forms/overview/data-access/enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb
title: Aggiunta di una colonna GridView di caselle di controllo (VB) | Microsoft Docs
author: rick-anderson
description: Questa esercitazione verrà illustrato come aggiungere una colonna di caselle di controllo a un controllo GridView per fornire all'utente un modo molto intuitivo di selezione di più righe di G....
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 39253d05-75c0-41c7-b9d4-a6c58ecf69ce
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb
msc.type: authoredcontent
ms.openlocfilehash: bcd9bbfed6613e1ec02cbf0a6ddaf4086bc6d1c0
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/25/2019
ms.locfileid: "58422480"
---
<a name="adding-a-gridview-column-of-checkboxes-vb"></a><span data-ttu-id="273c3-103">Aggiunta di una colonna GridView di caselle di controllo (VB)</span><span class="sxs-lookup"><span data-stu-id="273c3-103">Adding a GridView Column of Checkboxes (VB)</span></span>
====================
<span data-ttu-id="273c3-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="273c3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="273c3-105">[Scaricare l'App di esempio](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_52_VB.exe) o [Scarica il PDF](adding-a-gridview-column-of-checkboxes-vb/_static/datatutorial52vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="273c3-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_52_VB.exe) or [Download PDF](adding-a-gridview-column-of-checkboxes-vb/_static/datatutorial52vb1.pdf)</span></span>

> <span data-ttu-id="273c3-106">Questa esercitazione verrà illustrato come aggiungere una colonna di caselle di controllo a un controllo GridView per fornire all'utente un modo molto intuitivo di selezione di più righe di GridView.</span><span class="sxs-lookup"><span data-stu-id="273c3-106">This tutorial looks at how to add a column of check boxes to a GridView control to provide the user with an intuitive way of selecting multiple rows of the GridView.</span></span>


## <a name="introduction"></a><span data-ttu-id="273c3-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="273c3-107">Introduction</span></span>

<span data-ttu-id="273c3-108">Nell'esercitazione precedente abbiamo esaminato come aggiungere una colonna di pulsanti di opzione a GridView allo scopo di selezione di un record specifico.</span><span class="sxs-lookup"><span data-stu-id="273c3-108">In the preceding tutorial we examined how to add a column of radio buttons to the GridView for the purpose of selecting a particular record.</span></span> <span data-ttu-id="273c3-109">Una colonna di pulsanti di opzione è un'interfaccia utente appropriata quando l'utente è limitato a scegliere al massimo un elemento nella griglia.</span><span class="sxs-lookup"><span data-stu-id="273c3-109">A column of radio buttons is a suitable user interface when the user is limited to choosing at most one item from the grid.</span></span> <span data-ttu-id="273c3-110">In alcuni casi, tuttavia, potrebbe vogliamo consentire all'utente di selezionare un numero arbitrario di elementi nella griglia.</span><span class="sxs-lookup"><span data-stu-id="273c3-110">At times, however, we may want to allow the user to pick an arbitrary number of items from the grid.</span></span> <span data-ttu-id="273c3-111">I client di posta elettronica basato sul Web, ad esempio, in genere visualizzare l'elenco di messaggi con una colonna di caselle di controllo.</span><span class="sxs-lookup"><span data-stu-id="273c3-111">Web-based email clients, for example, typically display the list of messages with a column of checkboxes.</span></span> <span data-ttu-id="273c3-112">L'utente può selezionare un numero arbitrario di messaggi e quindi eseguire un'azione, ad esempio lo spostamento di messaggi di posta elettronica a un'altra cartella o eliminandoli.</span><span class="sxs-lookup"><span data-stu-id="273c3-112">The user can select an arbitrary number of messages and then perform some action, such as moving the emails to another folder or deleting them.</span></span>

<span data-ttu-id="273c3-113">In questa esercitazione si vedrà come aggiungere una colonna di caselle di controllo e come determinare quali caselle di controllo sono state controllate durante il postback.</span><span class="sxs-lookup"><span data-stu-id="273c3-113">In this tutorial we will see how to add a column of checkboxes and how to determine what checkboxes were checked on postback.</span></span> <span data-ttu-id="273c3-114">In particolare, creeremo un esempio che riproduce fedelmente l'interfaccia utente client di posta elettronica basato sul web.</span><span class="sxs-lookup"><span data-stu-id="273c3-114">In particular, we'll build an example that closely mimics the web-based email client user interface.</span></span> <span data-ttu-id="273c3-115">Questo esempio include un controllo GridView paging Elenca i prodotti nel `Products` tabella di database con una casella di controllo in ogni riga (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="273c3-115">Our example will include a paged GridView listing the products in the `Products` database table with a checkbox in each row (see Figure 1).</span></span> <span data-ttu-id="273c3-116">Un pulsante Elimina prodotti selezionati, quando si fa clic, verrà eliminati i prodotti selezionati.</span><span class="sxs-lookup"><span data-stu-id="273c3-116">A Delete Selected Products button, when clicked, will delete those products selected.</span></span>


<span data-ttu-id="273c3-117">[![Ogni riga di Product include una casella di controllo](adding-a-gridview-column-of-checkboxes-vb/_static/image1.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="273c3-117">[![Each Product Row Includes a Checkbox](adding-a-gridview-column-of-checkboxes-vb/_static/image1.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image1.png)</span></span>

<span data-ttu-id="273c3-118">**Figura 1**: Ogni riga di Product include una casella di controllo ([fare clic per visualizzare l'immagine con dimensioni normali](adding-a-gridview-column-of-checkboxes-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="273c3-118">**Figure 1**: Each Product Row Includes a Checkbox ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image2.png))</span></span>


## <a name="step-1-adding-a-paged-gridview-that-lists-product-information"></a><span data-ttu-id="273c3-119">Passaggio 1: Aggiunta di un controllo GridView di paging che elenca le informazioni sul prodotto</span><span class="sxs-lookup"><span data-stu-id="273c3-119">Step 1: Adding a Paged GridView that Lists Product Information</span></span>

<span data-ttu-id="273c3-120">Prima ci preoccupiamo aggiunta di una colonna di caselle di controllo, lasciare che lo stato attivo prima con s sull'elenco di prodotti in un controllo GridView che supporta il paging.</span><span class="sxs-lookup"><span data-stu-id="273c3-120">Before we worry about adding a column of checkboxes, let s first focus on listing the products in a GridView that supports paging.</span></span> <span data-ttu-id="273c3-121">Iniziare aprendo il `CheckBoxField.aspx` nella pagina la `EnhancedGridView` cartelle e trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione, l'impostazione relativa `ID` a `Products`.</span><span class="sxs-lookup"><span data-stu-id="273c3-121">Start by opening the `CheckBoxField.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` to `Products`.</span></span> <span data-ttu-id="273c3-122">Successivamente, scegliere di associare il controllo GridView per un nuovo oggetto ObjectDataSource denominato `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="273c3-122">Next, choose to bind the GridView to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="273c3-123">Configurare ObjectDataSource per usare la `ProductsBLL` classe, chiamare il `GetProducts()` metodo per restituire i dati.</span><span class="sxs-lookup"><span data-stu-id="273c3-123">Configure the ObjectDataSource to use the `ProductsBLL` class, calling the `GetProducts()` method to return the data.</span></span> <span data-ttu-id="273c3-124">Poiché questo controllo GridView sarà di sola lettura, impostare gli elenchi a discesa nell'aggiornamento, inserimento ed eliminare schede su (nessuno).</span><span class="sxs-lookup"><span data-stu-id="273c3-124">Since this GridView will be read-only, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="273c3-125">[![Creare un nuovo oggetto ObjectDataSource denominato ProductsDataSource](adding-a-gridview-column-of-checkboxes-vb/_static/image2.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="273c3-125">[![Create a New ObjectDataSource Named ProductsDataSource](adding-a-gridview-column-of-checkboxes-vb/_static/image2.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image3.png)</span></span>

<span data-ttu-id="273c3-126">**Figura 2**: Creare un nuovo oggetto ObjectDataSource denominato `ProductsDataSource` ([fare clic per visualizzare l'immagine con dimensioni normali](adding-a-gridview-column-of-checkboxes-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="273c3-126">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image4.png))</span></span>


<span data-ttu-id="273c3-127">[![Configurare ObjectDataSource per recuperare i dati usando il metodo GetProducts()](adding-a-gridview-column-of-checkboxes-vb/_static/image3.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="273c3-127">[![Configure the ObjectDataSource to Retrieve Data Using the GetProducts() Method](adding-a-gridview-column-of-checkboxes-vb/_static/image3.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image5.png)</span></span>

<span data-ttu-id="273c3-128">**Figura 3**: Configurare ObjectDataSource per recuperare dati usando il `GetProducts()` metodo ([fare clic per visualizzare l'immagine con dimensioni normali](adding-a-gridview-column-of-checkboxes-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="273c3-128">**Figure 3**: Configure the ObjectDataSource to Retrieve Data Using the `GetProducts()` Method ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image6.png))</span></span>


<span data-ttu-id="273c3-129">[![Impostare gli elenchi a discesa nell'aggiornamento, inserimento ed eliminare schede su (nessuno)](adding-a-gridview-column-of-checkboxes-vb/_static/image4.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="273c3-129">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](adding-a-gridview-column-of-checkboxes-vb/_static/image4.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image7.png)</span></span>

<span data-ttu-id="273c3-130">**Figura 4**: Impostare l'elenco a discesa sono elencati nell'aggiornamento, inserimento ed eliminare schede su (nessuno) ([fare clic per visualizzare l'immagine con dimensioni normali](adding-a-gridview-column-of-checkboxes-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="273c3-130">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image8.png))</span></span>


<span data-ttu-id="273c3-131">Dopo aver completato la procedura guidata Configura origine dati, Visual Studio creerà automaticamente BoundColumns e un CheckBoxColumn per i campi dati relativi al prodotto.</span><span class="sxs-lookup"><span data-stu-id="273c3-131">After completing the Configure Data Source wizard, Visual Studio will automatically create BoundColumns and a CheckBoxColumn for the product-related data fields.</span></span> <span data-ttu-id="273c3-132">Come abbiamo fatto nell'esercitazione precedente, rimuovere tutto tranne il `ProductName`, `CategoryName`, e `UnitPrice` BoundField e modificare il `HeaderText` le proprietà del prodotto, categoria e prezzo.</span><span class="sxs-lookup"><span data-stu-id="273c3-132">Like we did in the previous tutorial, remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields, and change the `HeaderText` properties to Product, Category, and Price.</span></span> <span data-ttu-id="273c3-133">Configurare il `UnitPrice` BoundField in modo che il relativo valore viene formattato come una valuta.</span><span class="sxs-lookup"><span data-stu-id="273c3-133">Configure the `UnitPrice` BoundField so that its value is formatted as a currency.</span></span> <span data-ttu-id="273c3-134">Configurare inoltre il controllo GridView per supportare il paging selezionando la casella di controllo Attiva Paging nello smart tag.</span><span class="sxs-lookup"><span data-stu-id="273c3-134">Also configure the GridView to support paging by checking the Enable Paging checkbox from the smart tag.</span></span>

<span data-ttu-id="273c3-135">Consentire s aggiungere anche l'interfaccia utente per l'eliminazione di prodotti selezionati.</span><span class="sxs-lookup"><span data-stu-id="273c3-135">Let s also add the user interface for deleting the selected products.</span></span> <span data-ttu-id="273c3-136">Aggiungere un controllo pulsante Web sotto il controllo GridView, l'impostazione relativa `ID` al `DeleteSelectedProducts` e il relativo `Text` proprietà da eliminare i prodotti selezionati.</span><span class="sxs-lookup"><span data-stu-id="273c3-136">Add a Button Web control beneath the GridView, setting its `ID` to `DeleteSelectedProducts` and its `Text` property to Delete Selected Products.</span></span> <span data-ttu-id="273c3-137">Anziché eliminare effettivamente i prodotti dal database, in questo esempio verrà semplicemente visualizzato un messaggio che informa i prodotti che dovrebbero essere stati eliminati.</span><span class="sxs-lookup"><span data-stu-id="273c3-137">Rather than actually deleting products from the database, for this example we'll just display a message stating the products that would have been deleted.</span></span> <span data-ttu-id="273c3-138">Per risolvere questo problema, aggiungere un controllo etichetta Web sotto il pulsante.</span><span class="sxs-lookup"><span data-stu-id="273c3-138">To accommodate this, add a Label Web control beneath the Button.</span></span> <span data-ttu-id="273c3-139">Impostare l'ID `DeleteResults`, deselezionare le relative `Text` proprietà e set relativo `Visible` e `EnableViewState` le proprietà da `False`.</span><span class="sxs-lookup"><span data-stu-id="273c3-139">Set its ID to `DeleteResults`, clear out its `Text` property, and set its `Visible` and `EnableViewState` properties to `False`.</span></span>

<span data-ttu-id="273c3-140">Dopo aver apportato queste modifiche, GridView, ObjectDataSource, pulsante ed etichetta s markup dichiarativo deve simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="273c3-140">After making these changes, the GridView, ObjectDataSource, Button, and Label s declarative markup should similar to the following:</span></span>


[!code-aspx[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample1.aspx)]

<span data-ttu-id="273c3-141">Si consiglia di visualizzare la pagina in un browser (vedere la figura 5).</span><span class="sxs-lookup"><span data-stu-id="273c3-141">Take a moment to view the page in a browser (see Figure 5).</span></span> <span data-ttu-id="273c3-142">A questo punto si dovrebbe vedere il nome, categoria e prezzo dei primi dieci prodotti.</span><span class="sxs-lookup"><span data-stu-id="273c3-142">At this point you should see the name, category, and price of the first ten products.</span></span>


<span data-ttu-id="273c3-143">[![Il nome, categoria e prezzo dei primi 10 prodotti sono elencati](adding-a-gridview-column-of-checkboxes-vb/_static/image5.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="273c3-143">[![The Name, Category, and Price of the First Ten Products are Listed](adding-a-gridview-column-of-checkboxes-vb/_static/image5.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image9.png)</span></span>

<span data-ttu-id="273c3-144">**Figura 5**: Sono elencati il nome, categoria e prezzo dei primi dieci prodotti ([fare clic per visualizzare l'immagine con dimensioni normali](adding-a-gridview-column-of-checkboxes-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="273c3-144">**Figure 5**: The Name, Category, and Price of the First Ten Products are Listed ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image10.png))</span></span>


## <a name="step-2-adding-a-column-of-checkboxes"></a><span data-ttu-id="273c3-145">Passaggio 2: Aggiunta di una colonna di caselle di controllo</span><span class="sxs-lookup"><span data-stu-id="273c3-145">Step 2: Adding a Column of Checkboxes</span></span>

<span data-ttu-id="273c3-146">Poiché ASP.NET 2.0 include un CampoCasellaDiControllo, si potrebbe pensare che può essere usato per aggiungere una colonna di caselle di controllo in un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="273c3-146">Since ASP.NET 2.0 includes a CheckBoxField, one might think that it could be used to add a column of checkboxes to a GridView.</span></span> <span data-ttu-id="273c3-147">Sfortunatamente, che non è il caso, come il CampoCasellaDiControllo è progettato per funzionare con un campo di dati Boolean.</span><span class="sxs-lookup"><span data-stu-id="273c3-147">Unfortunately, that is not the case, as the CheckBoxField is designed to work with a Boolean data field.</span></span> <span data-ttu-id="273c3-148">Vale a dire, per poter utilizzare il CampoCasellaDiControllo dobbiamo specificare il campo di dati sottostante il cui valore viene consultato per determinare se è selezionata la casella di controllo viene eseguito il rendering.</span><span class="sxs-lookup"><span data-stu-id="273c3-148">That is, in order to use the CheckBoxField we must specify the underlying data field whose value is consulted to determine whether the rendered checkbox is checked.</span></span> <span data-ttu-id="273c3-149">Usiamo il CampoCasellaDiControllo non possiamo semplicemente includere una colonna di caselle di controllo è deselezionata.</span><span class="sxs-lookup"><span data-stu-id="273c3-149">We cannot use the CheckBoxField to just include a column of unchecked checkboxes.</span></span>

<span data-ttu-id="273c3-150">In alternativa, è necessario aggiungere un TemplateField e aggiungere un controllo casella di controllo Web a relativo `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="273c3-150">Instead, we must add a TemplateField and add a CheckBox Web control to its `ItemTemplate`.</span></span> <span data-ttu-id="273c3-151">Aggiungere un TemplateField al `Products` GridView e renderlo il primo campo (a sinistra).</span><span class="sxs-lookup"><span data-stu-id="273c3-151">Go ahead and add a TemplateField to the `Products` GridView and make it the first (far-left) field.</span></span> <span data-ttu-id="273c3-152">GridView s nello smart tag, fare clic sul collegamento di modifica modelli e quindi trascinare un controllo casella di controllo Web dalla casella degli strumenti nel `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="273c3-152">From the GridView s smart tag, click on the Edit Templates link and then drag a CheckBox Web control from the Toolbox into the `ItemTemplate`.</span></span> <span data-ttu-id="273c3-153">Impostare s questa casella di controllo `ID` proprietà `ProductSelector`.</span><span class="sxs-lookup"><span data-stu-id="273c3-153">Set this CheckBox s `ID` property to `ProductSelector`.</span></span>


<span data-ttu-id="273c3-154">[![Aggiungere un controllo casella di controllo Web denominato ProductSelector all'ItemTemplate s TemplateField](adding-a-gridview-column-of-checkboxes-vb/_static/image6.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="273c3-154">[![Add a CheckBox Web Control Named ProductSelector to the TemplateField s ItemTemplate](adding-a-gridview-column-of-checkboxes-vb/_static/image6.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image11.png)</span></span>

<span data-ttu-id="273c3-155">**Figura 6**: Aggiungere un controllo casella di controllo di Web denominato `ProductSelector` ai dispositivi TemplateField `ItemTemplate` ([fare clic per visualizzare l'immagine con dimensioni normali](adding-a-gridview-column-of-checkboxes-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="273c3-155">**Figure 6**: Add a CheckBox Web Control Named `ProductSelector` to the TemplateField s `ItemTemplate` ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image12.png))</span></span>


<span data-ttu-id="273c3-156">Con il controllo casella di controllo Web e TemplateField aggiunto, ogni riga include ora una casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="273c3-156">With the TemplateField and CheckBox Web control added, each row now includes a checkbox.</span></span> <span data-ttu-id="273c3-157">Figura 7 Mostra questa pagina, quando viene visualizzato tramite un browser, dopo che sono stati aggiunti i TemplateField e una casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="273c3-157">Figure 7 shows this page, when viewed through a browser, after the TemplateField and CheckBox have been added.</span></span>


<span data-ttu-id="273c3-158">[![Ogni riga del prodotto include ora una casella di controllo](adding-a-gridview-column-of-checkboxes-vb/_static/image7.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="273c3-158">[![Each Product Row Now Includes a Checkbox](adding-a-gridview-column-of-checkboxes-vb/_static/image7.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image13.png)</span></span>

<span data-ttu-id="273c3-159">**Figura 7**: Ogni riga del prodotto include ora una casella di controllo ([fare clic per visualizzare l'immagine con dimensioni normali](adding-a-gridview-column-of-checkboxes-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="273c3-159">**Figure 7**: Each Product Row Now Includes a Checkbox ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image14.png))</span></span>


## <a name="step-3-determining-what-checkboxes-were-checked-on-postback"></a><span data-ttu-id="273c3-160">Passaggio 3: Determinare quali caselle di controllo sono state controllate durante il Postback</span><span class="sxs-lookup"><span data-stu-id="273c3-160">Step 3: Determining What Checkboxes Were Checked On Postback</span></span>

<span data-ttu-id="273c3-161">A questo punto si dispone di una colonna di caselle di controllo, ma un modo per determinare quali caselle di controllo sono state controllate durante il postback.</span><span class="sxs-lookup"><span data-stu-id="273c3-161">At this point we have a column of checkboxes but no way to determine what checkboxes were checked on postback.</span></span> <span data-ttu-id="273c3-162">Quando si fa clic sul pulsante Elimina i prodotti selezionati, tuttavia, è necessario conoscere quali caselle di controllo sono state controllate per eliminare tali prodotti.</span><span class="sxs-lookup"><span data-stu-id="273c3-162">When the Delete Selected Products button is clicked, though, we need to know what checkboxes were checked in order to delete those products.</span></span>

<span data-ttu-id="273c3-163">Le s GridView [ `Rows` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows.aspx) fornisce l'accesso alle righe di dati nel GridView.</span><span class="sxs-lookup"><span data-stu-id="273c3-163">The GridView s [`Rows` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows.aspx) provides access to the data rows in the GridView.</span></span> <span data-ttu-id="273c3-164">È possibile eseguire l'iterazione attraverso queste righe, la casella di controllo di accesso a livello di codice e quindi fare riferimento relativo `Checked` proprietà per determinare se è stata selezionata la casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="273c3-164">We can iterate through these rows, programmatically access the CheckBox control, and then consult its `Checked` property to determine whether the CheckBox has been selected.</span></span>

<span data-ttu-id="273c3-165">Creare un gestore eventi per il `DeleteSelectedProducts` controllo pulsante Web s `Click` eventi e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="273c3-165">Create an event handler for the `DeleteSelectedProducts` Button Web control s `Click` event and add the following code:</span></span>


[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample2.vb)]

<span data-ttu-id="273c3-166">Il `Rows` proprietà restituisce una raccolta di `GridViewRow` le istanze di tale struttura le righe di dati di s GridView.</span><span class="sxs-lookup"><span data-stu-id="273c3-166">The `Rows` property returns a collection of `GridViewRow` instances that makeup the GridView s data rows.</span></span> <span data-ttu-id="273c3-167">Il `For Each` ciclo qui enumera la raccolta.</span><span class="sxs-lookup"><span data-stu-id="273c3-167">The `For Each` loop here enumerates this collection.</span></span> <span data-ttu-id="273c3-168">Per ognuno `GridViewRow` dell'oggetto, la riga s casella di controllo a livello di codice si accede tramite `row.FindControl("controlID")`.</span><span class="sxs-lookup"><span data-stu-id="273c3-168">For each `GridViewRow` object, the row s CheckBox is programmatically accessed using `row.FindControl("controlID")`.</span></span> <span data-ttu-id="273c3-169">Se la casella di controllo è selezionata, la riga o le righe corrispondenti `ProductID` valore viene recuperato dal `DataKeys` raccolta.</span><span class="sxs-lookup"><span data-stu-id="273c3-169">If the CheckBox is checked, the row s corresponding `ProductID` value is retrieved from the `DataKeys` collection.</span></span> <span data-ttu-id="273c3-170">In questo esercizio, è sufficiente visualizzare un messaggio informativo nel `DeleteResults` assegnare un'etichetta, anche se in un'applicazione funzionante è il d invece eseguire una chiamata per il `ProductsBLL` classe s `DeleteProduct(productID)` (metodo).</span><span class="sxs-lookup"><span data-stu-id="273c3-170">In this exercise, we simply display an informative message in the `DeleteResults` Label, although in a working application we d instead make a call to the `ProductsBLL` class s `DeleteProduct(productID)` method.</span></span>

<span data-ttu-id="273c3-171">Con l'aggiunta di questo gestore dell'evento, fare clic sul pulsante Elimina prodotti selezionati ora consente di visualizzare il `ProductID` s di prodotti selezionati.</span><span class="sxs-lookup"><span data-stu-id="273c3-171">With the addition of this event handler, clicking the Delete Selected Products button now displays the `ProductID` s of the selected products.</span></span>


<span data-ttu-id="273c3-172">[![Quando si fa clic sul pulsante prodotti eliminare selezionata sono elencate ProductIDs i prodotti selezionati](adding-a-gridview-column-of-checkboxes-vb/_static/image8.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="273c3-172">[![When the Delete Selected Products Button is Clicked the Selected Products ProductIDs are Listed](adding-a-gridview-column-of-checkboxes-vb/_static/image8.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image15.png)</span></span>

<span data-ttu-id="273c3-173">**Figura 8**: Quando elimina selezionato prodotti fa clic sul pulsante i prodotti selezionati `ProductID` sono elencati ([fare clic per visualizzare l'immagine con dimensioni normali](adding-a-gridview-column-of-checkboxes-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="273c3-173">**Figure 8**: When the Delete Selected Products Button is Clicked the Selected Products `ProductID` s are Listed ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image16.png))</span></span>


## <a name="step-4-adding-check-all-and-uncheck-all-buttons"></a><span data-ttu-id="273c3-174">Passaggio 4: Aggiunta di selezionare tutte e deselezionare tutti i pulsanti</span><span class="sxs-lookup"><span data-stu-id="273c3-174">Step 4: Adding Check All and Uncheck All Buttons</span></span>

<span data-ttu-id="273c3-175">Se un utente vuole eliminare tutti i prodotti nella pagina corrente, è necessario controllare ogni le dieci caselle di controllo.</span><span class="sxs-lookup"><span data-stu-id="273c3-175">If a user wants to delete all products on the current page, they must check each of the ten checkboxes.</span></span> <span data-ttu-id="273c3-176">Possiamo aiutarti accelerare questo processo aggiungendo tutti un controllo pulsante che, quando si fa clic, consente di selezionare tutte le caselle di controllo nella griglia.</span><span class="sxs-lookup"><span data-stu-id="273c3-176">We can help expedite this process by adding a Check All button that, when clicked, selects all of the checkboxes in the grid.</span></span> <span data-ttu-id="273c3-177">Un pulsante deselezionare tutto sarebbe ugualmente utile.</span><span class="sxs-lookup"><span data-stu-id="273c3-177">An Uncheck All button would be equally helpful.</span></span>

<span data-ttu-id="273c3-178">Aggiungere due controlli Web pulsante alla pagina, inserirli sopra il controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="273c3-178">Add two Button Web controls to the page, placing them above the GridView.</span></span> <span data-ttu-id="273c3-179">Impostare i dispositivi prima di tutto una `ID` a `CheckAll` e il relativo `Text` controllare tutte le proprietà, impostare la seconda s `ID` a `UncheckAll` e il relativo `Text` deselezionare tutte le proprietà.</span><span class="sxs-lookup"><span data-stu-id="273c3-179">Set the first one s `ID` to `CheckAll` and its `Text` property to Check All ; set the second one s `ID` to `UncheckAll` and its `Text` property to Uncheck All .</span></span>


[!code-aspx[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample3.aspx)]

<span data-ttu-id="273c3-180">Successivamente, creare un metodo nella classe code-behind denominata `ToggleCheckState(checkState)` che, quando richiamata, enumera le `Products` s GridView `Rows` insieme e imposta ogni s casella di controllo `Checked` sul valore dell'oggetto passato in *oggetto checkState*  parametro.</span><span class="sxs-lookup"><span data-stu-id="273c3-180">Next, create a method in the code-behind class named `ToggleCheckState(checkState)` that, when invoked, enumerates the `Products` GridView s `Rows` collection and sets each CheckBox s `Checked` property to the value of the passed in *checkState* parameter.</span></span>


[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample4.vb)]

<span data-ttu-id="273c3-181">A questo punto, creare `Click` gestori eventi per il `CheckAll` e `UncheckAll` pulsanti.</span><span class="sxs-lookup"><span data-stu-id="273c3-181">Next, create `Click` event handlers for the `CheckAll` and `UncheckAll` buttons.</span></span> <span data-ttu-id="273c3-182">Nelle `CheckAll` gestore dell'evento s, semplicemente chiamare `ToggleCheckState(True)`; nella `UncheckAll`, chiamare `ToggleCheckState(False)`.</span><span class="sxs-lookup"><span data-stu-id="273c3-182">In `CheckAll` s event handler, simply call `ToggleCheckState(True)`; in `UncheckAll`, call `ToggleCheckState(False)`.</span></span>


[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample5.vb)]

<span data-ttu-id="273c3-183">Con questo codice, fare clic sul pulsante Seleziona tutto determina un postback e controlla tutte le caselle di controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="273c3-183">With this code, clicking the Check All button causes a postback and checks all of the checkboxes in the GridView.</span></span> <span data-ttu-id="273c3-184">Analogamente, facendo clic su deselezionare tutti Deseleziona tutte le caselle di controllo.</span><span class="sxs-lookup"><span data-stu-id="273c3-184">Likewise, clicking Uncheck All unselects all checkboxes.</span></span> <span data-ttu-id="273c3-185">Figura 9 mostra la schermata dopo aver verificato il pulsante Seleziona tutto.</span><span class="sxs-lookup"><span data-stu-id="273c3-185">Figure 9 shows the screen after the Check All button has been checked.</span></span>


<span data-ttu-id="273c3-186">[![Scegliere il controllo di che tutte sul pulsante Seleziona tutte le caselle di controllo](adding-a-gridview-column-of-checkboxes-vb/_static/image9.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="273c3-186">[![Clicking the Check All Button Selects All Checkboxes](adding-a-gridview-column-of-checkboxes-vb/_static/image9.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image17.png)</span></span>

<span data-ttu-id="273c3-187">**Figura 9**: Facendo clic su di controllare tutti i pulsante Seleziona tutte le caselle di controllo ([fare clic per visualizzare l'immagine con dimensioni normali](adding-a-gridview-column-of-checkboxes-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="273c3-187">**Figure 9**: Clicking the Check All Button Selects All Checkboxes ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="273c3-188">Quando la visualizzazione di una colonna di caselle di controllo, uno degli approcci per la selezione o la deselezione di tutte le caselle di controllo è tramite una casella di controllo nella riga di intestazione.</span><span class="sxs-lookup"><span data-stu-id="273c3-188">When displaying a column of checkboxes, one approach for selecting or unselecting all of the checkboxes is through a checkbox in the header row.</span></span> <span data-ttu-id="273c3-189">Inoltre, corrente selezionare tutte le / deselezionare tutti implementazione richiede un postback.</span><span class="sxs-lookup"><span data-stu-id="273c3-189">Moreover, the current Check All / Uncheck All implementation requires a postback.</span></span> <span data-ttu-id="273c3-190">Le caselle di controllo può essere selezionato o deselezionato, tuttavia, completamente tramite script lato client, offrendo così un'esperienza utente eseguiremo.</span><span class="sxs-lookup"><span data-stu-id="273c3-190">The checkboxes can be checked or unchecked, however, entirely through client-side script, thereby providing a snappier user experience.</span></span> <span data-ttu-id="273c3-191">Per analizzare l'uso di una casella di controllo di righe di intestazione per controllare tutti e deselezionare tutti in modo dettagliato, insieme a una discussione sull'utilizzo delle tecniche di lato client, consultare [controllo di tutte le caselle di controllo in uno Script lato Client con GridView e controllare tutte la casella di controllo](http://aspnet.4guysfromrolla.com/articles/053106-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="273c3-191">To explore using a header row checkbox for Check All and Uncheck All in detail, along with a discussion on using client-side techniques, check out [Checking All CheckBoxes in a GridView Using Client-Side Script and a Check All CheckBox](http://aspnet.4guysfromrolla.com/articles/053106-1.aspx).</span></span>


## <a name="summary"></a><span data-ttu-id="273c3-192">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="273c3-192">Summary</span></span>

<span data-ttu-id="273c3-193">Nei casi in cui è necessario per consentire agli utenti di scegliere un numero arbitrario di righe da un controllo GridView prima di procedere, aggiunta di una colonna di caselle di controllo è un'opzione.</span><span class="sxs-lookup"><span data-stu-id="273c3-193">In cases where you need to let users choose an arbitrary number of rows from a GridView before proceeding, adding a column of checkboxes is one option.</span></span> <span data-ttu-id="273c3-194">Come abbiamo visto in questa esercitazione, tra cui una colonna di caselle di controllo GridView comporta l'aggiunta di un TemplateField con un controllo casella di controllo Web.</span><span class="sxs-lookup"><span data-stu-id="273c3-194">As we saw in this tutorial, including a column of checkboxes in the GridView entails adding a TemplateField with a CheckBox Web control.</span></span> <span data-ttu-id="273c3-195">Usando un controllo Web (rispetto a inserimento markup direttamente nel modello, come è stato fatto nell'esercitazione precedente) ASP.NET memorizza automaticamente quali erano le caselle di controllo e non sono state archiviate durante il postback.</span><span class="sxs-lookup"><span data-stu-id="273c3-195">By using a Web control (versus injecting markup directly into the template, as we did in the previous tutorial) ASP.NET automatically remembers what CheckBoxes were and were not checked across postback.</span></span> <span data-ttu-id="273c3-196">È possibile accedere anche a livello di codice le caselle di controllo nel codice per determinare se una casella di controllo specificato è selezionato o per modificare lo stato di selezione.</span><span class="sxs-lookup"><span data-stu-id="273c3-196">We can also programmatically access the CheckBoxes in code to determine whether a given CheckBox is checked, or to change the checked state.</span></span>

<span data-ttu-id="273c3-197">Questa esercitazione e il penultimo esaminato l'aggiunta di una colonna di selezione della riga a GridView.</span><span class="sxs-lookup"><span data-stu-id="273c3-197">This tutorial and the last one looked at adding a row selector column to the GridView.</span></span> <span data-ttu-id="273c3-198">Nell'esercitazione successiva verrà esaminato come fare, con un po' di lavoro, è possibile aggiungere funzionalità di inserimento a GridView.</span><span class="sxs-lookup"><span data-stu-id="273c3-198">In our next tutorial we'll examine how, with a bit of work, we can add inserting capabilities to the GridView.</span></span>

<span data-ttu-id="273c3-199">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="273c3-199">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="273c3-200">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="273c3-200">About the Author</span></span>

<span data-ttu-id="273c3-201">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="273c3-201">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="273c3-202">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="273c3-202">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="273c3-203">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="273c3-203">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="273c3-204">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="273c3-204">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="273c3-205">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="273c3-205">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="273c3-206">[Precedente](adding-a-gridview-column-of-radio-buttons-vb.md)
> [Successivo](inserting-a-new-record-from-the-gridview-s-footer-vb.md)</span><span class="sxs-lookup"><span data-stu-id="273c3-206">[Previous](adding-a-gridview-column-of-radio-buttons-vb.md)
[Next](inserting-a-new-record-from-the-gridview-s-footer-vb.md)</span></span>
