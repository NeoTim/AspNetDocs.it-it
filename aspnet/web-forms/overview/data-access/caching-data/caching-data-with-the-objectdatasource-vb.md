---
uid: web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
title: Memorizzazione dei dati nella cache con ObjectDataSource (VB) | Microsoft Docs
author: rick-anderson
description: La memorizzazione nella cache può indicare la differenza tra un'applicazione Web lenta e una rapida. Questa esercitazione è la prima di quattro che prende una descrizione dettagliata della memorizzazione nella cache in ASP.NET...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: 2e56a733-5512-48a6-9276-70a65bbe4d5d
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 16f20d9a0f4f677073174d680418b278dba40b07
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/28/2019
ms.locfileid: "74612140"
---
# <a name="caching-data-with-the-objectdatasource-vb"></a><span data-ttu-id="c9913-104">Memorizzazione di dati nella cache con ObjectDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="c9913-104">Caching Data with the ObjectDataSource (VB)</span></span>

<span data-ttu-id="c9913-105">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c9913-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c9913-106">[Scaricare l'app di esempio](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) o [scaricare il file PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c9913-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) or [Download PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span></span>

> <span data-ttu-id="c9913-107">La memorizzazione nella cache può indicare la differenza tra un'applicazione Web lenta e una rapida.</span><span class="sxs-lookup"><span data-stu-id="c9913-107">Caching can mean the difference between a slow and a fast Web application.</span></span> <span data-ttu-id="c9913-108">Questa esercitazione è la prima di quattro che esamina in dettaglio la memorizzazione nella cache in ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="c9913-108">This tutorial is the first of four that take a detailed look at caching in ASP.NET.</span></span> <span data-ttu-id="c9913-109">Informazioni sui concetti chiave relativi alla memorizzazione nella cache e su come applicare la memorizzazione nella cache al livello di presentazione tramite il controllo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c9913-109">Learn the key concepts of caching and how to apply caching to the Presentation Layer through the ObjectDataSource control.</span></span>

## <a name="introduction"></a><span data-ttu-id="c9913-110">Introduzione</span><span class="sxs-lookup"><span data-stu-id="c9913-110">Introduction</span></span>

<span data-ttu-id="c9913-111">In informatica, la *memorizzazione nella cache* è il processo di acquisizione di dati o informazioni che è costoso ottenere e archiviare una copia in una posizione più veloce per l'accesso.</span><span class="sxs-lookup"><span data-stu-id="c9913-111">In computer science, *caching* is the process of taking data or information that is expensive to obtain and storing a copy of it in a location that is quicker to access.</span></span> <span data-ttu-id="c9913-112">Per le applicazioni basate sui dati, le query di grandi dimensioni e complesse utilizzano generalmente la maggior parte del tempo di esecuzione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c9913-112">For data-driven applications, large and complex queries commonly consume the majority of the application s execution time.</span></span> <span data-ttu-id="c9913-113">Le prestazioni di un'applicazione di questo tipo possono spesso essere migliorate archiviando i risultati delle query di database costose nella memoria dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c9913-113">Such an application s performance, then, can often be improved by storing the results of expensive database queries in the application s memory.</span></span>

<span data-ttu-id="c9913-114">ASP.NET 2,0 offre un'ampia gamma di opzioni di memorizzazione nella cache.</span><span class="sxs-lookup"><span data-stu-id="c9913-114">ASP.NET 2.0 offers a variety of caching options.</span></span> <span data-ttu-id="c9913-115">Un'intera pagina Web o un markup di rendering del controllo utente può essere memorizzato nella cache tramite la *memorizzazione nella cache di output*.</span><span class="sxs-lookup"><span data-stu-id="c9913-115">An entire web page or User Control s rendered markup can be cached through *output caching*.</span></span> <span data-ttu-id="c9913-116">I controlli ObjectDataSource e SqlDataSource forniscono anche funzionalità di memorizzazione nella cache, consentendo così la memorizzazione dei dati nella cache a livello di controllo.</span><span class="sxs-lookup"><span data-stu-id="c9913-116">The ObjectDataSource and SqlDataSource controls provide caching capabilities as well, thereby allowing data to be cached at the control level.</span></span> <span data-ttu-id="c9913-117">E ASP.NET s *data cache* fornisce un'API di Caching avanzata che consente agli sviluppatori di pagine di memorizzare nella cache gli oggetti a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="c9913-117">And ASP.NET s *data cache* provides a rich caching API that enables page developers to programmatically cache objects.</span></span> <span data-ttu-id="c9913-118">In questa esercitazione e nei tre successivi verrà esaminato l'utilizzo delle funzionalità di memorizzazione nella cache di ObjectDataSource e della cache dei dati.</span><span class="sxs-lookup"><span data-stu-id="c9913-118">In this tutorial and the next three we'll examine using the ObjectDataSource s caching features as well as the data cache.</span></span> <span data-ttu-id="c9913-119">Si esaminerà anche come memorizzare nella cache i dati a livello di applicazione all'avvio e come mantengono aggiornati i dati memorizzati nella cache tramite l'uso delle dipendenze della cache SQL.</span><span class="sxs-lookup"><span data-stu-id="c9913-119">We'll also explore how to cache application-wide data at startup and how to keep cached data fresh through the use of SQL cache dependencies.</span></span> <span data-ttu-id="c9913-120">Queste esercitazioni non esplorano la memorizzazione nella cache di output.</span><span class="sxs-lookup"><span data-stu-id="c9913-120">These tutorials do not explore output caching.</span></span> <span data-ttu-id="c9913-121">Per informazioni dettagliate sulla memorizzazione nella cache di output, vedere la pagina relativa alla [memorizzazione nella cache di output in ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="c9913-121">For a detailed look at output caching, see [Output Caching in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span></span>

<span data-ttu-id="c9913-122">È possibile applicare la memorizzazione nella cache in qualsiasi punto dell'architettura, dal livello di accesso ai dati fino al livello di presentazione.</span><span class="sxs-lookup"><span data-stu-id="c9913-122">Caching can be applied at any place in the architecture, from the Data Access Layer up through the Presentation Layer.</span></span> <span data-ttu-id="c9913-123">In questa esercitazione verrà illustrato come applicare la memorizzazione nella cache al livello di presentazione tramite il controllo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c9913-123">In this tutorial we'll look at applying caching to the Presentation Layer through the ObjectDataSource control.</span></span> <span data-ttu-id="c9913-124">Nell'esercitazione successiva verranno esaminati i dati memorizzati nella cache a livello della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c9913-124">In the next tutorial we'll examine caching data at the Business Logic Layer.</span></span>

## <a name="key-caching-concepts"></a><span data-ttu-id="c9913-125">Concetti chiave relativi alla memorizzazione nella cache</span><span class="sxs-lookup"><span data-stu-id="c9913-125">Key Caching Concepts</span></span>

<span data-ttu-id="c9913-126">La memorizzazione nella cache può migliorare notevolmente le prestazioni e la scalabilità complessive di un'applicazione, prendendo i dati costosi per generare e archiviare una copia in una posizione a cui è possibile accedere in modo più efficiente.</span><span class="sxs-lookup"><span data-stu-id="c9913-126">Caching can greatly improve an application s overall performance and scalability by taking data that is expensive to generate and storing a copy of it in a location that can be more efficiently accessed.</span></span> <span data-ttu-id="c9913-127">Poiché la cache include solo una copia dei dati effettivi sottostanti, può diventare obsoleta o non *aggiornata*se i dati sottostanti vengono modificati.</span><span class="sxs-lookup"><span data-stu-id="c9913-127">Since the cache holds just a copy of the actual, underlying data, it can become outdated, or *stale*, if the underlying data changes.</span></span> <span data-ttu-id="c9913-128">Per contrastare questo problema, uno sviluppatore di pagine può indicare i criteri in base ai quali l'elemento della cache verrà *rimosso* dalla cache, usando:</span><span class="sxs-lookup"><span data-stu-id="c9913-128">To combat this, a page developer can indicate criteria by which the cache item will be *evicted* from the cache, using either:</span></span>

- <span data-ttu-id="c9913-129">**Criteri basati sul tempo** è possibile aggiungere un elemento alla cache per una durata assoluta o variabile.</span><span class="sxs-lookup"><span data-stu-id="c9913-129">**Time-based criteria** an item may be added to the cache for an absolute or sliding duration.</span></span> <span data-ttu-id="c9913-130">Ad esempio, uno sviluppatore di pagine può indicare una durata di, ad esempio, 60 secondi.</span><span class="sxs-lookup"><span data-stu-id="c9913-130">For example, a page developer may indicate a duration of, say, 60 seconds.</span></span> <span data-ttu-id="c9913-131">Con una durata assoluta, l'elemento memorizzato nella cache viene eliminato 60 secondi dopo che è stato aggiunto alla cache, indipendentemente dalla frequenza con cui è stato eseguito l'accesso.</span><span class="sxs-lookup"><span data-stu-id="c9913-131">With an absolute duration, the cached item is evicted 60 seconds after it was added to cache, regardless of how frequently it was accessed.</span></span> <span data-ttu-id="c9913-132">Con una durata variabile, l'elemento memorizzato nella cache viene eliminato 60 secondi dopo l'ultimo accesso.</span><span class="sxs-lookup"><span data-stu-id="c9913-132">With a sliding duration, the cached item is evicted 60 seconds after the last access.</span></span>
- <span data-ttu-id="c9913-133">**Criteri basati sulle dipendenze** una dipendenza può essere associata a un elemento quando viene aggiunto alla cache.</span><span class="sxs-lookup"><span data-stu-id="c9913-133">**Dependency-based criteria** a dependency can be associated with an item when added to the cache.</span></span> <span data-ttu-id="c9913-134">Quando la dipendenza dell'elemento viene modificata, viene rimossa dalla cache.</span><span class="sxs-lookup"><span data-stu-id="c9913-134">When the item s dependency changes it is evicted from the cache.</span></span> <span data-ttu-id="c9913-135">La dipendenza può essere un file, un altro elemento della cache o una combinazione dei due.</span><span class="sxs-lookup"><span data-stu-id="c9913-135">The dependency may be a file, another cache item, or a combination of the two.</span></span> <span data-ttu-id="c9913-136">ASP.NET 2,0 consente inoltre le dipendenze della cache SQL, che consentono agli sviluppatori di aggiungere un elemento alla cache e di rimuoverlo quando cambiano i dati del database sottostante.</span><span class="sxs-lookup"><span data-stu-id="c9913-136">ASP.NET 2.0 also allows SQL cache dependencies, which enable developers to add an item to the cache and have it evicted when the underlying database data changes.</span></span> <span data-ttu-id="c9913-137">Si esamineranno le dipendenze della cache SQL nell'esercitazione imminente [uso delle dipendenze della cache SQL](using-sql-cache-dependencies-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="c9913-137">We will examine SQL cache dependencies in the upcoming [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="c9913-138">Indipendentemente dai criteri di rimozione specificati, è possibile eseguire lo *scavenging* di un elemento nella cache prima che siano soddisfatti i criteri basati sul tempo o sulle dipendenze.</span><span class="sxs-lookup"><span data-stu-id="c9913-138">Regardless of the eviction criteria specified, an item in the cache may be *scavenged* before the time-based or dependency-based criteria has been met.</span></span> <span data-ttu-id="c9913-139">Se la cache ha raggiunto la capacità, è necessario rimuovere gli elementi esistenti prima di poter aggiungere nuovi elementi.</span><span class="sxs-lookup"><span data-stu-id="c9913-139">If the cache has reached its capacity, existing items must be removed before new ones can be added.</span></span> <span data-ttu-id="c9913-140">Di conseguenza, quando si lavora a livello di programmazione con i dati memorizzati nella cache, è fondamentale presupporre sempre che i dati memorizzati nella cache non siano presenti.</span><span class="sxs-lookup"><span data-stu-id="c9913-140">Consequently, when programmatically working with cached data it s vital that you always assume that the cached data may not be present.</span></span> <span data-ttu-id="c9913-141">Si esaminerà il modello da usare per l'accesso ai dati dalla cache a livello di programmazione nell'esercitazione successiva, ovvero la *memorizzazione nella cache dei dati nell'architettura*.</span><span class="sxs-lookup"><span data-stu-id="c9913-141">We'll look at the pattern to use when accessing data from the cache programmatically in our next tutorial, *Caching Data in the Architecture*.</span></span>

<span data-ttu-id="c9913-142">La memorizzazione nella cache offre un mezzo economico per la compressione di più prestazioni da un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c9913-142">Caching provides an economical means for squeezing more performance from an application.</span></span> <span data-ttu-id="c9913-143">Mentre [Steven Smith](http://aspadvice.com/blogs/ssmith/) articola nel suo articolo [ASP.NET Caching: tecniche e procedure consigliate](https://msdn.microsoft.com/library/aa478965.aspx):</span><span class="sxs-lookup"><span data-stu-id="c9913-143">As [Steven Smith](http://aspadvice.com/blogs/ssmith/) articulates in his article [ASP.NET Caching: Techniques and Best Practices](https://msdn.microsoft.com/library/aa478965.aspx):</span></span>

<span data-ttu-id="c9913-144">La memorizzazione nella cache può essere un buon modo per ottenere prestazioni ottimali senza richiedere molto tempo e analisi.</span><span class="sxs-lookup"><span data-stu-id="c9913-144">Caching can be a good way to get good enough performance without requiring a lot of time and analysis.</span></span> <span data-ttu-id="c9913-145">Poiché la memoria è conveniente, se è possibile ottenere le prestazioni necessarie memorizzando nella cache l'output per 30 secondi anziché spendere un giorno o una settimana che tenta di ottimizzare il codice o il database, eseguire la soluzione di memorizzazione nella cache (presupponendo che i dati dei 30 secondi precedenti siano OK) e continuare.</span><span class="sxs-lookup"><span data-stu-id="c9913-145">Memory is cheap, so if you can get the performance you need by caching the output for 30 seconds instead of spending a day or a week trying to optimize your code or database, do the caching solution (assuming 30-second old data is ok) and move on.</span></span> <span data-ttu-id="c9913-146">Alla fine, è probabile che il progetto risulterà aggiornato, quindi ovviamente è consigliabile provare a progettare correttamente le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c9913-146">Eventually, poor design will probably catch up to you, so of course you should try to design your applications correctly.</span></span> <span data-ttu-id="c9913-147">Tuttavia, se è necessario ottenere subito prestazioni sufficienti, la memorizzazione nella cache può essere un ottimo [approccio], che consente di effettuare il refactoring dell'applicazione in un secondo momento quando si ha il tempo necessario.</span><span class="sxs-lookup"><span data-stu-id="c9913-147">But if you just need to get good enough performance today, caching can be an excellent [approach], buying you time to refactor your application at a later date when you have the time to do so.</span></span>

<span data-ttu-id="c9913-148">Anche se la memorizzazione nella cache è in grado di offrire miglioramenti significativi delle prestazioni, non è applicabile in tutte le situazioni, ad esempio con applicazioni che utilizzano dati in tempo reale con aggiornamento frequente o in cui anche i dati non aggiornati di breve durata non sono accettabili.</span><span class="sxs-lookup"><span data-stu-id="c9913-148">While caching can provide appreciable performance enhancements, it is not applicable in all situations, such as with applications that use real-time, frequently-updating data, or where even shortly-lived stale data is unacceptable.</span></span> <span data-ttu-id="c9913-149">Tuttavia, per la maggior parte delle applicazioni, è consigliabile usare la memorizzazione nella cache.</span><span class="sxs-lookup"><span data-stu-id="c9913-149">But for the majority of applications, caching should be used.</span></span> <span data-ttu-id="c9913-150">Per altri dettagli sulla memorizzazione nella cache in ASP.NET 2,0, vedere la sezione [caching per le prestazioni](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) delle [esercitazioni introduttive di ASP.NET 2,0](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span><span class="sxs-lookup"><span data-stu-id="c9913-150">For more background on caching in ASP.NET 2.0, refer to the [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) section of the [ASP.NET 2.0 QuickStart Tutorials](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span></span>

## <a name="step-1-creating-the-caching-web-pages"></a><span data-ttu-id="c9913-151">Passaggio 1: creazione delle pagine Web di Caching</span><span class="sxs-lookup"><span data-stu-id="c9913-151">Step 1: Creating the Caching Web Pages</span></span>

<span data-ttu-id="c9913-152">Prima di iniziare l'esplorazione delle funzionalità di memorizzazione nella cache di ObjectDataSource, è necessario prima di tutto creare le pagine ASP.NET nel progetto del sito Web che saranno necessarie per questa esercitazione e le tre successive.</span><span class="sxs-lookup"><span data-stu-id="c9913-152">Before we start our exploration of the ObjectDataSource s caching features, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="c9913-153">Per iniziare, aggiungere una nuova cartella denominata `Caching`.</span><span class="sxs-lookup"><span data-stu-id="c9913-153">Start by adding a new folder named `Caching`.</span></span> <span data-ttu-id="c9913-154">Aggiungere quindi le pagine ASP.NET seguenti a tale cartella, assicurandosi di associare ogni pagina alla pagina master `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="c9913-154">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ObjectDataSource.aspx`
- `FromTheArchitecture.aspx`
- `AtApplicationStartup.aspx`
- `SqlCacheDependencies.aspx`

![Aggiungere le pagine ASP.NET per le esercitazioni correlate alla memorizzazione nella cache](caching-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="c9913-156">**Figura 1**: aggiungere le pagine ASP.NET per le esercitazioni correlate alla memorizzazione nella cache</span><span class="sxs-lookup"><span data-stu-id="c9913-156">**Figure 1**: Add the ASP.NET Pages for the Caching-Related Tutorials</span></span>

<span data-ttu-id="c9913-157">Analogamente alle altre cartelle, `Default.aspx` nella cartella `Caching` elenca le esercitazioni nella sezione.</span><span class="sxs-lookup"><span data-stu-id="c9913-157">Like in the other folders, `Default.aspx` in the `Caching` folder will list the tutorials in its section.</span></span> <span data-ttu-id="c9913-158">Si ricordi che il controllo utente `SectionLevelTutorialListing.ascx` fornisce questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="c9913-158">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="c9913-159">Quindi, aggiungere questo controllo utente a `Default.aspx` trascinandolo dall'Esplora soluzioni nella visualizzazione di progettazione della pagina.</span><span class="sxs-lookup"><span data-stu-id="c9913-159">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="c9913-160">[![figura 2: aggiungere il controllo utente SectionLevelTutorialListing. ascx a default. aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="c9913-160">[![Figure 2: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="c9913-161">**Figura 2**: Figura 2: aggiungere il controllo utente `SectionLevelTutorialListing.ascx` al `Default.aspx` ([fare clic per visualizzare l'immagine con dimensioni complete](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="c9913-161">**Figure 2**: Figure 2: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="c9913-162">Infine, aggiungere queste pagine come voci al file di `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="c9913-162">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="c9913-163">In particolare, aggiungere il markup seguente dopo l'utilizzo dei dati binari `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="c9913-163">Specifically, add the following markup after the Working with Binary Data `<siteMapNode>`:</span></span>

[!code-xml[Main](caching-data-with-the-objectdatasource-vb/samples/sample1.xml)]

<span data-ttu-id="c9913-164">Dopo avere aggiornato `Web.sitemap`, è possibile visualizzare il sito Web delle esercitazioni tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="c9913-164">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="c9913-165">Il menu a sinistra include ora gli elementi per le esercitazioni di Caching.</span><span class="sxs-lookup"><span data-stu-id="c9913-165">The menu on the left now includes items for the caching tutorials.</span></span>

![La mappa del sito include ora le voci per le esercitazioni sulla memorizzazione nella cache](caching-data-with-the-objectdatasource-vb/_static/image5.png)

<span data-ttu-id="c9913-167">**Figura 3**: la mappa del sito include ora le voci per le esercitazioni sulla memorizzazione nella cache</span><span class="sxs-lookup"><span data-stu-id="c9913-167">**Figure 3**: The Site Map Now Includes Entries for the Caching Tutorials</span></span>

## <a name="step-2-displaying-a-list-of-products-in-a-web-page"></a><span data-ttu-id="c9913-168">Passaggio 2: visualizzazione di un elenco di prodotti in una pagina Web</span><span class="sxs-lookup"><span data-stu-id="c9913-168">Step 2: Displaying a List of Products in a Web Page</span></span>

<span data-ttu-id="c9913-169">Questa esercitazione illustra come usare le funzionalità di memorizzazione nella cache predefinite del controllo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c9913-169">This tutorial explores how to use the ObjectDataSource control s built-in caching features.</span></span> <span data-ttu-id="c9913-170">Prima di poter esaminare queste funzionalità, tuttavia, è necessario prima di tutto una pagina da cui lavorare.</span><span class="sxs-lookup"><span data-stu-id="c9913-170">Before we can look at these features, though, we first need a page to work from.</span></span> <span data-ttu-id="c9913-171">Consente di creare una pagina Web che usa un controllo GridView per elencare le informazioni sul prodotto recuperate da ObjectDataSource dalla classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="c9913-171">Let s create a web page that uses a GridView to list product information retrieved by an ObjectDataSource from the `ProductsBLL` class.</span></span>

<span data-ttu-id="c9913-172">Per iniziare, aprire la pagina `ObjectDataSource.aspx` nella cartella `Caching`.</span><span class="sxs-lookup"><span data-stu-id="c9913-172">Start by opening the `ObjectDataSource.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="c9913-173">Trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione, impostarne la proprietà `ID` su `Products`e, dallo smart tag, scegliere di associarlo a un nuovo controllo ObjectDataSource denominato `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="c9913-173">Drag a GridView from the Toolbox onto the Designer, set its `ID` property to `Products`, and, from its smart tag, choose to bind it to a new ObjectDataSource control named `ProductsDataSource`.</span></span> <span data-ttu-id="c9913-174">Configurare ObjectDataSource in modo che funzioni con la classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="c9913-174">Configure the ObjectDataSource to work with the `ProductsBLL` class.</span></span>

<span data-ttu-id="c9913-175">[![configurare ObjectDataSource per l'utilizzo della classe ProductsBLL](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="c9913-175">[![Configure the ObjectDataSource to Use the ProductsBLL Class](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span></span>

<span data-ttu-id="c9913-176">**Figura 4**: configurare ObjectDataSource per l'uso della classe `ProductsBLL` ([fare clic per visualizzare l'immagine con dimensioni complete](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="c9913-176">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span></span>

<span data-ttu-id="c9913-177">Per questa pagina, consente di creare un GridView modificabile in modo da poter esaminare cosa accade quando i dati memorizzati nella cache in ObjectDataSource vengono modificati tramite l'interfaccia GridView s.</span><span class="sxs-lookup"><span data-stu-id="c9913-177">For this page, let s create an editable GridView so that we can examine what happens when data cached in the ObjectDataSource is modified through the GridView s interface.</span></span> <span data-ttu-id="c9913-178">Lasciare l'elenco a discesa nella scheda Seleziona impostata sul valore predefinito, `GetProducts()`, ma modificare l'elemento selezionato nella scheda Aggiorna sull'overload `UpdateProduct` che accetta `productName`, `unitPrice`e `productID` come parametri di input.</span><span class="sxs-lookup"><span data-stu-id="c9913-178">Leave the drop-down list in the SELECT tab set to its default, `GetProducts()`, but change the selected item in the UPDATE tab to the `UpdateProduct` overload that accepts `productName`, `unitPrice`, and `productID` as its input parameters.</span></span>

<span data-ttu-id="c9913-179">[![impostare l'elenco a discesa scheda aggiornamento sull'overload UpdateProduct appropriato](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="c9913-179">[![Set the UPDATE Tab s Drop-Down List to the Appropriate UpdateProduct Overload](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="c9913-180">**Figura 5**: impostare l'elenco a discesa della scheda aggiornamento sull'overload `UpdateProduct` appropriato ([fare clic per visualizzare l'immagine con dimensioni complete](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="c9913-180">**Figure 5**: Set the UPDATE Tab s Drop-Down List to the Appropriate `UpdateProduct` Overload ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span></span>

<span data-ttu-id="c9913-181">Infine, impostare gli elenchi a discesa nelle schede Inserisci ed Elimina su (nessuno) e fare clic su fine.</span><span class="sxs-lookup"><span data-stu-id="c9913-181">Finally, set the drop-down lists in the INSERT and DELETE tabs to (None) and click Finish.</span></span> <span data-ttu-id="c9913-182">Al termine della configurazione guidata origine dati, Visual Studio imposta la proprietà `OldValuesParameterFormatString` di ObjectDataSource su `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="c9913-182">Upon completing the Configure Data Source wizard, Visual Studio sets the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="c9913-183">Come illustrato in [un'esercitazione introduttiva sull'inserimento, l'aggiornamento e l'eliminazione dei dati](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) , questa proprietà deve essere rimossa dalla sintassi dichiarativa o impostata nuovamente sul valore predefinito, `{0}`, per consentire al flusso di lavoro di aggiornamento di procedere senza errori.</span><span class="sxs-lookup"><span data-stu-id="c9913-183">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, this property needs to be removed from the declarative syntax or set back to its default value, `{0}`, in order for our update workflow to proceed without error.</span></span>

<span data-ttu-id="c9913-184">Al termine della procedura guidata, inoltre, Visual Studio aggiunge un campo a GridView per ognuno dei campi dati del prodotto.</span><span class="sxs-lookup"><span data-stu-id="c9913-184">Furthermore, at the completion of the wizard Visual Studio adds a field to the GridView for each of the product data fields.</span></span> <span data-ttu-id="c9913-185">Rimuovere tutti i BoundField tranne `ProductName`, `CategoryName`e `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="c9913-185">Remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="c9913-186">Successivamente, aggiornare le proprietà del `HeaderText` di ognuno di questi BoundField rispettivamente al prodotto, alla categoria e al prezzo.</span><span class="sxs-lookup"><span data-stu-id="c9913-186">Next, update the `HeaderText` properties of each of these BoundFields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="c9913-187">Poiché il campo `ProductName` è obbligatorio, convertire il BoundField in un TemplateField e aggiungere un RequiredFieldValidator al `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c9913-187">Since the `ProductName` field is required, convert the BoundField into a TemplateField and add a RequiredFieldValidator to the `EditItemTemplate`.</span></span> <span data-ttu-id="c9913-188">Analogamente, convertire il BoundField `UnitPrice` in un TemplateField e aggiungere un oggetto CompareValidator per assicurarsi che il valore immesso dall'utente sia un valore di valuta valido maggiore o uguale a zero.</span><span class="sxs-lookup"><span data-stu-id="c9913-188">Similarly, convert the `UnitPrice` BoundField into a TemplateField and add a CompareValidator to ensure that the value entered by the user is a valid currency value that s greater than or equal to zero.</span></span> <span data-ttu-id="c9913-189">Oltre a queste modifiche, è possibile eseguire tutte le modifiche estetiche, ad esempio l'allineamento a destra del valore `UnitPrice` o la formattazione del testo `UnitPrice` nelle interfacce di sola lettura e di modifica.</span><span class="sxs-lookup"><span data-stu-id="c9913-189">In addition to these modifications, feel free to perform any aesthetic changes, such as right-aligning the `UnitPrice` value, or specifying the formatting for the `UnitPrice` text in its read-only and editing interfaces.</span></span>

<span data-ttu-id="c9913-190">Rendere modificabile GridView selezionando la casella di controllo Abilita modifica nello smart tag di GridView.</span><span class="sxs-lookup"><span data-stu-id="c9913-190">Make the GridView editable by checking the Enable Editing checkbox in the GridView s smart tag.</span></span> <span data-ttu-id="c9913-191">Selezionare anche le caselle di controllo Abilita paging e Abilita ordinamento.</span><span class="sxs-lookup"><span data-stu-id="c9913-191">Also check the Enable Paging and Enable Sorting checkboxes.</span></span>

> [!NOTE]
> <span data-ttu-id="c9913-192">È necessaria una verifica della personalizzazione dell'interfaccia di modifica di GridView?</span><span class="sxs-lookup"><span data-stu-id="c9913-192">Need a review of how to customize the GridView s editing interface?</span></span> <span data-ttu-id="c9913-193">In tal caso, fare riferimento all'esercitazione [personalizzazione dell'interfaccia di modifica dei dati](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="c9913-193">If so, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>

<span data-ttu-id="c9913-194">[![abilitare il supporto GridView per la modifica, l'ordinamento e il paging](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="c9913-194">[![Enable GridView Support for Editing, Sorting, and Paging](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span></span>

<span data-ttu-id="c9913-195">**Figura 6**: abilitare il supporto GridView per la modifica, l'ordinamento e il paging ([fare clic per visualizzare l'immagine con dimensioni complete](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="c9913-195">**Figure 6**: Enable GridView Support for Editing, Sorting, and Paging ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span></span>

<span data-ttu-id="c9913-196">Dopo avere apportato queste modifiche GridView, il markup dichiarativo GridView e ObjectDataSource dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="c9913-196">After making these GridView modifications, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](caching-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="c9913-197">Come illustrato nella figura 7, il GridView modificabile elenca il nome, la categoria e il prezzo di ogni prodotto nel database.</span><span class="sxs-lookup"><span data-stu-id="c9913-197">As Figure 7 shows, the editable GridView lists the name, category, and price of each of the products in the database.</span></span> <span data-ttu-id="c9913-198">Dedicare un po' di tempo alla verifica della funzionalità della pagina, l'ordinamento dei risultati, la relativa pagina e la modifica di un record.</span><span class="sxs-lookup"><span data-stu-id="c9913-198">Take a moment to test out the page s functionality sort the results, page through them, and edit a record.</span></span>

<span data-ttu-id="c9913-199">[![il nome, la categoria e il prezzo di ogni prodotto sono elencati in un GridView ordinabile, paginabile e modificabile](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="c9913-199">[![Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span></span>

<span data-ttu-id="c9913-200">**Figura 7**: i nomi, la categoria e il prezzo di ogni prodotto sono elencati in un GridView ordinabile, paginabile e modificabile ([fare clic per visualizzare l'immagine con dimensioni complete](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="c9913-200">**Figure 7**: Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span></span>

## <a name="step-3-examining-when-the-objectdatasource-is-requesting-data"></a><span data-ttu-id="c9913-201">Passaggio 3: analisi della richiesta di dati da parte di ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="c9913-201">Step 3: Examining When the ObjectDataSource is Requesting Data</span></span>

<span data-ttu-id="c9913-202">Il `Products` GridView recupera i dati da visualizzare richiamando il metodo `Select` del `ProductsDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c9913-202">The `Products` GridView retrieves its data to display by invoking the `Select` method of the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="c9913-203">Questo ObjectDataSource crea un'istanza della classe `ProductsBLL` del livello della logica di business e chiama il relativo metodo `GetProducts()`, che a sua volta chiama il metodo di accesso ai dati s `ProductsTableAdapter` s `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="c9913-203">This ObjectDataSource creates an instance of the Business Logic Layer s `ProductsBLL` class and calls its `GetProducts()` method, which in turn calls the Data Access Layer s `ProductsTableAdapter` s `GetProducts()` method.</span></span> <span data-ttu-id="c9913-204">Il metodo DAL si connette al database Northwind e rilascia la query `SELECT` configurata.</span><span class="sxs-lookup"><span data-stu-id="c9913-204">The DAL method connects to the Northwind database and issues the configured `SELECT` query.</span></span> <span data-ttu-id="c9913-205">Questi dati vengono quindi restituiti al DAL, che li impacchetta in una `NorthwindDataTable`.</span><span class="sxs-lookup"><span data-stu-id="c9913-205">This data is then returned to the DAL, which packages it up in a `NorthwindDataTable`.</span></span> <span data-ttu-id="c9913-206">L'oggetto DataTable viene restituito a BLL, che lo restituisce a ObjectDataSource, che lo restituisce al controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="c9913-206">The DataTable object is returned to the BLL, which returns it to the ObjectDataSource, which returns it to the GridView.</span></span> <span data-ttu-id="c9913-207">GridView crea quindi un oggetto `GridViewRow` per ogni `DataRow` nella DataTable e ogni `GridViewRow` viene sottoposto a rendering nel codice HTML che viene restituito al client e visualizzato sul browser Visitor.</span><span class="sxs-lookup"><span data-stu-id="c9913-207">The GridView then creates a `GridViewRow` object for each `DataRow` in the DataTable, and each `GridViewRow` is eventually rendered into the HTML that is returned to the client and displayed on the visitor s browser.</span></span>

<span data-ttu-id="c9913-208">Questa sequenza di eventi si verifica ogni volta che è necessario associare GridView ai dati sottostanti.</span><span class="sxs-lookup"><span data-stu-id="c9913-208">This sequence of events happens each and every time the GridView needs to bind to its underlying data.</span></span> <span data-ttu-id="c9913-209">Ciò si verifica quando la pagina viene visitata per la prima volta, quando si passa da una pagina di dati a un'altra, durante l'ordinamento di GridView o quando si modificano i dati di GridView tramite le interfacce di modifica o eliminazione predefinite.</span><span class="sxs-lookup"><span data-stu-id="c9913-209">That happens when the page is first visited, when moving from one page of data to another, when sorting the GridView, or when modifying the GridView s data through its built-in editing or deleting interfaces.</span></span> <span data-ttu-id="c9913-210">Se lo stato di visualizzazione di GridView s è disabilitato, GridView verrà riassociato anche a ogni postback.</span><span class="sxs-lookup"><span data-stu-id="c9913-210">If the GridView s view state is disabled, the GridView will be rebound on each and every postback as well.</span></span> <span data-ttu-id="c9913-211">GridView può anche essere riassociato in modo esplicito ai dati chiamando il relativo metodo `DataBind()`.</span><span class="sxs-lookup"><span data-stu-id="c9913-211">The GridView can also be explicitly rebound to its data by calling its `DataBind()` method.</span></span>

<span data-ttu-id="c9913-212">Per apprezzare appieno la frequenza con cui i dati vengono recuperati dal database, viene visualizzato un messaggio che indica quando i dati vengono recuperati nuovamente.</span><span class="sxs-lookup"><span data-stu-id="c9913-212">To fully appreciate the frequency with which the data is retrieved from the database, let s display a message indicating when the data is being re-retrieved.</span></span> <span data-ttu-id="c9913-213">Aggiungere un controllo Web Label sopra il GridView denominato `ODSEvents`.</span><span class="sxs-lookup"><span data-stu-id="c9913-213">Add a Label Web control above the GridView named `ODSEvents`.</span></span> <span data-ttu-id="c9913-214">Cancellare la proprietà `Text` e impostare la relativa proprietà `EnableViewState` su `False`.</span><span class="sxs-lookup"><span data-stu-id="c9913-214">Clear out its `Text` property and set its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="c9913-215">Sotto l'etichetta aggiungere un controllo Web Button e impostare la relativa proprietà `Text` su postback.</span><span class="sxs-lookup"><span data-stu-id="c9913-215">Underneath the Label, add a Button Web control and set its `Text` property to Postback .</span></span>

<span data-ttu-id="c9913-216">[![aggiungere un'etichetta e un pulsante alla pagina sopra GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="c9913-216">[![Add a Label and Button to the Page Above the GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span></span>

<span data-ttu-id="c9913-217">**Figura 8**: aggiungere un'etichetta e un pulsante alla pagina sopra il GridView ([fare clic per visualizzare l'immagine con dimensioni complete](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="c9913-217">**Figure 8**: Add a Label and Button to the Page Above the GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span></span>

<span data-ttu-id="c9913-218">Durante il flusso di lavoro di accesso ai dati, l'evento `Selecting` di ObjectDataSource viene generato prima della creazione dell'oggetto sottostante e della chiamata del metodo configurato.</span><span class="sxs-lookup"><span data-stu-id="c9913-218">During the data access workflow, the ObjectDataSource s `Selecting` event fires before the underlying object is created and its configured method invoked.</span></span> <span data-ttu-id="c9913-219">Creare un gestore eventi per questo evento e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="c9913-219">Create an event handler for this event and add the following code:</span></span>

[!code-vb[Main](caching-data-with-the-objectdatasource-vb/samples/sample3.vb)]

<span data-ttu-id="c9913-220">Ogni volta che ObjectDataSource effettua una richiesta all'architettura per i dati, l'etichetta visualizzerà l'evento di selezione del testo generato.</span><span class="sxs-lookup"><span data-stu-id="c9913-220">Each time the ObjectDataSource makes a request to the architecture for data, the Label will display the text Selecting event fired .</span></span>

<span data-ttu-id="c9913-221">Visitare questa pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="c9913-221">Visit this page in a browser.</span></span> <span data-ttu-id="c9913-222">Quando la pagina viene visitata per la prima volta, viene visualizzato l'evento di selezione del testo generato.</span><span class="sxs-lookup"><span data-stu-id="c9913-222">When the page is first visited, the text Selecting event fired is shown.</span></span> <span data-ttu-id="c9913-223">Fare clic sul pulsante postback e notare che il testo scompare (presupponendo che la proprietà `EnableViewState` di GridView sia impostata su `True`, ovvero l'impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="c9913-223">Click the Postback button and note that the text disappears (assuming that the GridView s `EnableViewState` property is set to `True`, the default).</span></span> <span data-ttu-id="c9913-224">Questo è dovuto al fatto che, durante il postback, GridView viene ricostruito dallo stato di visualizzazione e pertanto non viene trasformato in ObjectDataSource per i dati.</span><span class="sxs-lookup"><span data-stu-id="c9913-224">This is because, on postback, the GridView is reconstructed from its view state and therefore doesn t turn to the ObjectDataSource for its data.</span></span> <span data-ttu-id="c9913-225">L'ordinamento, il paging o la modifica dei dati, tuttavia, determina la riassociazione di GridView alla relativa origine dati e pertanto viene nuovamente visualizzato il testo generato per l'evento selezionato.</span><span class="sxs-lookup"><span data-stu-id="c9913-225">Sorting, paging, or editing the data, however, causes the GridView to rebind to its data source, and therefore the Selecting event fired text reappears.</span></span>

<span data-ttu-id="c9913-226">[![ogni volta che GridView viene riassociato alla relativa origine dati, viene visualizzata la selezione dell'evento generato](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="c9913-226">[![Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span></span>

<span data-ttu-id="c9913-227">**Figura 9**: ogni volta che GridView viene riassociato alla relativa origine dati, viene visualizzata la selezione dell'evento generato ([fare clic per visualizzare l'immagine con dimensioni complete](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="c9913-227">**Figure 9**: Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span></span>

<span data-ttu-id="c9913-228">[![facendo clic sul pulsante postback, il controllo GridView verrà ricostruito dallo stato di visualizzazione](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="c9913-228">[![Clicking the Postback Button Causes the GridView to be Reconstructed from its View State](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span></span>

<span data-ttu-id="c9913-229">**Figura 10**: se si fa clic sul pulsante postback, il controllo GridView verrà ricostruito dallo stato di visualizzazione ([fare clic per visualizzare l'immagine con dimensioni complete](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="c9913-229">**Figure 10**: Clicking the Postback Button Causes the GridView to be Reconstructed from its View State ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span></span>

<span data-ttu-id="c9913-230">Potrebbe sembrare inutile recuperare i dati del database ogni volta che i dati vengono sottoposte a paging o ordinati.</span><span class="sxs-lookup"><span data-stu-id="c9913-230">It may seem wasteful to retrieve the database data each time the data is paged through or sorted.</span></span> <span data-ttu-id="c9913-231">Dopo tutto, poiché si usa il paging predefinito, ObjectDataSource ha recuperato tutti i record durante la visualizzazione della prima pagina.</span><span class="sxs-lookup"><span data-stu-id="c9913-231">After all, since we re using default paging, the ObjectDataSource has retrieved all of the records when displaying the first page.</span></span> <span data-ttu-id="c9913-232">Anche se GridView non fornisce il supporto per l'ordinamento e il paging, è necessario recuperare i dati dal database ogni volta che la pagina viene inizialmente visitata da qualsiasi utente (e a ogni postback, se lo stato di visualizzazione è disabilitato).</span><span class="sxs-lookup"><span data-stu-id="c9913-232">Even if the GridView does not provide sorting and paging support, the data must be retrieved from the database each time the page is first visited by any user (and on every postback, if view state is disabled).</span></span> <span data-ttu-id="c9913-233">Tuttavia, se GridView Mostra gli stessi dati a tutti gli utenti, queste richieste di database aggiuntive sono superflue.</span><span class="sxs-lookup"><span data-stu-id="c9913-233">But if the GridView is showing the same data to all users, these extra database requests are superfluous.</span></span> <span data-ttu-id="c9913-234">Perché non memorizzare nella cache i risultati restituiti dal metodo `GetProducts()` e associare GridView ai risultati memorizzati nella cache?</span><span class="sxs-lookup"><span data-stu-id="c9913-234">Why not cache the results returned from the `GetProducts()` method and bind the GridView to those cached results?</span></span>

## <a name="step-4-caching-the-data-using-the-objectdatasource"></a><span data-ttu-id="c9913-235">Passaggio 4: memorizzazione dei dati nella cache tramite ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="c9913-235">Step 4: Caching the Data Using the ObjectDataSource</span></span>

<span data-ttu-id="c9913-236">Semplicemente impostando alcune proprietà, ObjectDataSource può essere configurato per memorizzare automaticamente i dati recuperati nella cache di dati ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="c9913-236">By simply setting a few properties, the ObjectDataSource can be configured to automatically cache its retrieved data in the ASP.NET data cache.</span></span> <span data-ttu-id="c9913-237">Nell'elenco seguente sono riepilogate le proprietà correlate alla cache di ObjectDataSource:</span><span class="sxs-lookup"><span data-stu-id="c9913-237">The following list summarizes the cache-related properties of the ObjectDataSource:</span></span>

- <span data-ttu-id="c9913-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) deve essere impostato su `True` per abilitare la memorizzazione nella cache.</span><span class="sxs-lookup"><span data-stu-id="c9913-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) must be set to `True` to enable caching.</span></span> <span data-ttu-id="c9913-239">Il valore predefinito è `False`.</span><span class="sxs-lookup"><span data-stu-id="c9913-239">The default is `False`.</span></span>
- <span data-ttu-id="c9913-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) : quantità di tempo, in secondi, in cui i dati vengono memorizzati nella cache.</span><span class="sxs-lookup"><span data-stu-id="c9913-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) the amount of time, in seconds, that the data is cached.</span></span> <span data-ttu-id="c9913-241">Il valore predefinito è 0.</span><span class="sxs-lookup"><span data-stu-id="c9913-241">The default is 0.</span></span> <span data-ttu-id="c9913-242">ObjectDataSource memorizza nella cache solo i dati se `EnableCaching` è `True` e `CacheDuration` è impostato su un valore maggiore di zero.</span><span class="sxs-lookup"><span data-stu-id="c9913-242">The ObjectDataSource will only cache data if `EnableCaching` is `True` and `CacheDuration` is set to a value greater than zero.</span></span>
- <span data-ttu-id="c9913-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) può essere impostato su `Absolute` o `Sliding`.</span><span class="sxs-lookup"><span data-stu-id="c9913-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) can be set to `Absolute` or `Sliding`.</span></span> <span data-ttu-id="c9913-244">Se `Absolute`, ObjectDataSource memorizza nella cache i dati recuperati per `CacheDuration` secondi; Se `Sliding`, i dati scadono solo dopo che non sono stati accessibili per `CacheDuration` secondi.</span><span class="sxs-lookup"><span data-stu-id="c9913-244">If `Absolute`, the ObjectDataSource caches its retrieved data for `CacheDuration` seconds; if `Sliding`, the data expires only after it has not been accessed for `CacheDuration` seconds.</span></span> <span data-ttu-id="c9913-245">Il valore predefinito è `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="c9913-245">The default is `Absolute`.</span></span>
- <span data-ttu-id="c9913-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) usare questa proprietà per associare le voci della cache di ObjectDataSource a una dipendenza della cache esistente.</span><span class="sxs-lookup"><span data-stu-id="c9913-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) use this property to associate the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="c9913-247">Le voci di dati di ObjectDataSource possono essere eliminate prematuramente dalla cache mediante la scadenza del `CacheKeyDependency`associato.</span><span class="sxs-lookup"><span data-stu-id="c9913-247">The ObjectDataSource s data entries can be prematurely evicted from the cache by expiring its associated `CacheKeyDependency`.</span></span> <span data-ttu-id="c9913-248">Questa proprietà viene usata più di frequente per associare una dipendenza della cache SQL alla cache di ObjectDataSource, un argomento che verrà esaminato in futuro tramite l'esercitazione sulle [dipendenze della cache SQL](using-sql-cache-dependencies-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="c9913-248">This property is most commonly used to associate a SQL cache dependency with the ObjectDataSource s cache, a topic we'll explore in the future [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="c9913-249">Consente a s di configurare il `ProductsDataSource` ObjectDataSource per memorizzare i dati nella cache per 30 secondi su una scala assoluta.</span><span class="sxs-lookup"><span data-stu-id="c9913-249">Let s configure the `ProductsDataSource` ObjectDataSource to cache its data for 30 seconds on an absolute scale.</span></span> <span data-ttu-id="c9913-250">Impostare la proprietà `EnableCaching` di ObjectDataSource su `True` e la relativa proprietà `CacheDuration` su 30.</span><span class="sxs-lookup"><span data-stu-id="c9913-250">Set the ObjectDataSource s `EnableCaching` property to `True` and its `CacheDuration` property to 30.</span></span> <span data-ttu-id="c9913-251">Lasciare la proprietà `CacheExpirationPolicy` impostata sul valore predefinito, `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="c9913-251">Leave the `CacheExpirationPolicy` property set to its default, `Absolute`.</span></span>

<span data-ttu-id="c9913-252">[![configurare ObjectDataSource per memorizzare i dati nella cache per 30 secondi](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="c9913-252">[![Configure the ObjectDataSource to Cache its Data for 30 Seconds](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span></span>

<span data-ttu-id="c9913-253">**Figura 11**: configurare ObjectDataSource per memorizzare i dati nella cache per 30 secondi ([fare clic per visualizzare l'immagine con dimensioni complete](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="c9913-253">**Figure 11**: Configure the ObjectDataSource to Cache its Data for 30 Seconds ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span></span>

<span data-ttu-id="c9913-254">Salvare le modifiche e rivedere questa pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="c9913-254">Save your changes and revisit this page in a browser.</span></span> <span data-ttu-id="c9913-255">La selezione del testo generato dall'evento verrà visualizzata quando si visita la prima pagina, come inizialmente i dati non sono nella cache.</span><span class="sxs-lookup"><span data-stu-id="c9913-255">The Selecting event fired text will appear when you first visit the page, as initially the data is not in the cache.</span></span> <span data-ttu-id="c9913-256">Tuttavia, i postback successivi attivati facendo clic sul pulsante postback, l'ordinamento, il paging o facendo clic sui pulsanti modifica o Annulla *non* rivisualizzano il testo generato dall'evento selezionato.</span><span class="sxs-lookup"><span data-stu-id="c9913-256">But subsequent postbacks triggered by clicking the Postback button, sorting, paging, or clicking the Edit or Cancel buttons does *not* redisplay the Selecting event fired text.</span></span> <span data-ttu-id="c9913-257">Questo è dovuto al fatto che l'evento `Selecting` viene attivato solo quando ObjectDataSource recupera i dati dall'oggetto sottostante; l'evento `Selecting` non viene attivato se i dati vengono estratti dalla cache dei dati.</span><span class="sxs-lookup"><span data-stu-id="c9913-257">This is because the `Selecting` event only fires when the ObjectDataSource gets its data from its underlying object; the `Selecting` event does not fire if the data is pulled from the data cache.</span></span>

<span data-ttu-id="c9913-258">Dopo 30 secondi, i dati verranno rimossi dalla cache.</span><span class="sxs-lookup"><span data-stu-id="c9913-258">After 30 seconds, the data will be evicted from the cache.</span></span> <span data-ttu-id="c9913-259">I dati verranno rimossi dalla cache anche se vengono richiamati i metodi ObjectDataSource s `Insert`, `Update`o `Delete`.</span><span class="sxs-lookup"><span data-stu-id="c9913-259">The data will also be evicted from the cache if the ObjectDataSource s `Insert`, `Update`, or `Delete` methods are invoked.</span></span> <span data-ttu-id="c9913-260">Di conseguenza, dopo 30 secondi trascorsi o se è stato fatto clic sul pulsante Aggiorna, ordinando, paging o facendo clic sui pulsanti modifica o Annulla, ObjectDataSource otterrà i dati dall'oggetto sottostante, visualizzando il testo generato dall'evento quando viene generato l'evento `Selecting`.</span><span class="sxs-lookup"><span data-stu-id="c9913-260">Consequently, after 30 seconds have passed or the Update button has been clicked, sorting, paging, or clicking the Edit or Cancel buttons will cause the ObjectDataSource to get its data from its underlying object, displaying the Selecting event fired text when the `Selecting` event fires.</span></span> <span data-ttu-id="c9913-261">Questi risultati restituiti vengono inseriti nuovamente nella cache dei dati.</span><span class="sxs-lookup"><span data-stu-id="c9913-261">These returned results are placed back into the data cache.</span></span>

> [!NOTE]
> <span data-ttu-id="c9913-262">Se viene visualizzato spesso il testo selezionato per l'evento, anche quando si prevede che ObjectDataSource funzioni con i dati memorizzati nella cache, è possibile che si verifichino vincoli di memoria.</span><span class="sxs-lookup"><span data-stu-id="c9913-262">If you see the Selecting event fired text frequently, even when you expect the ObjectDataSource to be working with cached data, it may be due to memory constraints.</span></span> <span data-ttu-id="c9913-263">Se la memoria disponibile non è sufficiente, i dati aggiunti alla cache da ObjectDataSource potrebbero essere stati eliminati.</span><span class="sxs-lookup"><span data-stu-id="c9913-263">If there is not enough free memory, the data added to the cache by the ObjectDataSource may have been scavenged.</span></span> <span data-ttu-id="c9913-264">Se ObjectDataSource doesn t sembra che i dati vengano memorizzati correttamente nella cache o solo sporadicamente, chiudere alcune applicazioni per liberare memoria e riprovare.</span><span class="sxs-lookup"><span data-stu-id="c9913-264">If the ObjectDataSource doesn t appear to be correctly caching the data or only caches the data sporadically, close some applications to free memory and try again.</span></span>

<span data-ttu-id="c9913-265">Nella figura 12 viene illustrato il flusso di lavoro di memorizzazione nella cache di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c9913-265">Figure 12 illustrates the ObjectDataSource s caching workflow.</span></span> <span data-ttu-id="c9913-266">Quando viene visualizzato il testo generato dall'evento selezionato sullo schermo, questo è dovuto al fatto che i dati non sono presenti nella cache ed è stato necessario recuperarli dall'oggetto sottostante.</span><span class="sxs-lookup"><span data-stu-id="c9913-266">When the Selecting event fired text appears on your screen, it is because the data was not in the cache and had to be retrieved from the underlying object.</span></span> <span data-ttu-id="c9913-267">Quando questo testo risulta mancante, tuttavia, è perché i dati sono disponibili dalla cache.</span><span class="sxs-lookup"><span data-stu-id="c9913-267">When this text is missing, however, it s because the data was available from the cache.</span></span> <span data-ttu-id="c9913-268">Quando i dati vengono restituiti dalla cache, non viene eseguita alcuna chiamata all'oggetto sottostante e pertanto non è stata eseguita alcuna query sul database.</span><span class="sxs-lookup"><span data-stu-id="c9913-268">When the data is returned from the cache there s no call to the underlying object and, therefore, no database query executed.</span></span>

![ObjectDataSource archivia e recupera i dati dalla cache dei dati](caching-data-with-the-objectdatasource-vb/_static/image30.png)

<span data-ttu-id="c9913-270">**Figura 12**: ObjectDataSource archivia e recupera i dati dalla cache dei dati</span><span class="sxs-lookup"><span data-stu-id="c9913-270">**Figure 12**: The ObjectDataSource Stores and Retrieves its Data from the Data Cache</span></span>

<span data-ttu-id="c9913-271">Ogni applicazione ASP.NET dispone di un'istanza della cache dei dati condivisa tra tutte le pagine e i visitatori.</span><span class="sxs-lookup"><span data-stu-id="c9913-271">Each ASP.NET application has its own data cache instance that s shared across all pages and visitors.</span></span> <span data-ttu-id="c9913-272">Ciò significa che i dati archiviati nella cache di dati da ObjectDataSource sono condivisi in modo analogo tra tutti gli utenti che visitano la pagina.</span><span class="sxs-lookup"><span data-stu-id="c9913-272">That means that the data stored in the data cache by the ObjectDataSource is likewise shared across all users who visit the page.</span></span> <span data-ttu-id="c9913-273">Per verificarlo, aprire la pagina `ObjectDataSource.aspx` in un browser.</span><span class="sxs-lookup"><span data-stu-id="c9913-273">To verify this, open the `ObjectDataSource.aspx` page in a browser.</span></span> <span data-ttu-id="c9913-274">Quando si visita la pagina per la prima volta, viene visualizzato il testo di selezione evento generato (presupponendo che i dati aggiunti alla cache dai test precedenti siano stati rimossi).</span><span class="sxs-lookup"><span data-stu-id="c9913-274">When first visiting the page, the Selecting event fired text will appear (assuming that the data added to the cache by previous tests has, by now, been evicted).</span></span> <span data-ttu-id="c9913-275">Aprire una seconda istanza del browser e copiare e incollare l'URL dalla prima istanza del browser al secondo.</span><span class="sxs-lookup"><span data-stu-id="c9913-275">Open a second browser instance and copy and paste the URL from the first browser instance to the second.</span></span> <span data-ttu-id="c9913-276">Nella seconda istanza del browser, il testo generato per l'evento selezionato non viene visualizzato perché usa gli stessi dati memorizzati nella cache del primo.</span><span class="sxs-lookup"><span data-stu-id="c9913-276">In the second browser instance, the Selecting event fired text is not shown because it s using the same cached data as the first.</span></span>

<span data-ttu-id="c9913-277">Quando si inseriscono i dati recuperati nella cache, ObjectDataSource utilizza un valore della chiave della cache che include: i valori di `CacheDuration` e `CacheExpirationPolicy` proprietà; tipo dell'oggetto business sottostante utilizzato da ObjectDataSource, specificato tramite la [proprietà`TypeName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in questo esempio). il valore della proprietà `SelectMethod` e il nome e i valori dei parametri nella raccolta `SelectParameters`; e i valori delle proprietà `StartRowIndex` e `MaximumRows`, che vengono usate quando si implementa il [paging personalizzato](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span><span class="sxs-lookup"><span data-stu-id="c9913-277">When inserting its retrieved data into the cache, the ObjectDataSource uses a cache key value that includes: the `CacheDuration` and `CacheExpirationPolicy` property values; the type of the underlying business object being used by the ObjectDataSource, which is specified via the [`TypeName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in this example); the value of the `SelectMethod` property and the name and values of the parameters in the `SelectParameters` collection; and the values of its `StartRowIndex` and `MaximumRows` properties, which are used when implementing [custom paging](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span></span>

<span data-ttu-id="c9913-278">La creazione del valore della chiave di cache come una combinazione di queste proprietà garantisce una voce della cache univoca in quanto questi valori cambiano.</span><span class="sxs-lookup"><span data-stu-id="c9913-278">Crafting the cache key value as a combination of these properties ensures a unique cache entry as these values change.</span></span> <span data-ttu-id="c9913-279">Ad esempio, nelle esercitazioni precedenti è stato esaminato l'utilizzo della classe `ProductsBLL` s `GetProductsByCategoryID(categoryID)`, che restituisce tutti i prodotti per una categoria specificata.</span><span class="sxs-lookup"><span data-stu-id="c9913-279">For example, in past tutorials we ve looked at using the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)`, which returns all products for a specified category.</span></span> <span data-ttu-id="c9913-280">Un utente può passare alla pagina e visualizzare le bevande, che hanno un `CategoryID` di 1.</span><span class="sxs-lookup"><span data-stu-id="c9913-280">One user might come to the page and view beverages, which has a `CategoryID` of 1.</span></span> <span data-ttu-id="c9913-281">Se ObjectDataSource ha memorizzato nella cache i risultati senza considerare i valori di `SelectParameters`, quando un altro utente si trovava nella pagina per visualizzare i condimenti mentre i prodotti Beverage erano nella cache, i prodotti della bevanda memorizzati nella cache invece dei condimenti.</span><span class="sxs-lookup"><span data-stu-id="c9913-281">If the ObjectDataSource cached its results without regard for the `SelectParameters` values, when another user came to the page to view condiments while the beverages products were in the cache, they d see the cached beverage products rather than condiments.</span></span> <span data-ttu-id="c9913-282">Variando la chiave di cache con queste proprietà, che includono i valori della `SelectParameters`, ObjectDataSource mantiene una voce della cache separata per bevande e condimenti.</span><span class="sxs-lookup"><span data-stu-id="c9913-282">By varying the cache key by these properties, which include the values of the `SelectParameters`, the ObjectDataSource maintains a separate cache entry for beverages and condiments.</span></span>

## <a name="stale-data-concerns"></a><span data-ttu-id="c9913-283">Problemi relativi ai dati non aggiornati</span><span class="sxs-lookup"><span data-stu-id="c9913-283">Stale Data Concerns</span></span>

<span data-ttu-id="c9913-284">ObjectDataSource rimuove automaticamente gli elementi dalla cache quando viene richiamato uno dei metodi `Insert`, `Update`o `Delete`.</span><span class="sxs-lookup"><span data-stu-id="c9913-284">The ObjectDataSource automatically evicts its items from the cache when any one of its `Insert`, `Update`, or `Delete` methods is invoked.</span></span> <span data-ttu-id="c9913-285">Ciò consente di proteggere i dati non aggiornati cancellando le voci della cache quando i dati vengono modificati nella pagina.</span><span class="sxs-lookup"><span data-stu-id="c9913-285">This helps protect against stale data by clearing out the cache entries when the data is modified through the page.</span></span> <span data-ttu-id="c9913-286">Tuttavia, è possibile che ObjectDataSource usi la memorizzazione nella cache per visualizzare comunque i dati non aggiornati.</span><span class="sxs-lookup"><span data-stu-id="c9913-286">However, it is possible for an ObjectDataSource using caching to still display stale data.</span></span> <span data-ttu-id="c9913-287">Nel caso più semplice, può essere dovuto alla modifica dei dati direttamente all'interno del database.</span><span class="sxs-lookup"><span data-stu-id="c9913-287">In the simplest case, it can be due to the data changing directly within the database.</span></span> <span data-ttu-id="c9913-288">Forse un amministratore di database ha appena eseguito uno script che modifica alcuni record del database.</span><span class="sxs-lookup"><span data-stu-id="c9913-288">Perhaps a database administrator just ran a script that modifies some of the records in the database.</span></span>

<span data-ttu-id="c9913-289">Questo scenario può anche essere rivelato in modo più delicato.</span><span class="sxs-lookup"><span data-stu-id="c9913-289">This scenario could also unfold in a more subtle way.</span></span> <span data-ttu-id="c9913-290">Mentre ObjectDataSource rimuove gli elementi dalla cache quando viene chiamato uno dei metodi di modifica dei dati, gli elementi memorizzati nella cache vengono rimossi per la combinazione specifica di ObjectDataSource dei valori delle proprietà (`CacheDuration`, `TypeName`, `SelectMethod`e così via).</span><span class="sxs-lookup"><span data-stu-id="c9913-290">While the ObjectDataSource evicts its items from the cache when one of its data modification methods is called, the cached items removed are for the ObjectDataSource s particular combination of property values (`CacheDuration`, `TypeName`, `SelectMethod`, and so on).</span></span> <span data-ttu-id="c9913-291">Se si dispone di due ObjectDataSource che utilizzano `SelectMethods` o `SelectParameters`diversi, ma possono comunque aggiornare gli stessi dati, un ObjectDataSource può aggiornare una riga e invalidare le voci della cache, ma la riga corrispondente per il secondo ObjectDataSource verrà comunque gestita dalla cache.</span><span class="sxs-lookup"><span data-stu-id="c9913-291">If you have two ObjectDataSources that use different `SelectMethods` or `SelectParameters`, but still can update the same data, then one ObjectDataSource may update a row and invalidate its own cache entries, but the corresponding row for the second ObjectDataSource will still be served from the cached.</span></span> <span data-ttu-id="c9913-292">Si consiglia di creare pagine per presentare queste funzionalità.</span><span class="sxs-lookup"><span data-stu-id="c9913-292">I encourage you to create pages to exhibit this functionality.</span></span> <span data-ttu-id="c9913-293">Creare una pagina che visualizza un controllo GridView modificabile che estrae i dati da un ObjectDataSource che usa la memorizzazione nella cache ed è configurato per ottenere i dati dal metodo `GetProducts()` della classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="c9913-293">Create a page that displays an editable GridView that pulls its data from an ObjectDataSource that uses caching and is configured to get data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="c9913-294">Aggiungere un altro controllo GridView e ObjectDataSource modificabile a questa pagina (o un altro), ma per questo secondo ObjectDataSource usare il metodo `GetProductsByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="c9913-294">Add another editable GridView and ObjectDataSource to this page (or another one), but for this second ObjectDataSource have it use the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="c9913-295">Poiché i due elementi ObjectDataSource `SelectMethod` proprietà sono diversi, ognuno ha i propri valori memorizzati nella cache.</span><span class="sxs-lookup"><span data-stu-id="c9913-295">Since the two ObjectDataSources `SelectMethod` properties differ, they ll each have their own cached values.</span></span> <span data-ttu-id="c9913-296">Se si modifica un prodotto in una griglia, la volta successiva che si riassociano i dati all'altra griglia (mediante paging, ordinamento e così via), i dati memorizzati nella cache obsoleti e non riflettono le modifiche apportate dall'altra griglia.</span><span class="sxs-lookup"><span data-stu-id="c9913-296">If you edit a product in one grid, the next time you bind the data back to the other grid (by paging, sorting, and so forth), it will still serve the old, cached data and not reflect the change that was made from the other grid.</span></span>

<span data-ttu-id="c9913-297">In breve, utilizzare solo scadenze basate sul tempo se si è disposti ad avere il potenziale di dati non aggiornati e si utilizzano scadenze più brevi per gli scenari in cui l'aggiornamento dei dati è importante.</span><span class="sxs-lookup"><span data-stu-id="c9913-297">In short, only use time-based expiries if you are willing to have the potential of stale data, and use shorter expiries for scenarios where the freshness of data is important.</span></span> <span data-ttu-id="c9913-298">Se i dati non aggiornati non sono accettabili, è possibile evitare la memorizzazione nella cache o usare le dipendenze della cache SQL (presupponendo che si tratta di dati del database di cui si sta</span><span class="sxs-lookup"><span data-stu-id="c9913-298">If stale data is not acceptable, either forgo caching or use SQL cache dependencies (assuming it is database data you re caching).</span></span> <span data-ttu-id="c9913-299">Si esamineranno le dipendenze della cache SQL in un'esercitazione futura.</span><span class="sxs-lookup"><span data-stu-id="c9913-299">We'll explore SQL cache dependencies in a future tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="c9913-300">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="c9913-300">Summary</span></span>

<span data-ttu-id="c9913-301">In questa esercitazione sono state esaminate le funzionalità di memorizzazione nella cache predefinite di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c9913-301">In this tutorial we examined the ObjectDataSource s built-in caching capabilities.</span></span> <span data-ttu-id="c9913-302">Semplicemente impostando alcune proprietà, è possibile indicare a ObjectDataSource di memorizzare nella cache dati ASP.NET i risultati restituiti dal `SelectMethod` specificato.</span><span class="sxs-lookup"><span data-stu-id="c9913-302">By simply setting a few properties, we can instruct the ObjectDataSource to cache the results returned from the specified `SelectMethod` into the ASP.NET data cache.</span></span> <span data-ttu-id="c9913-303">Le proprietà `CacheDuration` e `CacheExpirationPolicy` indicano la durata dell'elemento memorizzato nella cache e se si tratta di una scadenza assoluta o variabile.</span><span class="sxs-lookup"><span data-stu-id="c9913-303">The `CacheDuration` and `CacheExpirationPolicy` properties indicate the duration the item is cached and whether it is an absolute or sliding expiration.</span></span> <span data-ttu-id="c9913-304">La proprietà `CacheKeyDependency` associa tutte le voci della cache di ObjectDataSource con una dipendenza della cache esistente.</span><span class="sxs-lookup"><span data-stu-id="c9913-304">The `CacheKeyDependency` property associates all of the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="c9913-305">Questa operazione può essere utilizzata per rimuovere le voci di ObjectDataSource dalla cache prima che venga raggiunta la scadenza basata sul tempo e viene in genere utilizzata con le dipendenze della cache SQL.</span><span class="sxs-lookup"><span data-stu-id="c9913-305">This can be used to evict the ObjectDataSource s entries from the cache before the time-based expiration is reached, and is typically used with SQL cache dependencies.</span></span>

<span data-ttu-id="c9913-306">Poiché ObjectDataSource memorizza semplicemente i valori nella cache dei dati, è possibile replicare la funzionalità incorporata di ObjectDataSource in modo programmatico.</span><span class="sxs-lookup"><span data-stu-id="c9913-306">Since the ObjectDataSource simply caches its values to the data cache, we could replicate the ObjectDataSource s built-in functionality programmatically.</span></span> <span data-ttu-id="c9913-307">Non ha senso eseguire questa operazione a livello di presentazione, poiché ObjectDataSource offre questa funzionalità predefinita, ma è possibile implementare le funzionalità di memorizzazione nella cache in un livello separato dell'architettura.</span><span class="sxs-lookup"><span data-stu-id="c9913-307">It doesn t make sense to do this at the Presentation Layer, since the ObjectDataSource offers this functionality out of the box, but we can implement caching capabilities in a separate layer of the architecture.</span></span> <span data-ttu-id="c9913-308">A tale scopo, è necessario ripetere la stessa logica usata da ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c9913-308">To do so, we'll need to repeat the same logic used by the ObjectDataSource.</span></span> <span data-ttu-id="c9913-309">Nell'esercitazione successiva verrà illustrato come usare la cache di dati a livello di codice all'interno dell'architettura.</span><span class="sxs-lookup"><span data-stu-id="c9913-309">We'll explore how to programmatically work with the data cache from within the architecture in our next tutorial.</span></span>

<span data-ttu-id="c9913-310">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="c9913-310">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="c9913-311">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="c9913-311">Further Reading</span></span>

<span data-ttu-id="c9913-312">Per ulteriori informazioni sugli argomenti trattati in questa esercitazione, fare riferimento alle risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="c9913-312">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="c9913-313">Caching ASP.NET: tecniche e procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="c9913-313">ASP.NET Caching: Techniques and Best Practices</span></span>](https://msdn.microsoft.com/library/aa478965.aspx)
- [<span data-ttu-id="c9913-314">Guida all'architettura di caching per applicazioni .NET Framework</span><span class="sxs-lookup"><span data-stu-id="c9913-314">Caching Architecture Guide for .NET Framework Applications</span></span>](https://msdn.microsoft.com/library/ee817645.aspx)
- [<span data-ttu-id="c9913-315">Caching di output in ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="c9913-315">Output Caching in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="c9913-316">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="c9913-316">About the Author</span></span>

<span data-ttu-id="c9913-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="c9913-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c9913-318">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="c9913-318">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c9913-319">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="c9913-319">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c9913-320">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c9913-320">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c9913-321">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="c9913-321">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c9913-322">Grazie speciale</span><span class="sxs-lookup"><span data-stu-id="c9913-322">Special Thanks To</span></span>

<span data-ttu-id="c9913-323">Questa serie di esercitazioni è stata esaminata da molti revisori utili.</span><span class="sxs-lookup"><span data-stu-id="c9913-323">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c9913-324">Il revisore principale di questa esercitazione era Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="c9913-324">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="c9913-325">Sei interessato a esaminare i miei prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="c9913-325">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c9913-326">In tal caso, rilasciare una riga in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c9913-326">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c9913-327">[Precedente](using-sql-cache-dependencies-cs.md)
> [Successivo](caching-data-in-the-architecture-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c9913-327">[Previous](using-sql-cache-dependencies-cs.md)
[Next](caching-data-in-the-architecture-vb.md)</span></span>
