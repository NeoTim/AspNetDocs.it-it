---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-cs
title: Inserimento, aggiornamento ed eliminazione di dati con SqlDataSource (C#) | Microsoft Docs
author: rick-anderson
description: Nelle esercitazioni precedenti è stato illustrato il modo in cui il controllo ObjectDataSource consentiva di inserire, aggiornare ed eliminare dati. Il controllo SqlDataSource supporta t...
ms.author: riande
ms.date: 02/20/2007
ms.assetid: a526f0ec-779e-4a2b-a476-6604090d25ce
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-cs
msc.type: authoredcontent
ms.openlocfilehash: 495e0e81a67e6926e1c4fa92e29ebbda747cd418
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/28/2019
ms.locfileid: "74610458"
---
# <a name="inserting-updating-and-deleting-data-with-the-sqldatasource-c"></a><span data-ttu-id="826d2-104">Inserimento, aggiornamento ed eliminazione dei dati con SqlDataSource (C#)</span><span class="sxs-lookup"><span data-stu-id="826d2-104">Inserting, Updating, and Deleting Data with the SqlDataSource (C#)</span></span>

<span data-ttu-id="826d2-105">di [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="826d2-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="826d2-106">[Scaricare l'app di esempio](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_CS.exe) o [scaricare il file PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/datatutorial49cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="826d2-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_CS.exe) or [Download PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/datatutorial49cs1.pdf)</span></span>

> <span data-ttu-id="826d2-107">Nelle esercitazioni precedenti è stato illustrato il modo in cui il controllo ObjectDataSource consentiva di inserire, aggiornare ed eliminare dati.</span><span class="sxs-lookup"><span data-stu-id="826d2-107">In previous tutorials we learned how the ObjectDataSource control allowed for inserting, updating, and deleting of data.</span></span> <span data-ttu-id="826d2-108">Il controllo SqlDataSource supporta le stesse operazioni, ma l'approccio è diverso e in questa esercitazione viene illustrato come configurare SqlDataSource per inserire, aggiornare ed eliminare i dati.</span><span class="sxs-lookup"><span data-stu-id="826d2-108">The SqlDataSource control supports the same operations, but the approach is different, and this tutorial shows how to configure the SqlDataSource to insert, update, and delete data.</span></span>

## <a name="introduction"></a><span data-ttu-id="826d2-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="826d2-109">Introduction</span></span>

<span data-ttu-id="826d2-110">Come descritto in [una panoramica di inserimento, aggiornamento ed eliminazione](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md), il controllo GridView fornisce funzionalità predefinite di aggiornamento ed eliminazione, mentre i controlli DetailsView e FormView includono il supporto per l'inserimento e la modifica e l'eliminazione delle funzionalità.</span><span class="sxs-lookup"><span data-stu-id="826d2-110">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md), the GridView control provides built-in updating and deleting capabilities, while the DetailsView and FormView controls include inserting support along with editing and deleting functionality.</span></span> <span data-ttu-id="826d2-111">Queste funzionalità di modifica dei dati possono essere inserite direttamente in un controllo origine dati senza che sia necessario scrivere una riga di codice.</span><span class="sxs-lookup"><span data-stu-id="826d2-111">These data modification capabilities can be plugged directly into a data source control without a line of code needing to be written.</span></span> <span data-ttu-id="826d2-112">[Panoramica dell'inserimento, dell'aggiornamento e dell'eliminazione](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) esaminati tramite ObjectDataSource per facilitare l'inserimento, l'aggiornamento e l'eliminazione con i controlli GridView, DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="826d2-112">[An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) examined using the ObjectDataSource to facilitate inserting, updating, and deleting with the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="826d2-113">In alternativa, è possibile utilizzare SqlDataSource al posto di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="826d2-113">Alternatively, the SqlDataSource can be used in place of the ObjectDataSource.</span></span>

<span data-ttu-id="826d2-114">Tenere presente che per supportare l'inserimento, l'aggiornamento e l'eliminazione, con ObjectDataSource è necessario specificare i metodi a livello di oggetto da richiamare per eseguire l'azione di inserimento, aggiornamento o eliminazione.</span><span class="sxs-lookup"><span data-stu-id="826d2-114">Recall that to support inserting, updating, and deleting, with the ObjectDataSource we needed to specify the object layer methods to invoke to perform the insert, update, or delete action.</span></span> <span data-ttu-id="826d2-115">Con il SqlDataSource è necessario fornire `INSERT`, `UPDATE`e `DELETE` istruzioni SQL (o stored procedure) da eseguire.</span><span class="sxs-lookup"><span data-stu-id="826d2-115">With the SqlDataSource, we need to provide `INSERT`, `UPDATE`, and `DELETE` SQL statements (or stored procedures) to execute.</span></span> <span data-ttu-id="826d2-116">Come si vedrà in questa esercitazione, queste istruzioni possono essere create manualmente oppure possono essere generate automaticamente dalla configurazione guidata origine dati di SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="826d2-116">As we'll see in this tutorial, these statements can be created manually or can be automatically generated by the SqlDataSource s Configure Data Source wizard.</span></span>

> [!NOTE]
> <span data-ttu-id="826d2-117">Poiché sono già state illustrate le funzionalità di inserimento, modifica ed eliminazione dei controlli GridView, DetailsView e FormView, questa esercitazione si concentrerà sulla configurazione del controllo SqlDataSource per supportare queste operazioni.</span><span class="sxs-lookup"><span data-stu-id="826d2-117">Since we ve already discussed the inserting, editing, and deleting capabilities of the GridView, DetailsView, and FormView controls, this tutorial will focus on configuring the SqlDataSource control to support these operations.</span></span> <span data-ttu-id="826d2-118">Se è necessario eseguire il pennello sull'implementazione di queste funzionalità all'interno di GridView, DetailsView e FormView, tornare alle esercitazioni relative a modifica, inserimento ed eliminazione dei dati, a partire da [una panoramica dell'inserimento, dell'aggiornamento e dell'eliminazione](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md).</span><span class="sxs-lookup"><span data-stu-id="826d2-118">If you need to brush up on implementing these features within the GridView, DetailsView, and FormView, return to the Editing, Inserting, and Deleting Data tutorials, starting with [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md).</span></span>

## <a name="step-1-specifyinginsertupdate-anddeletestatements"></a><span data-ttu-id="826d2-119">Passaggio 1: specifica di istruzioni`INSERT`,`UPDATE`e`DELETE`</span><span class="sxs-lookup"><span data-stu-id="826d2-119">Step 1: Specifying`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="826d2-120">Come illustrato nelle ultime due esercitazioni, per recuperare i dati da un controllo SqlDataSource è necessario impostare due proprietà:</span><span class="sxs-lookup"><span data-stu-id="826d2-120">As we ve seen in the past two tutorials, to retrieve data from a SqlDataSource control we need to set two properties:</span></span>

1. <span data-ttu-id="826d2-121">`ConnectionString`, che specifica il database a cui inviare la query e</span><span class="sxs-lookup"><span data-stu-id="826d2-121">`ConnectionString`, which specifies what database to send the query to, and</span></span>
2. <span data-ttu-id="826d2-122">`SelectCommand`, che specifica l'istruzione SQL ad hoc o il nome stored procedure da eseguire per restituire i risultati.</span><span class="sxs-lookup"><span data-stu-id="826d2-122">`SelectCommand`, which specifies the ad-hoc SQL statement or stored procedure name to execute to return the results.</span></span>

<span data-ttu-id="826d2-123">Per `SelectCommand` valori con parametri, i valori dei parametri vengono specificati tramite la raccolta di `SelectParameters` SqlDataSource e possono includere valori hardcoded, valori di origine di parametri comuni (campi QueryString, variabili di sessione, valori di controlli Web e così via) oppure possono essere assegnati a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="826d2-123">For `SelectCommand` values with parameters, the parameter values are specified via the SqlDataSource s `SelectParameters` collection and can include hard-coded values, common parameter source values (querystring fields, session variables, Web control values, and so on), or can be programmatically assigned.</span></span> <span data-ttu-id="826d2-124">Quando il controllo SqlDataSource s `Select()` metodo viene richiamato a livello di codice o automaticamente da un controllo Web dati, viene stabilita una connessione al database, i valori dei parametri vengono assegnati alla query e il comando viene collegato al database.</span><span class="sxs-lookup"><span data-stu-id="826d2-124">When the SqlDataSource control s `Select()` method is invoked either programmatically or automatically from a data Web control a connection to the database is established, the parameter values are assigned to the query, and the command is shuttled off to the database.</span></span> <span data-ttu-id="826d2-125">I risultati vengono quindi restituiti come DataSet o DataReader, a seconda del valore della proprietà `DataSourceMode` del controllo.</span><span class="sxs-lookup"><span data-stu-id="826d2-125">The results are then returned as either a DataSet or DataReader, depending on the value of the control s `DataSourceMode` property.</span></span>

<span data-ttu-id="826d2-126">Insieme alla selezione dei dati, è possibile utilizzare il controllo SqlDataSource per inserire, aggiornare ed eliminare dati fornendo `INSERT`, `UPDATE`e `DELETE` istruzioni SQL nello stesso modo.</span><span class="sxs-lookup"><span data-stu-id="826d2-126">Along with selecting data, the SqlDataSource control can be used to insert, update, and delete data by supplying `INSERT`, `UPDATE`, and `DELETE` SQL statements in much the same way.</span></span> <span data-ttu-id="826d2-127">È sufficiente assegnare le proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand` le istruzioni SQL `INSERT`, `UPDATE`e `DELETE` da eseguire.</span><span class="sxs-lookup"><span data-stu-id="826d2-127">Simply assign the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties the `INSERT`, `UPDATE`, and `DELETE` SQL statements to execute.</span></span> <span data-ttu-id="826d2-128">Se le istruzioni hanno parametri (come sempre), includerle nelle raccolte `InsertParameters`, `UpdateParameters`e `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="826d2-128">If the statements have parameters (as they most always will), include them in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="826d2-129">Dopo che è stato specificato un valore `InsertCommand`, `UpdateCommand`o `DeleteCommand`, l'opzione Abilita inserimento, Abilita modifica o Abilita eliminazione nello smart tag del controllo Web dei dati corrispondente diventerà disponibile.</span><span class="sxs-lookup"><span data-stu-id="826d2-129">Once an `InsertCommand`, `UpdateCommand`, or `DeleteCommand` value has been specified, the Enable Inserting, Enable Editing, or Enable Deleting option in the corresponding data Web control s smart tag will become available.</span></span> <span data-ttu-id="826d2-130">Per illustrare questo problema, è possibile prendere un esempio dalla pagina `Querying.aspx` creata nell'esercitazione sull' [esecuzione di query sui dati con il controllo SqlDataSource](querying-data-with-the-sqldatasource-control-cs.md) e potenziarla per includere le funzionalità di eliminazione.</span><span class="sxs-lookup"><span data-stu-id="826d2-130">To illustrate this, let s take an example from the `Querying.aspx` page we created in the [Querying Data with the SqlDataSource Control](querying-data-with-the-sqldatasource-control-cs.md) tutorial and augment it to include delete capabilities.</span></span>

<span data-ttu-id="826d2-131">Per iniziare, aprire il `InsertUpdateDelete.aspx` e `Querying.aspx` pagine dalla cartella `SqlDataSource`.</span><span class="sxs-lookup"><span data-stu-id="826d2-131">Start by opening the `InsertUpdateDelete.aspx` and `Querying.aspx` pages from the `SqlDataSource` folder.</span></span> <span data-ttu-id="826d2-132">Nella pagina `Querying.aspx` della finestra di progettazione selezionare SqlDataSource e GridView dal primo esempio (controlli `ProductsDataSource` e `GridView1`).</span><span class="sxs-lookup"><span data-stu-id="826d2-132">From the Designer on the `Querying.aspx` page, select the SqlDataSource and GridView from the first example (the `ProductsDataSource` and `GridView1` controls).</span></span> <span data-ttu-id="826d2-133">Dopo aver selezionato i due controlli, scegliere Copia dal menu modifica oppure premere CTRL + C.</span><span class="sxs-lookup"><span data-stu-id="826d2-133">After selecting the two controls, go to the Edit menu and choose Copy (or just hit Ctrl+C).</span></span> <span data-ttu-id="826d2-134">Passare quindi alla finestra di progettazione di `InsertUpdateDelete.aspx` e incollare i controlli.</span><span class="sxs-lookup"><span data-stu-id="826d2-134">Next, go to the Designer of `InsertUpdateDelete.aspx` and paste in the controls.</span></span> <span data-ttu-id="826d2-135">Dopo aver spostato i due controlli su `InsertUpdateDelete.aspx`, testare la pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="826d2-135">After you have moved the two controls over to `InsertUpdateDelete.aspx`, test out the page in a browser.</span></span> <span data-ttu-id="826d2-136">Verranno visualizzati i valori delle colonne `ProductID`, `ProductName`e `UnitPrice` per tutti i record nella tabella di database `Products`.</span><span class="sxs-lookup"><span data-stu-id="826d2-136">You should see the values of the `ProductID`, `ProductName`, and `UnitPrice` columns for all of the records in the `Products` database table.</span></span>

<span data-ttu-id="826d2-137">[![tutti i prodotti sono elencati, ordinati in base a ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="826d2-137">[![All of the Products are Listed, Ordered by ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.png)</span></span>

<span data-ttu-id="826d2-138">**Figura 1**: tutti i prodotti sono elencati, ordinati per `ProductID` ([fare clic per visualizzare l'immagine con dimensioni complete](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="826d2-138">**Figure 1**: All of the Products are Listed, Ordered by `ProductID` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image2.png))</span></span>

## <a name="adding-the-sqldatasource-sdeletecommandanddeleteparametersproperties"></a><span data-ttu-id="826d2-139">Aggiunta delle proprietà`DeleteCommand`e`DeleteParameters`di SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="826d2-139">Adding the SqlDataSource s`DeleteCommand`and`DeleteParameters`Properties</span></span>

<span data-ttu-id="826d2-140">A questo punto è presente un SqlDataSource che restituisce semplicemente tutti i record della tabella `Products` e GridView che esegue il rendering dei dati.</span><span class="sxs-lookup"><span data-stu-id="826d2-140">At this point we have a SqlDataSource that simply returns all of the records from the `Products` table and a GridView that renders this data.</span></span> <span data-ttu-id="826d2-141">L'obiettivo consiste nell'estendere questo esempio per consentire all'utente di eliminare i prodotti tramite GridView.</span><span class="sxs-lookup"><span data-stu-id="826d2-141">Our goal is to extend this example to allow for the user to delete products via the GridView.</span></span> <span data-ttu-id="826d2-142">A tale scopo, è necessario specificare i valori per le proprietà del controllo SqlDataSource `DeleteCommand` e `DeleteParameters` e quindi configurare GridView per supportare l'eliminazione.</span><span class="sxs-lookup"><span data-stu-id="826d2-142">To accomplish this we need to specify values for the SqlDataSource control s `DeleteCommand` and `DeleteParameters` properties and then configure the GridView to support deleting.</span></span>

<span data-ttu-id="826d2-143">È possibile specificare le proprietà `DeleteCommand` e `DeleteParameters` in diversi modi:</span><span class="sxs-lookup"><span data-stu-id="826d2-143">The `DeleteCommand` and `DeleteParameters` properties can be specified in a number of ways:</span></span>

- <span data-ttu-id="826d2-144">Tramite la sintassi dichiarativa</span><span class="sxs-lookup"><span data-stu-id="826d2-144">Through the declarative syntax</span></span>
- <span data-ttu-id="826d2-145">Dal Finestra Proprietà nella finestra di progettazione</span><span class="sxs-lookup"><span data-stu-id="826d2-145">From the Properties window in the Designer</span></span>
- <span data-ttu-id="826d2-146">Dalla schermata specificare un'istruzione SQL personalizzata o stored procedure nella configurazione guidata origine dati</span><span class="sxs-lookup"><span data-stu-id="826d2-146">From the Specify a custom SQL statement or stored procedure screen in the Configure Data Source wizard</span></span>
- <span data-ttu-id="826d2-147">Tramite il pulsante Avanzate nella finestra di dialogo impostazione colonne da una tabella di visualizzazione della configurazione guidata origine dati, che genererà automaticamente il `DELETE` istruzione SQL e la raccolta di parametri utilizzati nelle proprietà `DeleteCommand` e `DeleteParameters`</span><span class="sxs-lookup"><span data-stu-id="826d2-147">Via the Advanced button in the Specify columns from a table of view screen in the Configure Data Source wizard, which will actually automatically generate the `DELETE` SQL statement and parameter collection used in the `DeleteCommand` and `DeleteParameters` properties</span></span>

<span data-ttu-id="826d2-148">Si esaminerà come avere automaticamente l'istruzione `DELETE` creata nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="826d2-148">We'll examine how to automatically have the `DELETE` statement created in Step 2.</span></span> <span data-ttu-id="826d2-149">Per il momento, è possibile utilizzare il Finestra Proprietà nella finestra di progettazione, anche se la configurazione guidata origine dati o la sintassi dichiarativa funzionerebbe anche.</span><span class="sxs-lookup"><span data-stu-id="826d2-149">For now, let s use the Properties window in the Designer, although the Configure Data Source wizard or declarative syntax option would work just as well.</span></span>

<span data-ttu-id="826d2-150">Nella finestra di progettazione `InsertUpdateDelete.aspx`fare clic sul `ProductsDataSource` SqlDataSource, quindi visualizzare il Finestra Proprietà (dal menu Visualizza scegliere Finestra Proprietà o semplicemente premere F4).</span><span class="sxs-lookup"><span data-stu-id="826d2-150">From the Designer in `InsertUpdateDelete.aspx`, click on the `ProductsDataSource` SqlDataSource and then bring up the Properties window (from the View menu, choose Properties window, or simply hit F4).</span></span> <span data-ttu-id="826d2-151">Selezionare la proprietà DeleteQuery, che consente di visualizzare un set di ellissi.</span><span class="sxs-lookup"><span data-stu-id="826d2-151">Select the DeleteQuery property, which will bring up a set of ellipses.</span></span>

![Selezionare la proprietà DeleteQuery nella finestra Proprietà](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image2.gif)

<span data-ttu-id="826d2-153">**Figura 2**: selezionare la proprietà DeleteQuery nella finestra Proprietà</span><span class="sxs-lookup"><span data-stu-id="826d2-153">**Figure 2**: Select the DeleteQuery Property from the Properties Window</span></span>

> [!NOTE]
> <span data-ttu-id="826d2-154">Il SqlDataSource doesn t ha una proprietà DeleteQuery.</span><span class="sxs-lookup"><span data-stu-id="826d2-154">The SqlDataSource doesn t have a DeleteQuery property.</span></span> <span data-ttu-id="826d2-155">DeleteQuery è invece una combinazione delle proprietà `DeleteCommand` e `DeleteParameters` e viene elencata solo nel Finestra Proprietà quando si visualizza la finestra tramite la finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="826d2-155">Rather, DeleteQuery is a combination of the `DeleteCommand` and `DeleteParameters` properties and is only listed in the Properties window when viewing the window through the Designer.</span></span> <span data-ttu-id="826d2-156">Se si esaminano le Finestra Proprietà nella visualizzazione origine, si troverà invece la proprietà `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="826d2-156">If you are looking at the Properties window in the Source view, you'll find the `DeleteCommand` property instead.</span></span>

<span data-ttu-id="826d2-157">Fare clic sui puntini di sospensione nella proprietà DeleteQuery per visualizzare la finestra di dialogo Editor comandi e parametri (vedere la figura 3).</span><span class="sxs-lookup"><span data-stu-id="826d2-157">Click the ellipses in the DeleteQuery property to bring up the Command and Parameter Editor dialog box (see Figure 3).</span></span> <span data-ttu-id="826d2-158">Da questa finestra di dialogo è possibile specificare l'istruzione SQL `DELETE` e specificare i parametri.</span><span class="sxs-lookup"><span data-stu-id="826d2-158">From this dialog box you can specify the `DELETE` SQL statement and specify the parameters.</span></span> <span data-ttu-id="826d2-159">Immettere la query seguente nella casella di testo Command `DELETE` (manualmente o usando il Generatore di query, se si preferisce):</span><span class="sxs-lookup"><span data-stu-id="826d2-159">Enter the following query into the `DELETE` command textbox (either manually or using the Query Builder, if you prefer):</span></span>

[!code-sql[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/samples/sample1.sql)]

<span data-ttu-id="826d2-160">Fare quindi clic sul pulsante Aggiorna parametri per aggiungere il parametro `@ProductID` all'elenco dei parametri riportati di seguito.</span><span class="sxs-lookup"><span data-stu-id="826d2-160">Next, click the Refresh Parameters button to add the `@ProductID` parameter to the list of parameters below.</span></span>

<span data-ttu-id="826d2-161">[![selezionare la proprietà DeleteQuery nella finestra Proprietà](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="826d2-161">[![Select the DeleteQuery Property from the Properties Window](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.png)</span></span>

<span data-ttu-id="826d2-162">**Figura 3**: selezionare la proprietà DeleteQuery nella finestra Proprietà ([fare clic per visualizzare l'immagine con dimensioni complete](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="826d2-162">**Figure 3**: Select the DeleteQuery Property from the Properties Window ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.png))</span></span>

<span data-ttu-id="826d2-163">*Non* specificare un valore per questo parametro (lasciare l'origine del parametro su None).</span><span class="sxs-lookup"><span data-stu-id="826d2-163">Do *not* provide a value for this parameter (leave its Parameter source at None ).</span></span> <span data-ttu-id="826d2-164">Quando si aggiunge il supporto per l'eliminazione a GridView, GridView fornirà automaticamente questo valore di parametro, usando il valore della raccolta di `DataKeys` per la riga di cui è stato fatto clic sul pulsante Elimina.</span><span class="sxs-lookup"><span data-stu-id="826d2-164">Once we add deleting support to the GridView, the GridView will automatically supply this parameter value, using the value of its `DataKeys` collection for the row whose Delete button was clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="826d2-165">Il nome del parametro utilizzato nella query di `DELETE` *deve* corrispondere al nome del valore `DataKeyNames` in GridView, DetailsView o FormView.</span><span class="sxs-lookup"><span data-stu-id="826d2-165">The parameter name used in the `DELETE` query *must* be the same as the name of the `DataKeyNames` value in the GridView, DetailsView, or FormView.</span></span> <span data-ttu-id="826d2-166">Ciò significa che il parametro nell'istruzione `DELETE` viene denominato espressamente `@ProductID` (anziché, Say, `@ID`), perché il nome della colonna chiave primaria nella tabella Products (e pertanto il valore al DataKeyNames in GridView) viene `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="826d2-166">That is, the parameter in the `DELETE` statement is purposefully named `@ProductID` (instead of, say, `@ID`), because the primary key column name in the Products table (and therefore the DataKeyNames value in the GridView) is `ProductID`.</span></span>

<span data-ttu-id="826d2-167">Se il nome del parametro e il valore di `DataKeyNames` non corrispondono, GridView non può assegnare automaticamente il parametro al valore della raccolta di `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="826d2-167">If the parameter name and `DataKeyNames` value doesn t match, the GridView cannot automatically assign the parameter the value from the `DataKeys` collection.</span></span>

<span data-ttu-id="826d2-168">Dopo aver immesso le informazioni relative all'eliminazione nella finestra di dialogo Editor comandi e parametri, fare clic su OK e passare alla visualizzazione origine per esaminare il markup dichiarativo risultante:</span><span class="sxs-lookup"><span data-stu-id="826d2-168">After entering the delete-related information into the Command and Parameter Editor dialog box click OK and go to the Source view to examine the resulting declarative markup:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/samples/sample2.aspx)]

<span data-ttu-id="826d2-169">Si noti l'aggiunta della proprietà `DeleteCommand`, nonché la sezione `<DeleteParameters>` e l'oggetto Parameter denominato `productID`.</span><span class="sxs-lookup"><span data-stu-id="826d2-169">Note the addition of the `DeleteCommand` property as well as the `<DeleteParameters>` section and the Parameter object named `productID`.</span></span>

## <a name="configuring-the-gridview-for-deleting"></a><span data-ttu-id="826d2-170">Configurazione di GridView per l'eliminazione</span><span class="sxs-lookup"><span data-stu-id="826d2-170">Configuring the GridView for Deleting</span></span>

<span data-ttu-id="826d2-171">Con la proprietà `DeleteCommand` aggiunta, lo smart tag GridView s contiene ora l'opzione Abilita eliminazione.</span><span class="sxs-lookup"><span data-stu-id="826d2-171">With the `DeleteCommand` property added, the GridView s smart tag now contains the Enable Deleting option.</span></span> <span data-ttu-id="826d2-172">Procedere e selezionare questa casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="826d2-172">Go ahead and check this checkbox.</span></span> <span data-ttu-id="826d2-173">Come descritto in [una panoramica dell'inserimento, dell'aggiornamento e dell'eliminazione](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md), in GridView viene aggiunto un oggetto CommandField con la relativa proprietà `ShowDeleteButton` impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="826d2-173">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md), this causes the GridView to add a CommandField with its `ShowDeleteButton` property set to `true`.</span></span> <span data-ttu-id="826d2-174">Come illustrato nella figura 4, quando la pagina viene visitata tramite un browser viene incluso un pulsante Elimina.</span><span class="sxs-lookup"><span data-stu-id="826d2-174">As Figure 4 shows, when the page is visited through a browser a Delete button is included.</span></span> <span data-ttu-id="826d2-175">Testare questa pagina eliminando alcuni prodotti.</span><span class="sxs-lookup"><span data-stu-id="826d2-175">Test this page out by deleting some products.</span></span>

<span data-ttu-id="826d2-176">[![ogni riga GridView include ora un pulsante Elimina](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="826d2-176">[![Each GridView Row Now Includes a Delete Button](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image5.png)</span></span>

<span data-ttu-id="826d2-177">**Figura 4**: ogni riga GridView include ora un pulsante Elimina ([fare clic per visualizzare l'immagine con dimensioni complete](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="826d2-177">**Figure 4**: Each GridView Row Now Includes a Delete Button ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.png))</span></span>

<span data-ttu-id="826d2-178">Quando si fa clic su un pulsante Elimina, viene eseguito un postback, GridView assegna il parametro `ProductID` il valore del valore della raccolta `DataKeys` per la riga il cui pulsante Elimina è stato selezionato e richiama il Metodo SqlDataSource s `Delete()`.</span><span class="sxs-lookup"><span data-stu-id="826d2-178">Upon clicking a Delete button, a postback occurs, the GridView assigns the `ProductID` parameter the value of the `DataKeys` collection value for the row whose Delete button was clicked, and invokes the SqlDataSource s `Delete()` method.</span></span> <span data-ttu-id="826d2-179">Il controllo SqlDataSource si connette quindi al database ed esegue l'istruzione `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="826d2-179">The SqlDataSource control then connects to the database and executes the `DELETE` statement.</span></span> <span data-ttu-id="826d2-180">Il controllo GridView viene quindi riassociato al SqlDataSource, ottenendo nuovamente e visualizzando il set corrente di prodotti (che non include più il record appena eliminato).</span><span class="sxs-lookup"><span data-stu-id="826d2-180">The GridView then rebinds to the SqlDataSource, getting back and displaying the current set of products (which no longer includes the just-deleted record).</span></span>

> [!NOTE]
> <span data-ttu-id="826d2-181">Poiché GridView usa la raccolta `DataKeys` per popolare i parametri SqlDataSource, è fondamentale che la proprietà `DataKeyNames` di GridView sia impostata sulle colonne che costituiscono la chiave primaria e che il `SelectCommand` di SqlDataSource restituisca tali colonne.</span><span class="sxs-lookup"><span data-stu-id="826d2-181">Since the GridView uses its `DataKeys` collection to populate the SqlDataSource parameters, it s vital that the GridView s `DataKeyNames` property be set to the column(s) that constitute the primary key and that the SqlDataSource s `SelectCommand` returns these columns.</span></span> <span data-ttu-id="826d2-182">Inoltre, è importante che il nome del parametro in SqlDataSource s `DeleteCommand` sia impostato su `@ProductID`.</span><span class="sxs-lookup"><span data-stu-id="826d2-182">Moreover, it s important that the parameter name in the SqlDataSource s `DeleteCommand` is set to `@ProductID`.</span></span> <span data-ttu-id="826d2-183">Se la proprietà `DataKeyNames` non è impostata o il parametro non è denominato `@ProductsID`, facendo clic sul pulsante Elimina verrà generato un postback, ma non verrà eliminato alcun record.</span><span class="sxs-lookup"><span data-stu-id="826d2-183">If the `DataKeyNames` property is not set or the parameter is not named `@ProductsID`, clicking the Delete button will cause a postback, but won't actually delete any record.</span></span>

<span data-ttu-id="826d2-184">Nella figura 5 viene illustrata graficamente questa interazione.</span><span class="sxs-lookup"><span data-stu-id="826d2-184">Figure 5 depicts this interaction graphically.</span></span> <span data-ttu-id="826d2-185">Per una discussione più dettagliata sulla catena di eventi associati all'inserimento, all'aggiornamento e all'eliminazione da un controllo Web dati, vedere l'esercitazione [esaminare gli eventi associati all'inserimento, l'aggiornamento e l'eliminazione](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="826d2-185">Refer back to the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial for a more detailed discussion on the chain of events associated with inserting, updating, and deleting from a data Web control.</span></span>

![Se si fa clic sul pulsante Elimina in GridView, viene chiamato il Metodo SqlDataSource s Delete ()](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image5.gif)

<span data-ttu-id="826d2-187">**Figura 5**: facendo clic sul pulsante Elimina in GridView viene richiamato il Metodo SqlDataSource s `Delete()`</span><span class="sxs-lookup"><span data-stu-id="826d2-187">**Figure 5**: Clicking the Delete Button in the GridView Invokes the SqlDataSource s `Delete()` Method</span></span>

## <a name="step-2-automatically-generating-theinsertupdate-anddeletestatements"></a><span data-ttu-id="826d2-188">Passaggio 2: generazione automatica delle istruzioni`INSERT`,`UPDATE`e`DELETE`</span><span class="sxs-lookup"><span data-stu-id="826d2-188">Step 2: Automatically Generating the`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="826d2-189">Come indicato nel passaggio 1, è possibile specificare le istruzioni SQL `INSERT`, `UPDATE`e `DELETE` tramite la sintassi dichiarativa Finestra Proprietà o Control.</span><span class="sxs-lookup"><span data-stu-id="826d2-189">As Step 1 examined, `INSERT`, `UPDATE`, and `DELETE` SQL statements can be specified through the Properties window or the control s declarative syntax.</span></span> <span data-ttu-id="826d2-190">Tuttavia, questo approccio richiede la scrittura manuale manuale delle istruzioni SQL, che possono essere monotone e soggette a errori.</span><span class="sxs-lookup"><span data-stu-id="826d2-190">However, this approach requires that we manually write out the SQL statements by hand, which can be monotonous and error-prone.</span></span> <span data-ttu-id="826d2-191">Fortunatamente, la configurazione guidata origine dati offre un'opzione che consente di generare automaticamente le istruzioni `INSERT`, `UPDATE`e `DELETE` quando si utilizza la schermata specificare le colonne da una tabella di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="826d2-191">Fortunately, the Configure Data Source wizard provides an option to have the `INSERT`, `UPDATE`, and `DELETE` statements automatically generated when using the Specify columns from a table of view screen.</span></span>

<span data-ttu-id="826d2-192">Consente di esplorare questa opzione di generazione automatica.</span><span class="sxs-lookup"><span data-stu-id="826d2-192">Let s explore this automatic generation option.</span></span> <span data-ttu-id="826d2-193">Aggiungere un oggetto DetailsView alla finestra di progettazione in `InsertUpdateDelete.aspx` e impostare la relativa proprietà `ID` su `ManageProducts`.</span><span class="sxs-lookup"><span data-stu-id="826d2-193">Add a DetailsView to the Designer in `InsertUpdateDelete.aspx` and set its `ID` property to `ManageProducts`.</span></span> <span data-ttu-id="826d2-194">Quindi, dallo smart tag di DetailsView, scegliere di creare una nuova origine dati e creare un SqlDataSource denominato `ManageProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="826d2-194">Next, from the DetailsView s smart tag, choose to create a new data source and create a SqlDataSource named `ManageProductsDataSource`.</span></span>

<span data-ttu-id="826d2-195">[![creare un nuovo SqlDataSource denominato ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="826d2-195">[![Create a New SqlDataSource Named ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.png)</span></span>

<span data-ttu-id="826d2-196">**Figura 6**: creare un nuovo SqlDataSource denominato `ManageProductsDataSource` ([fare clic per visualizzare l'immagine con dimensioni complete](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="826d2-196">**Figure 6**: Create a New SqlDataSource Named `ManageProductsDataSource` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image8.png))</span></span>

<span data-ttu-id="826d2-197">Nella configurazione guidata origine dati scegliere di utilizzare la stringa di connessione `NORTHWINDConnectionString` e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="826d2-197">From the Configure Data Source wizard, opt to use the `NORTHWINDConnectionString` connection string and click Next.</span></span> <span data-ttu-id="826d2-198">Dalla schermata Configura istruzione SELECT, lasciare selezionato il pulsante di opzione specificare le colonne da una tabella o una vista e selezionare la tabella `Products` dall'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="826d2-198">From the Configure the Select Statement screen, leave the Specify columns from a table or view radio button selected and pick the `Products` table from the drop-down list.</span></span> <span data-ttu-id="826d2-199">Selezionare le colonne `ProductID`, `ProductName`, `UnitPrice`e `Discontinued` nell'elenco di caselle di controllo.</span><span class="sxs-lookup"><span data-stu-id="826d2-199">Select the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` columns from the checkbox list.</span></span>

<span data-ttu-id="826d2-200">[![utilizzando la tabella Products, restituire le colonne ProductID, ProductName, PrezzoUnitario e Discontinued](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="826d2-200">[![Using the Products Table, Return the ProductID, ProductName, UnitPrice, and Discontinued Columns](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.png)</span></span>

<span data-ttu-id="826d2-201">**Figura 7**: utilizzo della tabella `Products`, restituire le colonne `ProductID`, `ProductName`, `UnitPrice`e `Discontinued` ([fare clic per visualizzare l'immagine con dimensioni complete](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="826d2-201">**Figure 7**: Using the `Products` Table, Return the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` Columns ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image10.png))</span></span>

<span data-ttu-id="826d2-202">Per generare automaticamente le istruzioni `INSERT`, `UPDATE`e `DELETE` in base alla tabella e alle colonne selezionate, fare clic sul pulsante Avanzate e selezionare la casella di controllo genera `INSERT`, `UPDATE`e `DELETE` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="826d2-202">To automatically generate `INSERT`, `UPDATE`, and `DELETE` statements based on the selected table and columns, click the Advanced button and check the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox.</span></span>

![Selezionare la casella di controllo genera istruzioni INSERT, UPDATE e DELETE](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image8.gif)

<span data-ttu-id="826d2-204">**Figura 8**: selezionare la casella di controllo genera `INSERT`, `UPDATE`e istruzioni `DELETE`</span><span class="sxs-lookup"><span data-stu-id="826d2-204">**Figure 8**: Check the Generate `INSERT`, `UPDATE`, and `DELETE` statements Checkbox</span></span>

<span data-ttu-id="826d2-205">La casella di controllo genera `INSERT`, `UPDATE`e `DELETE` sarà controllabile solo se la tabella selezionata include una chiave primaria e la colonna o le colonne di chiave primaria sono incluse nell'elenco delle colonne restituite.</span><span class="sxs-lookup"><span data-stu-id="826d2-205">The Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox will only be checkable if the table selected has a primary key and the primary key column (or columns) are included in the list of returned columns.</span></span> <span data-ttu-id="826d2-206">La casella di controllo Usa concorrenza ottimistica, che diventa selezionabile dopo che è stata selezionata la casella di controllo genera `INSERT`, `UPDATE`e `DELETE` istruzioni, aumenterà le clausole `WHERE` nelle istruzioni `UPDATE` e `DELETE` risultanti per fornire il controllo della concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="826d2-206">The Use optimistic concurrency checkbox, which becomes selectable once the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox has been checked, will augment the `WHERE` clauses in the resulting `UPDATE` and `DELETE` statements to provide optimistic concurrency control.</span></span> <span data-ttu-id="826d2-207">Per il momento, lasciare deselezionata questa casella di controllo; si esaminerà la concorrenza ottimistica con il controllo SqlDataSource nell'esercitazione successiva.</span><span class="sxs-lookup"><span data-stu-id="826d2-207">For now, leave this checkbox unchecked; we'll examine optimistic concurrency with the SqlDataSource control in the next tutorial.</span></span>

<span data-ttu-id="826d2-208">Dopo aver selezionato la casella di controllo genera `INSERT`, `UPDATE`e `DELETE`, fare clic su OK per tornare alla schermata Configura istruzione SELECT, quindi fare clic su Avanti, quindi su fine per completare la procedura guidata Configura origine dati.</span><span class="sxs-lookup"><span data-stu-id="826d2-208">After checking the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox, click OK to return to the Configure Select Statement screen, then click Next, and then Finish, to complete the Configure Data Source wizard.</span></span> <span data-ttu-id="826d2-209">Al termine della procedura guidata, Visual Studio aggiungerà i BoundField a DetailsView per le colonne `ProductID`, `ProductName`e `UnitPrice` e un CheckBoxField per la colonna `Discontinued`.</span><span class="sxs-lookup"><span data-stu-id="826d2-209">Upon completing the wizard, Visual Studio will add BoundFields to the DetailsView for the `ProductID`, `ProductName`, and `UnitPrice` columns and a CheckBoxField for the `Discontinued` column.</span></span> <span data-ttu-id="826d2-210">Dallo smart tag DetailsView s selezionare l'opzione Abilita paging in modo che l'utente che visita questa pagina possa esaminare i prodotti.</span><span class="sxs-lookup"><span data-stu-id="826d2-210">From the DetailsView s smart tag, check the Enable Paging option so that the user visiting this page can step through the products.</span></span> <span data-ttu-id="826d2-211">Deselezionare anche le proprietà `Width` e `Height` di DetailsView.</span><span class="sxs-lookup"><span data-stu-id="826d2-211">Also clear out the DetailsView s `Width` and `Height` properties.</span></span>

<span data-ttu-id="826d2-212">Si noti che per lo smart tag sono disponibili le opzioni Consenti inserimento, Abilita modifica e Abilita eliminazione.</span><span class="sxs-lookup"><span data-stu-id="826d2-212">Notice that the smart tag has the Enable Inserting, Enable Editing, and Enable Deleting options available.</span></span> <span data-ttu-id="826d2-213">Questo è dovuto al fatto che il SqlDataSource contiene valori per la `InsertCommand`, `UpdateCommand`e `DeleteCommand`, come illustrato nella sintassi dichiarativa seguente:</span><span class="sxs-lookup"><span data-stu-id="826d2-213">This is because the SqlDataSource contains values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand`, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/samples/sample3.aspx)]

<span data-ttu-id="826d2-214">Si noti che per il controllo SqlDataSource sono stati impostati valori automaticamente per le proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="826d2-214">Note how the SqlDataSource control has had values automatically set for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="826d2-215">Il set di colonne a cui si fa riferimento nelle proprietà `InsertCommand` e `UpdateCommand` si basa su quelle nell'istruzione `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="826d2-215">The set of columns referenced in the `InsertCommand` and `UpdateCommand` properties are based on those in the `SELECT` statement.</span></span> <span data-ttu-id="826d2-216">Ovvero, anziché avere *ogni* colonna Products nel `InsertCommand` e `UpdateCommand`, sono presenti solo le colonne specificate nella `SelectCommand` (less `ProductID`, che viene omesso perché è una [colonna`IDENTITY`](http://www.sqlteam.com/item.asp?ItemID=102), il cui valore non può essere modificato quando modificato e che viene assegnato automaticamente durante l'inserimento).</span><span class="sxs-lookup"><span data-stu-id="826d2-216">That is, rather than having *every* Products column in the `InsertCommand` and `UpdateCommand`, there are only those columns specified in the `SelectCommand` (less `ProductID`, which is omitted because it s an [`IDENTITY` column](http://www.sqlteam.com/item.asp?ItemID=102), whose value cannot be changed when edited and which is automatically assigned when inserting).</span></span> <span data-ttu-id="826d2-217">Inoltre, per ogni parametro nelle proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand` sono presenti parametri corrispondenti nelle raccolte `InsertParameters`, `UpdateParameters`e `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="826d2-217">Moreover, for each parameter in the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties there are corresponding parameters in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="826d2-218">Per attivare le funzionalità di modifica dei dati di DetailsView, selezionare le opzioni Consenti inserimento, Abilita modifica e Abilita eliminazione nello smart tag.</span><span class="sxs-lookup"><span data-stu-id="826d2-218">To turn on the DetailsView s data modification features, check the Enable Inserting, Enable Editing, and Enable Deleting options in its smart tag.</span></span> <span data-ttu-id="826d2-219">Viene aggiunto un oggetto CommandField con le proprietà `ShowInsertButton`, `ShowEditButton`e `ShowDeleteButton` impostate su `true`.</span><span class="sxs-lookup"><span data-stu-id="826d2-219">This adds a CommandField with its `ShowInsertButton`, `ShowEditButton`, and `ShowDeleteButton` properties set to `true`.</span></span>

<span data-ttu-id="826d2-220">Visitare la pagina in un browser e prendere nota dei pulsanti modifica, Elimina e nuovo inclusi in DetailsView.</span><span class="sxs-lookup"><span data-stu-id="826d2-220">Visit the page in a browser and note the Edit, Delete, and New buttons included in the DetailsView.</span></span> <span data-ttu-id="826d2-221">Facendo clic sul pulsante modifica, il controllo DetailsView viene trasformato in modalità di modifica, che consente di visualizzare ogni BoundField la cui proprietà `ReadOnly` è impostata su `false` (impostazione predefinita) come casella di testo e l'oggetto CheckBoxField come casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="826d2-221">Clicking the Edit button turns the DetailsView into edit mode, which displays each BoundField whose `ReadOnly` property is set to `false` (the default) as a TextBox, and the CheckBoxField as a checkbox.</span></span>

<span data-ttu-id="826d2-222">[![l'interfaccia di modifica predefinita di DetailsView s](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="826d2-222">[![The DetailsView s Default Editing Interface](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image11.png)</span></span>

<span data-ttu-id="826d2-223">**Figura 9**: interfaccia di modifica predefinita di DetailsView ([fare clic per visualizzare l'immagine con dimensioni complete](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="826d2-223">**Figure 9**: The DetailsView s Default Editing Interface ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image12.png))</span></span>

<span data-ttu-id="826d2-224">Analogamente, è possibile eliminare il prodotto attualmente selezionato o aggiungere un nuovo prodotto al sistema.</span><span class="sxs-lookup"><span data-stu-id="826d2-224">Similarly, you can delete the currently selected product or add a new product to the system.</span></span> <span data-ttu-id="826d2-225">Poiché l'istruzione `InsertCommand` funziona solo con le colonne `ProductName`, `UnitPrice`e `Discontinued`, le altre colonne hanno `NULL` o il relativo valore predefinito assegnato dal database al momento dell'inserimento.</span><span class="sxs-lookup"><span data-stu-id="826d2-225">Since the `InsertCommand` statement only works with the `ProductName`, `UnitPrice`, and `Discontinued` columns, the other columns have either `NULL` or their default value assigned by the database upon insert.</span></span> <span data-ttu-id="826d2-226">Proprio come con ObjectDataSource, se mancano le colonne `InsertCommand` della tabella di database che non consentono `NULL` s e Don t hanno un valore predefinito, si verificherà un errore SQL quando si tenta di eseguire l'istruzione `INSERT`.</span><span class="sxs-lookup"><span data-stu-id="826d2-226">Just like with the ObjectDataSource, if the `InsertCommand` is missing any database table columns that don t allow `NULL` s and don t have a default value, a SQL error will occur when attempting to execute the `INSERT` statement.</span></span>

> [!NOTE]
> <span data-ttu-id="826d2-227">Le interfacce di inserimento e modifica di DetailsView non dispongono di alcuna personalizzazione o convalida.</span><span class="sxs-lookup"><span data-stu-id="826d2-227">The DetailsView s inserting and editing interfaces lack any sort of customization or validation.</span></span> <span data-ttu-id="826d2-228">Per aggiungere controlli di convalida o personalizzare le interfacce, è necessario convertire i BoundField in TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="826d2-228">To add validation controls or to customize the interfaces, you need to convert the BoundFields to TemplateFields.</span></span> <span data-ttu-id="826d2-229">Per ulteriori informazioni, vedere l'articolo relativo all' [aggiunta di controlli di convalida alle interfacce di modifica e inserimento](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) e [alla personalizzazione delle esercitazioni sull'interfaccia di modifica dei dati](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="826d2-229">Refer to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) and [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorials for more information.</span></span>

<span data-ttu-id="826d2-230">Tenere inoltre presente che, per l'aggiornamento e l'eliminazione, DetailsView utilizza il valore `DataKey` del prodotto corrente, presente solo se la proprietà `DataKeyNames` è configurata.</span><span class="sxs-lookup"><span data-stu-id="826d2-230">Also, keep in mind that for updating and deleting, the DetailsView uses the current product s `DataKey` value, which is only present if the `DataKeyNames` property is configured.</span></span> <span data-ttu-id="826d2-231">Se la modifica o l'eliminazione sembra non avere alcun effetto, verificare che sia impostata la proprietà `DataKeyNames`.</span><span class="sxs-lookup"><span data-stu-id="826d2-231">If editing or deleting appears to have no effect, ensure that the `DataKeyNames` property is set.</span></span>

## <a name="limitations-of-automatically-generating-sql-statements"></a><span data-ttu-id="826d2-232">Limitazioni della generazione automatica di istruzioni SQL</span><span class="sxs-lookup"><span data-stu-id="826d2-232">Limitations of Automatically Generating SQL Statements</span></span>

<span data-ttu-id="826d2-233">Poiché l'opzione genera `INSERT`, `UPDATE`e `DELETE` Statements è disponibile solo quando si selezionano le colonne di una tabella, per le query più complesse sarà necessario scrivere le proprie istruzioni `INSERT`, `UPDATE`e `DELETE` come nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="826d2-233">Since the Generate `INSERT`, `UPDATE`, and `DELETE` statements option is only available when picking columns from a table, for more complex queries you will have to write your own `INSERT`, `UPDATE`, and `DELETE` statements like we did in Step 1.</span></span> <span data-ttu-id="826d2-234">Le istruzioni SQL `SELECT` usano in genere `JOIN` s per ripristinare i dati da una o più tabelle di ricerca a scopo di visualizzazione, ad esempio riportando il campo `CategoryName` della tabella `Categories` quando si visualizzano le informazioni sul prodotto.</span><span class="sxs-lookup"><span data-stu-id="826d2-234">Commonly, SQL `SELECT` statements use `JOIN` s to bring back data from one or more lookup tables for display purposes (such as bringing back the `Categories` table s `CategoryName` field when displaying product information).</span></span> <span data-ttu-id="826d2-235">Allo stesso tempo, potrebbe essere necessario consentire all'utente di modificare, aggiornare o inserire dati nella tabella principale, in questo caso`Products`.</span><span class="sxs-lookup"><span data-stu-id="826d2-235">At the same time, we might want to allow the user to edit, update, or insert data into the core table (`Products`, in this case).</span></span>

<span data-ttu-id="826d2-236">Sebbene le istruzioni `INSERT`, `UPDATE`e `DELETE` possano essere immesse manualmente, tenere presente il suggerimento relativo al risparmio di tempo seguente.</span><span class="sxs-lookup"><span data-stu-id="826d2-236">While the `INSERT`, `UPDATE`, and `DELETE` statements can be entered manually, consider the following time-saving tip.</span></span> <span data-ttu-id="826d2-237">Configurare inizialmente il SqlDataSource in modo da estrarre i dati solo dalla tabella `Products`.</span><span class="sxs-lookup"><span data-stu-id="826d2-237">Initially setup the SqlDataSource so that it pulls back data just from the `Products` table.</span></span> <span data-ttu-id="826d2-238">Utilizzare la configurazione guidata origine dati s specificare le colonne da una schermata della tabella o della vista in modo che sia possibile generare automaticamente le istruzioni `INSERT`, `UPDATE`e `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="826d2-238">Use the Configure Data Source wizard s Specify columns from a table or view screen so that you can automatically generate the `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="826d2-239">Quindi, dopo aver completato la procedura guidata, scegliere di configurare SelectQuery dalla Finestra Proprietà (oppure, in alternativa, tornare alla configurazione guidata origine dati, ma usare l'opzione specificare un'istruzione SQL personalizzata o stored procedure).</span><span class="sxs-lookup"><span data-stu-id="826d2-239">Then, after completing the wizard, choose to configure the SelectQuery from the Properties window (or, alternatively, go back to the Configure Data Source wizard, but use the Specify a custom SQL statement or stored procedure option).</span></span> <span data-ttu-id="826d2-240">Aggiornare quindi l'istruzione `SELECT` per includere la sintassi del `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="826d2-240">Then update the `SELECT` statement to include the `JOIN` syntax.</span></span> <span data-ttu-id="826d2-241">Questa tecnica offre i vantaggi per il risparmio di tempo delle istruzioni SQL generate automaticamente e consente un'istruzione `SELECT` più personalizzata.</span><span class="sxs-lookup"><span data-stu-id="826d2-241">This technique offers the time-saving benefits of the automatically generated SQL statements and allows for a more customized `SELECT` statement.</span></span>

<span data-ttu-id="826d2-242">Un altro limite di generazione automatica delle istruzioni `INSERT`, `UPDATE`e `DELETE` è che le colonne nelle istruzioni `INSERT` e `UPDATE` sono basate sulle colonne restituite dall'istruzione `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="826d2-242">Another limitation of automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements is that the columns in the `INSERT` and `UPDATE` statements are based on the columns returned by the `SELECT` statement.</span></span> <span data-ttu-id="826d2-243">Potrebbe tuttavia essere necessario aggiornare o inserire più campi o meno.</span><span class="sxs-lookup"><span data-stu-id="826d2-243">We may need to update or insert more or fewer fields, however.</span></span> <span data-ttu-id="826d2-244">Ad esempio, nell'esempio del passaggio 2, potrebbe essere necessario che la `UnitPrice` BoundField sia di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="826d2-244">For example, in the example from Step 2, maybe we want to have the `UnitPrice` BoundField be read-only.</span></span> <span data-ttu-id="826d2-245">In tal caso, non dovrebbe essere visualizzato nella `UpdateCommand`.</span><span class="sxs-lookup"><span data-stu-id="826d2-245">In that case, it shouldn't appear in the `UpdateCommand`.</span></span> <span data-ttu-id="826d2-246">In alternativa, potrebbe essere necessario impostare il valore di un campo di tabella che non viene visualizzato in GridView.</span><span class="sxs-lookup"><span data-stu-id="826d2-246">Or we may want to set the value of a table field that does not appear in the GridView.</span></span> <span data-ttu-id="826d2-247">Ad esempio, quando si aggiunge un nuovo record, potrebbe essere necessario impostare il valore di `QuantityPerUnit` su TODO.</span><span class="sxs-lookup"><span data-stu-id="826d2-247">For example, when adding a new record we may want the `QuantityPerUnit` value set to TODO .</span></span>

<span data-ttu-id="826d2-248">Se tali personalizzazioni sono necessarie, è necessario impostarle manualmente, tramite la Finestra Proprietà, l'opzione specificare un'istruzione SQL personalizzata o stored procedure nella procedura guidata oppure tramite la sintassi dichiarativa.</span><span class="sxs-lookup"><span data-stu-id="826d2-248">If such customizations are required, you need to make them manually, either through the Properties window, the Specify a custom SQL statement or stored procedure option in the wizard, or via the declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="826d2-249">Quando si aggiungono parametri che non hanno campi corrispondenti nel controllo Web dei dati, tenere presente che i valori dei parametri devono essere assegnati in qualche modo.</span><span class="sxs-lookup"><span data-stu-id="826d2-249">When adding parameters that do not have corresponding fields in the data Web control, keep in mind that these parameters values will need to be assigned values in some manner.</span></span> <span data-ttu-id="826d2-250">Questi valori possono essere: hardcoded direttamente nel `InsertCommand` o `UpdateCommand`; può provenire da un'origine predefinita (queryString, stato sessione, controlli Web nella pagina e così via); oppure possono essere assegnati a livello di codice, come illustrato nell'esercitazione precedente.</span><span class="sxs-lookup"><span data-stu-id="826d2-250">These values can be: hard-coded directly in the `InsertCommand` or `UpdateCommand`; can come from some pre-defined source (the querystring, session state, Web controls on the page, and so on); or can be assigned programmatically, as we saw in the preceding tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="826d2-251">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="826d2-251">Summary</span></span>

<span data-ttu-id="826d2-252">Per consentire ai controlli Web dei dati di utilizzare le funzionalità di inserimento, modifica ed eliminazione predefinite, il controllo origine dati a cui sono associate deve offrire tale funzionalità.</span><span class="sxs-lookup"><span data-stu-id="826d2-252">In order for the data Web controls to utilize their built-in inserting, editing, and deleting capabilities, the data source control they are bound to must offer such functionality.</span></span> <span data-ttu-id="826d2-253">Per il SqlDataSource, ciò significa che le istruzioni SQL `INSERT`, `UPDATE`e `DELETE` devono essere assegnate alle proprietà `InsertCommand`, `UpdateCommand`e `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="826d2-253">For the SqlDataSource, this means that `INSERT`, `UPDATE`, and `DELETE` SQL statements must be assigned to the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="826d2-254">Queste proprietà e le raccolte di parametri corrispondenti possono essere aggiunte manualmente o generate automaticamente tramite la configurazione guidata origine dati.</span><span class="sxs-lookup"><span data-stu-id="826d2-254">These properties, and the corresponding parameters collections, can be added manually or generated automatically through the Configure Data Source wizard.</span></span> <span data-ttu-id="826d2-255">In questa esercitazione sono state esaminate entrambe le tecniche.</span><span class="sxs-lookup"><span data-stu-id="826d2-255">In this tutorial we examined both techniques.</span></span>

<span data-ttu-id="826d2-256">È stata esaminata l'uso della concorrenza ottimistica con ObjectDataSource nell'esercitazione sull' [implementazione della concorrenza ottimistica](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="826d2-256">We examined using optimistic concurrency with the ObjectDataSource in the [Implementing Optimistic Concurrency](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-cs.md) tutorial.</span></span> <span data-ttu-id="826d2-257">Il controllo SqlDataSource fornisce inoltre supporto per la concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="826d2-257">The SqlDataSource control also provides optimistic concurrency support.</span></span> <span data-ttu-id="826d2-258">Come indicato nel passaggio 2, quando si generano automaticamente le istruzioni `INSERT`, `UPDATE`e `DELETE`, la procedura guidata offre un'opzione Usa concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="826d2-258">As noted in Step 2, when automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements, the wizard offers a Use optimistic concurrency option.</span></span> <span data-ttu-id="826d2-259">Come si vedrà nell'esercitazione successiva, l'uso della concorrenza ottimistica con SqlDataSource modifica le clausole `WHERE` nelle istruzioni `UPDATE` e `DELETE` per assicurarsi che i valori per le altre colonne non siano stati modificati dopo l'ultima visualizzazione dei dati nella pagina.</span><span class="sxs-lookup"><span data-stu-id="826d2-259">As we'll see in the next tutorial, using optimistic concurrency with the SqlDataSource modifies the `WHERE` clauses in the `UPDATE` and `DELETE` statements to ensure that the values for the other columns haven't changed since the data was last displayed on the page.</span></span>

<span data-ttu-id="826d2-260">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="826d2-260">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="826d2-261">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="826d2-261">About the Author</span></span>

<span data-ttu-id="826d2-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette ASP/ASP. NET Books e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), collabora con le tecnologie Web Microsoft a partire da 1998.</span><span class="sxs-lookup"><span data-stu-id="826d2-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="826d2-263">Scott lavora come consulente, trainer e writer indipendenti.</span><span class="sxs-lookup"><span data-stu-id="826d2-263">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="826d2-264">Il suo ultimo libro è [*Sams Teach Yourself ASP.NET 2,0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="826d2-264">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="826d2-265">Può essere raggiunto in [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="826d2-265">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="826d2-266">o tramite il suo Blog, disponibile in [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="826d2-266">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="826d2-267">[Precedente](using-parameterized-queries-with-the-sqldatasource-cs.md)
> [Successivo](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)</span><span class="sxs-lookup"><span data-stu-id="826d2-267">[Previous](using-parameterized-queries-with-the-sqldatasource-cs.md)
[Next](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)</span></span>
