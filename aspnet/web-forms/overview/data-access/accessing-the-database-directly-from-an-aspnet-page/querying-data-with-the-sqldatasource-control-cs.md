---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs
title: Eseguire query sui dati con il controllo SqlDataSource (c#) | Microsoft Docs
author: rick-anderson
description: Nelle esercitazioni precedenti abbiamo utilizzato il controllo ObjectDataSource per separare completamente il livello di presentazione dal livello di accesso ai dati. A partire da questa tutor...
ms.author: riande
ms.date: 02/20/2007
ms.assetid: 60512d6a-b572-4b7a-beb3-3e44b4d2020c
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs
msc.type: authoredcontent
ms.openlocfilehash: de0ad77967af2b1b7d6cca08a0c13df81a278091
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/06/2019
ms.locfileid: "65115010"
---
# <a name="querying-data-with-the-sqldatasource-control-c"></a><span data-ttu-id="f7a95-104">Esecuzione di query sui dati con il controllo SqlDataSource (C#)</span><span class="sxs-lookup"><span data-stu-id="f7a95-104">Querying Data with the SqlDataSource Control (C#)</span></span>

<span data-ttu-id="f7a95-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f7a95-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f7a95-106">[Scaricare l'App di esempio](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_CS.exe) o [Scarica il PDF](querying-data-with-the-sqldatasource-control-cs/_static/datatutorial47cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f7a95-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_CS.exe) or [Download PDF](querying-data-with-the-sqldatasource-control-cs/_static/datatutorial47cs1.pdf)</span></span>

> <span data-ttu-id="f7a95-107">Nelle esercitazioni precedenti abbiamo utilizzato il controllo ObjectDataSource per separare completamente il livello di presentazione dal livello di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-107">In the preceding tutorials we used the ObjectDataSource control to fully separate the presentation layer from the Data Access layer.</span></span> <span data-ttu-id="f7a95-108">A partire da questa esercitazione, è informazioni su come utilizzare il controllo SqlDataSource per applicazioni semplici che non richiedono una netta separazione di presentazione e l'accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-108">Starting with this tutorial, we learn how the SqlDataSource control can be used for simple applications that do not require such a strict separation of presentation and data access.</span></span>

## <a name="introduction"></a><span data-ttu-id="f7a95-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="f7a95-109">Introduction</span></span>

<span data-ttu-id="f7a95-110">Tutte le esercitazioni si va esaminato finora è stata utilizzata un'architettura a più livelli di presentazione, logica di Business e livelli di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-110">All of the tutorials we ve examined so far have used a tiered architecture consisting of presentation, Business Logic, and Data Access layers.</span></span> <span data-ttu-id="f7a95-111">La Data Access Layer (DAL) è stato creato nella prima esercitazione ([creazione di un livello di accesso ai dati](../introduction/creating-a-data-access-layer-cs.md)) e il livello di logica di Business nella seconda ([creazione di un livello di logica di Business](../introduction/creating-a-business-logic-layer-cs.md)).</span><span class="sxs-lookup"><span data-stu-id="f7a95-111">The Data Access Layer (DAL) was crafted in the first tutorial ([Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md)) and the Business Logic Layer in the second ([Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-cs.md)).</span></span> <span data-ttu-id="f7a95-112">Inizia con la [visualizzazione di dati con ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) dell'esercitazione, è stato illustrato come usare controllo ObjectDataSource di ASP.NET 2.0 s nuovo in modo dichiarativo interfacciarsi con l'architettura dal livello di presentazione.</span><span class="sxs-lookup"><span data-stu-id="f7a95-112">Starting with the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) tutorial, we saw how to use ASP.NET 2.0 s new ObjectDataSource control to declaratively interface with the architecture from the presentation layer.</span></span>

<span data-ttu-id="f7a95-113">Mentre tutte le esercitazioni finora hanno usato l'architettura per lavorare con i dati, è anche possibile accedere, inserire, aggiornare ed eliminare i dati del database direttamente da una pagina ASP.NET, ignorando l'architettura.</span><span class="sxs-lookup"><span data-stu-id="f7a95-113">While all of the tutorials so far have used the architecture to work with data, it is also possible to access, insert, update, and delete database data directly from an ASP.NET page, bypassing the architecture.</span></span> <span data-ttu-id="f7a95-114">Questa operazione inserisce le query di database specifico e la logica di business direttamente nella pagina web.</span><span class="sxs-lookup"><span data-stu-id="f7a95-114">Doing so places the specific database queries and business logic directly in the web page.</span></span> <span data-ttu-id="f7a95-115">Per le applicazioni sufficientemente ampio e complesse, progettazione, implementazione e usa un'architettura a più livelli è estremamente importante per l'esito positivo, degli aggiornamenti e la manutenibilità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f7a95-115">For sufficiently large or complex applications, designing, implementing, and using a tiered architecture is vitally important for the success, updatability, and maintainability of the application.</span></span> <span data-ttu-id="f7a95-116">Sviluppa un'architettura solida, tuttavia, potrebbe non essere necessario quando si creano applicazioni estremamente semplici e singole.</span><span class="sxs-lookup"><span data-stu-id="f7a95-116">Developing a robust architecture, however, may be unnecessary when creating exceedingly simple, one-off applications.</span></span>

<span data-ttu-id="f7a95-117">ASP.NET 2.0 fornisce controlli origine dati incorporati cinque [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), e [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="f7a95-117">ASP.NET 2.0 provides five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span></span> <span data-ttu-id="f7a95-118">SqlDataSource è utilizzabile per accedere e modificare i dati direttamente da un database relazionale, tra cui Microsoft SQL Server, Microsoft Access, Oracle, MySQL e altri utenti.</span><span class="sxs-lookup"><span data-stu-id="f7a95-118">The SqlDataSource can be used to access and modify data directly from a relational database, including Microsoft SQL Server, Microsoft Access, Oracle, MySQL, and others.</span></span> <span data-ttu-id="f7a95-119">In questa esercitazione e i successivi tre, verrà esaminato come utilizzare il controllo SqlDataSource, esplorazione come eseguire una query e filtrare i dati di database, nonché come utilizzare SqlDataSource per inserire, aggiornare ed eliminare dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-119">In this tutorial and the next three, we'll examine how to work with the SqlDataSource control, exploring how to query and filter database data, as well as how to use the SqlDataSource to insert, update, and delete data.</span></span>

![ASP.NET 2.0 include cinque controlli origine dati incorporata](querying-data-with-the-sqldatasource-control-cs/_static/image1.gif)

<span data-ttu-id="f7a95-121">**Figura 1**: ASP.NET 2.0 include cinque controlli origine dati incorporata</span><span class="sxs-lookup"><span data-stu-id="f7a95-121">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>

## <a name="comparing-the-objectdatasource-and-sqldatasource"></a><span data-ttu-id="f7a95-122">Confronto tra la ObjectDataSource e SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="f7a95-122">Comparing the ObjectDataSource and SqlDataSource</span></span>

<span data-ttu-id="f7a95-123">Concettualmente, i controlli di ObjectDataSource e SqlDataSource sono semplicemente i proxy ai dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-123">Conceptually, both the ObjectDataSource and SqlDataSource controls are simply proxies to data.</span></span> <span data-ttu-id="f7a95-124">Come descritto nel [visualizzazione di dati con ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) esercitazione ObjectDataSource ha proprietà che indicano il tipo di oggetto che fornisce i dati e i metodi da richiamare per selezionare, inserire, aggiornare ed eliminare dati il tipo di oggetto sottostante.</span><span class="sxs-lookup"><span data-stu-id="f7a95-124">As discussed in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) tutorial, the ObjectDataSource has properties that indicate the object type that provides the data and the methods to invoke to select, insert, update, and delete data from the underlying object type.</span></span> <span data-ttu-id="f7a95-125">Dopo aver configurate le proprietà di ObjectDataSource s, un controllo Web, ad esempio un controllo GridView, DetailsView o DataList dati possono essere associati al controllo, usando gli oggetti ObjectDataSource `Select()`, `Insert()`, `Delete()`, e `Update()` metodi interagire con l'architettura sottostante.</span><span class="sxs-lookup"><span data-stu-id="f7a95-125">Once the ObjectDataSource s properties have been configured, a data Web control such as a GridView, DetailsView, or DataList can be bound to the control, using the ObjectDataSource s `Select()`, `Insert()`, `Delete()`, and `Update()` methods to interact with the underlying architecture.</span></span>

<span data-ttu-id="f7a95-126">SqlDataSource fornisce la stessa funzionalità, ma viene eseguito su un database relazionale piuttosto che una libreria di oggetti.</span><span class="sxs-lookup"><span data-stu-id="f7a95-126">The SqlDataSource provides the same functionality, but operates against a relational database rather than an object library.</span></span> <span data-ttu-id="f7a95-127">Con SqlDataSource, è necessario specificare la stringa di connessione di database e le query SQL ad hoc o le stored procedure da eseguire per inserire, aggiornare, eliminare e recuperare i dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-127">With the SqlDataSource, we must specify the database connection string and the ad-hoc SQL queries or stored procedures to execute to insert, update, delete, and retrieve data.</span></span> <span data-ttu-id="f7a95-128">Le s SqlDataSource `Select()`, `Insert()`, `Update()`, e `Delete()` metodi, quando richiamata, connettersi al database specificato ed eseguire la query SQL appropriata.</span><span class="sxs-lookup"><span data-stu-id="f7a95-128">The SqlDataSource s `Select()`, `Insert()`, `Update()`, and `Delete()` methods, when invoked, connect to the specified database and issue the appropriate SQL query.</span></span> <span data-ttu-id="f7a95-129">Come illustrato nel diagramma seguente, questi metodi eseguono il noioso compito di connessione a un database, esegue una query e restituzione dei risultati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-129">As the following diagram illustrates, the these methods do the grunt work of connecting to a database, issuing a query, and returning the results.</span></span>

![SqlDataSource funge da Proxy per il Database](querying-data-with-the-sqldatasource-control-cs/_static/image2.gif)

<span data-ttu-id="f7a95-131">**Figura 2**: SqlDataSource funge da Proxy per il Database</span><span class="sxs-lookup"><span data-stu-id="f7a95-131">**Figure 2**: The SqlDataSource Serves as a Proxy to the Database</span></span>

> [!NOTE]
> <span data-ttu-id="f7a95-132">In questa esercitazione ci concentreremo sul recupero dei dati dal database.</span><span class="sxs-lookup"><span data-stu-id="f7a95-132">In this tutorial we'll focus on retrieving data from the database.</span></span> <span data-ttu-id="f7a95-133">Nel [inserimento, aggiornamento ed eliminazione di dati con il controllo SqlDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-cs.md) dell'esercitazione, si vedrà come configurare SqlDataSource per supportare l'inserimento, aggiornamento ed eliminazione.</span><span class="sxs-lookup"><span data-stu-id="f7a95-133">In the [Inserting, Updating, and Deleting Data with the SqlDataSource Control](inserting-updating-and-deleting-data-with-the-sqldatasource-cs.md) tutorial, we'll see how to configure the SqlDataSource to support inserting, updating, and deleting.</span></span>

## <a name="the-sqldatasource-and-accessdatasource-controls"></a><span data-ttu-id="f7a95-134">I controlli di AccessDataSource e SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="f7a95-134">The SqlDataSource and AccessDataSource Controls</span></span>

<span data-ttu-id="f7a95-135">Oltre al controllo SqlDataSource, ASP.NET 2.0 include anche un controllo AccessDataSource.</span><span class="sxs-lookup"><span data-stu-id="f7a95-135">In addition to the SqlDataSource control, ASP.NET 2.0 also includes an AccessDataSource control.</span></span> <span data-ttu-id="f7a95-136">Questi due diversi controlli causare molti sviluppatori familiarità con ASP.NET 2.0 sospettare che il controllo AccessDataSource è progettato per funzionare esclusivamente con Microsoft Access con il controllo SqlDataSource progettato per funzionare in modo esclusivo con Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f7a95-136">These two different controls lead many developers new to ASP.NET 2.0 to suspect that the AccessDataSource control is designed to work exclusively with Microsoft Access with the SqlDataSource control designed to work exclusively with Microsoft SQL Server.</span></span> <span data-ttu-id="f7a95-137">Sebbene il AccessDataSource è progettato per funzionare in modo specifico con Microsoft Access, il controllo SqlDataSource funziona con *qualsiasi* database relazionale in cui è possibile accedere tramite .NET.</span><span class="sxs-lookup"><span data-stu-id="f7a95-137">While the AccessDataSource is designed to work specifically with Microsoft Access, the SqlDataSource control works with *any* relational database that can be accessed through .NET.</span></span> <span data-ttu-id="f7a95-138">Ciò include qualsiasi archivi dati OLE DB o ODBC conformi a, ad esempio Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL e PostgreSQL, tra le molte altre.</span><span class="sxs-lookup"><span data-stu-id="f7a95-138">This includes any OleDb- or ODBC-compliant data stores, such as Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL, and PostgreSQL, among many others.</span></span>

<span data-ttu-id="f7a95-139">L'unica differenza tra i controlli SqlDataSource e AccessDataSource è come specificare le informazioni di connessione del database.</span><span class="sxs-lookup"><span data-stu-id="f7a95-139">The sole difference between the AccessDataSource and SqlDataSource controls is how the database connection information is specified.</span></span> <span data-ttu-id="f7a95-140">Il controllo AccessDataSource richiede solo il percorso di file al file di database di Access.</span><span class="sxs-lookup"><span data-stu-id="f7a95-140">The AccessDataSource control needs just the file path to the Access database file.</span></span> <span data-ttu-id="f7a95-141">SqlDataSource, d'altra parte, richiede una stringa di connessione completa.</span><span class="sxs-lookup"><span data-stu-id="f7a95-141">The SqlDataSource, on the other hand, requires a complete connection string.</span></span>

## <a name="step-1-creating-the-sqldatasource-web-pages"></a><span data-ttu-id="f7a95-142">Passaggio 1: Creazione di pagine Web SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="f7a95-142">Step 1: Creating the SqlDataSource Web Pages</span></span>

<span data-ttu-id="f7a95-143">Prima di iniziare a esplorare come lavorare direttamente con i dati di database usando il controllo SqlDataSource, consentire s prima di tutto si consiglia di creare le pagine ASP.NET nel progetto di sito Web che è necessario per questa esercitazione e i successivi tre.</span><span class="sxs-lookup"><span data-stu-id="f7a95-143">Before we start exploring how to work directly with database data using the SqlDataSource control, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="f7a95-144">Iniziare aggiungendo una nuova cartella denominata `SqlDataSource`.</span><span class="sxs-lookup"><span data-stu-id="f7a95-144">Start by adding a new folder named `SqlDataSource`.</span></span> <span data-ttu-id="f7a95-145">Successivamente, aggiungere le seguenti pagine ASP.NET per quella cartella, assicurandosi di associare ogni pagina con il `Site.master` pagina master:</span><span class="sxs-lookup"><span data-stu-id="f7a95-145">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Querying.aspx`
- `ParameterizedQueries.aspx`
- `InsertUpdateDelete.aspx`
- `OptimisticConcurrency.aspx`

![Aggiungere le pagine ASP.NET per le esercitazioni relative alla SqlDataSource](querying-data-with-the-sqldatasource-control-cs/_static/image3.gif)

<span data-ttu-id="f7a95-147">**Figura 3**: Aggiungere le pagine ASP.NET per le esercitazioni relative alla SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="f7a95-147">**Figure 3**: Add the ASP.NET Pages for the SqlDataSource-Related Tutorials</span></span>

<span data-ttu-id="f7a95-148">In altre cartelle, analogo a `Default.aspx` nella `SqlDataSource` cartella elencherà le esercitazioni nella relativa sezione.</span><span class="sxs-lookup"><span data-stu-id="f7a95-148">Like in the other folders, `Default.aspx` in the `SqlDataSource` folder will list the tutorials in its section.</span></span> <span data-ttu-id="f7a95-149">Si tenga presente che il `SectionLevelTutorialListing.ascx` controllo utente fornisce questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="f7a95-149">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="f7a95-150">Pertanto, aggiungere questo controllo utente da `Default.aspx` trascinandolo da Esplora soluzioni nella pagina di visualizzazione della struttura s.</span><span class="sxs-lookup"><span data-stu-id="f7a95-150">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="f7a95-151">[![Aggiungere il controllo utente sectionleveltutoriallisting. ascx a default. aspx](querying-data-with-the-sqldatasource-control-cs/_static/image5.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image4.gif)</span><span class="sxs-lookup"><span data-stu-id="f7a95-151">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](querying-data-with-the-sqldatasource-control-cs/_static/image5.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image4.gif)</span></span>

<span data-ttu-id="f7a95-152">**Figura 4**: Aggiungere il `SectionLevelTutorialListing.ascx` controllo utente da `Default.aspx` ([fare clic per visualizzare l'immagine con dimensioni normali](querying-data-with-the-sqldatasource-control-cs/_static/image6.gif))</span><span class="sxs-lookup"><span data-stu-id="f7a95-152">**Figure 4**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](querying-data-with-the-sqldatasource-control-cs/_static/image6.gif))</span></span>

<span data-ttu-id="f7a95-153">Infine, aggiungere questi quattro pagine come voci per il `Web.sitemap` file.</span><span class="sxs-lookup"><span data-stu-id="f7a95-153">Lastly, add these four pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="f7a95-154">In particolare, aggiungere il markup seguente dopo l'aggiunta di pulsanti personalizzati con DataList e Repeater `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="f7a95-154">Specifically, add the following markup after the Adding Custom Buttons to the DataList and Repeater `<siteMapNode>`:</span></span>

[!code-sql[Main](querying-data-with-the-sqldatasource-control-cs/samples/sample1.sql)]

<span data-ttu-id="f7a95-155">Dopo aver aggiornato `Web.sitemap`, si consiglia di visualizzare il sito Web di esercitazioni tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="f7a95-155">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="f7a95-156">Il menu a sinistra ora include elementi per la modifica, inserimento ed eliminazione di esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="f7a95-156">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![Mappa del sito include ora voci per le esercitazioni SqlDataSource](querying-data-with-the-sqldatasource-control-cs/_static/image7.gif)

<span data-ttu-id="f7a95-158">**Figura 5**: Mappa del sito include ora voci per le esercitazioni SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="f7a95-158">**Figure 5**: The Site Map Now Includes Entries for the SqlDataSource Tutorials</span></span>

## <a name="step-2-adding-and-configuring-the-sqldatasource-control"></a><span data-ttu-id="f7a95-159">Passaggio 2: Aggiunta e configurazione del controllo SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="f7a95-159">Step 2: Adding and Configuring the SqlDataSource Control</span></span>

<span data-ttu-id="f7a95-160">Iniziare aprendo il `Querying.aspx` nella pagina di `SqlDataSource` cartella e passare alla visualizzazione progettazione.</span><span class="sxs-lookup"><span data-stu-id="f7a95-160">Start by opening the `Querying.aspx` page in the `SqlDataSource` folder and switch to Design view.</span></span> <span data-ttu-id="f7a95-161">Trascinare un controllo SqlDataSource dalla casella degli strumenti nella finestra di progettazione e set relativo `ID` a `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="f7a95-161">Drag a SqlDataSource control from the Toolbox onto the Designer and set its `ID` to `ProductsDataSource`.</span></span> <span data-ttu-id="f7a95-162">Come con ObjectDataSource, SqlDataSource non genera alcun output sottoposto a rendering e pertanto viene visualizzato come un riquadro grigio nell'area di progettazione.</span><span class="sxs-lookup"><span data-stu-id="f7a95-162">As with the ObjectDataSource, the SqlDataSource does not produce any rendered output and therefore appears as a gray box on the design surface.</span></span> <span data-ttu-id="f7a95-163">Per configurare SqlDataSource, fare clic sul collegamento Configura origine dati nello smart tag SqlDataSource s.</span><span class="sxs-lookup"><span data-stu-id="f7a95-163">To configure the SqlDataSource, click on the Configure Data Source link from the SqlDataSource s smart tag.</span></span>

![Scegliere il collegamento Configura origine dati nello Smart tag s SqlDataSource](querying-data-with-the-sqldatasource-control-cs/_static/image8.gif)

<span data-ttu-id="f7a95-165">**Figura 6**: Scegliere il collegamento Configura origine dati nello Smart tag s SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="f7a95-165">**Figure 6**: Click on the Configure Data Source Link from the SqlDataSource s Smart Tag</span></span>

<span data-ttu-id="f7a95-166">Verrà visualizzata la procedura guidata Configura origine dati di s controllo SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="f7a95-166">This brings up the SqlDataSource control s Configure Data Source wizard.</span></span> <span data-ttu-id="f7a95-167">Durante la procedura guidata s diversa dal controllo ObjectDataSource s, l'obiettivo finale è lo stesso per fornire i dettagli su come recuperare, inserire, aggiornare ed eliminare dati tramite l'origine dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-167">While the wizard s steps differ from the ObjectDataSource control s, the end goal is the same to provide the details on how to retrieve, insert, update, and delete data through the data source.</span></span> <span data-ttu-id="f7a95-168">Per SqlDataSource questo comporta che specifica il database sottostante da utilizzare e che forniscono le istruzioni SQL ad hoc o le stored procedure.</span><span class="sxs-lookup"><span data-stu-id="f7a95-168">For the SqlDataSource this entails specifying the underlying database to use and providing the ad-hoc SQL statements or stored procedures.</span></span>

<span data-ttu-id="f7a95-169">Il primo passaggio della procedura guidata richiede il database.</span><span class="sxs-lookup"><span data-stu-id="f7a95-169">The first wizard step prompts us for the database.</span></span> <span data-ttu-id="f7a95-170">L'elenco di riepilogo a discesa include tali database trovati in s dell'applicazione web `App_Data` cartella e quelli che sono state aggiunte al nodo Connessioni dati in Esplora Server.</span><span class="sxs-lookup"><span data-stu-id="f7a95-170">The drop-down list includes those databases found in the web application s `App_Data` folder and those that have been added to the Data Connections node in the Server Explorer.</span></span> <span data-ttu-id="f7a95-171">Poiché è stato aggiunto già una stringa di connessione per il `NORTHWIND.MDF` del database nel `App_Data` cartella al nostro progetto s `Web.config` file, nell'elenco a discesa include un riferimento a tale stringa di connessione, `NORTHWINDConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="f7a95-171">Since we ve already added a connection string for the `NORTHWIND.MDF` database in the `App_Data` folder to our project s `Web.config` file, the drop-down list includes a reference to that connection string, `NORTHWINDConnectionString`.</span></span> <span data-ttu-id="f7a95-172">Scegliere questa voce dall'elenco a discesa elenco e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="f7a95-172">Choose this item from the drop-down list and click Next.</span></span>

![Scegliere il NORTHWINDConnectionString dall'elenco a discesa](querying-data-with-the-sqldatasource-control-cs/_static/image9.gif)

<span data-ttu-id="f7a95-174">**Figura 7**: Scegliere il `NORTHWINDConnectionString` nell'elenco a discesa</span><span class="sxs-lookup"><span data-stu-id="f7a95-174">**Figure 7**: Choose the `NORTHWINDConnectionString` from the Drop-Down List</span></span>

<span data-ttu-id="f7a95-175">Dopo aver scelto il database, la procedura guidata richiede la query restituire i dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-175">After choosing the database, the wizard asks for the query to return data.</span></span> <span data-ttu-id="f7a95-176">È possibile specificare le colonne di una tabella o vista per restituire può immettere un'istruzione SQL personalizzata o specificare una stored procedure.</span><span class="sxs-lookup"><span data-stu-id="f7a95-176">We can either specify the columns of a table or view to return or can enter a custom SQL statement or specify a stored procedure.</span></span> <span data-ttu-id="f7a95-177">È possibile alternare questa scelta tramite la specifica un'istruzione SQL personalizzata o stored procedure e specificare le colonne da una tabella o visualizzare i pulsanti di opzione.</span><span class="sxs-lookup"><span data-stu-id="f7a95-177">You can toggle between this choice through the Specify a custom SQL statement or stored procedure and Specify columns from a table or view radio buttons.</span></span>

> [!NOTE]
> <span data-ttu-id="f7a95-178">Per questo primo esempio, consentire s utilizzare il specificare le colonne di un'opzione di tabella o vista.</span><span class="sxs-lookup"><span data-stu-id="f7a95-178">For this first example, let s use the Specify columns from a table or view option.</span></span> <span data-ttu-id="f7a95-179">Verrà restituito alla procedura guidata più avanti in questa esercitazione ed esplorare specifica un'opzione della stored procedure o un'istruzione SQL personalizzata.</span><span class="sxs-lookup"><span data-stu-id="f7a95-179">We'll return to the wizard later in this tutorial and explore the Specify a custom SQL statement or stored procedure option.</span></span>

<span data-ttu-id="f7a95-180">Figura 8 Mostra configura la schermata di istruzione Select quando è selezionata la specificare le colonne di un pulsante di opzione di tabella o vista.</span><span class="sxs-lookup"><span data-stu-id="f7a95-180">Figure 8 shows the Configure the Select Statement screen when the Specify columns from a table or view radio button is selected.</span></span> <span data-ttu-id="f7a95-181">L'elenco a discesa contiene il set di tabelle e viste nel database Northwind, con la tabella selezionata o colonne della vista s visualizzate nell'elenco casella di controllo seguente.</span><span class="sxs-lookup"><span data-stu-id="f7a95-181">The drop-down list contains the set of tables and views in the Northwind database, with the selected table or view s columns displayed in the checkbox list below.</span></span> <span data-ttu-id="f7a95-182">Per questo esempio, restituire let s il `ProductID`, `ProductName`, e `UnitPrice` le colonne dai `Products` tabella.</span><span class="sxs-lookup"><span data-stu-id="f7a95-182">For this example, let s return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table.</span></span> <span data-ttu-id="f7a95-183">Come illustrato nella figura 8, dopo la procedura guidata queste selezioni Mostra l'istruzione SQL risultante `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span><span class="sxs-lookup"><span data-stu-id="f7a95-183">As Figure 8 shows, after making these selections the wizard shows the resulting SQL statement `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span></span>

![Restituire i dati dalla tabella Products](querying-data-with-the-sqldatasource-control-cs/_static/image10.gif)

<span data-ttu-id="f7a95-185">**Figura 8**: Dati restituiti dai `Products` tabella</span><span class="sxs-lookup"><span data-stu-id="f7a95-185">**Figure 8**: Return Data from the `Products` Table</span></span>

<span data-ttu-id="f7a95-186">Dopo aver configurato la procedura guidata per restituire il `ProductID`, `ProductName`, e `UnitPrice` le colonne dai `Products` , fare clic sul pulsante Avanti.</span><span class="sxs-lookup"><span data-stu-id="f7a95-186">Once you have configured the wizard to return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table, click the Next button.</span></span> <span data-ttu-id="f7a95-187">Questa schermata finale fornisce un'opportunità per esaminare i risultati della query configurato nel passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="f7a95-187">This final screen provides an opportunity to examine the results of the query configured from the previous step.</span></span> <span data-ttu-id="f7a95-188">Fare clic sul pulsante Query di Test viene eseguita l'applicazione configurata `SELECT` istruzione e consente di visualizzare i risultati in una griglia.</span><span class="sxs-lookup"><span data-stu-id="f7a95-188">Clicking the Test Query button executes the configured `SELECT` statement and displays the results in a grid.</span></span>

![Fare clic sul pulsante Query di prova per rivedere la Query SELECT](querying-data-with-the-sqldatasource-control-cs/_static/image11.gif)

<span data-ttu-id="f7a95-190">**Figura 9**: Fare clic sul pulsante Query di Test per la revisione di `SELECT` Query</span><span class="sxs-lookup"><span data-stu-id="f7a95-190">**Figure 9**: Click the Test Query Button to Review Your `SELECT` Query</span></span>

<span data-ttu-id="f7a95-191">Per completare la procedura guidata, fare clic su Fine.</span><span class="sxs-lookup"><span data-stu-id="f7a95-191">To complete the wizard, click Finish.</span></span>

<span data-ttu-id="f7a95-192">Come con ObjectDataSource, la procedura guidata s SqlDataSource si limita ad assegna valori alle proprietà del controllo del codice s, vale a dire il [ `ConnectionString` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) e [ `SelectCommand` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) proprietà.</span><span class="sxs-lookup"><span data-stu-id="f7a95-192">Like with the ObjectDataSource, the SqlDataSource s wizard merely assigns values to the control s properties, namely the [`ConnectionString`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) and [`SelectCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) properties.</span></span> <span data-ttu-id="f7a95-193">Dopo aver completato la procedura guidata, il markup dichiarativo del controllo s SqlDataSource dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="f7a95-193">After completing the wizard, your SqlDataSource control s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-cs/samples/sample2.aspx)]

<span data-ttu-id="f7a95-194">Il `ConnectionString` proprietà fornisce informazioni su come connettersi al database.</span><span class="sxs-lookup"><span data-stu-id="f7a95-194">The `ConnectionString` property provides information on how to connect to the database.</span></span> <span data-ttu-id="f7a95-195">Questa proprietà può essere assegnata un valore di stringa di connessione completa a livello di codice oppure può puntare a una stringa di connessione in `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="f7a95-195">This property can be assigned a complete, hard-coded connection string value or can point to a connection string in `Web.config`.</span></span> <span data-ttu-id="f7a95-196">Per fare riferimento a un valore di stringa di connessione nel file Web. config, usare la sintassi `<%$ expressionPrefix:expressionValue %>`.</span><span class="sxs-lookup"><span data-stu-id="f7a95-196">To reference a connection string value in Web.config, use the syntax `<%$ expressionPrefix:expressionValue %>`.</span></span> <span data-ttu-id="f7a95-197">In genere *expressionPrefix* è ConnectionStrings e *expressionValue* è il nome della stringa di connessione nel `Web.config` [ `<connectionStrings>` sezione](https://msdn.microsoft.com/library/bf7sd233.aspx).</span><span class="sxs-lookup"><span data-stu-id="f7a95-197">Typically, *expressionPrefix* is ConnectionStrings and *expressionValue* is the name of the connect string in the `Web.config` [`<connectionStrings>` section](https://msdn.microsoft.com/library/bf7sd233.aspx).</span></span> <span data-ttu-id="f7a95-198">Tuttavia, è possibile usare la sintassi per fare riferimento a `<appSettings>` elementi o il contenuto dai file di risorse.</span><span class="sxs-lookup"><span data-stu-id="f7a95-198">However, the syntax can be used to reference `<appSettings>` elements or content from resource files.</span></span> <span data-ttu-id="f7a95-199">Visualizzare [Panoramica di espressioni ASP.NET](https://msdn.microsoft.com/library/d5bd1tad.aspx) per altre informazioni su questa sintassi.</span><span class="sxs-lookup"><span data-stu-id="f7a95-199">See [ASP.NET Expressions Overview](https://msdn.microsoft.com/library/d5bd1tad.aspx) for more on this syntax.</span></span>

<span data-ttu-id="f7a95-200">Il `SelectCommand` proprietà consente di specificare l'istruzione SQL ad hoc o stored procedure da eseguire per restituire i dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-200">The `SelectCommand` property specifies the ad-hoc SQL statement or stored procedure to execute to return the data.</span></span>

## <a name="step-3-adding-a-data-web-control-and-binding-it-to-the-sqldatasource"></a><span data-ttu-id="f7a95-201">Passaggio 3: Aggiunta di un controllo Web e associarla a SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="f7a95-201">Step 3: Adding a Data Web Control and Binding it to the SqlDataSource</span></span>

<span data-ttu-id="f7a95-202">Dopo aver configurato il SqlDataSource, può essere associato a un controllo Web, ad esempio un controllo GridView o DetailsView di dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-202">Once the SqlDataSource has been configured, it can be bound to a data Web control, such as a GridView or DetailsView.</span></span> <span data-ttu-id="f7a95-203">Per questa esercitazione, lasciare s visualizzare i dati in un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="f7a95-203">For this tutorial, let s display the data in a GridView.</span></span> <span data-ttu-id="f7a95-204">Dalla casella degli strumenti, trascinare un controllo GridView sulla pagina e associarlo al `ProductsDataSource` SqlDataSource scegliendo l'origine dati nell'elenco a discesa nello smart tag s GridView.</span><span class="sxs-lookup"><span data-stu-id="f7a95-204">From the Toolbox, drag a GridView onto the page and bind it to the `ProductsDataSource` SqlDataSource by choosing the data source from the drop-down list in the GridView s smart tag.</span></span>

<span data-ttu-id="f7a95-205">[![Aggiungere un controllo GridView e associarlo al controllo SqlDataSource](querying-data-with-the-sqldatasource-control-cs/_static/image13.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image12.gif)</span><span class="sxs-lookup"><span data-stu-id="f7a95-205">[![Add a GridView and Bind it to the SqlDataSource Control](querying-data-with-the-sqldatasource-control-cs/_static/image13.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image12.gif)</span></span>

<span data-ttu-id="f7a95-206">**Figura 10**: Aggiungere un controllo GridView e associarlo al controllo SqlDataSource ([fare clic per visualizzare l'immagine con dimensioni normali](querying-data-with-the-sqldatasource-control-cs/_static/image14.gif))</span><span class="sxs-lookup"><span data-stu-id="f7a95-206">**Figure 10**: Add a GridView and Bind it to the SqlDataSource Control ([Click to view full-size image](querying-data-with-the-sqldatasource-control-cs/_static/image14.gif))</span></span>

<span data-ttu-id="f7a95-207">Dopo che è già selezionato il controllo SqlDataSource dall'elenco a discesa nello smart tag s GridView, Visual Studio aggiungerà automaticamente un BoundField o CampoCasellaDiControllo a GridView per ognuna delle colonne restituite dal controllo origine dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-207">Once you ve selected the SqlDataSource control from the drop-down list in the GridView s smart tag, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the columns returned by the data source control.</span></span> <span data-ttu-id="f7a95-208">Poiché SqlDataSource restituisce tre colonne di database `ProductID`, `ProductName`, e `UnitPrice` nel GridView sono presenti tre campi.</span><span class="sxs-lookup"><span data-stu-id="f7a95-208">Since the SqlDataSource returns three database columns `ProductID`, `ProductName`, and `UnitPrice` there are three fields in the GridView.</span></span>

<span data-ttu-id="f7a95-209">Si consiglia di configurare i dispositivi di GridView tre BoundField.</span><span class="sxs-lookup"><span data-stu-id="f7a95-209">Take a moment to configure the GridView s three BoundFields.</span></span> <span data-ttu-id="f7a95-210">Modifica il `ProductName` il campo s `HeaderText` proprietà per nome prodotto e `UnitPrice` il campo s al prezzo.</span><span class="sxs-lookup"><span data-stu-id="f7a95-210">Change the `ProductName` field s `HeaderText` property to Product Name and the `UnitPrice` field s to Price.</span></span> <span data-ttu-id="f7a95-211">Anche formattare i `UnitPrice` campo come valuta.</span><span class="sxs-lookup"><span data-stu-id="f7a95-211">Also format the `UnitPrice` field as a currency.</span></span> <span data-ttu-id="f7a95-212">Dopo aver apportato queste modifiche, il markup dichiarativo di GridView s dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="f7a95-212">After making these modifications, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-cs/samples/sample3.aspx)]

<span data-ttu-id="f7a95-213">Visitare questa pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="f7a95-213">Visit this page through a browser.</span></span> <span data-ttu-id="f7a95-214">Come illustrato nella figura 11, il controllo GridView Elenca ogni prodotto 1!s `ProductID`, `ProductName`, e `UnitPrice` valori.</span><span class="sxs-lookup"><span data-stu-id="f7a95-214">As Figure 11 shows, the GridView lists each product s `ProductID`, `ProductName`, and `UnitPrice` values.</span></span>

<span data-ttu-id="f7a95-215">[![GridView Visualizza ogni prodotto s ProductID, ProductName e valori UnitPrice](querying-data-with-the-sqldatasource-control-cs/_static/image16.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image15.gif)</span><span class="sxs-lookup"><span data-stu-id="f7a95-215">[![The GridView Displays Each Product s ProductID, ProductName, and UnitPrice Values](querying-data-with-the-sqldatasource-control-cs/_static/image16.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image15.gif)</span></span>

<span data-ttu-id="f7a95-216">**Figura 11**: Le s GridView Visualizza ogni prodotto `ProductID`, `ProductName`, e `UnitPrice` valori ([fare clic per visualizzare l'immagine con dimensioni normali](querying-data-with-the-sqldatasource-control-cs/_static/image17.gif))</span><span class="sxs-lookup"><span data-stu-id="f7a95-216">**Figure 11**: The GridView Displays Each Product s `ProductID`, `ProductName`, and `UnitPrice` Values ([Click to view full-size image](querying-data-with-the-sqldatasource-control-cs/_static/image17.gif))</span></span>

<span data-ttu-id="f7a95-217">Quando si visita la pagina di GridView richiama il controllo del codice sorgente dati s `Select()` (metodo).</span><span class="sxs-lookup"><span data-stu-id="f7a95-217">When the page is visited the GridView invokes its data source control s `Select()` method.</span></span> <span data-ttu-id="f7a95-218">Quando si stava usando il controllo ObjectDataSource, questa chiamata il `ProductsBLL` classe s `GetProducts()` (metodo).</span><span class="sxs-lookup"><span data-stu-id="f7a95-218">When we were using the ObjectDataSource control, this called the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="f7a95-219">Con SqlDataSource, tuttavia, il `Select()` metodo stabilisce una connessione al database specificato e i problemi il `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, in questo esempio).</span><span class="sxs-lookup"><span data-stu-id="f7a95-219">With the SqlDataSource, however, the `Select()` method establishes a connection to the specified database and issues the `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, in this example).</span></span> <span data-ttu-id="f7a95-220">SqlDataSource restituisce i risultati che il controllo GridView viene enumerato, creazione di una riga in GridView per ogni record di database restituiti.</span><span class="sxs-lookup"><span data-stu-id="f7a95-220">The SqlDataSource returns its results which the GridView then enumerates, creating a row in the GridView for each database record returned.</span></span>

## <a name="the-built-in-data-web-control-features-and-the-sqldatasource-control"></a><span data-ttu-id="f7a95-221">Le funzionalità di controllo Web di dati incorporato e il controllo SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="f7a95-221">The Built-In Data Web Control Features and the SqlDataSource Control</span></span>

<span data-ttu-id="f7a95-222">In generale, le funzionalità intrinseche per i dati di paging, ordinamento, modifica, i controlli Web l'eliminazione, inserimento e così via sono specifiche per il controllo Web per dati e non dipendono dal controllo origine dati usato.</span><span class="sxs-lookup"><span data-stu-id="f7a95-222">In general, the features inherent to the data Web controls paging, sorting, editing, deleting, inserting, and so on are specific to the data Web control and are not dependent on the data source control used.</span></span> <span data-ttu-id="f7a95-223">Vale a dire, il controllo GridView può utilizzare relativo predefinito di paging, ordinamento, modifica ed eliminazione se è associato a ObjectDataSource o un SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="f7a95-223">That is, the GridView can utilize its built-in paging, sorting, editing, and deleting whether it is bound to an ObjectDataSource or a SqlDataSource.</span></span> <span data-ttu-id="f7a95-224">Tuttavia, determinati funzionalità di controllo Web i dati sono riservati per il controllo origine dati in uso o per la configurazione di controllo del codice s dell'origine dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-224">However, certain data Web control features are sensitive to the data source control being used or to the data source control s configuration.</span></span>

<span data-ttu-id="f7a95-225">Ad esempio, nel [in modo efficiente il Paging attraverso quantità di dati di grandi dimensioni](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) esercitazione è stata illustrata la procedura, per impostazione predefinita, la logica di paging per i dati Web controlla gestire restituisce *tutti* i record da sottostante origine dati e quindi visualizzano solo il subset appropriato di record specificato l'indice della pagina corrente e il numero di record da visualizzare per pagina.</span><span class="sxs-lookup"><span data-stu-id="f7a95-225">For example, in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) tutorial we discussed how, by default, the paging logic for the data Web controls naively returns *all* records from the underlying data source and then displays only the appropriate subset of records given the current page index and the number of records to display per page.</span></span> <span data-ttu-id="f7a95-226">Questo modello è particolarmente inefficiente quando paging dei set di risultati sufficientemente grandi.</span><span class="sxs-lookup"><span data-stu-id="f7a95-226">This model is highly inefficient when paging through sufficiently large result sets.</span></span> <span data-ttu-id="f7a95-227">Fortunatamente, ObjectDataSource può essere configurati per supportare il paging personalizzato, che restituisce solo il subset preciso di record da visualizzare.</span><span class="sxs-lookup"><span data-stu-id="f7a95-227">Fortunately, the ObjectDataSource can be configured to support custom paging, which returns only the precise subset of records to display.</span></span> <span data-ttu-id="f7a95-228">Il controllo SqlDataSource, tuttavia, non ha le proprietà per implementare il paging personalizzato.</span><span class="sxs-lookup"><span data-stu-id="f7a95-228">The SqlDataSource control, however, lacks the properties for implementing custom paging.</span></span>

<span data-ttu-id="f7a95-229">Si verifica un altro accorgimento con paging e ordinamento con SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="f7a95-229">Another subtlety with paging and sorting arises with the SqlDataSource.</span></span> <span data-ttu-id="f7a95-230">Per impostazione predefinita, i dati restituiti da un SqlDataSource possono essere di paging o ordinati tramite il controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="f7a95-230">By default, the data returned from a SqlDataSource can be paged or sorted through the GridView.</span></span> <span data-ttu-id="f7a95-231">Per dimostrare questo concetto, controllare le opzioni di abilitare il Paging e abilitare l'ordinamento in GridView s smart tag in `Querying.aspx` e verificare che funzioni come previsto.</span><span class="sxs-lookup"><span data-stu-id="f7a95-231">To demonstrate this, check the Enable Paging and Enable Sorting options in the GridView s smart tag in `Querying.aspx` and verify that this works as expected.</span></span>

<span data-ttu-id="f7a95-232">Ordinamento e paging funziona perché SqlDataSource recupera i dati di database in un set di dati non fortemente tipizzato.</span><span class="sxs-lookup"><span data-stu-id="f7a95-232">Sorting and paging works because the SqlDataSource retrieves the database data into a loosely-typed DataSet.</span></span> <span data-ttu-id="f7a95-233">Che è possibile ottenere il numero totale di record restituiti dalla query un aspetto essenziale per implementare il paging del set di dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-233">The total number of records returned by the query an essential aspect to implementing paging can be ascertained from the DataSet.</span></span> <span data-ttu-id="f7a95-234">Inoltre, i risultati di s set di dati possono essere ordinati tramite un oggetto DataView.</span><span class="sxs-lookup"><span data-stu-id="f7a95-234">Additionally, the DataSet s results can be sorted through a DataView.</span></span> <span data-ttu-id="f7a95-235">Queste funzionalità vengono usate da SqlDataSource automaticamente quando le richieste di GridView di paging o i dati ordinati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-235">These capabilities are automatically used by the SqlDataSource when the GridView requests paged or sorted data.</span></span>

<span data-ttu-id="f7a95-236">SqlDataSource può essere configurato per restituire un oggetto DataReader invece di un set di dati tramite la modifica relativa [ `DataSourceMode` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) dalla `DataSet` (predefinito) a `DataReader`.</span><span class="sxs-lookup"><span data-stu-id="f7a95-236">The SqlDataSource can be configured to return a DataReader instead of a DataSet by changing its [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) from `DataSet` (the default) to `DataReader`.</span></span> <span data-ttu-id="f7a95-237">Potrebbe essere preferito tramite un oggetto DataReader in situazioni quando si passano i risultati di s SqlDataSource al codice esistente che si aspetta un DataReader.</span><span class="sxs-lookup"><span data-stu-id="f7a95-237">Using a DataReader might be preferred in situations when passing the SqlDataSource s results to existing code that expects a DataReader.</span></span> <span data-ttu-id="f7a95-238">Inoltre, poiché DataReader sono oggetti notevolmente più semplici rispetto a set di dati, queste connessioni offrono prestazioni migliori.</span><span class="sxs-lookup"><span data-stu-id="f7a95-238">Furthermore, since DataReaders are considerably simpler objects than DataSets, they offer better performance.</span></span> <span data-ttu-id="f7a95-239">Se si apporta questa modifica, tuttavia, non è possibile ordinare il controllo Web per dati né pagina poiché SqlDataSource non è possibile verificare il numero di record viene restituito dalla query e neppure DataReader offrono tutte le tecniche per l'ordinamento dei dati restituiti.</span><span class="sxs-lookup"><span data-stu-id="f7a95-239">If you make this change, however, the data Web control can neither sort nor page since the SqlDataSource cannot ascertain how many records are returned by the query, nor does the DataReader offer any techniques for sorting the returned data.</span></span>

## <a name="step-4-using-a-custom-sql-statement-or-stored-procedure"></a><span data-ttu-id="f7a95-240">Passaggio 4: Utilizzando un'istruzione SQL personalizzata o una Stored Procedure</span><span class="sxs-lookup"><span data-stu-id="f7a95-240">Step 4: Using a Custom SQL Statement or Stored Procedure</span></span>

<span data-ttu-id="f7a95-241">Quando si configura il controllo SqlDataSource, la query utilizzata per restituire i dati può essere specificata in uno dei due approcci come un'istruzione SQL personalizzata o una stored procedure o come colonne di una tabella o vista esistente.</span><span class="sxs-lookup"><span data-stu-id="f7a95-241">When configuring the SqlDataSource control, the query used to return data can be specified in one of two approaches as a custom SQL statement or stored procedure, or as columns from an existing table or view.</span></span> <span data-ttu-id="f7a95-242">Nel passaggio 2 sono stati esaminati selezionando le colonne dai `Products` tabella.</span><span class="sxs-lookup"><span data-stu-id="f7a95-242">In Step 2 we examined selecting columns from the `Products` table.</span></span> <span data-ttu-id="f7a95-243">Let s spiega come usare un'istruzione SQL personalizzata.</span><span class="sxs-lookup"><span data-stu-id="f7a95-243">Let s look at using a custom SQL statement.</span></span>

<span data-ttu-id="f7a95-244">Aggiungere un altro controllo GridView di `Querying.aspx` pagina e scegliere di creare una nuova origine dati dall'elenco a discesa scegliere nello smart tag.</span><span class="sxs-lookup"><span data-stu-id="f7a95-244">Add another GridView control to the `Querying.aspx` page and choose to create a new data source from the drop-down list in the smart tag.</span></span> <span data-ttu-id="f7a95-245">Successivamente, indicare che i dati verranno prelevati da un database si creerà un nuovo controllo SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="f7a95-245">Next, indicate that the data will be pulled from a database this will create a new SqlDataSource control.</span></span> <span data-ttu-id="f7a95-246">Denominare il controllo `ProductsWithCategoryInfoDataSource`.</span><span class="sxs-lookup"><span data-stu-id="f7a95-246">Name the control `ProductsWithCategoryInfoDataSource`.</span></span>

![Creare un nuovo controllo SqlDataSource denominato ProductsWithCategoryInfoDataSource](querying-data-with-the-sqldatasource-control-cs/_static/image18.gif)

<span data-ttu-id="f7a95-248">**Figura 12**: Creare un nuovo controllo SqlDataSource denominato `ProductsWithCategoryInfoDataSource`</span><span class="sxs-lookup"><span data-stu-id="f7a95-248">**Figure 12**: Create a New SqlDataSource Control Named `ProductsWithCategoryInfoDataSource`</span></span>

<span data-ttu-id="f7a95-249">Nella schermata successiva viene chiesto di specificare per specificare il database.</span><span class="sxs-lookup"><span data-stu-id="f7a95-249">The next screen asks us to specify the database.</span></span> <span data-ttu-id="f7a95-250">Come è stato fatto nella figura 7, selezionare il `NORTHWINDConnectionString` dall'elenco a discesa elenco e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="f7a95-250">As we did back in Figure 7, select the `NORTHWINDConnectionString` from the drop-down list and click Next.</span></span> <span data-ttu-id="f7a95-251">Schermata di istruzione Select della configurazione, scegliere di specificare un pulsante di opzione di stored procedure o un'istruzione SQL personalizzata e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="f7a95-251">In the Configure the Select Statement screen, choose the Specify a custom SQL statement or stored procedure radio button and click Next.</span></span> <span data-ttu-id="f7a95-252">Verrà visualizzata la schermata di Stored procedure o definire istruzioni personalizzate, che offre schede: SELECT, UPDATE, INSERT e DELETE.</span><span class="sxs-lookup"><span data-stu-id="f7a95-252">This will bring up the Define Custom Statements or Stored Procedures screen, which offers tabs labeled SELECT, UPDATE, INSERT, and DELETE.</span></span> <span data-ttu-id="f7a95-253">In ogni scheda è possibile immettere un'istruzione SQL personalizzata nella casella di testo o scegliere una stored procedure dall'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="f7a95-253">In each tab you can enter a custom SQL statement into the textbox or choose a stored procedure from the drop-down list.</span></span> <span data-ttu-id="f7a95-254">In questa esercitazione si esaminerà immettendo un'istruzione SQL personalizzata. l'esercitazione successiva include un esempio che usa una stored procedure.</span><span class="sxs-lookup"><span data-stu-id="f7a95-254">In this tutorial we will look at entering a custom SQL statement; the next tutorial includes an example that uses a stored procedure.</span></span>

![Immettere un'istruzione SQL personalizzata o una Stored Procedure di selezione](querying-data-with-the-sqldatasource-control-cs/_static/image19.gif)

<span data-ttu-id="f7a95-256">**Figura 13**: Immettere un'istruzione SQL personalizzata o una Stored Procedure di selezione</span><span class="sxs-lookup"><span data-stu-id="f7a95-256">**Figure 13**: Enter a Custom SQL Statement or Pick a Stored Procedure</span></span>

<span data-ttu-id="f7a95-257">L'istruzione SQL personalizzata può essere immessi manualmente nella casella di testo o può essere costruito graficamente facendo clic sul pulsante Generatore delle Query.</span><span class="sxs-lookup"><span data-stu-id="f7a95-257">The custom SQL statement can be entered by hand into the textbox or can be constructed graphically by clicking the Query Builder button.</span></span> <span data-ttu-id="f7a95-258">Dal generatore di Query o la casella di testo, utilizzare la query seguente per restituire il `ProductID` e `ProductName` i campi dalle `Products` tabella usando una `JOIN` per recuperare il prodotto s `CategoryName` dal `Categories` tabella:</span><span class="sxs-lookup"><span data-stu-id="f7a95-258">From either the Query Builder or the textbox, use the following query to return the `ProductID` and `ProductName` fields from the `Products` table using a `JOIN` to retrieve the product s `CategoryName` from the `Categories` table:</span></span>

[!code-sql[Main](querying-data-with-the-sqldatasource-control-cs/samples/sample4.sql)]

![È possibile graficamente costruire la Query utilizzando il generatore delle Query](querying-data-with-the-sqldatasource-control-cs/_static/image20.gif)

<span data-ttu-id="f7a95-260">**Figura 14**: È possibile graficamente costruire la Query utilizzando il generatore delle Query</span><span class="sxs-lookup"><span data-stu-id="f7a95-260">**Figure 14**: You can Graphically Construct the Query Using the Query Builder</span></span>

<span data-ttu-id="f7a95-261">Dopo aver specificato la query, fare clic su Avanti per passare alla schermata di Query di Test.</span><span class="sxs-lookup"><span data-stu-id="f7a95-261">After specifying the query, click Next to proceed to the Test Query screen.</span></span> <span data-ttu-id="f7a95-262">Fare clic su Fine per completare la procedura guidata SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="f7a95-262">Click Finish to complete the SqlDataSource wizard.</span></span>

<span data-ttu-id="f7a95-263">Dopo aver completato la procedura guidata, il controllo GridView avrà tre BoundField aggiunto a tale visualizzazione il `ProductID`, `ProductName`, e `CategoryName` colonne restituite dalla query e risultante nel markup dichiarativo seguenti:</span><span class="sxs-lookup"><span data-stu-id="f7a95-263">After completing the wizard, the GridView will have three BoundFields added to it displaying the `ProductID`, `ProductName`, and `CategoryName` columns returned from the query and resulting in the following declarative markup:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-cs/samples/sample5.aspx)]

<span data-ttu-id="f7a95-264">[![GridView Visualizza ogni ID prodotto s, nome della categoria di nome e associato](querying-data-with-the-sqldatasource-control-cs/_static/image22.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image21.gif)</span><span class="sxs-lookup"><span data-stu-id="f7a95-264">[![The GridView Shows Each Product s ID, Name, and Associated Category Name](querying-data-with-the-sqldatasource-control-cs/_static/image22.gif)](querying-data-with-the-sqldatasource-control-cs/_static/image21.gif)</span></span>

<span data-ttu-id="f7a95-265">**Figura 15**: L'ID s GridView Visualizza ogni prodotto, nome e associate nome della categoria ([fare clic per visualizzare l'immagine con dimensioni normali](querying-data-with-the-sqldatasource-control-cs/_static/image23.gif))</span><span class="sxs-lookup"><span data-stu-id="f7a95-265">**Figure 15**: The GridView Shows Each Product s ID, Name, and Associated Category Name ([Click to view full-size image](querying-data-with-the-sqldatasource-control-cs/_static/image23.gif))</span></span>

## <a name="summary"></a><span data-ttu-id="f7a95-266">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="f7a95-266">Summary</span></span>

<span data-ttu-id="f7a95-267">In questa esercitazione è stato illustrato come eseguire query e visualizzare i dati usando il controllo SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="f7a95-267">In this tutorial we saw how to query and display data using the SqlDataSource control.</span></span> <span data-ttu-id="f7a95-268">Ad esempio ObjectDataSource, SqlDataSource funge da proxy, che fornisce un approccio dichiarativo per l'accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-268">Like the ObjectDataSource, the SqlDataSource serves as a proxy, providing a declarative approach to accessing data.</span></span> <span data-ttu-id="f7a95-269">Le relative proprietà specificano il database a cui connettersi e il codice SQL `SELECT` la query da eseguire; possono essere specificate tramite la finestra proprietà o tramite la procedura guidata Configura origine dati.</span><span class="sxs-lookup"><span data-stu-id="f7a95-269">Its properties specify the database to connect to and the SQL `SELECT` query to execute; they can be specified through the Properties window or by using the Configure DataSource wizard.</span></span>

<span data-ttu-id="f7a95-270">Il `SELECT` esempi di query viene esaminati in questa esercitazione tutti i record restituiscano dalla query specificata.</span><span class="sxs-lookup"><span data-stu-id="f7a95-270">The `SELECT` query examples we examined in this tutorial returned all of the records from the specified query.</span></span> <span data-ttu-id="f7a95-271">Tuttavia, il controllo SqlDataSource, può includere un `WHERE` clausola con parametri i cui valori vengono assegnati a livello di codice o vengono automaticamente eseguito il pull da un'origine specificata.</span><span class="sxs-lookup"><span data-stu-id="f7a95-271">The SqlDataSource control, however, can include a `WHERE` clause with parameters whose values are assigned programmatically or are automatically pulled from a specified source.</span></span> <span data-ttu-id="f7a95-272">Come creare e usare query con parametri nella prossima esercitazione verrà esaminato.</span><span class="sxs-lookup"><span data-stu-id="f7a95-272">We'll examine how to create and use parameterized queries in the next tutorial!</span></span>

<span data-ttu-id="f7a95-273">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="f7a95-273">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="f7a95-274">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="f7a95-274">Further Reading</span></span>

<span data-ttu-id="f7a95-275">Per altre informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="f7a95-275">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f7a95-276">L'accesso ai dati di Database relazionale</span><span class="sxs-lookup"><span data-stu-id="f7a95-276">Accessing Relational Database Data</span></span>](http://aspnet.4guysfromrolla.com/articles/022206-1.aspx)
- [<span data-ttu-id="f7a95-277">Cenni preliminari sul controllo SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="f7a95-277">SqlDataSource Control Overview</span></span>](https://msdn.microsoft.com/library/dz12d98w.aspx)
- [<span data-ttu-id="f7a95-278">Esercitazioni della Guida rapida ASP.NET: Il controllo SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="f7a95-278">ASP.NET Quickstart Tutorials: The SqlDataSource Control</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/sqldatasource.aspx)
- [<span data-ttu-id="f7a95-279">Il file Web. config `<connectionStrings>` elemento</span><span class="sxs-lookup"><span data-stu-id="f7a95-279">The Web.config `<connectionStrings>` Element</span></span>](https://msdn.microsoft.com/library/bf7sd233.aspx)
- [<span data-ttu-id="f7a95-280">Riferimento alla stringa di connessione di database</span><span class="sxs-lookup"><span data-stu-id="f7a95-280">Database Connection String Reference</span></span>](http://www.connectionstrings.com/)

## <a name="about-the-author"></a><span data-ttu-id="f7a95-281">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="f7a95-281">About the Author</span></span>

<span data-ttu-id="f7a95-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autore di sette libri e fondatore di [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha collaborato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="f7a95-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f7a95-283">Lavora come un consulente, formatore e autore.</span><span class="sxs-lookup"><span data-stu-id="f7a95-283">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f7a95-284">Il suo ultimo libro si intitola [ *Sams Teach Yourself ASP.NET 2.0 in 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f7a95-284">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f7a95-285">È possibile contattarlo al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f7a95-285">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f7a95-286">o sul suo blog, che è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f7a95-286">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f7a95-287">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="f7a95-287">Special Thanks To</span></span>

<span data-ttu-id="f7a95-288">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="f7a95-288">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f7a95-289">I revisori per questa esercitazione sono state Connery Susan, Bernadette Leigh e David Suru.</span><span class="sxs-lookup"><span data-stu-id="f7a95-289">Lead reviewers for this tutorial were Susan Connery, Bernadette Leigh, and David Suru.</span></span> <span data-ttu-id="f7a95-290">Se si è interessati prossimi articoli MSDN dello?</span><span class="sxs-lookup"><span data-stu-id="f7a95-290">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f7a95-291">In questo caso, Inviami una riga in corrispondenza [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f7a95-291">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="f7a95-292">avanti</span><span class="sxs-lookup"><span data-stu-id="f7a95-292">Next</span></span>](using-parameterized-queries-with-the-sqldatasource-cs.md)
