---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments
title: Personalizzazione delle distribuzioni di database per più ambienti | Microsoft Docs
author: jrjlee
description: "In questo argomento viene descritto come personalizzare le proprietà di un database in ambienti di destinazione specifici come parte del processo di distribuzione. Nota: nell'argomento si presuppone..."
ms.author: riande
ms.date: 05/04/2012
ms.assetid: a172979a-1318-4318-a9c6-4f9560d26267
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments
msc.type: authoredcontent
ms.openlocfilehash: 8ae8cb1a322afb95c5d2e8d5e73c7825c7b2fe5a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78604027"
---
# <a name="customizing-database-deployments-for-multiple-environments"></a><span data-ttu-id="e4ded-104">Personalizzazione delle distribuzioni di database per più ambienti</span><span class="sxs-lookup"><span data-stu-id="e4ded-104">Customizing Database Deployments for Multiple Environments</span></span>

<span data-ttu-id="e4ded-105">di [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="e4ded-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="e4ded-106">Scaricare PDF</span><span class="sxs-lookup"><span data-stu-id="e4ded-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="e4ded-107">In questo argomento viene descritto come personalizzare le proprietà di un database in ambienti di destinazione specifici come parte del processo di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-107">This topic describes how to tailor the properties of a database to specific target environments as part of the deployment process.</span></span>
> 
> > [!NOTE]
> > <span data-ttu-id="e4ded-108">Nell'argomento si presuppone che si stia distribuendo un progetto di database di Visual Studio 2010 usando MSBuild. exe e VSDBCMD. exe.</span><span class="sxs-lookup"><span data-stu-id="e4ded-108">The topic assumes that you're deploying a Visual Studio 2010 database project using MSBuild.exe and VSDBCMD.exe.</span></span> <span data-ttu-id="e4ded-109">Per ulteriori informazioni sui motivi per cui è possibile scegliere questo approccio, vedere [distribuzione Web nell'organizzazione](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md) e [distribuzione di progetti di database](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span><span class="sxs-lookup"><span data-stu-id="e4ded-109">For more information on why you might choose this approach, see [Web Deployment in the Enterprise](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md) and [Deploying Database Projects](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span></span>
> 
> 
> <span data-ttu-id="e4ded-110">Quando si distribuisce un progetto di database in più destinazioni, è spesso necessario personalizzare le proprietà di distribuzione del database per ogni ambiente di destinazione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-110">When you deploy a database project to multiple destinations, you'll often want to customize the database deployment properties for each target environment.</span></span> <span data-ttu-id="e4ded-111">Negli ambienti di test, ad esempio, è in genere necessario ricreare il database in ogni distribuzione, mentre negli ambienti di gestione temporanea o di produzione è molto più probabile eseguire aggiornamenti incrementali per conservare i dati.</span><span class="sxs-lookup"><span data-stu-id="e4ded-111">For example, in test environments you'd typically recreate the database on every deployment, whereas in staging or production environments you'd be a lot more likely to make incremental updates to preserve your data.</span></span>
> 
> <span data-ttu-id="e4ded-112">In un progetto di database Visual Studio 2010, le impostazioni di distribuzione sono contenute in un file di configurazione della distribuzione (. sqldeployment).</span><span class="sxs-lookup"><span data-stu-id="e4ded-112">In a Visual Studio 2010 database project, deployment settings are contained within a deployment configuration (.sqldeployment) file.</span></span> <span data-ttu-id="e4ded-113">In questo argomento viene illustrato come creare file di configurazione della distribuzione specifici dell'ambiente e specificare quello che si desidera utilizzare come parametro VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="e4ded-113">This topic will show you how to create environment-specific deployment configuration files and specify the one you want to use as a VSDBCMD parameter.</span></span>

<span data-ttu-id="e4ded-114">Questo argomento fa parte di una serie di esercitazioni basate sui requisiti di distribuzione aziendali di una società fittizia denominata Fabrikam, Inc. Questa serie di esercitazioni usa una&#x2014;soluzione di esempio la&#x2014; [soluzione Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)per rappresentare un'applicazione Web con un livello di complessità realistico, tra cui un'applicazione ASP.NET MVC 3, un servizio Windows Communication Foundation (WCF) e un progetto di database.</span><span class="sxs-lookup"><span data-stu-id="e4ded-114">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="e4ded-115">Il metodo di distribuzione al centro di queste esercitazioni si basa sull'approccio Split Project file descritto in [informazioni sul file di progetto](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in cui il processo di compilazione è controllato da due&#x2014;file di progetto, uno contenente istruzioni di compilazione che si applicano a ogni ambiente di destinazione e uno contenente le impostazioni di compilazione e distribuzione specifiche dell'ambiente.</span><span class="sxs-lookup"><span data-stu-id="e4ded-115">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="e4ded-116">In fase di compilazione, il file di progetto specifico dell'ambiente viene unito al file di progetto indipendente dall'ambiente per formare un set completo di istruzioni di compilazione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-116">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="e4ded-117">Panoramica delle attività</span><span class="sxs-lookup"><span data-stu-id="e4ded-117">Task Overview</span></span>

<span data-ttu-id="e4ded-118">In questo argomento si presuppone che l'utente:</span><span class="sxs-lookup"><span data-stu-id="e4ded-118">This topic assumes that:</span></span>

- <span data-ttu-id="e4ded-119">Usare l'approccio Split Project file per la distribuzione della soluzione, come descritto in [informazioni sul file di progetto](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span><span class="sxs-lookup"><span data-stu-id="e4ded-119">You use the split project file approach to solution deployment, as described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span></span>
- <span data-ttu-id="e4ded-120">Per distribuire il progetto di database, è possibile chiamare VSDBCMD dal file di progetto, come descritto in [informazioni sul processo di compilazione](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="e4ded-120">You call VSDBCMD from the project file to deploy your database project, as described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>

<span data-ttu-id="e4ded-121">Per creare un sistema di distribuzione che supporti la variazione delle proprietà di distribuzione del database tra gli ambienti di destinazione, è necessario:</span><span class="sxs-lookup"><span data-stu-id="e4ded-121">To create a deployment system that supports varying the database deployment properties between target environments, you'll need to:</span></span>

- <span data-ttu-id="e4ded-122">Creare un file di configurazione della distribuzione (. sqldeployment) per ogni ambiente di destinazione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-122">Create a deployment configuration (.sqldeployment) file for each target environment.</span></span>
- <span data-ttu-id="e4ded-123">Creare un comando VSDBCMD che specifichi il file di configurazione della distribuzione come opzione della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="e4ded-123">Create a VSDBCMD command that specifies the deployment configuration file as a command-line switch.</span></span>
- <span data-ttu-id="e4ded-124">Parametrizzare il comando VSDBCMD in un file di progetto Microsoft Build Engine (MSBuild), in modo che le opzioni VSDBCMD siano appropriate per l'ambiente di destinazione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-124">Parameterize the VSDBCMD command in a Microsoft Build Engine (MSBuild) project file, so that the VSDBCMD options are appropriate to the target environment.</span></span>

<span data-ttu-id="e4ded-125">In questo argomento viene illustrato come eseguire ognuna di queste procedure.</span><span class="sxs-lookup"><span data-stu-id="e4ded-125">This topic will show you how to perform each of these procedures.</span></span>

## <a name="creating-environment-specific-deployment-configuration-files"></a><span data-ttu-id="e4ded-126">Creazione di file di configurazione della distribuzione specifici dell'ambiente</span><span class="sxs-lookup"><span data-stu-id="e4ded-126">Creating Environment-Specific Deployment Configuration Files</span></span>

<span data-ttu-id="e4ded-127">Per impostazione predefinita, un progetto di database contiene un unico file di configurazione della distribuzione denominato *database. sqldeployment*.</span><span class="sxs-lookup"><span data-stu-id="e4ded-127">By default, a database project contains a single deployment configuration file named *Database.sqldeployment*.</span></span> <span data-ttu-id="e4ded-128">Se si apre il file in Visual Studio 2010, è possibile visualizzare le diverse opzioni di distribuzione disponibili:</span><span class="sxs-lookup"><span data-stu-id="e4ded-128">If you open this file in Visual Studio 2010, you can see the different deployment options that are available to you:</span></span>

- <span data-ttu-id="e4ded-129">**Regole**di confronto per il confronto della distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-129">**Deployment comparison collation**.</span></span> <span data-ttu-id="e4ded-130">Ciò consente di scegliere se utilizzare le regole di confronto del database del progetto (regole di confronto di *origine* ) o le regole di confronto del database del server di destinazione (regole di confronto di *destinazione* ).</span><span class="sxs-lookup"><span data-stu-id="e4ded-130">This lets you choose whether to use the database collation of your project (the *source* collation) or the database collation of your destination server (the *target* collation).</span></span> <span data-ttu-id="e4ded-131">Nella maggior parte dei casi, è consigliabile utilizzare le regole di confronto di origine quando si esegue la distribuzione in un ambiente di sviluppo o di test.</span><span class="sxs-lookup"><span data-stu-id="e4ded-131">In most cases, you'll want to use the source collation when you deploy to a development or test environment.</span></span> <span data-ttu-id="e4ded-132">Quando si esegue la distribuzione in un ambiente di gestione temporanea o di produzione, in genere si desidera lasciare invariate le regole di confronto di destinazione per evitare eventuali problemi di interoperabilità.</span><span class="sxs-lookup"><span data-stu-id="e4ded-132">When you deploy to a staging or production environment, you'll usually want to leave the target collation unchanged to avoid any interoperability issues.</span></span>
- <span data-ttu-id="e4ded-133">**Distribuire le proprietà del database**.</span><span class="sxs-lookup"><span data-stu-id="e4ded-133">**Deploy database properties**.</span></span> <span data-ttu-id="e4ded-134">Ciò consente di scegliere se applicare le proprietà del database, come definito nel file *database. sqlsettings* .</span><span class="sxs-lookup"><span data-stu-id="e4ded-134">This lets you choose whether to apply the database properties, as defined in the *Database.sqlsettings* file.</span></span> <span data-ttu-id="e4ded-135">Quando si distribuisce un database per la prima volta, è necessario distribuire le proprietà del database.</span><span class="sxs-lookup"><span data-stu-id="e4ded-135">When you deploy a database for the first time, you should deploy the database properties.</span></span> <span data-ttu-id="e4ded-136">Se si sta aggiornando un database esistente, le proprietà devono essere già presenti e non è necessario distribuirle nuovamente.</span><span class="sxs-lookup"><span data-stu-id="e4ded-136">If you're updating an existing database, the properties should already be in place, and you shouldn't need to deploy them again.</span></span>
- <span data-ttu-id="e4ded-137">**Ricreare sempre il database**.</span><span class="sxs-lookup"><span data-stu-id="e4ded-137">**Always re-create database**.</span></span> <span data-ttu-id="e4ded-138">Ciò consente di scegliere se ricreare il database di destinazione ogni volta che si distribuiscono o si apportano modifiche incrementali per rendere aggiornato il database di destinazione con lo schema.</span><span class="sxs-lookup"><span data-stu-id="e4ded-138">This lets you choose whether to re-create the target database every time you deploy or make incremental changes to bring the target database up to date with your schema.</span></span> <span data-ttu-id="e4ded-139">Se si ricrea il database, si perderanno tutti i dati nel database esistente.</span><span class="sxs-lookup"><span data-stu-id="e4ded-139">If you re-create the database, you'll lose any data in the existing database.</span></span> <span data-ttu-id="e4ded-140">Di conseguenza, in genere è necessario impostare su **false** per le distribuzioni in ambienti di gestione temporanea o di produzione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-140">As such, you should usually set this to **false** for deployments to staging or production environments.</span></span>
- <span data-ttu-id="e4ded-141">**Blocca la distribuzione incrementale se possono verificarsi perdite di dati**.</span><span class="sxs-lookup"><span data-stu-id="e4ded-141">**Block incremental deployment if data loss might occur**.</span></span> <span data-ttu-id="e4ded-142">Ciò consente di scegliere se la distribuzione deve essere interrotta se una modifica allo schema del database provocherà la perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="e4ded-142">This lets you choose whether deployment should stop if a change to the database schema will cause the loss of data.</span></span> <span data-ttu-id="e4ded-143">In genere, questo valore viene impostato su **true** per una distribuzione in un ambiente di produzione, per offrire l'opportunità di intervenire e proteggere i dati importanti.</span><span class="sxs-lookup"><span data-stu-id="e4ded-143">You typically set this to **true** for a deployment to a production environment, to give you the opportunity to intervene and protect any important data.</span></span> <span data-ttu-id="e4ded-144">Se è stato impostato **ricrea sempre database** su **false**, questa impostazione non avrà alcun effetto.</span><span class="sxs-lookup"><span data-stu-id="e4ded-144">If you have set **Always re-create database** to **false**, this setting will have no effect.</span></span>
- <span data-ttu-id="e4ded-145">**Eseguire la distribuzione in modalità utente singolo**.</span><span class="sxs-lookup"><span data-stu-id="e4ded-145">**Execute deployment in single-user mode**.</span></span> <span data-ttu-id="e4ded-146">Non si tratta in genere di un problema negli ambienti di sviluppo o di test.</span><span class="sxs-lookup"><span data-stu-id="e4ded-146">This is not usually an issue in development or test environments.</span></span> <span data-ttu-id="e4ded-147">Tuttavia, in genere è necessario impostare su **true** per le distribuzioni in ambienti di gestione temporanea o di produzione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-147">However, you should typically set this to **true** for deployments to staging or production environments.</span></span> <span data-ttu-id="e4ded-148">In questo modo si impedisce agli utenti di apportare modifiche al database mentre è in corso la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-148">This prevents users from making changes to the database while the deployment is underway.</span></span>
- <span data-ttu-id="e4ded-149">**Eseguire il backup del database prima della distribuzione**.</span><span class="sxs-lookup"><span data-stu-id="e4ded-149">**Back up database before deployment**.</span></span> <span data-ttu-id="e4ded-150">In genere, questo valore viene impostato su **true** quando si esegue la distribuzione in un ambiente di produzione, come precauzione dalla perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="e4ded-150">You typically set this to **true** when you deploy to a production environment, as a precaution against data loss.</span></span> <span data-ttu-id="e4ded-151">È inoltre possibile impostarlo su **true** quando si esegue la distribuzione in un ambiente di gestione temporanea, se il database di gestione temporanea contiene una grande quantità di dati.</span><span class="sxs-lookup"><span data-stu-id="e4ded-151">You may also want to set it to **true** when you deploy to a staging environment, if your staging database contains a lot of data.</span></span>
- <span data-ttu-id="e4ded-152">**Genera istruzioni DROP per gli oggetti presenti nel database di destinazione ma che non sono presenti nel progetto di database**.</span><span class="sxs-lookup"><span data-stu-id="e4ded-152">**Generate DROP statements for objects that are in the target database but that are not in the database project**.</span></span> <span data-ttu-id="e4ded-153">Nella maggior parte dei casi, si tratta di una parte integrante e essenziale di apportare modifiche incrementali a un database.</span><span class="sxs-lookup"><span data-stu-id="e4ded-153">In most cases, this is an integral and essential part of making incremental changes to a database.</span></span> <span data-ttu-id="e4ded-154">Se è stato impostato **ricrea sempre database** su **false**, questa impostazione non avrà alcun effetto.</span><span class="sxs-lookup"><span data-stu-id="e4ded-154">If you have set **Always re-create database** to **false**, this setting will have no effect.</span></span>
- <span data-ttu-id="e4ded-155">**Non utilizzare istruzioni ALTER assembly per aggiornare i tipi CLR**.</span><span class="sxs-lookup"><span data-stu-id="e4ded-155">**Do not use ALTER ASSEMBLY statements to update CLR types**.</span></span> <span data-ttu-id="e4ded-156">Questa impostazione determina il modo in cui SQL Server aggiornare i tipi di Common Language Runtime (CLR) a versioni di assembly più recenti.</span><span class="sxs-lookup"><span data-stu-id="e4ded-156">This setting determines how SQL Server should update common language runtime (CLR) types to newer assembly versions.</span></span> <span data-ttu-id="e4ded-157">Questa impostazione deve essere impostata su **false** nella maggior parte degli scenari.</span><span class="sxs-lookup"><span data-stu-id="e4ded-157">This should be set to **false** in most scenarios.</span></span>

<span data-ttu-id="e4ded-158">Questa tabella mostra le impostazioni di distribuzione tipiche per ambienti di destinazione diversi.</span><span class="sxs-lookup"><span data-stu-id="e4ded-158">This table shows typical deployment settings for different destination environments.</span></span> <span data-ttu-id="e4ded-159">Tuttavia, le impostazioni possono variare a seconda dei requisiti specifici.</span><span class="sxs-lookup"><span data-stu-id="e4ded-159">However, your settings may be different depending on your exact requirements.</span></span>

|  | <span data-ttu-id="e4ded-160">Developer/test</span><span class="sxs-lookup"><span data-stu-id="e4ded-160">Developer/Test</span></span> | <span data-ttu-id="e4ded-161">Gestione temporanea/integrazione</span><span class="sxs-lookup"><span data-stu-id="e4ded-161">Staging/Integration</span></span> | <span data-ttu-id="e4ded-162">Produzione</span><span class="sxs-lookup"><span data-stu-id="e4ded-162">Production</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="e4ded-163">**Regole di confronto per il confronto della distribuzione**</span><span class="sxs-lookup"><span data-stu-id="e4ded-163">**Deployment comparison collation**</span></span> | <span data-ttu-id="e4ded-164">Origine</span><span class="sxs-lookup"><span data-stu-id="e4ded-164">Source</span></span> | <span data-ttu-id="e4ded-165">Destinazione</span><span class="sxs-lookup"><span data-stu-id="e4ded-165">Target</span></span> | <span data-ttu-id="e4ded-166">Destinazione</span><span class="sxs-lookup"><span data-stu-id="e4ded-166">Target</span></span> |
| <span data-ttu-id="e4ded-167">**Distribuisci proprietà database**</span><span class="sxs-lookup"><span data-stu-id="e4ded-167">**Deploy database properties**</span></span> | <span data-ttu-id="e4ded-168">True</span><span class="sxs-lookup"><span data-stu-id="e4ded-168">True</span></span> | <span data-ttu-id="e4ded-169">Solo per la prima volta</span><span class="sxs-lookup"><span data-stu-id="e4ded-169">First time only</span></span> | <span data-ttu-id="e4ded-170">Solo per la prima volta</span><span class="sxs-lookup"><span data-stu-id="e4ded-170">First time only</span></span> |
| <span data-ttu-id="e4ded-171">**Ricrea sempre database**</span><span class="sxs-lookup"><span data-stu-id="e4ded-171">**Always re-create database**</span></span> | <span data-ttu-id="e4ded-172">True</span><span class="sxs-lookup"><span data-stu-id="e4ded-172">True</span></span> | <span data-ttu-id="e4ded-173">False</span><span class="sxs-lookup"><span data-stu-id="e4ded-173">False</span></span> | <span data-ttu-id="e4ded-174">False</span><span class="sxs-lookup"><span data-stu-id="e4ded-174">False</span></span> |
| <span data-ttu-id="e4ded-175">**Blocca la distribuzione incrementale se possono verificarsi perdite di dati**</span><span class="sxs-lookup"><span data-stu-id="e4ded-175">**Block incremental deployment if data loss might occur**</span></span> | <span data-ttu-id="e4ded-176">False</span><span class="sxs-lookup"><span data-stu-id="e4ded-176">False</span></span> | <span data-ttu-id="e4ded-177">È possibile</span><span class="sxs-lookup"><span data-stu-id="e4ded-177">Maybe</span></span> | <span data-ttu-id="e4ded-178">True</span><span class="sxs-lookup"><span data-stu-id="e4ded-178">True</span></span> |
| <span data-ttu-id="e4ded-179">**Eseguire lo script di distribuzione in modalità utente singolo**</span><span class="sxs-lookup"><span data-stu-id="e4ded-179">**Execute deployment script in single-user mode**</span></span> | <span data-ttu-id="e4ded-180">False</span><span class="sxs-lookup"><span data-stu-id="e4ded-180">False</span></span> | <span data-ttu-id="e4ded-181">True</span><span class="sxs-lookup"><span data-stu-id="e4ded-181">True</span></span> | <span data-ttu-id="e4ded-182">True</span><span class="sxs-lookup"><span data-stu-id="e4ded-182">True</span></span> |
| <span data-ttu-id="e4ded-183">**Eseguire il backup del database prima della distribuzione**</span><span class="sxs-lookup"><span data-stu-id="e4ded-183">**Back up database before deployment**</span></span> | <span data-ttu-id="e4ded-184">False</span><span class="sxs-lookup"><span data-stu-id="e4ded-184">False</span></span> | <span data-ttu-id="e4ded-185">È possibile</span><span class="sxs-lookup"><span data-stu-id="e4ded-185">Maybe</span></span> | <span data-ttu-id="e4ded-186">True</span><span class="sxs-lookup"><span data-stu-id="e4ded-186">True</span></span> |
| <span data-ttu-id="e4ded-187">**Genera istruzioni DROP per gli oggetti presenti nel database di destinazione ma che non sono presenti nel progetto di database**</span><span class="sxs-lookup"><span data-stu-id="e4ded-187">**Generate DROP statements for objects that are in the target database but that are not in the database project**</span></span> | <span data-ttu-id="e4ded-188">False</span><span class="sxs-lookup"><span data-stu-id="e4ded-188">False</span></span> | <span data-ttu-id="e4ded-189">True</span><span class="sxs-lookup"><span data-stu-id="e4ded-189">True</span></span> | <span data-ttu-id="e4ded-190">True</span><span class="sxs-lookup"><span data-stu-id="e4ded-190">True</span></span> |
| <span data-ttu-id="e4ded-191">**Non utilizzare istruzioni ALTER ASSEMBLY per aggiornare i tipi CLR**</span><span class="sxs-lookup"><span data-stu-id="e4ded-191">**Do not use ALTER ASSEMBLY statements to update CLR types**</span></span> | <span data-ttu-id="e4ded-192">False</span><span class="sxs-lookup"><span data-stu-id="e4ded-192">False</span></span> | <span data-ttu-id="e4ded-193">False</span><span class="sxs-lookup"><span data-stu-id="e4ded-193">False</span></span> | <span data-ttu-id="e4ded-194">False</span><span class="sxs-lookup"><span data-stu-id="e4ded-194">False</span></span> |

> [!NOTE]
> <span data-ttu-id="e4ded-195">Per ulteriori informazioni sulle proprietà di distribuzione del database e sulle considerazioni sull'ambiente, vedere [una panoramica delle impostazioni del progetto di database](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx), [procedura: configurare le proprietà per i dettagli della distribuzione](https://msdn.microsoft.com/library/dd172125.aspx), [compilare e distribuire il database in un ambiente di sviluppo isolato](https://msdn.microsoft.com/library/dd193409.aspx)e [compilare e distribuire database in un ambiente di gestione temporanea o di produzione](https://msdn.microsoft.com/library/dd193413.aspx).</span><span class="sxs-lookup"><span data-stu-id="e4ded-195">For more information on database deployment properties and environment considerations, see [An Overview of Database Project Settings](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx), [How to: Configure Properties for Deployment Details](https://msdn.microsoft.com/library/dd172125.aspx), [Build and Deploy Database to an Isolated Development Environment](https://msdn.microsoft.com/library/dd193409.aspx), and [Build and Deploy Databases to a Staging or Production Environment](https://msdn.microsoft.com/library/dd193413.aspx).</span></span>

<span data-ttu-id="e4ded-196">Per supportare la distribuzione di un progetto di database in più destinazioni, è necessario creare un file di configurazione della distribuzione per ogni ambiente di destinazione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-196">To support the deployment of a database project to multiple destinations, you should create a deployment configuration file for each target environment.</span></span>

<span data-ttu-id="e4ded-197">**Per creare un file di configurazione specifico dell'ambiente**</span><span class="sxs-lookup"><span data-stu-id="e4ded-197">**To create an environment-specific configuration file**</span></span>

1. <span data-ttu-id="e4ded-198">In Visual Studio 2010, nella finestra di **Esplora soluzioni** , fare clic con il pulsante destro del mouse sul progetto di database e quindi scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="e4ded-198">In Visual Studio 2010, in the **Solution Explorer** window, right-click your database project, and then click **Properties**.</span></span>
2. <span data-ttu-id="e4ded-199">Nella scheda **Distribuisci** della pagina proprietà del progetto di database, nella riga **file di configurazione della distribuzione** , fare clic su **nuovo**.</span><span class="sxs-lookup"><span data-stu-id="e4ded-199">On the database project properties page, on the **Deploy** tab, in the **Deployment configuration file** row, click **New**.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image1.png)
3. <span data-ttu-id="e4ded-200">Nella finestra di dialogo **nuovo file di configurazione della distribuzione** assegnare al file un nome significativo, ad esempio **TestEnvironment. sqldeployment**, quindi fare clic su **Salva**.</span><span class="sxs-lookup"><span data-stu-id="e4ded-200">In the **New Deployment Configuration File** dialog box, give the file a meaningful name (for example, **TestEnvironment.sqldeployment**), and then click **Save**.</span></span>
4. <span data-ttu-id="e4ded-201">Nella pagina *[nomefile] \* \* *. sqldeployment** impostare le proprietà di distribuzione in modo che corrispondano ai requisiti dell'ambiente di destinazione, quindi salvare il file.</span><span class="sxs-lookup"><span data-stu-id="e4ded-201">On the *[Filename]\*\*\*.sqldeployment*\* page, set the deployment properties to match the requirements of your destination environment, and then save the file.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image2.png)
5. <span data-ttu-id="e4ded-202">Si noti che il nuovo file viene aggiunto alla cartella Properties nel progetto di database.</span><span class="sxs-lookup"><span data-stu-id="e4ded-202">Notice that the new file is added to the Properties folder in your database project.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image3.png)

## <a name="specifying-the-deployment-configuration-file-in-vsdbcmd"></a><span data-ttu-id="e4ded-203">Specifica del file di configurazione della distribuzione in VSDBCMD</span><span class="sxs-lookup"><span data-stu-id="e4ded-203">Specifying the Deployment Configuration File in VSDBCMD</span></span>

<span data-ttu-id="e4ded-204">Quando si usano configurazioni di soluzione, ad esempio debug e versione, all'interno di Visual Studio 2010, è possibile associare un file di configurazione della distribuzione a ogni configurazione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-204">When you use solution configurations (like Debug and Release) within Visual Studio 2010, you can associate a deployment configuration file with each configuration.</span></span> <span data-ttu-id="e4ded-205">Quando si compila una configurazione specifica, il processo di compilazione genera un file manifesto di distribuzione specifico per la configurazione che punta al file di configurazione della distribuzione specifico della configurazione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-205">When you build a particular configuration, the build process generates a configuration-specific deployment manifest file that points to the configuration-specific deployment configuration file.</span></span> <span data-ttu-id="e4ded-206">Tuttavia, uno degli obiettivi principali dell'approccio alla distribuzione descritto in queste esercitazioni è fornire agli utenti la possibilità di controllare il processo di distribuzione senza usare Visual Studio 2010 e le configurazioni della soluzione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-206">However, one of the main aims of the approach to deployment described in these tutorials is to give people the ability to control the deployment process without using Visual Studio 2010 and solution configurations.</span></span> <span data-ttu-id="e4ded-207">In questo approccio, la configurazione della soluzione è la stessa indipendentemente dall'ambiente di distribuzione di destinazione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-207">In this approach, the solution configuration is the same regardless of the target deployment environment.</span></span> <span data-ttu-id="e4ded-208">Per personalizzare la distribuzione del database in un ambiente di destinazione specifico, è possibile utilizzare le opzioni della riga di comando VSDBCMD per specificare il file di configurazione della distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-208">To tailor your database deployment to a specific destination environment, you can use the VSDBCMD command-line options to specify your deployment configuration file.</span></span>

<span data-ttu-id="e4ded-209">Per specificare un file di configurazione della distribuzione in VSDBCMD, usare l'opzione **p:/DeploymentConfigurationFile** e specificare il percorso completo del file.</span><span class="sxs-lookup"><span data-stu-id="e4ded-209">To specify a deployment configuration file in your VSDBCMD, use the **p:/DeploymentConfigurationFile** switch and provide the full path to your file.</span></span> <span data-ttu-id="e4ded-210">Verrà eseguito l'override del file di configurazione della distribuzione identificato dal manifesto di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-210">This will override the deployment configuration file that the deployment manifest identifies.</span></span> <span data-ttu-id="e4ded-211">Ad esempio, è possibile usare questo comando VSDBCMD per distribuire il database **ContactManager** in un ambiente di testing:</span><span class="sxs-lookup"><span data-stu-id="e4ded-211">For example, you could use this VSDBCMD command to deploy the **ContactManager** database to a test environment:</span></span>

[!code-console[Main](customizing-database-deployments-for-multiple-environments/samples/sample1.cmd)]

> [!NOTE]
> <span data-ttu-id="e4ded-212">Si noti che il processo di compilazione può rinominare il file. sqldeployment quando copia il file nella directory di output.</span><span class="sxs-lookup"><span data-stu-id="e4ded-212">Note that the build process may rename your .sqldeployment file when it copies the file to the output directory.</span></span>

<span data-ttu-id="e4ded-213">Se si usano variabili di comando SQL negli script SQL di pre-distribuzione o post-distribuzione, è possibile usare un approccio simile per associare un file con estensione sqlcmdvars specifico dell'ambiente alla distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e4ded-213">If you use SQL command variables in your pre-deployment or post-deployment SQL scripts, you can use a similar approach to associate an environment-specific .sqlcmdvars file with your deployment.</span></span> <span data-ttu-id="e4ded-214">In questo caso, si usa l'opzione **p:/SqlCommandVariablesFile** per identificare il file. sqlcmdvars.</span><span class="sxs-lookup"><span data-stu-id="e4ded-214">In this case, you use the **p:/SqlCommandVariablesFile** switch to identify your .sqlcmdvars file.</span></span>

## <a name="running-the-vsdbcmd-command-from-an-msbuild-project-file"></a><span data-ttu-id="e4ded-215">Esecuzione del comando VSDBCMD da un file di progetto MSBuild</span><span class="sxs-lookup"><span data-stu-id="e4ded-215">Running the VSDBCMD Command from an MSBuild Project File</span></span>

<span data-ttu-id="e4ded-216">È possibile richiamare un comando VSDBCMD da un file di progetto MSBuild utilizzando un'attività **Exec** all'interno di una destinazione MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e4ded-216">You can invoke a VSDBCMD command from an MSBuild project file by using an **Exec** task within an MSBuild target.</span></span> <span data-ttu-id="e4ded-217">Nella sua forma più semplice, avrà un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="e4ded-217">In its simplest form, it would look like this:</span></span>

[!code-xml[Main](customizing-database-deployments-for-multiple-environments/samples/sample2.xml)]

- <span data-ttu-id="e4ded-218">In pratica, per facilitare la lettura e il riutilizzo dei file di progetto, è opportuno creare proprietà per archiviare i vari parametri della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="e4ded-218">In practice, to make your project files easy to read and reuse, you'll want to create properties to store the various command-line parameters.</span></span> <span data-ttu-id="e4ded-219">Questo consente agli utenti di fornire più facilmente i valori delle proprietà in un file di progetto specifico dell'ambiente o di eseguire l'override dei valori predefiniti dalla riga di comando di MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e4ded-219">This makes it easier for users to provide property values in an environment-specific project file or to override default values from the MSBuild command line.</span></span> <span data-ttu-id="e4ded-220">Se si usa l'approccio Split Project file descritto in [informazioni sul file di progetto](../web-deployment-in-the-enterprise/understanding-the-project-file.md), è necessario dividere le istruzioni e le proprietà di compilazione tra i due file di conseguenza:</span><span class="sxs-lookup"><span data-stu-id="e4ded-220">If you use the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), you should divide your build instructions and properties between the two files accordingly:</span></span>
- <span data-ttu-id="e4ded-221">Le impostazioni specifiche dell'ambiente, ad esempio il nome del file di configurazione della distribuzione, la stringa di connessione del database e il nome del database di destinazione, devono essere inserite nel file di progetto specifico dell'ambiente.</span><span class="sxs-lookup"><span data-stu-id="e4ded-221">Environment-specific settings, like the deployment configuration filename, the database connection string, and the target database name, should go in the environment-specific project file.</span></span>
- <span data-ttu-id="e4ded-222">La destinazione MSBuild che esegue il comando VSDBCMD, insieme a qualsiasi proprietà universale come il percorso del file eseguibile VSDBCMD, deve essere presente nel file di progetto universale.</span><span class="sxs-lookup"><span data-stu-id="e4ded-222">The MSBuild target that runs the VSDBCMD command, together with any universal properties like the location of the VSDBCMD executable, should go in the universal project file.</span></span>

<span data-ttu-id="e4ded-223">È inoltre necessario assicurarsi di compilare il progetto di database prima di richiamare VSDBCMD, in modo che il file con estensione deploymanifest venga creato e pronto per l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="e4ded-223">You should also ensure that you build the database project before you invoke VSDBCMD so that the .deploymanifest file is created and ready to use.</span></span> <span data-ttu-id="e4ded-224">È possibile vedere un esempio completo di questo approccio nell'argomento [informazioni sul processo di compilazione](../web-deployment-in-the-enterprise/understanding-the-build-process.md), che illustra i file di progetto nella soluzione di [esempio Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md).</span><span class="sxs-lookup"><span data-stu-id="e4ded-224">You can see a full example of this approach in the topic [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md), which walks you through the project files in the [Contact Manager sample solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="e4ded-225">Conclusione</span><span class="sxs-lookup"><span data-stu-id="e4ded-225">Conclusion</span></span>

<span data-ttu-id="e4ded-226">In questo argomento viene descritto come personalizzare le proprietà del database in ambienti di destinazione diversi quando si distribuiscono progetti di database tramite MSBuild e VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="e4ded-226">This topic described how you can tailor database properties to different destination environments when you deploy database projects using MSBuild and VSDBCMD.</span></span> <span data-ttu-id="e4ded-227">Questo approccio è utile quando è necessario distribuire progetti di database come parte di soluzioni di livello aziendale di dimensioni maggiori.</span><span class="sxs-lookup"><span data-stu-id="e4ded-227">This approach is useful when you need to deploy database projects as part of larger, enterprise-scale solutions.</span></span> <span data-ttu-id="e4ded-228">Queste soluzioni vengono spesso distribuite in più destinazioni, ad esempio ambienti di sviluppo o di test in modalità sandbox, piattaforme di gestione temporanea o di integrazione, nonché ambienti di produzione o dinamici.</span><span class="sxs-lookup"><span data-stu-id="e4ded-228">These solutions are often deployed to multiple destinations, like sandboxed development or test environments, staging or integration platforms, and production or live environments.</span></span> <span data-ttu-id="e4ded-229">Ognuno di questi ambienti di destinazione richiede in genere un set univoco di proprietà di distribuzione del database.</span><span class="sxs-lookup"><span data-stu-id="e4ded-229">Each of these target environments typically requires a unique set of database deployment properties.</span></span>

## <a name="further-reading"></a><span data-ttu-id="e4ded-230">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="e4ded-230">Further Reading</span></span>

<span data-ttu-id="e4ded-231">Per ulteriori informazioni sulla distribuzione di progetti di database mediante VSDBCMD. exe, vedere [distribuzione di progetti di database](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span><span class="sxs-lookup"><span data-stu-id="e4ded-231">For more information on deploying database projects using VSDBCMD.exe, see [Deploying Database Projects](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span></span> <span data-ttu-id="e4ded-232">Per ulteriori informazioni sull'utilizzo di file di progetto MSBuild personalizzati per controllare il processo di distribuzione, vedere [informazioni sul file di progetto](../web-deployment-in-the-enterprise/understanding-the-project-file.md) e [informazioni sul processo di compilazione](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="e4ded-232">For more information on using custom MSBuild project files to control the deployment process, see [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md) and [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>

<span data-ttu-id="e4ded-233">Questi articoli su MSDN forniscono indicazioni più generali sulla distribuzione di database:</span><span class="sxs-lookup"><span data-stu-id="e4ded-233">These articles on MSDN provide more general guidance on database deployment:</span></span>

- <span data-ttu-id="e4ded-234">[Panoramica delle impostazioni del progetto di database](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="e4ded-234">[An Overview of Database Project Settings](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx)</span></span>
- [<span data-ttu-id="e4ded-235">Procedura: configurare le proprietà per i dettagli della distribuzione</span><span class="sxs-lookup"><span data-stu-id="e4ded-235">How to: Configure Properties for Deployment Details</span></span>](https://msdn.microsoft.com/library/dd172125.aspx)
- [<span data-ttu-id="e4ded-236">Creare e distribuire database in un ambiente di sviluppo isolato</span><span class="sxs-lookup"><span data-stu-id="e4ded-236">Build and Deploy Databases to an Isolated Development Environment</span></span>](https://msdn.microsoft.com/library/dd193409.aspx)
- [<span data-ttu-id="e4ded-237">Creare e distribuire database in un ambiente di gestione temporanea o di produzione</span><span class="sxs-lookup"><span data-stu-id="e4ded-237">Build and Deploy Databases to a Staging or Production Environment</span></span>](https://msdn.microsoft.com/library/dd193413.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="e4ded-238">[Precedente](performing-a-what-if-deployment.md)
> [Successivo](deploying-database-role-memberships-to-test-environments.md)</span><span class="sxs-lookup"><span data-stu-id="e4ded-238">[Previous](performing-a-what-if-deployment.md)
[Next](deploying-database-role-memberships-to-test-environments.md)</span></span>
