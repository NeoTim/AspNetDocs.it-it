---
uid: web-forms/overview/moving-to-aspnet-20/data-source-controls
title: Controlli origine dati | Microsoft Docs
author: microsoft
description: Il controllo DataGrid in ASP.NET 1. x ha contrassegnato un notevole miglioramento nell'accesso ai dati nelle applicazioni Web. Tuttavia, non era così facile da usare....
ms.author: riande
ms.date: 02/20/2005
ms.assetid: 78fd0e92-f9c6-4e96-a5e9-0375b307a828
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/data-source-controls
msc.type: authoredcontent
ms.openlocfilehash: a2e2cfbec3e5aebf42a2de30bab7d45b4b610298
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78639412"
---
# <a name="data-source-controls"></a><span data-ttu-id="90336-104">Controlli origine dati</span><span class="sxs-lookup"><span data-stu-id="90336-104">Data Source Controls</span></span>

<span data-ttu-id="90336-105">[Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="90336-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="90336-106">Il controllo DataGrid in ASP.NET 1. x ha contrassegnato un notevole miglioramento nell'accesso ai dati nelle applicazioni Web.</span><span class="sxs-lookup"><span data-stu-id="90336-106">The DataGrid control in ASP.NET 1.x marked a great improvement in data access in Web applications.</span></span> <span data-ttu-id="90336-107">Tuttavia, non era così facile da usare.</span><span class="sxs-lookup"><span data-stu-id="90336-107">However, it wasn't as user-friendly as it could have been.</span></span> <span data-ttu-id="90336-108">È ancora necessaria una notevole quantità di codice per ottenere funzionalità molto utili.</span><span class="sxs-lookup"><span data-stu-id="90336-108">It still required a considerable amount of code to obtain much useful functionality from it.</span></span> <span data-ttu-id="90336-109">Questo è il modello in tutti i tentativi di accesso ai dati in 1. x.</span><span class="sxs-lookup"><span data-stu-id="90336-109">Such is the model in all data access endeavors in 1.x.</span></span>

<span data-ttu-id="90336-110">Il controllo DataGrid in ASP.NET 1. x ha contrassegnato un notevole miglioramento nell'accesso ai dati nelle applicazioni Web.</span><span class="sxs-lookup"><span data-stu-id="90336-110">The DataGrid control in ASP.NET 1.x marked a great improvement in data access in Web applications.</span></span> <span data-ttu-id="90336-111">Tuttavia, non era così facile da usare.</span><span class="sxs-lookup"><span data-stu-id="90336-111">However, it wasn't as user-friendly as it could have been.</span></span> <span data-ttu-id="90336-112">È ancora necessaria una notevole quantità di codice per ottenere funzionalità molto utili.</span><span class="sxs-lookup"><span data-stu-id="90336-112">It still required a considerable amount of code to obtain much useful functionality from it.</span></span> <span data-ttu-id="90336-113">Questo è il modello in tutti i tentativi di accesso ai dati in 1. x.</span><span class="sxs-lookup"><span data-stu-id="90336-113">Such is the model in all data access endeavors in 1.x.</span></span>

<span data-ttu-id="90336-114">ASP.NET 2,0 risolve questo problema con i controlli origine dati in parte.</span><span class="sxs-lookup"><span data-stu-id="90336-114">ASP.NET 2.0 addresses this with in part with data source controls.</span></span> <span data-ttu-id="90336-115">I controlli origine dati in ASP.NET 2,0 forniscono agli sviluppatori un modello dichiarativo per il recupero dei dati, la visualizzazione dei dati e la modifica dei dati.</span><span class="sxs-lookup"><span data-stu-id="90336-115">The data source controls in ASP.NET 2.0 provide developers with a declarative model for retrieving data, displaying data, and editing data.</span></span> <span data-ttu-id="90336-116">Lo scopo dei controlli origine dati è fornire una rappresentazione coerente dei dati ai controlli con associazione a dati indipendentemente dall'origine di tali dati.</span><span class="sxs-lookup"><span data-stu-id="90336-116">The purpose of data source controls is to provide a consistent representation of data to data-bound controls regardless of the source of those data.</span></span> <span data-ttu-id="90336-117">Il fulcro dei controlli origine dati in ASP.NET 2,0 è la classe astratta DataSourceControl.</span><span class="sxs-lookup"><span data-stu-id="90336-117">At the heart of the data source controls in ASP.NET 2.0 is the DataSourceControl abstract class.</span></span> <span data-ttu-id="90336-118">La classe DataSourceControl fornisce un'implementazione di base dell'interfaccia IDataSource e dell'interfaccia IListSource, il secondo dei quali consente di assegnare il controllo origine dati come origine dati di un controllo con associazione a dati (tramite la nuova proprietà DataSourceId descritto più avanti) ed esporre i dati in esso contenuti come elenco.</span><span class="sxs-lookup"><span data-stu-id="90336-118">The DataSourceControl class provides a base implementation of the IDataSource interface and the IListSource interface, the latter of which allows you to assign the data source control as the DataSource of a data-bound control (via the new DataSourceId property discussed later) and expose the data therein as a list.</span></span> <span data-ttu-id="90336-119">Ogni elenco di dati di un controllo origine dati viene esposto come oggetto DataSourceView.</span><span class="sxs-lookup"><span data-stu-id="90336-119">Each list of data from a data source control is exposed as a DataSourceView object.</span></span> <span data-ttu-id="90336-120">L'accesso alle istanze di DataSourceView viene fornito dall'interfaccia IDataSource.</span><span class="sxs-lookup"><span data-stu-id="90336-120">Access to the DataSourceView instances is provided by the IDataSource interface.</span></span> <span data-ttu-id="90336-121">Ad esempio, il metodo GetViewNames restituisce un oggetto ICollection che consente di enumerare gli DataSourceView associati a un particolare controllo origine dati e il metodo GetView consente di accedere a una particolare istanza di DataSourceView in base al nome.</span><span class="sxs-lookup"><span data-stu-id="90336-121">For example, the GetViewNames method returns an ICollection that allows you to enumerate the DataSourceViews associated with a particular data source control, and the GetView method allows you to access a particular DataSourceView instance by name.</span></span>

<span data-ttu-id="90336-122">I controlli origine dati non hanno un'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="90336-122">Data source controls have no user-interface.</span></span> <span data-ttu-id="90336-123">Vengono implementati come controlli server in modo che possano supportare la sintassi dichiarativa e in modo da avere accesso allo stato della pagina, se lo si desidera.</span><span class="sxs-lookup"><span data-stu-id="90336-123">They are implemented as server controls so that they can support declarative syntax and so that they have access to page state if desired.</span></span> <span data-ttu-id="90336-124">I controlli origine dati non eseguono il rendering del markup HTML nel client.</span><span class="sxs-lookup"><span data-stu-id="90336-124">Data source controls do not render any HTML markup to the client.</span></span>

> [!NOTE]
> <span data-ttu-id="90336-125">Come si vedrà in seguito, sono disponibili anche i vantaggi della memorizzazione nella cache ottenuti tramite i controlli origine dati.</span><span class="sxs-lookup"><span data-stu-id="90336-125">As you'll see later, there are also caching benefits obtained by using data source controls.</span></span>

## <a name="storing-connection-strings"></a><span data-ttu-id="90336-126">Archiviazione di stringhe di connessione</span><span class="sxs-lookup"><span data-stu-id="90336-126">Storing Connection Strings</span></span>

<span data-ttu-id="90336-127">Prima di esaminare come configurare i controlli origine dati, è necessario coprire una nuova funzionalità di ASP.NET 2,0 relativa alle stringhe di connessione.</span><span class="sxs-lookup"><span data-stu-id="90336-127">Before we get into looking at how to configure data source controls, we should cover a new capability in ASP.NET 2.0 concerning connection strings.</span></span> <span data-ttu-id="90336-128">ASP.NET 2,0 introduce una nuova sezione del file di configurazione che consente di archiviare facilmente le stringhe di connessione che possono essere lette dinamicamente in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="90336-128">ASP.NET 2.0 introduces a new section in the configuration file that allows you to easily store connection strings that can be read dynamically at runtime.</span></span> <span data-ttu-id="90336-129">La sezione &lt;connectionStrings&gt; semplifica l'archiviazione delle stringhe di connessione.</span><span class="sxs-lookup"><span data-stu-id="90336-129">The &lt;connectionStrings&gt; section makes it easy to store connection strings.</span></span>

<span data-ttu-id="90336-130">Il frammento di codice seguente aggiunge una nuova stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="90336-130">The snippet below adds a new connection string.</span></span>

[!code-xml[Main](data-source-controls/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="90336-131">Analogamente alla sezione &lt;appSettings&gt;, la sezione&gt; &lt;connectionStrings viene visualizzata all'esterno della sezione &lt;System. Web&gt; nel file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="90336-131">Just as with the &lt;appSettings&gt; section, the &lt;connectionStrings&gt; section appears outside of the &lt;system.web&gt; section in the configuration file.</span></span>

<span data-ttu-id="90336-132">Per utilizzare questa stringa di connessione, è possibile utilizzare la sintassi seguente quando si imposta l'attributo ConnectionString di un controllo server.</span><span class="sxs-lookup"><span data-stu-id="90336-132">To use this connection string, you can use the following syntax when setting the ConnectionString attribute of a server control.</span></span>

[!code-aspx[Main](data-source-controls/samples/sample2.aspx)]

<span data-ttu-id="90336-133">La sezione &lt;connectionStrings&gt; può anche essere crittografata in modo che le informazioni riservate non vengano esposte.</span><span class="sxs-lookup"><span data-stu-id="90336-133">The &lt;connectionStrings&gt; section can also be encrypted so that sensitive information is not exposed.</span></span> <span data-ttu-id="90336-134">Questa funzionalità verrà analizzata in un modulo successivo.</span><span class="sxs-lookup"><span data-stu-id="90336-134">That ability will be covered in a later module.</span></span>

## <a name="caching-data-sources"></a><span data-ttu-id="90336-135">Memorizzazione nella cache di origini dati</span><span class="sxs-lookup"><span data-stu-id="90336-135">Caching Data Sources</span></span>

<span data-ttu-id="90336-136">Ogni DataSourceControl fornisce quattro proprietà per la configurazione della memorizzazione nella cache. EnableCaching, CacheDuration, CacheExpirationPolicy e CacheKeyDependency.</span><span class="sxs-lookup"><span data-stu-id="90336-136">Each DataSourceControl provides four properties for configuring caching; EnableCaching, CacheDuration, CacheExpirationPolicy, and CacheKeyDependency.</span></span>

## <a name="enablecaching"></a><span data-ttu-id="90336-137">EnableCaching</span><span class="sxs-lookup"><span data-stu-id="90336-137">EnableCaching</span></span>

<span data-ttu-id="90336-138">EnableCaching è una proprietà booleana che determina se la memorizzazione nella cache è abilitata o meno per il controllo origine dati.</span><span class="sxs-lookup"><span data-stu-id="90336-138">EnableCaching is a Boolean property that determines whether or not caching is enabled for the data source control.</span></span>

## <a name="cacheduration-property"></a><span data-ttu-id="90336-139">Proprietà CacheDuration</span><span class="sxs-lookup"><span data-stu-id="90336-139">CacheDuration Property</span></span>

<span data-ttu-id="90336-140">La proprietà CacheDuration imposta il numero di secondi per cui la cache rimane valida.</span><span class="sxs-lookup"><span data-stu-id="90336-140">The CacheDuration property sets the number of seconds that the cache remains valid.</span></span> <span data-ttu-id="90336-141">Se si imposta questa proprietà su **0** , la cache rimarrà valida fino a quando non viene invalidata in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="90336-141">Setting this property to **0** causes the cache to remain valid until explicitly invalidated.</span></span>

## <a name="cacheexpirationpolicy-property"></a><span data-ttu-id="90336-142">Proprietà CacheExpirationPolicy</span><span class="sxs-lookup"><span data-stu-id="90336-142">CacheExpirationPolicy Property</span></span>

<span data-ttu-id="90336-143">La proprietà CacheExpirationPolicy può essere impostata su **Absolute** o **scorrevole**.</span><span class="sxs-lookup"><span data-stu-id="90336-143">The CacheExpirationPolicy property can be set to either **Absolute** or **Sliding**.</span></span> <span data-ttu-id="90336-144">Se viene impostata su Absolute, il periodo di tempo massimo in cui i dati verranno memorizzati nella cache corrisponde al numero di secondi specificato dalla proprietà CacheDuration.</span><span class="sxs-lookup"><span data-stu-id="90336-144">Setting it to Absolute means that the maximum amount of time that the data will be cached is the number of seconds specified by the CacheDuration property.</span></span> <span data-ttu-id="90336-145">Impostando la variabile su scorrevole, l'ora di scadenza viene reimpostata quando viene eseguita ogni operazione.</span><span class="sxs-lookup"><span data-stu-id="90336-145">By setting it to Sliding, the expiration time is reset when each operation is performed.</span></span>

## <a name="cachekeydependency-property"></a><span data-ttu-id="90336-146">Proprietà CacheKeyDependency</span><span class="sxs-lookup"><span data-stu-id="90336-146">CacheKeyDependency Property</span></span>

<span data-ttu-id="90336-147">Se viene specificato un valore stringa per la proprietà CacheKeyDependency, ASP.NET imposterà una nuova dipendenza della cache basata su tale stringa.</span><span class="sxs-lookup"><span data-stu-id="90336-147">If a string value is specified for the CacheKeyDependency property, ASP.NET will set up a new cache dependency based on that string.</span></span> <span data-ttu-id="90336-148">Ciò consente di invalidare la cache in modo esplicito semplicemente modificando o rimuovendo il CacheKeyDependency.</span><span class="sxs-lookup"><span data-stu-id="90336-148">This allows you to explicitly invalidate the cache by simply changing or removing the CacheKeyDependency.</span></span>

<span data-ttu-id="90336-149">**Importante**: se la rappresentazione è abilitata e l'accesso all'origine dati e/o al contenuto dei dati è basato sull'identità client, è consigliabile disabilitare la memorizzazione nella cache impostando EnableCaching su false.</span><span class="sxs-lookup"><span data-stu-id="90336-149">**Important**: If impersonation is enabled and access to the data source and/or content of data are based upon client identity, it is recommended that caching be disabled by setting EnableCaching to False.</span></span> <span data-ttu-id="90336-150">Se la memorizzazione nella cache è abilitata in questo scenario e un utente diverso dall'utente che ha originariamente richiesto i dati emette una richiesta, l'autorizzazione all'origine dati non viene applicata.</span><span class="sxs-lookup"><span data-stu-id="90336-150">If caching is enabled in this scenario and a user other than the user who originally requested the data issues a request, authorization to the data source is not enforced.</span></span> <span data-ttu-id="90336-151">I dati verranno semplicemente serviti dalla cache.</span><span class="sxs-lookup"><span data-stu-id="90336-151">The data will simply be served from cache.</span></span>

## <a name="the-sqldatasource-control"></a><span data-ttu-id="90336-152">Controllo SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="90336-152">The SqlDataSource Control</span></span>

<span data-ttu-id="90336-153">Il controllo SqlDataSource consente agli sviluppatori di accedere ai dati archiviati in qualsiasi database relazionale che supporta ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="90336-153">The SqlDataSource control allows a developer to access data stored in any relational database that supports ADO.NET.</span></span> <span data-ttu-id="90336-154">Può usare il provider System. Data. SqlClient per accedere a un database di SQL Server, al provider System. Data. OleDb, al provider System. Data. ODBC o al provider System. Data. OracleClient per accedere a Oracle.</span><span class="sxs-lookup"><span data-stu-id="90336-154">It can use the System.Data.SqlClient provider to access a SQL Server database, the System.Data.OleDb provider, the System.Data.Odbc provider, or the System.Data.OracleClient provider to access Oracle.</span></span> <span data-ttu-id="90336-155">Il SqlDataSource non viene pertanto usato solo per accedere ai dati in un database SQL Server.</span><span class="sxs-lookup"><span data-stu-id="90336-155">Therefore, the SqlDataSource is certainly not only used for accessing data in a SQL Server database.</span></span>

<span data-ttu-id="90336-156">Per utilizzare SqlDataSource, è sufficiente fornire un valore per la proprietà ConnectionString e specificare un comando SQL o stored procedure.</span><span class="sxs-lookup"><span data-stu-id="90336-156">In order to use the SqlDataSource, you simply provide a value for the ConnectionString property and specify a SQL command or stored procedure.</span></span> <span data-ttu-id="90336-157">Il controllo SqlDataSource si occupa dell'architettura ADO.NET sottostante.</span><span class="sxs-lookup"><span data-stu-id="90336-157">The SqlDataSource control takes care of working with the underlying ADO.NET architecture.</span></span> <span data-ttu-id="90336-158">Viene aperta la connessione, viene eseguita una query sull'origine dati o viene eseguita la stored procedure, vengono restituiti i dati, quindi la connessione viene chiusa.</span><span class="sxs-lookup"><span data-stu-id="90336-158">It opens the connection, queries the data source or executes the stored procedure, returns the data, and then closes the connection for you.</span></span>

> [!NOTE]
> <span data-ttu-id="90336-159">Poiché la classe DataSourceControl chiude automaticamente la connessione, è consigliabile ridurre il numero di chiamate del cliente generate dalla perdita di connessioni al database.</span><span class="sxs-lookup"><span data-stu-id="90336-159">Because the DataSourceControl class automatically closes the connection for you, it should reduce the number of customer calls generated by leaking database connections.</span></span>

<span data-ttu-id="90336-160">Il frammento di codice seguente associa un controllo DropDownList a un controllo SqlDataSource usando la stringa di connessione archiviata nel file di configurazione, come illustrato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="90336-160">The code snippet below binds a DropDownList control to a SqlDataSource control using the connection string that is stored in the configuration file as shown above.</span></span>

[!code-aspx[Main](data-source-controls/samples/sample3.aspx)]

<span data-ttu-id="90336-161">Come illustrato in precedenza, la proprietà DataSourceMode del SqlDataSource specifica la modalità per l'origine dati.</span><span class="sxs-lookup"><span data-stu-id="90336-161">As illustrated above, the DataSourceMode property of the SqlDataSource specifies the mode for the data source.</span></span> <span data-ttu-id="90336-162">Nell'esempio precedente, DataSourceMode è impostato su DataReader.</span><span class="sxs-lookup"><span data-stu-id="90336-162">In the example above, the DataSourceMode is set to DataReader.</span></span> <span data-ttu-id="90336-163">In tal caso, il SqlDataSource restituirà un oggetto IDataReader usando un cursore di sola lettura e di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="90336-163">In that case, the SqlDataSource will return an IDataReader object using a forward-only and read-only cursor.</span></span> <span data-ttu-id="90336-164">Il tipo specificato di oggetto restituito è controllato dal provider utilizzato.</span><span class="sxs-lookup"><span data-stu-id="90336-164">The specified type of object that is returned is controlled by the provider that is used.</span></span> <span data-ttu-id="90336-165">In questo caso, utilizzo il provider System. Data. SqlClient come specificato nella sezione &lt;connectionStrings&gt; del file Web. config.</span><span class="sxs-lookup"><span data-stu-id="90336-165">In this case, I'm using the System.Data.SqlClient provider as specified in the &lt;connectionStrings&gt; section of the web.config file.</span></span> <span data-ttu-id="90336-166">Pertanto, l'oggetto restituito sarà di tipo SqlDataReader.</span><span class="sxs-lookup"><span data-stu-id="90336-166">Therefore, the object that is returned will be of type SqlDataReader.</span></span> <span data-ttu-id="90336-167">Specificando un valore DataSourceMode del set di dati, i dati possono essere archiviati in un set di dati nel server.</span><span class="sxs-lookup"><span data-stu-id="90336-167">By specifying a DataSourceMode value of DataSet, the data can be stored in a DataSet on the server.</span></span> <span data-ttu-id="90336-168">Questa modalità consente di aggiungere funzionalità, ad esempio l'ordinamento, il paging e così via. Se il SqlDataSource è stato associato a un controllo GridView, avrei scelto la modalità del set di dati.</span><span class="sxs-lookup"><span data-stu-id="90336-168">This mode allows you to add features such as sorting, paging, etc. If I had been data-binding the SqlDataSource to a GridView control, I would have chosen the DataSet mode.</span></span> <span data-ttu-id="90336-169">Tuttavia, nel caso di un oggetto DropDownList, la modalità DataReader è la scelta corretta.</span><span class="sxs-lookup"><span data-stu-id="90336-169">However, in the case of a DropDownList, the DataReader mode is the correct choice.</span></span>

> [!NOTE]
> <span data-ttu-id="90336-170">Quando si memorizza nella cache un SqlDataSource o un AccessDataSource, è necessario impostare la proprietà DataSourceMode su DataSet.</span><span class="sxs-lookup"><span data-stu-id="90336-170">When caching a SqlDataSource or an AccessDataSource, the DataSourceMode property must be set to DataSet.</span></span> <span data-ttu-id="90336-171">Si verificherà un'eccezione se si Abilita la memorizzazione nella cache con un oggetto DataSourceMode di DataReader.</span><span class="sxs-lookup"><span data-stu-id="90336-171">An exception will occur if you enable caching with a DataSourceMode of DataReader.</span></span>

## <a name="sqldatasource-properties"></a><span data-ttu-id="90336-172">Proprietà SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="90336-172">SqlDataSource Properties</span></span>

<span data-ttu-id="90336-173">Di seguito sono riportate alcune delle proprietà del controllo SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="90336-173">The following are some of the properties of the SqlDataSource control.</span></span>

### <a name="cancelselectonnullparameter"></a><span data-ttu-id="90336-174">CancelSelectOnNullParameter</span><span class="sxs-lookup"><span data-stu-id="90336-174">CancelSelectOnNullParameter</span></span>

<span data-ttu-id="90336-175">Valore booleano che specifica se un comando SELECT viene annullato se uno dei parametri è null.</span><span class="sxs-lookup"><span data-stu-id="90336-175">A Boolean value that specifies whether a select command is canceled if one of the parameters is null.</span></span> <span data-ttu-id="90336-176">True per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="90336-176">True by default.</span></span>

### <a name="conflictdetection"></a><span data-ttu-id="90336-177">ConflictDetection</span><span class="sxs-lookup"><span data-stu-id="90336-177">ConflictDetection</span></span>

<span data-ttu-id="90336-178">In una situazione in cui più utenti possono aggiornare un'origine dati nello stesso momento, la proprietà ConflictDetection determina il comportamento del controllo SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="90336-178">In a situation where multiple users may be updating a data source at the same time, the ConflictDetection property determines the behavior of the SqlDataSource control.</span></span> <span data-ttu-id="90336-179">Questa proprietà restituisce uno dei valori dell'enumerazione ConflictOptions.</span><span class="sxs-lookup"><span data-stu-id="90336-179">This property evaluates to one of the values of the ConflictOptions enumeration.</span></span> <span data-ttu-id="90336-180">Tali valori sono **CompareAllValues** e **OverwriteChanges**.</span><span class="sxs-lookup"><span data-stu-id="90336-180">Those values are **CompareAllValues** and **OverwriteChanges**.</span></span> <span data-ttu-id="90336-181">Se impostato su OverwriteChanges, l'ultima persona che scrive i dati nell'origine dati sovrascrive le eventuali modifiche precedenti.</span><span class="sxs-lookup"><span data-stu-id="90336-181">If set to OverwriteChanges, the last person to write data to the data source overwrites any previous changes.</span></span> <span data-ttu-id="90336-182">Tuttavia, se la proprietà ConflictDetection è impostata su CompareAllValues, vengono creati anche i parametri creati per le colonne restituite da SelectCommand e i parametri per mantenere i valori originali in ognuna di queste colonne consentendo a SqlDataSource di determinare se i valori sono stati modificati dopo l'esecuzione di SelectCommand.</span><span class="sxs-lookup"><span data-stu-id="90336-182">However, if the ConflictDetection property is set to CompareAllValues, parameters get created for the columns returned by the SelectCommand and parameters are also created to hold the original values in each of those columns allowing the SqlDataSource to determine whether or not the values have changed since the SelectCommand was executed.</span></span>

### <a name="deletecommand"></a><span data-ttu-id="90336-183">DeleteCommand</span><span class="sxs-lookup"><span data-stu-id="90336-183">DeleteCommand</span></span>

<span data-ttu-id="90336-184">Ottiene o imposta la stringa SQL utilizzata durante l'eliminazione di righe dal database.</span><span class="sxs-lookup"><span data-stu-id="90336-184">Sets or gets the SQL string used when deleting rows from the database.</span></span> <span data-ttu-id="90336-185">Può trattarsi di una query SQL o di un nome stored procedure.</span><span class="sxs-lookup"><span data-stu-id="90336-185">This can either be a SQL query or a stored procedure name.</span></span>

### <a name="deletecommandtype"></a><span data-ttu-id="90336-186">DeleteCommandType</span><span class="sxs-lookup"><span data-stu-id="90336-186">DeleteCommandType</span></span>

<span data-ttu-id="90336-187">Ottiene o imposta il tipo di comando DELETE, ovvero una query SQL (testo) o un stored procedure (StoredProcedure).</span><span class="sxs-lookup"><span data-stu-id="90336-187">Sets or gets the type of delete command, either a SQL query (Text) or a stored procedure (StoredProcedure).</span></span>

### <a name="deleteparameters"></a><span data-ttu-id="90336-188">DeleteParameters</span><span class="sxs-lookup"><span data-stu-id="90336-188">DeleteParameters</span></span>

<span data-ttu-id="90336-189">Restituisce i parametri utilizzati dal DeleteCommand dell'oggetto SqlDataSourceView associato al controllo SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="90336-189">Returns the parameters that are used by the DeleteCommand of the SqlDataSourceView object associated with the SqlDataSource control.</span></span>

### <a name="oldvaluesparameterformatstring"></a><span data-ttu-id="90336-190">OldValuesParameterFormatString</span><span class="sxs-lookup"><span data-stu-id="90336-190">OldValuesParameterFormatString</span></span>

<span data-ttu-id="90336-191">Questa proprietà viene utilizzata per specificare il formato dei parametri del valore originale nei casi in cui la proprietà ConflictDetection è impostata su CompareAllValues.</span><span class="sxs-lookup"><span data-stu-id="90336-191">This property is used to specify the format of the original value parameters in cases where the ConflictDetection property is set to CompareAllValues.</span></span> <span data-ttu-id="90336-192">Il valore predefinito è {0}, che indica che i parametri del valore originale hanno lo stesso nome del parametro originale.</span><span class="sxs-lookup"><span data-stu-id="90336-192">The default is {0} which means that original value parameters will take the same name as the original parameter.</span></span> <span data-ttu-id="90336-193">In altre parole, se il nome del campo è EmployeeID, il parametro del valore originale verrebbe @EmployeeID.</span><span class="sxs-lookup"><span data-stu-id="90336-193">In other words, if the field name is EmployeeID, the original value parameter would be @EmployeeID.</span></span>

### <a name="selectcommand"></a><span data-ttu-id="90336-194">SelectCommand</span><span class="sxs-lookup"><span data-stu-id="90336-194">SelectCommand</span></span>

<span data-ttu-id="90336-195">Ottiene o imposta la stringa SQL utilizzata per recuperare i dati dal database.</span><span class="sxs-lookup"><span data-stu-id="90336-195">Sets or gets the SQL string that is used to retrieve data from the database.</span></span> <span data-ttu-id="90336-196">Può trattarsi di una query SQL o di un nome stored procedure.</span><span class="sxs-lookup"><span data-stu-id="90336-196">This can either be a SQL query or a stored procedure name.</span></span>

### <a name="selectcommandtype"></a><span data-ttu-id="90336-197">SelectCommandType</span><span class="sxs-lookup"><span data-stu-id="90336-197">SelectCommandType</span></span>

<span data-ttu-id="90336-198">Ottiene o imposta il tipo di comando SELECT, ovvero una query SQL (testo) o un stored procedure (StoredProcedure).</span><span class="sxs-lookup"><span data-stu-id="90336-198">Sets or gets the type of select command, either a SQL query (Text) or a stored procedure (StoredProcedure).</span></span>

### <a name="selectparameters"></a><span data-ttu-id="90336-199">SelectParameters</span><span class="sxs-lookup"><span data-stu-id="90336-199">SelectParameters</span></span>

<span data-ttu-id="90336-200">Restituisce i parametri utilizzati dal SelectCommand dell'oggetto SqlDataSourceView associato al controllo SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="90336-200">Returns the parameters that are used by the SelectCommand of the SqlDataSourceView object associated with the SqlDataSource control.</span></span>

### <a name="sortparametername"></a><span data-ttu-id="90336-201">SortParameterName</span><span class="sxs-lookup"><span data-stu-id="90336-201">SortParameterName</span></span>

<span data-ttu-id="90336-202">Ottiene o imposta il nome di un parametro di stored procedure utilizzato durante l'ordinamento dei dati recuperati dal controllo origine dati.</span><span class="sxs-lookup"><span data-stu-id="90336-202">Gets or sets the name of a stored procedure parameter that is used when sorting data retrieved by the data source control.</span></span> <span data-ttu-id="90336-203">Valido solo quando SelectCommandType è impostato su StoredProcedure.</span><span class="sxs-lookup"><span data-stu-id="90336-203">Valid only when SelectCommandType is set to StoredProcedure.</span></span>

### <a name="sqlcachedependency"></a><span data-ttu-id="90336-204">SqlCacheDependency</span><span class="sxs-lookup"><span data-stu-id="90336-204">SqlCacheDependency</span></span>

<span data-ttu-id="90336-205">Stringa delimitata da punto e virgola che specifica i database e le tabelle utilizzati in una dipendenza della cache SQL Server.</span><span class="sxs-lookup"><span data-stu-id="90336-205">A semi-colon delimited string specifying the databases and tables used in a SQL Server cache dependency.</span></span> <span data-ttu-id="90336-206">Le dipendenze della cache SQL verranno discusse in un modulo successivo.</span><span class="sxs-lookup"><span data-stu-id="90336-206">(SQL cache dependencies will be discussed in a later module.)</span></span>

### <a name="updatecommand"></a><span data-ttu-id="90336-207">UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="90336-207">UpdateCommand</span></span>

<span data-ttu-id="90336-208">Ottiene o imposta la stringa SQL utilizzata per aggiornare i dati nel database.</span><span class="sxs-lookup"><span data-stu-id="90336-208">Sets or gets the SQL string that is used when updating data in the database.</span></span> <span data-ttu-id="90336-209">Può trattarsi di una query SQL o di un nome stored procedure.</span><span class="sxs-lookup"><span data-stu-id="90336-209">This can either be a SQL query or a stored procedure name.</span></span>

### <a name="updatecommandtype"></a><span data-ttu-id="90336-210">UpdateCommandType</span><span class="sxs-lookup"><span data-stu-id="90336-210">UpdateCommandType</span></span>

<span data-ttu-id="90336-211">Imposta o ottiene il tipo di comando di aggiornamento, ovvero una query SQL (testo) o un stored procedure (StoredProcedure).</span><span class="sxs-lookup"><span data-stu-id="90336-211">Sets or gets the type of update command, either a SQL query (Text) or a stored procedure (StoredProcedure).</span></span>

### <a name="updateparameters"></a><span data-ttu-id="90336-212">UpdateParameters</span><span class="sxs-lookup"><span data-stu-id="90336-212">UpdateParameters</span></span>

<span data-ttu-id="90336-213">Restituisce i parametri utilizzati dal UpdateCommand dell'oggetto SqlDataSourceView associato al controllo SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="90336-213">Returns the parameters that are used by the UpdateCommand of the SqlDataSourceView object associated with the SqlDataSource control.</span></span>

## <a name="the-accessdatasource-control"></a><span data-ttu-id="90336-214">Controllo AccessDataSource</span><span class="sxs-lookup"><span data-stu-id="90336-214">The AccessDataSource Control</span></span>

<span data-ttu-id="90336-215">Il controllo AccessDataSource deriva dalla classe SqlDataSource e viene utilizzato per eseguire l'associazione dati a un database di Microsoft Access.</span><span class="sxs-lookup"><span data-stu-id="90336-215">The AccessDataSource control derives from the SqlDataSource class and is used to data-bind to a Microsoft Access database.</span></span> <span data-ttu-id="90336-216">La proprietà ConnectionString per il controllo AccessDataSource è una proprietà di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="90336-216">The ConnectionString property for the AccessDataSource control is a read-only property.</span></span> <span data-ttu-id="90336-217">Anziché utilizzare la proprietà ConnectionString, la proprietà DataFile viene utilizzata per puntare al database di Access, come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="90336-217">Instead of using the ConnectionString property, the DataFile property is used to point to the Access Database as shown below.</span></span>

[!code-aspx[Main](data-source-controls/samples/sample4.aspx)]

<span data-ttu-id="90336-218">L'oggetto AccessDataSource imposta sempre il ProviderName dell'oggetto SqlDataSource di base su System. Data. OleDb e si connette al database usando il provider di OLE DB Microsoft. Jet. OLEDB. 4.0.</span><span class="sxs-lookup"><span data-stu-id="90336-218">The AccessDataSource will always set the ProviderName of the base SqlDataSource to System.Data.OleDb and connects to the database using the Microsoft.Jet.OLEDB.4.0 OLE DB provider.</span></span> <span data-ttu-id="90336-219">Non è possibile utilizzare il controllo AccessDataSource per connettersi a un database di Access protetto da password.</span><span class="sxs-lookup"><span data-stu-id="90336-219">You cannot use the AccessDataSource control to connect to a password-protected Access database.</span></span> <span data-ttu-id="90336-220">Se è necessario connettersi a un database protetto da password, è necessario utilizzare il controllo SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="90336-220">If you have to connect to a password protected database, you should use the SqlDataSource control.</span></span>

> [!NOTE]
> <span data-ttu-id="90336-221">I database di Access archiviati nel sito Web devono essere inseriti nell'app\_directory dei dati.</span><span class="sxs-lookup"><span data-stu-id="90336-221">Access databases stored within the Web site should be placed in the App\_Data directory.</span></span> <span data-ttu-id="90336-222">ASP.NET non consente l'esplorazione dei file presenti in questa directory.</span><span class="sxs-lookup"><span data-stu-id="90336-222">ASP.NET does not allow files in this directory to be browsed.</span></span> <span data-ttu-id="90336-223">È necessario concedere all'account di processo le autorizzazioni di lettura e scrittura per l'app\_directory dati quando si usano i database di Access.</span><span class="sxs-lookup"><span data-stu-id="90336-223">You will need to grant the process account Read and Write permissions to the App\_Data directory when using Access databases.</span></span>

## <a name="the-xmldatasource-control"></a><span data-ttu-id="90336-224">Controllo XmlDataSource</span><span class="sxs-lookup"><span data-stu-id="90336-224">The XmlDataSource Control</span></span>

<span data-ttu-id="90336-225">XmlDataSource viene utilizzato per associare dati XML ai controlli con associazione a dati.</span><span class="sxs-lookup"><span data-stu-id="90336-225">The XmlDataSource is used to data-bind XML data to data-bound controls.</span></span> <span data-ttu-id="90336-226">È possibile eseguire l'associazione a un file XML usando la proprietà DataFile oppure è possibile eseguire l'associazione a una stringa XML usando la proprietà Data.</span><span class="sxs-lookup"><span data-stu-id="90336-226">You can bind to an XML file using the DataFile property or you can bind to an XML string using the Data property.</span></span> <span data-ttu-id="90336-227">XmlDataSource espone gli attributi XML come campi associabili.</span><span class="sxs-lookup"><span data-stu-id="90336-227">The XmlDataSource exposes XML attributes as bindable fields.</span></span> <span data-ttu-id="90336-228">Nei casi in cui è necessario eseguire l'associazione a valori che non sono rappresentati come attributi, sarà necessario utilizzare una trasformazione XSL.</span><span class="sxs-lookup"><span data-stu-id="90336-228">In cases where you need to bind to values that are not represented as attributes, you will need to use an XSL transform.</span></span> <span data-ttu-id="90336-229">Per filtrare i dati XML, è inoltre possibile utilizzare espressioni XPath.</span><span class="sxs-lookup"><span data-stu-id="90336-229">You can also use XPath expressions to filter XML data.</span></span>

<span data-ttu-id="90336-230">Si consideri il seguente file XML:</span><span class="sxs-lookup"><span data-stu-id="90336-230">Consider the following XML file:</span></span>

[!code-xml[Main](data-source-controls/samples/sample5.xml)]

<span data-ttu-id="90336-231">Si noti che XmlDataSource usa una proprietà XPath di *People/Person* per filtrare solo i nodi &lt;persona&gt;.</span><span class="sxs-lookup"><span data-stu-id="90336-231">Notice that the XmlDataSource uses an XPath property of *People/Person* in order to filter on just the &lt;Person&gt; nodes.</span></span> <span data-ttu-id="90336-232">Il DropDownList esegue quindi il binding dei dati all'attributo LastName usando la proprietà TextField.</span><span class="sxs-lookup"><span data-stu-id="90336-232">The DropDownList then data-binds to the LastName attribute using the DataTextField property.</span></span>

<span data-ttu-id="90336-233">Sebbene il controllo XmlDataSource venga utilizzato principalmente per l'associazione dati ai dati XML di sola lettura, è possibile modificare il file di dati XML.</span><span class="sxs-lookup"><span data-stu-id="90336-233">While the XmlDataSource control is primarily used to data-bind to read-only XML data, it is possible to edit the XML data file.</span></span> <span data-ttu-id="90336-234">Si noti che in questi casi, l'inserimento automatico, l'aggiornamento e l'eliminazione delle informazioni nel file XML non vengono effettuati automaticamente come avviene con altri controlli origine dati.</span><span class="sxs-lookup"><span data-stu-id="90336-234">Note that in such cases, automatic insertion, updating, and deletion of information in the XML file does not happen automatically as it does with other data source controls.</span></span> <span data-ttu-id="90336-235">Sarà invece necessario scrivere codice per modificare manualmente i dati utilizzando i metodi seguenti del controllo XmlDataSource.</span><span class="sxs-lookup"><span data-stu-id="90336-235">Instead, you will have to write code to manually edit the data using the following methods of the XmlDataSource control.</span></span>

### <a name="getxmldocument"></a><span data-ttu-id="90336-236">GetXmlDocument</span><span class="sxs-lookup"><span data-stu-id="90336-236">GetXmlDocument</span></span>

<span data-ttu-id="90336-237">Recupera un oggetto XmlDocument contenente il codice XML recuperato da XmlDataSource.</span><span class="sxs-lookup"><span data-stu-id="90336-237">Retrieves an XmlDocument object containing the XML code retrieved by the XmlDataSource.</span></span>

### <a name="save"></a><span data-ttu-id="90336-238">Salva</span><span class="sxs-lookup"><span data-stu-id="90336-238">Save</span></span>

<span data-ttu-id="90336-239">Salva di nuovo l'oggetto XmlDocument in memoria nell'origine dati.</span><span class="sxs-lookup"><span data-stu-id="90336-239">Saves the in-memory XmlDocument back to the data source.</span></span>

<span data-ttu-id="90336-240">È importante tenere presente che il metodo Save funziona solo quando vengono soddisfatte le due condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="90336-240">It's important to realize that the Save method will only work when the following two conditions are met:</span></span>

1. <span data-ttu-id="90336-241">XmlDataSource usa la proprietà DataFile per eseguire l'associazione a un file XML invece che alla proprietà data per l'associazione a dati XML in memoria.</span><span class="sxs-lookup"><span data-stu-id="90336-241">The XmlDataSource is using the DataFile property to bind to an XML file instead of the Data property to bind to in-memory XML data.</span></span>
2. <span data-ttu-id="90336-242">Non viene specificata alcuna trasformazione tramite la proprietà Transform o TransformFile.</span><span class="sxs-lookup"><span data-stu-id="90336-242">No transformation is specified via the Transform or TransformFile property.</span></span>

<span data-ttu-id="90336-243">Si noti inoltre che il metodo Save può produrre risultati imprevisti quando viene chiamato da più utenti contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="90336-243">Note also that the Save method can yield unexpected results when called by multiple users concurrently.</span></span>

## <a name="the-objectdatasource-control"></a><span data-ttu-id="90336-244">Controllo ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="90336-244">The ObjectDataSource Control</span></span>

<span data-ttu-id="90336-245">I controlli origine dati che abbiamo analizzato fino a questo punto sono ottime opzioni per le applicazioni a due livelli in cui il controllo origine dati comunica direttamente con l'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="90336-245">The data source controls that we have covered up to this point are excellent choices for two-tier applications where the data source control communicates directly to the data store.</span></span> <span data-ttu-id="90336-246">Tuttavia, molte applicazioni reali sono applicazioni multilivello in cui un controllo origine dati potrebbe dover comunicare con un oggetto business che, a sua volta, comunica con il livello dati.</span><span class="sxs-lookup"><span data-stu-id="90336-246">However, many real-world applications are multi-tier applications where a data source control might need to communicate to a business object which, in turn, communicates with the data layer.</span></span> <span data-ttu-id="90336-247">In queste situazioni, ObjectDataSource riempie la fattura.</span><span class="sxs-lookup"><span data-stu-id="90336-247">In these situations, the ObjectDataSource fills the bill nicely.</span></span> <span data-ttu-id="90336-248">ObjectDataSource funziona insieme a un oggetto di origine.</span><span class="sxs-lookup"><span data-stu-id="90336-248">The ObjectDataSource works in conjunction with a source object.</span></span> <span data-ttu-id="90336-249">Il controllo ObjectDataSource creerà un'istanza dell'oggetto di origine, chiamerà il metodo specificato ed eliminerà l'istanza dell'oggetto all'interno dell'ambito di una singola richiesta, se l'oggetto dispone di metodi di istanza anziché di metodi statici (Shared in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="90336-249">The ObjectDataSource control will create an instance of the source object, call the specified method, and dispose of the object instance all within the scope of a single request, if your object has instance methods instead of static methods (Shared in Visual Basic).</span></span> <span data-ttu-id="90336-250">Pertanto, l'oggetto deve essere senza stato.</span><span class="sxs-lookup"><span data-stu-id="90336-250">Therefore, your object must be stateless.</span></span> <span data-ttu-id="90336-251">Ovvero, l'oggetto deve acquisire e rilasciare tutte le risorse necessarie entro l'intervallo di una singola richiesta.</span><span class="sxs-lookup"><span data-stu-id="90336-251">That is, your object should acquire and release all required resources within the span of a single request.</span></span> <span data-ttu-id="90336-252">È possibile controllare la modalità di creazione dell'oggetto di origine gestendo l'evento ObjectCreating del controllo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="90336-252">You can control how the source object is created by handling the ObjectCreating event of the ObjectDataSource control.</span></span> <span data-ttu-id="90336-253">È possibile creare un'istanza dell'oggetto di origine, quindi impostare la proprietà ObjectInstance della classe ObjectDataSourceEventArgs su tale istanza.</span><span class="sxs-lookup"><span data-stu-id="90336-253">You can create an instance of the source object, and then set the ObjectInstance property of the ObjectDataSourceEventArgs class to that instance.</span></span> <span data-ttu-id="90336-254">Il controllo ObjectDataSource utilizzerà l'istanza creata nell'evento ObjectCreating anziché creare un'istanza autonomamente.</span><span class="sxs-lookup"><span data-stu-id="90336-254">The ObjectDataSource control will use the instance that is created in the ObjectCreating event instead of creating an instance on its own.</span></span>

<span data-ttu-id="90336-255">Se l'oggetto di origine per un controllo ObjectDataSource espone metodi statici pubblici (condivisi in Visual Basic) che possono essere chiamati per recuperare e modificare i dati, un controllo ObjectDataSource chiamerà direttamente tali metodi.</span><span class="sxs-lookup"><span data-stu-id="90336-255">If the source object for an ObjectDataSource control exposes public static methods (Shared in Visual Basic) that can be called to retrieve and modify data, an ObjectDataSource control will call those methods directly.</span></span> <span data-ttu-id="90336-256">Se un controllo ObjectDataSource deve creare un'istanza dell'oggetto di origine per poter effettuare chiamate al metodo, l'oggetto deve includere un costruttore pubblico che non accetta parametri.</span><span class="sxs-lookup"><span data-stu-id="90336-256">If an ObjectDataSource control must create an instance of the source object in order to make method calls, the object must include a public constructor that takes no parameters.</span></span> <span data-ttu-id="90336-257">Il controllo ObjectDataSource chiamerà questo costruttore quando crea una nuova istanza dell'oggetto di origine.</span><span class="sxs-lookup"><span data-stu-id="90336-257">The ObjectDataSource control will call this constructor when it creates a new instance of the source object.</span></span>

<span data-ttu-id="90336-258">Se l'oggetto di origine non contiene un costruttore pubblico senza parametri, è possibile creare un'istanza dell'oggetto di origine che verrà utilizzato dal controllo ObjectDataSource nell'evento ObjectCreating.</span><span class="sxs-lookup"><span data-stu-id="90336-258">If the source object does not contain a public constructor without parameters, you can create an instance of the source object that will be used by the ObjectDataSource control in the ObjectCreating event.</span></span>

## <a name="specifying-object-methods"></a><span data-ttu-id="90336-259">Specifica di metodi oggetto</span><span class="sxs-lookup"><span data-stu-id="90336-259">Specifying Object Methods</span></span>

<span data-ttu-id="90336-260">L'oggetto di origine per un controllo ObjectDataSource può contenere un numero qualsiasi di metodi utilizzati per selezionare, inserire, aggiornare o eliminare dati.</span><span class="sxs-lookup"><span data-stu-id="90336-260">The source object for an ObjectDataSource control can contain any number of methods that are used to select, insert, update, or delete data.</span></span> <span data-ttu-id="90336-261">Questi metodi vengono chiamati dal controllo ObjectDataSource in base al nome del metodo, come identificato tramite la proprietà SelectMethod, InsertMethod, UpdateMethod o DeleteMethod del controllo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="90336-261">These methods are called by the ObjectDataSource control based on the name of the method, as identified by using either the SelectMethod, InsertMethod, UpdateMethod, or DeleteMethod property of the ObjectDataSource control.</span></span> <span data-ttu-id="90336-262">L'oggetto di origine può includere anche un metodo SelectCount facoltativo, identificato dal controllo ObjectDataSource usando la proprietà SelectCountMethod, che restituisce il conteggio del numero totale di oggetti nell'origine dati.</span><span class="sxs-lookup"><span data-stu-id="90336-262">The source object can also include an optional SelectCount method, which is identified by the ObjectDataSource control using the SelectCountMethod property, that returns the count of the total number of objects at the data source.</span></span> <span data-ttu-id="90336-263">Il controllo ObjectDataSource chiamerà il metodo SelectCount dopo che è stato chiamato un metodo Select per recuperare il numero totale di record nell'origine dati da utilizzare per il paging.</span><span class="sxs-lookup"><span data-stu-id="90336-263">The ObjectDataSource control will call the SelectCount method after a Select method has been called to retrieve the total number of records at the data source for use when paging.</span></span>

## <a name="lab-using-data-source-controls"></a><span data-ttu-id="90336-264">Lab con i controlli origine dati</span><span class="sxs-lookup"><span data-stu-id="90336-264">Lab Using Data Source Controls</span></span>

## <a name="exercise-1---displaying-data-with-the-sqldatasource-control"></a><span data-ttu-id="90336-265">Esercizio 1: visualizzazione dei dati con il controllo SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="90336-265">Exercise 1 - Displaying Data with the SqlDataSource Control</span></span>

<span data-ttu-id="90336-266">Nell'esercizio seguente viene utilizzato il controllo SqlDataSource per la connessione al database Northwind.</span><span class="sxs-lookup"><span data-stu-id="90336-266">The following exercise uses the SqlDataSource control to connect to the Northwind database.</span></span> <span data-ttu-id="90336-267">Si presuppone che si disponga dell'accesso al database Northwind in un'istanza di SQL Server 2000.</span><span class="sxs-lookup"><span data-stu-id="90336-267">It assumes that you have access to the Northwind database on a SQL Server 2000 instance.</span></span>

1. <span data-ttu-id="90336-268">Creare un nuovo sito Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="90336-268">Create a new ASP.NET Web site.</span></span>
2. <span data-ttu-id="90336-269">Aggiungere un nuovo file Web. config.</span><span class="sxs-lookup"><span data-stu-id="90336-269">Add a new web.config file.</span></span>

    1. <span data-ttu-id="90336-270">Fare clic con il pulsante destro del mouse sul progetto in Esplora soluzioni e scegliere Aggiungi nuovo elemento.</span><span class="sxs-lookup"><span data-stu-id="90336-270">Right-click on the project in Solution Explorer and click Add New Item.</span></span>
    2. <span data-ttu-id="90336-271">Scegliere file di configurazione Web dall'elenco di modelli e fare clic su Aggiungi.</span><span class="sxs-lookup"><span data-stu-id="90336-271">Choose Web Configuration File from the list of templates and click Add.</span></span>
3. <span data-ttu-id="90336-272">Modificare la sezione &lt;connectionStrings&gt; come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="90336-272">Edit the &lt;connectionStrings&gt; section as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample6.aspx)]
4. <span data-ttu-id="90336-273">Passare alla visualizzazione codice e aggiungere un attributo ConnectionString e un attributo SelectCommand al controllo &lt;ASP: SqlDataSource&gt; come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="90336-273">Switch to Code view and add a ConnectionString attribute and a SelectCommand attribute to the &lt;asp:SqlDataSource&gt; control as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample7.aspx)]
5. <span data-ttu-id="90336-274">Dalla visualizzazione Progettazione aggiungere un nuovo controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="90336-274">From Design view, add a new GridView control.</span></span>
6. <span data-ttu-id="90336-275">Dall'elenco a discesa Scegli origine dati nel menu attività di GridView scegliere SqlDataSource1.</span><span class="sxs-lookup"><span data-stu-id="90336-275">From the Choose Data Source dropdown in the GridView Tasks menu, choose SqlDataSource1.</span></span>
7. <span data-ttu-id="90336-276">Fare clic con il pulsante destro del mouse su default. aspx e scegliere Visualizza nel browser dal menu.</span><span class="sxs-lookup"><span data-stu-id="90336-276">Right-click on Default.aspx and choose View in Browser from the menu.</span></span> <span data-ttu-id="90336-277">Quando viene richiesto di salvare, fare clic su Sì.</span><span class="sxs-lookup"><span data-stu-id="90336-277">Click Yes when prompted to save.</span></span>
8. <span data-ttu-id="90336-278">GridView Visualizza i dati della tabella Products.</span><span class="sxs-lookup"><span data-stu-id="90336-278">The GridView displays the data from the Products table.</span></span>

## <a name="exercise-2---editing-data-with-the-sqldatasource-control"></a><span data-ttu-id="90336-279">Esercizio 2: modifica di dati con il controllo SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="90336-279">Exercise 2 - Editing Data with the SqlDataSource Control</span></span>

<span data-ttu-id="90336-280">Nell'esercizio seguente viene illustrato come associare un controllo DropDownList utilizzando la sintassi dichiarativa e consente di modificare i dati presentati nel controllo DropDownList.</span><span class="sxs-lookup"><span data-stu-id="90336-280">The following exercise demonstrates how to data bind a DropDownList control using the declarative syntax and allows you to edit the data presented in the DropDownList control.</span></span>

1. <span data-ttu-id="90336-281">In visualizzazione progettazione eliminare il controllo GridView da default. aspx.</span><span class="sxs-lookup"><span data-stu-id="90336-281">In Design view, delete the GridView control from Default.aspx.</span></span> 

    <span data-ttu-id="90336-282">**Importante**: lasciare il controllo SqlDataSource nella pagina.</span><span class="sxs-lookup"><span data-stu-id="90336-282">**Important**: Leave the SqlDataSource control on the page.</span></span>
2. <span data-ttu-id="90336-283">Aggiungere un controllo DropDownList a default. aspx.</span><span class="sxs-lookup"><span data-stu-id="90336-283">Add a DropDownList control to Default.aspx.</span></span>
3. <span data-ttu-id="90336-284">Passa alla visualizzazione origine.</span><span class="sxs-lookup"><span data-stu-id="90336-284">Switch to Source view.</span></span>
4. <span data-ttu-id="90336-285">Aggiungere un attributo DataSourceID, TextField e DataValueField al controllo &lt;ASP: DropDownList&gt; come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="90336-285">Add a DataSourceId, DataTextField, and DataValueField attribute to the &lt;asp:DropDownList&gt; control as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample8.aspx)]
5. <span data-ttu-id="90336-286">Salvare default. aspx e visualizzarlo nel browser.</span><span class="sxs-lookup"><span data-stu-id="90336-286">Save Default.aspx and view it in the browser.</span></span> <span data-ttu-id="90336-287">Si noti che il DropDownList contiene tutti i prodotti del database Northwind.</span><span class="sxs-lookup"><span data-stu-id="90336-287">Note that the DropDownList contains all of the products from the Northwind database.</span></span>
6. <span data-ttu-id="90336-288">Chiudere il browser.</span><span class="sxs-lookup"><span data-stu-id="90336-288">Close the browser.</span></span>
7. <span data-ttu-id="90336-289">Nella visualizzazione origine di default. aspx aggiungere un nuovo controllo TextBox sotto il controllo DropDownList.</span><span class="sxs-lookup"><span data-stu-id="90336-289">In Source view of Default.aspx, add a new TextBox control below the DropDownList control.</span></span> <span data-ttu-id="90336-290">Modificare la proprietà ID della casella di testo in txtProductName.</span><span class="sxs-lookup"><span data-stu-id="90336-290">Change the ID property of the TextBox to txtProductName.</span></span>
8. <span data-ttu-id="90336-291">Sotto il controllo TextBox aggiungere un nuovo controllo Button.</span><span class="sxs-lookup"><span data-stu-id="90336-291">Under the TextBox control, add a new Button control.</span></span> <span data-ttu-id="90336-292">Modificare la proprietà ID del pulsante in btnUpdate e la proprietà Text per **aggiornare il nome del prodotto**.</span><span class="sxs-lookup"><span data-stu-id="90336-292">Change the ID property of the Button to btnUpdate and the Text property to **Update Product Name**.</span></span>
9. <span data-ttu-id="90336-293">Nella visualizzazione origine di default. aspx aggiungere una proprietà UpdateCommand e due nuovi UpdateParameters al tag SqlDataSource come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="90336-293">In Source view of Default.aspx, add an UpdateCommand property and two new UpdateParameters to the SqlDataSource tag as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample9.aspx)]

    > [!NOTE]
    > <span data-ttu-id="90336-294">Si noti che in questo codice sono stati aggiunti due parametri di aggiornamento (ProductName e ProductID).</span><span class="sxs-lookup"><span data-stu-id="90336-294">Note that there are two update parameters (ProductName and ProductID) added in this code.</span></span> <span data-ttu-id="90336-295">Questi parametri vengono mappati alla proprietà Text della casella di testo txtProductName e alla proprietà SelectedValue di DropDownList ddlProducts.</span><span class="sxs-lookup"><span data-stu-id="90336-295">These parameters are mapped to the Text property of the txtProductName TextBox and the SelectedValue property of the ddlProducts DropDownList.</span></span>
10. <span data-ttu-id="90336-296">Passare alla visualizzazione progettazione e fare doppio clic sul controllo Button per aggiungere un gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="90336-296">Switch to Design view and double-click on the Button control to add an event handler.</span></span>
11. <span data-ttu-id="90336-297">Aggiungere il codice seguente al btnUpdate\_fare clic su codice:</span><span class="sxs-lookup"><span data-stu-id="90336-297">Add the following code to the btnUpdate\_Click code:</span></span> 

    [!code-csharp[Main](data-source-controls/samples/sample10.cs)]
12. <span data-ttu-id="90336-298">Fare clic con il pulsante destro del mouse su default. aspx e scegliere di visualizzarlo nel browser.</span><span class="sxs-lookup"><span data-stu-id="90336-298">Right-click on Default.aspx and choose to view it in the browser.</span></span> <span data-ttu-id="90336-299">Quando viene richiesto di salvare tutte le modifiche, fare clic su Sì.</span><span class="sxs-lookup"><span data-stu-id="90336-299">Click Yes when prompted to save all changes.</span></span>
13. <span data-ttu-id="90336-300">Le classi parziali ASP.NET 2,0 consentono la compilazione in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="90336-300">ASP.NET 2.0 partial classes allow for compilation at runtime.</span></span> <span data-ttu-id="90336-301">Non è necessario compilare un'applicazione per fare in modo che le modifiche al codice abbiano effetto.</span><span class="sxs-lookup"><span data-stu-id="90336-301">It is not necessary to build an application in order to see code changes take effect.</span></span>
14. <span data-ttu-id="90336-302">Selezionare un prodotto dal DropDownList.</span><span class="sxs-lookup"><span data-stu-id="90336-302">Select a product from the DropDownList.</span></span>
15. <span data-ttu-id="90336-303">Immettere un nuovo nome per il prodotto selezionato nella casella di testo e quindi fare clic sul pulsante Aggiorna.</span><span class="sxs-lookup"><span data-stu-id="90336-303">Enter a new name for the selected product in the TextBox and then click the Update button.</span></span>
16. <span data-ttu-id="90336-304">Il nome del prodotto viene aggiornato nel database.</span><span class="sxs-lookup"><span data-stu-id="90336-304">The product name is updated in the database.</span></span>

## <a name="exercise-3-using-the-objectdatasource-control"></a><span data-ttu-id="90336-305">Esercizio 3 utilizzo del controllo ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="90336-305">Exercise 3 Using the ObjectDataSource Control</span></span>

<span data-ttu-id="90336-306">In questo esercizio verrà illustrato come utilizzare il controllo ObjectDataSource e un oggetto di origine per interagire con il database Northwind.</span><span class="sxs-lookup"><span data-stu-id="90336-306">This exercise will demonstrate how to use the ObjectDataSource control and a source object to interact with the Northwind database.</span></span>

1. <span data-ttu-id="90336-307">Fare clic con il pulsante destro del mouse sul progetto in Esplora soluzioni e scegliere Aggiungi nuovo elemento.</span><span class="sxs-lookup"><span data-stu-id="90336-307">Right-click on the project in Solution Explorer and click on Add New Item.</span></span>
2. <span data-ttu-id="90336-308">Selezionare Web Form nell'elenco Templates (modelli).</span><span class="sxs-lookup"><span data-stu-id="90336-308">Select Web Form in the templates list.</span></span> <span data-ttu-id="90336-309">Modificare il nome in Object. aspx e fare clic su Aggiungi.</span><span class="sxs-lookup"><span data-stu-id="90336-309">Change the name to object.aspx and click Add.</span></span>
3. <span data-ttu-id="90336-310">Fare clic con il pulsante destro del mouse sul progetto in Esplora soluzioni e scegliere Aggiungi nuovo elemento.</span><span class="sxs-lookup"><span data-stu-id="90336-310">Right-click on the project in Solution Explorer and click on Add New Item.</span></span>
4. <span data-ttu-id="90336-311">Selezionare classe nell'elenco modelli.</span><span class="sxs-lookup"><span data-stu-id="90336-311">Select Class in the templates list.</span></span> <span data-ttu-id="90336-312">Modificare il nome della classe in NorthwindData.cs e fare clic su Aggiungi.</span><span class="sxs-lookup"><span data-stu-id="90336-312">Change the name of the class to NorthwindData.cs and click Add.</span></span>
5. <span data-ttu-id="90336-313">Quando viene richiesto di aggiungere la classe alla cartella del codice\_app, fare clic su Sì.</span><span class="sxs-lookup"><span data-stu-id="90336-313">Click Yes when prompted to add the class to the App\_Code folder.</span></span>
6. <span data-ttu-id="90336-314">Aggiungere il codice seguente al file NorthwindData.cs:</span><span class="sxs-lookup"><span data-stu-id="90336-314">Add the following code to the NorthwindData.cs file:</span></span> 

    [!code-csharp[Main](data-source-controls/samples/sample11.cs)]
7. <span data-ttu-id="90336-315">Aggiungere il codice seguente alla visualizzazione di origine di Object. aspx:</span><span class="sxs-lookup"><span data-stu-id="90336-315">Add the following code to the Source view of object.aspx:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample12.aspx)]
8. <span data-ttu-id="90336-316">Salvare tutti i file e cercare Object. aspx.</span><span class="sxs-lookup"><span data-stu-id="90336-316">Save all files and browse object.aspx.</span></span>
9. <span data-ttu-id="90336-317">Interagire con l'interfaccia visualizzando i dettagli, modificando i dipendenti, aggiungendo i dipendenti ed eliminando i dipendenti.</span><span class="sxs-lookup"><span data-stu-id="90336-317">Interact with the interface by viewing details, editing employees, adding employees, and deleting employees.</span></span>
