---
uid: web-pages/overview/data/5-working-with-data
title: Introduzione all'uso di un Database in ASP.NET Web Pages (Razor) siti | Microsoft Docs
author: Rick-Anderson
description: In questo capitolo descrive come accedere ai dati da un database e visualizzarlo utilizzando ASP.NET Web Pages.
ms.author: riande
ms.date: 02/18/2014
ms.assetid: 673d502f-2c16-4a6f-bb63-dbfd9a77ef47
msc.legacyurl: /web-pages/overview/data/5-working-with-data
msc.type: authoredcontent
ms.openlocfilehash: 4ed2a2a1ee3cff7a50e67b6571b85f74d01efab7
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/06/2019
ms.locfileid: "65133223"
---
# <a name="introduction-to-working-with-a-database-in-aspnet-web-pages-razor-sites"></a><span data-ttu-id="152aa-103">Introduzione all'uso di un Database in ASP.NET Web Pages (Razor) siti</span><span class="sxs-lookup"><span data-stu-id="152aa-103">Introduction to Working with a Database in ASP.NET Web Pages (Razor) Sites</span></span>

<span data-ttu-id="152aa-104">da [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="152aa-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="152aa-105">Questo articolo descrive come usare gli strumenti di Microsoft WebMatrix per creare un database in un sito Web ASP.NET Web Pages (Razor) e come creare pagine che consentono di visualizzare, aggiungere, modificare ed eliminare dati.</span><span class="sxs-lookup"><span data-stu-id="152aa-105">This article describes how to use Microsoft WebMatrix tools to create a database in an ASP.NET Web Pages (Razor) website, and how to create pages that let you display, add, edit, and delete data.</span></span>
> 
> <span data-ttu-id="152aa-106">**Che cosa si apprenderà come:**</span><span class="sxs-lookup"><span data-stu-id="152aa-106">**What you'll learn:**</span></span> 
> 
> - <span data-ttu-id="152aa-107">Come creare un database.</span><span class="sxs-lookup"><span data-stu-id="152aa-107">How to create a database.</span></span>
> - <span data-ttu-id="152aa-108">Come connettersi a un database.</span><span class="sxs-lookup"><span data-stu-id="152aa-108">How to connect to a database.</span></span>
> - <span data-ttu-id="152aa-109">Come visualizzare i dati in una pagina web.</span><span class="sxs-lookup"><span data-stu-id="152aa-109">How to display data in a web page.</span></span>
> - <span data-ttu-id="152aa-110">Come inserire, aggiornare ed eliminare i record del database.</span><span class="sxs-lookup"><span data-stu-id="152aa-110">How to insert, update, and delete database records.</span></span>
> 
> <span data-ttu-id="152aa-111">Queste sono le funzionalità introdotte nell'articolo:</span><span class="sxs-lookup"><span data-stu-id="152aa-111">These are the features introduced in the article:</span></span>
> 
> - <span data-ttu-id="152aa-112">Utilizzo di un database Microsoft SQL Server Compact Edition.</span><span class="sxs-lookup"><span data-stu-id="152aa-112">Working with a Microsoft SQL Server Compact Edition database.</span></span>
> - <span data-ttu-id="152aa-113">Utilizzo di query SQL.</span><span class="sxs-lookup"><span data-stu-id="152aa-113">Working with SQL queries.</span></span>
> - <span data-ttu-id="152aa-114">Classe `Database`.</span><span class="sxs-lookup"><span data-stu-id="152aa-114">The `Database` class.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="152aa-115">Versioni del software utilizzate nell'esercitazione</span><span class="sxs-lookup"><span data-stu-id="152aa-115">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="152aa-116">ASP.NET Web Pages (Razor) 2</span><span class="sxs-lookup"><span data-stu-id="152aa-116">ASP.NET Web Pages (Razor) 2</span></span>
> - <span data-ttu-id="152aa-117">WebMatrix 2</span><span class="sxs-lookup"><span data-stu-id="152aa-117">WebMatrix 2</span></span>
>   
> 
> <span data-ttu-id="152aa-118">Questa esercitazione si integra inoltre con WebMatrix 3.</span><span class="sxs-lookup"><span data-stu-id="152aa-118">This tutorial also works with WebMatrix 3.</span></span> <span data-ttu-id="152aa-119">È possibile usare 3 pagine Web ASP.NET e Visual Studio 2013 (o Visual Studio Express 2013 per il Web); Tuttavia, l'interfaccia utente sarà diversa.</span><span class="sxs-lookup"><span data-stu-id="152aa-119">You can use ASP.NET Web Pages 3 and Visual Studio 2013 (or Visual Studio Express 2013 for Web); however, the user interface will be different.</span></span>

## <a name="introduction-to-databases"></a><span data-ttu-id="152aa-120">Introduzione a database</span><span class="sxs-lookup"><span data-stu-id="152aa-120">Introduction to Databases</span></span>

<span data-ttu-id="152aa-121">Si immagini una rubrica tipico.</span><span class="sxs-lookup"><span data-stu-id="152aa-121">Imagine a typical address book.</span></span> <span data-ttu-id="152aa-122">Per ogni voce della Rubrica (vale a dire, per ogni persona) disporre di varie informazioni quali nome, cognome, indirizzo, indirizzo di posta elettronica e numero di telefono.</span><span class="sxs-lookup"><span data-stu-id="152aa-122">For each entry in the address book (that is, for each person) you have several pieces of information such as first name, last name, address, email address, and phone number.</span></span>

<span data-ttu-id="152aa-123">Un modo comune per i dati immagine simile alla seguente è come una tabella con righe e colonne.</span><span class="sxs-lookup"><span data-stu-id="152aa-123">A typical way to picture data like this is as a table with rows and columns.</span></span> <span data-ttu-id="152aa-124">In termini di database, ogni riga è noto anche come un record.</span><span class="sxs-lookup"><span data-stu-id="152aa-124">In database terms, each row is often referred to as a record.</span></span> <span data-ttu-id="152aa-125">Ogni colonna (talvolta detto campi) contiene un valore per ogni tipo di dati: nome del primo, ultimo nome e così via.</span><span class="sxs-lookup"><span data-stu-id="152aa-125">Each column (sometimes referred to as fields) contains a value for each type of data: first name, last name, and so on.</span></span>

| <span data-ttu-id="152aa-126">**ID**</span><span class="sxs-lookup"><span data-stu-id="152aa-126">**ID**</span></span> | <span data-ttu-id="152aa-127">**FirstName**</span><span class="sxs-lookup"><span data-stu-id="152aa-127">**FirstName**</span></span> | <span data-ttu-id="152aa-128">**LastName**</span><span class="sxs-lookup"><span data-stu-id="152aa-128">**LastName**</span></span> | <span data-ttu-id="152aa-129">**Address**</span><span class="sxs-lookup"><span data-stu-id="152aa-129">**Address**</span></span> | <span data-ttu-id="152aa-130">**Posta elettronica**</span><span class="sxs-lookup"><span data-stu-id="152aa-130">**Email**</span></span> | <span data-ttu-id="152aa-131">**Telefono**</span><span class="sxs-lookup"><span data-stu-id="152aa-131">**Phone**</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="152aa-132">1</span><span class="sxs-lookup"><span data-stu-id="152aa-132">1</span></span> | <span data-ttu-id="152aa-133">Jim</span><span class="sxs-lookup"><span data-stu-id="152aa-133">Jim</span></span> | <span data-ttu-id="152aa-134">Abrus</span><span class="sxs-lookup"><span data-stu-id="152aa-134">Abrus</span></span> | <span data-ttu-id="152aa-135">210 100th St SE Orcas WA 98031</span><span class="sxs-lookup"><span data-stu-id="152aa-135">210 100th St SE Orcas WA 98031</span></span> | jim@contoso.com | <span data-ttu-id="152aa-136">555 0100</span><span class="sxs-lookup"><span data-stu-id="152aa-136">555 0100</span></span> |
| <span data-ttu-id="152aa-137">2</span><span class="sxs-lookup"><span data-stu-id="152aa-137">2</span></span> | <span data-ttu-id="152aa-138">Terry</span><span class="sxs-lookup"><span data-stu-id="152aa-138">Terry</span></span> | <span data-ttu-id="152aa-139">Adams</span><span class="sxs-lookup"><span data-stu-id="152aa-139">Adams</span></span> | <span data-ttu-id="152aa-140">1234 Main St. Seattle WA 99011</span><span class="sxs-lookup"><span data-stu-id="152aa-140">1234 Main St. Seattle WA 99011</span></span> | terry@cohowinery.com | <span data-ttu-id="152aa-141">555 0101</span><span class="sxs-lookup"><span data-stu-id="152aa-141">555 0101</span></span> |

<span data-ttu-id="152aa-142">Per la maggior parte delle tabelle di database, la tabella deve disporre di una colonna che contiene un identificatore univoco, ad esempio un numero cliente, numero di account e così via. Questo è noto come la tabella *chiave primaria*, e usarlo per identificare ogni riga nella tabella.</span><span class="sxs-lookup"><span data-stu-id="152aa-142">For most database tables, the table has to have a column that contains a unique identifier, like a customer number, account number, etc. This is known as the table's *primary key*, and you use it to identify each row in the table.</span></span> <span data-ttu-id="152aa-143">Nell'esempio, la colonna ID è la chiave primaria per la Rubrica.</span><span class="sxs-lookup"><span data-stu-id="152aa-143">In the example, the ID column is the primary key for the address book.</span></span>

<span data-ttu-id="152aa-144">Con questa conoscenza di base dei database, si è pronti per imparare a creare un database semplice ed esegua operazioni di aggiunta, modifica ed eliminazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="152aa-144">With this basic understanding of databases, you're ready to learn how to create a simple database and perform operations such as adding, modifying, and deleting data.</span></span>

> [!TIP] 
> 
> <span data-ttu-id="152aa-145">**Database relazionali**</span><span class="sxs-lookup"><span data-stu-id="152aa-145">**Relational Databases**</span></span>
> 
> <span data-ttu-id="152aa-146">È possibile archiviare i dati in molti modi, tra cui fogli di calcolo e file di testo.</span><span class="sxs-lookup"><span data-stu-id="152aa-146">You can store data in lots of ways, including text files and spreadsheets.</span></span> <span data-ttu-id="152aa-147">Per la maggior parte degli usi di business, tuttavia, i dati vengono archiviati in un database relazionale.</span><span class="sxs-lookup"><span data-stu-id="152aa-147">For most business uses, though, data is stored in a relational database.</span></span>
> 
> <span data-ttu-id="152aa-148">Questo articolo non andare molto approfonditamente nel database.</span><span class="sxs-lookup"><span data-stu-id="152aa-148">This article doesn't go very deeply into databases.</span></span> <span data-ttu-id="152aa-149">Tuttavia, si potrebbe risultare utile per comprendere un po' riguardo.</span><span class="sxs-lookup"><span data-stu-id="152aa-149">However, you might find it useful to understand a little about them.</span></span> <span data-ttu-id="152aa-150">In un database relazionale, informazioni viene suddiviso logicamente in tabelle separate.</span><span class="sxs-lookup"><span data-stu-id="152aa-150">In a relational database, information is logically divided into separate tables.</span></span> <span data-ttu-id="152aa-151">Ad esempio, un database per un istituto di istruzione potrebbe contenere tabelle separate per gli studenti e per le offerte di classe.</span><span class="sxs-lookup"><span data-stu-id="152aa-151">For example, a database for a school might contain separate tables for students and for class offerings.</span></span> <span data-ttu-id="152aa-152">Software (ad esempio SQL Server) supporta avanzato dei comandi di database che consentono in modo dinamico stabiliscono relazioni tra le tabelle.</span><span class="sxs-lookup"><span data-stu-id="152aa-152">The database software (such as SQL Server) supports powerful commands that let you dynamically establish relationships between the tables.</span></span> <span data-ttu-id="152aa-153">Ad esempio, è possibile utilizzare il database relazionale per stabilire una relazione logica tra gli studenti e classi per creare una pianificazione.</span><span class="sxs-lookup"><span data-stu-id="152aa-153">For example, you can use the relational database to establish a logical relationship between students and classes in order to create a schedule.</span></span> <span data-ttu-id="152aa-154">L'archiviazione dei dati in tabelle separate riduce la complessità di struttura della tabella e riduce la necessità di mantenere i dati ridondanti nelle tabelle.</span><span class="sxs-lookup"><span data-stu-id="152aa-154">Storing data in separate tables reduces the complexity of the table structure and reduces the need to keep redundant data in tables.</span></span>

## <a name="creating-a-database"></a><span data-ttu-id="152aa-155">Creazione di un database</span><span class="sxs-lookup"><span data-stu-id="152aa-155">Creating a Database</span></span>

<span data-ttu-id="152aa-156">Questa procedura illustra come creare un database denominato SmallBakery usando lo strumento di progettazione di Database di SQL Server Compact incluso in WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="152aa-156">This procedure shows you how to create a database named SmallBakery by using the SQL Server Compact Database design tool that's included in WebMatrix.</span></span> <span data-ttu-id="152aa-157">Sebbene sia possibile creare un database usando il codice, è più comune per creare il database e tabelle di database utilizzando uno strumento di progettazione, ad esempio WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="152aa-157">Although you can create a database using code, it's more typical to create the database and database tables using a design tool like WebMatrix.</span></span>

1. <span data-ttu-id="152aa-158">Avviare WebMatrix e nella pagina avvio rapido fare clic su **sito da modello**.</span><span class="sxs-lookup"><span data-stu-id="152aa-158">Start WebMatrix, and on the Quick Start page, click **Site From Template**.</span></span>
2. <span data-ttu-id="152aa-159">Selezionare **sito vuoto**e il **nome sito** casella immettere "SmallBakery" e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="152aa-159">Select **Empty Site**, and in the **Site Name** box enter "SmallBakery" and then click **OK**.</span></span> <span data-ttu-id="152aa-160">Il sito verrà creato e visualizzato in WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="152aa-160">The site is created and displayed in WebMatrix.</span></span>
3. <span data-ttu-id="152aa-161">Nel riquadro a sinistra, scegliere il **database** dell'area di lavoro.</span><span class="sxs-lookup"><span data-stu-id="152aa-161">In the left pane, click the **Databases** workspace.</span></span>
4. <span data-ttu-id="152aa-162">Nella barra multifunzione, fare clic su **Nuovo Database**.</span><span class="sxs-lookup"><span data-stu-id="152aa-162">In the ribbon, click **New Database**.</span></span> <span data-ttu-id="152aa-163">Viene creato un database vuoto con lo stesso nome del sito.</span><span class="sxs-lookup"><span data-stu-id="152aa-163">An empty database is created with the same name as your site.</span></span>
5. <span data-ttu-id="152aa-164">Nel riquadro sinistro, espandere la **SmallBakery.sdf** nodo e quindi fare clic su **tabelle**.</span><span class="sxs-lookup"><span data-stu-id="152aa-164">In the left pane, expand the **SmallBakery.sdf** node and then click **Tables**.</span></span>
6. <span data-ttu-id="152aa-165">Nella barra multifunzione, fare clic su **nuova tabella**.</span><span class="sxs-lookup"><span data-stu-id="152aa-165">In the ribbon, click **New Table**.</span></span> <span data-ttu-id="152aa-166">WebMatrix consente di aprire la finestra di progettazione di tabella.</span><span class="sxs-lookup"><span data-stu-id="152aa-166">WebMatrix opens the table designer.</span></span>

    ![[immagine]](5-working-with-data/_static/image1.jpg)
7. <span data-ttu-id="152aa-168">Fare clic nella **Name** colonna e immettere &quot;Id&quot;.</span><span class="sxs-lookup"><span data-stu-id="152aa-168">Click in the **Name** column and enter &quot;Id&quot;.</span></span>
8. <span data-ttu-id="152aa-169">Nel **tipo di dati** colonna, selezionare **int**.</span><span class="sxs-lookup"><span data-stu-id="152aa-169">In the **Data Type** column, select **int**.</span></span>
9. <span data-ttu-id="152aa-170">Impostare il **è chiave primaria?** e **è identificare?** le opzioni per **Sì**.</span><span class="sxs-lookup"><span data-stu-id="152aa-170">Set the **Is Primary Key?** and **Is Identify?** options to **Yes**.</span></span>

    <span data-ttu-id="152aa-171">Come suggerisce il nome, **chiave primaria è** viene indicato al database che si tratterà chiave primaria della tabella.</span><span class="sxs-lookup"><span data-stu-id="152aa-171">As the name suggests, **Is Primary Key** tells the database that this will be the table's primary key.</span></span> <span data-ttu-id="152aa-172">**Identità** indica il database da creare automaticamente un numero di ID per ogni nuovo record e per assegnargli il successivo numero sequenziale (a partire da 1).</span><span class="sxs-lookup"><span data-stu-id="152aa-172">**Is Identity** tells the database to automatically create an ID number for every new record and to assign it the next sequential number (starting at 1).</span></span>
10. <span data-ttu-id="152aa-173">Fare clic nella riga successiva.</span><span class="sxs-lookup"><span data-stu-id="152aa-173">Click in the next row.</span></span> <span data-ttu-id="152aa-174">L'editor viene avviata una nuova definizione di colonna.</span><span class="sxs-lookup"><span data-stu-id="152aa-174">The editor starts a new column definition.</span></span>
11. <span data-ttu-id="152aa-175">Per il valore del nome, immettere &quot;nome&quot;.</span><span class="sxs-lookup"><span data-stu-id="152aa-175">For the Name value, enter &quot;Name&quot;.</span></span>
12. <span data-ttu-id="152aa-176">Per la **tipo di dati**, scegliere &quot;nvarchar&quot; e impostare la lunghezza fino a 50.</span><span class="sxs-lookup"><span data-stu-id="152aa-176">For **Data Type**, choose &quot;nvarchar&quot; and set the length to 50.</span></span> <span data-ttu-id="152aa-177">Il *var* fa parte di `nvarchar` viene indicato al database che i dati per questa colonna sarà una stringa le cui dimensioni possono variare da un record a altro.</span><span class="sxs-lookup"><span data-stu-id="152aa-177">The *var* part of `nvarchar` tells the database that the data for this column will be a string whose size might vary from record to record.</span></span> <span data-ttu-id="152aa-178">(Il *n* prefisso rappresenta *national*, che indica che il campo può contenere dati di tipo carattere che rappresenta qualsiasi alfabeto o sistema di scrittura &#8212; , ovvero che il campo contiene dati Unicode.)</span><span class="sxs-lookup"><span data-stu-id="152aa-178">(The *n* prefix represents *national*, indicating that the field can hold character data that represents any alphabet or writing system &#8212; that is, that the field holds Unicode data.)</span></span>
13. <span data-ttu-id="152aa-179">Impostare il **Ammetti** possibilità **No**.</span><span class="sxs-lookup"><span data-stu-id="152aa-179">Set the **Allow Nulls** option to **No**.</span></span> <span data-ttu-id="152aa-180">Ciò impone che il *nome* colonna non viene lasciata vuota.</span><span class="sxs-lookup"><span data-stu-id="152aa-180">This will enforce that the *Name* column is not left blank.</span></span>
14. <span data-ttu-id="152aa-181">Usando la stessa procedura, creare una colonna denominata *descrizione*.</span><span class="sxs-lookup"><span data-stu-id="152aa-181">Using this same process, create a column named *Description*.</span></span> <span data-ttu-id="152aa-182">Impostare **tipo di dati** "nvarchar" e 50 sono riservati per la lunghezza, quindi impostare **Allow Nulls** su false.</span><span class="sxs-lookup"><span data-stu-id="152aa-182">Set **Data Type** to "nvarchar" and 50 for the length, and set **Allow Nulls** to false.</span></span>
15. <span data-ttu-id="152aa-183">Creare una colonna denominata *Price*.</span><span class="sxs-lookup"><span data-stu-id="152aa-183">Create a column named *Price*.</span></span> <span data-ttu-id="152aa-184">Impostare **tipo di dati "money"** e impostare **Allow Nulls** su false.</span><span class="sxs-lookup"><span data-stu-id="152aa-184">Set **Data Type to "money"** and set **Allow Nulls** to false.</span></span>
16. <span data-ttu-id="152aa-185">Nella casella nella parte superiore di denominare la tabella &quot;prodotto&quot;.</span><span class="sxs-lookup"><span data-stu-id="152aa-185">In the box at the top, name the table &quot;Product&quot;.</span></span>

    <span data-ttu-id="152aa-186">Al termine, la definizione avrà un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-186">When you're done, the definition will look like this:</span></span>

    ![[immagine]](5-working-with-data/_static/image2.jpg)
17. <span data-ttu-id="152aa-188">Premere Ctrl + S per salvare la tabella.</span><span class="sxs-lookup"><span data-stu-id="152aa-188">Press Ctrl+S to save the table.</span></span>

## <a name="adding-data-to-the-database"></a><span data-ttu-id="152aa-189">Aggiunta di dati al Database</span><span class="sxs-lookup"><span data-stu-id="152aa-189">Adding Data to the Database</span></span>

<span data-ttu-id="152aa-190">A questo punto è possibile aggiungere alcuni dati di esempio per il database che verranno usate più avanti nell'articolo.</span><span class="sxs-lookup"><span data-stu-id="152aa-190">Now you can add some sample data to your database that you'll work with later in the article.</span></span>

1. <span data-ttu-id="152aa-191">Nel riquadro sinistro, espandere la **SmallBakery.sdf** nodo e quindi fare clic su **tabelle**.</span><span class="sxs-lookup"><span data-stu-id="152aa-191">In the left pane, expand the **SmallBakery.sdf** node and then click **Tables**.</span></span>
2. <span data-ttu-id="152aa-192">Fare doppio clic nella tabella Product e quindi fare clic su **dati**.</span><span class="sxs-lookup"><span data-stu-id="152aa-192">Right-click the Product table and then click **Data**.</span></span>
3. <span data-ttu-id="152aa-193">Nel riquadro di modifica, immettere i record seguenti:</span><span class="sxs-lookup"><span data-stu-id="152aa-193">In the edit pane, enter the following records:</span></span>

    | <span data-ttu-id="152aa-194">**Name**</span><span class="sxs-lookup"><span data-stu-id="152aa-194">**Name**</span></span> | <span data-ttu-id="152aa-195">**Descrizione**</span><span class="sxs-lookup"><span data-stu-id="152aa-195">**Description**</span></span> | <span data-ttu-id="152aa-196">**Prezzo**</span><span class="sxs-lookup"><span data-stu-id="152aa-196">**Price**</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="152aa-197">Pane</span><span class="sxs-lookup"><span data-stu-id="152aa-197">Bread</span></span> | <span data-ttu-id="152aa-198">Virtuali create con bake aggiornato ogni giorno.</span><span class="sxs-lookup"><span data-stu-id="152aa-198">Baked fresh every day.</span></span> | <span data-ttu-id="152aa-199">2.99</span><span class="sxs-lookup"><span data-stu-id="152aa-199">2.99</span></span> |
    | <span data-ttu-id="152aa-200">Shortcake strawberry</span><span class="sxs-lookup"><span data-stu-id="152aa-200">Strawberry Shortcake</span></span> | <span data-ttu-id="152aa-201">Eseguita con strawberries organica dal nostro giardino.</span><span class="sxs-lookup"><span data-stu-id="152aa-201">Made with organic strawberries from our garden.</span></span> | <span data-ttu-id="152aa-202">9.99</span><span class="sxs-lookup"><span data-stu-id="152aa-202">9.99</span></span> |
    | <span data-ttu-id="152aa-203">Grafico a torta Apple</span><span class="sxs-lookup"><span data-stu-id="152aa-203">Apple Pie</span></span> | <span data-ttu-id="152aa-204">In secondo luogo solo ai grafici a torta di mom.</span><span class="sxs-lookup"><span data-stu-id="152aa-204">Second only to your mom's pie.</span></span> | <span data-ttu-id="152aa-205">12.99</span><span class="sxs-lookup"><span data-stu-id="152aa-205">12.99</span></span> |
    | <span data-ttu-id="152aa-206">Grafico a torta Pecan</span><span class="sxs-lookup"><span data-stu-id="152aa-206">Pecan Pie</span></span> | <span data-ttu-id="152aa-207">Se si desidera che del Queenland, si tratta per l'utente.</span><span class="sxs-lookup"><span data-stu-id="152aa-207">If you like pecans, this is for you.</span></span> | <span data-ttu-id="152aa-208">10.99</span><span class="sxs-lookup"><span data-stu-id="152aa-208">10.99</span></span> |
    | <span data-ttu-id="152aa-209">Grafico a torta limone</span><span class="sxs-lookup"><span data-stu-id="152aa-209">Lemon Pie</span></span> | <span data-ttu-id="152aa-210">Effettuate con i limoni migliori del mondo.</span><span class="sxs-lookup"><span data-stu-id="152aa-210">Made with the best lemons in the world.</span></span> | <span data-ttu-id="152aa-211">11.99</span><span class="sxs-lookup"><span data-stu-id="152aa-211">11.99</span></span> |
    | <span data-ttu-id="152aa-212">Cupcakes</span><span class="sxs-lookup"><span data-stu-id="152aa-212">Cupcakes</span></span> | <span data-ttu-id="152aa-213">I bambini e kid in si apprezzeranno questi.</span><span class="sxs-lookup"><span data-stu-id="152aa-213">Your kids and the kid in you will love these.</span></span> | <span data-ttu-id="152aa-214">7.99</span><span class="sxs-lookup"><span data-stu-id="152aa-214">7.99</span></span> |

    <span data-ttu-id="152aa-215">Tenere presente che non è necessario immettere alcun valore per il *Id* colonna.</span><span class="sxs-lookup"><span data-stu-id="152aa-215">Remember that you don't have to enter anything for the *Id* column.</span></span> <span data-ttu-id="152aa-216">Quando è stato creato il *Id* colonna, si imposta relativo **Identity** proprietà su true, che ne determina automaticamente da compilare.</span><span class="sxs-lookup"><span data-stu-id="152aa-216">When you created the *Id* column, you set its **Is Identity** property to true, which causes it to automatically be filled in.</span></span>

    <span data-ttu-id="152aa-217">Quando hai finito immissione dei dati, Progettazione tabelle avrà un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-217">When you're finished entering the data, the table designer will look like this:</span></span>

    ![[immagine]](5-working-with-data/_static/image3.jpg)
4. <span data-ttu-id="152aa-219">Chiudere la scheda che contiene i dati del database.</span><span class="sxs-lookup"><span data-stu-id="152aa-219">Close the tab that contains the database data.</span></span>

## <a name="displaying-data-from-a-database"></a><span data-ttu-id="152aa-220">Visualizzazione dei dati da un Database</span><span class="sxs-lookup"><span data-stu-id="152aa-220">Displaying Data from a Database</span></span>

<span data-ttu-id="152aa-221">Dopo che è disponibile un database con dati in esso, è possibile visualizzare i dati in una pagina web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="152aa-221">Once you've got a database with data in it, you can display the data in an ASP.NET web page.</span></span> <span data-ttu-id="152aa-222">Per selezionare le righe della tabella per visualizzare, utilizzare un'istruzione SQL, che è un comando che si passa al database.</span><span class="sxs-lookup"><span data-stu-id="152aa-222">To select the table rows to display, you use a SQL statement, which is a command that you pass to the database.</span></span>

1. <span data-ttu-id="152aa-223">Nel riquadro a sinistra, scegliere il **file** dell'area di lavoro.</span><span class="sxs-lookup"><span data-stu-id="152aa-223">In the left pane, click the **Files** workspace.</span></span>
2. <span data-ttu-id="152aa-224">Nella radice del sito Web, creare una nuova pagina CSHTML denominata *ListProducts.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="152aa-224">In the root of the website, create a new CSHTML page named *ListProducts.cshtml*.</span></span>
3. <span data-ttu-id="152aa-225">Sostituire il markup esistente con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-225">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample1.cshtml)]

    <span data-ttu-id="152aa-226">Nel primo blocco di codice, si apre la *SmallBakery.sdf* file (database) creato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="152aa-226">In the first code block, you open the *SmallBakery.sdf* file (database) that you created earlier.</span></span> <span data-ttu-id="152aa-227">Il `Database.Open` metodo presuppone che il *sdf* file è di un sito Web *App\_dati* cartella.</span><span class="sxs-lookup"><span data-stu-id="152aa-227">The `Database.Open` method assumes that the *.sdf* file is in your website's *App\_Data* folder.</span></span> <span data-ttu-id="152aa-228">(Si noti che non è necessario specificare il *sdf* estensione &#8212; in effetti, tal caso, il `Open` (metodo) non funzionerà.)</span><span class="sxs-lookup"><span data-stu-id="152aa-228">(Notice that you don't need to specify the *.sdf* extension &#8212; in fact, if you do, the `Open` method won't work.)</span></span>

    > [!NOTE]
    > <span data-ttu-id="152aa-229">Il *App\_dati* cartella è una cartella speciale in ASP.NET che viene usato per archiviare i file di dati.</span><span class="sxs-lookup"><span data-stu-id="152aa-229">The *App\_Data* folder is a special folder in ASP.NET that's used to store data files.</span></span> <span data-ttu-id="152aa-230">Per altre informazioni, vedere [ci si connette a un Database](#SB_ConnectingToADatabase) più avanti in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="152aa-230">For more information, see [Connecting to a Database](#SB_ConnectingToADatabase) later in this article.</span></span>

    <span data-ttu-id="152aa-231">Quindi effettuare una richiesta per eseguire query sul database usando il codice SQL seguente `Select` istruzione:</span><span class="sxs-lookup"><span data-stu-id="152aa-231">You then make a request to query the database using the following SQL `Select` statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample2.sql)]

    <span data-ttu-id="152aa-232">Nell'istruzione `Product` identifica la tabella alla query.</span><span class="sxs-lookup"><span data-stu-id="152aa-232">In the statement, `Product` identifies the table to query.</span></span> <span data-ttu-id="152aa-233">Il `*` carattere specifica che la query deve restituire tutte le colonne dalla tabella.</span><span class="sxs-lookup"><span data-stu-id="152aa-233">The `*` character specifies that the query should return all the columns from the table.</span></span> <span data-ttu-id="152aa-234">(È possibile inoltre elencare le colonne singolarmente, separati da virgole, se si vogliono visualizzare solo alcune colonne.) Il `Order By` clausola indica come devono essere ordinati i dati di &#8212; in questo caso, per il *Name* colonna.</span><span class="sxs-lookup"><span data-stu-id="152aa-234">(You could also list columns individually, separated by commas, if you wanted to see only some of the columns.) The `Order By` clause indicates how the data should be sorted &#8212; in this case, by the *Name* column.</span></span> <span data-ttu-id="152aa-235">Ciò significa che i dati vengono ordinati in ordine alfabetico in base al valore della *nome* colonna per ogni riga.</span><span class="sxs-lookup"><span data-stu-id="152aa-235">This means that the data is sorted alphabetically based on the value of the *Name* column for each row.</span></span>

    <span data-ttu-id="152aa-236">Nel corpo della pagina, il markup crea una tabella HTML che verrà usata per visualizzare i dati.</span><span class="sxs-lookup"><span data-stu-id="152aa-236">In the body of the page, the markup creates an HTML table that will be used to display the data.</span></span> <span data-ttu-id="152aa-237">All'interno di `<tbody>` elemento, si utilizza un `foreach` ciclo per ottenere individualmente ogni riga di dati restituito dalla query.</span><span class="sxs-lookup"><span data-stu-id="152aa-237">Inside the `<tbody>` element, you use a `foreach` loop to individually get each data row that's returned by the query.</span></span> <span data-ttu-id="152aa-238">Per ogni riga di dati, si crea una riga della tabella HTML (`<tr>` elemento).</span><span class="sxs-lookup"><span data-stu-id="152aa-238">For each data row, you create an HTML table row (`<tr>` element).</span></span> <span data-ttu-id="152aa-239">Quindi, creiamo le celle della tabella HTML (`<td>` elementi) per ogni colonna.</span><span class="sxs-lookup"><span data-stu-id="152aa-239">Then you create HTML table cells (`<td>` elements) for each column.</span></span> <span data-ttu-id="152aa-240">Ogni volta che visita del ciclo, la successiva riga disponibile del database è nel `row` variabile (a tale scopo `foreach` istruzione).</span><span class="sxs-lookup"><span data-stu-id="152aa-240">Each time you go through the loop, the next available row from the database is in the `row` variable (you set this up in the `foreach` statement).</span></span> <span data-ttu-id="152aa-241">Per ottenere una singola colonna della riga, è possibile usare `row.Name` o `row.Description` o è il nome della colonna è necessario.</span><span class="sxs-lookup"><span data-stu-id="152aa-241">To get an individual column from the row, you can use `row.Name` or `row.Description` or whatever the name is of the column you want.</span></span>
4. <span data-ttu-id="152aa-242">Eseguire la pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="152aa-242">Run the page in a browser.</span></span> <span data-ttu-id="152aa-243">(Assicurarsi che sia selezionata la pagina nel **file** dell'area di lavoro prima dell'esecuzione.) La pagina Visualizza un elenco simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-243">(Make sure the page is selected in the **Files** workspace before you run it.) The page displays a list like the following:</span></span>

    ![[immagine]](5-working-with-data/_static/image4.jpg)

> [!TIP] 
> 
> <span data-ttu-id="152aa-245">**Structured Query Language (SQL)**</span><span class="sxs-lookup"><span data-stu-id="152aa-245">**Structured Query Language (SQL)**</span></span>
> 
> <span data-ttu-id="152aa-246">SQL è un linguaggio che viene utilizzato nella maggior parte dei database relazionali per la gestione dei dati in un database.</span><span class="sxs-lookup"><span data-stu-id="152aa-246">SQL is a language that's used in most relational databases for managing data in a database.</span></span> <span data-ttu-id="152aa-247">Include i comandi che consentono di recuperare i dati e aggiornarlo e che consentono di creare, modificare e gestire le tabelle del database.</span><span class="sxs-lookup"><span data-stu-id="152aa-247">It includes commands that let you retrieve data and update it, and that let you create, modify, and manage database tables.</span></span> <span data-ttu-id="152aa-248">SQL è diverso da quello di un linguaggio di programmazione (simile a quello in uso in WebMatrix) perché con SQL, l'idea è che viene comunicato al database che si desidera, ed è il processo del database per scoprire come ottenere i dati o eseguire l'attività.</span><span class="sxs-lookup"><span data-stu-id="152aa-248">SQL is different than a programming language (like the one you're using in WebMatrix) because with SQL, the idea is that you tell the database what you want, and it's the database's job to figure out how to get the data or perform the task.</span></span> <span data-ttu-id="152aa-249">Ecco alcuni esempi di alcuni comandi SQL e le operazioni eseguite:</span><span class="sxs-lookup"><span data-stu-id="152aa-249">Here are examples of some SQL commands and what they do:</span></span>
> 
> `SELECT Id, Name, Price FROM Product WHERE Price > 10.00 ORDER BY Name`
> 
> <span data-ttu-id="152aa-250">Si recupera la *Id*, *Name*, e *prezzo* colonne dai record nel *prodotto* tabella se il valore di *prezzo* è maggiore di 10 e restituisce i risultati in ordine alfabetico in base ai valori del *nome* colonna.</span><span class="sxs-lookup"><span data-stu-id="152aa-250">This fetches the *Id*, *Name*, and *Price* columns from records in the *Product* table if the value of *Price* is more than 10, and returns the results in alphabetical order based on the values of the *Name* column.</span></span> <span data-ttu-id="152aa-251">Questo comando restituirà un set di risultati che contiene i record che soddisfano i criteri o un set vuoto se nessun record corrispondente.</span><span class="sxs-lookup"><span data-stu-id="152aa-251">This command will return a result set that contains the records that meet the criteria, or an empty set if no records match.</span></span>
> 
> `INSERT INTO Product (Name, Description, Price) VALUES ("Croissant", "A flaky delight", 1.99)`
> 
> <span data-ttu-id="152aa-252">Inserisce un nuovo record nel *prodotto* tabella, l'impostazione di *nome* colonna &quot;Cornetto&quot;, il *descrizione* colonna &quot; Un apprezzate dagli inattendibili&quot;e il prezzo per 1.99.</span><span class="sxs-lookup"><span data-stu-id="152aa-252">This inserts a new record into the *Product* table, setting the *Name* column to &quot;Croissant&quot;, the *Description* column to &quot;A flaky delight&quot;, and the price to 1.99.</span></span>
> 
> `DELETE FROM Product WHERE ExpirationDate < "01/01/2008"`
> 
> <span data-ttu-id="152aa-253">Questo comando Elimina i record nel *prodotto* tabella la cui colonna di date di scadenza è precedente al 1 gennaio 2008.</span><span class="sxs-lookup"><span data-stu-id="152aa-253">This command deletes records in the *Product* table whose expiration date column is earlier than January 1, 2008.</span></span> <span data-ttu-id="152aa-254">(Ciò presuppone che il *prodotto* tabella include una colonna, ovviamente.) La data non viene immesso nel formato MM/GG/AAAA, ma deve essere immesso nel formato utilizzato per le impostazioni locali.</span><span class="sxs-lookup"><span data-stu-id="152aa-254">(This assumes that the *Product* table has such a column, of course.) The date is entered here in MM/DD/YYYY format, but it should be entered in the format that's used for your locale.</span></span>
> 
> <span data-ttu-id="152aa-255">Il `Insert Into` e `Delete` comandi non restituiscono set di risultati.</span><span class="sxs-lookup"><span data-stu-id="152aa-255">The `Insert Into` and `Delete` commands don't return result sets.</span></span> <span data-ttu-id="152aa-256">Al contrario, restituiscono un numero che indica il numero di record sono stato interessato dal comando.</span><span class="sxs-lookup"><span data-stu-id="152aa-256">Instead, they return a number that tells you how many records were affected by the command.</span></span>
> 
> <span data-ttu-id="152aa-257">Per alcune di queste operazioni (ad esempio, inserimento ed eliminazione di record), il processo che sta richiedendo l'operazione deve disporre delle autorizzazioni appropriate nel database.</span><span class="sxs-lookup"><span data-stu-id="152aa-257">For some of these operations (like inserting and deleting records), the process that's requesting the operation has to have appropriate permissions in the database.</span></span> <span data-ttu-id="152aa-258">Questo è il motivo per i database di produzione è spesso necessario fornire un nome utente e password quando ci si connette al database.</span><span class="sxs-lookup"><span data-stu-id="152aa-258">This is why for production databases you often have to supply a username and password when you connect to the database.</span></span>
> 
> <span data-ttu-id="152aa-259">Sono disponibili decine di comandi SQL, ma seguono un modello simile al seguente.</span><span class="sxs-lookup"><span data-stu-id="152aa-259">There are dozens of SQL commands, but they all follow a pattern like this.</span></span> <span data-ttu-id="152aa-260">È possibile usare i comandi SQL per creare tabelle di database, contare il numero di record in una tabella, calcolo dei prezzi ed eseguire molte più operazioni.</span><span class="sxs-lookup"><span data-stu-id="152aa-260">You can use SQL commands to create database tables, count the number of records in a table, calculate prices, and perform many more operations.</span></span>

## <a name="inserting-data-in-a-database"></a><span data-ttu-id="152aa-261">Inserimento di dati in un Database</span><span class="sxs-lookup"><span data-stu-id="152aa-261">Inserting Data in a Database</span></span>

<span data-ttu-id="152aa-262">In questa sezione viene illustrato come creare una pagina che consente agli utenti di aggiungere un nuovo prodotto per il *prodotto* tabella di database.</span><span class="sxs-lookup"><span data-stu-id="152aa-262">This section shows how to create a page that lets users add a new product to the *Product* database table.</span></span> <span data-ttu-id="152aa-263">Dopo che viene inserito un nuovo record di prodotto, la pagina viene visualizzata la tabella aggiornata con le *ListProducts.cshtml* pagina creata nella sezione precedente.</span><span class="sxs-lookup"><span data-stu-id="152aa-263">After a new product record is inserted, the page displays the updated table using the *ListProducts.cshtml* page that you created in the previous section.</span></span>

<span data-ttu-id="152aa-264">La pagina include la convalida per assicurarsi che i dati immessi dall'utente siano validi per il database.</span><span class="sxs-lookup"><span data-stu-id="152aa-264">The page includes validation to make sure that the data that the user enters is valid for the database.</span></span> <span data-ttu-id="152aa-265">Ad esempio, il codice nella pagina assicura che sia stato immesso un valore per tutte le colonne necessarie.</span><span class="sxs-lookup"><span data-stu-id="152aa-265">For example, code in the page makes sure that a value has been entered for all required columns.</span></span>

1. <span data-ttu-id="152aa-266">Nel sito Web, creare un nuovo file con estensione CSHTML denominato *InsertProducts.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="152aa-266">In the website, create a new CSHTML file named *InsertProducts.cshtml*.</span></span>
2. <span data-ttu-id="152aa-267">Sostituire il markup esistente con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-267">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample3.cshtml)]

    <span data-ttu-id="152aa-268">Il corpo della pagina contiene un modulo HTML con tre caselle di testo che consentono agli utenti di immettere un nome, descrizione e prezzo.</span><span class="sxs-lookup"><span data-stu-id="152aa-268">The body of the page contains an HTML form with three text boxes that let users enter a name, description, and price.</span></span> <span data-ttu-id="152aa-269">Quando gli utenti fanno clic la **inserire** pulsante, il codice nella parte superiore della pagina consente di aprire una connessione per il *SmallBakery.sdf* database.</span><span class="sxs-lookup"><span data-stu-id="152aa-269">When users click the **Insert** button, the code at the top of the page opens a connection to the *SmallBakery.sdf* database.</span></span> <span data-ttu-id="152aa-270">Ottenere quindi i valori che l'utente ha immesso utilizzando il `Request` dell'oggetto e assegnare tali valori a variabili locali.</span><span class="sxs-lookup"><span data-stu-id="152aa-270">You then get the values that the user has submitted by using the `Request` object and assign those values to local variables.</span></span>

    <span data-ttu-id="152aa-271">Per convalidare che l'utente ha immesso un valore per ogni colonna necessaria, ogni registrazione `<input>` elemento che si desidera convalidare:</span><span class="sxs-lookup"><span data-stu-id="152aa-271">To validate that the user entered a value for each required column, you register each `<input>` element that you want to validate:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample4.cs)]

    <span data-ttu-id="152aa-272">Il `Validation` helper controlla che sia presente un valore in ognuno dei campi che è stato registrato.</span><span class="sxs-lookup"><span data-stu-id="152aa-272">The `Validation` helper checks that there is a value in each of the fields that you've registered.</span></span> <span data-ttu-id="152aa-273">È possibile verificare se tutti i campi sono stati convalidati controllando `Validation.IsValid()`, che avviene in genere prima di elaborare le informazioni ottenute da parte dell'utente:</span><span class="sxs-lookup"><span data-stu-id="152aa-273">You can test whether all the fields passed validation by checking `Validation.IsValid()`, which you typically do before you process the information you get from the user:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample5.cs)]

    <span data-ttu-id="152aa-274">(Il `&&` mezzi di operatore AND: questo test viene *se si tratta di invio di un modulo e tutti i campi hanno superato la convalida*.)</span><span class="sxs-lookup"><span data-stu-id="152aa-274">(The `&&` operator means AND — this test is *If this is a form submission AND all the fields have passed validation*.)</span></span>

    <span data-ttu-id="152aa-275">Se tutte le colonne convalidata (Nessuno era vuota), si proseguire e creare un'istruzione SQL per inserire i dati e quindi di eseguirlo come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="152aa-275">If all the columns validated (none were empty), you go ahead and create a SQL statement to insert the data and then execute it as shown next:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample6.cs)]

    <span data-ttu-id="152aa-276">Per i valori da inserire, includere il segnaposto di parametro (`@0`, `@1`, `@2`).</span><span class="sxs-lookup"><span data-stu-id="152aa-276">For the values to insert, you include parameter placeholders (`@0`, `@1`, `@2`).</span></span>

    > [!NOTE]
    > <span data-ttu-id="152aa-277">Come misura precauzionale, passare sempre i valori in un'istruzione SQL con parametri, come noterete nell'esempio precedente.</span><span class="sxs-lookup"><span data-stu-id="152aa-277">As a security precaution, always pass values to a SQL statement using parameters, as you see in the preceding example.</span></span> <span data-ttu-id="152aa-278">Questo offre la possibilità di convalidare i dati dell'utente, oltre aiuta a proteggersi da tentativi di invio di comandi dannosi per il database (talvolta detto attacchi SQL injection).</span><span class="sxs-lookup"><span data-stu-id="152aa-278">This gives you a chance to validate the user's data, plus it helps protect against attempts to send malicious commands to your database (sometimes referred to as SQL injection attacks).</span></span>

    <span data-ttu-id="152aa-279">Per eseguire la query, è utilizzare questa istruzione, passando le variabili che contengono i valori per sostituire i segnaposto:</span><span class="sxs-lookup"><span data-stu-id="152aa-279">To execute the query, you use this statement, passing to it the variables that contain the values to substitute for the placeholders:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample7.cs)]

    <span data-ttu-id="152aa-280">Dopo il `Insert Into` esecuzione dell'istruzione, si invia l'utente alla pagina che elenca i prodotti utilizzando questa riga:</span><span class="sxs-lookup"><span data-stu-id="152aa-280">After the `Insert Into` statement has executed, you send the user to the page that lists the products using this line:</span></span>

    [!code-javascript[Main](5-working-with-data/samples/sample8.js)]

    <span data-ttu-id="152aa-281">Se non è riuscita la convalida, si ignora l'inserimento.</span><span class="sxs-lookup"><span data-stu-id="152aa-281">If validation didn't succeed, you skip the insert.</span></span> <span data-ttu-id="152aa-282">È invece necessario un supporto nella pagina in grado di visualizzare i messaggi di errore accumulato (se presente):</span><span class="sxs-lookup"><span data-stu-id="152aa-282">Instead, you have a helper in the page that can display the accumulated error messages (if any):</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample9.cshtml)]

    <span data-ttu-id="152aa-283">Si noti che il blocco di stile nel markup include una definizione di classe CSS denominata `.validation-summary-errors`.</span><span class="sxs-lookup"><span data-stu-id="152aa-283">Notice that the style block in the markup includes a CSS class definition named `.validation-summary-errors`.</span></span> <span data-ttu-id="152aa-284">Si tratta del nome della classe CSS utilizzata per impostazione predefinita per il `<div>` elemento che contiene gli errori di convalida.</span><span class="sxs-lookup"><span data-stu-id="152aa-284">This is the name of the CSS class that's used by default for the `<div>` element that contains any validation errors.</span></span> <span data-ttu-id="152aa-285">In questo caso, la classe CSS specifica che gli errori di riepilogo di convalida vengono visualizzati in rosso e in grassetto, ma è possibile definire il `.validation-summary-errors` classe per visualizzare qualsiasi formattazione desiderato.</span><span class="sxs-lookup"><span data-stu-id="152aa-285">In this case, the CSS class specifies that validation summary errors are displayed in red and in bold, but you can define the `.validation-summary-errors` class to display any formatting you like.</span></span>

### <a name="testing-the-insert-page"></a><span data-ttu-id="152aa-286">Test della pagina di inserimento</span><span class="sxs-lookup"><span data-stu-id="152aa-286">Testing the Insert Page</span></span>

1. <span data-ttu-id="152aa-287">Visualizzare la pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="152aa-287">View the page in a browser.</span></span> <span data-ttu-id="152aa-288">La pagina Visualizza un form simile a quello illustrato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="152aa-288">The page displays a form that's similar to the one that's shown in the following illustration.</span></span>

    ![[immagine]](5-working-with-data/_static/image5.jpg)
2. <span data-ttu-id="152aa-290">Immettere i valori per tutte le colonne, ma assicurarsi di lasciare il *prezzo* colonna vuota.</span><span class="sxs-lookup"><span data-stu-id="152aa-290">Enter values for all the columns, but make sure that you leave the *Price* column blank.</span></span>
3. <span data-ttu-id="152aa-291">Fare clic su **Inserisci**.</span><span class="sxs-lookup"><span data-stu-id="152aa-291">Click **Insert**.</span></span> <span data-ttu-id="152aa-292">La pagina Visualizza un messaggio di errore, come illustrato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="152aa-292">The page displays an error message, as shown in the following illustration.</span></span> <span data-ttu-id="152aa-293">(Nessun nuovo record viene creato).</span><span class="sxs-lookup"><span data-stu-id="152aa-293">(No new record is created.)</span></span>

    ![[immagine]](5-working-with-data/_static/image6.jpg)
4. <span data-ttu-id="152aa-295">Compilare il modulo completamente e quindi fare clic su **Inserisci**.</span><span class="sxs-lookup"><span data-stu-id="152aa-295">Fill the form out completely, and then click **Insert**.</span></span> <span data-ttu-id="152aa-296">Questa volta, il *ListProducts.cshtml* pagina viene visualizzata e Mostra il nuovo record.</span><span class="sxs-lookup"><span data-stu-id="152aa-296">This time, the *ListProducts.cshtml* page is displayed and shows the new record.</span></span>

## <a name="updating-data-in-a-database"></a><span data-ttu-id="152aa-297">L'aggiornamento dei dati in un Database</span><span class="sxs-lookup"><span data-stu-id="152aa-297">Updating Data in a Database</span></span>

<span data-ttu-id="152aa-298">Dopo l'immissione dei dati in una tabella, si potrebbe essere necessario aggiornarlo.</span><span class="sxs-lookup"><span data-stu-id="152aa-298">After data has been entered into a table, you might need to update it.</span></span> <span data-ttu-id="152aa-299">Questa procedura illustra come creare due pagine che sono simili a quelli creati per l'inserimento di dati in precedenza.</span><span class="sxs-lookup"><span data-stu-id="152aa-299">This procedure shows you how to create two pages that are similar to the ones you created for data insertion earlier.</span></span> <span data-ttu-id="152aa-300">La prima pagina consente di visualizzare i prodotti e consente agli utenti di selezionarne uno da modificare.</span><span class="sxs-lookup"><span data-stu-id="152aa-300">The first page displays products and lets users select one to change.</span></span> <span data-ttu-id="152aa-301">La seconda pagina consente agli utenti effettivamente apportare le modifiche e salvarle.</span><span class="sxs-lookup"><span data-stu-id="152aa-301">The second page lets the users actually make the edits and save them.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="152aa-302">**Importante** In siti Web di produzione, è in genere limitare chi è autorizzato per apportare modifiche ai dati.</span><span class="sxs-lookup"><span data-stu-id="152aa-302">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="152aa-303">Per informazioni su come configurare l'appartenenza e sui modi per consentire agli utenti di eseguire attività nel sito, vedere [aggiunta di sicurezza e l'appartenenza a un sito con pagine Web ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="152aa-303">For information about how to set up membership and about ways to authorize users to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>

1. <span data-ttu-id="152aa-304">Nel sito Web, creare un nuovo file con estensione CSHTML denominato *EditProducts.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="152aa-304">In the website, create a new CSHTML file named *EditProducts.cshtml*.</span></span>
2. <span data-ttu-id="152aa-305">Sostituire il markup esistente nel file con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-305">Replace the existing markup in the file with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample10.cshtml)]

    <span data-ttu-id="152aa-306">L'unica differenza tra questa pagina e il *ListProducts.cshtml* pagina da versioni precedenti è che la tabella HTML in questa pagina include una colonna aggiuntiva che visualizza un' **modificare** collegamento.</span><span class="sxs-lookup"><span data-stu-id="152aa-306">The only difference between this page and the *ListProducts.cshtml* page from earlier is that the HTML table in this page includes an extra column that displays an **Edit** link.</span></span> <span data-ttu-id="152aa-307">Quando si fa clic su questo collegamento, verrà visualizzato il *UpdateProducts.cshtml* pagina (che verrà creata successivamente) in cui è possibile modificare il record selezionato.</span><span class="sxs-lookup"><span data-stu-id="152aa-307">When you click this link, it takes you to the *UpdateProducts.cshtml* page (which you'll create next) where you can edit the selected record.</span></span>

    <span data-ttu-id="152aa-308">Esaminare il codice che crea il **modifica** collegamento:</span><span class="sxs-lookup"><span data-stu-id="152aa-308">Look at the code that creates the **Edit** link:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample11.cshtml)]

    <span data-ttu-id="152aa-309">Ciò consente di creare un elemento HTML `<a>` elemento la cui `href` attributo è impostato in modo dinamico.</span><span class="sxs-lookup"><span data-stu-id="152aa-309">This creates an HTML `<a>` element whose `href` attribute is set dynamically.</span></span> <span data-ttu-id="152aa-310">Il `href` attributo specifica la pagina da visualizzare quando l'utente fa clic sul collegamento.</span><span class="sxs-lookup"><span data-stu-id="152aa-310">The `href` attribute specifies the page to display when the user clicks the link.</span></span> <span data-ttu-id="152aa-311">Viene anche passata la `Id` valore della riga corrente per il collegamento.</span><span class="sxs-lookup"><span data-stu-id="152aa-311">It also passes the `Id` value of the current row to the link.</span></span> <span data-ttu-id="152aa-312">Quando la pagina viene eseguita, l'origine della pagina potrebbe contenere collegamenti simili ai seguenti:</span><span class="sxs-lookup"><span data-stu-id="152aa-312">When the page runs, the page source might contain links like these:</span></span>

    [!code-html[Main](5-working-with-data/samples/sample12.html)]

    <span data-ttu-id="152aa-313">Si noti che il `href` attributo è impostato su `UpdateProducts/n`, dove *n* è un numero di prodotto.</span><span class="sxs-lookup"><span data-stu-id="152aa-313">Notice that the `href` attribute is set to `UpdateProducts/n`, where *n* is a product number.</span></span> <span data-ttu-id="152aa-314">Quando un utente fa clic su uno di questi collegamenti, l'URL risultante avrà un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-314">When a user clicks one of these links, the resulting URL will look something like this:</span></span>

    `http://localhost:18816/UpdateProducts/6`

    <span data-ttu-id="152aa-315">In altre parole, il numero del prodotto per la modifica verrà passato nell'URL.</span><span class="sxs-lookup"><span data-stu-id="152aa-315">In other words, the product number to be edited will be passed in the URL.</span></span>
3. <span data-ttu-id="152aa-316">Visualizzare la pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="152aa-316">View the page in a browser.</span></span> <span data-ttu-id="152aa-317">La pagina Visualizza i dati in un formato simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-317">The page displays the data in a format like this:</span></span>

    ![[immagine]](5-working-with-data/_static/image7.jpg)

    <span data-ttu-id="152aa-319">Successivamente, si creerà la pagina che consente agli utenti di aggiornare effettivamente i dati.</span><span class="sxs-lookup"><span data-stu-id="152aa-319">Next, you'll create the page that lets users actually update the data.</span></span> <span data-ttu-id="152aa-320">La pagina di aggiornamento include la convalida per convalidare i dati immessi dall'utente.</span><span class="sxs-lookup"><span data-stu-id="152aa-320">The update page includes validation to validate the data that the user enters.</span></span> <span data-ttu-id="152aa-321">Ad esempio, il codice nella pagina assicura che sia stato immesso un valore per tutte le colonne necessarie.</span><span class="sxs-lookup"><span data-stu-id="152aa-321">For example, code in the page makes sure that a value has been entered for all required columns.</span></span>
4. <span data-ttu-id="152aa-322">Nel sito Web, creare un nuovo file con estensione CSHTML denominato *UpdateProducts.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="152aa-322">In the website, create a new CSHTML file named *UpdateProducts.cshtml*.</span></span>
5. <span data-ttu-id="152aa-323">Sostituire il markup esistente nel file con il codice seguente.</span><span class="sxs-lookup"><span data-stu-id="152aa-323">Replace the existing markup in the file with the following.</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample13.cshtml)]

    <span data-ttu-id="152aa-324">Il corpo della pagina contiene un form HTML in cui viene visualizzato un prodotto e in cui gli utenti possono modificarlo.</span><span class="sxs-lookup"><span data-stu-id="152aa-324">The body of the page contains an HTML form where a product is displayed and where users can edit it.</span></span> <span data-ttu-id="152aa-325">Per ottenere il prodotto da visualizzare, utilizzare l'istruzione SQL:</span><span class="sxs-lookup"><span data-stu-id="152aa-325">To get the product to display, you use this SQL statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample14.sql)]

    <span data-ttu-id="152aa-326">Ciò consentirà di selezionare il prodotto il cui ID corrisponde al valore passato il `@0` parametro.</span><span class="sxs-lookup"><span data-stu-id="152aa-326">This will select the product whose ID matches the value that's passed in the `@0` parameter.</span></span> <span data-ttu-id="152aa-327">(Poiché *Id* è la chiave primaria e pertanto deve essere univoco, record di un solo prodotto mai può essere selezionato in questo modo.) Per ottenere il valore di ID da passare a questa `Select` istruzione, è possibile leggere il valore passato alla pagina come parte dell'URL, utilizzando la sintassi seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-327">(Because *Id* is the primary key and therefore must be unique, only one product record can ever be selected this way.) To get the ID value to pass to this `Select` statement, you can read the value that's passed to the page as part of the URL, using the following syntax:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample15.cs)]

    <span data-ttu-id="152aa-328">Per recuperare effettivamente il record di prodotto, si utilizza il `QuerySingle` metodo, che verrà restituito un solo record:</span><span class="sxs-lookup"><span data-stu-id="152aa-328">To actually fetch the product record, you use the `QuerySingle` method, which will return just one record:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample16.cs)]

    <span data-ttu-id="152aa-329">La singola riga viene restituita nel `row` variabile.</span><span class="sxs-lookup"><span data-stu-id="152aa-329">The single row is returned into the `row` variable.</span></span> <span data-ttu-id="152aa-330">È possibile ottenere dati all'esterno di ogni colonna e assegnarlo alle variabili locali simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-330">You can get data out of each column and assign it to local variables like this:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample17.cs)]

    <span data-ttu-id="152aa-331">Nel markup per il form, questi valori vengono visualizzati automaticamente in singole caselle di testo tramite codice incorporato simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-331">In the markup for the form, these values are displayed automatically in individual text boxes by using embedded code like the following:</span></span>

    [!code-html[Main](5-working-with-data/samples/sample18.html)]

    <span data-ttu-id="152aa-332">Tale parte del codice visualizza il record di prodotto da aggiornare.</span><span class="sxs-lookup"><span data-stu-id="152aa-332">That part of the code displays the product record to be updated.</span></span> <span data-ttu-id="152aa-333">Una volta che il record è stato visualizzato, l'utente può modificare le singole colonne.</span><span class="sxs-lookup"><span data-stu-id="152aa-333">Once the record has been displayed, the user can edit individual columns.</span></span>

    <span data-ttu-id="152aa-334">Quando l'utente invia il form facendo il **Update** pulsante, il codice nel `if(IsPost)` bloccare l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="152aa-334">When the user submits the form by clicking the **Update** button, the code in the `if(IsPost)` block runs.</span></span> <span data-ttu-id="152aa-335">Questo modo si ottengono i valori dell'utente dal `Request` archivia i valori nelle variabili di oggetto e verifica che ogni colonna è stata compilata.</span><span class="sxs-lookup"><span data-stu-id="152aa-335">This gets the user's values from the `Request` object, stores the values in variables, and validates that each column has been filled in.</span></span> <span data-ttu-id="152aa-336">Se la convalida riesce, il codice crea la seguente istruzione SQL Update:</span><span class="sxs-lookup"><span data-stu-id="152aa-336">If validation passes, the code creates the following SQL Update statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample19.sql)]

    <span data-ttu-id="152aa-337">In un database SQL `Update` istruzione, si specifica ogni colonna da aggiornare e il valore per impostare l'opzione.</span><span class="sxs-lookup"><span data-stu-id="152aa-337">In a SQL `Update` statement, you specify each column to update and the value to set it to.</span></span> <span data-ttu-id="152aa-338">In questo codice, i valori vengono specificati mediante i segnaposti dei parametri `@0`, `@1`, `@2`e così via.</span><span class="sxs-lookup"><span data-stu-id="152aa-338">In this code, the values are specified using the parameter placeholders `@0`, `@1`, `@2`, and so on.</span></span> <span data-ttu-id="152aa-339">(Come indicato in precedenza, per sicurezza, è sempre opportuno passare valori a un'istruzione SQL con parametri.)</span><span class="sxs-lookup"><span data-stu-id="152aa-339">(As noted earlier, for security, you should always pass values to a SQL statement by using parameters.)</span></span>

    <span data-ttu-id="152aa-340">Quando si chiama il `db.Execute` metodo, si passano le variabili che contengono i valori nell'ordine corrispondente ai parametri nell'istruzione SQL:</span><span class="sxs-lookup"><span data-stu-id="152aa-340">When you call the `db.Execute` method, you pass the variables that contain the values in the order that corresponds to the parameters in the SQL statement:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample20.cs)]

    <span data-ttu-id="152aa-341">Dopo il `Update` istruzione è stata eseguita, si chiama il metodo seguente per indirizzare l'utente torna alla pagina di modifica:</span><span class="sxs-lookup"><span data-stu-id="152aa-341">After the `Update` statement has been executed, you call the following method in order to redirect the user back to the edit page:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample21.cshtml)]

    <span data-ttu-id="152aa-342">L'effetto è che l'utente visualizza un elenco aggiornato dei dati nel database e può modificare un altro prodotto.</span><span class="sxs-lookup"><span data-stu-id="152aa-342">The effect is that the user sees an updated listing of the data in the database and can edit another product.</span></span>
6. <span data-ttu-id="152aa-343">Salvare la pagina.</span><span class="sxs-lookup"><span data-stu-id="152aa-343">Save the page.</span></span>
7. <span data-ttu-id="152aa-344">Eseguire la *EditProducts.cshtml* pagina (non la pagina di aggiornamento) e quindi fare clic su **modificare** selezionare un prodotto da modificare.</span><span class="sxs-lookup"><span data-stu-id="152aa-344">Run the *EditProducts.cshtml* page (not the update page) and then click **Edit** to select a product to edit.</span></span> <span data-ttu-id="152aa-345">Il *UpdateProducts.cshtml* pagina viene visualizzata, che mostra il record selezionato.</span><span class="sxs-lookup"><span data-stu-id="152aa-345">The *UpdateProducts.cshtml* page is displayed, showing the record you selected.</span></span>

    ![[immagine]](5-working-with-data/_static/image8.jpg)
8. <span data-ttu-id="152aa-347">Apportare una modifica e fare clic su **Update**.</span><span class="sxs-lookup"><span data-stu-id="152aa-347">Make a change and click **Update**.</span></span> <span data-ttu-id="152aa-348">L'elenco di prodotti è illustrato anche in questo caso con i dati aggiornati.</span><span class="sxs-lookup"><span data-stu-id="152aa-348">The products list is shown again with your updated data.</span></span>

## <a name="deleting-data-in-a-database"></a><span data-ttu-id="152aa-349">L'eliminazione dei dati in un Database</span><span class="sxs-lookup"><span data-stu-id="152aa-349">Deleting Data in a Database</span></span>

<span data-ttu-id="152aa-350">Questa sezione illustra come consentire agli utenti di eliminare un prodotto dal *prodotto* tabella di database.</span><span class="sxs-lookup"><span data-stu-id="152aa-350">This section shows how to let users delete a product from the *Product* database table.</span></span> <span data-ttu-id="152aa-351">L'esempio è costituito da due pagine.</span><span class="sxs-lookup"><span data-stu-id="152aa-351">The example consists of two pages.</span></span> <span data-ttu-id="152aa-352">Nella prima pagina, gli utenti selezionare un record da eliminare.</span><span class="sxs-lookup"><span data-stu-id="152aa-352">In the first page, users select a record to delete.</span></span> <span data-ttu-id="152aa-353">Il record da eliminare viene quindi visualizzato in una seconda pagina che consente di confermare che si desidera eliminare il record.</span><span class="sxs-lookup"><span data-stu-id="152aa-353">The record to be deleted is then displayed in a second page that lets them confirm that they want to delete the record.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="152aa-354">**Importante** In siti Web di produzione, è in genere limitare chi è autorizzato per apportare modifiche ai dati.</span><span class="sxs-lookup"><span data-stu-id="152aa-354">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="152aa-355">Per informazioni su come configurare l'appartenenza e sui modi per autorizzare l'utente di eseguire le attività nel sito, vedere [aggiunta di sicurezza e l'appartenenza a un sito con pagine Web ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="152aa-355">For information about how to set up membership and about ways to authorize user to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>

1. <span data-ttu-id="152aa-356">Nel sito Web, creare un nuovo file con estensione CSHTML denominato *ListProductsForDelete.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="152aa-356">In the website, create a new CSHTML file named *ListProductsForDelete.cshtml*.</span></span>
2. <span data-ttu-id="152aa-357">Sostituire il markup esistente con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-357">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample22.cshtml)]

    <span data-ttu-id="152aa-358">Questa pagina è simile al *EditProducts.cshtml* pagina illustrato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="152aa-358">This page is similar to the *EditProducts.cshtml* page from earlier.</span></span> <span data-ttu-id="152aa-359">Tuttavia, invece di visualizzare un **Edit** collegamento per ogni prodotto, viene visualizzato un **eliminare** collegamento.</span><span class="sxs-lookup"><span data-stu-id="152aa-359">However, instead of displaying an **Edit** link for each product, it displays a **Delete** link.</span></span> <span data-ttu-id="152aa-360">Il **eliminare** collegamento viene creato utilizzando il seguente codice incorporato nel markup:</span><span class="sxs-lookup"><span data-stu-id="152aa-360">The **Delete** link is created using the following embedded code in the markup:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample23.cshtml)]

    <span data-ttu-id="152aa-361">Verrà creato un URL simile alla seguente quando l'utente sceglie il collegamento:</span><span class="sxs-lookup"><span data-stu-id="152aa-361">This creates a URL that looks like this when users click the link:</span></span>

    `http://<server>/DeleteProduct/4`

    <span data-ttu-id="152aa-362">L'URL chiama una pagina denominata *DeleteProduct.cshtml* (che verrà creata successivamente) e lo passa l'ID del prodotto da eliminare (in questo esempio, 4).</span><span class="sxs-lookup"><span data-stu-id="152aa-362">The URL calls a page named *DeleteProduct.cshtml* (which you'll create next) and passes it the ID of the product to delete (here, 4).</span></span>
3. <span data-ttu-id="152aa-363">Salvare il file, ma lasciarlo aperto.</span><span class="sxs-lookup"><span data-stu-id="152aa-363">Save the file, but leave it open.</span></span>
4. <span data-ttu-id="152aa-364">Creare un altro file CHTML denominato *DeleteProduct.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="152aa-364">Create another CHTML file named *DeleteProduct.cshtml*.</span></span> <span data-ttu-id="152aa-365">Sostituire il contenuto esistente con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-365">Replace the existing content with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample24.cshtml)]

    <span data-ttu-id="152aa-366">Questa pagina viene chiamata da *ListProductsForDelete.cshtml* e consente agli utenti di confermare che si desidera eliminare un prodotto.</span><span class="sxs-lookup"><span data-stu-id="152aa-366">This page is called by *ListProductsForDelete.cshtml* and lets users confirm that they want to delete a product.</span></span> <span data-ttu-id="152aa-367">Per elencare il prodotto deve essere eliminato, è ottenere l'ID del prodotto da eliminare dall'URL usando il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-367">To list the product to be deleted, you get the ID of the product to delete from the URL using the following code:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample25.cs)]

    <span data-ttu-id="152aa-368">Nella pagina verrà quindi richiesto all'utente di fare clic su un pulsante per eliminare effettivamente i record.</span><span class="sxs-lookup"><span data-stu-id="152aa-368">The page then asks the user to click a button to actually delete the record.</span></span> <span data-ttu-id="152aa-369">Si tratta di un'importante misura di sicurezza: quando si eseguono operazioni sensibili nel sito Web, ad esempio l'aggiornamento o eliminazione dei dati, queste operazioni devono sempre essere eseguite tramite un'operazione POST, non un'operazione GET.</span><span class="sxs-lookup"><span data-stu-id="152aa-369">This is an important security measure: when you perform sensitive operations in your website like updating or deleting data, these operations should always be done using a POST operation, not a GET operation.</span></span> <span data-ttu-id="152aa-370">Se il sito è configurato in modo che un'operazione di eliminazione può essere eseguita tramite un'operazione GET, chiunque può passare un URL come `http://<server>/DeleteProduct/4` e tutto ciò che desideri eliminare dal database.</span><span class="sxs-lookup"><span data-stu-id="152aa-370">If your site is set up so that a delete operation can be performed using a GET operation, anyone can pass a URL like `http://<server>/DeleteProduct/4` and delete anything they want from your database.</span></span> <span data-ttu-id="152aa-371">Aggiungendo la conferma dell'accesso e la codifica della pagina in modo che l'eliminazione può essere eseguita solo utilizzando un POST, si aggiunge una misura di sicurezza per il sito.</span><span class="sxs-lookup"><span data-stu-id="152aa-371">By adding the confirmation and coding the page so that the deletion can be performed only by using a POST, you add a measure of security to your site.</span></span>

    <span data-ttu-id="152aa-372">L'operazione di eliminazione viene eseguita usando il codice seguente che conferma prima di tutto che questa è un'operazione post e che l'ID non sia vuoto:</span><span class="sxs-lookup"><span data-stu-id="152aa-372">The actual delete operation is performed using the following code, which first confirms that this is a post operation and that the ID isn't empty:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample26.cs)]

    <span data-ttu-id="152aa-373">Il codice esegue un'istruzione SQL che elimina il record specificato e quindi reindirizza l'utente torna alla pagina dell'inserzione.</span><span class="sxs-lookup"><span data-stu-id="152aa-373">The code runs a SQL statement that deletes the specified record and then redirects the user back to the listing page.</span></span>
5. <span data-ttu-id="152aa-374">Eseguire *ListProductsForDelete.cshtml* in un browser.</span><span class="sxs-lookup"><span data-stu-id="152aa-374">Run *ListProductsForDelete.cshtml* in a browser.</span></span>

    ![[immagine]](5-working-with-data/_static/image9.jpg)
6. <span data-ttu-id="152aa-376">Scegliere il **eliminare** collegamento per uno dei prodotti.</span><span class="sxs-lookup"><span data-stu-id="152aa-376">Click the **Delete** link for one of the products.</span></span> <span data-ttu-id="152aa-377">Il *DeleteProduct.cshtml* viene visualizzata la pagina per confermare che si desidera eliminare il record.</span><span class="sxs-lookup"><span data-stu-id="152aa-377">The *DeleteProduct.cshtml* page is displayed to confirm that you want to delete that record.</span></span>
7. <span data-ttu-id="152aa-378">Scegliere il **eliminare** pulsante.</span><span class="sxs-lookup"><span data-stu-id="152aa-378">Click the **Delete** button.</span></span> <span data-ttu-id="152aa-379">Il record di prodotto viene eliminato e la pagina viene aggiornata con un elenco di aggiornamenti del prodotto.</span><span class="sxs-lookup"><span data-stu-id="152aa-379">The product record is deleted and the page is refreshed with an updated product listing.</span></span>

> [!TIP]
> 
> <a id="SB_ConnectingToADatabase"></a>
> ### <a name="connecting-to-a-database"></a><span data-ttu-id="152aa-380">La connessione a un Database</span><span class="sxs-lookup"><span data-stu-id="152aa-380">Connecting to a Database</span></span>
> 
> <span data-ttu-id="152aa-381">È possibile connettersi a un database in due modi.</span><span class="sxs-lookup"><span data-stu-id="152aa-381">You can connect to a database in two ways.</span></span> <span data-ttu-id="152aa-382">Il primo consiste nell'usare la `Database.Open` metodo e per specificare il nome del file di database (meno la *sdf* estensione):</span><span class="sxs-lookup"><span data-stu-id="152aa-382">The first is to use the `Database.Open` method and to specify the name of the database file (less the *.sdf* extension):</span></span>
> 
> `var db = Database.Open("SmallBakery");`
> 
> <span data-ttu-id="152aa-383">Il `Open` metodo presuppone che il. *sdf* file è il sito Web *App\_dati* cartella.</span><span class="sxs-lookup"><span data-stu-id="152aa-383">The `Open` method assumes that the .*sdf* file is in the website's *App\_Data* folder.</span></span> <span data-ttu-id="152aa-384">Questa cartella è progettata specificamente per contenere i dati.</span><span class="sxs-lookup"><span data-stu-id="152aa-384">This folder is designed specifically for holding data.</span></span> <span data-ttu-id="152aa-385">Ad esempio, dispone delle autorizzazioni appropriate per consentire al sito Web di leggere e scrivere dati e come misura di sicurezza, WebMatrix non consente l'accesso ai file da questa cartella.</span><span class="sxs-lookup"><span data-stu-id="152aa-385">For example, it has appropriate permissions to allow the website to read and write data, and as a security measure, WebMatrix does not allow access to files from this folder.</span></span>
> 
> <span data-ttu-id="152aa-386">Il secondo modo consiste nell'utilizzare una stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="152aa-386">The second way is to use a connection string.</span></span> <span data-ttu-id="152aa-387">Una stringa di connessione contiene informazioni su come connettersi a un database.</span><span class="sxs-lookup"><span data-stu-id="152aa-387">A connection string contains information about how to connect to a database.</span></span> <span data-ttu-id="152aa-388">Può trattarsi di un percorso di file, o può includere il nome di un database di SQL Server in un server locale o remoto, insieme a un nome utente e password per connettersi a tale server.</span><span class="sxs-lookup"><span data-stu-id="152aa-388">This can include a file path, or it can include the name of a SQL Server database on a local or remote server, along with a user name and password to connect to that server.</span></span> <span data-ttu-id="152aa-389">(Se si mantengono i dati in una versione di SQL Server gestita centralmente, ad esempio nel sito del provider di hosting, sempre usare una stringa di connessione per specificare le informazioni di connessione del database.)</span><span class="sxs-lookup"><span data-stu-id="152aa-389">(If you keep data in a centrally managed version of SQL Server, such as on a hosting provider's site, you always use a connection string to specify the database connection information.)</span></span>
> 
> <span data-ttu-id="152aa-390">In WebMatrix, le stringhe di connessione sono in genere archiviate in un file XML denominato *Web. config*. Come suggerisce il nome, è possibile usare una *Web. config* file nella radice del sito Web per archiviare le informazioni di configurazione del sito, inclusi eventuali stringhe di connessione che potrebbe richiedere il sito.</span><span class="sxs-lookup"><span data-stu-id="152aa-390">In WebMatrix, connection strings are usually stored in an XML file named *Web.config*. As the name implies, you can use a *Web.config* file in the root of your website to store the site's configuration information, including any connection strings that your site might require.</span></span> <span data-ttu-id="152aa-391">Un esempio di una stringa di connessione in un *Web. config* file potrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="152aa-391">An example of a connection string in a *Web.config* file might look like the following:</span></span>
> 
> [!code-xml[Main](5-working-with-data/samples/sample27.xml)]
> 
> <span data-ttu-id="152aa-392">Nell'esempio, la stringa di connessione fa riferimento a un database in un'istanza di SQL Server in cui è in esecuzione in un server in un punto (anziché una variabile locale *sdf* file).</span><span class="sxs-lookup"><span data-stu-id="152aa-392">In the example, the connection string points to a database in an instance of SQL Server that's running on a server somewhere (as opposed to a local *.sdf* file).</span></span> <span data-ttu-id="152aa-393">È necessario sostituire i nomi appropriati per `myServer` e `myDatabase`, specificare i valori di account di accesso di SQL Server per `username` e `password`.</span><span class="sxs-lookup"><span data-stu-id="152aa-393">You would need to substitute the appropriate names for `myServer` and `myDatabase`, and specify SQL Server login values for `username` and `password`.</span></span> <span data-ttu-id="152aa-394">(I valori di nome utente e password non sono necessariamente lo stesso come le credenziali di Windows o i valori che il provider di hosting ha assegnato per l'accesso al server.</span><span class="sxs-lookup"><span data-stu-id="152aa-394">(The username and password values are not necessarily the same as your Windows credentials or as the values that your hosting provider has given you for logging in to their servers.</span></span> <span data-ttu-id="152aa-395">Rivolgersi all'amministratore per i valori esatti che necessari.)</span><span class="sxs-lookup"><span data-stu-id="152aa-395">Check with the administrator for the exact values you need.)</span></span>
> 
> <span data-ttu-id="152aa-396">Il `Database.Open` metodo è flessibile, poiché consente di passare il nome di un database *sdf* file o il nome di una stringa di connessione archiviata nel *Web. config* file.</span><span class="sxs-lookup"><span data-stu-id="152aa-396">The `Database.Open` method is flexible, because it lets you pass either the name of a database *.sdf* file or the name of a connection string that's stored in the *Web.config* file.</span></span> <span data-ttu-id="152aa-397">Nell'esempio seguente viene illustrato come connettersi al database usando la stringa di connessione illustrata nell'esempio precedente:</span><span class="sxs-lookup"><span data-stu-id="152aa-397">The following example shows how to connect to the database using the connection string illustrated in the previous example:</span></span>
> 
> [!code-cshtml[Main](5-working-with-data/samples/sample28.cshtml)]
> 
> <span data-ttu-id="152aa-398">Come accennato, la `Database.Open` metodo consente di passare un nome di database o una stringa di connessione e possibile individuare i cui si desidera utilizzare.</span><span class="sxs-lookup"><span data-stu-id="152aa-398">As noted, the `Database.Open` method lets you pass either a database name or a connection string, and it'll figure out which to use.</span></span> <span data-ttu-id="152aa-399">Ciò è molto utile quando si distribuisce (pubblica) nel sito Web.</span><span class="sxs-lookup"><span data-stu-id="152aa-399">This is very useful when you deploy (publish) your website.</span></span> <span data-ttu-id="152aa-400">È possibile usare un *sdf* del file nei *App\_dati* cartella durante lo sviluppo e test del sito.</span><span class="sxs-lookup"><span data-stu-id="152aa-400">You can use an *.sdf* file in the *App\_Data* folder when you're developing and testing your site.</span></span> <span data-ttu-id="152aa-401">Quando si sposta il sito in un server di produzione, è possibile usare una stringa di connessione nel *Web. config* file con lo stesso nome del *sdf* file, ma che punta al provider di hosting database &#8212;senza dover modificare il codice.</span><span class="sxs-lookup"><span data-stu-id="152aa-401">Then when you move your site to a production server, you can use a connection string in the *Web.config* file that has the same name as your *.sdf* file but that points to the hosting provider's database &#8212; all without having to change your code.</span></span>
> 
> <span data-ttu-id="152aa-402">Infine, se si desidera lavorare direttamente con una stringa di connessione, è possibile chiamare il `Database.OpenConnectionString` metodo e passare è l'effettiva della stringa di connessione anziché il nome di un oggetto incluso il *Web. config* file.</span><span class="sxs-lookup"><span data-stu-id="152aa-402">Finally, if you want to work directly with a connection string, you can call the `Database.OpenConnectionString` method and pass it the actual connection string instead of just the name of one in the *Web.config* file.</span></span> <span data-ttu-id="152aa-403">Ciò può risultare utile nelle situazioni in cui per qualche motivo non si ha accesso alla stringa di connessione (o valori in essa contenuti, ad esempio la *sdf* nome file) fino a quando la pagina è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="152aa-403">This might be useful in situations where for some reason you don't have access to the connection string (or values in it, such as the *.sdf* file name) until the page is running.</span></span> <span data-ttu-id="152aa-404">Tuttavia, per la maggior parte degli scenari, è possibile usare `Database.Open` come descritto in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="152aa-404">However, for most scenarios, you can use `Database.Open` as described in this article.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="152aa-405">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="152aa-405">Additional Resources</span></span>

- [<span data-ttu-id="152aa-406">SQL Server Compact</span><span class="sxs-lookup"><span data-stu-id="152aa-406">SQL Server Compact</span></span>](https://www.microsoft.com/sqlserver/2008/en/us/compact.aspx)
- [<span data-ttu-id="152aa-407">La connessione a un Database SQL Server o MySQL in WebMatrix</span><span class="sxs-lookup"><span data-stu-id="152aa-407">Connecting to a SQL Server or MySQL Database in WebMatrix</span></span>](https://go.microsoft.com/fwlink/?LinkId=208661)
- [<span data-ttu-id="152aa-408">Convalida dell'input utente nelle pagine Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="152aa-408">Validating User Input in ASP.NET Web Pages Sites</span></span>](https://go.microsoft.com/fwlink/?LinkId=253002)
