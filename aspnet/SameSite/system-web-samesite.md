---
title: Usare i cookie navigava sullostesso sito in ASP.NET
author: rick-anderson
description: Informazioni su come usare per navigava sullostesso sito i cookie in ASP.NET
ms.author: riande
ms.date: 2/15/2019
uid: samesite/system-web-samesite
ms.openlocfilehash: 2a39663dcbfa97ae441edd9a9768172cafbaab03
ms.sourcegitcommit: 09a34635ed0e74d6c2625f6a485c78f201c689ee
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2020
ms.locfileid: "91763460"
---
# <a name="work-with-samesite-cookies-in-aspnet"></a><span data-ttu-id="f26d7-103">Usare i cookie navigava sullostesso sito in ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f26d7-103">Work with SameSite cookies in ASP.NET</span></span>

<span data-ttu-id="f26d7-104">Autore: [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="f26d7-104">By [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="f26d7-105">Navigava sullostesso sito è uno standard [IETF](https://ietf.org/about/) Draft progettato per garantire una protezione contro gli attacchi di richiesta intersito falsificazione (CSRF).</span><span class="sxs-lookup"><span data-stu-id="f26d7-105">SameSite is an [IETF](https://ietf.org/about/) draft standard designed to provide some protection against cross-site request forgery (CSRF) attacks.</span></span> <span data-ttu-id="f26d7-106">Originariamente redatto in [2016](https://tools.ietf.org/html/draft-west-first-party-cookies-07), il Draft standard è stato aggiornato in [2019](https://tools.ietf.org/html/draft-west-cookie-incrementalism-00).</span><span class="sxs-lookup"><span data-stu-id="f26d7-106">Originally drafted in [2016](https://tools.ietf.org/html/draft-west-first-party-cookies-07), the draft standard was updated in [2019](https://tools.ietf.org/html/draft-west-cookie-incrementalism-00).</span></span> <span data-ttu-id="f26d7-107">Lo standard aggiornato non è compatibile con le versioni precedenti dello standard precedente, con le differenze più evidenti tra quelle riportate di seguito:</span><span class="sxs-lookup"><span data-stu-id="f26d7-107">The updated standard is not backward compatible with the previous standard, with the following being the most noticeable differences:</span></span>

* <span data-ttu-id="f26d7-108">I cookie senza intestazione navigava sullostesso sito vengono considerati come `SameSite=Lax` per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="f26d7-108">Cookies without SameSite header are treated as `SameSite=Lax` by default.</span></span>
* <span data-ttu-id="f26d7-109">`SameSite=None` deve essere usato per consentire l'uso di cookie tra siti.</span><span class="sxs-lookup"><span data-stu-id="f26d7-109">`SameSite=None` must be used to allow cross-site cookie use.</span></span>
* <span data-ttu-id="f26d7-110">I cookie che asseriscono `SameSite=None` anche devono essere contrassegnati come `Secure` .</span><span class="sxs-lookup"><span data-stu-id="f26d7-110">Cookies that assert `SameSite=None` must also be marked as `Secure`.</span></span>
* <span data-ttu-id="f26d7-111">Le applicazioni che utilizzano [`<iframe>`](https://developer.mozilla.org/docs/Web/HTML/Element/iframe) potrebbero riscontrare problemi con i `sameSite=Lax` cookie di o `sameSite=Strict` perché `<iframe>` vengono considerati scenari tra siti.</span><span class="sxs-lookup"><span data-stu-id="f26d7-111">Applications that use [`<iframe>`](https://developer.mozilla.org/docs/Web/HTML/Element/iframe) may experience issues with `sameSite=Lax` or `sameSite=Strict` cookies because `<iframe>` is treated as cross-site scenarios.</span></span>
* <span data-ttu-id="f26d7-112">Il valore `SameSite=None` non è consentito dallo [standard 2016](https://tools.ietf.org/html/draft-west-first-party-cookies-07) e fa in modo che alcune implementazioni considerino tali cookie come `SameSite=Strict` .</span><span class="sxs-lookup"><span data-stu-id="f26d7-112">The value `SameSite=None` is not allowed by the [2016 standard](https://tools.ietf.org/html/draft-west-first-party-cookies-07) and causes some implementations to treat such cookies as `SameSite=Strict`.</span></span> <span data-ttu-id="f26d7-113">Vedere [supporto di browser meno recenti](#sob) in questo documento.</span><span class="sxs-lookup"><span data-stu-id="f26d7-113">See [Supporting older browsers](#sob) in this document.</span></span>

<span data-ttu-id="f26d7-114">L' `SameSite=Lax` impostazione funziona per la maggior parte dei cookie dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f26d7-114">The `SameSite=Lax` setting works for most application cookies.</span></span> <span data-ttu-id="f26d7-115">Alcune forme di autenticazione come [OpenID Connect](https://openid.net/connect/) (OIDC) e l'impostazione predefinita di [WS-Federation](https://auth0.com/docs/protocols/ws-fed) sono i reindirizzamenti basati su post.</span><span class="sxs-lookup"><span data-stu-id="f26d7-115">Some forms of authentication like [OpenID Connect](https://openid.net/connect/) (OIDC) and [WS-Federation](https://auth0.com/docs/protocols/ws-fed) default to POST based redirects.</span></span> <span data-ttu-id="f26d7-116">I reindirizzamenti basati su POST attivano le protezioni del browser navigava sullostesso sito, pertanto navigava sullostesso sito è disabilitato per questi componenti.</span><span class="sxs-lookup"><span data-stu-id="f26d7-116">The POST based redirects trigger the SameSite browser protections, so SameSite is disabled for these components.</span></span> <span data-ttu-id="f26d7-117">La maggior parte degli accessi [OAuth](https://oauth.net/) non è interessata a causa di differenze nel modo in cui la richiesta fluisce.</span><span class="sxs-lookup"><span data-stu-id="f26d7-117">Most [OAuth](https://oauth.net/) logins are not affected due to differences in how the request flows.</span></span>

<span data-ttu-id="f26d7-118">Ogni componente ASP.NET che emette cookie deve decidere se navigava sullostesso sito è appropriato.</span><span class="sxs-lookup"><span data-stu-id="f26d7-118">Each ASP.NET component that emits cookies needs to decide if SameSite is appropriate.</span></span>

<span data-ttu-id="f26d7-119">Vedere [problemi noti](#known) relativi a problemi con le applicazioni dopo l'installazione degli aggiornamenti di navigava sullostesso sito .NET 2019.</span><span class="sxs-lookup"><span data-stu-id="f26d7-119">See [Known Issues](#known) for problems with applications after installing the 2019 .Net SameSite updates.</span></span>

## <a name="using-samesite-in-aspnet-472-and-48"></a><span data-ttu-id="f26d7-120">Uso di navigava sullostesso sito in ASP.NET 4.7.2 e 4,8</span><span class="sxs-lookup"><span data-stu-id="f26d7-120">Using SameSite in ASP.NET 4.7.2 and 4.8</span></span>

<span data-ttu-id="f26d7-121">.NET 4.7.2 e 4,8 supporta lo [standard 2019 Draft](https://tools.ietf.org/html/draft-west-cookie-incrementalism-00) per navigava sullostesso sito dal rilascio degli aggiornamenti nel 2019 dicembre.</span><span class="sxs-lookup"><span data-stu-id="f26d7-121">.Net 4.7.2 and 4.8 supports the [2019 draft standard](https://tools.ietf.org/html/draft-west-cookie-incrementalism-00) for SameSite since the release of updates in December 2019.</span></span> <span data-ttu-id="f26d7-122">Gli sviluppatori sono in grado di controllare a livello di codice il valore dell'intestazione navigava sullostesso sito usando la [Proprietà HttpCookie. navigava sullostesso sito](/dotnet/api/system.web.httpcookie.samesite#System_Web_HttpCookie_SameSite).</span><span class="sxs-lookup"><span data-stu-id="f26d7-122">Developers are able to programmatically control the value of the SameSite header using the [HttpCookie.SameSite property](/dotnet/api/system.web.httpcookie.samesite#System_Web_HttpCookie_SameSite).</span></span> <span data-ttu-id="f26d7-123">L'impostazione della `SameSite` proprietà su `Strict` , `Lax` o `None` comporta la scrittura di tali valori in rete con il cookie.</span><span class="sxs-lookup"><span data-stu-id="f26d7-123">Setting the `SameSite` property to `Strict`, `Lax`, or `None` results in those values being written on the network with the cookie.</span></span> <span data-ttu-id="f26d7-124">L'impostazione di un valore uguale a `(SameSiteMode)(-1)` indica che non è necessario includere nella rete alcuna intestazione navigava sullostesso sito con il cookie.</span><span class="sxs-lookup"><span data-stu-id="f26d7-124">Setting it equal to `(SameSiteMode)(-1)` indicates that no SameSite header should be included on the network with the cookie.</span></span> <span data-ttu-id="f26d7-125">È possibile usare la [Proprietà HttpCookie. Secure](/dotnet/api/system.web.httpcookie.secure)o ' RequireSSL ' nei file di configurazione per contrassegnare il cookie come `Secure` o no.</span><span class="sxs-lookup"><span data-stu-id="f26d7-125">The [HttpCookie.Secure Property](/dotnet/api/system.web.httpcookie.secure), or 'requireSSL' in config files, can be used to mark the cookie as `Secure` or not.</span></span>

<span data-ttu-id="f26d7-126">`HttpCookie`Le nuove istanze utilizzeranno per impostazione predefinita `SameSite=(SameSiteMode)(-1)` e `Secure=false` .</span><span class="sxs-lookup"><span data-stu-id="f26d7-126">New `HttpCookie` instances will default to `SameSite=(SameSiteMode)(-1)` and `Secure=false`.</span></span> <span data-ttu-id="f26d7-127">Queste impostazioni predefinite possono essere sostituite nella `system.web/httpCookies` sezione di configurazione, in cui la stringa `"Unspecified"` è una sintassi di sola configurazione intuitiva per `(SameSiteMode)(-1)` :</span><span class="sxs-lookup"><span data-stu-id="f26d7-127">These defaults can be overridden in the `system.web/httpCookies` configuration section, where the string `"Unspecified"` is a friendly configuration-only syntax for `(SameSiteMode)(-1)`:</span></span>

```xml
<configuration>
 <system.web>
  <httpCookies sameSite="[Strict|Lax|None|Unspecified]" requireSSL="[true|false]" />
 <system.web>
<configuration>
```

<span data-ttu-id="f26d7-128">ASP.Net emette anche quattro cookie specifici per queste funzionalità: autenticazione anonima, autenticazione basata su form, stato sessione e gestione dei ruoli.</span><span class="sxs-lookup"><span data-stu-id="f26d7-128">ASP.Net also issues four specific cookies of its own for these features: Anonymous Authentication, Forms Authentication, Session State, and Role Management.</span></span> <span data-ttu-id="f26d7-129">Le istanze di questi cookie ottenute in fase di esecuzione possono essere modificate usando le `SameSite` `Secure` proprietà e esattamente come qualsiasi altra istanza di HttpCookie.</span><span class="sxs-lookup"><span data-stu-id="f26d7-129">Instances of these cookies obtained in runtime can be manipulated using the `SameSite` and `Secure` properties just like any other HttpCookie instance.</span></span> <span data-ttu-id="f26d7-130">Tuttavia, a causa dell'emergenza patchwork dello standard navigava sullostesso sito, le opzioni di configurazione per questi quattro cookie di funzionalità sono incoerenti.</span><span class="sxs-lookup"><span data-stu-id="f26d7-130">However, due to the patchwork emergence of the SameSite standard, configuration options for these four features cookies is inconsistent.</span></span> <span data-ttu-id="f26d7-131">Di seguito sono riportati gli attributi e le sezioni di configurazione pertinenti, con le impostazioni predefinite.</span><span class="sxs-lookup"><span data-stu-id="f26d7-131">The relevant configuration sections and attributes, with defaults, are shown below.</span></span> <span data-ttu-id="f26d7-132">Se non è disponibile `SameSite` alcun `Secure` attributo o correlato per una funzionalità, la funzionalità verrà riattivata nei valori predefiniti configurati nella `system.web/httpCookies` sezione descritta in precedenza.</span><span class="sxs-lookup"><span data-stu-id="f26d7-132">If there is no `SameSite` or `Secure` related attribute for a feature, then the feature will fall back on the defaults configured in the `system.web/httpCookies` section discussed above.</span></span>

```xml
<configuration>
 <system.web>
  <anonymousIdentification cookieRequireSSL="false" /> <!-- No config attribute for SameSite -->
  <authentication>
   <forms cookieSameSite="Lax" requireSSL="false" />
  </authentication>
  <sessionState cookieSameSite="Lax" /> <!-- No config attribute for Secure -->
  <roleManager cookieRequireSSL="false" /> <!-- No config attribute for SameSite -->
 <system.web>
<configuration>
```  

<span data-ttu-id="f26d7-133">**Nota**:' non specificato ' è disponibile al `system.web/httpCookies@sameSite` momento.</span><span class="sxs-lookup"><span data-stu-id="f26d7-133">**Note**: 'Unspecified' is only available to `system.web/httpCookies@sameSite` at the moment.</span></span> <span data-ttu-id="f26d7-134">Ci auguriamo di aggiungere una sintassi simile agli attributi cookieSameSite illustrati in precedenza negli aggiornamenti futuri.</span><span class="sxs-lookup"><span data-stu-id="f26d7-134">We hope to add similar syntax to the previously shown cookieSameSite attributes in future updates.</span></span> <span data-ttu-id="f26d7-135">L'impostazione `(SameSiteMode)(-1)` nel codice funziona comunque con le istanze di questi cookie. \*</span><span class="sxs-lookup"><span data-stu-id="f26d7-135">Setting `(SameSiteMode)(-1)` in code still works on instances of these cookies.\*</span></span>

[!INCLUDE[](~/includes/MTcomments.md)]

<a name="retargeting"></a>

### <a name="retarget-net-apps"></a><span data-ttu-id="f26d7-136">Ridestinare le app .NET</span><span class="sxs-lookup"><span data-stu-id="f26d7-136">Retarget .NET apps</span></span>

<span data-ttu-id="f26d7-137">Per specificare come destinazione .NET 4.7.2 o versione successiva:</span><span class="sxs-lookup"><span data-stu-id="f26d7-137">To target .NET 4.7.2 or later:</span></span>

* <span data-ttu-id="f26d7-138">Verificare che *web.config* contenga quanto segue:</span><span class="sxs-lookup"><span data-stu-id="f26d7-138">Ensure *web.config* contains the following:</span></span>  <!-- review, I removed `debug="true"` -->

  ```xml
  <system.web>
    <compilation targetFramework="4.7.2"/>
    <httpRuntime targetFramework="4.7.2"/>
  </system.web>

* Verify the project file contains the correct [TargetFrameworkVersion](/visualstudio/msbuild/msbuild-target-framework-and-target-platform?view=vs-2019):

  ```xml
  <TargetFrameworkVersion>v4.7.2</TargetFrameworkVersion>
  ```

  <span data-ttu-id="f26d7-139">Per informazioni dettagliate, fare [riferimento alla guida alla migrazione di .NET](/dotnet/framework/migration-guide/) .</span><span class="sxs-lookup"><span data-stu-id="f26d7-139">The [.NET Migration Guide](/dotnet/framework/migration-guide/) has more details.</span></span>

* <span data-ttu-id="f26d7-140">Verificare che i pacchetti NuGet nel progetto siano destinati alla versione del Framework corretta.</span><span class="sxs-lookup"><span data-stu-id="f26d7-140">Verify NuGet packages in the project are targeted at the correct framework version.</span></span> <span data-ttu-id="f26d7-141">È possibile verificare la versione corretta del Framework esaminando il file di *packages.config* , ad esempio:</span><span class="sxs-lookup"><span data-stu-id="f26d7-141">You can verify the correct framework version by examining the *packages.config* file, for example:</span></span>

  ```xml
  <?xml version="1.0" encoding="utf-8"?>
  <packages>
    <package id="Microsoft.AspNet.Mvc" version="5.2.7" targetFramework="net472" />
    <package id="Microsoft.ApplicationInsights" version="2.4.0" targetFramework="net451" />
  </packages>
  ```

  <span data-ttu-id="f26d7-142">Nel file di *packages.config* precedente, il `Microsoft.ApplicationInsights` pacchetto:</span><span class="sxs-lookup"><span data-stu-id="f26d7-142">In the preceding *packages.config* file, the `Microsoft.ApplicationInsights` package:</span></span>
    * <span data-ttu-id="f26d7-143">È destinato a .NET 4.5.1.</span><span class="sxs-lookup"><span data-stu-id="f26d7-143">Is  targeted against .NET 4.5.1.</span></span>
    * <span data-ttu-id="f26d7-144">L'attributo deve essere `targetFramework` aggiornato a `net472` se è presente un pacchetto aggiornato destinato alla destinazione del Framework.</span><span class="sxs-lookup"><span data-stu-id="f26d7-144">Should have its `targetFramework` attribute updated to `net472` if an updated package targeting your framework target exists.</span></span>

<a name="nope"></a>

### <a name="net-versions-earlier-than-472"></a><span data-ttu-id="f26d7-145">Versioni di .NET precedenti a 4.7.2</span><span class="sxs-lookup"><span data-stu-id="f26d7-145">.NET versions earlier than 4.7.2</span></span>

<span data-ttu-id="f26d7-146">Microsoft non supporta le versioni di .NET, più 4.7.2 per la scrittura dell'attributo del cookie dello stesso sito.</span><span class="sxs-lookup"><span data-stu-id="f26d7-146">Microsoft does not support .NET versions lower that 4.7.2 for writing the same-site cookie attribute.</span></span> <span data-ttu-id="f26d7-147">Non è stato trovato alcun modo affidabile per:</span><span class="sxs-lookup"><span data-stu-id="f26d7-147">We have not found a reliable way to:</span></span>

* <span data-ttu-id="f26d7-148">Verificare che l'attributo sia scritto correttamente in base alla versione del browser.</span><span class="sxs-lookup"><span data-stu-id="f26d7-148">Ensure the attribute is written correctly based on browser version.</span></span>
* <span data-ttu-id="f26d7-149">Intercettare e modificare i cookie di autenticazione e di sessione nelle versioni precedenti del Framework.</span><span class="sxs-lookup"><span data-stu-id="f26d7-149">Intercept and adjust authentication and session cookies on older framework versions.</span></span>

### <a name="december-patch-behavior-changes"></a><span data-ttu-id="f26d7-150">Modifiche al comportamento della patch di dicembre</span><span class="sxs-lookup"><span data-stu-id="f26d7-150">December patch behavior changes</span></span>

<span data-ttu-id="f26d7-151">La modifica del comportamento specifico per .NET Framework è il modo in cui la `SameSite` Proprietà interpreta il `None` valore:</span><span class="sxs-lookup"><span data-stu-id="f26d7-151">The specific behavior change for .NET Framework is how the `SameSite` property interprets the `None` value:</span></span>

* <span data-ttu-id="f26d7-152">Prima della patch, il valore `None` significava:</span><span class="sxs-lookup"><span data-stu-id="f26d7-152">Before the patch a value of `None` meant:</span></span>
  * <span data-ttu-id="f26d7-153">Non creare l'attributo.</span><span class="sxs-lookup"><span data-stu-id="f26d7-153">Do not emit the attribute at all.</span></span>
* <span data-ttu-id="f26d7-154">Dopo la patch:</span><span class="sxs-lookup"><span data-stu-id="f26d7-154">After the patch:</span></span>
  * <span data-ttu-id="f26d7-155">Il valore `None` indica che l'attributo viene emesso con un valore pari a `None` .</span><span class="sxs-lookup"><span data-stu-id="f26d7-155">A value of `None`it means "Emit the attribute with a value of `None`".</span></span>
  * <span data-ttu-id="f26d7-156">`SameSite` `(SameSiteMode)(-1)` Il valore fa sì che l'attributo non venga emesso.</span><span class="sxs-lookup"><span data-stu-id="f26d7-156">A `SameSite` value of `(SameSiteMode)(-1)` causes the attribute not to be emitted.</span></span>

<span data-ttu-id="f26d7-157">Il valore predefinito di navigava sullostesso sito per l'autenticazione basata su form e i cookie di stato della sessione è stato modificato da `None` a `Lax` .</span><span class="sxs-lookup"><span data-stu-id="f26d7-157">The default SameSite value for forms authentication and session state cookies was changed from `None` to `Lax`.</span></span>

### <a name="summary-of-change-impact-on-browsers"></a><span data-ttu-id="f26d7-158">Riepilogo dell'effetto delle modifiche nei browser</span><span class="sxs-lookup"><span data-stu-id="f26d7-158">Summary of change impact on browsers</span></span>

<span data-ttu-id="f26d7-159">Se si installa la patch e si rilascia un cookie con `SameSite.None` , si verificherà una delle due operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="f26d7-159">If you install the patch and issue a cookie with `SameSite.None`, one of two things will happen:</span></span>
* <span data-ttu-id="f26d7-160">Chrome V80 tratterà questo cookie in base alla nuova implementazione e non imporrà le stesse restrizioni del sito sul cookie.</span><span class="sxs-lookup"><span data-stu-id="f26d7-160">Chrome v80 will treat this cookie according to the new implementation, and not enforce same site restrictions on the cookie.</span></span>
* <span data-ttu-id="f26d7-161">Tutti i browser che non sono stati aggiornati per supportare la nuova implementazione seguiranno l'implementazione precedente.</span><span class="sxs-lookup"><span data-stu-id="f26d7-161">Any browser that has not been updated to support the new implementation will follow the old implementation.</span></span> <span data-ttu-id="f26d7-162">L'implementazione precedente afferma:</span><span class="sxs-lookup"><span data-stu-id="f26d7-162">The old implementation says:</span></span>
  * <span data-ttu-id="f26d7-163">Se viene visualizzato un valore che non si comprende, ignorarlo e passare a restrizioni dello stesso sito.</span><span class="sxs-lookup"><span data-stu-id="f26d7-163">If you see a value you don't understand, ignore it and switch to strict same site restrictions.</span></span>

<span data-ttu-id="f26d7-164">Quindi, l'app si interrompe in Chrome o si interrompe in molte altre posizioni.</span><span class="sxs-lookup"><span data-stu-id="f26d7-164">So either the app breaks in Chrome, or you break in numerous other places.</span></span>

## <a name="history-and-changes"></a><span data-ttu-id="f26d7-165">Cronologia e modifiche</span><span class="sxs-lookup"><span data-stu-id="f26d7-165">History and changes</span></span>

<span data-ttu-id="f26d7-166">Il supporto di navigava sullostesso sito è stato implementato per la prima volta in .NET 4.7.2 usando lo [standard draft 2016](https://tools.ietf.org/html/draft-west-first-party-cookies-07#section-4.1).</span><span class="sxs-lookup"><span data-stu-id="f26d7-166">SameSite support was first implemented in .NET 4.7.2 using the [2016 draft standard](https://tools.ietf.org/html/draft-west-first-party-cookies-07#section-4.1).</span></span>

<span data-ttu-id="f26d7-167">Il 19 novembre 2019 aggiornamenti per Windows aggiornamento di .NET 4.7.2 + dallo standard 2016 allo standard 2019.</span><span class="sxs-lookup"><span data-stu-id="f26d7-167">The November 19, 2019 updates for Windows updated .NET 4.7.2+ from the 2016 standard to the 2019 standard.</span></span> <span data-ttu-id="f26d7-168">Ulteriori aggiornamenti sono imminenti per le altre versioni di Windows.</span><span class="sxs-lookup"><span data-stu-id="f26d7-168">Additional updates are forthcoming for other versions of Windows.</span></span> <span data-ttu-id="f26d7-169">Per altre informazioni, vedere <xref:samesite/kbs-samesite>.</span><span class="sxs-lookup"><span data-stu-id="f26d7-169">For more information, see <xref:samesite/kbs-samesite>.</span></span>

 <span data-ttu-id="f26d7-170">Bozza 2019 della specifica navigava sullostesso sito:</span><span class="sxs-lookup"><span data-stu-id="f26d7-170">The 2019 draft of the SameSite specification:</span></span>

* <span data-ttu-id="f26d7-171">**Non** è compatibile con le versioni precedenti della bozza 2016.</span><span class="sxs-lookup"><span data-stu-id="f26d7-171">Is **not** backwards compatible with the 2016 draft.</span></span> <span data-ttu-id="f26d7-172">Per ulteriori informazioni, vedere [supporto dei browser meno recenti](#sob) in questo documento.</span><span class="sxs-lookup"><span data-stu-id="f26d7-172">For more information, see [Supporting older browsers](#sob) in this document.</span></span>
* <span data-ttu-id="f26d7-173">Specifica che i cookie vengono considerati come `SameSite=Lax` per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="f26d7-173">Specifies cookies are treated as `SameSite=Lax` by default.</span></span>
* <span data-ttu-id="f26d7-174">Specifica i cookie che asseriscono in modo esplicito `SameSite=None` per abilitare il recapito tra siti, anche deve essere contrassegnato come `Secure` .</span><span class="sxs-lookup"><span data-stu-id="f26d7-174">Specifies cookies that explicitly assert `SameSite=None` in order to enable cross-site delivery should also be marked as `Secure`.</span></span>
* <span data-ttu-id="f26d7-175">È supportato dalle patch rilasciate come descritto nella Knowledge base elencata in precedenza.</span><span class="sxs-lookup"><span data-stu-id="f26d7-175">Is supported by patches issued as described in the KB's listed above.</span></span>
* <span data-ttu-id="f26d7-176">Viene pianificata per essere abilitata per impostazione predefinita da [Chrome](https://chromestatus.com/feature/5088147346030592) in [feb 2020](https://blog.chromium.org/2019/10/developers-get-ready-for-new.html).</span><span class="sxs-lookup"><span data-stu-id="f26d7-176">Is scheduled to be enabled by [Chrome](https://chromestatus.com/feature/5088147346030592) by default in [Feb 2020](https://blog.chromium.org/2019/10/developers-get-ready-for-new.html).</span></span> <span data-ttu-id="f26d7-177">Il passaggio a questo standard nei browser è stato avviato in 2019.</span><span class="sxs-lookup"><span data-stu-id="f26d7-177">Browsers started moving to this standard in 2019.</span></span>

<a name="known"></a>

## <a name="known-issues"></a><span data-ttu-id="f26d7-178">Problemi noti</span><span class="sxs-lookup"><span data-stu-id="f26d7-178">Known Issues</span></span>

<span data-ttu-id="f26d7-179">Poiché le specifiche draft 2016 e 2019 non sono compatibili, l'aggiornamento di novembre 2019 .NET Framework introduce alcune modifiche che potrebbero compromettere.</span><span class="sxs-lookup"><span data-stu-id="f26d7-179">Because the 2016 and 2019 draft specifications are not compatible, the November 2019 .Net Framework update introduces some changes that may be breaking.</span></span>

* <span data-ttu-id="f26d7-180">Lo stato della sessione e i cookie di autenticazione basata su form vengono ora scritti nella rete come `Lax` anziché non specificati.</span><span class="sxs-lookup"><span data-stu-id="f26d7-180">Session State and Forms Authentication cookies are now written to the network as `Lax` instead of unspecified.</span></span>
  * <span data-ttu-id="f26d7-181">Sebbene la maggior parte delle app funzioni con `SameSite=Lax` i cookie, le app che pubblicano i siti o le applicazioni che usano `iframe` possono rilevare che i cookie relativi allo stato della sessione o all'autorizzazione basata su form non vengono usati come previsto.</span><span class="sxs-lookup"><span data-stu-id="f26d7-181">While most apps work with `SameSite=Lax` cookies, apps that POST across sites or applications that make use of `iframe` may find that their session state or forms authorization cookies aren't being used as expected.</span></span> <span data-ttu-id="f26d7-182">Per risolvere questo problema, modificare il `cookieSameSite` valore nella sezione di configurazione appropriata come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="f26d7-182">To remedy this, change the `cookieSameSite` value in the appropriate configuration section as discussed previously.</span></span>
* <span data-ttu-id="f26d7-183">HttpCookies che imposta in modo esplicito `SameSite=None` nel codice o nella configurazione ora hanno tale valore scritto con il cookie, mentre in precedenza è stato omesso.</span><span class="sxs-lookup"><span data-stu-id="f26d7-183">HttpCookies that explicitly set `SameSite=None` in code or configuration now have that value written with the cookie, whereas it was previously omitted.</span></span> <span data-ttu-id="f26d7-184">Ciò può causare problemi con i browser meno recenti che supportano solo lo standard 2016 Draft.</span><span class="sxs-lookup"><span data-stu-id="f26d7-184">This may cause issues with older browsers that only support the 2016 draft standard.</span></span>
  * <span data-ttu-id="f26d7-185">Quando la destinazione è il browser che supporta lo standard 2019 Draft con i `SameSite=None` cookie, ricordarsi di contrassegnarli anche `Secure` o non riconosciuti.</span><span class="sxs-lookup"><span data-stu-id="f26d7-185">When targeting browsers supporting the 2019 draft standard with `SameSite=None` cookies, remember to also mark them `Secure` or they may not be recognized.</span></span>
  * <span data-ttu-id="f26d7-186">Per ripristinare il comportamento 2016 di non scrivere `SameSite=None` , usare l'impostazione app `aspnet:SupressSameSiteNone=true` .</span><span class="sxs-lookup"><span data-stu-id="f26d7-186">To revert to the 2016 behavior of not writing `SameSite=None`, use the app setting `aspnet:SupressSameSiteNone=true`.</span></span> <span data-ttu-id="f26d7-187">Si noti che questa operazione verrà applicata a tutti HttpCookies nell'app.</span><span class="sxs-lookup"><span data-stu-id="f26d7-187">Note that this will apply to all HttpCookies in the app.</span></span>

### <a name="azure-app-servicesamesite-cookie-handling"></a><span data-ttu-id="f26d7-188">Servizio app Azure-gestione dei cookie navigava sullostesso sito</span><span class="sxs-lookup"><span data-stu-id="f26d7-188">Azure App Service—SameSite cookie handling</span></span>

<span data-ttu-id="f26d7-189">Per informazioni sul modo in cui app Azure servizio sta configurando i comportamenti navigava sullostesso sito nelle app .NET 4.7.2 [, vedere app Azure Service-gestione dei cookie navigava sullostesso sito e .NET Framework patch 4.7.2](https://azure.microsoft.com/updates/app-service-samesite-cookie-update/) .</span><span class="sxs-lookup"><span data-stu-id="f26d7-189">See [Azure App Service—SameSite cookie handling and .NET Framework 4.7.2 patch](https://azure.microsoft.com/updates/app-service-samesite-cookie-update/) for information about how Azure App Service is configuring SameSite behaviors in .Net 4.7.2 apps.</span></span>

<a name="sob"></a>

## <a name="supporting-older-browsers"></a><span data-ttu-id="f26d7-190">Supporto di browser meno recenti</span><span class="sxs-lookup"><span data-stu-id="f26d7-190">Supporting older browsers</span></span>

<span data-ttu-id="f26d7-191">Lo standard 2016 navigava sullostesso sito ha richiesto che i valori sconosciuti debbano essere considerati `SameSite=Strict` valori.</span><span class="sxs-lookup"><span data-stu-id="f26d7-191">The 2016 SameSite standard mandated that unknown values must be treated as `SameSite=Strict` values.</span></span> <span data-ttu-id="f26d7-192">Le app a cui è stato eseguito l'accesso da browser meno recenti che supportano lo standard navigava sullostesso sito 2016 possono interrompersi quando ottengono una proprietà navigava sullostesso sito con un valore `None` .</span><span class="sxs-lookup"><span data-stu-id="f26d7-192">Apps accessed from older browsers which support the 2016 SameSite standard may break when they get a SameSite property with a value of `None`.</span></span> <span data-ttu-id="f26d7-193">Le app Web devono implementare il rilevamento del browser se intendono supportare browser meno recenti.</span><span class="sxs-lookup"><span data-stu-id="f26d7-193">Web apps must implement browser detection if they intend to support older browsers.</span></span> <span data-ttu-id="f26d7-194">ASP.NET non implementa il rilevamento del browser perché i valori degli agenti utente sono altamente volatili e cambiano di frequente.</span><span class="sxs-lookup"><span data-stu-id="f26d7-194">ASP.NET doesn't implement browser detection because User-Agents values are highly volatile and change frequently.</span></span>

<span data-ttu-id="f26d7-195">L'approccio di Microsoft alla risoluzione del problema consiste nell'implementare i componenti di rilevamento del browser per rimuovere l' `sameSite=None` attributo dai cookie se un browser non lo supporta.</span><span class="sxs-lookup"><span data-stu-id="f26d7-195">Microsoft's approach to fixing the problem is to help you implement browser detection components to strip the `sameSite=None` attribute from cookies if a browser is known to not support it.</span></span> <span data-ttu-id="f26d7-196">Il Consiglio di Google è stato quello di emettere cookie doppi, uno con il nuovo attributo e uno senza l'attributo.</span><span class="sxs-lookup"><span data-stu-id="f26d7-196">Google's advice was to issue double cookies, one with the new attribute, and one without the attribute at all.</span></span> <span data-ttu-id="f26d7-197">Si considerino tuttavia i suggerimenti di Google limitati.</span><span class="sxs-lookup"><span data-stu-id="f26d7-197">However we consider Google's advice limited.</span></span> <span data-ttu-id="f26d7-198">Alcuni browser, in particolare i browser per dispositivi mobili, hanno limiti molto limitati al numero di cookie di un sito oppure possono inviare un nome di dominio.</span><span class="sxs-lookup"><span data-stu-id="f26d7-198">Some browsers, especially mobile browsers have very small limits on the number of cookies a site, or a domain name can send.</span></span> <span data-ttu-id="f26d7-199">Inviare più cookie, soprattutto cookie di grandi dimensioni come i cookie di autenticazione, può raggiungere il limite del browser per dispositivi mobili molto rapidamente, causando errori delle app difficili da diagnosticare e correggere.</span><span class="sxs-lookup"><span data-stu-id="f26d7-199">Sending multiple cookies, especially large cookies like authentication cookies can reach the mobile browser limit very quickly, causing app failures that are hard to diagnose and fix.</span></span> <span data-ttu-id="f26d7-200">Inoltre, come Framework è disponibile un ampio ecosistema di codice di terze parti e componenti che potrebbero non essere aggiornati per l'utilizzo di un approccio con doppio cookie.</span><span class="sxs-lookup"><span data-stu-id="f26d7-200">Furthermore as a framework there is a large ecosystem of third party code and components that may not be updated to use a double cookie approach.</span></span>

<span data-ttu-id="f26d7-201">Il codice di rilevamento del browser usato nei progetti di esempio in [questo repository GitHub]() è contenuto in due file</span><span class="sxs-lookup"><span data-stu-id="f26d7-201">The browser detection code used in the sample projects in [this GitHub repository]() is contained in two files</span></span>

* [<span data-ttu-id="f26d7-202">SameSiteSupport.cs C#</span><span class="sxs-lookup"><span data-stu-id="f26d7-202">C# SameSiteSupport.cs</span></span>](https://github.com/blowdart/AspNetSameSiteSamples/blob/master/SameSiteSupport.cs)
* [<span data-ttu-id="f26d7-203">VB SameSiteSupport. vb</span><span class="sxs-lookup"><span data-stu-id="f26d7-203">VB SameSiteSupport.vb</span></span>](https://github.com/blowdart/AspNetSameSiteSamples/blob/master/SameSiteSupport.vb)

<span data-ttu-id="f26d7-204">Questi rilevamenti sono gli agenti browser più comuni osservati che supportano lo standard 2016 e per i quali è necessario rimuovere completamente l'attributo.</span><span class="sxs-lookup"><span data-stu-id="f26d7-204">These detections are the most common browser agents we have seen that support the 2016 standard and for which the attribute needs to be completely removed.</span></span> <span data-ttu-id="f26d7-205">Non è concepito come un'implementazione completa:</span><span class="sxs-lookup"><span data-stu-id="f26d7-205">It isn't meant as a complete implementation:</span></span>

* <span data-ttu-id="f26d7-206">L'app può visualizzare i browser non disponibili nei siti di test.</span><span class="sxs-lookup"><span data-stu-id="f26d7-206">Your app may see browsers that our test sites do not.</span></span>
* <span data-ttu-id="f26d7-207">È necessario essere pronti ad aggiungere i rilevamenti necessari per l'ambiente.</span><span class="sxs-lookup"><span data-stu-id="f26d7-207">You should be prepared to add detections as necessary for your environment.</span></span>

<span data-ttu-id="f26d7-208">La modalità di collegamento del rilevamento varia a seconda della versione di .NET e del framework Web in uso.</span><span class="sxs-lookup"><span data-stu-id="f26d7-208">How you wire up the detection varies according the version of .NET and the web framework that you are using.</span></span> <span data-ttu-id="f26d7-209">Il codice seguente può essere chiamato nel sito di chiamata [HttpCookie](/dotnet/api/system.web.httpcookie) :</span><span class="sxs-lookup"><span data-stu-id="f26d7-209">The following code can be called at the [HttpCookie](/dotnet/api/system.web.httpcookie) call site:</span></span>

[!code-csharp[](sample/SameSiteCheck.cs?name=snippet)]

<span data-ttu-id="f26d7-210">Vedere gli argomenti seguenti relativi ai cookie ASP.NET 4.7.2 navigava sullostesso sito:</span><span class="sxs-lookup"><span data-stu-id="f26d7-210">See the following ASP.NET 4.7.2 SameSite cookie topics:</span></span>

* [<span data-ttu-id="f26d7-211">MVC C#</span><span class="sxs-lookup"><span data-stu-id="f26d7-211">C# MVC</span></span>](xref:samesite/csMVC)
* [<span data-ttu-id="f26d7-212">WebForms C#</span><span class="sxs-lookup"><span data-stu-id="f26d7-212">C# WebForms</span></span>](xref:samesite/CSharpWebForms)
* [<span data-ttu-id="f26d7-213">WebForms VB</span><span class="sxs-lookup"><span data-stu-id="f26d7-213">VB WebForms</span></span>](xref:samesite/vbWF)
* [<span data-ttu-id="f26d7-214">MVC VB</span><span class="sxs-lookup"><span data-stu-id="f26d7-214">VB MVC</span></span>](xref:samesite/vbMVC)
<!--
* <xref:samesite/csMVC>
* <xref:samesite/CSharpWebForms>
* <xref:samesite/vbWF>
* <xref:samesite/vbMVC>
-->

### <a name="ensuring-your-site-redirects-to-https"></a><span data-ttu-id="f26d7-215">Verifica del reindirizzamento del sito a HTTPS</span><span class="sxs-lookup"><span data-stu-id="f26d7-215">Ensuring your site redirects to HTTPS</span></span>

<span data-ttu-id="f26d7-216">Per ASP.NET 4. x, Web Form e MVC, la funzionalità di [riscrittura URL di IIS](/iis/extensions/url-rewrite-module/creating-rewrite-rules-for-the-url-rewrite-module) può essere usata per reindirizzare tutte le richieste a HTTPS.</span><span class="sxs-lookup"><span data-stu-id="f26d7-216">For ASP.NET 4.x, WebForms and MVC, [IIS's URL Rewrite](/iis/extensions/url-rewrite-module/creating-rewrite-rules-for-the-url-rewrite-module) feature can be used to redirect all requests to HTTPS.</span></span> <span data-ttu-id="f26d7-217">Nel codice XML seguente viene illustrata una regola di esempio:</span><span class="sxs-lookup"><span data-stu-id="f26d7-217">The following XML shows a sample rule:</span></span>

```xml
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.webServer>
    <rewrite>
      <rules>
        <rule name="Redirect to https" stopProcessing="true">
          <match url="(.*)"/>
          <conditions>
            <add input="{HTTPS}" pattern="Off"/>
            <add input="{REQUEST_METHOD}" pattern="^get$|^head$" />
          </conditions>
          <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" redirectType="Permanent"/>
        </rule>
      </rules>
    </rewrite>
  </system.webServer>
</configuration>
```

<span data-ttu-id="f26d7-218">Nelle installazioni locali di [IIS URL Rewrite](https://www.iis.net/downloads/microsoft/url-rewrite) è una funzionalità facoltativa che potrebbe richiedere l'installazione di.</span><span class="sxs-lookup"><span data-stu-id="f26d7-218">In on-premises installations of [IIS URL Rewrite](https://www.iis.net/downloads/microsoft/url-rewrite) is an optional feature that may need installing.</span></span>

## <a name="test-apps-for-samesite-problems"></a><span data-ttu-id="f26d7-219">Testare le app per i problemi di navigava sullostesso sito</span><span class="sxs-lookup"><span data-stu-id="f26d7-219">Test apps for SameSite problems</span></span>

<span data-ttu-id="f26d7-220">È necessario testare l'app con i browser supportati ed esaminare gli scenari che coinvolgono i cookie.</span><span class="sxs-lookup"><span data-stu-id="f26d7-220">You must test your app with the browsers you support and go through your scenarios that involve cookies.</span></span> <span data-ttu-id="f26d7-221">Gli scenari di cookie coinvolgono generalmente</span><span class="sxs-lookup"><span data-stu-id="f26d7-221">Cookie scenarios typically involve</span></span>

* <span data-ttu-id="f26d7-222">Form di accesso</span><span class="sxs-lookup"><span data-stu-id="f26d7-222">Login forms</span></span>
* <span data-ttu-id="f26d7-223">Meccanismi di accesso esterni, ad esempio Facebook, Azure AD, OAuth e OIDC</span><span class="sxs-lookup"><span data-stu-id="f26d7-223">External login mechanisms such as Facebook, Azure AD, OAuth and OIDC</span></span>
* <span data-ttu-id="f26d7-224">Pagine che accettano richieste da altri siti</span><span class="sxs-lookup"><span data-stu-id="f26d7-224">Pages that accept requests from other sites</span></span>
* <span data-ttu-id="f26d7-225">Pagine nell'app progettate per essere incorporate in iframe</span><span class="sxs-lookup"><span data-stu-id="f26d7-225">Pages in your app designed to be embedded in iframes</span></span>

<span data-ttu-id="f26d7-226">Verificare che i cookie vengano creati, salvati in modo permanente ed eliminati correttamente nell'app.</span><span class="sxs-lookup"><span data-stu-id="f26d7-226">You should check that cookies are created, persisted and deleted correctly in your app.</span></span>

<span data-ttu-id="f26d7-227">Le app che interagiscono con i siti remoti, ad esempio tramite l'accesso di terze parti, devono:</span><span class="sxs-lookup"><span data-stu-id="f26d7-227">Apps that interact with remote sites such as through third-party login need to:</span></span>

* <span data-ttu-id="f26d7-228">Testare l'interazione su più browser.</span><span class="sxs-lookup"><span data-stu-id="f26d7-228">Test the interaction on multiple browsers.</span></span>
* <span data-ttu-id="f26d7-229">Applicare il [rilevamento e la mitigazione del browser](#sob) discussi in questo documento.</span><span class="sxs-lookup"><span data-stu-id="f26d7-229">Apply the [browser detection and mitigation](#sob) discussed in this document.</span></span>

<span data-ttu-id="f26d7-230">Testare le app Web usando una versione client che può acconsentire esplicitamente al nuovo comportamento del navigava sullostesso sito.</span><span class="sxs-lookup"><span data-stu-id="f26d7-230">Test web apps using a client version that can opt-in to the new SameSite behavior.</span></span> <span data-ttu-id="f26d7-231">Chrome, Firefox e Chromium Edge hanno tutti nuovi flag di funzionalità di consenso esplicito che possono essere usati per i test.</span><span class="sxs-lookup"><span data-stu-id="f26d7-231">Chrome, Firefox, and Chromium Edge all have new opt-in feature flags that can be used for testing.</span></span> <span data-ttu-id="f26d7-232">Quando l'app applica le patch di navigava sullostesso sito, testarla con versioni client precedenti, in particolare Safari.</span><span class="sxs-lookup"><span data-stu-id="f26d7-232">After your app applies the SameSite patches, test it with older client versions, especially Safari.</span></span> <span data-ttu-id="f26d7-233">Per ulteriori informazioni, vedere [supporto dei browser meno recenti](#sob) in questo documento.</span><span class="sxs-lookup"><span data-stu-id="f26d7-233">For more information, see [Supporting older browsers](#sob) in this document.</span></span>

### <a name="test-with-chrome"></a><span data-ttu-id="f26d7-234">Eseguire test con Chrome</span><span class="sxs-lookup"><span data-stu-id="f26d7-234">Test with Chrome</span></span>

<span data-ttu-id="f26d7-235">Chrome 78 + fornisce risultati fuorvianti perché prevede una mitigazione temporanea.</span><span class="sxs-lookup"><span data-stu-id="f26d7-235">Chrome 78+ gives misleading results because it has a temporary mitigation in place.</span></span> <span data-ttu-id="f26d7-236">La mitigazione temporanea di Chrome 78 + consente ai cookie meno di due minuti di età.</span><span class="sxs-lookup"><span data-stu-id="f26d7-236">The Chrome 78+ temporary mitigation allows cookies less than two minutes old.</span></span> <span data-ttu-id="f26d7-237">Chrome 76 o 77 con i flag di test appropriati abilitati fornisce risultati più accurati.</span><span class="sxs-lookup"><span data-stu-id="f26d7-237">Chrome 76 or 77 with the appropriate test flags enabled provides more accurate results.</span></span> <span data-ttu-id="f26d7-238">Per testare il nuovo comportamento `chrome://flags/#same-site-by-default-cookies` di navigava sullostesso sito, impostare su **Enabled**.</span><span class="sxs-lookup"><span data-stu-id="f26d7-238">To test the new SameSite behavior toggle `chrome://flags/#same-site-by-default-cookies` to **Enabled**.</span></span> <span data-ttu-id="f26d7-239">Le versioni precedenti di Chrome (75 e versioni precedenti) vengono segnalate per avere esito negativo con la nuova `None` impostazione.</span><span class="sxs-lookup"><span data-stu-id="f26d7-239">Older versions of Chrome (75 and below) are reported to fail with the new `None` setting.</span></span> <span data-ttu-id="f26d7-240">Vedere [supporto di browser meno recenti](#sob) in questo documento.</span><span class="sxs-lookup"><span data-stu-id="f26d7-240">See [Supporting older browsers](#sob) in this document.</span></span>

<span data-ttu-id="f26d7-241">Google non rende disponibili versioni precedenti di Chrome.</span><span class="sxs-lookup"><span data-stu-id="f26d7-241">Google does not make older chrome versions available.</span></span> <span data-ttu-id="f26d7-242">Seguire le istruzioni riportate in [scaricare Chromium](https://www.chromium.org/getting-involved/download-chromium) per testare le versioni precedenti di Chrome.</span><span class="sxs-lookup"><span data-stu-id="f26d7-242">Follow the instructions at [Download Chromium](https://www.chromium.org/getting-involved/download-chromium) to test older versions of Chrome.</span></span> <span data-ttu-id="f26d7-243">Non **scaricare Chrome** dai collegamenti forniti cercando le versioni precedenti di Chrome.</span><span class="sxs-lookup"><span data-stu-id="f26d7-243">Do **not** download Chrome from links provided by searching for older versions of chrome.</span></span>

* [<span data-ttu-id="f26d7-244">Cromo 76 Win64</span><span class="sxs-lookup"><span data-stu-id="f26d7-244">Chromium 76 Win64</span></span>](https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win_x64/664998/)
* [<span data-ttu-id="f26d7-245">Cromo 74 Win64</span><span class="sxs-lookup"><span data-stu-id="f26d7-245">Chromium 74 Win64</span></span>](https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win_x64/638880/)
* <span data-ttu-id="f26d7-246">Se non si usa una versione a 64 bit di Windows, è possibile usare il [Visualizzatore OmahaProxy](https://omahaproxy.appspot.com/) per cercare il ramo cromo corrispondente a Chrome 74 (v 74.0.3729.108) usando le [istruzioni fornite da Chromium](https://www.chromium.org/getting-involved/download-chromium).</span><span class="sxs-lookup"><span data-stu-id="f26d7-246">If you're not using a 64bit version of Windows you can use the [OmahaProxy viewer](https://omahaproxy.appspot.com/) to look up which Chromium branch corresponds to Chrome 74 (v74.0.3729.108) using the [instructions provided by Chromium](https://www.chromium.org/getting-involved/download-chromium).</span></span>

<span data-ttu-id="f26d7-247">A partire dalla versione Canary `80.0.3975.0` , è possibile disabilitare la mitigazione temporanea + post temporanea a scopo di test usando il nuovo flag `--enable-features=SameSiteDefaultChecksMethodRigorously` per consentire il test di siti e servizi nello stato finale finale della funzionalità in cui è stata rimossa la mitigazione.</span><span class="sxs-lookup"><span data-stu-id="f26d7-247">Starting in Canary version `80.0.3975.0`, the Lax+POST temporary mitigation can be disabled for testing purposes using the new flag `--enable-features=SameSiteDefaultChecksMethodRigorously` to allow testing of sites and services in the eventual end state of the feature where the mitigation has been removed.</span></span> <span data-ttu-id="f26d7-248">Per ulteriori informazioni, vedere la pagina relativa agli [aggiornamenti di navigava sullostesso sito](https://www.chromium.org/updates/same-site) per progetti Chromium</span><span class="sxs-lookup"><span data-stu-id="f26d7-248">For more information, see The Chromium Projects [SameSite Updates](https://www.chromium.org/updates/same-site)</span></span>

#### <a name="test-with-chrome-80"></a><span data-ttu-id="f26d7-249">Test con Chrome 80 +</span><span class="sxs-lookup"><span data-stu-id="f26d7-249">Test with Chrome 80+</span></span>

<span data-ttu-id="f26d7-250">[Scaricare](https://www.google.com/chrome/) una versione di Chrome che supporta il nuovo attributo.</span><span class="sxs-lookup"><span data-stu-id="f26d7-250">[Download](https://www.google.com/chrome/) a version of Chrome that supports their new attribute.</span></span> <span data-ttu-id="f26d7-251">Al momento della stesura di questo documento, la versione corrente è Chrome 80.</span><span class="sxs-lookup"><span data-stu-id="f26d7-251">At the time of writing, the current version is Chrome 80.</span></span> <span data-ttu-id="f26d7-252">`chrome://flags/#same-site-by-default-cookies`Per usare il nuovo comportamento, Chrome 80 necessita del flag abilitato.</span><span class="sxs-lookup"><span data-stu-id="f26d7-252">Chrome 80 needs the flag `chrome://flags/#same-site-by-default-cookies` enabled to use the new behavior.</span></span> <span data-ttu-id="f26d7-253">È inoltre consigliabile abilitare ( `chrome://flags/#cookies-without-same-site-must-be-secure` ) per testare il comportamento imminente per i cookie per i quali non sono abilitati attributi navigava sullostesso sito.</span><span class="sxs-lookup"><span data-stu-id="f26d7-253">You should also enable (`chrome://flags/#cookies-without-same-site-must-be-secure`) to test the upcoming behavior for cookies which have no sameSite attribute enabled.</span></span> <span data-ttu-id="f26d7-254">Chrome 80 si trova nella destinazione per fare in modo che il Commuter tratti i cookie senza l'attributo come `SameSite=Lax` , sebbene con un periodo di tolleranza programmato per determinate richieste.</span><span class="sxs-lookup"><span data-stu-id="f26d7-254">Chrome 80 is on target to make the switch to treat cookies without the attribute as `SameSite=Lax`, albeit with a timed grace period for certain requests.</span></span> <span data-ttu-id="f26d7-255">Per disabilitare il periodo di tolleranza temporizzato, Chrome 80 può essere avviato con l'argomento della riga di comando seguente:</span><span class="sxs-lookup"><span data-stu-id="f26d7-255">To disable the timed grace period Chrome 80 can be launched with the following command line argument:</span></span>

`--enable-features=SameSiteDefaultChecksMethodRigorously`

<span data-ttu-id="f26d7-256">Chrome 80 contiene messaggi di avviso nella console del browser sugli attributi navigava sullostesso sito mancanti.</span><span class="sxs-lookup"><span data-stu-id="f26d7-256">Chrome 80 has warning messages in the browser console about missing sameSite attributes.</span></span> <span data-ttu-id="f26d7-257">Usare F12 per aprire la console del browser.</span><span class="sxs-lookup"><span data-stu-id="f26d7-257">Use F12 to open the browser console.</span></span>

### <a name="test-with-safari"></a><span data-ttu-id="f26d7-258">Eseguire test con Safari</span><span class="sxs-lookup"><span data-stu-id="f26d7-258">Test with Safari</span></span>

<span data-ttu-id="f26d7-259">Safari 12 ha implementato rigorosamente la bozza precedente e ha esito negativo quando il nuovo `None` valore si trova in un cookie.</span><span class="sxs-lookup"><span data-stu-id="f26d7-259">Safari 12 strictly implemented the prior draft and fails when the new `None` value is in a cookie.</span></span> <span data-ttu-id="f26d7-260">`None` viene evitato tramite il codice di rilevamento del browser che [supporta i browser meno recenti](#sob) in questo documento.</span><span class="sxs-lookup"><span data-stu-id="f26d7-260">`None` is avoided via the browser detection code [Supporting older browsers](#sob) in this document.</span></span> <span data-ttu-id="f26d7-261">Testare gli accessi basati su stile sistema operativo Safari 12, Safari 13 e WebKit usando MSAL, ADAL o qualsiasi libreria in uso.</span><span class="sxs-lookup"><span data-stu-id="f26d7-261">Test Safari 12, Safari 13, and WebKit based OS style logins using MSAL, ADAL or whatever library you are using.</span></span> <span data-ttu-id="f26d7-262">Il problema dipende dalla versione del sistema operativo sottostante.</span><span class="sxs-lookup"><span data-stu-id="f26d7-262">The problem is dependent on the underlying OS version.</span></span> <span data-ttu-id="f26d7-263">I problemi di compatibilità con il nuovo comportamento navigava sullostesso sito sono noti per OSX Mojave (10,14) e iOS 12.</span><span class="sxs-lookup"><span data-stu-id="f26d7-263">OSX Mojave (10.14) and iOS 12 are known to have compatibility problems with the new SameSite behavior.</span></span> <span data-ttu-id="f26d7-264">L'aggiornamento del sistema operativo a OSX Catalina (10,15) o iOS 13 corregge il problema.</span><span class="sxs-lookup"><span data-stu-id="f26d7-264">Upgrading the OS to OSX Catalina (10.15) or iOS 13 fixes the problem.</span></span> <span data-ttu-id="f26d7-265">Safari attualmente non dispone di un flag di consenso esplicito per il test del nuovo comportamento delle specifiche.</span><span class="sxs-lookup"><span data-stu-id="f26d7-265">Safari does not currently have an opt-in flag for testing the new spec behavior.</span></span>

### <a name="test-with-firefox"></a><span data-ttu-id="f26d7-266">Eseguire test con Firefox</span><span class="sxs-lookup"><span data-stu-id="f26d7-266">Test with Firefox</span></span>

<span data-ttu-id="f26d7-267">Il supporto di Firefox per il nuovo standard può essere testato nella versione 68 + scegliendo nella `about:config` pagina con il flag funzionalità `network.cookie.sameSite.laxByDefault` .</span><span class="sxs-lookup"><span data-stu-id="f26d7-267">Firefox support for the new standard can be tested on version 68+ by opting in on the `about:config` page with the feature flag `network.cookie.sameSite.laxByDefault`.</span></span> <span data-ttu-id="f26d7-268">Non sono stati segnalati problemi di compatibilità con le versioni precedenti di Firefox.</span><span class="sxs-lookup"><span data-stu-id="f26d7-268">There haven't been reports of compatibility issues with older versions of Firefox.</span></span>

### <a name="test-with-edge-legacy-browser"></a><span data-ttu-id="f26d7-269">Test con browser Edge (legacy)</span><span class="sxs-lookup"><span data-stu-id="f26d7-269">Test with Edge (Legacy) browser</span></span>

<span data-ttu-id="f26d7-270">Edge supporta lo standard navigava sullostesso sito precedente.</span><span class="sxs-lookup"><span data-stu-id="f26d7-270">Edge supports the old SameSite standard.</span></span> <span data-ttu-id="f26d7-271">Edge versione 44 + non presenta problemi di compatibilità noti con il nuovo standard.</span><span class="sxs-lookup"><span data-stu-id="f26d7-271">Edge version 44+ doesn't have any known compatibility problems with the new standard.</span></span>

### <a name="test-with-edge-chromium"></a><span data-ttu-id="f26d7-272">Test con Edge (cromo)</span><span class="sxs-lookup"><span data-stu-id="f26d7-272">Test with Edge (Chromium)</span></span>

<span data-ttu-id="f26d7-273">I flag navigava sullostesso sito sono impostati nella `edge://flags/#same-site-by-default-cookies` pagina.</span><span class="sxs-lookup"><span data-stu-id="f26d7-273">SameSite flags are set on the `edge://flags/#same-site-by-default-cookies` page.</span></span> <span data-ttu-id="f26d7-274">Nessun problema di compatibilità rilevato con cromo perimetrale.</span><span class="sxs-lookup"><span data-stu-id="f26d7-274">No compatibility issues were discovered with Edge Chromium.</span></span>

### <a name="test-with-electron"></a><span data-ttu-id="f26d7-275">Test con elettrone</span><span class="sxs-lookup"><span data-stu-id="f26d7-275">Test with Electron</span></span>

<span data-ttu-id="f26d7-276">Le versioni di Electron includono versioni precedenti di cromo.</span><span class="sxs-lookup"><span data-stu-id="f26d7-276">Versions of Electron include older versions of Chromium.</span></span> <span data-ttu-id="f26d7-277">Ad esempio, la versione di Electron usata dai team è Chromium 66, che presenta il comportamento precedente.</span><span class="sxs-lookup"><span data-stu-id="f26d7-277">For example, the version of Electron used by Teams is Chromium 66, which exhibits the older behavior.</span></span> <span data-ttu-id="f26d7-278">È necessario eseguire test di compatibilità personalizzati con la versione di Electron utilizzata dal prodotto.</span><span class="sxs-lookup"><span data-stu-id="f26d7-278">You must perform your own compatibility testing with the version of Electron your product uses.</span></span> <span data-ttu-id="f26d7-279">Vedere [supporto di browser meno recenti](#sob).</span><span class="sxs-lookup"><span data-stu-id="f26d7-279">See [Supporting older browsers](#sob).</span></span>

## <a name="reverting-samesite-patches"></a><span data-ttu-id="f26d7-280">Ripristino di patch navigava sullostesso sito</span><span class="sxs-lookup"><span data-stu-id="f26d7-280">Reverting SameSite patches</span></span>

<span data-ttu-id="f26d7-281">È possibile ripristinare il comportamento di navigava sullostesso sito aggiornato nelle app .NET Framework al comportamento precedente in cui l'attributo navigava sullostesso sito non viene emesso per un valore di `None` e ripristinare i cookie di autenticazione e di sessione in modo da non creare il valore.</span><span class="sxs-lookup"><span data-stu-id="f26d7-281">You can revert the updated sameSite behavior in .NET Framework apps to its previous behavior where the sameSite attribute is not emitted for a value of `None`, and revert the authentication and session cookies to not emit the value.</span></span> <span data-ttu-id="f26d7-282">Questa operazione dovrebbe essere considerata una *correzione estremamente temporanea*, in quanto le modifiche al Chrome interromperanno le richieste post esterne o l'autenticazione per gli utenti che usano browser che supportano le modifiche allo standard.</span><span class="sxs-lookup"><span data-stu-id="f26d7-282">This should be viewed as an *extremely temporary fix*, as the Chrome changes will break any external POST requests or authentication for users using browsers which support the changes to the standard.</span></span>

### <a name="reverting-net-472-behavior"></a><span data-ttu-id="f26d7-283">Ripristino del comportamento 4.7.2 .NET</span><span class="sxs-lookup"><span data-stu-id="f26d7-283">Reverting .NET 4.7.2 behavior</span></span>

<span data-ttu-id="f26d7-284">Aggiornare *web.config* per includere le impostazioni di configurazione seguenti:</span><span class="sxs-lookup"><span data-stu-id="f26d7-284">Update *web.config* to include the following configuration settings:</span></span>

```xml
<configuration> 
  <appSettings>
    <add key="aspnet:SuppressSameSiteNone" value="true" />
  </appSettings>
 
  <system.web> 
    <authentication> 
      <forms cookieSameSite="None" /> 
    </authentication> 
    <sessionState cookieSameSite="None" /> 
  </system.web> 
</configuration>
```

## <a name="additional-resources"></a><span data-ttu-id="f26d7-285">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="f26d7-285">Additional resources</span></span>

* [<span data-ttu-id="f26d7-286">Prossime modifiche ai cookie navigava sullostesso sito in ASP.NET e ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="f26d7-286">Upcoming SameSite Cookie Changes in ASP.NET and ASP.NET Core</span></span>](https://devblogs.microsoft.com/aspnet/upcoming-samesite-cookie-changes-in-asp-net-and-asp-net-core/)
* [<span data-ttu-id="f26d7-287">Suggerimenti per il test e il debug di navigava sullostesso sito per impostazione predefinita e "navigava sullostesso sito = None; Proteggi "cookie</span><span class="sxs-lookup"><span data-stu-id="f26d7-287">Tips for testing and debugging SameSite-by-default and “SameSite=None; Secure” cookies</span></span>](https://www.chromium.org/updates/same-site/test-debug)
* [<span data-ttu-id="f26d7-288">Blog di Chromium: sviluppatori: prepararsi per la nuova navigava sullostesso sito = None; Impostazioni sicure del cookie</span><span class="sxs-lookup"><span data-stu-id="f26d7-288">Chromium Blog:Developers: Get Ready for New SameSite=None; Secure Cookie Settings</span></span>](https://blog.chromium.org/2019/10/developers-get-ready-for-new.html)
* [<span data-ttu-id="f26d7-289">Spiegazione dei cookie navigava sullostesso sito</span><span class="sxs-lookup"><span data-stu-id="f26d7-289">SameSite cookies explained</span></span>](https://web.dev/samesite-cookies-explained/)
* [<span data-ttu-id="f26d7-290">Aggiornamenti Chrome</span><span class="sxs-lookup"><span data-stu-id="f26d7-290">Chrome Updates</span></span>](https://www.chromium.org/updates/same-site)
* [<span data-ttu-id="f26d7-291">Patch navigava sullostesso sito .NET</span><span class="sxs-lookup"><span data-stu-id="f26d7-291">.NET SameSite Patches</span></span>](/aspnet/samesite/kbs-samesite)
* [<span data-ttu-id="f26d7-292">Informazioni sullo stesso sito per le applicazioni Web di Azure</span><span class="sxs-lookup"><span data-stu-id="f26d7-292">Azure Web Applications Same Site Information</span></span>](https://azure.microsoft.com/updates/app-service-samesite-cookie-update/)
* [<span data-ttu-id="f26d7-293">Informazioni sullo stesso sito di Azure ActiveDirectory</span><span class="sxs-lookup"><span data-stu-id="f26d7-293">Azure ActiveDirectory Same Site Information</span></span>](/azure/active-directory/develop/howto-handle-samesite-cookie-changes-chrome-browser)
