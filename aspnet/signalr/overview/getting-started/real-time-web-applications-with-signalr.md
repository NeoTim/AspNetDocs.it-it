---
uid: signalr/overview/getting-started/real-time-web-applications-with-signalr
title: 'Laboratorio pratico: applicazioni Web in tempo reale con SignalR | Microsoft Docs'
author: bradygaster
description: Le applicazioni Web in tempo reale offrono la possibilità di eseguire il push del contenuto lato server ai client connessi come avviene, in tempo reale. Per gli sviluppatori ASP.NET, ASP...
ms.author: bradyg
ms.date: 07/16/2014
ms.assetid: ba07958c-42e1-4da0-81db-ba6925ed6db0
msc.legacyurl: /signalr/overview/getting-started/real-time-web-applications-with-signalr
msc.type: authoredcontent
ms.openlocfilehash: 9e39fd3f2fc9d4e791002450085215096c222fcd
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78537100"
---
# <a name="hands-on-lab-real-time-web-applications-with-signalr"></a><span data-ttu-id="2a241-104">Laboratorio pratico: applicazioni Web in tempo reale con SignalR</span><span class="sxs-lookup"><span data-stu-id="2a241-104">Hands On Lab: Real-Time Web Applications with SignalR</span></span>

<span data-ttu-id="2a241-105">dal [team di Web Camp](https://twitter.com/webcamps)</span><span class="sxs-lookup"><span data-stu-id="2a241-105">by [Web Camps Team](https://twitter.com/webcamps)</span></span>

[!INCLUDE [Consider ASP.NET Core SignalR](~/includes/signalr/signalr-version-disambiguation.md)]

[<span data-ttu-id="2a241-106">Scarica il kit di formazione di Web Camps, versione ottobre 2015</span><span class="sxs-lookup"><span data-stu-id="2a241-106">Download Web Camps Training Kit, October 2015 Release</span></span>](https://github.com/Microsoft-Web/WebCampTrainingKit/releases/tag/v2015.10.13b)

> <span data-ttu-id="2a241-107">Le applicazioni Web in tempo reale offrono la possibilità di eseguire il push del contenuto lato server ai client connessi come avviene, in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="2a241-107">Real-time Web applications feature the ability to push server-side content to the connected clients as it happens, in real-time.</span></span> <span data-ttu-id="2a241-108">Per gli sviluppatori ASP.NET, **ASP.NET SignalR** è una libreria che consente di aggiungere funzionalità Web in tempo reale alle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="2a241-108">For ASP.NET developers, **ASP.NET SignalR** is a library to add real-time web functionality to their applications.</span></span> <span data-ttu-id="2a241-109">Sfrutta i vantaggi di diversi trasporti, selezionando automaticamente il migliore trasporto disponibile, dato il migliore trasporto disponibile per il client e il server.</span><span class="sxs-lookup"><span data-stu-id="2a241-109">It takes advantage of several transports, automatically selecting the best available transport given the client and server's best available transport.</span></span> <span data-ttu-id="2a241-110">Sfrutta i vantaggi di **WebSocket**, un'API HTML5 che consente la comunicazione bidirezionale tra il browser e il server.</span><span class="sxs-lookup"><span data-stu-id="2a241-110">It takes advantage of **WebSocket**, an HTML5 API that enables bi-directional communication between the browser and server.</span></span>
> 
> <span data-ttu-id="2a241-111">**SignalR** fornisce anche un'API semplice e di alto livello per eseguire la RPC da server a client (chiamare le funzioni JavaScript nei browser dei client dal codice .NET lato server) nell'applicazione ASP.NET, nonché aggiungere utili hook per la gestione delle connessioni, ad esempio gli eventi di connessione/disconnessione, le connessioni di raggruppamento e l'autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="2a241-111">**SignalR** also provides a simple, high-level API for doing server to client RPC (call JavaScript functions in your clients' browsers from server-side .NET code) in your ASP.NET application, as well as adding useful hooks for connection management, such as connect/disconnect events, grouping connections, and authorization.</span></span>
> 
> <span data-ttu-id="2a241-112">**SignalR** è un'astrazione di alcuni dei trasporti necessari per eseguire operazioni in tempo reale tra client e server.</span><span class="sxs-lookup"><span data-stu-id="2a241-112">**SignalR** is an abstraction over some of the transports that are required to do real-time work between client and server.</span></span> <span data-ttu-id="2a241-113">Una connessione **SignalR** viene avviata come http e viene quindi promossa a una connessione **WebSocket** , se disponibile.</span><span class="sxs-lookup"><span data-stu-id="2a241-113">A **SignalR** connection starts as HTTP, and is then promoted to a **WebSocket** connection if available.</span></span> <span data-ttu-id="2a241-114">**WebSocket** è il trasporto ideale per **SignalR**, dal momento che rende più efficiente l'uso della memoria del server, presenta la latenza più bassa e presenta le funzionalità più sottostanti (ad esempio, la comunicazione duplex completa tra client e server), ma presenta anche i requisiti più severi: **WebSocket** richiede che il server usi **Windows server 2012** o **Windows 8**insieme a **.NET Framework 4,5**.</span><span class="sxs-lookup"><span data-stu-id="2a241-114">**WebSocket** is the ideal transport for **SignalR**, since it makes the most efficient use of server memory, has the lowest latency, and has the most underlying features (such as full duplex communication between client and server), but it also has the most stringent requirements: **WebSocket** requires the server to be using **Windows Server 2012** or **Windows 8**, along with **.NET Framework 4.5**.</span></span> <span data-ttu-id="2a241-115">Se questi requisiti non vengono soddisfatti, **SignalR** tenterà di usare altri trasporti per effettuare le connessioni (ad esempio, il *polling lungo Ajax*).</span><span class="sxs-lookup"><span data-stu-id="2a241-115">If these requirements are not met, **SignalR** will attempt to use other transports to make its connections (like *Ajax long polling*).</span></span>
> 
> <span data-ttu-id="2a241-116">L'API **SignalR** contiene due modelli per la comunicazione tra client e server: connessioni e **Hub** **permanenti** .</span><span class="sxs-lookup"><span data-stu-id="2a241-116">The **SignalR** API contains two models for communicating between clients and servers: **Persistent Connections** and **Hubs**.</span></span> <span data-ttu-id="2a241-117">Una **connessione** rappresenta un semplice endpoint per l'invio di messaggi a destinatario singolo, raggruppati o trasmessi.</span><span class="sxs-lookup"><span data-stu-id="2a241-117">A **Connection** represents a simple endpoint for sending single-recipient, grouped, or broadcast messages.</span></span> <span data-ttu-id="2a241-118">Un **Hub** è una pipeline più elevata basata sull'API di connessione che consente al client e al server di chiamare direttamente i metodi tra loro.</span><span class="sxs-lookup"><span data-stu-id="2a241-118">A **Hub** is a more high-level pipeline built upon the Connection API that allows your client and server to call methods on each other directly.</span></span>
> 
> ![Architettura SignalR](real-time-web-applications-with-signalr/_static/image1.png)
> 
> <span data-ttu-id="2a241-120">Tutti i codici e i frammenti di codice di esempio sono inclusi nel kit di formazione di Web Camp, versione ottobre 2015, disponibile all' [https://github.com/Microsoft-Web/WebCampTrainingKit/releases/tag/v2015.10.13b](https://github.com/Microsoft-Web/WebCampTrainingKit/releases/tag/v2015.10.13b).</span><span class="sxs-lookup"><span data-stu-id="2a241-120">All sample code and snippets are included in the Web Camps Training Kit, October 2015 Release, available at [https://github.com/Microsoft-Web/WebCampTrainingKit/releases/tag/v2015.10.13b](https://github.com/Microsoft-Web/WebCampTrainingKit/releases/tag/v2015.10.13b).</span></span>  <span data-ttu-id="2a241-121">Si noti che il collegamento del programma di installazione nella pagina non funziona più; usare invece uno dei collegamenti nella sezione asset.</span><span class="sxs-lookup"><span data-stu-id="2a241-121">Please note that the Installer link on that page no longer works; use one of the links under the Assets section instead.</span></span>

<a id="Overview"></a>
## <a name="overview"></a><span data-ttu-id="2a241-122">Panoramica</span><span class="sxs-lookup"><span data-stu-id="2a241-122">Overview</span></span>

<a id="Objectives"></a>
### <a name="objectives"></a><span data-ttu-id="2a241-123">Obiettivi</span><span class="sxs-lookup"><span data-stu-id="2a241-123">Objectives</span></span>

<span data-ttu-id="2a241-124">In questo laboratorio pratico si apprenderà come:</span><span class="sxs-lookup"><span data-stu-id="2a241-124">In this hands-on lab, you will learn how to:</span></span>

- <span data-ttu-id="2a241-125">Inviare notifiche dal server al client usando SignalR.</span><span class="sxs-lookup"><span data-stu-id="2a241-125">Send notifications from server to client using SignalR.</span></span>
- <span data-ttu-id="2a241-126">Scale Out l'applicazione SignalR usando **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="2a241-126">Scale Out your SignalR application using **SQL Server**.</span></span>

<a id="Prerequisites"></a>
### <a name="prerequisites"></a><span data-ttu-id="2a241-127">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="2a241-127">Prerequisites</span></span>

<span data-ttu-id="2a241-128">Per completare questa esercitazione pratica, è necessario quanto segue:</span><span class="sxs-lookup"><span data-stu-id="2a241-128">The following is required to complete this hands-on lab:</span></span>

- <span data-ttu-id="2a241-129">[Visual Studio Express 2013 per il Web](https://www.microsoft.com/visualstudio/) o versione successiva</span><span class="sxs-lookup"><span data-stu-id="2a241-129">[Visual Studio Express 2013 for Web](https://www.microsoft.com/visualstudio/) or greater</span></span>

<a id="Setup"></a>
### <a name="setup"></a><span data-ttu-id="2a241-130">Configurazione</span><span class="sxs-lookup"><span data-stu-id="2a241-130">Setup</span></span>

<span data-ttu-id="2a241-131">Per eseguire gli esercizi in questo laboratorio pratico, è necessario configurare prima l'ambiente.</span><span class="sxs-lookup"><span data-stu-id="2a241-131">In order to run the exercises in this hands-on lab, you will need to set up your environment first.</span></span>

1. <span data-ttu-id="2a241-132">Aprire una finestra di Esplora risorse e passare alla cartella di **origine** del Lab.</span><span class="sxs-lookup"><span data-stu-id="2a241-132">Open a Windows Explorer window and browse to the lab's **Source** folder.</span></span>
2. <span data-ttu-id="2a241-133">Fare clic con il pulsante destro del mouse su **Setup. cmd** e scegliere **Esegui come amministratore** per avviare il processo di installazione che configurerà l'ambiente e installerà i frammenti di codice di Visual Studio per questo Lab.</span><span class="sxs-lookup"><span data-stu-id="2a241-133">Right-click **Setup.cmd** and select **Run as administrator** to launch the setup process that will configure your environment and install the Visual Studio code snippets for this lab.</span></span>
3. <span data-ttu-id="2a241-134">Se viene visualizzata la finestra di dialogo controllo account utente, confermare l'azione per continuare.</span><span class="sxs-lookup"><span data-stu-id="2a241-134">If the User Account Control dialog box is shown, confirm the action to proceed.</span></span>

> [!NOTE]
> <span data-ttu-id="2a241-135">Prima di eseguire l'installazione, verificare di aver selezionato tutte le dipendenze per questo Lab.</span><span class="sxs-lookup"><span data-stu-id="2a241-135">Make sure you have checked all the dependencies for this lab before running the setup.</span></span>

<a id="CodeSnippets"></a>
### <a name="using-the-code-snippets"></a><span data-ttu-id="2a241-136">Uso dei frammenti di codice</span><span class="sxs-lookup"><span data-stu-id="2a241-136">Using the Code Snippets</span></span>

<span data-ttu-id="2a241-137">Nell'intero documento del Lab verrà richiesto di inserire blocchi di codice.</span><span class="sxs-lookup"><span data-stu-id="2a241-137">Throughout the lab document, you will be instructed to insert code blocks.</span></span> <span data-ttu-id="2a241-138">Per praticità, la maggior parte di questo codice viene fornita come Visual Studio Code frammenti, a cui è possibile accedere da Visual Studio 2013 per evitare di aggiungerla manualmente.</span><span class="sxs-lookup"><span data-stu-id="2a241-138">For your convenience, most of this code is provided as Visual Studio Code Snippets, which you can access from within Visual Studio 2013 to avoid having to add it manually.</span></span>

> [!NOTE]
> <span data-ttu-id="2a241-139">Ogni esercizio è accompagnato da una soluzione iniziale che si trova nella cartella **Begin** dell'esercizio che consente di seguire ogni esercizio in modo indipendente dagli altri.</span><span class="sxs-lookup"><span data-stu-id="2a241-139">Each exercise is accompanied by a starting solution located in the **Begin** folder of the exercise that allows you to follow each exercise independently of the others.</span></span> <span data-ttu-id="2a241-140">Tenere presente che i frammenti di codice aggiunti durante un esercizio risultano mancanti da queste soluzioni iniziali e potrebbero non funzionare fino a quando non è stato completato l'esercizio.</span><span class="sxs-lookup"><span data-stu-id="2a241-140">Please be aware that the code snippets that are added during an exercise are missing from these starting solutions and may not work until you have completed the exercise.</span></span> <span data-ttu-id="2a241-141">All'interno del codice sorgente per un esercizio, si troverà anche una cartella **finale** contenente una soluzione di Visual Studio con il codice risultante dal completamento dei passaggi nell'esercizio corrispondente.</span><span class="sxs-lookup"><span data-stu-id="2a241-141">Inside the source code for an exercise, you will also find an **End** folder containing a Visual Studio solution with the code that results from completing the steps in the corresponding exercise.</span></span> <span data-ttu-id="2a241-142">È possibile usare queste soluzioni come materiale sussidiario se è necessaria ulteriore assistenza durante l'utilizzo di questa esercitazione pratica.</span><span class="sxs-lookup"><span data-stu-id="2a241-142">You can use these solutions as guidance if you need additional help as you work through this hands-on lab.</span></span>

---

<a id="Exercises"></a>
## <a name="exercises"></a><span data-ttu-id="2a241-143">Esercizi</span><span class="sxs-lookup"><span data-stu-id="2a241-143">Exercises</span></span>

<span data-ttu-id="2a241-144">Questa esercitazione pratica include gli esercizi seguenti:</span><span class="sxs-lookup"><span data-stu-id="2a241-144">This hands-on lab includes the following exercises:</span></span>

1. [<span data-ttu-id="2a241-145">Utilizzo di dati in tempo reale tramite SignalR</span><span class="sxs-lookup"><span data-stu-id="2a241-145">Working with Real-Time Data Using SignalR</span></span>](#Exercise1)
2. [<span data-ttu-id="2a241-146">Scalabilità orizzontale con SQL Server</span><span class="sxs-lookup"><span data-stu-id="2a241-146">Scaling Out Using SQL Server</span></span>](#Exercise2)

<span data-ttu-id="2a241-147">Tempo stimato per il completamento del Lab: **60 minuti**</span><span class="sxs-lookup"><span data-stu-id="2a241-147">Estimated time to complete this lab: **60 minutes**</span></span>

> [!NOTE]
> <span data-ttu-id="2a241-148">Quando si avvia Visual Studio per la prima volta, è necessario selezionare una delle raccolte di impostazioni predefinite.</span><span class="sxs-lookup"><span data-stu-id="2a241-148">When you first start Visual Studio, you must select one of the predefined settings collections.</span></span> <span data-ttu-id="2a241-149">Ogni raccolta predefinita è progettata in modo da corrispondere a un particolare stile di sviluppo e determina il layout delle finestre, il comportamento dell'editor, i frammenti di codice IntelliSense e le opzioni della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="2a241-149">Each predefined collection is designed to match a particular development style and determines window layouts, editor behavior, IntelliSense code snippets, and dialog box options.</span></span> <span data-ttu-id="2a241-150">Le procedure descritte in questa esercitazione descrivono le azioni necessarie per eseguire un'attività specifica in Visual Studio quando si usa la raccolta di **impostazioni di sviluppo generali** .</span><span class="sxs-lookup"><span data-stu-id="2a241-150">The procedures in this lab describe the actions necessary to accomplish a given task in Visual Studio when using the **General Development Settings** collection.</span></span> <span data-ttu-id="2a241-151">Se si sceglie una raccolta di impostazioni diversa per l'ambiente di sviluppo, è possibile che siano presenti differenze nei passaggi da tenere in considerazione.</span><span class="sxs-lookup"><span data-stu-id="2a241-151">If you choose a different settings collection for your development environment, there may be differences in the steps that you should take into account.</span></span>

<a id="Exercise1"></a>
### <a name="exercise-1-working-with-real-time-data-using-signalr"></a><span data-ttu-id="2a241-152">Esercizio 1: utilizzo di dati in tempo reale tramite SignalR</span><span class="sxs-lookup"><span data-stu-id="2a241-152">Exercise 1: Working with Real-Time Data Using SignalR</span></span>

<span data-ttu-id="2a241-153">Sebbene la chat venga spesso utilizzata come esempio, è possibile eseguire molte altre operazioni con la funzionalità Web in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="2a241-153">While chat is often used as an example, you can do a whole lot more with real-time Web functionality.</span></span> <span data-ttu-id="2a241-154">Ogni volta che un utente aggiorna una pagina Web per visualizzare nuovi dati o la pagina implementa il polling lungo Ajax per recuperare i nuovi dati, è possibile usare SignalR.</span><span class="sxs-lookup"><span data-stu-id="2a241-154">Any time a user refreshes a web page to see new data or the page implements Ajax long polling to retrieve new data, you can use SignalR.</span></span>

<span data-ttu-id="2a241-155">SignalR supporta la funzionalità di push o **broadcast** del **Server** . gestisce automaticamente la gestione delle connessioni.</span><span class="sxs-lookup"><span data-stu-id="2a241-155">SignalR supports **server push** or **broadcasting** functionality; it handles connection management automatically.</span></span> <span data-ttu-id="2a241-156">Nelle connessioni HTTP classiche per la comunicazione client-server, viene ristabilita la connessione per ogni richiesta, ma SignalR fornisce una connessione permanente tra il client e il server.</span><span class="sxs-lookup"><span data-stu-id="2a241-156">In classic HTTP connections for client-server communication, connection is re-established for each request, but SignalR provides persistent connection between the client and server.</span></span> <span data-ttu-id="2a241-157">In SignalR il codice server chiama un codice client nel browser usando RPC (Remote Procedure Call), anziché il modello di richiesta-risposta attualmente noto.</span><span class="sxs-lookup"><span data-stu-id="2a241-157">In SignalR the server code calls out to a client code in the browser using Remote Procedure Calls (RPC), rather than the request-response model we know today.</span></span>

<span data-ttu-id="2a241-158">In questo esercizio verrà configurata l'applicazione di **quiz geek** per l'uso di SignalR per visualizzare il Dashboard delle statistiche con le metriche aggiornate senza dover aggiornare l'intera pagina.</span><span class="sxs-lookup"><span data-stu-id="2a241-158">In this exercise, you will configure the **Geek Quiz** application to use SignalR to display the Statistics dashboard with the updated metrics without the need to refresh the entire page.</span></span>

<a id="Ex1Task1"></a>
#### <a name="task-1--exploring-the-geek-quiz-statistics-page"></a><span data-ttu-id="2a241-159">Attività 1: esplorazione della pagina statistiche quiz di geek</span><span class="sxs-lookup"><span data-stu-id="2a241-159">Task 1 – Exploring the Geek Quiz Statistics Page</span></span>

<span data-ttu-id="2a241-160">In questa attività si procederà attraverso l'applicazione e si verificherà come viene visualizzata la pagina statistiche e come è possibile migliorare il modo in cui vengono aggiornate le informazioni.</span><span class="sxs-lookup"><span data-stu-id="2a241-160">In this task, you will go through the application and verify how the statistics page is shown and how you can improve the way the information is updated.</span></span>

1. <span data-ttu-id="2a241-161">Aprire **Visual Studio Express 2013 per il Web** e aprire la soluzione **GeekQuiz. sln** disponibile nella cartella **Source\Ex1-WorkingWithRealTimeData\Begin** .</span><span class="sxs-lookup"><span data-stu-id="2a241-161">Open **Visual Studio Express 2013 for Web** and open the **GeekQuiz.sln** solution located in the **Source\Ex1-WorkingWithRealTimeData\Begin** folder.</span></span>
2. <span data-ttu-id="2a241-162">Premere **F5** per eseguire la soluzione.</span><span class="sxs-lookup"><span data-stu-id="2a241-162">Press **F5** to run the solution.</span></span> <span data-ttu-id="2a241-163">La pagina di **accesso** verrà visualizzata nel browser.</span><span class="sxs-lookup"><span data-stu-id="2a241-163">The **Log in** page should appear in the browser.</span></span>

    <span data-ttu-id="2a241-164">![Esecuzione della soluzione](real-time-web-applications-with-signalr/_static/image2.png "Esecuzione della soluzione")</span><span class="sxs-lookup"><span data-stu-id="2a241-164">![Running the solution](real-time-web-applications-with-signalr/_static/image2.png "Running the solution")</span></span>

    <span data-ttu-id="2a241-165">*Esecuzione della soluzione*</span><span class="sxs-lookup"><span data-stu-id="2a241-165">*Running the solution*</span></span>
3. <span data-ttu-id="2a241-166">Fare clic su **registra** nell'angolo superiore destro della pagina per creare un nuovo utente nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="2a241-166">Click **Register** in the upper-right corner of the page to create a new user in the application.</span></span>

    <span data-ttu-id="2a241-167">![Registra collegamento](real-time-web-applications-with-signalr/_static/image3.png "Registra collegamento")</span><span class="sxs-lookup"><span data-stu-id="2a241-167">![Register link](real-time-web-applications-with-signalr/_static/image3.png "Register link")</span></span>

    <span data-ttu-id="2a241-168">*Registra collegamento*</span><span class="sxs-lookup"><span data-stu-id="2a241-168">*Register link*</span></span>
4. <span data-ttu-id="2a241-169">Nella pagina **Register** immettere un **nome utente** e una **password**e quindi fare clic su **Register (registra**).</span><span class="sxs-lookup"><span data-stu-id="2a241-169">In the **Register** page, enter a **User name** and **Password**, and then click **Register**.</span></span>

    <span data-ttu-id="2a241-170">![Registrazione di un utente](real-time-web-applications-with-signalr/_static/image4.png "Registrazione di un utente")</span><span class="sxs-lookup"><span data-stu-id="2a241-170">![Registering a user](real-time-web-applications-with-signalr/_static/image4.png "Registering a user")</span></span>

    <span data-ttu-id="2a241-171">*Registrazione di un utente*</span><span class="sxs-lookup"><span data-stu-id="2a241-171">*Registering a user*</span></span>
5. <span data-ttu-id="2a241-172">L'applicazione registra il nuovo account e l'utente viene autenticato e reindirizzato di nuovo all'home page che mostra la prima domanda del quiz.</span><span class="sxs-lookup"><span data-stu-id="2a241-172">The application registers the new account and the user is authenticated and redirected back to the home page showing the first quiz question.</span></span>
6. <span data-ttu-id="2a241-173">Aprire la pagina **statistiche** in una nuova finestra e inserire la pagina **iniziale** e la pagina **statistiche** affiancata.</span><span class="sxs-lookup"><span data-stu-id="2a241-173">Open the **Statistics** page in a new window and put the **Home** page and **Statistics** page side-by-side.</span></span>

    <span data-ttu-id="2a241-174">![Finestre affiancate](real-time-web-applications-with-signalr/_static/image5.png "Finestre affiancate")</span><span class="sxs-lookup"><span data-stu-id="2a241-174">![Side-by-side windows](real-time-web-applications-with-signalr/_static/image5.png "Side by side windows")</span></span>

    <span data-ttu-id="2a241-175">*Finestre affiancate*</span><span class="sxs-lookup"><span data-stu-id="2a241-175">*Side-by-side windows*</span></span>
7. <span data-ttu-id="2a241-176">Nella **Home** page, fare clic su una delle opzioni per rispondere alla domanda.</span><span class="sxs-lookup"><span data-stu-id="2a241-176">In the **Home** page, answer the question by clicking one of the options.</span></span>

    <span data-ttu-id="2a241-177">![Risposta a una domanda](real-time-web-applications-with-signalr/_static/image6.png "Risposta a una domanda")</span><span class="sxs-lookup"><span data-stu-id="2a241-177">![Answering a question](real-time-web-applications-with-signalr/_static/image6.png "Answering a question")</span></span>

    <span data-ttu-id="2a241-178">*Risposta a una domanda*</span><span class="sxs-lookup"><span data-stu-id="2a241-178">*Answering a question*</span></span>
8. <span data-ttu-id="2a241-179">Dopo aver fatto clic su uno dei pulsanti, viene visualizzata la risposta.</span><span class="sxs-lookup"><span data-stu-id="2a241-179">After clicking one of the buttons, the answer should appear.</span></span>

    <span data-ttu-id="2a241-180">![Risposta alla domanda corretta](real-time-web-applications-with-signalr/_static/image7.png "Risposta alla domanda corretta")</span><span class="sxs-lookup"><span data-stu-id="2a241-180">![Question answered correct](real-time-web-applications-with-signalr/_static/image7.png "Question answered correct")</span></span>

    <span data-ttu-id="2a241-181">*Risposta corretta alla domanda*</span><span class="sxs-lookup"><span data-stu-id="2a241-181">*Question answered correctly*</span></span>
9. <span data-ttu-id="2a241-182">Si noti che le informazioni fornite nella pagina statistiche sono obsolete.</span><span class="sxs-lookup"><span data-stu-id="2a241-182">Notice that the information provided in the Statistics page is outdated.</span></span> <span data-ttu-id="2a241-183">Aggiornare la pagina per visualizzare i risultati aggiornati.</span><span class="sxs-lookup"><span data-stu-id="2a241-183">Refresh the page in order to see the updated results.</span></span>

    <span data-ttu-id="2a241-184">![Pagina statistiche](real-time-web-applications-with-signalr/_static/image8.png "Pagina statistiche")</span><span class="sxs-lookup"><span data-stu-id="2a241-184">![Statistics page](real-time-web-applications-with-signalr/_static/image8.png "Statistics page")</span></span>

    <span data-ttu-id="2a241-185">*Pagina statistiche*</span><span class="sxs-lookup"><span data-stu-id="2a241-185">*Statistics page*</span></span>
10. <span data-ttu-id="2a241-186">Tornare a Visual Studio e arrestare il debug.</span><span class="sxs-lookup"><span data-stu-id="2a241-186">Go back to Visual Studio and stop debugging.</span></span>

<a id="Ex1Task2"></a>
#### <a name="task-2--adding-signalr-to-geek-quiz-to-show-online-charts"></a><span data-ttu-id="2a241-187">Attività 2: aggiunta di SignalR a quiz per geek per visualizzare i grafici online</span><span class="sxs-lookup"><span data-stu-id="2a241-187">Task 2 – Adding SignalR to Geek Quiz to Show Online Charts</span></span>

<span data-ttu-id="2a241-188">In questa attività si aggiungerà SignalR alla soluzione e si invieranno gli aggiornamenti ai client automaticamente quando viene inviata una nuova risposta al server.</span><span class="sxs-lookup"><span data-stu-id="2a241-188">In this task, you will add SignalR to the solution and send updates to the clients automatically when a new answer is sent to the server.</span></span>

1. <span data-ttu-id="2a241-189">Dal menu **strumenti** in Visual Studio selezionare **Gestione pacchetti NuGet**e quindi fare clic su **console di gestione pacchetti**.</span><span class="sxs-lookup"><span data-stu-id="2a241-189">From the **Tools** menu in Visual Studio, select **NuGet Package Manager**, and then click **Package Manager Console**.</span></span>
2. <span data-ttu-id="2a241-190">Nella finestra **console di gestione pacchetti** eseguire il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="2a241-190">In the **Package Manager Console** window, execute the following command:</span></span>

    [!code-powershell[Main](real-time-web-applications-with-signalr/samples/sample1.ps1)]

    <span data-ttu-id="2a241-191">![Installazione del pacchetto SignalR](real-time-web-applications-with-signalr/_static/image9.png "Installazione del pacchetto SignalR")</span><span class="sxs-lookup"><span data-stu-id="2a241-191">![SignalR package installation](real-time-web-applications-with-signalr/_static/image9.png "SignalR package installation")</span></span>

    <span data-ttu-id="2a241-192">*Installazione del pacchetto SignalR*</span><span class="sxs-lookup"><span data-stu-id="2a241-192">*SignalR package installation*</span></span>

   > [!NOTE]
   > <span data-ttu-id="2a241-193">Quando si installano i pacchetti NuGet di **SignalR** versione 2.0.2 da una nuova applicazione MVC 5, sarà necessario aggiornare manualmente i pacchetti **OWIN** alla versione 2.0.1 (o versione successiva) prima di installare SignalR.</span><span class="sxs-lookup"><span data-stu-id="2a241-193">When installing **SignalR** NuGet packages version 2.0.2 from a brand new MVC 5 application, you will need to manually update **OWIN** packages to version 2.0.1 (or higher) before installing SignalR.</span></span> <span data-ttu-id="2a241-194">A tale scopo, è possibile eseguire lo script seguente nella **console di gestione pacchetti**:</span><span class="sxs-lookup"><span data-stu-id="2a241-194">To do this, you can execute the following script in the **Package Manager Console**:</span></span>
   > 
   > [!code-powershell[Main](real-time-web-applications-with-signalr/samples/sample2.ps1)]
   > 
   > <span data-ttu-id="2a241-195">In una versione futura di SignalR le dipendenze di OWIN verranno aggiornate automaticamente.</span><span class="sxs-lookup"><span data-stu-id="2a241-195">In a future release of SignalR, OWIN dependencies will be automatically updated.</span></span>
3. <span data-ttu-id="2a241-196">In **Esplora soluzioni**espandere la cartella **Scripts** e notare che i file di SignalR *JS* sono stati aggiunti alla soluzione.</span><span class="sxs-lookup"><span data-stu-id="2a241-196">In **Solution Explorer**, expand the **Scripts** folder and notice that the SignalR *js* files were added to the solution.</span></span>

    <span data-ttu-id="2a241-197">![Riferimenti JavaScript a SignalR](real-time-web-applications-with-signalr/_static/image10.png "Riferimenti JavaScript a SignalR")</span><span class="sxs-lookup"><span data-stu-id="2a241-197">![SignalR JavaScript references](real-time-web-applications-with-signalr/_static/image10.png "SignalR JavaScript references")</span></span>

    <span data-ttu-id="2a241-198">*Riferimenti JavaScript a SignalR*</span><span class="sxs-lookup"><span data-stu-id="2a241-198">*SignalR JavaScript references*</span></span>
4. <span data-ttu-id="2a241-199">In **Esplora soluzioni**fare clic con il pulsante destro del mouse sul progetto **GeekQuiz** , selezionare **Aggiungi** | **nuova cartella**e denominarla **Hub**.</span><span class="sxs-lookup"><span data-stu-id="2a241-199">In **Solution Explorer**, right-click the **GeekQuiz** project, select **Add** | **New Folder**, and name it **Hubs**.</span></span>
5. <span data-ttu-id="2a241-200">Fare clic con il pulsante destro del mouse sulla cartella **Hub** e scegliere **Aggiungi | Nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="2a241-200">Right-click the **Hubs** folder and select **Add | New Item**.</span></span>

    <span data-ttu-id="2a241-201">![Aggiungi nuovo elemento](real-time-web-applications-with-signalr/_static/image11.png "Aggiungi nuovo elemento")</span><span class="sxs-lookup"><span data-stu-id="2a241-201">![Add new item](real-time-web-applications-with-signalr/_static/image11.png "Add new item")</span></span>

    <span data-ttu-id="2a241-202">*Aggiungi nuovo elemento*</span><span class="sxs-lookup"><span data-stu-id="2a241-202">*Add new item*</span></span>
6. <span data-ttu-id="2a241-203">Nella finestra di dialogo **Aggiungi nuovo elemento** selezionare l'oggetto **visivo C# | Web | Nodo SignalR** nel riquadro sinistro, selezionare **classe Hub SignalR (v2)** dal riquadro centrale, denominare il file **StatisticsHub.cs** e fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="2a241-203">In the **Add New Item** dialog box, select the **Visual C# | Web | SignalR** node in the left pane, select **SignalR Hub Class (v2)** from the center pane, name the file **StatisticsHub.cs** and click **Add**.</span></span>

    <span data-ttu-id="2a241-204">![Finestra di dialogo Aggiungi nuovo elemento](real-time-web-applications-with-signalr/_static/image12.png "Finestra di dialogo Aggiungi nuovo elemento")</span><span class="sxs-lookup"><span data-stu-id="2a241-204">![Add new item dialog box](real-time-web-applications-with-signalr/_static/image12.png "Add new item dialog box")</span></span>

    <span data-ttu-id="2a241-205">*Finestra di dialogo Aggiungi nuovo elemento*</span><span class="sxs-lookup"><span data-stu-id="2a241-205">*Add new item dialog box*</span></span>
7. <span data-ttu-id="2a241-206">Sostituire il codice nella classe **StatisticsHub** con il codice seguente.</span><span class="sxs-lookup"><span data-stu-id="2a241-206">Replace the code in the **StatisticsHub** class with the following code.</span></span>

    <span data-ttu-id="2a241-207">(Frammento di codice- *RealTimeSignalR-EX1-StatisticsHubClass*)</span><span class="sxs-lookup"><span data-stu-id="2a241-207">(Code Snippet - *RealTimeSignalR - Ex1 - StatisticsHubClass*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample3.cs)]
8. <span data-ttu-id="2a241-208">Aprire **Startup.cs** e aggiungere la riga seguente alla fine del metodo di **configurazione** .</span><span class="sxs-lookup"><span data-stu-id="2a241-208">Open **Startup.cs** and add the following line at the end of the **Configuration** method.</span></span>

    <span data-ttu-id="2a241-209">(Frammento di codice- *RealTimeSignalR-EX1-MapSignalR*)</span><span class="sxs-lookup"><span data-stu-id="2a241-209">(Code Snippet - *RealTimeSignalR - Ex1 - MapSignalR*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample4.cs)]
9. <span data-ttu-id="2a241-210">Aprire la pagina **StatisticsService.cs** all'interno della cartella **Servizi** e aggiungere le seguenti direttive using.</span><span class="sxs-lookup"><span data-stu-id="2a241-210">Open the **StatisticsService.cs** page inside the **Services** folder and add the following using directives.</span></span>

    <span data-ttu-id="2a241-211">(Frammento di codice- *RealTimeSignalR-EX1-UsingDirectives*)</span><span class="sxs-lookup"><span data-stu-id="2a241-211">(Code Snippet - *RealTimeSignalR - Ex1 - UsingDirectives*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample5.cs)]
10. <span data-ttu-id="2a241-212">Per notificare ai client connessi gli aggiornamenti, è innanzitutto necessario recuperare un oggetto di **contesto** per la connessione corrente.</span><span class="sxs-lookup"><span data-stu-id="2a241-212">To notify connected clients of updates, you first retrieve a **Context** object for the current connection.</span></span> <span data-ttu-id="2a241-213">L'oggetto **Hub** contiene i metodi per inviare messaggi a un singolo client o trasmettere a tutti i client connessi.</span><span class="sxs-lookup"><span data-stu-id="2a241-213">The **Hub** object contains methods to send messages to a single client or broadcast to all connected clients.</span></span> <span data-ttu-id="2a241-214">Aggiungere il metodo seguente alla classe **StatisticsService** per trasmettere i dati delle statistiche.</span><span class="sxs-lookup"><span data-stu-id="2a241-214">Add the following method to the **StatisticsService** class to broadcast the statistics data.</span></span>

    <span data-ttu-id="2a241-215">(Frammento di codice- *RealTimeSignalR-EX1-NotifyUpdatesMethod*)</span><span class="sxs-lookup"><span data-stu-id="2a241-215">(Code Snippet - *RealTimeSignalR - Ex1 - NotifyUpdatesMethod*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample6.cs)]

    > [!NOTE]
    > <span data-ttu-id="2a241-216">Nel codice precedente si usa un nome di metodo arbitrario per chiamare una funzione sul client (ad esempio: *UpdateStatistics*).</span><span class="sxs-lookup"><span data-stu-id="2a241-216">In the code above, you are using an arbitrary method name to call a function on the client (i.e.: *updateStatistics*).</span></span> <span data-ttu-id="2a241-217">Il nome del metodo specificato viene interpretato come oggetto dinamico, il che significa che non è presente alcuna convalida di IntelliSense o della fase di compilazione.</span><span class="sxs-lookup"><span data-stu-id="2a241-217">The method name that you specify is interpreted as a dynamic object, which means there is no IntelliSense or compile-time validation for it.</span></span> <span data-ttu-id="2a241-218">L'espressione viene valutata in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="2a241-218">The expression is evaluated at run time.</span></span> <span data-ttu-id="2a241-219">Quando viene eseguita la chiamata al metodo, SignalR invia il nome del metodo e i valori del parametro al client.</span><span class="sxs-lookup"><span data-stu-id="2a241-219">When the method call executes, SignalR sends the method name and the parameter values to the client.</span></span> <span data-ttu-id="2a241-220">Se il client dispone di un metodo che corrisponde al nome, viene chiamato il metodo e vengono passati i valori dei parametri.</span><span class="sxs-lookup"><span data-stu-id="2a241-220">If the client has a method that matches the name, that method is called and the parameter values are passed to it.</span></span> <span data-ttu-id="2a241-221">Se non viene trovato alcun metodo corrispondente nel client, non viene generato alcun errore.</span><span class="sxs-lookup"><span data-stu-id="2a241-221">If no matching method is found on the client, no error is raised.</span></span> <span data-ttu-id="2a241-222">Per altre informazioni, vedere la [Guida dell'API degli hub SignalR di ASP.NET](../guide-to-the-api/hubs-api-guide-server.md).</span><span class="sxs-lookup"><span data-stu-id="2a241-222">For more information, refer to [ASP.NET SignalR Hubs API Guide](../guide-to-the-api/hubs-api-guide-server.md).</span></span>
11. <span data-ttu-id="2a241-223">Aprire la pagina **TriviaController.cs** all'interno della cartella **Controllers** e aggiungere le seguenti direttive using.</span><span class="sxs-lookup"><span data-stu-id="2a241-223">Open the **TriviaController.cs** page inside the **Controllers** folder and add the following using directives.</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample7.cs)]
12. <span data-ttu-id="2a241-224">Aggiungere il codice evidenziato seguente al metodo **post** -azione.</span><span class="sxs-lookup"><span data-stu-id="2a241-224">Add the following highlighted code to the **Post** action method.</span></span>

    <span data-ttu-id="2a241-225">(Frammento di codice- *RealTimeSignalR-EX1-NotifyUpdatesCall*)</span><span class="sxs-lookup"><span data-stu-id="2a241-225">(Code Snippet - *RealTimeSignalR - Ex1 - NotifyUpdatesCall*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample8.cs)]
13. <span data-ttu-id="2a241-226">Aprire la pagina **Statistics. cshtml** all'interno delle **visualizzazioni | Home** directory.</span><span class="sxs-lookup"><span data-stu-id="2a241-226">Open the **Statistics.cshtml** page inside the **Views | Home** folder.</span></span> <span data-ttu-id="2a241-227">Individuare la sezione **Scripts** e aggiungere i riferimenti allo script seguenti all'inizio della sezione.</span><span class="sxs-lookup"><span data-stu-id="2a241-227">Locate the **Scripts** section and add the following script references at the beginning of the section.</span></span>

    <span data-ttu-id="2a241-228">(Frammento di codice- *RealTimeSignalR-EX1-SignalRScriptReferences*)</span><span class="sxs-lookup"><span data-stu-id="2a241-228">(Code Snippet - *RealTimeSignalR - Ex1 - SignalRScriptReferences*)</span></span>

    [!code-cshtml[Main](real-time-web-applications-with-signalr/samples/sample9.cshtml)]

    > [!NOTE]
    > <span data-ttu-id="2a241-229">Quando si aggiungono SignalR e altre librerie di script al progetto di Visual Studio, gestione pacchetti potrebbe installare una versione del file di script SignalR più recente della versione indicata in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="2a241-229">When you add SignalR and other script libraries to your Visual Studio project, the Package Manager might install a version of the SignalR script file that is more recent than the version shown in this topic.</span></span> <span data-ttu-id="2a241-230">Verificare che il riferimento allo script nel codice corrisponda alla versione della libreria di script installata nel progetto.</span><span class="sxs-lookup"><span data-stu-id="2a241-230">Make sure that the script reference in your code matches the version of the script library installed in your project.</span></span>
14. <span data-ttu-id="2a241-231">Aggiungere il codice evidenziato seguente per connettere il client all'hub SignalR e aggiornare i dati delle statistiche quando viene ricevuto un nuovo messaggio dall'hub.</span><span class="sxs-lookup"><span data-stu-id="2a241-231">Add the following highlighted code to connect the client to the SignalR hub and update the statistics data when a new message is received from the hub.</span></span>

    <span data-ttu-id="2a241-232">(Frammento di codice- *RealTimeSignalR-EX1-SignalRClientCode*)</span><span class="sxs-lookup"><span data-stu-id="2a241-232">(Code Snippet - *RealTimeSignalR - Ex1 - SignalRClientCode*)</span></span>

    [!code-cshtml[Main](real-time-web-applications-with-signalr/samples/sample10.cshtml)]

    <span data-ttu-id="2a241-233">In questo codice si crea un proxy Hub e si registra un gestore eventi per ascoltare i messaggi inviati dal server.</span><span class="sxs-lookup"><span data-stu-id="2a241-233">In this code, you are creating a Hub Proxy and registering an event handler to listen for messages sent by the server.</span></span> <span data-ttu-id="2a241-234">In questo caso, si è in ascolto dei messaggi inviati tramite il metodo *UpdateStatistics* .</span><span class="sxs-lookup"><span data-stu-id="2a241-234">In this case, you listen for messages sent through the *updateStatistics* method.</span></span>

<a id="Ex1Task3"></a>
#### <a name="task-3--running-the-solution"></a><span data-ttu-id="2a241-235">Attività 3: esecuzione della soluzione</span><span class="sxs-lookup"><span data-stu-id="2a241-235">Task 3 – Running the Solution</span></span>

<span data-ttu-id="2a241-236">In questa attività verrà eseguita la soluzione per verificare che la visualizzazione Statistiche venga aggiornata automaticamente usando SignalR dopo aver risposto a una nuova domanda.</span><span class="sxs-lookup"><span data-stu-id="2a241-236">In this task, you will run the solution to verify that the statistics view is updated automatically using SignalR after answering a new question.</span></span>

1. <span data-ttu-id="2a241-237">Premere **F5** per eseguire la soluzione.</span><span class="sxs-lookup"><span data-stu-id="2a241-237">Press **F5** to run the solution.</span></span>

    > [!NOTE]
    > <span data-ttu-id="2a241-238">Se non è già stato effettuato l'accesso all'applicazione, effettuare l'accesso con l'utente creato nell'attività 1.</span><span class="sxs-lookup"><span data-stu-id="2a241-238">If not already logged in to the application, log in with the user you created in Task 1.</span></span>
2. <span data-ttu-id="2a241-239">Aprire la pagina delle **statistiche** in una nuova finestra e inserire la pagina **iniziale** e le **statistiche** affiancate come nell'attività 1.</span><span class="sxs-lookup"><span data-stu-id="2a241-239">Open the **Statistics** page in a new window and put the **Home** page and **Statistics** page side-by-side as you did in Task 1.</span></span>
3. <span data-ttu-id="2a241-240">Nella **Home** page, fare clic su una delle opzioni per rispondere alla domanda.</span><span class="sxs-lookup"><span data-stu-id="2a241-240">In the **Home** page, answer the question by clicking one of the options.</span></span>

    <span data-ttu-id="2a241-241">![Risposta a un'altra domanda](real-time-web-applications-with-signalr/_static/image13.png "Risposta a un'altra domanda")</span><span class="sxs-lookup"><span data-stu-id="2a241-241">![Answering another question](real-time-web-applications-with-signalr/_static/image13.png "Answering another question")</span></span>

    <span data-ttu-id="2a241-242">*Risposta a un'altra domanda*</span><span class="sxs-lookup"><span data-stu-id="2a241-242">*Answering another question*</span></span>
4. <span data-ttu-id="2a241-243">Dopo aver fatto clic su uno dei pulsanti, viene visualizzata la risposta.</span><span class="sxs-lookup"><span data-stu-id="2a241-243">After clicking one of the buttons, the answer should appear.</span></span> <span data-ttu-id="2a241-244">Si noti che le informazioni statistiche sulla pagina vengono aggiornate automaticamente dopo aver risposto alla domanda con le informazioni aggiornate senza dover aggiornare l'intera pagina.</span><span class="sxs-lookup"><span data-stu-id="2a241-244">Notice that the Statistics information on the page is updated automatically after answering the question with the updated information without the need to refresh the entire page.</span></span>

    <span data-ttu-id="2a241-245">![Pagina statistiche aggiornata dopo la risposta](real-time-web-applications-with-signalr/_static/image14.png "Pagina statistiche aggiornata dopo la risposta")</span><span class="sxs-lookup"><span data-stu-id="2a241-245">![Statistics page refreshed after answer](real-time-web-applications-with-signalr/_static/image14.png "Statistics page refreshed after answer")</span></span>

    <span data-ttu-id="2a241-246">*Pagina statistiche aggiornata dopo la risposta*</span><span class="sxs-lookup"><span data-stu-id="2a241-246">*Statistics page refreshed after answer*</span></span>

<a id="Exercise2"></a>
### <a name="exercise-2-scaling-out-using-sql-server"></a><span data-ttu-id="2a241-247">Esercizio 2: scalabilità orizzontale con SQL Server</span><span class="sxs-lookup"><span data-stu-id="2a241-247">Exercise 2: Scaling Out Using SQL Server</span></span>

<span data-ttu-id="2a241-248">Quando si ridimensiona un'applicazione Web, è in genere possibile scegliere tra le opzioni di *scalabilità verticale* e *orizzontale* .</span><span class="sxs-lookup"><span data-stu-id="2a241-248">When scaling a web application, you can generally choose between *scaling up* and *scaling out* options.</span></span> <span data-ttu-id="2a241-249">La *scalabilità verticale* indica l'uso di un server di dimensioni maggiori, con più risorse (CPU, RAM e così via), mentre la *scalabilità orizzontale* significa aggiungere altri server per gestire il carico.</span><span class="sxs-lookup"><span data-stu-id="2a241-249">*Scale up* means using a larger server, with more resources (CPU, RAM, etc.) while *scale out* means adding more servers to handle the load.</span></span> <span data-ttu-id="2a241-250">Il problema con quest'ultimo è che i client possono essere indirizzati a server diversi.</span><span class="sxs-lookup"><span data-stu-id="2a241-250">The problem with the latter is that the clients can get routed to different servers.</span></span> <span data-ttu-id="2a241-251">Un client connesso a un server non riceverà i messaggi inviati da un altro server.</span><span class="sxs-lookup"><span data-stu-id="2a241-251">A client that is connected to one server will not receive messages sent from another server.</span></span>

<span data-ttu-id="2a241-252">È possibile risolvere questi problemi utilizzando un componente denominato *backplane*, per l'invio di messaggi tra server.</span><span class="sxs-lookup"><span data-stu-id="2a241-252">You can solve these issues by using a component called *backplane*, to forward messages between servers.</span></span> <span data-ttu-id="2a241-253">Con un backplane abilitato, ogni istanza dell'applicazione invia messaggi al backplane e il backplane li inoltra alle altre istanze dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="2a241-253">With a backplane enabled, each application instance sends messages to the backplane, and the backplane forwards them to the other application instances.</span></span>

<span data-ttu-id="2a241-254">Esistono attualmente tre tipi di BACKPLAN per SignalR:</span><span class="sxs-lookup"><span data-stu-id="2a241-254">There are currently three types of backplanes for SignalR:</span></span>

- <span data-ttu-id="2a241-255">**Bus di servizio di Microsoft Azure**.</span><span class="sxs-lookup"><span data-stu-id="2a241-255">**Windows Azure Service Bus**.</span></span> <span data-ttu-id="2a241-256">Il bus di servizio è un'infrastruttura di messaggistica che consente ai componenti di inviare messaggi a regime di controllo libero.</span><span class="sxs-lookup"><span data-stu-id="2a241-256">Service Bus is a messaging infrastructure that allows components to send loosely coupled messages.</span></span>
- <span data-ttu-id="2a241-257">**SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="2a241-257">**SQL Server**.</span></span> <span data-ttu-id="2a241-258">Il backplane SQL Server scrive i messaggi nelle tabelle SQL.</span><span class="sxs-lookup"><span data-stu-id="2a241-258">The SQL Server backplane writes messages to SQL tables.</span></span> <span data-ttu-id="2a241-259">Il backplane USA Service Broker per la messaggistica efficiente.</span><span class="sxs-lookup"><span data-stu-id="2a241-259">The backplane uses Service Broker for efficient messaging.</span></span> <span data-ttu-id="2a241-260">Tuttavia, funziona anche se Service Broker non è abilitato.</span><span class="sxs-lookup"><span data-stu-id="2a241-260">However, it also works if Service Broker is not enabled.</span></span>
- <span data-ttu-id="2a241-261">**Redis**.</span><span class="sxs-lookup"><span data-stu-id="2a241-261">**Redis**.</span></span> <span data-ttu-id="2a241-262">Redis è un archivio chiave-valore in memoria.</span><span class="sxs-lookup"><span data-stu-id="2a241-262">Redis is an in-memory key-value store.</span></span> <span data-ttu-id="2a241-263">Redis supporta un modello di pubblicazione/sottoscrizione ("pub/sub") per l'invio di messaggi.</span><span class="sxs-lookup"><span data-stu-id="2a241-263">Redis supports a publish/subscribe ("pub/sub") pattern for sending messages.</span></span>

<span data-ttu-id="2a241-264">Ogni messaggio viene inviato tramite un bus di messaggi.</span><span class="sxs-lookup"><span data-stu-id="2a241-264">Every message is sent through a message bus.</span></span> <span data-ttu-id="2a241-265">Un bus di messaggi implementa l'interfaccia [IMessageBus](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.messaging.imessagebus(v=vs.100).aspx) , che fornisce un'astrazione di pubblicazione/sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="2a241-265">A message bus implements the [IMessageBus](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.messaging.imessagebus(v=vs.100).aspx) interface, which provides a publish/subscribe abstraction.</span></span> <span data-ttu-id="2a241-266">Il backplans funziona sostituendo il **IMessageBus** predefinito con un bus progettato per tale backplane.</span><span class="sxs-lookup"><span data-stu-id="2a241-266">The backplanes work by replacing the default **IMessageBus** with a bus designed for that backplane.</span></span>

<span data-ttu-id="2a241-267">Ogni istanza del server si connette al backplane tramite il bus.</span><span class="sxs-lookup"><span data-stu-id="2a241-267">Each server instance connects to the backplane through the bus.</span></span> <span data-ttu-id="2a241-268">Quando un messaggio viene inviato, passa al backplane e il backplane lo invia a ogni server.</span><span class="sxs-lookup"><span data-stu-id="2a241-268">When a message is sent, it goes to the backplane, and the backplane sends it to every server.</span></span> <span data-ttu-id="2a241-269">Quando un server riceve un messaggio dal backplane, archivia il messaggio nella cache locale.</span><span class="sxs-lookup"><span data-stu-id="2a241-269">When a server receives a message from the backplane, it stores the message in its local cache.</span></span> <span data-ttu-id="2a241-270">Il server recapita quindi i messaggi ai client dalla cache locale.</span><span class="sxs-lookup"><span data-stu-id="2a241-270">The server then delivers messages to clients from its local cache.</span></span>

<span data-ttu-id="2a241-271">Per ulteriori informazioni sul funzionamento del backplane SignalR, leggere questo [articolo](../performance/scaleout-in-signalr.md).</span><span class="sxs-lookup"><span data-stu-id="2a241-271">For more information about how the SignalR backplane works, read this [article](../performance/scaleout-in-signalr.md).</span></span>

> [!NOTE]
> <span data-ttu-id="2a241-272">Esistono scenari in cui un backplane può diventare un collo di bottiglia.</span><span class="sxs-lookup"><span data-stu-id="2a241-272">There are some scenarios where a backplane can become a bottleneck.</span></span> <span data-ttu-id="2a241-273">Ecco alcuni scenari tipici di SignalR:</span><span class="sxs-lookup"><span data-stu-id="2a241-273">Here are some typical SignalR scenarios:</span></span>
> 
> - <span data-ttu-id="2a241-274">[Broadcast del server](tutorial-server-broadcast-with-signalr.md) (ad esempio, Stock): i BACKPLAN sono adatti a questo scenario, perché il server controlla la velocità con cui vengono inviati i messaggi.</span><span class="sxs-lookup"><span data-stu-id="2a241-274">[Server broadcast](tutorial-server-broadcast-with-signalr.md) (e.g., stock ticker): Backplanes work well for this scenario, because the server controls the rate at which messages are sent.</span></span>
> - <span data-ttu-id="2a241-275">[Da client a client](tutorial-getting-started-with-signalr.md) (ad esempio, chat): in questo scenario, il backplane può costituire un collo di bottiglia se il numero di messaggi viene ridimensionato con il numero di client; ovvero, se la frequenza dei messaggi aumenta proporzionalmente Man mano che si aggiungono altri client.</span><span class="sxs-lookup"><span data-stu-id="2a241-275">[Client-to-client](tutorial-getting-started-with-signalr.md) (e.g., chat): In this scenario, the backplane might be a bottleneck if the number of messages scales with the number of clients; that is, if the rate of messages grows proportionally as more clients join.</span></span>
> - <span data-ttu-id="2a241-276">[Tempo reale ad alta frequenza](tutorial-high-frequency-realtime-with-signalr.md) (ad esempio, giochi in tempo reale): un backplane non è consigliato per questo scenario.</span><span class="sxs-lookup"><span data-stu-id="2a241-276">[High-frequency realtime](tutorial-high-frequency-realtime-with-signalr.md) (e.g., real-time games): A backplane is not recommended for this scenario.</span></span>

<span data-ttu-id="2a241-277">In questo esercizio si userà **SQL Server** per distribuire i messaggi nell'applicazione di **quiz per geek** .</span><span class="sxs-lookup"><span data-stu-id="2a241-277">In this exercise, you will use **SQL Server** to distribute messages across the **Geek Quiz** application.</span></span> <span data-ttu-id="2a241-278">Queste attività vengono eseguite in un singolo computer di test per apprendere come configurare la configurazione, ma per ottenere l'effetto completo sarà necessario distribuire l'applicazione SignalR a due o più server.</span><span class="sxs-lookup"><span data-stu-id="2a241-278">You will run these tasks on a single test machine to learn how to set up the configuration, but in order to get the full effect, you will need to deploy the SignalR application to two or more servers.</span></span> <span data-ttu-id="2a241-279">È inoltre necessario installare SQL Server su uno dei server o su un server dedicato separato.</span><span class="sxs-lookup"><span data-stu-id="2a241-279">You must also install SQL Server on one of the servers, or on a separate dedicated server.</span></span>

![Scale Out con SQL Server diagramma](real-time-web-applications-with-signalr/_static/image15.png)

<a id="Ex2Task1"></a>
#### <a name="task-1---understanding-the-scenario"></a><span data-ttu-id="2a241-281">Attività 1: informazioni sullo scenario</span><span class="sxs-lookup"><span data-stu-id="2a241-281">Task 1 - Understanding the Scenario</span></span>

<span data-ttu-id="2a241-282">In questa attività verranno eseguite 2 istanze di **quiz geek** simulando più istanze di IIS nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="2a241-282">In this task, you will run 2 instances of **Geek Quiz** simulating multiple IIS instances on your local machine.</span></span> <span data-ttu-id="2a241-283">In questo scenario, quando si rispondono a domande semplici su un'applicazione, l'aggiornamento non verrà notificato nella pagina statistiche della seconda istanza.</span><span class="sxs-lookup"><span data-stu-id="2a241-283">In this scenario, when answering trivia questions on one application, update won't be notified on the statistics page of the second instance.</span></span> <span data-ttu-id="2a241-284">Questa simulazione è simile a un ambiente in cui l'applicazione viene distribuita in più istanze e usando un servizio di bilanciamento del carico per comunicare con loro.</span><span class="sxs-lookup"><span data-stu-id="2a241-284">This simulation resembles an environment where your application is deployed on multiple instances and using a load balancer to communicate with them.</span></span>

1. <span data-ttu-id="2a241-285">Aprire la soluzione **Begin. sln** disponibile nella cartella **source/EX2-ScalingOutWithSQLServer/Begin** .</span><span class="sxs-lookup"><span data-stu-id="2a241-285">Open the **Begin.sln** solution located in the **Source/Ex2-ScalingOutWithSQLServer/Begin** folder.</span></span> <span data-ttu-id="2a241-286">Una volta caricato, si noterà che nella **Esplora server** che la soluzione contiene due progetti con strutture identiche ma nomi diversi.</span><span class="sxs-lookup"><span data-stu-id="2a241-286">Once loaded, you will notice on the **Server Explorer** that the solution has two projects with identical structures but different names.</span></span> <span data-ttu-id="2a241-287">Verrà simulata l'esecuzione di due istanze della stessa applicazione nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="2a241-287">This will simulate running two instances of the same application on your local machine.</span></span>

    <span data-ttu-id="2a241-288">![Inizia la simulazione della soluzione 2 istanze di quiz geek](real-time-web-applications-with-signalr/_static/image16.png "Inizia la simulazione della soluzione 2 istanze di quiz geek")</span><span class="sxs-lookup"><span data-stu-id="2a241-288">![Begin Solution Simulating 2 Instances of Geek Quiz](real-time-web-applications-with-signalr/_static/image16.png "Begin Solution Simulating 2 Instances of Geek Quiz")</span></span>

    <span data-ttu-id="2a241-289">*Inizia la simulazione della soluzione 2 istanze di quiz geek*</span><span class="sxs-lookup"><span data-stu-id="2a241-289">*Begin Solution Simulating 2 Instances of Geek Quiz*</span></span>
2. <span data-ttu-id="2a241-290">Per aprire la pagina delle proprietà della soluzione, fare clic con il pulsante destro del mouse sul nodo della soluzione e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="2a241-290">Open the properties page of the solution by right-clicking the solution node and selecting **Properties**.</span></span> <span data-ttu-id="2a241-291">In **progetto di avvio**selezionare **progetti di avvio multipli** e modificare il valore dell' **azione** per entrambi i progetti su *Avvia*.</span><span class="sxs-lookup"><span data-stu-id="2a241-291">Under **Startup Project**, select **Multiple startup projects** and change the **Action** value for both projects to *Start*.</span></span>

    <span data-ttu-id="2a241-292">![Avvio di più progetti](real-time-web-applications-with-signalr/_static/image17.png "Avvio di più progetti")</span><span class="sxs-lookup"><span data-stu-id="2a241-292">![Starting Multiple Projects](real-time-web-applications-with-signalr/_static/image17.png "Starting Multiple Projects")</span></span>

    <span data-ttu-id="2a241-293">*Avvio di più progetti*</span><span class="sxs-lookup"><span data-stu-id="2a241-293">*Starting Multiple Projects*</span></span>
3. <span data-ttu-id="2a241-294">Premere **F5** per eseguire la soluzione.</span><span class="sxs-lookup"><span data-stu-id="2a241-294">Press **F5** to run the solution.</span></span> <span data-ttu-id="2a241-295">L'applicazione avvierà due istanze di **quiz geek** in porte diverse, simulando più istanze della stessa applicazione.</span><span class="sxs-lookup"><span data-stu-id="2a241-295">The application will launch two instances of **Geek Quiz** in different ports, simulating multiple instances of the same application.</span></span> <span data-ttu-id="2a241-296">Aggiungere uno dei browser a sinistra e l'altro a destra dello schermo.</span><span class="sxs-lookup"><span data-stu-id="2a241-296">Pin one of the browsers on left and the other on the right of your screen.</span></span> <span data-ttu-id="2a241-297">Accedere con le proprie credenziali o registrare un nuovo utente.</span><span class="sxs-lookup"><span data-stu-id="2a241-297">Log in with your credentials or register a new user.</span></span> <span data-ttu-id="2a241-298">Una volta effettuato l'accesso, Mantieni la pagina di Trivia a sinistra e vai alla pagina delle **statistiche** nel browser a destra.</span><span class="sxs-lookup"><span data-stu-id="2a241-298">Once logged in, keep the Trivia page on the left and go to the **Statistics** page in the browser on the right.</span></span>

    ![Quiz geek side-by-side](real-time-web-applications-with-signalr/_static/image18.png)

    <span data-ttu-id="2a241-300">*Quiz geek side-by-side*</span><span class="sxs-lookup"><span data-stu-id="2a241-300">*Geek Quiz Side by Side*</span></span>

    ![Quiz per geek in porte diverse](real-time-web-applications-with-signalr/_static/image19.png)

    <span data-ttu-id="2a241-302">*Quiz per geek in porte diverse*</span><span class="sxs-lookup"><span data-stu-id="2a241-302">*Geek Quiz in Different Ports*</span></span>
4. <span data-ttu-id="2a241-303">Iniziare a rispondere alle domande nel browser a sinistra. si noterà che la pagina **statistiche** nel browser a destra non è in fase di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="2a241-303">Start answering questions in the left browser and you will notice that the **Statistics** page in the right browser is not being updated.</span></span> <span data-ttu-id="2a241-304">Questo perché **SignalR** usa una cache locale per distribuire i messaggi tra i client e questo scenario simula più istanze, quindi la cache non viene condivisa tra di essi.</span><span class="sxs-lookup"><span data-stu-id="2a241-304">This is because **SignalR** uses a local cache to distribute messages across their clients and this scenario is simulating multiple instances, therefore the cache is not shared between them.</span></span> <span data-ttu-id="2a241-305">È possibile verificare che **SignalR** funzioni verificando gli stessi passaggi, ma usando una singola app.</span><span class="sxs-lookup"><span data-stu-id="2a241-305">You can verify that **SignalR** is working by testing the same steps but using a single app.</span></span> <span data-ttu-id="2a241-306">Nelle attività seguenti viene configurato un backplane per replicare i messaggi tra le istanze.</span><span class="sxs-lookup"><span data-stu-id="2a241-306">In the following tasks you will configure a backplane to replicate the messages across instances.</span></span>
5. <span data-ttu-id="2a241-307">Tornare a Visual Studio e arrestare il debug.</span><span class="sxs-lookup"><span data-stu-id="2a241-307">Go back to Visual Studio and stop debugging.</span></span>

<a id="Ex2Task2"></a>
#### <a name="task-2--creating-the-sql-server-backplane"></a><span data-ttu-id="2a241-308">Attività 2: creazione del backplane SQL Server</span><span class="sxs-lookup"><span data-stu-id="2a241-308">Task 2 – Creating the SQL Server Backplane</span></span>

<span data-ttu-id="2a241-309">In questa attività verrà creato un database che fungerà da backplane per l'applicazione di **quiz per geek** .</span><span class="sxs-lookup"><span data-stu-id="2a241-309">In this task, you will create a database that will serve as a backplane for the **Geek Quiz** application.</span></span> <span data-ttu-id="2a241-310">Si utilizzerà **Esplora oggetti di SQL Server** per esplorare il server e inizializzare il database.</span><span class="sxs-lookup"><span data-stu-id="2a241-310">You will use **SQL Server Object Explorer** to browse your server and initialize the database.</span></span> <span data-ttu-id="2a241-311">Inoltre, sarà possibile abilitare il **Service Broker**.</span><span class="sxs-lookup"><span data-stu-id="2a241-311">Additionally, you will enable the **Service Broker**.</span></span>

1. <span data-ttu-id="2a241-312">In **Visual Studio**aprire la **visualizzazione** menu e selezionare **Esplora oggetti di SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="2a241-312">In **Visual Studio**, open menu **View** and select **SQL Server Object Explorer**.</span></span>
2. <span data-ttu-id="2a241-313">Connettersi all'istanza del database locale facendo clic con il pulsante destro del mouse sul nodo **SQL Server** e selezionando l'opzione **Aggiungi SQL Server...** .</span><span class="sxs-lookup"><span data-stu-id="2a241-313">Connect to your LocalDB instance by right-clicking the **SQL Server** node and selecting **Add SQL Server...** option.</span></span>

    <span data-ttu-id="2a241-314">![Aggiunta di un'istanza di SQL Server](real-time-web-applications-with-signalr/_static/image20.png "Aggiunta di un'istanza di SQL Server")</span><span class="sxs-lookup"><span data-stu-id="2a241-314">![Adding a SQL Server Instance](real-time-web-applications-with-signalr/_static/image20.png "Adding a SQL Server Instance")</span></span>

    <span data-ttu-id="2a241-315">*Aggiunta di un'istanza di SQL Server a Esplora oggetti di SQL Server*</span><span class="sxs-lookup"><span data-stu-id="2a241-315">*Adding a SQL Server instance to SQL Server Object Explorer*</span></span>
3. <span data-ttu-id="2a241-316">Impostare il **nome del server** su (local DB *) \V11.0* e lasciare **l'autenticazione di Windows** come modalità di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="2a241-316">Set the **server name** to *(localdb)\v11.0* and leave **Windows Authentication** as your authentication mode.</span></span> <span data-ttu-id="2a241-317">Fare clic su **Connetti** per continuare.</span><span class="sxs-lookup"><span data-stu-id="2a241-317">Click **Connect** to continue.</span></span>

    <span data-ttu-id="2a241-318">![Connessione al database locale](real-time-web-applications-with-signalr/_static/image21.png "Connessione al database locale")</span><span class="sxs-lookup"><span data-stu-id="2a241-318">![Connecting to LocalDB](real-time-web-applications-with-signalr/_static/image21.png "Connecting to LocalDB")</span></span>

    <span data-ttu-id="2a241-319">*Connessione al database locale*</span><span class="sxs-lookup"><span data-stu-id="2a241-319">*Connecting to LocalDB*</span></span>
4. <span data-ttu-id="2a241-320">Ora che si è connessi all'istanza del database locale, è necessario creare un database che rappresenterà il backplane SQL Server per SignalR.</span><span class="sxs-lookup"><span data-stu-id="2a241-320">Now that you are connected to your LocalDB instance, you will need to create a database that will represent the SQL Server backplane for SignalR.</span></span> <span data-ttu-id="2a241-321">A tale scopo, fare clic con il pulsante destro del mouse sul nodo **database** e scegliere **Aggiungi nuovo database**.</span><span class="sxs-lookup"><span data-stu-id="2a241-321">To do this, right-click the **Databases** node and select **Add New Database**.</span></span>

    <span data-ttu-id="2a241-322">![Aggiunta di un nuovo database](real-time-web-applications-with-signalr/_static/image22.png "Aggiunta di un nuovo database")</span><span class="sxs-lookup"><span data-stu-id="2a241-322">![Adding a new database](real-time-web-applications-with-signalr/_static/image22.png "Adding a new database")</span></span>

    <span data-ttu-id="2a241-323">*Aggiunta di un nuovo database*</span><span class="sxs-lookup"><span data-stu-id="2a241-323">*Adding a new database*</span></span>
5. <span data-ttu-id="2a241-324">Impostare il nome del database su *SignalR* e fare clic su **OK** per crearlo.</span><span class="sxs-lookup"><span data-stu-id="2a241-324">Set the database name to *SignalR* and click **OK** to create it.</span></span>

    <span data-ttu-id="2a241-325">![Creazione del database SignalR](real-time-web-applications-with-signalr/_static/image23.png "Creazione del database SignalR")</span><span class="sxs-lookup"><span data-stu-id="2a241-325">![Creating the SignalR database](real-time-web-applications-with-signalr/_static/image23.png "Creating the SignalR database")</span></span>

    <span data-ttu-id="2a241-326">*Creazione del database SignalR*</span><span class="sxs-lookup"><span data-stu-id="2a241-326">*Creating the SignalR database*</span></span>

    > [!NOTE]
    > <span data-ttu-id="2a241-327">È possibile scegliere qualsiasi nome per il database.</span><span class="sxs-lookup"><span data-stu-id="2a241-327">You can choose any name for the database.</span></span>
6. <span data-ttu-id="2a241-328">Per ricevere gli aggiornamenti in modo più efficiente dal backplane, è consigliabile abilitare Service Broker per il database.</span><span class="sxs-lookup"><span data-stu-id="2a241-328">To receive updates more efficiently from the backplane, it is recommended to enable Service Broker for the database.</span></span> <span data-ttu-id="2a241-329">Service Broker fornisce il supporto nativo per la messaggistica e l'accodamento in SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2a241-329">Service Broker provides native support for messaging and queuing in SQL Server.</span></span> <span data-ttu-id="2a241-330">Il backplane funziona anche senza Service Broker.</span><span class="sxs-lookup"><span data-stu-id="2a241-330">The backplane also works without Service Broker.</span></span> <span data-ttu-id="2a241-331">Per aprire una nuova query, fare clic con il pulsante destro del mouse sul database e scegliere **nuova query**.</span><span class="sxs-lookup"><span data-stu-id="2a241-331">Open a new query by right-clicking the database and select **New Query**.</span></span>

    <span data-ttu-id="2a241-332">![Apertura di una nuova query](real-time-web-applications-with-signalr/_static/image24.png "Apertura di una nuova query")</span><span class="sxs-lookup"><span data-stu-id="2a241-332">![Opening a New Query](real-time-web-applications-with-signalr/_static/image24.png "Opening a New Query")</span></span>

    <span data-ttu-id="2a241-333">*Apertura di una nuova query*</span><span class="sxs-lookup"><span data-stu-id="2a241-333">*Opening a New Query*</span></span>
7. <span data-ttu-id="2a241-334">Per verificare se la Service Broker è abilitata, eseguire una query sulla colonna **\_Broker\_abilitato** nella vista del catalogo **sys. databases** .</span><span class="sxs-lookup"><span data-stu-id="2a241-334">To check whether Service Broker is enabled, query the **is\_broker\_enabled** column in the **sys.databases** catalog view.</span></span> <span data-ttu-id="2a241-335">Eseguire lo script seguente nella finestra di query aperta di recente.</span><span class="sxs-lookup"><span data-stu-id="2a241-335">Execute the following script in the recently opened query window.</span></span>

    [!code-sql[Main](real-time-web-applications-with-signalr/samples/sample11.sql)]

    <span data-ttu-id="2a241-336">![Esecuzione di query sullo stato di Service Broker](real-time-web-applications-with-signalr/_static/image25.png "Esecuzione di query sullo stato di Service Broker")</span><span class="sxs-lookup"><span data-stu-id="2a241-336">![Querying the Service Broker Status](real-time-web-applications-with-signalr/_static/image25.png "Querying the Service Broker Status")</span></span>

    <span data-ttu-id="2a241-337">*Esecuzione di query sullo stato di Service Broker*</span><span class="sxs-lookup"><span data-stu-id="2a241-337">*Querying the Service Broker Status*</span></span>
8. <span data-ttu-id="2a241-338">Se il valore della colonna **\_broker\_abilitato** nel database è &quot;0&quot;, utilizzare il comando seguente per abilitarlo.</span><span class="sxs-lookup"><span data-stu-id="2a241-338">If the value of the **is\_broker\_enabled** column in your database is &quot;0&quot;, use the following command to enable it.</span></span> <span data-ttu-id="2a241-339">Sostituire **&lt;&gt;del database** con il nome impostato durante la creazione del database (ad esempio, SignalR).</span><span class="sxs-lookup"><span data-stu-id="2a241-339">Replace **&lt;YOUR-DATABASE&gt;** with the name you set when creating the database (e.g.: SignalR).</span></span>

    [!code-sql[Main](real-time-web-applications-with-signalr/samples/sample12.sql)]

    <span data-ttu-id="2a241-340">![Abilitazione di Service Broker](real-time-web-applications-with-signalr/_static/image26.png "Abilitazione di Service Broker")</span><span class="sxs-lookup"><span data-stu-id="2a241-340">![Enabling Service Broker](real-time-web-applications-with-signalr/_static/image26.png "Enabling Service Broker")</span></span>

    <span data-ttu-id="2a241-341">*Abilitazione di Service Broker*</span><span class="sxs-lookup"><span data-stu-id="2a241-341">*Enabling Service Broker*</span></span>

    > [!NOTE]
    > <span data-ttu-id="2a241-342">Se questa query viene visualizzata come deadlock, assicurarsi che non vi siano applicazioni connesse al database.</span><span class="sxs-lookup"><span data-stu-id="2a241-342">If this query appears to deadlock, make sure there are no applications connected to the DB.</span></span>

<a id="Ex2Task3"></a>
#### <a name="task-3--configuring-the-signalr-application"></a><span data-ttu-id="2a241-343">Attività 3: configurazione dell'applicazione SignalR</span><span class="sxs-lookup"><span data-stu-id="2a241-343">Task 3 – Configuring the SignalR Application</span></span>

<span data-ttu-id="2a241-344">In questa attività verrà configurato il **quiz geek** per la connessione al backplane SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2a241-344">In this task, you will configure **Geek Quiz** to connect to the SQL Server backplane.</span></span> <span data-ttu-id="2a241-345">Viene innanzitutto aggiunto il pacchetto NuGet **SignalR. SqlServer** e la stringa di connessione viene impostata sul database backplane.</span><span class="sxs-lookup"><span data-stu-id="2a241-345">You will first add the **SignalR.SqlServer** NuGet package and set the connection string to your backplane database.</span></span>

1. <span data-ttu-id="2a241-346">Aprire la **console di gestione pacchetti** da **strumenti** > **Gestione pacchetti NuGet**.</span><span class="sxs-lookup"><span data-stu-id="2a241-346">Open the **Package Manager Console** from **Tools** > **NuGet Package Manager**.</span></span> <span data-ttu-id="2a241-347">Verificare che il progetto **GeekQuiz** sia selezionato nell'elenco a discesa **progetto predefinito** .</span><span class="sxs-lookup"><span data-stu-id="2a241-347">Make sure that **GeekQuiz** project is selected in the **Default project** drop-down list.</span></span> <span data-ttu-id="2a241-348">Digitare il comando seguente per installare il pacchetto NuGet **Microsoft. AspNet. SignalR. SqlServer** .</span><span class="sxs-lookup"><span data-stu-id="2a241-348">Type the following command to install the **Microsoft.AspNet.SignalR.SqlServer** NuGet package.</span></span>

    [!code-powershell[Main](real-time-web-applications-with-signalr/samples/sample13.ps1)]
2. <span data-ttu-id="2a241-349">Ripetere il passaggio precedente, ma questa volta per il progetto **GeekQuiz2**.</span><span class="sxs-lookup"><span data-stu-id="2a241-349">Repeat the previous step but this time for project **GeekQuiz2**.</span></span>
3. <span data-ttu-id="2a241-350">Per configurare il backplane di SQL Server, aprire il file **Startup.cs** del progetto **GeekQuiz** e aggiungere il codice seguente al metodo **Configure** .</span><span class="sxs-lookup"><span data-stu-id="2a241-350">To configure the SQL Server backplane, open the **Startup.cs** file of the **GeekQuiz** project and add the following code to the **Configure** method.</span></span> <span data-ttu-id="2a241-351">Sostituire **&lt;&gt;del database** con il nome del database usato durante la creazione del backplane SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2a241-351">Replace **&lt;YOUR-DATABASE&gt;** with your database name you used when creating the SQL Server backplane.</span></span> <span data-ttu-id="2a241-352">Ripetere questo passaggio per il progetto **GeekQuiz2** .</span><span class="sxs-lookup"><span data-stu-id="2a241-352">Repeat this step for the **GeekQuiz2** project.</span></span>

    <span data-ttu-id="2a241-353">(Frammento di codice- *RealTimeSignalR-EX2-StartupConfiguration*)</span><span class="sxs-lookup"><span data-stu-id="2a241-353">(Code Snippet - *RealTimeSignalR - Ex2 - StartupConfiguration*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample14.cs)]
4. <span data-ttu-id="2a241-354">Ora che entrambi i progetti sono configurati per l'uso del backplane SQL Server, premere **F5** per eseguirli simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="2a241-354">Now that both projects are configured to use the SQL Server backplane, press **F5** to run them simultaneously.</span></span>
5. <span data-ttu-id="2a241-355">Anche in questo caso, **Visual Studio** avvierà due istanze di **quiz geek** in porte diverse.</span><span class="sxs-lookup"><span data-stu-id="2a241-355">Again, **Visual Studio** will launch two instances of **Geek Quiz** in different ports.</span></span> <span data-ttu-id="2a241-356">Aggiungere uno dei browser a sinistra e l'altro a destra dello schermo e accedere con le proprie credenziali.</span><span class="sxs-lookup"><span data-stu-id="2a241-356">Pin one of the browsers on the left and the other on the right of your screen and log in with your credentials.</span></span> <span data-ttu-id="2a241-357">Mantieni la pagina dei Trivia a sinistra e vai alla pagina delle **statistiche** nel browser a destra.</span><span class="sxs-lookup"><span data-stu-id="2a241-357">Keep the Trivia page on the left and go to **Statistics** pagein the right browser.</span></span>
6. <span data-ttu-id="2a241-358">Iniziare a rispondere alle domande nel browser a sinistra.</span><span class="sxs-lookup"><span data-stu-id="2a241-358">Start answering questions in the left browser.</span></span> <span data-ttu-id="2a241-359">Questa volta, la pagina delle **statistiche** viene aggiornata grazie al backplane.</span><span class="sxs-lookup"><span data-stu-id="2a241-359">This time, the **Statistics** page is updated thanks to the backplane.</span></span> <span data-ttu-id="2a241-360">Passare da un'applicazione all'altra (le**statistiche** sono ora a sinistra e la **curiosità** è a destra) e ripetere il test per verificare che funzioni per entrambe le istanze.</span><span class="sxs-lookup"><span data-stu-id="2a241-360">Switch between applications (**Statistics** is now on the left, and **Trivia** is on the right) and repeat the test to validate that it is working for both instances.</span></span> <span data-ttu-id="2a241-361">Il backplane funge da *cache condivisa* dei messaggi per ogni server connesso e ogni server archivia i messaggi nella propria cache locale per la distribuzione ai client connessi.</span><span class="sxs-lookup"><span data-stu-id="2a241-361">The backplane serves as a *shared cache* of messages for each connected server, and each server will store the messages in their own local cache to distribute to connected clients.</span></span>
7. <span data-ttu-id="2a241-362">Tornare a Visual Studio e arrestare il debug.</span><span class="sxs-lookup"><span data-stu-id="2a241-362">Go back to Visual Studio and stop debugging.</span></span>
8. <span data-ttu-id="2a241-363">Il componente SQL Server backplane genera automaticamente le tabelle necessarie nel database specificato.</span><span class="sxs-lookup"><span data-stu-id="2a241-363">The SQL Server backplane component automatically generates the necessary tables on the specified database.</span></span> <span data-ttu-id="2a241-364">Nel pannello **Esplora oggetti di SQL Server** aprire il database creato per il backplane (ad esempio, SignalR) ed espandere le relative tabelle.</span><span class="sxs-lookup"><span data-stu-id="2a241-364">In the **SQL Server Object Explorer** panel, open the database you created for the backplane (e.g.: SignalR) and expand its tables.</span></span> <span data-ttu-id="2a241-365">Verranno visualizzate le tabelle seguenti:</span><span class="sxs-lookup"><span data-stu-id="2a241-365">You should see the following tables:</span></span>

    ![Tabelle generate backplane](real-time-web-applications-with-signalr/_static/image27.png)

    <span data-ttu-id="2a241-367">*Tabelle generate backplane*</span><span class="sxs-lookup"><span data-stu-id="2a241-367">*Backplane Generated Tables*</span></span>
9. <span data-ttu-id="2a241-368">Fare clic con il pulsante destro del mouse sulla tabella **SignalR. messages\_0** e selezionare **Visualizza dati**.</span><span class="sxs-lookup"><span data-stu-id="2a241-368">Right-click the **SignalR.Messages\_0** table and select **View Data**.</span></span>

    ![Visualizzazione della tabella dei messaggi del backplane SignalR](real-time-web-applications-with-signalr/_static/image28.png)

    <span data-ttu-id="2a241-370">*Visualizzazione della tabella dei messaggi del backplane SignalR*</span><span class="sxs-lookup"><span data-stu-id="2a241-370">*View SignalR Backplane Messages Table*</span></span>
10. <span data-ttu-id="2a241-371">È possibile visualizzare i diversi messaggi inviati all' **Hub** quando si rispondono alle domande di Trivia.</span><span class="sxs-lookup"><span data-stu-id="2a241-371">You can see the different messages sent to the **Hub** when answering the trivia questions.</span></span> <span data-ttu-id="2a241-372">Il backplane distribuisce questi messaggi a qualsiasi istanza connessa.</span><span class="sxs-lookup"><span data-stu-id="2a241-372">The backplane distributes these messages to any connected instance.</span></span>

    ![Tabella messaggi backplane](real-time-web-applications-with-signalr/_static/image29.png)

    <span data-ttu-id="2a241-374">*Tabella messaggi backplane*</span><span class="sxs-lookup"><span data-stu-id="2a241-374">*Backplane Messages Table*</span></span>

---

<a id="Summary"></a>
## <a name="summary"></a><span data-ttu-id="2a241-375">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="2a241-375">Summary</span></span>

<span data-ttu-id="2a241-376">In questo laboratorio pratico si è appreso come aggiungere **SignalR** all'applicazione e inviare notifiche dal server ai client connessi usando gli **Hub**.</span><span class="sxs-lookup"><span data-stu-id="2a241-376">In this hands-on lab, you have learned how to add **SignalR** to your application and send notifications from the server to your connected clients using **Hubs**.</span></span> <span data-ttu-id="2a241-377">Si è inoltre appreso come aumentare la scalabilità orizzontale dell'applicazione usando un componente *backplane* quando l'applicazione viene distribuita in più istanze di IIS.</span><span class="sxs-lookup"><span data-stu-id="2a241-377">Additionally, you learned how to scale out your application by using a *backplane* component when your application is deployed in multiple IIS instances.</span></span>
