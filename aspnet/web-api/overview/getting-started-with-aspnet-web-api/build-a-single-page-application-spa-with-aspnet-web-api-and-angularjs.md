---
uid: web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs
title: "Laboratorio pratico: creare un'applicazione a pagina singola (SPA) con API Web ASP.NET e angolar. js-ASP.NET 4. x"
author: rick-anderson
description: "Codice dettagliato: compilare un'applicazione a pagina singola (SPA) con API Web ASP.NET e angolar. js per ASP.NET 4. x."
ms.author: riande
ms.date: 09/30/2015
ms.custom: seoapril2019
ms.assetid: 719727b7-bef3-45ad-bfe9-ba5bcdb2305f
msc.legacyurl: /web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs
msc.type: authoredcontent
ms.openlocfilehash: 86833a890da759e489dd11dc9afb128a9b7a75e3
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/06/2020
ms.locfileid: "78557043"
---
# <a name="hands-on-lab-build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs"></a><span data-ttu-id="0f2c2-103">Laboratorio pratico: creare un'applicazione a pagina singola (SPA) con API Web ASP.NET e angolar. js</span><span class="sxs-lookup"><span data-stu-id="0f2c2-103">Hands On Lab: Build a Single Page Application (SPA) with ASP.NET Web API and Angular.js</span></span>

<span data-ttu-id="0f2c2-104">dal [team di Web Camp](https://twitter.com/webcamps)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-104">by [Web Camps Team](https://twitter.com/webcamps)</span></span>

[<span data-ttu-id="0f2c2-105">Scarica il kit di formazione di Web Camp</span><span class="sxs-lookup"><span data-stu-id="0f2c2-105">Download Web Camps Training Kit</span></span>](https://aka.ms/webcamps-training-kit)

<span data-ttu-id="0f2c2-106">Questo laboratorio pratico Mostra come creare un'applicazione a pagina singola (SPA) con API Web ASP.NET e angolar. js per ASP.NET 4. x.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-106">This hands on lab shows you how to build a Single Page Application (SPA) with ASP.NET Web API and Angular.js for ASP.NET 4.x.</span></span>

<span data-ttu-id="0f2c2-107">In questa esercitazione, si utilizzeranno tali tecnologie per implementare un quiz per geek, un sito Web di Trivia basato sul concetto di SPA.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-107">In this hand-on lab, you will take advantage of those technologies to implement Geek Quiz, a trivia website based on the SPA concept.</span></span> <span data-ttu-id="0f2c2-108">Il livello di servizio viene innanzitutto implementato con API Web ASP.NET per esporre gli endpoint necessari per recuperare le domande del quiz e archiviare le risposte.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-108">You will first implement the service layer with ASP.NET Web API to expose the required endpoints to retrieve the quiz questions and store the answers.</span></span> <span data-ttu-id="0f2c2-109">Sarà quindi possibile creare un'interfaccia utente completa e reattiva usando gli effetti di trasformazione AngularJS e CSS3.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-109">Then, you will build a rich and responsive UI using AngularJS and CSS3 transformation effects.</span></span>

<span data-ttu-id="0f2c2-110">Nelle applicazioni Web tradizionali, il client (browser) avvia la comunicazione con il server richiedendo una pagina.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-110">In traditional web applications, the client (browser) initiates the communication with the server by requesting a page.</span></span> <span data-ttu-id="0f2c2-111">Il server elabora quindi la richiesta e invia il codice HTML della pagina al client.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-111">The server then processes the request and sends the HTML of the page to the client.</span></span> <span data-ttu-id="0f2c2-112">Nelle interazioni successive con la pagina, ad esempio l'utente passa a un collegamento o Invia un modulo con i dati, viene inviata una nuova richiesta al server e il flusso viene riavviato: il server elabora la richiesta e invia una nuova pagina al browser in risposta alla nuova richiesta di azione. ed dal client.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-112">In subsequent interactions with the page –e.g. the user navigates to a link or submits a form with data– a new request is sent to the server, and the flow starts again: the server processes the request and sends a new page to the browser in response to the new action requested by the client.</span></span>
> 
> <span data-ttu-id="0f2c2-113">Nelle applicazioni a singola pagina (Spa) l'intera pagina viene caricata nel browser dopo la richiesta iniziale, ma le interazioni successive avvengono tramite richieste AJAX.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-113">In Single-Page Applications (SPAs) the entire page is loaded in the browser after the initial request, but subsequent interactions take place through Ajax requests.</span></span> <span data-ttu-id="0f2c2-114">Questo significa che il browser deve aggiornare solo la parte della pagina che è stata modificata. non è necessario ricaricare l'intera pagina.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-114">This means that the browser has to update only the portion of the page that has changed; there is no need to reload the entire page.</span></span> <span data-ttu-id="0f2c2-115">L'approccio SPA riduce il tempo impiegato dall'applicazione per rispondere alle azioni dell'utente, ottenendo un'esperienza più fluida.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-115">The SPA approach reduces the time taken by the application to respond to user actions, resulting in a more fluid experience.</span></span>
> 
> <span data-ttu-id="0f2c2-116">L'architettura di una SPA comporta alcune problemi che non sono presenti nelle applicazioni Web tradizionali.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-116">The architecture of a SPA involves certain challenges that are not present in traditional web applications.</span></span> <span data-ttu-id="0f2c2-117">Tuttavia, le tecnologie emergenti come API Web ASP.NET, i framework JavaScript come AngularJS e le nuove funzionalità di stile offerte da CSS3 semplificano la progettazione e la creazione di Spa.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-117">However, emerging technologies like ASP.NET Web API, JavaScript frameworks like AngularJS and new styling features provided by CSS3 make it really easy to design and build SPAs.</span></span>
> 
> 
> <span data-ttu-id="0f2c2-118">Tutti i codici e i frammenti di codice di esempio sono inclusi nel kit di formazione di Web Camp, disponibile all' [https://aka.ms/webcamps-training-kit](https://aka.ms/webcamps-training-kit).</span><span class="sxs-lookup"><span data-stu-id="0f2c2-118">All sample code and snippets are included in the Web Camps Training Kit, available at [https://aka.ms/webcamps-training-kit](https://aka.ms/webcamps-training-kit).</span></span>

## <a name="overview"></a><span data-ttu-id="0f2c2-119">Panoramica</span><span class="sxs-lookup"><span data-stu-id="0f2c2-119">Overview</span></span>

<a id="Objectives"></a>
### <a name="objectives"></a><span data-ttu-id="0f2c2-120">Obiettivi</span><span class="sxs-lookup"><span data-stu-id="0f2c2-120">Objectives</span></span>

<span data-ttu-id="0f2c2-121">In questo laboratorio pratico si apprenderà come:</span><span class="sxs-lookup"><span data-stu-id="0f2c2-121">In this hands-on lab, you will learn how to:</span></span>

- <span data-ttu-id="0f2c2-122">Creare un servizio API Web ASP.NET per inviare e ricevere dati JSON</span><span class="sxs-lookup"><span data-stu-id="0f2c2-122">Create an ASP.NET Web API service to send and receive JSON data</span></span>
- <span data-ttu-id="0f2c2-123">Creare un'interfaccia utente reattiva usando AngularJS</span><span class="sxs-lookup"><span data-stu-id="0f2c2-123">Create a responsive UI using AngularJS</span></span>
- <span data-ttu-id="0f2c2-124">Migliorare l'esperienza dell'interfaccia utente con le trasformazioni CSS3</span><span class="sxs-lookup"><span data-stu-id="0f2c2-124">Enhance the UI experience with CSS3 transformations</span></span>

<a id="Prerequisites"></a>
### <a name="prerequisites"></a><span data-ttu-id="0f2c2-125">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="0f2c2-125">Prerequisites</span></span>

<span data-ttu-id="0f2c2-126">Per completare questa esercitazione pratica, è necessario quanto segue:</span><span class="sxs-lookup"><span data-stu-id="0f2c2-126">The following is required to complete this hands-on lab:</span></span>

- <span data-ttu-id="0f2c2-127">[Visual Studio Express 2013 per il Web](https://www.microsoft.com/visualstudio/) o versione successiva</span><span class="sxs-lookup"><span data-stu-id="0f2c2-127">[Visual Studio Express 2013 for Web](https://www.microsoft.com/visualstudio/) or greater</span></span>

<a id="Setup"></a>
### <a name="setup"></a><span data-ttu-id="0f2c2-128">Configurazione</span><span class="sxs-lookup"><span data-stu-id="0f2c2-128">Setup</span></span>

<span data-ttu-id="0f2c2-129">Per eseguire gli esercizi in questo laboratorio pratico, è necessario configurare prima l'ambiente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-129">In order to run the exercises in this hands-on lab, you will need to set up your environment first.</span></span>

1. <span data-ttu-id="0f2c2-130">Aprire Esplora risorse e passare alla cartella di **origine** del Lab.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-130">Open Windows Explorer and browse to the lab's **Source** folder.</span></span>
2. <span data-ttu-id="0f2c2-131">Fare clic con il pulsante destro del mouse su **Setup. cmd** e scegliere **Esegui come amministratore** per avviare il processo di installazione che configurerà l'ambiente e installerà i frammenti di codice di Visual Studio per questo Lab.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-131">Right-click on **Setup.cmd** and select **Run as administrator** to launch the setup process that will configure your environment and install the Visual Studio code snippets for this lab.</span></span>
3. <span data-ttu-id="0f2c2-132">Se viene visualizzata la finestra di dialogo controllo account utente, confermare l'azione per continuare.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-132">If the User Account Control dialog box is shown, confirm the action to proceed.</span></span>

> [!NOTE]
> <span data-ttu-id="0f2c2-133">Prima di eseguire l'installazione, verificare di aver selezionato tutte le dipendenze per questo Lab.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-133">Make sure you have checked all the dependencies for this lab before running the setup.</span></span>

<a id="CodeSnippets"></a>
### <a name="using-the-code-snippets"></a><span data-ttu-id="0f2c2-134">Uso dei frammenti di codice</span><span class="sxs-lookup"><span data-stu-id="0f2c2-134">Using the Code Snippets</span></span>

<span data-ttu-id="0f2c2-135">Nell'intero documento del Lab verrà richiesto di inserire blocchi di codice.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-135">Throughout the lab document, you will be instructed to insert code blocks.</span></span> <span data-ttu-id="0f2c2-136">Per praticità, la maggior parte di questo codice viene fornita come Visual Studio Code frammenti, a cui è possibile accedere da Visual Studio 2013 per evitare di aggiungerla manualmente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-136">For your convenience, most of this code is provided as Visual Studio Code Snippets, which you can access from within Visual Studio 2013 to avoid having to add it manually.</span></span>

> [!NOTE]
> <span data-ttu-id="0f2c2-137">Ogni esercizio è accompagnato da una soluzione iniziale che si trova nella cartella **Begin** dell'esercizio che consente di seguire ogni esercizio in modo indipendente dagli altri.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-137">Each exercise is accompanied by a starting solution located in the **Begin** folder of the exercise that allows you to follow each exercise independently of the others.</span></span> <span data-ttu-id="0f2c2-138">Tenere presente che i frammenti di codice aggiunti durante un esercizio risultano mancanti da queste soluzioni iniziali e potrebbero non funzionare fino a quando non è stato completato l'esercizio.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-138">Please be aware that the code snippets that are added during an exercise are missing from these starting solutions and may not work until you have completed the exercise.</span></span> <span data-ttu-id="0f2c2-139">All'interno del codice sorgente per un esercizio, si troverà anche una cartella **finale** contenente una soluzione di Visual Studio con il codice risultante dal completamento dei passaggi nell'esercizio corrispondente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-139">Inside the source code for an exercise, you will also find an **End** folder containing a Visual Studio solution with the code that results from completing the steps in the corresponding exercise.</span></span> <span data-ttu-id="0f2c2-140">È possibile usare queste soluzioni come materiale sussidiario se è necessaria ulteriore assistenza durante l'utilizzo di questa esercitazione pratica.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-140">You can use these solutions as guidance if you need additional help as you work through this hands-on lab.</span></span>

---

<a id="Exercises"></a>
## <a name="exercises"></a><span data-ttu-id="0f2c2-141">Esercizi</span><span class="sxs-lookup"><span data-stu-id="0f2c2-141">Exercises</span></span>

<span data-ttu-id="0f2c2-142">Questa esercitazione pratica include gli esercizi seguenti:</span><span class="sxs-lookup"><span data-stu-id="0f2c2-142">This hands-on lab includes the following exercises:</span></span>

1. [<span data-ttu-id="0f2c2-143">Creazione di un'API Web</span><span class="sxs-lookup"><span data-stu-id="0f2c2-143">Creating a Web API</span></span>](#Exercise1)
2. [<span data-ttu-id="0f2c2-144">Creazione di un'interfaccia SPA</span><span class="sxs-lookup"><span data-stu-id="0f2c2-144">Creating a SPA Interface</span></span>](#Exercise2)

<span data-ttu-id="0f2c2-145">Tempo stimato per il completamento del Lab: **60 minuti**</span><span class="sxs-lookup"><span data-stu-id="0f2c2-145">Estimated time to complete this lab: **60 minutes**</span></span>

> [!NOTE]
> <span data-ttu-id="0f2c2-146">Quando si avvia Visual Studio per la prima volta, è necessario selezionare una delle raccolte di impostazioni predefinite.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-146">When you first start Visual Studio, you must select one of the predefined settings collections.</span></span> <span data-ttu-id="0f2c2-147">Ogni raccolta predefinita è progettata in modo da corrispondere a un particolare stile di sviluppo e determina il layout delle finestre, il comportamento dell'editor, i frammenti di codice IntelliSense e le opzioni della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-147">Each predefined collection is designed to match a particular development style and determines window layouts, editor behavior, IntelliSense code snippets, and dialog box options.</span></span> <span data-ttu-id="0f2c2-148">Le procedure descritte in questa esercitazione descrivono le azioni necessarie per eseguire un'attività specifica in Visual Studio quando si usa la raccolta di **impostazioni di sviluppo generali** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-148">The procedures in this lab describe the actions necessary to accomplish a given task in Visual Studio when using the **General Development Settings** collection.</span></span> <span data-ttu-id="0f2c2-149">Se si sceglie una raccolta di impostazioni diversa per l'ambiente di sviluppo, è possibile che siano presenti differenze nei passaggi da tenere in considerazione.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-149">If you choose a different settings collection for your development environment, there may be differences in the steps that you should take into account.</span></span>

<a id="Exercise1"></a>
### <a name="exercise-1-creating-a-web-api"></a><span data-ttu-id="0f2c2-150">Esercizio 1: creazione di un'API Web</span><span class="sxs-lookup"><span data-stu-id="0f2c2-150">Exercise 1: Creating a Web API</span></span>

<span data-ttu-id="0f2c2-151">Una delle parti principali di una SPA è il livello di servizio.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-151">One of the key parts of a SPA is the service layer.</span></span> <span data-ttu-id="0f2c2-152">È responsabile dell'elaborazione delle chiamate AJAX inviate dall'interfaccia utente e della restituzione dei dati in risposta a tale chiamata.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-152">It is responsible for processing the Ajax calls sent by the UI and returning data in response to that call.</span></span> <span data-ttu-id="0f2c2-153">I dati recuperati devono essere presentati in un formato leggibile dal computer per essere analizzati e utilizzati dal client.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-153">The data retrieved should be presented in a machine-readable format in order to be parsed and consumed by the client.</span></span>

<span data-ttu-id="0f2c2-154">Il Framework API Web fa parte dello stack ASP.NET ed è progettato per semplificare l'implementazione di servizi HTTP, in genere l'invio e la ricezione di dati in formato JSON o XML tramite un'API RESTful.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-154">The Web API framework is part of the ASP.NET Stack and is designed to make it easy to implement HTTP services, generally sending and receiving JSON- or XML-formatted data through a RESTful API.</span></span> <span data-ttu-id="0f2c2-155">In questo esercizio verrà creato il sito Web per ospitare l'applicazione di quiz per geek e quindi implementare il servizio back-end per esporre e rendere permanente i dati del quiz utilizzando API Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-155">In this exercise you will create the Web site to host the Geek Quiz application and then implement the back-end service to expose and persist the quiz data using ASP.NET Web API.</span></span>

<a id="Ex1Task1"></a>
#### <a name="task-1--creating-the-initial-project-for-geek-quiz"></a><span data-ttu-id="0f2c2-156">Attività 1: creazione del progetto iniziale per il quiz per geek</span><span class="sxs-lookup"><span data-stu-id="0f2c2-156">Task 1 – Creating the Initial Project for Geek Quiz</span></span>

<span data-ttu-id="0f2c2-157">In questa attività si inizierà a creare un nuovo progetto MVC ASP.NET con il supporto per API Web ASP.NET in base a un tipo di progetto **ASP.NET** che viene incluso in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-157">In this task you will start creating a new ASP.NET MVC project with support for ASP.NET Web API based on the **One ASP.NET** project type that comes with Visual Studio.</span></span> <span data-ttu-id="0f2c2-158">**Un ASP.NET** unifica tutte le tecnologie ASP.NET e offre la possibilità di combinare e abbinarle in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-158">**One ASP.NET** unifies all ASP.NET technologies and gives you the option to mix and match them as desired.</span></span> <span data-ttu-id="0f2c2-159">Si aggiungeranno quindi le classi del modello del Entity Framework e l'inizializzatore di database per inserire le domande del quiz.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-159">You will then add the Entity Framework's model classes and the database initializer to insert the quiz questions.</span></span>

1. <span data-ttu-id="0f2c2-160">Aprire **Visual Studio Express 2013 per il Web** e selezionare **file | Nuovo progetto...** per avviare una nuova soluzione.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-160">Open **Visual Studio Express 2013 for Web** and select **File | New Project...** to start a new solution.</span></span>

    <span data-ttu-id="0f2c2-161">![Creazione di un nuovo progetto](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image1.png "Creazione di un nuovo progetto")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-161">![Creating a New Project](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image1.png "Creating a New Project")</span></span>

    <span data-ttu-id="0f2c2-162">*Creazione di un nuovo progetto*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-162">*Creating a New Project*</span></span>
2. <span data-ttu-id="0f2c2-163">Nella finestra di dialogo **nuovo progetto** selezionare **applicazione Web ASP.NET** sotto l'oggetto **visivo C# | Scheda Web** . Assicurarsi che sia selezionato **.NET Framework 4,5** , denominarlo *GeekQuiz*, scegliere un **percorso** e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-163">In the **New Project** dialog box, select **ASP.NET Web Application** under the **Visual C# | Web** tab. Make sure **.NET Framework 4.5** is selected, name it *GeekQuiz*, choose a **Location** and click **OK**.</span></span>

    <span data-ttu-id="0f2c2-164">![Creazione di un nuovo progetto di applicazione Web ASP.NET](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image2.png "Creazione di un nuovo progetto di applicazione Web ASP.NET")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-164">![Creating a new ASP.NET Web Application project](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image2.png "Creating a new ASP.NET Web Application project")</span></span>

    <span data-ttu-id="0f2c2-165">*Creazione di un nuovo progetto di applicazione Web ASP.NET*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-165">*Creating a new ASP.NET Web Application project*</span></span>
3. <span data-ttu-id="0f2c2-166">Nella finestra di dialogo **nuovo progetto ASP.NET** selezionare il modello **MVC** e selezionare l'opzione **API Web** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-166">In the **New ASP.NET Project** dialog box, select the **MVC** template and select the **Web API** option.</span></span> <span data-ttu-id="0f2c2-167">Inoltre, assicurarsi che l'opzione **autenticazione** sia impostata su **singoli account utente**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-167">Also, make sure that the **Authentication** option is set to **Individual User Accounts**.</span></span> <span data-ttu-id="0f2c2-168">Fare clic su **OK** per continuare.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-168">Click **OK** to continue.</span></span>

    ![Creazione di un nuovo progetto con il modello MVC, inclusi i componenti dell'API Web](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image3.png)

    <span data-ttu-id="0f2c2-170">*Creazione di un nuovo progetto con il modello MVC, inclusi i componenti dell'API Web*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-170">*Creating a new project with the MVC template, including Web API components*</span></span>
4. <span data-ttu-id="0f2c2-171">In **Esplora soluzioni**fare clic con il pulsante destro del mouse sulla cartella **Models** del progetto **GeekQuiz** e scegliere **Aggiungi | Elemento esistente...**</span><span class="sxs-lookup"><span data-stu-id="0f2c2-171">In **Solution Explorer**, right-click the **Models** folder of the **GeekQuiz** project and select **Add | Existing Item...**.</span></span>

    <span data-ttu-id="0f2c2-172">![Aggiunta di un elemento esistente](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image4.png "Aggiunta di un elemento esistente")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-172">![Adding an existing item](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image4.png "Adding an existing item")</span></span>

    <span data-ttu-id="0f2c2-173">*Aggiunta di un elemento esistente*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-173">*Adding an existing item*</span></span>
5. <span data-ttu-id="0f2c2-174">Nella finestra di dialogo **Aggiungi elemento esistente** passare alla cartella **source/assets/Models** e selezionare tutti i file.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-174">In the **Add Existing Item** dialog box, navigate to the **Source/Assets/Models** folder and select all the files.</span></span> <span data-ttu-id="0f2c2-175">Fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-175">Click **Add**.</span></span>

    <span data-ttu-id="0f2c2-176">![Aggiunta degli asset del modello](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image5.png "Aggiunta degli asset del modello")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-176">![Adding the model assets](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image5.png "Adding the model assets")</span></span>

    <span data-ttu-id="0f2c2-177">*Aggiunta degli asset del modello*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-177">*Adding the model assets*</span></span>

    > [!NOTE]
    > <span data-ttu-id="0f2c2-178">Aggiungendo questi file, si aggiungono il modello di dati, il contesto di database Entity Framework e l'inizializzatore di database per l'applicazione di quiz per geek.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-178">By adding these files, you are adding the data model, the Entity Framework's database context and the database initializer for the Geek Quiz application.</span></span>
    > 
    > <span data-ttu-id="0f2c2-179">**Entity Framework (EF)** è un mapper relazionale a oggetti (ORM) che consente di creare applicazioni di accesso ai dati tramite la programmazione con un modello di applicazione concettuale anziché programmare direttamente utilizzando uno schema di archiviazione relazionale.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-179">**Entity Framework (EF)** is an object-relational mapper (ORM) that enables you to create data access applications by programming with a conceptual application model instead of programming directly using a relational storage schema.</span></span> <span data-ttu-id="0f2c2-180">Per altre informazioni su Entity Framework, vedere [qui](../../../entity-framework.md).</span><span class="sxs-lookup"><span data-stu-id="0f2c2-180">You can learn more about Entity Framework [here](../../../entity-framework.md).</span></span>
    > 
    > <span data-ttu-id="0f2c2-181">Di seguito è riportata una descrizione delle classi appena aggiunte:</span><span class="sxs-lookup"><span data-stu-id="0f2c2-181">The following is a description of the classes you just added:</span></span>
    > 
    > - <span data-ttu-id="0f2c2-182">**TriviaOption:** rappresenta una singola opzione associata a una domanda di quiz</span><span class="sxs-lookup"><span data-stu-id="0f2c2-182">**TriviaOption:** represents a single option associated with a quiz question</span></span>
    > - <span data-ttu-id="0f2c2-183">**TriviaQuestion:** rappresenta una domanda di quiz ed espone le opzioni associate tramite la proprietà **options**</span><span class="sxs-lookup"><span data-stu-id="0f2c2-183">**TriviaQuestion:** represents a quiz question and exposes the associated options through the **Options** property</span></span>
    > - <span data-ttu-id="0f2c2-184">**TriviaAnswer:** rappresenta l'opzione selezionata dall'utente in risposta a una domanda di quiz</span><span class="sxs-lookup"><span data-stu-id="0f2c2-184">**TriviaAnswer:** represents the option selected by the user in response to a quiz question</span></span>
    > - <span data-ttu-id="0f2c2-185">**TriviaContext:** rappresenta il contesto di database del Entity Framework dell'applicazione di quiz per geek.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-185">**TriviaContext:** represents the Entity Framework's database context of the Geek Quiz application.</span></span> <span data-ttu-id="0f2c2-186">Questa classe deriva da **DContext** ed espone le proprietà **DbSet** che rappresentano le raccolte delle entità descritte in precedenza.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-186">This class derives from **DContext** and exposes **DbSet** properties that represent collections of the entities described above.</span></span>
    > - <span data-ttu-id="0f2c2-187">**TriviaDatabaseInitializer:** l'implementazione dell'inizializzatore di Entity Framework per la classe **TriviaContext** che eredita da **CreateDatabaseIfNotExists**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-187">**TriviaDatabaseInitializer:** the implementation of the Entity Framework initializer for the **TriviaContext** class which inherits from **CreateDatabaseIfNotExists**.</span></span> <span data-ttu-id="0f2c2-188">Il comportamento predefinito di questa classe consiste nel creare il database solo se non esiste, inserendo le entità specificate nel metodo **Seed** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-188">The default behavior of this class is to create the database only if it does not exist, inserting the entities specified in the **Seed** method.</span></span>
6. <span data-ttu-id="0f2c2-189">Aprire il file **Global.asax.cs** e aggiungere l'istruzione using seguente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-189">Open the **Global.asax.cs** file and add the following using statement.</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample1.cs)]
7. <span data-ttu-id="0f2c2-190">Aggiungere il codice seguente all'inizio dell' **applicazione\_metodo Start** per impostare **TriviaDatabaseInitializer** come inizializzatore di database.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-190">Add the following code at the beginning of the **Application\_Start** method to set the **TriviaDatabaseInitializer** as the database initializer.</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample2.cs)]
8. <span data-ttu-id="0f2c2-191">Modificare il controller **Home** per limitare l'accesso agli utenti autenticati.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-191">Modify the **Home** controller to restrict access to authenticated users.</span></span> <span data-ttu-id="0f2c2-192">A tale scopo, aprire il file **HomeController.cs** nella cartella **Controllers** e aggiungere l'attributo **autorizza** alla definizione della classe **HomeController** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-192">To do this, open the **HomeController.cs** file inside the **Controllers** folder and add the **Authorize** attribute to the **HomeController** class definition.</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample3.cs)]

    > [!NOTE]
    > <span data-ttu-id="0f2c2-193">Il filtro di **autorizzazione** controlla se l'utente è autenticato.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-193">The **Authorize** filter checks to see if the user is authenticated.</span></span> <span data-ttu-id="0f2c2-194">Se l'utente non è autenticato, restituisce il codice di stato HTTP 401 (non autorizzato) senza richiamare l'azione.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-194">If the user is not authenticated, it returns HTTP status code 401 (Unauthorized) without invoking the action.</span></span> <span data-ttu-id="0f2c2-195">È possibile applicare il filtro a livello globale, a livello di controller o a livello di singole azioni.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-195">You can apply the filter globally, at the controller level, or at the level of individual actions.</span></span>
9. <span data-ttu-id="0f2c2-196">A questo punto sarà possibile personalizzare il layout delle pagine Web e la personalizzazione.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-196">You will now customize the layout of the web pages and the branding.</span></span> <span data-ttu-id="0f2c2-197">A tale scopo, aprire il file **\_layout. cshtml** all'interno delle **visualizzazioni | Cartella condivisa** e aggiornare il contenuto dell'elemento **titolo&lt;&gt;** sostituendo l' *applicazione ASP.NET* con il *quiz geek*.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-197">To do this, open the **\_Layout.cshtml** file inside the **Views | Shared** folder and update the content of the **&lt;title&gt;** element by replacing *My ASP.NET Application* with *Geek Quiz*.</span></span>

    [!code-cshtml[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample4.cshtml)]
10. <span data-ttu-id="0f2c2-198">Nello stesso file aggiornare la barra di spostamento rimuovendo i collegamenti *About* e *Contact* e rinominando il collegamento *Home* per la *riproduzione*.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-198">In the same file, update the navigation bar by removing the *About* and *Contact* links and renaming the *Home* link to *Play*.</span></span> <span data-ttu-id="0f2c2-199">Inoltre, rinominare il collegamento *nome applicazione* a *quiz geek*.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-199">Additionally, rename the *Application name* link to *Geek Quiz*.</span></span> <span data-ttu-id="0f2c2-200">Il codice HTML per la barra di spostamento dovrebbe essere simile al codice seguente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-200">The HTML for the navigation bar should look like the following code.</span></span>

    [!code-cshtml[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample5.cshtml)]
11. <span data-ttu-id="0f2c2-201">Aggiornare il piè di pagina della pagina di layout sostituendo l' *applicazione ASP.NET con il* *quiz geek*.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-201">Update the footer of the layout page by replacing *My ASP.NET Application* with *Geek Quiz*.</span></span> <span data-ttu-id="0f2c2-202">A tale scopo, sostituire il contenuto dell'elemento **&lt;piè** di pagina&gt;con il codice evidenziato seguente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-202">To do this, replace the content of the **&lt;footer&gt;** element with the following highlighted code.</span></span>

    [!code-html[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample6.html)]

<a id="Ex1Task2"></a>
#### <a name="task-2--creating-the-triviacontroller-web-api"></a><span data-ttu-id="0f2c2-203">Attività 2: creazione dell'API Web TriviaController</span><span class="sxs-lookup"><span data-stu-id="0f2c2-203">Task 2 – Creating the TriviaController Web API</span></span>

<span data-ttu-id="0f2c2-204">Nell'attività precedente è stata creata la struttura iniziale dell'applicazione Web Geek quiz.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-204">In the previous task, you created the initial structure of the Geek Quiz web application.</span></span> <span data-ttu-id="0f2c2-205">Verrà ora compilato un semplice servizio API Web che interagisce con il modello di dati del quiz ed espone le azioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="0f2c2-205">You will now build a simple Web API service that interacts with the quiz data model and exposes the following actions:</span></span>

- <span data-ttu-id="0f2c2-206">**Get/API/Trivia**: Recupera la domanda successiva dall'elenco dei quiz a cui deve rispondere l'utente autenticato.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-206">**GET /api/trivia**: Retrieves the next question from the quiz list to be answered by the authenticated user.</span></span>
- <span data-ttu-id="0f2c2-207">**Post/API/Trivia**: archivia la risposta al quiz specificata dall'utente autenticato.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-207">**POST /api/trivia**: Stores the quiz answer specified by the authenticated user.</span></span>

<span data-ttu-id="0f2c2-208">Per creare la linea di base per la classe controller API Web, si useranno gli strumenti di impalcatura ASP.NET forniti da Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-208">You will use the ASP.NET Scaffolding tools provided by Visual Studio to create the baseline for the Web API controller class.</span></span>

1. <span data-ttu-id="0f2c2-209">Aprire il file **WebApiConfig.cs** all'interno dell' **app\_** cartella di avvio.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-209">Open the **WebApiConfig.cs** file inside the **App\_Start** folder.</span></span> <span data-ttu-id="0f2c2-210">Questo file definisce la configurazione del servizio API Web, come il mapping delle route alle azioni del controller API Web.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-210">This file defines the configuration of the Web API service, like how routes are mapped to Web API controller actions.</span></span>
2. <span data-ttu-id="0f2c2-211">Aggiungere l'istruzione using seguente all'inizio del file.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-211">Add the following using statement at the beginning of the file.</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample7.cs)]
3. <span data-ttu-id="0f2c2-212">Aggiungere il codice evidenziato seguente al metodo **Register** per configurare globalmente il formattatore per i dati JSON recuperati dai metodi di azione dell'API Web.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-212">Add the following highlighted code to the **Register** method to globally configure the formatter for the JSON data retrieved by the Web API action methods.</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample8.cs)]

    > [!NOTE]
    > <span data-ttu-id="0f2c2-213">**CamelCasePropertyNamesContractResolver** converte automaticamente i nomi di proprietà in *Camel* case, ovvero la convenzione generale per i nomi di proprietà in JavaScript.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-213">The **CamelCasePropertyNamesContractResolver** automatically converts property names to *camel* case, which is the general convention for property names in JavaScript.</span></span>
4. <span data-ttu-id="0f2c2-214">In **Esplora soluzioni**fare clic con il pulsante destro del mouse sulla cartella **controller** del progetto **GeekQuiz** e scegliere **Aggiungi | Nuovo elemento con impalcatura...**</span><span class="sxs-lookup"><span data-stu-id="0f2c2-214">In **Solution Explorer**, right-click the **Controllers** folder of the **GeekQuiz** project and select **Add | New Scaffolded Item...**.</span></span>

    <span data-ttu-id="0f2c2-215">![Creazione di un nuovo elemento con impalcatura](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image6.png "Creazione di un nuovo elemento con impalcatura")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-215">![Creating a new scaffolded item](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image6.png "Creating a new scaffolded item")</span></span>

    <span data-ttu-id="0f2c2-216">*Creazione di un nuovo elemento con impalcatura*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-216">*Creating a new scaffolded item*</span></span>
5. <span data-ttu-id="0f2c2-217">Nella finestra di dialogo **Aggiungi impalcatura** , verificare che il nodo **comune** sia selezionato nel riquadro sinistro.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-217">In the **Add Scaffold** dialog box, make sure that the **Common** node is selected in the left pane.</span></span> <span data-ttu-id="0f2c2-218">Quindi, selezionare il modello **Web API 2 controller-Empty** nel riquadro centrale e fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-218">Then, select the **Web API 2 Controller - Empty** template in the center pane and click **Add**.</span></span>

    <span data-ttu-id="0f2c2-219">![Selezione del modello vuoto del controller Web API 2](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image7.png "Selezione del modello vuoto del controller Web API 2")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-219">![Selecting the Web API 2 Controller Empty template](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image7.png "Selecting the Web API 2 Controller Empty template")</span></span>

    <span data-ttu-id="0f2c2-220">*Selezione del modello vuoto del controller Web API 2*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-220">*Selecting the Web API 2 Controller Empty template*</span></span>

    > [!NOTE]
    > <span data-ttu-id="0f2c2-221">L' **impalcatura ASP.NET** è un Framework per la generazione di codice per le applicazioni Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-221">**ASP.NET Scaffolding** is a code generation framework for ASP.NET Web applications.</span></span> <span data-ttu-id="0f2c2-222">Visual Studio 2013 include i generatori di codice preinstallati per i progetti MVC e API Web.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-222">Visual Studio 2013 includes pre-installed code generators for MVC and Web API projects.</span></span> <span data-ttu-id="0f2c2-223">È consigliabile utilizzare l'impalcatura nel progetto quando si desidera aggiungere rapidamente codice che interagisce con i modelli di dati per ridurre la quantità di tempo necessaria per lo sviluppo di operazioni dati standard.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-223">You should use scaffolding in your project when you want to quickly add code that interacts with data models in order to reduce the amount of time required to develop standard data operations.</span></span>
    > 
    > <span data-ttu-id="0f2c2-224">Il processo di impalcatura garantisce inoltre che tutte le dipendenze necessarie siano installate nel progetto.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-224">The scaffolding process also ensures that all the required dependencies are installed in the project.</span></span> <span data-ttu-id="0f2c2-225">Se ad esempio si inizia con un progetto ASP.NET vuoto e quindi si usa l'impalcatura per aggiungere un controller API Web, i riferimenti e i pacchetti NuGet dell'API Web richiesti verranno aggiunti automaticamente al progetto.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-225">For example, if you start with an empty ASP.NET project and then use scaffolding to add a Web API controller, the required Web API NuGet packages and references are added to your project automatically.</span></span>
6. <span data-ttu-id="0f2c2-226">Nella finestra di dialogo **Aggiungi controller** digitare *TriviaController* nella casella di testo **nome controller** , quindi fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-226">In the **Add Controller** dialog box, type *TriviaController* in the **Controller name** text box and click **Add**.</span></span>

    <span data-ttu-id="0f2c2-227">![Aggiunta del controller Trivia](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image8.png "Aggiunta del controller Trivia")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-227">![Adding the Trivia Controller](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image8.png "Adding the Trivia Controller")</span></span>

    <span data-ttu-id="0f2c2-228">*Aggiunta del controller Trivia*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-228">*Adding the Trivia Controller*</span></span>
7. <span data-ttu-id="0f2c2-229">Il file **TriviaController.cs** viene quindi aggiunto alla cartella **Controllers** del progetto **GeekQuiz** , contenente una classe **TriviaController** vuota.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-229">The **TriviaController.cs** file is then added to the **Controllers** folder of the **GeekQuiz** project, containing an empty **TriviaController** class.</span></span> <span data-ttu-id="0f2c2-230">Aggiungere le istruzioni using seguenti all'inizio del file.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-230">Add the following using statements at the beginning of the file.</span></span>

    <span data-ttu-id="0f2c2-231">(Frammento di codice- *AspNetWebApiSpa-EX1-TriviaControllerUsings*)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-231">(Code Snippet - *AspNetWebApiSpa - Ex1 - TriviaControllerUsings*)</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample9.cs)]
8. <span data-ttu-id="0f2c2-232">Aggiungere il codice seguente all'inizio della classe **TriviaController** per definire, inizializzare ed eliminare l'istanza di **TriviaContext** nel controller.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-232">Add the following code at the beginning of the **TriviaController** class to define, initialize and dispose the **TriviaContext** instance in the controller.</span></span>

    <span data-ttu-id="0f2c2-233">(Frammento di codice- *AspNetWebApiSpa-EX1-TriviaControllerContext*)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-233">(Code Snippet - *AspNetWebApiSpa - Ex1 - TriviaControllerContext*)</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample10.cs)]

    > [!NOTE]
    > <span data-ttu-id="0f2c2-234">Il metodo **Dispose** di **TriviaController** richiama il metodo **Dispose** dell'istanza **TriviaContext** , che garantisce che tutte le risorse utilizzate dall'oggetto context vengano rilasciate quando l'istanza di **TriviaContext** viene eliminata o sottoposta a Garbage Collection.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-234">The **Dispose** method of **TriviaController** invokes the **Dispose** method of the **TriviaContext** instance, which ensures that all the resources used by the context object are released when the **TriviaContext** instance is disposed or garbage-collected.</span></span> <span data-ttu-id="0f2c2-235">Ciò include la chiusura di tutte le connessioni di database aperte dal Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-235">This includes closing all database connections opened by Entity Framework.</span></span>
9. <span data-ttu-id="0f2c2-236">Aggiungere il seguente metodo helper alla fine della classe **TriviaController** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-236">Add the following helper method at the end of the **TriviaController** class.</span></span> <span data-ttu-id="0f2c2-237">Questo metodo recupera la domanda di quiz seguente dal database a cui l'utente specificato deve rispondere.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-237">This method retrieves the following quiz question from the database to be answered by the specified user.</span></span>

    <span data-ttu-id="0f2c2-238">(Frammento di codice- *AspNetWebApiSpa-EX1-TriviaControllerNextQuestion*)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-238">(Code Snippet - *AspNetWebApiSpa - Ex1 - TriviaControllerNextQuestion*)</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample11.cs)]
10. <span data-ttu-id="0f2c2-239">Aggiungere il metodo **Get** Action seguente alla classe **TriviaController** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-239">Add the following **Get** action method to the **TriviaController** class.</span></span> <span data-ttu-id="0f2c2-240">Questo metodo di azione chiama il metodo helper **NextQuestionAsync** definito nel passaggio precedente per recuperare la domanda successiva per l'utente autenticato.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-240">This action method calls the **NextQuestionAsync** helper method defined in the previous step to retrieve the next question for the authenticated user.</span></span>

    <span data-ttu-id="0f2c2-241">(Frammento di codice- *AspNetWebApiSpa-EX1-TriviaControllerGetAction*)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-241">(Code Snippet - *AspNetWebApiSpa - Ex1 - TriviaControllerGetAction*)</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample12.cs)]
11. <span data-ttu-id="0f2c2-242">Aggiungere il seguente metodo helper alla fine della classe **TriviaController** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-242">Add the following helper method at the end of the **TriviaController** class.</span></span> <span data-ttu-id="0f2c2-243">Questo metodo archivia la risposta specificata nel database e restituisce un valore booleano che indica se la risposta è corretta.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-243">This method stores the specified answer in the database and returns a Boolean value indicating whether or not the answer is correct.</span></span>

    <span data-ttu-id="0f2c2-244">(Frammento di codice- *AspNetWebApiSpa-EX1-TriviaControllerStoreAsync*)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-244">(Code Snippet - *AspNetWebApiSpa - Ex1 - TriviaControllerStoreAsync*)</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample13.cs)]
12. <span data-ttu-id="0f2c2-245">Aggiungere il metodo **post** azione seguente alla classe **TriviaController** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-245">Add the following **Post** action method to the **TriviaController** class.</span></span> <span data-ttu-id="0f2c2-246">Questo metodo di azione associa la risposta all'utente autenticato e chiama il metodo helper **storeAsync** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-246">This action method associates the answer to the authenticated user and calls the **StoreAsync** helper method.</span></span> <span data-ttu-id="0f2c2-247">Quindi invia una risposta con il valore booleano restituito dal metodo helper.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-247">Then, it sends a response with the Boolean value returned by the helper method.</span></span>

    <span data-ttu-id="0f2c2-248">(Frammento di codice- *AspNetWebApiSpa-EX1-TriviaControllerPostAction*)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-248">(Code Snippet - *AspNetWebApiSpa - Ex1 - TriviaControllerPostAction*)</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample14.cs)]
13. <span data-ttu-id="0f2c2-249">Modificare il controller API Web per limitare l'accesso agli utenti autenticati aggiungendo l'attributo **autorizza** alla definizione della classe **TriviaController** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-249">Modify the Web API controller to restrict access to authenticated users by adding the **Authorize** attribute to the **TriviaController** class definition.</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample15.cs)]

<a id="Ex1Task3"></a>
#### <a name="task-3--running-the-solution"></a><span data-ttu-id="0f2c2-250">Attività 3: esecuzione della soluzione</span><span class="sxs-lookup"><span data-stu-id="0f2c2-250">Task 3 – Running the Solution</span></span>

<span data-ttu-id="0f2c2-251">In questa attività si verificherà che il servizio API Web compilato nell'attività precedente funzioni come previsto.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-251">In this task you will verify that the Web API service you built in the previous task is working as expected.</span></span> <span data-ttu-id="0f2c2-252">Si utilizzerà il Strumenti di sviluppo di Internet Explorer **F12** per acquisire il traffico di rete e controllare la risposta completa dal servizio API Web.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-252">You will use the Internet Explorer **F12 Developer Tools** to capture the network traffic and inspect the full response from the Web API service.</span></span>

> [!NOTE]
> <span data-ttu-id="0f2c2-253">Assicurarsi che **Internet Explorer** sia selezionato nel pulsante **Avvia** sulla barra degli strumenti di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-253">Make sure that **Internet Explorer** is selected in the **Start** button located on the Visual Studio toolbar.</span></span>
> 
> ![Opzione Internet Explorer](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image9.png)

1. <span data-ttu-id="0f2c2-255">Premere **F5** per eseguire la soluzione.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-255">Press **F5** to run the solution.</span></span> <span data-ttu-id="0f2c2-256">La pagina di **accesso** verrà visualizzata nel browser.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-256">The **Log in** page should appear in the browser.</span></span>

    > [!NOTE]
    > <span data-ttu-id="0f2c2-257">Quando l'applicazione viene avviata, viene attivata la route MVC predefinita, che per impostazione predefinita è mappata all'azione **index** della classe **HomeController** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-257">When the application starts, the default MVC route is triggered, which by default is mapped to the **Index** action of the **HomeController** class.</span></span> <span data-ttu-id="0f2c2-258">Poiché **HomeController** è limitato agli utenti autenticati (ricordare che la classe è stata decorata con l'attributo di **autorizzazione** nell'esercizio 1) e non è ancora stato eseguito l'autenticazione dell'utente, l'applicazione reindirizza la richiesta originale alla pagina di accesso.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-258">Since **HomeController** is restricted to authenticated users (remember that you decorated that class with the **Authorize** attribute in Exercise 1) and there is no user authenticated yet, the application redirects the original request to the log in page.</span></span>

    <span data-ttu-id="0f2c2-259">![Esecuzione della soluzione](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image10.png "Esecuzione della soluzione")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-259">![Running the solution](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image10.png "Running the solution")</span></span>

    <span data-ttu-id="0f2c2-260">*Esecuzione della soluzione*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-260">*Running the solution*</span></span>
2. <span data-ttu-id="0f2c2-261">Fare clic su **registra** per creare un nuovo utente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-261">Click **Register** to create a new user.</span></span>

    <span data-ttu-id="0f2c2-262">![Registrazione di un nuovo utente](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image11.png "Registrazione di un nuovo utente")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-262">![Registering a new user](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image11.png "Registering a new user")</span></span>

    <span data-ttu-id="0f2c2-263">*Registrazione di un nuovo utente*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-263">*Registering a new user*</span></span>
3. <span data-ttu-id="0f2c2-264">Nella pagina **Register** immettere un **nome utente** e una **password**e quindi fare clic su **Register (registra**).</span><span class="sxs-lookup"><span data-stu-id="0f2c2-264">In the **Register** page, enter a **User name** and **Password**, and then click **Register**.</span></span>

    <span data-ttu-id="0f2c2-265">![Pagina di registrazione](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image12.png "Pagina di registrazione")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-265">![Register page](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image12.png "Register page")</span></span>

    <span data-ttu-id="0f2c2-266">*Pagina di registrazione*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-266">*Register page*</span></span>
4. <span data-ttu-id="0f2c2-267">L'applicazione registra il nuovo account e l'utente viene autenticato e reindirizzato di nuovo al home page.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-267">The application registers the new account and the user is authenticated and redirected back to the home page.</span></span>

    <span data-ttu-id="0f2c2-268">![L'utente è autenticato](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image13.png "Utente autenticato")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-268">![User is authenticated](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image13.png "User authenticated")</span></span>

    <span data-ttu-id="0f2c2-269">*L'utente è autenticato*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-269">*User is authenticated*</span></span>
5. <span data-ttu-id="0f2c2-270">Nel browser premere **F12** per aprire il pannello **strumenti di sviluppo** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-270">In the browser, press **F12** to open the **Developer Tools** panel.</span></span> <span data-ttu-id="0f2c2-271">Premere **CTRL + 4** oppure fare clic sull'icona della **rete** , quindi fare clic sul pulsante freccia verde per avviare l'acquisizione del traffico di rete.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-271">Press **CTRL + 4** or click the **Network** icon, and then click the green arrow button to begin capturing network traffic.</span></span>

    <span data-ttu-id="0f2c2-272">![Avvio dell'acquisizione di rete dell'API Web](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image14.png "Avvio dell'acquisizione di rete dell'API Web")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-272">![Initiating Web API network capture](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image14.png "Initiating Web API network capture")</span></span>

    <span data-ttu-id="0f2c2-273">*Avvio dell'acquisizione di rete dell'API Web*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-273">*Initiating Web API network capture*</span></span>
6. <span data-ttu-id="0f2c2-274">Aggiungere **API/Trivia** all'URL nella barra degli indirizzi del browser.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-274">Append **api/trivia** to the URL in the browser's address bar.</span></span> <span data-ttu-id="0f2c2-275">Verranno ora esaminati i dettagli della risposta dal metodo **Get** Action in **TriviaController**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-275">You will now inspect the details of the response from the **Get** action method in **TriviaController**.</span></span>

    <span data-ttu-id="0f2c2-276">![Recupero dei dati delle domande successive tramite l'API Web](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image15.png "Recupero dei dati delle domande successive tramite l'API Web")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-276">![Retrieving the next question data through Web API](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image15.png "Retrieving the next question data through Web API")</span></span>

    <span data-ttu-id="0f2c2-277">*Recupero dei dati delle domande successive tramite l'API Web*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-277">*Retrieving the next question data through Web API*</span></span>

    > [!NOTE]
    > <span data-ttu-id="0f2c2-278">Al termine del download, verrà richiesto di eseguire un'azione con il file scaricato.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-278">Once the download finishes, you will be prompted to make an action with the downloaded file.</span></span> <span data-ttu-id="0f2c2-279">Lasciare aperta la finestra di dialogo per poter controllare il contenuto della risposta tramite la finestra degli strumenti sviluppatori.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-279">Leave the dialog box open in order to be able to watch the response content through the Developers Tool window.</span></span>
7. <span data-ttu-id="0f2c2-280">A questo punto, verrà ispezionato il corpo della risposta.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-280">Now you will inspect the body of the response.</span></span> <span data-ttu-id="0f2c2-281">A tale scopo, fare clic sulla scheda **Dettagli** e quindi su **corpo della risposta**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-281">To do this, click the **Details** tab and then click **Response body**.</span></span> <span data-ttu-id="0f2c2-282">È possibile verificare che i dati scaricati siano un oggetto con le **Opzioni** Properties, ovvero un elenco di oggetti **TriviaOption** , **ID** e **title** corrispondenti alla classe **TriviaQuestion** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-282">You can check that the downloaded data is an object with the properties **options** (which is a list of **TriviaOption** objects), **id** and **title** that correspond to the **TriviaQuestion** class.</span></span>

    <span data-ttu-id="0f2c2-283">![Visualizzazione del corpo della risposta dell'API Web](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image16.png "Visualizzazione del corpo della risposta dell'API Web")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-283">![Viewing the Web API Response Body](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image16.png "Viewing the Web API Response Body")</span></span>

    <span data-ttu-id="0f2c2-284">*Visualizzazione del corpo della risposta dell'API Web*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-284">*Viewing Web API Response Body*</span></span>
8. <span data-ttu-id="0f2c2-285">Tornare a Visual Studio e premere **MAIUSC + F5** per arrestare il debug.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-285">Go back to Visual Studio and press **SHIFT + F5** to stop debugging.</span></span>

<a id="Exercise2"></a>
### <a name="exercise-2-creating-the-spa-interface"></a><span data-ttu-id="0f2c2-286">Esercizio 2: creazione dell'interfaccia SPA</span><span class="sxs-lookup"><span data-stu-id="0f2c2-286">Exercise 2: Creating the SPA Interface</span></span>

<span data-ttu-id="0f2c2-287">In questo esercizio verrà prima di tutto creato il componente front-end Web del quiz per geek, concentrandosi sull'interazione dell'applicazione a pagina singola con **AngularJS**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-287">In this exercise you will first build the web front-end portion of Geek Quiz, focusing on the Single-Page Application interaction using **AngularJS**.</span></span> <span data-ttu-id="0f2c2-288">Sarà quindi possibile migliorare l'esperienza utente con CSS3 per eseguire animazioni complete e fornire un effetto visivo del cambio di contesto durante la transizione da una domanda a quella successiva.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-288">You will then enhance the user experience with CSS3 to perform rich animations and provide a visual effect of context switching when transitioning from one question to the next.</span></span>

<a id="Ex2Task1"></a>
#### <a name="task-1--creating-the-spa-interface-using-angularjs"></a><span data-ttu-id="0f2c2-289">Attività 1: creazione dell'interfaccia SPA mediante AngularJS</span><span class="sxs-lookup"><span data-stu-id="0f2c2-289">Task 1 – Creating the SPA Interface Using AngularJS</span></span>

<span data-ttu-id="0f2c2-290">In questa attività si userà **AngularJS** per implementare il lato client dell'applicazione di quiz per geek.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-290">In this task you will use **AngularJS** to implement the client side of the Geek Quiz application.</span></span> <span data-ttu-id="0f2c2-291">**AngularJS** è un framework JavaScript open source che consente di aumentare le applicazioni basate su browser con la funzionalità MVC ( *Model-View-Controller* ), semplificando sia lo sviluppo che il test.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-291">**AngularJS** is an open-source JavaScript framework that augments browser-based applications with *Model-View-Controller* (MVC) capability, facilitating both development and testing.</span></span>

<span data-ttu-id="0f2c2-292">Si inizierà installando AngularJS dalla console di gestione pacchetti di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-292">You will start by installing AngularJS from Visual Studio's Package Manager Console.</span></span> <span data-ttu-id="0f2c2-293">Quindi, si creerà il controller per fornire il comportamento dell'app quiz geek e la visualizzazione per eseguire il rendering delle domande e delle risposte al quiz usando il motore di modelli AngularJS.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-293">Then, you will create the controller to provide the behavior of the Geek Quiz app and the view to render the quiz questions and answers using the AngularJS template engine.</span></span>

> [!NOTE]
> <span data-ttu-id="0f2c2-294">Per ulteriori informazioni su AngularJS, vedere [[http://angularjs.org/](http://angularjs.org/)](http://angularjs.org/).</span><span class="sxs-lookup"><span data-stu-id="0f2c2-294">For more information about AngularJS, refer to [[http://angularjs.org/](http://angularjs.org/)](http://angularjs.org/).</span></span>

1. <span data-ttu-id="0f2c2-295">Aprire **Visual Studio Express 2013 per il Web** e aprire la soluzione **GeekQuiz. sln** che si trova nella cartella **source/EX2-CreatingASPAInterface/Begin** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-295">Open **Visual Studio Express 2013 for Web** and open the **GeekQuiz.sln** solution located in the **Source/Ex2-CreatingASPAInterface/Begin** folder.</span></span> <span data-ttu-id="0f2c2-296">In alternativa, è possibile continuare con la soluzione ottenuta nell'esercizio precedente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-296">Alternatively, you can continue with the solution that you obtained in the previous exercise.</span></span>
2. <span data-ttu-id="0f2c2-297">Aprire la **console di gestione pacchetti** da **strumenti** > **Gestione pacchetti NuGet**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-297">Open the **Package Manager Console** from **Tools** > **NuGet Package Manager**.</span></span> <span data-ttu-id="0f2c2-298">Digitare il comando seguente per installare il pacchetto NuGet **AngularJS. Core** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-298">Type the following command to install the **AngularJS.Core** NuGet package.</span></span>

    [!code-powershell[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample16.ps1)]
3. <span data-ttu-id="0f2c2-299">In **Esplora soluzioni**fare clic con il pulsante destro del mouse sulla cartella **script** del progetto **GeekQuiz** e scegliere **Aggiungi | Nuova cartella**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-299">In **Solution Explorer**, right-click the **Scripts** folder of the **GeekQuiz** project and select **Add | New Folder**.</span></span> <span data-ttu-id="0f2c2-300">Assegnare un nome all' **app** per la cartella e premere **invio**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-300">Name the folder **app** and press **Enter**.</span></span>
4. <span data-ttu-id="0f2c2-301">Fare clic con il pulsante destro del mouse sulla cartella dell' **app** appena creata e scegliere **Aggiungi | File JavaScript**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-301">Right-click the **app** folder you just created and select **Add | JavaScript File**.</span></span>

    ![Creazione di un nuovo file JavaScript](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image17.png)

    <span data-ttu-id="0f2c2-303">*Creazione di un nuovo file JavaScript*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-303">*Creating a new JavaScript file*</span></span>
5. <span data-ttu-id="0f2c2-304">Nella finestra di dialogo **Specifica nome per l'elemento** Digitare *quiz-controller* nella casella di testo **nome elemento** e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-304">In the **Specify Name for Item** dialog box, type *quiz-controller* in the **Item name** text box and click **OK**.</span></span>

    ![Denominazione del nuovo file JavaScript](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image18.png)

    <span data-ttu-id="0f2c2-306">*Denominazione del nuovo file JavaScript*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-306">*Naming the new JavaScript file*</span></span>
6. <span data-ttu-id="0f2c2-307">Nel file **quiz-controller. js** aggiungere il codice seguente per dichiarare e inizializzare il controller **QuizCtrl** AngularJS.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-307">In the **quiz-controller.js** file, add the following code to declare and initialize the AngularJS **QuizCtrl** controller.</span></span>

    <span data-ttu-id="0f2c2-308">(Frammento di codice- *AspNetWebApiSpa-EX2-AngularQuizController*)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-308">(Code Snippet - *AspNetWebApiSpa - Ex2 - AngularQuizController*)</span></span>

    [!code-javascript[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample17.js)]

    > [!NOTE]
    > <span data-ttu-id="0f2c2-309">La funzione del costruttore del controller **QuizCtrl** prevede un parametro iniettabile denominato **$scope**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-309">The constructor function of the **QuizCtrl** controller expects an injectable parameter named **$scope**.</span></span> <span data-ttu-id="0f2c2-310">Lo stato iniziale dell'ambito deve essere configurato nella funzione del costruttore mediante l'associazione di proprietà all'oggetto **$scope** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-310">The initial state of the scope should be set up in the constructor function by attaching properties to the **$scope** object.</span></span> <span data-ttu-id="0f2c2-311">Le proprietà contengono il **modello di visualizzazione**e saranno accessibili al modello quando il controller viene registrato.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-311">The properties contain the **view model**, and will be accessible to the template when the controller is registered.</span></span>
    > 
    > <span data-ttu-id="0f2c2-312">Il controller **QuizCtrl** viene definito all'interno di un modulo denominato **QuizApp**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-312">The **QuizCtrl** controller is defined inside a module named **QuizApp**.</span></span> <span data-ttu-id="0f2c2-313">I moduli sono unità di lavoro che consentono di suddividere l'applicazione in componenti separati.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-313">Modules are units of work that let you break your application into separate components.</span></span> <span data-ttu-id="0f2c2-314">I principali vantaggi derivanti dall'uso dei moduli è che il codice è più semplice da comprendere e facilita il testing unità, la riusabilità e la gestibilità.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-314">The main advantages of using modules is that the code is easier to understand and facilitates unit testing, reusability and maintainability.</span></span>
7. <span data-ttu-id="0f2c2-315">A questo punto si aggiungerà il comportamento all'ambito per rispondere agli eventi generati dalla visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-315">You will now add behavior to the scope in order to react to events triggered from the view.</span></span> <span data-ttu-id="0f2c2-316">Aggiungere il codice seguente alla fine del controller **QuizCtrl** per definire la funzione **nextQuestion** nell'oggetto **$scope** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-316">Add the following code at the end of the **QuizCtrl** controller to define the **nextQuestion** function in the **$scope** object.</span></span>

    <span data-ttu-id="0f2c2-317">(Frammento di codice- *AspNetWebApiSpa-EX2-AngularQuizControllerNextQuestion*)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-317">(Code Snippet - *AspNetWebApiSpa - Ex2 - AngularQuizControllerNextQuestion*)</span></span>

    [!code-javascript[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample18.js)]

    > [!NOTE]
    > <span data-ttu-id="0f2c2-318">Questa funzione recupera la domanda successiva dall'API Web di **Trivia** creata nell'esercizio precedente e connette i dati della domanda all'oggetto **$scope** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-318">This function retrieves the next question from the **Trivia** Web API created in the previous exercise and attaches the question data to the **$scope** object.</span></span>
8. <span data-ttu-id="0f2c2-319">Inserire il codice seguente alla fine del controller **QuizCtrl** per definire la funzione **sendAnswer** nell'oggetto **$scope** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-319">Insert the following code at the end of the **QuizCtrl** controller to define the **sendAnswer** function in the **$scope** object.</span></span>

    <span data-ttu-id="0f2c2-320">(Frammento di codice- *AspNetWebApiSpa-EX2-AngularQuizControllerSendAnswer*)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-320">(Code Snippet - *AspNetWebApiSpa - Ex2 - AngularQuizControllerSendAnswer*)</span></span>

    [!code-javascript[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample19.js)]

    > [!NOTE]
    > <span data-ttu-id="0f2c2-321">Questa funzione Invia la risposta selezionata dall'utente all'API Web **Trivia** e archivia il risultato, ad esempio se la risposta è corretta o meno, nell'oggetto **$scope** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-321">This function sends the answer selected by the user to the **Trivia** Web API and stores the result –i.e. if the answer is correct or not– in the **$scope** object.</span></span>
    > 
    > <span data-ttu-id="0f2c2-322">Le funzioni **nextQuestion** e **sendAnswer** della versione precedente usano l'oggetto AngularJS **$http** per astrarre la comunicazione con l'API Web tramite l'oggetto XMLHttpRequest JavaScript dal browser.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-322">The **nextQuestion** and **sendAnswer** functions from above use the AngularJS **$http** object to abstract the communication with the Web API via the XMLHttpRequest JavaScript object from the browser.</span></span> <span data-ttu-id="0f2c2-323">AngularJS supporta un altro servizio che offre un livello più elevato di astrazione per l'esecuzione di operazioni CRUD su una risorsa tramite le API RESTful.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-323">AngularJS supports another service that brings a higher level of abstraction to perform CRUD operations against a resource through RESTful APIs.</span></span> <span data-ttu-id="0f2c2-324">L'oggetto AngularJS **$Resource** dispone di metodi di azione che forniscono comportamenti di alto livello senza la necessità di interagire con l'oggetto **$http** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-324">The AngularJS **$resource** object has action methods which provide high-level behaviors without the need to interact with the **$http** object.</span></span> <span data-ttu-id="0f2c2-325">Si consiglia di usare l'oggetto **$Resource** in scenari che richiedono il modello CRUD (informazioni di primo piano, vedere la [documentazione $Resource](https://docs.angularjs.org/api/ngResource/service/$resource)).</span><span class="sxs-lookup"><span data-stu-id="0f2c2-325">Consider using the **$resource** object in scenarios that requires the CRUD model (fore information, see the [$resource documentation](https://docs.angularjs.org/api/ngResource/service/$resource)).</span></span>
9. <span data-ttu-id="0f2c2-326">Il passaggio successivo consiste nel creare il modello AngularJS che definisce la visualizzazione per il quiz.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-326">The next step is to create the AngularJS template that defines the view for the quiz.</span></span> <span data-ttu-id="0f2c2-327">A tale scopo, aprire il file **index. cshtml** all'interno delle **visualizzazioni | Home** directory e sostituire il contenuto con il codice seguente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-327">To do this, open the **Index.cshtml** file inside the **Views | Home** folder and replace the content with the following code.</span></span>

    <span data-ttu-id="0f2c2-328">(Frammento di codice- *AspNetWebApiSpa-EX2-GeekQuizView*)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-328">(Code Snippet - *AspNetWebApiSpa - Ex2 - GeekQuizView*)</span></span>

    [!code-cshtml[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample20.cshtml)]

    > [!NOTE]
    > <span data-ttu-id="0f2c2-329">Il modello AngularJS è una specifica dichiarativa che usa le informazioni del modello e il controller per trasformare il markup statico nella visualizzazione dinamica visualizzata dall'utente nel browser.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-329">The AngularJS template is a declarative specification that uses information from the model and the controller to transform static markup into the dynamic view that the user sees in the browser.</span></span> <span data-ttu-id="0f2c2-330">Di seguito sono riportati esempi di elementi AngularJS ed attributi di elementi che possono essere utilizzati in un modello:</span><span class="sxs-lookup"><span data-stu-id="0f2c2-330">The following are examples of AngularJS elements and element attributes that can be used in a template:</span></span>
    > 
    > - <span data-ttu-id="0f2c2-331">La direttiva **ng-app** indica a AngularJS l'elemento DOM che rappresenta l'elemento radice dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-331">The **ng-app** directive tells AngularJS the DOM element that represents the root element of the application.</span></span>
    > - <span data-ttu-id="0f2c2-332">La direttiva **ng-controller** connette un controller al Dom nel punto in cui viene dichiarata la direttiva.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-332">The **ng-controller** directive attaches a controller to the DOM at the point where the directive is declared.</span></span>
    > - <span data-ttu-id="0f2c2-333">La notazione parentesi graffa **{{}}** indica le associazioni alle proprietà dell'ambito definite nel controller.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-333">The curly brace notation **{{ }}** denotes bindings to the scope properties defined in the controller.</span></span>
    > - <span data-ttu-id="0f2c2-334">La direttiva **ng-click** viene utilizzata per richiamare le funzioni definite nell'ambito in risposta ai clic dell'utente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-334">The **ng-click** directive is used to invoke the functions defined in the scope in response to user clicks.</span></span>
10. <span data-ttu-id="0f2c2-335">Aprire il file **site. CSS** all'interno della cartella **Content** e aggiungere gli stili evidenziati seguenti alla fine del file per fornire un aspetto per la visualizzazione quiz.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-335">Open the **Site.css** file inside the **Content** folder and add the following highlighted styles at the end of the file to provide a look and feel for the quiz view.</span></span>

    <span data-ttu-id="0f2c2-336">(Frammento di codice- *AspNetWebApiSpa-EX2-GeekQuizStyles*)</span><span class="sxs-lookup"><span data-stu-id="0f2c2-336">(Code Snippet - *AspNetWebApiSpa - Ex2 - GeekQuizStyles*)</span></span>

    [!code-css[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample21.css)]

<a id="Ex2Task2"></a>
#### <a name="task-2--running-the-solution"></a><span data-ttu-id="0f2c2-337">Attività 2: esecuzione della soluzione</span><span class="sxs-lookup"><span data-stu-id="0f2c2-337">Task 2 – Running the Solution</span></span>

<span data-ttu-id="0f2c2-338">In questa attività verrà eseguita la soluzione usando la nuova interfaccia utente creata con AngularJS per rispondere ad alcune domande sul quiz.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-338">In this task you will execute the solution using the new user interface you built with AngularJS to answer some of the quiz questions.</span></span>

1. <span data-ttu-id="0f2c2-339">Premere **F5** per eseguire la soluzione.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-339">Press **F5** to run the solution.</span></span>
2. <span data-ttu-id="0f2c2-340">Registrare un nuovo account utente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-340">Register a new user account.</span></span> <span data-ttu-id="0f2c2-341">A tale scopo, seguire la procedura di registrazione descritta in esercizio 1, attività 3.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-341">To do this, follow the registration steps described in Exercise 1, Task 3.</span></span>

    > [!NOTE]
    > <span data-ttu-id="0f2c2-342">Se si usa la soluzione dell'esercizio precedente, è possibile accedere con l'account utente creato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-342">If you are using the solution from the previous exercise, you can log in with the user account you created before.</span></span>
3. <span data-ttu-id="0f2c2-343">Verrà visualizzata la **Home** page, che mostra la prima domanda del quiz.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-343">The **Home** page should appear, showing the first question of the quiz.</span></span> <span data-ttu-id="0f2c2-344">Per rispondere alla domanda, fare clic su una delle opzioni.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-344">Answer the question by clicking one of the options.</span></span> <span data-ttu-id="0f2c2-345">Verrà attivata la funzione **sendAnswer** definita in precedenza, che invia l'opzione selezionata all'API Web **Trivia** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-345">This will trigger the **sendAnswer** function defined earlier, which sends the selected option to the **Trivia** Web API.</span></span>

    <span data-ttu-id="0f2c2-346">![Risposta a una domanda](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image19.png "Risposta a una domanda")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-346">![Answering a question](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image19.png "Answering a question")</span></span>

    <span data-ttu-id="0f2c2-347">*Risposta a una domanda*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-347">*Answering a question*</span></span>
4. <span data-ttu-id="0f2c2-348">Dopo aver fatto clic su uno dei pulsanti, viene visualizzata la risposta.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-348">After clicking one of the buttons, the answer should appear.</span></span> <span data-ttu-id="0f2c2-349">Fare clic su **domanda successiva** per visualizzare la domanda seguente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-349">Click **Next Question** to show the following question.</span></span> <span data-ttu-id="0f2c2-350">Verrà attivata la funzione **nextQuestion** definita nel controller.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-350">This will trigger the **nextQuestion** function defined in the controller.</span></span>

    <span data-ttu-id="0f2c2-351">![Richiesta della domanda successiva](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image20.png "Richiesta della domanda successiva")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-351">![Requesting the next question](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image20.png "Requesting the next question")</span></span>

    <span data-ttu-id="0f2c2-352">*Richiesta della domanda successiva*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-352">*Requesting the next question*</span></span>
5. <span data-ttu-id="0f2c2-353">Verrà visualizzata la domanda successiva.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-353">The next question should appear.</span></span> <span data-ttu-id="0f2c2-354">Continuare a rispondere alle domande tutte le volte che si desidera.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-354">Continue answering questions as many times as you want.</span></span> <span data-ttu-id="0f2c2-355">Dopo aver completato tutte le domande, è necessario tornare alla prima domanda.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-355">After completing all the questions you should return to the first question.</span></span>

    <span data-ttu-id="0f2c2-356">![Un'altra domanda](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image21.png "Un'altra domanda")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-356">![Another question](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image21.png "Another question")</span></span>

    <span data-ttu-id="0f2c2-357">*Prossima domanda*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-357">*Next question*</span></span>
6. <span data-ttu-id="0f2c2-358">Tornare a Visual Studio e premere **MAIUSC + F5** per arrestare il debug.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-358">Go back to Visual Studio and press **SHIFT + F5** to stop debugging.</span></span>

<a id="Ex2Task3"></a>
#### <a name="task-3--creating-a-flip-animation-using-css3"></a><span data-ttu-id="0f2c2-359">Attività 3: creazione di un'animazione flip con CSS3</span><span class="sxs-lookup"><span data-stu-id="0f2c2-359">Task 3 – Creating a Flip Animation Using CSS3</span></span>

<span data-ttu-id="0f2c2-360">In questa attività si useranno le proprietà CSS3 per eseguire animazioni complete aggiungendo un effetto flip quando viene fornita una risposta a una domanda e quando viene recuperata la domanda successiva.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-360">In this task you will use CSS3 properties to perform rich animations by adding a flip effect when a question is answered and when the next question is retrieved.</span></span>

1. <span data-ttu-id="0f2c2-361">In **Esplora soluzioni**fare clic con il pulsante destro del mouse sulla cartella **contenuto** del progetto **GeekQuiz** e scegliere **Aggiungi | Elemento esistente...**</span><span class="sxs-lookup"><span data-stu-id="0f2c2-361">In **Solution Explorer**, right-click the **Content** folder of the **GeekQuiz** project and select **Add | Existing Item...**.</span></span>

    <span data-ttu-id="0f2c2-362">![Aggiunta di un elemento esistente alla cartella Content](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image22.png "Aggiunta di un elemento esistente alla cartella Content")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-362">![Adding an existing item to the Content folder](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image22.png "Adding an existing item to the Content folder")</span></span>

    <span data-ttu-id="0f2c2-363">*Aggiunta di un elemento esistente alla cartella Content*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-363">*Adding an existing item to the Content folder*</span></span>
2. <span data-ttu-id="0f2c2-364">Nella finestra di dialogo **Aggiungi elemento esistente** passare alla cartella **source/assets** e selezionare **flip. CSS**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-364">In the **Add Existing Item** dialog box, navigate to the **Source/Assets** folder and select **Flip.css**.</span></span> <span data-ttu-id="0f2c2-365">Fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-365">Click **Add**.</span></span>

    <span data-ttu-id="0f2c2-366">![Aggiunta del file Flip. CSS dagli asset](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image23.png "Aggiunta del file Flip. CSS dagli asset")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-366">![Adding the Flip.css file from Assets](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image23.png "Adding the Flip.css file from Assets")</span></span>

    <span data-ttu-id="0f2c2-367">*Aggiunta del file Flip. CSS dagli asset*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-367">*Adding the Flip.css file from Assets*</span></span>
3. <span data-ttu-id="0f2c2-368">Aprire il file **flip. CSS** appena aggiunto ed esaminarne il contenuto.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-368">Open the **Flip.css** file you just added and inspect its content.</span></span>
4. <span data-ttu-id="0f2c2-369">Individuare il commento della **trasformazione Capovolgi** .</span><span class="sxs-lookup"><span data-stu-id="0f2c2-369">Locate the **flip transformation** comment.</span></span> <span data-ttu-id="0f2c2-370">Gli stili riportati di seguito utilizzano la **prospettiva** CSS e le trasformazioni **rotative** per generare un &quot;Flip&quot; effetto della scheda.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-370">The styles below that comment use the CSS **perspective** and **rotateY** transformations to generate a &quot;card flip&quot; effect.</span></span>

    [!code-css[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample22.css)]
5. <span data-ttu-id="0f2c2-371">Individuare il **riquadro Nascondi indietro durante** il commento flip.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-371">Locate the **hide back of pane during flip** comment.</span></span> <span data-ttu-id="0f2c2-372">Lo stile sotto il commento nasconde il lato posteriore delle facce quando si trovano al di fuori del Visualizzatore impostando la proprietà CSS **backface-visibility** su *Hidden*.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-372">The style below that comment hides the back-side of the faces when they are facing away from the viewer by setting the **backface-visibility** CSS property to *hidden*.</span></span>

    [!code-css[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample23.css)]
6. <span data-ttu-id="0f2c2-373">Aprire il file **BundleConfig.cs** all'interno dell' **app\_** cartella di avvio e aggiungere il riferimento al file **flip. css** nel bundle di stile **&quot;~/content/CSS&quot;**</span><span class="sxs-lookup"><span data-stu-id="0f2c2-373">Open the **BundleConfig.cs** file inside the **App\_Start** folder and add the reference to the **Flip.css** file in the **&quot;~/Content/css&quot;** style bundle</span></span>

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample24.cs)]
7. <span data-ttu-id="0f2c2-374">Premere **F5** per eseguire la soluzione e accedere con le proprie credenziali.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-374">Press **F5** to run the solution and log in with your credentials.</span></span>
8. <span data-ttu-id="0f2c2-375">Per rispondere a una domanda, fare clic su una delle opzioni.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-375">Answer a question by clicking one of the options.</span></span> <span data-ttu-id="0f2c2-376">Si noti l'effetto flip durante la transizione tra le visualizzazioni.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-376">Notice the flip effect when transitioning between views.</span></span>

    <span data-ttu-id="0f2c2-377">![Risposta a una domanda con effetto flip](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image24.png "Risposta a una domanda con effetto flip")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-377">![Answering a question with the flip effect](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image24.png "Answering a question with the flip effect")</span></span>

    <span data-ttu-id="0f2c2-378">*Risposta a una domanda con effetto flip*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-378">*Answering a question with the flip effect*</span></span>
9. <span data-ttu-id="0f2c2-379">Fare clic su **Next question** per recuperare la domanda seguente.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-379">Click **Next Question** to retrieve the following question.</span></span> <span data-ttu-id="0f2c2-380">L'effetto flip dovrebbe essere visualizzato di nuovo.</span><span class="sxs-lookup"><span data-stu-id="0f2c2-380">The flip effect should appear again.</span></span>

    <span data-ttu-id="0f2c2-381">![Recupero della domanda seguente con effetto flip](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image25.png "Recupero della domanda seguente con effetto flip")</span><span class="sxs-lookup"><span data-stu-id="0f2c2-381">![Retrieving the following question with the flip effect](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image25.png "Retrieving the following question with the flip effect")</span></span>

    <span data-ttu-id="0f2c2-382">*Recupero della domanda seguente con effetto flip*</span><span class="sxs-lookup"><span data-stu-id="0f2c2-382">*Retrieving the following question with the flip effect*</span></span>

---

<a id="Summary"></a>
## <a name="summary"></a><span data-ttu-id="0f2c2-383">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="0f2c2-383">Summary</span></span>

<span data-ttu-id="0f2c2-384">Completando questa esercitazione pratica si è appreso come:</span><span class="sxs-lookup"><span data-stu-id="0f2c2-384">By completing this hands-on lab you have learned how to:</span></span>

- <span data-ttu-id="0f2c2-385">Creare un controller di API Web ASP.NET usando l'impalcatura ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0f2c2-385">Create an ASP.NET Web API controller using ASP.NET Scaffolding</span></span>
- <span data-ttu-id="0f2c2-386">Implementare un'azione Get dell'API Web per recuperare la domanda successiva del quiz</span><span class="sxs-lookup"><span data-stu-id="0f2c2-386">Implement a Web API Get action to retrieve the next quiz question</span></span>
- <span data-ttu-id="0f2c2-387">Implementare un'azione post per l'API Web per archiviare le risposte al quiz</span><span class="sxs-lookup"><span data-stu-id="0f2c2-387">Implement a Web API Post action to store the quiz answers</span></span>
- <span data-ttu-id="0f2c2-388">Installare AngularJS dalla console di gestione pacchetti di Visual Studio</span><span class="sxs-lookup"><span data-stu-id="0f2c2-388">Install AngularJS from the Visual Studio Package Manager Console</span></span>
- <span data-ttu-id="0f2c2-389">Implementare modelli e controller AngularJS</span><span class="sxs-lookup"><span data-stu-id="0f2c2-389">Implement AngularJS templates and controllers</span></span>
- <span data-ttu-id="0f2c2-390">Usare le transizioni CSS3 per eseguire gli effetti di animazione</span><span class="sxs-lookup"><span data-stu-id="0f2c2-390">Use CSS3 transitions to perform animation effects</span></span>
